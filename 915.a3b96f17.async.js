var ip=Math.pow;(self.webpackChunkdistrict_data=self.webpackChunkdistrict_data||[]).push([[915],{81618:function(Ne){"use strict";(function(fe,I){Ne.exports=I()})(this,function(){function fe(Y){var G=[];return Y.AMapUI&&G.push(I(Y.AMapUI)),Y.Loca&&G.push(D(Y.Loca)),Promise.all(G)}function I(Y){return new Promise(function(G,$){var xe=[];if(Y.plugins)for(var Fe=0;Fe<Y.plugins.length;Fe+=1)m.AMapUI.plugins.indexOf(Y.plugins[Fe])==-1&&xe.push(Y.plugins[Fe]);if(ae.AMapUI===k.failed)$("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(ae.AMapUI===k.notload){ae.AMapUI=k.loading,m.AMapUI.version=Y.version||m.AMapUI.version,Fe=m.AMapUI.version;var Ce=document.body||document.head,We=document.createElement("script");We.type="text/javascript",We.src="https://webapi.amap.com/ui/"+Fe+"/main.js",We.onerror=function(me){ae.AMapUI=k.failed,$("\u8BF7\u6C42 AMapUI \u5931\u8D25")},We.onload=function(){if(ae.AMapUI=k.loaded,xe.length)window.AMapUI.loadUI(xe,function(){for(var me=0,Ge=xe.length;me<Ge;me++){var Ke=xe[me].split("/").slice(-1)[0];window.AMapUI[Ke]=arguments[me]}for(G();F.AMapUI.length;)F.AMapUI.splice(0,1)[0]()});else for(G();F.AMapUI.length;)F.AMapUI.splice(0,1)[0]()},Ce.appendChild(We)}else ae.AMapUI===k.loaded?Y.version&&Y.version!==m.AMapUI.version?$("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):xe.length?window.AMapUI.loadUI(xe,function(){for(var me=0,Ge=xe.length;me<Ge;me++){var Ke=xe[me].split("/").slice(-1)[0];window.AMapUI[Ke]=arguments[me]}G()}):G():Y.version&&Y.version!==m.AMapUI.version?$("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):F.AMapUI.push(function(me){me?$(me):xe.length?window.AMapUI.loadUI(xe,function(){for(var Ge=0,Ke=xe.length;Ge<Ke;Ge++){var pt=xe[Ge].split("/").slice(-1)[0];window.AMapUI[pt]=arguments[Ge]}G()}):G()})})}function D(Y){return new Promise(function(G,$){if(ae.Loca===k.failed)$("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(ae.Loca===k.notload){ae.Loca=k.loading,m.Loca.version=Y.version||m.Loca.version;var xe=m.Loca.version,Fe=m.AMap.version.startsWith("2"),Ce=xe.startsWith("2");if(Fe&&!Ce||!Fe&&Ce)$("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{Fe=m.key,Ce=document.body||document.head;var We=document.createElement("script");We.type="text/javascript",We.src="https://webapi.amap.com/loca?v="+xe+"&key="+Fe,We.onerror=function(me){ae.Loca=k.failed,$("\u8BF7\u6C42 AMapUI \u5931\u8D25")},We.onload=function(){for(ae.Loca=k.loaded,G();F.Loca.length;)F.Loca.splice(0,1)[0]()},Ce.appendChild(We)}}else ae.Loca===k.loaded?Y.version&&Y.version!==m.Loca.version?$("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):G():Y.version&&Y.version!==m.Loca.version?$("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):F.Loca.push(function(me){me?$(me):$()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var k;(function(Y){Y.notload="notload",Y.loading="loading",Y.loaded="loaded",Y.failed="failed"})(k||(k={}));var m={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},ae={AMap:k.notload,AMapUI:k.notload,Loca:k.notload},F={AMap:[],AMapUI:[],Loca:[]},K=[],W=function(Y){typeof Y=="function"&&(ae.AMap===k.loaded?Y(window.AMap):K.push(Y))};return{load:function(Y){return new Promise(function(G,$){if(ae.AMap==k.failed)$("");else if(ae.AMap==k.notload){var xe=Y.key,Fe=Y.version,Ce=Y.plugins;xe?(window.AMap&&location.host!=="lbs.amap.com"&&$("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),m.key=xe,m.AMap.version=Fe||m.AMap.version,m.AMap.plugins=Ce||m.AMap.plugins,ae.AMap=k.loading,Fe=document.body||document.head,window.___onAPILoaded=function(me){if(delete window.___onAPILoaded,me)ae.AMap=k.failed,$(me);else for(ae.AMap=k.loaded,fe(Y).then(function(){G(window.AMap)}).catch($);K.length;)K.splice(0,1)[0]()},Ce=document.createElement("script"),Ce.type="text/javascript",Ce.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+m.AMap.version+"&key="+xe+"&plugin="+m.AMap.plugins.join(","),Ce.onerror=function(me){ae.AMap=k.failed,$(me)},Fe.appendChild(Ce)):$("\u8BF7\u586B\u5199key")}else if(ae.AMap==k.loaded)if(Y.key&&Y.key!==m.key)$("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Y.version&&Y.version!==m.AMap.version)$("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(xe=[],Y.plugins)for(Fe=0;Fe<Y.plugins.length;Fe+=1)m.AMap.plugins.indexOf(Y.plugins[Fe])==-1&&xe.push(Y.plugins[Fe]);xe.length?window.AMap.plugin(xe,function(){fe(Y).then(function(){G(window.AMap)}).catch($)}):fe(Y).then(function(){G(window.AMap)}).catch($)}else if(Y.key&&Y.key!==m.key)$("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Y.version&&Y.version!==m.AMap.version)$("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var We=[];if(Y.plugins)for(Fe=0;Fe<Y.plugins.length;Fe+=1)m.AMap.plugins.indexOf(Y.plugins[Fe])==-1&&We.push(Y.plugins[Fe]);W(function(){We.length?window.AMap.plugin(We,function(){fe(Y).then(function(){G(window.AMap)}).catch($)}):fe(Y).then(function(){G(window.AMap)}).catch($)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,m={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},ae={AMap:k.notload,AMapUI:k.notload,Loca:k.notload},F={AMap:[],AMapUI:[],Loca:[]}}}})},16397:function(Ne,fe,I){"use strict";I.d(fe,{R_:function(){return Ke}});var D=I(86500),k=I(1350),m=2,ae=.16,F=.05,K=.05,W=.15,Y=5,G=4,$=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function xe(bt){var Ht=bt.r,Er=bt.g,Vt=bt.b,on=(0,D.py)(Ht,Er,Vt);return{h:on.h*360,s:on.s,v:on.v}}function Fe(bt){var Ht=bt.r,Er=bt.g,Vt=bt.b;return"#".concat((0,D.vq)(Ht,Er,Vt,!1))}function Ce(bt,Ht,Er){var Vt=Er/100,on={r:(Ht.r-bt.r)*Vt+bt.r,g:(Ht.g-bt.g)*Vt+bt.g,b:(Ht.b-bt.b)*Vt+bt.b};return on}function We(bt,Ht,Er){var Vt;return Math.round(bt.h)>=60&&Math.round(bt.h)<=240?Vt=Er?Math.round(bt.h)-m*Ht:Math.round(bt.h)+m*Ht:Vt=Er?Math.round(bt.h)+m*Ht:Math.round(bt.h)-m*Ht,Vt<0?Vt+=360:Vt>=360&&(Vt-=360),Vt}function me(bt,Ht,Er){if(bt.h===0&&bt.s===0)return bt.s;var Vt;return Er?Vt=bt.s-ae*Ht:Ht===G?Vt=bt.s+ae:Vt=bt.s+F*Ht,Vt>1&&(Vt=1),Er&&Ht===Y&&Vt>.1&&(Vt=.1),Vt<.06&&(Vt=.06),Number(Vt.toFixed(2))}function Ge(bt,Ht,Er){var Vt;return Er?Vt=bt.v+K*Ht:Vt=bt.v-W*Ht,Vt>1&&(Vt=1),Number(Vt.toFixed(2))}function Ke(bt){for(var Ht=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Er=[],Vt=(0,k.uA)(bt),on=Y;on>0;on-=1){var hn=xe(Vt),gi=Fe((0,k.uA)({h:We(hn,on,!0),s:me(hn,on,!0),v:Ge(hn,on,!0)}));Er.push(gi)}Er.push(Fe(Vt));for(var Hn=1;Hn<=G;Hn+=1){var Dt=xe(Vt),Ea=Fe((0,k.uA)({h:We(Dt,Hn),s:me(Dt,Hn),v:Ge(Dt,Hn)}));Er.push(Ea)}return Ht.theme==="dark"?$.map(function(Ze){var ci=Ze.index,Ci=Ze.opacity,Oi=Fe(Ce((0,k.uA)(Ht.backgroundColor||"#141414"),(0,k.uA)(Er[ci]),Ci*100));return Oi}):Er}var pt={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Xe={},gt={};Object.keys(pt).forEach(function(bt){Xe[bt]=Ke(pt[bt]),Xe[bt].primary=Xe[bt][5],gt[bt]=Ke(pt[bt],{theme:"dark",backgroundColor:"#141414"}),gt[bt].primary=gt[bt][5]});var ie=Xe.red,ft=Xe.volcano,ve=Xe.gold,Ae=Xe.orange,Re=Xe.yellow,Ye=Xe.lime,at=Xe.green,ht=Xe.cyan,Se=Xe.blue,Qe=Xe.geekblue,oe=Xe.purple,ue=Xe.magenta,be=Xe.grey,vt=Xe.grey},51222:function(Ne,fe,I){"use strict";I.d(fe,{E4:function(){return Yt},jG:function(){return Tt},fp:function(){return Ci},xy:function(){return Rr}});var D=I(1413),k=I(74902),m=I(67294);function ae(lt){for(var Xt=0,nr,ur=0,Vr=lt.length;Vr>=4;++ur,Vr-=4)nr=lt.charCodeAt(ur)&255|(lt.charCodeAt(++ur)&255)<<8|(lt.charCodeAt(++ur)&255)<<16|(lt.charCodeAt(++ur)&255)<<24,nr=(nr&65535)*1540483477+((nr>>>16)*59797<<16),nr^=nr>>>24,Xt=(nr&65535)*1540483477+((nr>>>16)*59797<<16)^(Xt&65535)*1540483477+((Xt>>>16)*59797<<16);switch(Vr){case 3:Xt^=(lt.charCodeAt(ur+2)&255)<<16;case 2:Xt^=(lt.charCodeAt(ur+1)&255)<<8;case 1:Xt^=lt.charCodeAt(ur)&255,Xt=(Xt&65535)*1540483477+((Xt>>>16)*59797<<16)}return Xt^=Xt>>>13,Xt=(Xt&65535)*1540483477+((Xt>>>16)*59797<<16),((Xt^Xt>>>15)>>>0).toString(36)}var F=ae,K=I(56982),W=I(91881),Y=I(15671),G=I(43144),$=I(4942),xe=function(){function lt(){(0,Y.Z)(this,lt),(0,$.Z)(this,"cache",new Map)}return(0,G.Z)(lt,[{key:"get",value:function(nr){return this.cache.get(nr.join("%"))||null}},{key:"update",value:function(nr,ur){var Vr=nr.join("%"),ln=this.cache.get(Vr),Un=ur(ln);Un===null?this.cache.delete(Vr):this.cache.set(Vr,Un)}}]),lt}(),Fe=xe,Ce=null,We="data-token-hash",me="data-css-hash",Ge="data-dev-cache-path",Ke="__cssinjs_instance__",pt=Math.random().toString(12).slice(2);function Xe(){if(typeof document!="undefined"&&document.head&&document.body){var lt=document.body.querySelectorAll("style[".concat(me,"]"))||[],Xt=document.head.firstChild;Array.from(lt).forEach(function(ur){ur[Ke]=ur[Ke]||pt,document.head.insertBefore(ur,Xt)});var nr={};Array.from(document.querySelectorAll("style[".concat(me,"]"))).forEach(function(ur){var Vr=ur.getAttribute(me);if(nr[Vr]){if(ur[Ke]===pt){var ln;(ln=ur.parentNode)===null||ln===void 0||ln.removeChild(ur)}}else nr[Vr]=!0})}return new Fe}var gt=m.createContext({hashPriority:"low",cache:Xe(),defaultCache:!0}),ie=function(Xt){var nr=Xt.children,ur=_objectWithoutProperties(Xt,Ce),Vr=React.useContext(gt),ln=useMemo(function(){var Un=_objectSpread({},Vr);Object.keys(ur).forEach(function(qn){var oi=ur[qn];ur[qn]!==void 0&&(Un[qn]=oi)});var Gn=ur.cache;return Un.cache=Un.cache||Xe(),Un.defaultCache=!Gn&&Vr.defaultCache,Un},[Vr,ur],function(Un,Gn){return!isEqual(Un[0],Gn[0],!0)||!isEqual(Un[1],Gn[1],!0)});return React.createElement(gt.Provider,{value:ln},nr)},ft=gt,ve=I(97685);function Ae(){return!1}var Re=!1;function Ye(){return Re}var at=Ae;if(!1)var ht,Se;function Qe(lt,Xt,nr,ur){var Vr=m.useContext(ft),ln=Vr.cache,Un=[lt].concat((0,k.Z)(Xt)),Gn=at();return m.useMemo(function(){ln.update(Un,function(qn){var oi=qn||[],T=(0,ve.Z)(oi,2),H=T[0],_e=H===void 0?0:H,ne=T[1],$e=ne,xt=$e||nr();return[_e+1,xt]})},[Un.join("_")]),m.useEffect(function(){return function(){ln.update(Un,function(qn){var oi=qn||[],T=(0,ve.Z)(oi,2),H=T[0],_e=H===void 0?0:H,ne=T[1],$e=_e-1;return $e===0?(ur==null||ur(ne,!1),null):[_e-1,ne]})}},Un),ln.get(Un)[1]}var oe=I(71002),ue=I(98924),be=I(44958);function vt(lt){var Xt="";return Object.keys(lt).forEach(function(nr){var ur=lt[nr];Xt+=nr,ur&&(0,oe.Z)(ur)==="object"?Xt+=vt(ur):Xt+=ur}),Xt}function bt(lt,Xt){return F("".concat(Xt,"_").concat(vt(lt)))}var Ht="layer-".concat(Date.now(),"-").concat(Math.random()).replace(/\./g,""),Er="903px";function Vt(lt,Xt){if((0,ue.Z)()){var nr;(0,be.hq)(lt,Ht);var ur=document.createElement("div");ur.style.position="fixed",ur.style.left="0",ur.style.top="0",Xt==null||Xt(ur),document.body.appendChild(ur);var Vr=getComputedStyle(ur).width===Er;return(nr=ur.parentNode)===null||nr===void 0||nr.removeChild(ur),(0,be.jL)(Ht),Vr}return!1}var on=void 0;function hn(){return on===void 0&&(on=Vt("@layer ".concat(Ht," { .").concat(Ht," { width: ").concat(Er,"!important; } }"),function(lt){lt.className=Ht})),on}var gi={},Hn="css",Dt=new Map;function Ea(lt){Dt.set(lt,(Dt.get(lt)||0)+1)}function Ze(lt){if(typeof document!="undefined"){var Xt=document.querySelectorAll("style[".concat(We,'="').concat(lt,'"]'));Xt.forEach(function(nr){if(nr[Ke]===pt){var ur;(ur=nr.parentNode)===null||ur===void 0||ur.removeChild(nr)}})}}function ci(lt){Dt.set(lt,(Dt.get(lt)||0)-1);var Xt=Array.from(Dt.keys()),nr=Xt.filter(function(ur){var Vr=Dt.get(ur)||0;return Vr<=0});nr.length<Xt.length&&nr.forEach(function(ur){Ze(ur),Dt.delete(ur)})}function Ci(lt,Xt){var nr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ur=nr.salt,Vr=ur===void 0?"":ur,ln=nr.override,Un=ln===void 0?gi:ln,Gn=nr.formatToken,qn=m.useMemo(function(){return Object.assign.apply(Object,[{}].concat((0,k.Z)(Xt)))},[Xt]),oi=m.useMemo(function(){return vt(qn)},[qn]),T=m.useMemo(function(){return vt(Un)},[Un]),H=Qe("token",[Vr,lt.id,oi,T],function(){var _e=lt.getDerivativeToken(qn),ne=(0,D.Z)((0,D.Z)({},_e),Un);Gn&&(ne=Gn(ne));var $e=bt(ne,Vr);ne._tokenKey=$e,Ea($e);var xt="".concat(Hn,"-").concat(F($e));return ne._hashId=xt,[ne,xt]},function(_e){ci(_e[0]._tokenKey)});return H}var Oi=I(87462),ea={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},fn=ea,tn="-ms-",da="-moz-",Ii="-webkit-",Ai="comm",Pr="rule",nt="decl",it="@page",_t="@media",we="@import",er="@charset",$r="@viewport",Fn="@supports",Qt="@document",Br="@namespace",bn="@keyframes",gr="@font-face",pn="@counter-style",Sn="@font-feature-values",Dn=Math.abs,ui=String.fromCharCode,di=Object.assign;function ca(lt,Xt){return an(lt,0)^45?(((Xt<<2^an(lt,0))<<2^an(lt,1))<<2^an(lt,2))<<2^an(lt,3):0}function Ni(lt){return lt.trim()}function Wa(lt,Xt){return(lt=Xt.exec(lt))?lt[0]:lt}function Ba(lt,Xt,nr){return lt.replace(Xt,nr)}function Ia(lt,Xt){return lt.indexOf(Xt)}function an(lt,Xt){return lt.charCodeAt(Xt)|0}function Ln(lt,Xt,nr){return lt.slice(Xt,nr)}function re(lt){return lt.length}function he(lt){return lt.length}function V(lt,Xt){return Xt.push(lt),lt}function Et(lt,Xt){return lt.map(Xt).join("")}function Bt(lt,Xt){for(var nr="",ur=he(lt),Vr=0;Vr<ur;Vr++)nr+=Xt(lt[Vr],Vr,lt,Xt)||"";return nr}function Le(lt,Xt,nr,ur){switch(lt.type){case we:case nt:return lt.return=lt.return||lt.value;case Ai:return"";case bn:return lt.return=lt.value+"{"+Bt(lt.children,ur)+"}";case Pr:lt.value=lt.props.join(",")}return re(nr=Bt(lt.children,ur))?lt.return=lt.value+"{"+nr+"}":""}var St=1,tt=1,At=0,tr=0,en=0,Kr="";function Ft(lt,Xt,nr,ur,Vr,ln,Un){return{value:lt,root:Xt,parent:nr,type:ur,props:Vr,children:ln,line:St,column:tt,length:Un,return:""}}function rr(lt,Xt){return assign(Ft("",null,null,"",null,null,0),lt,{length:-lt.length},Xt)}function ot(){return en}function Li(){return en=tr>0?an(Kr,--tr):0,tt--,en===10&&(tt=1,St--),en}function Hr(){return en=tr<At?an(Kr,tr++):0,tt++,en===10&&(tt=1,St++),en}function _i(){return an(Kr,tr)}function vi(){return tr}function It(lt,Xt){return Ln(Kr,lt,Xt)}function Yr(lt){switch(lt){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Dr(lt){return St=tt=1,At=re(Kr=lt),tr=0,[]}function Jn(lt){return Kr="",lt}function Kt(lt){return Ni(It(tr-1,Ui(lt===91?lt+2:lt===40?lt+1:lt)))}function hr(lt){return Jn(qr(Dr(lt)))}function Fr(lt){for(;(en=_i())&&en<33;)Hr();return Yr(lt)>2||Yr(en)>3?"":" "}function qr(lt){for(;Hr();)switch(Yr(en)){case 0:append(Wi(tr-1),lt);break;case 2:append(Kt(en),lt);break;default:append(from(en),lt)}return lt}function An(lt,Xt){for(;--Xt&&Hr()&&!(en<48||en>102||en>57&&en<65||en>70&&en<97););return It(lt,vi()+(Xt<6&&_i()==32&&Hr()==32))}function Ui(lt){for(;Hr();)switch(en){case lt:return tr;case 34:case 39:lt!==34&&lt!==39&&Ui(en);break;case 40:lt===41&&Ui(lt);break;case 92:Hr();break}return tr}function fa(lt,Xt){for(;Hr()&&lt+en!==47+10;)if(lt+en===42+42&&_i()===47)break;return"/*"+It(Xt,tr-1)+"*"+ui(lt===47?lt:Hr())}function Wi(lt){for(;!Yr(_i());)Hr();return It(lt,tr)}function ct(lt){return Jn(qi("",null,null,null,[""],lt=Dr(lt),0,[0],lt))}function qi(lt,Xt,nr,ur,Vr,ln,Un,Gn,qn){for(var oi=0,T=0,H=Un,_e=0,ne=0,$e=0,xt=1,zt=1,_r=1,xr=0,dn="",Bn=Vr,zi=ln,Vi=ur,Ei=dn;zt;)switch($e=xr,xr=Hr()){case 40:if($e!=108&&an(Ei,H-1)==58){Ia(Ei+=Ba(Kt(xr),"&","&\f"),"&\f")!=-1&&(_r=-1);break}case 34:case 39:case 91:Ei+=Kt(xr);break;case 9:case 10:case 13:case 32:Ei+=Fr($e);break;case 92:Ei+=An(vi()-1,7);continue;case 47:switch(_i()){case 42:case 47:V(To(fa(Hr(),vi()),Xt,nr),qn);break;default:Ei+="/"}break;case 123*xt:Gn[oi++]=re(Ei)*_r;case 125*xt:case 59:case 0:switch(xr){case 0:case 125:zt=0;case 59+T:ne>0&&re(Ei)-H&&V(ne>32?ao(Ei+";",ur,nr,H-1):ao(Ba(Ei," ","")+";",ur,nr,H-2),qn);break;case 59:Ei+=";";default:if(V(Vi=Na(Ei,Xt,nr,oi,T,Vr,Gn,dn,Bn=[],zi=[],H),ln),xr===123)if(T===0)qi(Ei,Xt,Vi,Vi,Bn,ln,H,Gn,zi);else switch(_e===99&&an(Ei,3)===110?100:_e){case 100:case 109:case 115:qi(lt,Vi,Vi,ur&&V(Na(lt,Vi,Vi,0,0,Vr,Gn,dn,Vr,Bn=[],H),zi),Vr,zi,H,Gn,ur?Bn:zi);break;default:qi(Ei,Vi,Vi,Vi,[""],zi,0,Gn,zi)}}oi=T=ne=0,xt=_r=1,dn=Ei="",H=Un;break;case 58:H=1+re(Ei),ne=$e;default:if(xt<1){if(xr==123)--xt;else if(xr==125&&xt++==0&&Li()==125)continue}switch(Ei+=ui(xr),xr*xt){case 38:_r=T>0?1:(Ei+="\f",-1);break;case 44:Gn[oi++]=(re(Ei)-1)*_r,_r=1;break;case 64:_i()===45&&(Ei+=Kt(Hr())),_e=_i(),T=H=re(dn=Ei+=Wi(vi())),xr++;break;case 45:$e===45&&re(Ei)==2&&(xt=0)}}return ln}function Na(lt,Xt,nr,ur,Vr,ln,Un,Gn,qn,oi,T){for(var H=Vr-1,_e=Vr===0?ln:[""],ne=he(_e),$e=0,xt=0,zt=0;$e<ur;++$e)for(var _r=0,xr=Ln(lt,H+1,H=Dn(xt=Un[$e])),dn=lt;_r<ne;++_r)(dn=Ni(xt>0?_e[_r]+" "+xr:Ba(xr,/&\f/g,_e[_r])))&&(qn[zt++]=dn);return Ft(lt,Xt,nr,Vr===0?Pr:Gn,qn,oi,T)}function To(lt,Xt,nr){return Ft(lt,Xt,nr,Ai,ui(ot()),Ln(lt,2,-2),0)}function ao(lt,Xt,nr,ur){return Ft(lt,Xt,nr,nt,Ln(lt,0,ur),Ln(lt,ur+1,-1),ur)}var Ga=I(80334);function Ko(lt,Xt){var nr=Xt.path,ur=Xt.parentSelectors;devWarning(!1,"[Ant Design CSS-in-JS] ".concat(nr?"Error in ".concat(nr,": "):"").concat(lt).concat(ur.length?" Selector: ".concat(ur.join(" | ")):""))}var ws=function(Xt,nr,ur){if(Xt==="content"){var Vr=/(attr|counters?|url|(((repeating-)?(linear|radial))|conic)-gradient)\(|(no-)?(open|close)-quote/,ln=["normal","none","initial","inherit","unset"];(typeof nr!="string"||ln.indexOf(nr)===-1&&!Vr.test(nr)&&(nr.charAt(0)!==nr.charAt(nr.length-1)||nr.charAt(0)!=='"'&&nr.charAt(0)!=="'"))&&lintWarning("You seem to be using a value for 'content' without quotes, try replacing it with `content: '\"".concat(nr,"\"'`."),ur)}},Fo=null,su=function(Xt,nr,ur){Xt==="animation"&&ur.hashId&&nr!=="none"&&lintWarning("You seem to be using hashed animation '".concat(nr,"', in which case 'animationName' with Keyframe as value is recommended."),ur)},zo=null;function ns(lt){var Xt,nr=((Xt=lt.match(/:not\(([^)]*)\)/))===null||Xt===void 0?void 0:Xt[1])||"",ur=nr.split(/(\[[^[]*])|(?=[.#])/).filter(function(Vr){return Vr});return ur.length>1}function ls(lt){return lt.parentSelectors.reduce(function(Xt,nr){return Xt?nr.includes("&")?nr.replace(/&/g,Xt):"".concat(Xt," ").concat(nr):nr},"")}var _o=function(Xt,nr,ur){var Vr=ls(ur),ln=Vr.match(/:not\([^)]*\)/g)||[];ln.length>0&&ln.some(ns)&&lintWarning("Concat ':not' selector not support in legacy browsers.",ur)},Po=null,Ss=function(Xt,nr,ur){switch(Xt){case"marginLeft":case"marginRight":case"paddingLeft":case"paddingRight":case"left":case"right":case"borderLeft":case"borderLeftWidth":case"borderLeftStyle":case"borderLeftColor":case"borderRight":case"borderRightWidth":case"borderRightStyle":case"borderRightColor":case"borderTopLeftRadius":case"borderTopRightRadius":case"borderBottomLeftRadius":case"borderBottomRightRadius":lintWarning("You seem to be using non-logical property '".concat(Xt,"' which is not compatible with RTL mode. Please use logical properties and values instead. For more information: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Logical_Properties."),ur);return;case"margin":case"padding":case"borderWidth":case"borderStyle":if(typeof nr=="string"){var Vr=nr.split(" ").map(function(Gn){return Gn.trim()});Vr.length===4&&Vr[1]!==Vr[3]&&lintWarning("You seem to be using '".concat(Xt,"' property with different left ").concat(Xt," and right ").concat(Xt,", which is not compatible with RTL mode. Please use logical properties and values instead. For more information: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Logical_Properties."),ur)}return;case"clear":case"textAlign":(nr==="left"||nr==="right")&&lintWarning("You seem to be using non-logical value '".concat(nr,"' of ").concat(Xt,", which is not compatible with RTL mode. Please use logical properties and values instead. For more information: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Logical_Properties."),ur);return;case"borderRadius":if(typeof nr=="string"){var ln=nr.split("/").map(function(Gn){return Gn.trim()}),Un=ln.reduce(function(Gn,qn){if(Gn)return Gn;var oi=qn.split(" ").map(function(T){return T.trim()});return oi.length>=2&&oi[0]!==oi[1]||oi.length===3&&oi[1]!==oi[2]||oi.length===4&&oi[2]!==oi[3]?!0:Gn},!1);Un&&lintWarning("You seem to be using non-logical value '".concat(nr,"' of ").concat(Xt,", which is not compatible with RTL mode. Please use logical properties and values instead. For more information: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Logical_Properties."),ur)}return;default:}},Wu=null,$s=function(Xt,nr,ur){ur.parentSelectors.some(function(Vr){var ln=Vr.split(",");return ln.some(function(Un){return Un.split("&").length>2})})&&lintWarning("Should not use more than one `&` in a selector.",ur)},uu=null,Jo=(0,ue.Z)(),ms="_skip_check_";function eu(lt){var Xt=Bt(ct(lt),Le);return Xt.replace(/\{%%%\:[^;];}/g,";")}function Bs(lt){return(0,oe.Z)(lt)==="object"&&lt&&ms in lt}function fi(lt,Xt,nr){if(!Xt)return lt;var ur=".".concat(Xt),Vr=nr==="low"?":where(".concat(ur,")"):ur,ln=lt.split(",").map(function(Un){var Gn,qn=Un.trim().split(/\s+/),oi=qn[0]||"",T=((Gn=oi.match(/^\w+/))===null||Gn===void 0?void 0:Gn[0])||"";return oi="".concat(T).concat(Vr).concat(oi.slice(T.length)),[oi].concat((0,k.Z)(qn.slice(1))).join(" ")});return ln.join(",")}var is=new Set,ku=null,mt=function lt(Xt){var nr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ur=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},Vr=ur.root,ln=ur.injectHash,Un=ur.parentSelectors,Gn=nr.hashId,qn=nr.layer,oi=nr.path,T=nr.hashPriority,H=nr.transformers,_e=H===void 0?[]:H,ne=nr.linters,$e=ne===void 0?[]:ne,xt="",zt={};function _r(Vi){var Ei=Vi.getName(Gn);if(!zt[Ei]){var qa=lt(Vi.style,nr,{root:!1,parentSelectors:Un}),$a=(0,ve.Z)(qa,1),La=$a[0];zt[Ei]="@keyframes ".concat(Vi.getName(Gn)).concat(La)}}function xr(Vi){var Ei=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Vi.forEach(function(qa){Array.isArray(qa)?xr(qa,Ei):qa&&Ei.push(qa)}),Ei}var dn=xr(Array.isArray(Xt)?Xt:[Xt]);if(dn.forEach(function(Vi){var Ei=typeof Vi=="string"&&!Vr?{}:Vi;if(typeof Ei=="string")xt+="".concat(Ei,`
`);else if(Ei._keyframe)_r(Ei);else{var qa=_e.reduce(function($a,La){var to;return(La==null||(to=La.visit)===null||to===void 0?void 0:to.call(La,$a))||$a},Ei);Object.keys(qa).forEach(function($a){var La=qa[$a];if((0,oe.Z)(La)==="object"&&La&&($a!=="animationName"||!La._keyframe)&&!Bs(La)){var to=!1,Ho=$a.trim(),xo=!1;(Vr||ln)&&Gn?Ho.startsWith("@")?to=!0:Ho=fi($a,Gn,T):Vr&&!Gn&&(Ho==="&"||Ho==="")&&(Ho="",xo=!0);var bo=lt(La,nr,{root:xo,injectHash:to,parentSelectors:[].concat((0,k.Z)(Un),[Ho])}),so=(0,ve.Z)(bo,2),Cs=so[0],Ls=so[1];zt=(0,D.Z)((0,D.Z)({},zt),Ls),xt+="".concat(Ho).concat(Cs)}else{var Rs,lu=(Rs=La==null?void 0:La.value)!==null&&Rs!==void 0?Rs:La,ps=$a.replace(/[A-Z]/g,function(zu){return"-".concat(zu.toLowerCase())}),Go=lu;!fn[$a]&&typeof Go=="number"&&Go!==0&&(Go="".concat(Go,"px")),$a==="animationName"&&La!==null&&La!==void 0&&La._keyframe&&(_r(La),Go=La.getName(Gn)),xt+="".concat(ps,":").concat(Go,";")}})}}),!Vr)xt="{".concat(xt,"}");else if(qn&&hn()){var Bn=qn.split(","),zi=Bn[Bn.length-1].trim();xt="@layer ".concat(zi," {").concat(xt,"}"),Bn.length>1&&(xt="@layer ".concat(qn,"{%%%:%}").concat(xt))}return[xt,zt]};function Gt(lt,Xt){return F("".concat(lt.join("%")).concat(Xt))}function Cr(){return null}function Rr(lt,Xt){var nr=lt.token,ur=lt.path,Vr=lt.hashId,ln=lt.layer,Un=m.useContext(ft),Gn=Un.autoClear,qn=Un.mock,oi=Un.defaultCache,T=Un.hashPriority,H=Un.container,_e=Un.ssrInline,ne=Un.transformers,$e=Un.linters,xt=nr._tokenKey,zt=[xt].concat((0,k.Z)(ur)),_r=Jo,xr=Qe("style",zt,function(){var Ei=Xt(),qa=mt(Ei,{hashId:Vr,hashPriority:T,layer:ln,path:ur.join("-"),transformers:ne,linters:$e}),$a=(0,ve.Z)(qa,2),La=$a[0],to=$a[1],Ho=eu(La),xo=Gt(zt,Ho);if(_r){var bo=(0,be.hq)(Ho,xo,{mark:me,prepend:"queue",attachTo:H});bo[Ke]=pt,bo.setAttribute(We,xt),Object.keys(to).forEach(function(so){is.has(so)||(is.add(so),(0,be.hq)(eu(to[so]),"_effect-".concat(so),{mark:me,prepend:"queue",attachTo:H}))})}return[Ho,xt,xo]},function(Ei,qa){var $a=(0,ve.Z)(Ei,3),La=$a[2];(qa||Gn)&&Jo&&(0,be.jL)(La,{mark:me})}),dn=(0,ve.Z)(xr,3),Bn=dn[0],zi=dn[1],Vi=dn[2];return function(Ei){var qa;if(!_e||_r||!oi)qa=m.createElement(Cr,null);else{var $a;qa=m.createElement("style",(0,Oi.Z)({},($a={},(0,$.Z)($a,We,zi),(0,$.Z)($a,me,Vi),$a),{dangerouslySetInnerHTML:{__html:Bn}}))}return m.createElement(m.Fragment,null,qa,Ei)}}function ji(lt){var Xt=Array.from(lt.cache.keys()).filter(function(ur){return ur.startsWith("style%")}),nr="";return Xt.forEach(function(ur){var Vr=_slicedToArray(lt.cache.get(ur)[1],3),ln=Vr[0],Un=Vr[1],Gn=Vr[2];nr+="<style ".concat(ATTR_TOKEN,'="').concat(Un,'" ').concat(ATTR_MARK,'="').concat(Gn,'">').concat(ln,"</style>")}),nr}var Pa=function(){function lt(Xt,nr){(0,Y.Z)(this,lt),(0,$.Z)(this,"name",void 0),(0,$.Z)(this,"style",void 0),(0,$.Z)(this,"_keyframe",!0),this.name=Xt,this.style=nr}return(0,G.Z)(lt,[{key:"getName",value:function(){var nr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return nr?"".concat(nr,"-").concat(this.name):this.name}}]),lt}(),Yt=Pa;function De(lt,Xt){if(lt.length!==Xt.length)return!1;for(var nr=0;nr<lt.length;nr++)if(lt[nr]!==Xt[nr])return!1;return!0}var Me=function(){function lt(){(0,Y.Z)(this,lt),(0,$.Z)(this,"cache",void 0),(0,$.Z)(this,"keys",void 0),(0,$.Z)(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return(0,G.Z)(lt,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(nr){var ur,Vr,ln=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Un={map:this.cache};return nr.forEach(function(Gn){if(!Un)Un=void 0;else{var qn,oi;Un=(qn=Un)===null||qn===void 0||(oi=qn.map)===null||oi===void 0?void 0:oi.get(Gn)}}),(ur=Un)!==null&&ur!==void 0&&ur.value&&ln&&(Un.value[1]=this.cacheCallTimes++),(Vr=Un)===null||Vr===void 0?void 0:Vr.value}},{key:"get",value:function(nr){var ur;return(ur=this.internalGet(nr,!0))===null||ur===void 0?void 0:ur[0]}},{key:"has",value:function(nr){return!!this.internalGet(nr)}},{key:"set",value:function(nr,ur){var Vr=this;if(!this.has(nr)){if(this.size()+1>lt.MAX_CACHE_SIZE+lt.MAX_CACHE_OFFSET){var ln=this.keys.reduce(function(oi,T){var H=(0,ve.Z)(oi,2),_e=H[1];return Vr.internalGet(T)[1]<_e?[T,Vr.internalGet(T)[1]]:oi},[this.keys[0],this.cacheCallTimes]),Un=(0,ve.Z)(ln,1),Gn=Un[0];this.delete(Gn)}this.keys.push(nr)}var qn=this.cache;nr.forEach(function(oi,T){if(T===nr.length-1)qn.set(oi,{value:[ur,Vr.cacheCallTimes++]});else{var H=qn.get(oi);H?H.map||(H.map=new Map):qn.set(oi,{map:new Map}),qn=qn.get(oi).map}})}},{key:"deleteByPath",value:function(nr,ur){var Vr=nr.get(ur[0]);if(ur.length===1){var ln;return Vr.map?nr.set(ur[0],{map:Vr.map}):nr.delete(ur[0]),(ln=Vr.value)===null||ln===void 0?void 0:ln[0]}var Un=this.deleteByPath(Vr.map,ur.slice(1));return(!Vr.map||Vr.map.size===0)&&!Vr.value&&nr.delete(ur[0]),Un}},{key:"delete",value:function(nr){if(this.has(nr))return this.keys=this.keys.filter(function(ur){return!De(ur,nr)}),this.deleteByPath(this.cache,nr)}}]),lt}();(0,$.Z)(Me,"MAX_CACHE_SIZE",20),(0,$.Z)(Me,"MAX_CACHE_OFFSET",5);var ce=0,He=function(){function lt(Xt){(0,Y.Z)(this,lt),(0,$.Z)(this,"derivatives",void 0),(0,$.Z)(this,"id",void 0),this.derivatives=Array.isArray(Xt)?Xt:[Xt],this.id=ce,Xt.length===0&&(0,Ga.Kp)(Xt.length>0,"[Ant Design CSS-in-JS] Theme should have at least one derivative function."),ce+=1}return(0,G.Z)(lt,[{key:"getDerivativeToken",value:function(nr){return this.derivatives.reduce(function(ur,Vr){return Vr(nr,ur)},void 0)}}]),lt}(),Pe=new Me;function Tt(lt){var Xt=Array.isArray(lt)?lt:[lt];return Pe.has(Xt)||Pe.set(Xt,new He(Xt)),Pe.get(Xt)}function Mt(lt){if(typeof lt=="number")return[lt];var Xt=String(lt).split(/\s+/),nr="",ur=0;return Xt.reduce(function(Vr,ln){return ln.includes("(")?(nr+=ln,ur+=ln.split("(").length-1):ln.includes(")")?(nr+=ln,ur-=ln.split(")").length-1,ur===0&&(Vr.push(nr),nr="")):ur>0?nr+=ln:Vr.push(ln),Vr},[])}function $t(lt){return lt.notSplit=!0,lt}var fr={inset:["top","right","bottom","left"],insetBlock:["top","bottom"],insetBlockStart:["top"],insetBlockEnd:["bottom"],insetInline:["left","right"],insetInlineStart:["left"],insetInlineEnd:["right"],marginBlock:["marginTop","marginBottom"],marginBlockStart:["marginTop"],marginBlockEnd:["marginBottom"],marginInline:["marginLeft","marginRight"],marginInlineStart:["marginLeft"],marginInlineEnd:["marginRight"],paddingBlock:["paddingTop","paddingBottom"],paddingBlockStart:["paddingTop"],paddingBlockEnd:["paddingBottom"],paddingInline:["paddingLeft","paddingRight"],paddingInlineStart:["paddingLeft"],paddingInlineEnd:["paddingRight"],borderBlock:$t(["borderTop","borderBottom"]),borderBlockStart:$t(["borderTop"]),borderBlockEnd:$t(["borderBottom"]),borderInline:$t(["borderLeft","borderRight"]),borderInlineStart:$t(["borderLeft"]),borderInlineEnd:$t(["borderRight"]),borderBlockWidth:["borderTopWidth","borderBottomWidth"],borderBlockStartWidth:["borderTopWidth"],borderBlockEndWidth:["borderBottomWidth"],borderInlineWidth:["borderLeftWidth","borderRightWidth"],borderInlineStartWidth:["borderLeftWidth"],borderInlineEndWidth:["borderRightWidth"],borderBlockStyle:["borderTopStyle","borderBottomStyle"],borderBlockStartStyle:["borderTopStyle"],borderBlockEndStyle:["borderBottomStyle"],borderInlineStyle:["borderLeftStyle","borderRightStyle"],borderInlineStartStyle:["borderLeftStyle"],borderInlineEndStyle:["borderRightStyle"],borderBlockColor:["borderTopColor","borderBottomColor"],borderBlockStartColor:["borderTopColor"],borderBlockEndColor:["borderBottomColor"],borderInlineColor:["borderLeftColor","borderRightColor"],borderInlineStartColor:["borderLeftColor"],borderInlineEndColor:["borderRightColor"],borderStartStartRadius:["borderTopLeftRadius"],borderStartEndRadius:["borderTopRightRadius"],borderEndStartRadius:["borderBottomLeftRadius"],borderEndEndRadius:["borderBottomRightRadius"]};function Tr(lt){return{_skip_check_:!0,value:lt}}var Sr={visit:function(Xt){var nr={};return Object.keys(Xt).forEach(function(ur){var Vr=Xt[ur],ln=fr[ur];if(ln&&(typeof Vr=="number"||typeof Vr=="string")){var Un=Mt(Vr);ln.length&&ln.notSplit?ln.forEach(function(Gn){nr[Gn]=Tr(Vr)}):ln.length===1?nr[ln[0]]=Tr(Vr):ln.length===2?ln.forEach(function(Gn,qn){var oi;nr[Gn]=Tr((oi=Un[qn])!==null&&oi!==void 0?oi:Un[0])}):ln.length===4?ln.forEach(function(Gn,qn){var oi,T;nr[Gn]=Tr((oi=(T=Un[qn])!==null&&T!==void 0?T:Un[qn-2])!==null&&oi!==void 0?oi:Un[0])}):nr[ur]=Vr}else nr[ur]=Vr}),nr}},sn=null},89099:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return bn}});var D=I(1413),k=I(97685),m=I(4942),ae=I(91),F=I(67294),K=I(94184),W=I.n(K),Y=(0,F.createContext)({}),G=Y,$=I(71002),xe=I(86500),Fe=I(1350),Ce=2,We=.16,me=.05,Ge=.05,Ke=.15,pt=5,Xe=4,gt=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function ie(gr){var pn=gr.r,Sn=gr.g,Dn=gr.b,ui=(0,xe.py)(pn,Sn,Dn);return{h:ui.h*360,s:ui.s,v:ui.v}}function ft(gr){var pn=gr.r,Sn=gr.g,Dn=gr.b;return"#".concat((0,xe.vq)(pn,Sn,Dn,!1))}function ve(gr,pn,Sn){var Dn=Sn/100,ui={r:(pn.r-gr.r)*Dn+gr.r,g:(pn.g-gr.g)*Dn+gr.g,b:(pn.b-gr.b)*Dn+gr.b};return ui}function Ae(gr,pn,Sn){var Dn;return Math.round(gr.h)>=60&&Math.round(gr.h)<=240?Dn=Sn?Math.round(gr.h)-Ce*pn:Math.round(gr.h)+Ce*pn:Dn=Sn?Math.round(gr.h)+Ce*pn:Math.round(gr.h)-Ce*pn,Dn<0?Dn+=360:Dn>=360&&(Dn-=360),Dn}function Re(gr,pn,Sn){if(gr.h===0&&gr.s===0)return gr.s;var Dn;return Sn?Dn=gr.s-We*pn:pn===Xe?Dn=gr.s+We:Dn=gr.s+me*pn,Dn>1&&(Dn=1),Sn&&pn===pt&&Dn>.1&&(Dn=.1),Dn<.06&&(Dn=.06),Number(Dn.toFixed(2))}function Ye(gr,pn,Sn){var Dn;return Sn?Dn=gr.v+Ge*pn:Dn=gr.v-Ke*pn,Dn>1&&(Dn=1),Number(Dn.toFixed(2))}function at(gr){for(var pn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Sn=[],Dn=(0,Fe.uA)(gr),ui=pt;ui>0;ui-=1){var di=ie(Dn),ca=ft((0,Fe.uA)({h:Ae(di,ui,!0),s:Re(di,ui,!0),v:Ye(di,ui,!0)}));Sn.push(ca)}Sn.push(ft(Dn));for(var Ni=1;Ni<=Xe;Ni+=1){var Wa=ie(Dn),Ba=ft((0,Fe.uA)({h:Ae(Wa,Ni),s:Re(Wa,Ni),v:Ye(Wa,Ni)}));Sn.push(Ba)}return pn.theme==="dark"?gt.map(function(Ia){var an=Ia.index,Ln=Ia.opacity,re=ft(ve((0,Fe.uA)(pn.backgroundColor||"#141414"),(0,Fe.uA)(Sn[an]),Ln*100));return re}):Sn}var ht={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Se={},Qe={};Object.keys(ht).forEach(function(gr){Se[gr]=at(ht[gr]),Se[gr].primary=Se[gr][5],Qe[gr]=at(ht[gr],{theme:"dark",backgroundColor:"#141414"}),Qe[gr].primary=Qe[gr][5]});var oe=Se.red,ue=Se.volcano,be=Se.gold,vt=Se.orange,bt=Se.yellow,Ht=Se.lime,Er=Se.green,Vt=Se.cyan,on=Se.blue,hn=Se.geekblue,gi=Se.purple,Hn=Se.magenta,Dt=Se.grey,Ea=I(80334),Ze=I(44958);function ci(gr,pn){(0,Ea.ZP)(gr,"[@ant-design/icons] ".concat(pn))}function Ci(gr){return(0,$.Z)(gr)==="object"&&typeof gr.name=="string"&&typeof gr.theme=="string"&&((0,$.Z)(gr.icon)==="object"||typeof gr.icon=="function")}function Oi(){var gr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(gr).reduce(function(pn,Sn){var Dn=gr[Sn];switch(Sn){case"class":pn.className=Dn,delete pn.class;break;default:pn[Sn]=Dn}return pn},{})}function ea(gr,pn,Sn){return Sn?F.createElement(gr.tag,(0,D.Z)((0,D.Z)({key:pn},Oi(gr.attrs)),Sn),(gr.children||[]).map(function(Dn,ui){return ea(Dn,"".concat(pn,"-").concat(gr.tag,"-").concat(ui))})):F.createElement(gr.tag,(0,D.Z)({key:pn},Oi(gr.attrs)),(gr.children||[]).map(function(Dn,ui){return ea(Dn,"".concat(pn,"-").concat(gr.tag,"-").concat(ui))}))}function fn(gr){return at(gr)[0]}function tn(gr){return gr?Array.isArray(gr)?gr:[gr]:[]}var da={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"},Ii=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Ai=function(){var pn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ii,Sn=(0,F.useContext)(G),Dn=Sn.csp;(0,F.useEffect)(function(){(0,Ze.hq)(pn,"@ant-design-icons",{prepend:!0,csp:Dn})},[])},Pr=["icon","className","onClick","style","primaryColor","secondaryColor"],nt={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function it(gr){var pn=gr.primaryColor,Sn=gr.secondaryColor;nt.primaryColor=pn,nt.secondaryColor=Sn||fn(pn),nt.calculated=!!Sn}function _t(){return(0,D.Z)({},nt)}var we=function(pn){var Sn=pn.icon,Dn=pn.className,ui=pn.onClick,di=pn.style,ca=pn.primaryColor,Ni=pn.secondaryColor,Wa=(0,ae.Z)(pn,Pr),Ba=nt;if(ca&&(Ba={primaryColor:ca,secondaryColor:Ni||fn(ca)}),Ai(),ci(Ci(Sn),"icon should be icon definiton, but got ".concat(Sn)),!Ci(Sn))return null;var Ia=Sn;return Ia&&typeof Ia.icon=="function"&&(Ia=(0,D.Z)((0,D.Z)({},Ia),{},{icon:Ia.icon(Ba.primaryColor,Ba.secondaryColor)})),ea(Ia.icon,"svg-".concat(Ia.name),(0,D.Z)({className:Dn,onClick:ui,style:di,"data-icon":Ia.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},Wa))};we.displayName="IconReact",we.getTwoToneColors=_t,we.setTwoToneColors=it;var er=we;function $r(gr){var pn=tn(gr),Sn=(0,k.Z)(pn,2),Dn=Sn[0],ui=Sn[1];return er.setTwoToneColors({primaryColor:Dn,secondaryColor:ui})}function Fn(){var gr=er.getTwoToneColors();return gr.calculated?[gr.primaryColor,gr.secondaryColor]:gr.primaryColor}var Qt=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];$r("#1890ff");var Br=F.forwardRef(function(gr,pn){var Sn,Dn=gr.className,ui=gr.icon,di=gr.spin,ca=gr.rotate,Ni=gr.tabIndex,Wa=gr.onClick,Ba=gr.twoToneColor,Ia=(0,ae.Z)(gr,Qt),an=F.useContext(G),Ln=an.prefixCls,re=Ln===void 0?"anticon":Ln,he=an.rootClassName,V=W()(he,re,(Sn={},(0,m.Z)(Sn,"".concat(re,"-").concat(ui.name),!!ui.name),(0,m.Z)(Sn,"".concat(re,"-spin"),!!di||ui.name==="loading"),Sn),Dn),Et=Ni;Et===void 0&&Wa&&(Et=-1);var Bt=ca?{msTransform:"rotate(".concat(ca,"deg)"),transform:"rotate(".concat(ca,"deg)")}:void 0,Le=tn(Ba),St=(0,k.Z)(Le,2),tt=St[0],At=St[1];return F.createElement("span",(0,D.Z)((0,D.Z)({role:"img","aria-label":ui.name},Ia),{},{ref:pn,tabIndex:Et,onClick:Wa,className:V}),F.createElement(er,{icon:ui,primaryColor:tt,secondaryColor:At,style:Bt}))});Br.displayName="AntdIcon",Br.getTwoToneColor=Fn,Br.setTwoToneColor=$r;var bn=Br},58093:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return W}});var D=I(1413),k=I(67294),m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"},ae=m,F=I(89099),K=function(G,$){return k.createElement(F.Z,(0,D.Z)((0,D.Z)({},G),{},{ref:$,icon:ae}))};K.displayName="CopyOutlined";var W=k.forwardRef(K)},38244:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return W}});var D=I(1413),k=I(67294),m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},ae=m,F=I(89099),K=function(G,$){return k.createElement(F.Z,(0,D.Z)((0,D.Z)({},G),{},{ref:$,icon:ae}))};K.displayName="DownloadOutlined";var W=k.forwardRef(K)},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(Ne){try{let G=function(){F||(F=!0,m())},$=function(){try{ae.documentElement.doScroll("left")}catch(xe){return void setTimeout($,50)}G()};var W=G,Y=$,I=(I=document.getElementsByTagName("script"))[I.length-1],fe=I.getAttribute("data-injectcss"),I=I.getAttribute("data-disable-injectsvg");if(!I){var D,k,m,ae,F,K=function(Fe,Ce){Ce.parentNode.insertBefore(Fe,Ce)};if(fe&&!Ne.__iconfont__svg__cssinject__){Ne.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(xe){console&&console.log(xe)}}D=function(){var Fe,Ce=document.createElement("div");Ce.innerHTML=Ne._iconfont_svg_string_3580659,(Ce=Ce.getElementsByTagName("svg")[0])&&(Ce.setAttribute("aria-hidden","true"),Ce.style.position="absolute",Ce.style.width=0,Ce.style.height=0,Ce.style.overflow="hidden",Ce=Ce,(Fe=document.body).firstChild?K(Ce,Fe.firstChild):Fe.appendChild(Ce))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(D,0):(k=function(){document.removeEventListener("DOMContentLoaded",k,!1),D()},document.addEventListener("DOMContentLoaded",k,!1)):document.attachEvent&&(m=D,ae=Ne.document,F=!1,$(),ae.onreadystatechange=function(){ae.readyState=="complete"&&(ae.onreadystatechange=null,G())})}}catch(G){}}(window)},67135:function(Ne,fe,I){(function(D,k){k(fe,I(34789))})(this,function(D,k){"use strict";var m={draw:"crosshair",pointHover:"pointer",pointDrag:"move",lineHover:"pointer",lineDrag:"move",polygonHover:"pointer",polygonDrag:"move"},ae={point:[],line:[],polygon:[],midPoint:[],dashLine:[],text:[]},F="top",K="bottom",W="right",Y="left",G="auto",$=[F,K,W,Y],xe="start",Fe="end",Ce="viewport",We="popper",me=$.reduce(function(E,A){return E.concat([A+"-"+xe,A+"-"+Fe])},[]),Ge=[].concat($,[G]).reduce(function(E,A){return E.concat([A,A+"-"+xe,A+"-"+Fe])},[]),Ke=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function pt(E){return E?(E.nodeName||"").toLowerCase():null}function Xe(E){if(E==null)return window;if(""+E!="[object Window]"){var A=E.ownerDocument;return A&&A.defaultView||window}return E}function gt(E){return E instanceof Xe(E).Element||E instanceof Element}function ie(E){return E instanceof Xe(E).HTMLElement||E instanceof HTMLElement}function ft(E){return typeof ShadowRoot!="undefined"&&(E instanceof Xe(E).ShadowRoot||E instanceof ShadowRoot)}var ve={name:"applyStyles",enabled:!0,phase:"write",fn:function(E){var A=E.state;Object.keys(A.elements).forEach(function(L){var P=A.styles[L]||{},B=A.attributes[L]||{},j=A.elements[L];ie(j)&&pt(j)&&(Object.assign(j.style,P),Object.keys(B).forEach(function(te){var de=B[te];de===!1?j.removeAttribute(te):j.setAttribute(te,de===!0?"":de)}))})},effect:function(E){var A=E.state,L={popper:{position:A.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(A.elements.popper.style,L.popper),A.styles=L,A.elements.arrow&&Object.assign(A.elements.arrow.style,L.arrow),function(){Object.keys(A.elements).forEach(function(P){var B=A.elements[P],j=A.attributes[P]||{},te=Object.keys(A.styles.hasOwnProperty(P)?A.styles[P]:L[P]).reduce(function(de,Oe){return de[Oe]="",de},{});ie(B)&&pt(B)&&(Object.assign(B.style,te),Object.keys(j).forEach(function(de){B.removeAttribute(de)}))})}},requires:["computeStyles"]};function Ae(E){return E.split("-")[0]}var Re=Math.max,Ye=Math.min,at=Math.round;function ht(){var E=navigator.userAgentData;return E!=null&&E.brands?E.brands.map(function(A){return A.brand+"/"+A.version}).join(" "):navigator.userAgent}function Se(){return!/^((?!chrome|android).)*safari/i.test(ht())}function Qe(E,A,L){A===void 0&&(A=!1),L===void 0&&(L=!1);var P=E.getBoundingClientRect(),B=1,j=1;A&&ie(E)&&(B=E.offsetWidth>0&&at(P.width)/E.offsetWidth||1,j=E.offsetHeight>0&&at(P.height)/E.offsetHeight||1);var te=(gt(E)?Xe(E):window).visualViewport,de=!Se()&&L,Oe=(P.left+(de&&te?te.offsetLeft:0))/B,et=(P.top+(de&&te?te.offsetTop:0))/j,Pt=P.width/B,Mr=P.height/j;return{width:Pt,height:Mr,top:et,right:Oe+Pt,bottom:et+Mr,left:Oe,x:Oe,y:et}}function oe(E){var A=Qe(E),L=E.offsetWidth,P=E.offsetHeight;return Math.abs(A.width-L)>1||(L=A.width),Math.abs(A.height-P)>1||(P=A.height),{x:E.offsetLeft,y:E.offsetTop,width:L,height:P}}function ue(E,A){var L=A.getRootNode&&A.getRootNode();if(E.contains(A))return!0;if(L&&ft(L)){var P=A;do{if(P&&E.isSameNode(P))return!0;P=P.parentNode||P.host}while(P)}return!1}function be(E){return Xe(E).getComputedStyle(E)}function vt(E){return["table","td","th"].indexOf(pt(E))>=0}function bt(E){return((gt(E)?E.ownerDocument:E.document)||window.document).documentElement}function Ht(E){return pt(E)==="html"?E:E.assignedSlot||E.parentNode||(ft(E)?E.host:null)||bt(E)}function Er(E){return ie(E)&&be(E).position!=="fixed"?E.offsetParent:null}function Vt(E){for(var A=Xe(E),L=Er(E);L&&vt(L)&&be(L).position==="static";)L=Er(L);return L&&(pt(L)==="html"||pt(L)==="body"&&be(L).position==="static")?A:L||function(P){var B=/firefox/i.test(ht());if(/Trident/i.test(ht())&&ie(P)&&be(P).position==="fixed")return null;var j=Ht(P);for(ft(j)&&(j=j.host);ie(j)&&0>["html","body"].indexOf(pt(j));){var te=be(j);if(te.transform!=="none"||te.perspective!=="none"||te.contain==="paint"||["transform","perspective"].indexOf(te.willChange)!==-1||B&&te.willChange==="filter"||B&&te.filter&&te.filter!=="none")return j;j=j.parentNode}return null}(E)||A}function on(E){return 0>["top","bottom"].indexOf(E)?"y":"x"}function hn(E,A,L){return Re(E,Ye(A,L))}function gi(E){return Object.assign({},{top:0,right:0,bottom:0,left:0},E)}function Hn(E,A){return A.reduce(function(L,P){return L[P]=E,L},{})}var Dt={name:"arrow",enabled:!0,phase:"main",fn:function(E){var A,L=E.state,P=E.name,B=E.options,j=L.elements.arrow,te=L.modifiersData.popperOffsets,de=Ae(L.placement),Oe=on(de),et=[Y,W].indexOf(de)>=0?"height":"width";if(j&&te){var Pt=function(si,Ti){return gi(typeof(si=typeof si=="function"?si(Object.assign({},Ti.rects,{placement:Ti.placement})):si)!="number"?si:Hn(si,$))}(B.padding,L),Mr=oe(j),Qr=Oe==="y"?F:Y,Xn=Oe==="y"?K:W,ii=L.rects.reference[et]+L.rects.reference[Oe]-te[Oe]-L.rects.popper[et],li=te[Oe]-L.rects.reference[Oe],Mn=Vt(j),wn=Mn?Oe==="y"?Mn.clientHeight||0:Mn.clientWidth||0:0,Vn=wn/2-Mr[et]/2+(ii/2-li/2),br=hn(Pt[Qr],Vn,wn-Mr[et]-Pt[Xn]);L.modifiersData[P]=((A={})[Oe]=br,A.centerOffset=br-Vn,A)}},effect:function(E){var A=E.state,L=E.options.element,P=L===void 0?"[data-popper-arrow]":L;P!=null&&(typeof P!="string"||(P=A.elements.popper.querySelector(P)))&&ue(A.elements.popper,P)&&(A.elements.arrow=P)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ea(E){return E.split("-")[1]}var Ze={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ci(E){var A,L=E.popper,P=E.popperRect,B=E.placement,j=E.variation,te=E.offsets,de=E.position,Oe=E.gpuAcceleration,et=E.adaptive,Pt=E.roundOffsets,Mr=E.isFixed,Qr=te.x,Xn=Qr===void 0?0:Qr,ii=te.y,li=ii===void 0?0:ii,Mn=typeof Pt=="function"?Pt({x:Xn,y:li}):{x:Xn,y:li};Xn=Mn.x,li=Mn.y;var wn=te.hasOwnProperty("x"),Vn=te.hasOwnProperty("y"),br=Y,si=F,Ti=window;if(et){var ka=Vt(L),So="clientHeight",Mo="clientWidth";ka===Xe(L)&&be(ka=bt(L)).position!=="static"&&de==="absolute"&&(So="scrollHeight",Mo="scrollWidth"),(B===F||(B===Y||B===W)&&j===Fe)&&(si=K,li-=(Mr&&ka===Ti&&Ti.visualViewport?Ti.visualViewport.height:ka[So])-P.height,li*=Oe?1:-1),(B===Y||(B===F||B===K)&&j===Fe)&&(br=W,Xn-=(Mr&&ka===Ti&&Ti.visualViewport?Ti.visualViewport.width:ka[Mo])-P.width,Xn*=Oe?1:-1)}var rs,pu=Object.assign({position:de},et&&Ze),Co=Pt===!0?function(Qo){var bu=Qo.y,o=window.devicePixelRatio||1;return{x:at(Qo.x*o)/o||0,y:at(bu*o)/o||0}}({x:Xn,y:li}):{x:Xn,y:li};return Xn=Co.x,li=Co.y,Object.assign({},pu,Oe?((rs={})[si]=Vn?"0":"",rs[br]=wn?"0":"",rs.transform=(Ti.devicePixelRatio||1)>1?"translate3d("+Xn+"px, "+li+"px, 0)":"translate("+Xn+"px, "+li+"px)",rs):((A={})[si]=Vn?li+"px":"",A[br]=wn?Xn+"px":"",A.transform="",A))}var Ci={passive:!0},Oi={left:"right",right:"left",bottom:"top",top:"bottom"};function ea(E){return E.replace(/left|right|bottom|top/g,function(A){return Oi[A]})}var fn={start:"end",end:"start"};function tn(E){return E.replace(/start|end/g,function(A){return fn[A]})}function da(E){var A=Xe(E);return{scrollLeft:A.pageXOffset,scrollTop:A.pageYOffset}}function Ii(E){return Qe(bt(E)).left+da(E).scrollLeft}function Ai(E){var A=be(E);return/auto|scroll|overlay|hidden/.test(A.overflow+A.overflowY+A.overflowX)}function Pr(E){return 0>["html","body","#document"].indexOf(pt(E))?ie(E)&&Ai(E)?E:Pr(Ht(E)):E.ownerDocument.body}function nt(E,A){var L;A===void 0&&(A=[]);var P=Pr(E),B=P===((L=E.ownerDocument)==null?void 0:L.body),j=Xe(P),te=B?[j].concat(j.visualViewport||[],Ai(P)?P:[]):P,de=A.concat(te);return B?de:de.concat(nt(Ht(te)))}function it(E){return Object.assign({},E,{left:E.x,top:E.y,right:E.x+E.width,bottom:E.y+E.height})}function _t(E,A,L){return A===Ce?it(function(P,B){var j=Xe(P),te=bt(P),de=j.visualViewport,Oe=te.clientWidth,et=te.clientHeight,Pt=0,Mr=0;if(de){Oe=de.width,et=de.height;var Qr=Se();(Qr||!Qr&&B==="fixed")&&(Pt=de.offsetLeft,Mr=de.offsetTop)}return{width:Oe,height:et,x:Pt+Ii(P),y:Mr}}(E,L)):gt(A)?function(P,B){var j=Qe(P,!1,B==="fixed");return j.top=j.top+P.clientTop,j.left=j.left+P.clientLeft,j.bottom=j.top+P.clientHeight,j.right=j.left+P.clientWidth,j.width=P.clientWidth,j.height=P.clientHeight,j.x=j.left,j.y=j.top,j}(A,L):it(function(P){var B,j=bt(P),te=da(P),de=(B=P.ownerDocument)==null?void 0:B.body,Oe=Re(j.scrollWidth,j.clientWidth,de?de.scrollWidth:0,de?de.clientWidth:0),et=Re(j.scrollHeight,j.clientHeight,de?de.scrollHeight:0,de?de.clientHeight:0),Pt=-te.scrollLeft+Ii(P),Mr=-te.scrollTop;return be(de||j).direction==="rtl"&&(Pt+=Re(j.clientWidth,de?de.clientWidth:0)-Oe),{width:Oe,height:et,x:Pt,y:Mr}}(bt(E)))}function we(E,A,L,P){var B=A==="clippingParents"?function(de){var Oe=nt(Ht(de)),et=["absolute","fixed"].indexOf(be(de).position)>=0&&ie(de)?Vt(de):de;return gt(et)?Oe.filter(function(Pt){return gt(Pt)&&ue(Pt,et)&&pt(Pt)!=="body"}):[]}(E):[].concat(A),j=[].concat(B,[L]),te=j.reduce(function(de,Oe){var et=_t(E,Oe,P);return de.top=Re(et.top,de.top),de.right=Ye(et.right,de.right),de.bottom=Ye(et.bottom,de.bottom),de.left=Re(et.left,de.left),de},_t(E,j[0],P));return te.width=te.right-te.left,te.height=te.bottom-te.top,te.x=te.left,te.y=te.top,te}function er(E){var A,L=E.reference,P=E.element,B=E.placement,j=B?Ae(B):null,te=B?Ea(B):null,de=L.x+L.width/2-P.width/2,Oe=L.y+L.height/2-P.height/2;switch(j){case F:A={x:de,y:L.y-P.height};break;case K:A={x:de,y:L.y+L.height};break;case W:A={x:L.x+L.width,y:Oe};break;case Y:A={x:L.x-P.width,y:Oe};break;default:A={x:L.x,y:L.y}}var et=j?on(j):null;if(et!=null){var Pt=et==="y"?"height":"width";switch(te){case xe:A[et]=A[et]-(L[Pt]/2-P[Pt]/2);break;case Fe:A[et]=A[et]+(L[Pt]/2-P[Pt]/2)}}return A}function $r(E,A){A===void 0&&(A={});var L=A.placement,P=L===void 0?E.placement:L,B=A.strategy,j=B===void 0?E.strategy:B,te=A.boundary,de=te===void 0?"clippingParents":te,Oe=A.rootBoundary,et=Oe===void 0?Ce:Oe,Pt=A.elementContext,Mr=Pt===void 0?We:Pt,Qr=A.altBoundary,Xn=Qr!==void 0&&Qr,ii=A.padding,li=ii===void 0?0:ii,Mn=gi(typeof li!="number"?li:Hn(li,$)),wn=E.rects.popper,Vn=E.elements[Xn?Mr===We?"reference":We:Mr],br=we(gt(Vn)?Vn:Vn.contextElement||bt(E.elements.popper),de,et,j),si=Qe(E.elements.reference),Ti=er({reference:si,element:wn,strategy:"absolute",placement:P}),ka=it(Object.assign({},wn,Ti)),So=Mr===We?ka:si,Mo={top:br.top-So.top+Mn.top,bottom:So.bottom-br.bottom+Mn.bottom,left:br.left-So.left+Mn.left,right:So.right-br.right+Mn.right},rs=E.modifiersData.offset;if(Mr===We&&rs){var pu=rs[P];Object.keys(Mo).forEach(function(Co){var Qo=0>[W,K].indexOf(Co)?-1:1;Mo[Co]+=pu[0>[F,K].indexOf(Co)?"x":"y"]*Qo})}return Mo}function Fn(E,A){A===void 0&&(A={});var L=A.boundary,P=A.rootBoundary,B=A.padding,j=A.flipVariations,te=A.allowedAutoPlacements,de=te===void 0?Ge:te,Oe=Ea(A.placement),et=Oe?j?me:me.filter(function(Qr){return Ea(Qr)===Oe}):$,Pt=et.filter(function(Qr){return de.indexOf(Qr)>=0});Pt.length===0&&(Pt=et);var Mr=Pt.reduce(function(Qr,Xn){return Qr[Xn]=$r(E,{placement:Xn,boundary:L,rootBoundary:P,padding:B})[Ae(Xn)],Qr},{});return Object.keys(Mr).sort(function(Qr,Xn){return Mr[Qr]-Mr[Xn]})}var Qt={name:"flip",enabled:!0,phase:"main",fn:function(E){var A=E.state,L=E.options,P=E.name;if(!A.modifiersData[P]._skip){for(var B=L.mainAxis,j=B===void 0||B,te=L.altAxis,de=te===void 0||te,Oe=L.fallbackPlacements,et=L.padding,Pt=L.boundary,Mr=L.rootBoundary,Qr=L.altBoundary,Xn=L.flipVariations,ii=Xn===void 0||Xn,li=L.allowedAutoPlacements,Mn=A.options.placement,wn=Ae(Mn),Vn=Oe||(wn===Mn||!ii?[ea(Mn)]:function(Q){if(Ae(Q)===G)return[];var pe=ea(Q);return[tn(Q),pe,tn(pe)]}(Mn)),br=[Mn].concat(Vn).reduce(function(Q,pe){return Q.concat(Ae(pe)===G?Fn(A,{placement:pe,boundary:Pt,rootBoundary:Mr,padding:et,flipVariations:ii,allowedAutoPlacements:li}):pe)},[]),si=A.rects.reference,Ti=A.rects.popper,ka=new Map,So=!0,Mo=br[0],rs=0;br.length>rs;rs++){var pu=br[rs],Co=Ae(pu),Qo=Ea(pu)===xe,bu=[F,K].indexOf(Co)>=0,o=bu?"width":"height",u=$r(A,{placement:pu,boundary:Pt,rootBoundary:Mr,altBoundary:Qr,padding:et}),c=bu?Qo?W:Y:Qo?K:F;si[o]>Ti[o]&&(c=ea(c));var y=ea(c),C=[];if(j&&C.push(0>=u[Co]),de&&C.push(0>=u[c],0>=u[y]),C.every(function(Q){return Q})){Mo=pu,So=!1;break}ka.set(pu,C)}if(So)for(var R=function(Q){var pe=br.find(function(Ie){var ze=ka.get(Ie);if(ze)return ze.slice(0,Q).every(function(qe){return qe})});if(pe)return Mo=pe,"break"},z=ii?3:1;z>0&&R(z)!=="break";z--);A.placement!==Mo&&(A.modifiersData[P]._skip=!0,A.placement=Mo,A.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Br(E,A,L){return L===void 0&&(L={x:0,y:0}),{top:E.top-A.height-L.y,right:E.right-A.width+L.x,bottom:E.bottom-A.height+L.y,left:E.left-A.width-L.x}}function bn(E){return[F,W,K,Y].some(function(A){return E[A]>=0})}var gr={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(E){var A=E.state,L=E.name,P=E.options.offset,B=P===void 0?[0,0]:P,j=Ge.reduce(function(Oe,et){return Oe[et]=function(Pt,Mr,Qr){var Xn=Ae(Pt),ii=0>[Y,F].indexOf(Xn)?1:-1,li=typeof Qr=="function"?Qr(Object.assign({},Mr,{placement:Pt})):Qr,Mn=li[0],wn=li[1];return Mn=Mn||0,wn=(wn||0)*ii,0>[Y,W].indexOf(Xn)?{x:Mn,y:wn}:{x:wn,y:Mn}}(et,A.rects,B),Oe},{}),te=j[A.placement],de=te.y;A.modifiersData.popperOffsets!=null&&(A.modifiersData.popperOffsets.x+=te.x,A.modifiersData.popperOffsets.y+=de),A.modifiersData[L]=j}},pn={name:"preventOverflow",enabled:!0,phase:"main",fn:function(E){var A=E.state,L=E.options,P=E.name,B=L.mainAxis,j=B===void 0||B,te=L.altAxis,de=te!==void 0&&te,Oe=L.tether,et=Oe===void 0||Oe,Pt=L.tetherOffset,Mr=Pt===void 0?0:Pt,Qr=$r(A,{boundary:L.boundary,rootBoundary:L.rootBoundary,padding:L.padding,altBoundary:L.altBoundary}),Xn=Ae(A.placement),ii=Ea(A.placement),li=!ii,Mn=on(Xn),wn=Mn==="x"?"y":"x",Vn=A.modifiersData.popperOffsets,br=A.rects.reference,si=A.rects.popper,Ti=typeof Mr=="function"?Mr(Object.assign({},A.rects,{placement:A.placement})):Mr,ka=typeof Ti=="number"?{mainAxis:Ti,altAxis:Ti}:Object.assign({mainAxis:0,altAxis:0},Ti),So=A.modifiersData.offset?A.modifiersData.offset[A.placement]:null,Mo={x:0,y:0};if(Vn){if(j){var rs,pu=Mn==="y"?F:Y,Co=Mn==="y"?K:W,Qo=Mn==="y"?"height":"width",bu=Vn[Mn],o=bu+Qr[pu],u=bu-Qr[Co],c=et?-si[Qo]/2:0,y=ii===xe?br[Qo]:si[Qo],C=ii===xe?-si[Qo]:-br[Qo],R=A.elements.arrow,z=et&&R?oe(R):{width:0,height:0},Q=A.modifiersData["arrow#persistent"]?A.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},pe=Q[pu],Ie=Q[Co],ze=hn(0,br[Qo],z[Qo]),qe=li?br[Qo]/2-c-ze-pe-ka.mainAxis:y-ze-pe-ka.mainAxis,ut=li?-br[Qo]/2+c+ze+Ie+ka.mainAxis:C+ze+Ie+ka.mainAxis,wt=A.elements.arrow&&Vt(A.elements.arrow),or=(rs=So==null?void 0:So[Mn])!=null?rs:0,sr=bu+ut-or,mr=hn(et?Ye(o,bu+qe-or-(wt?Mn==="y"?wt.clientTop||0:wt.clientLeft||0:0)):o,bu,et?Re(u,sr):u);Vn[Mn]=mr,Mo[Mn]=mr-bu}if(de){var yr,rn=Vn[wn],_n=wn==="y"?"height":"width",kn=rn+Qr[Mn==="x"?F:Y],Nn=rn-Qr[Mn==="x"?K:W],pi=[F,Y].indexOf(Xn)!==-1,Xr=(yr=So==null?void 0:So[wn])!=null?yr:0,ua=pi?kn:rn-br[_n]-si[_n]-Xr+ka.altAxis,Ir=pi?rn+br[_n]+si[_n]-Xr-ka.altAxis:Nn,vn=et&&pi?function($i,ki,eo){var Ha=hn($i,ki,eo);return Ha>eo?eo:Ha}(ua,rn,Ir):hn(et?ua:kn,rn,et?Ir:Nn);Vn[wn]=vn,Mo[wn]=vn-rn}A.modifiersData[P]=Mo}},requiresIfExists:["offset"]};function Sn(E,A,L){L===void 0&&(L=!1);var P,B,j=ie(A),te=ie(A)&&function(Mr){var Qr=Mr.getBoundingClientRect(),Xn=at(Qr.width)/Mr.offsetWidth||1,ii=at(Qr.height)/Mr.offsetHeight||1;return Xn!==1||ii!==1}(A),de=bt(A),Oe=Qe(E,te,L),et={scrollLeft:0,scrollTop:0},Pt={x:0,y:0};return(j||!j&&!L)&&((pt(A)!=="body"||Ai(de))&&(et=(P=A)!==Xe(P)&&ie(P)?{scrollLeft:(B=P).scrollLeft,scrollTop:B.scrollTop}:da(P)),ie(A)?((Pt=Qe(A,!0)).x+=A.clientLeft,Pt.y+=A.clientTop):de&&(Pt.x=Ii(de))),{x:Oe.left+et.scrollLeft-Pt.x,y:Oe.top+et.scrollTop-Pt.y,width:Oe.width,height:Oe.height}}function Dn(E){var A=new Map,L=new Set,P=[];function B(j){L.add(j.name),[].concat(j.requires||[],j.requiresIfExists||[]).forEach(function(te){if(!L.has(te)){var de=A.get(te);de&&B(de)}}),P.push(j)}return E.forEach(function(j){A.set(j.name,j)}),E.forEach(function(j){L.has(j.name)||B(j)}),P}var ui={placement:"bottom",modifiers:[],strategy:"absolute"};function di(){for(var E=arguments.length,A=Array(E),L=0;E>L;L++)A[L]=arguments[L];return!A.some(function(P){return!(P&&typeof P.getBoundingClientRect=="function")})}function ca(E){E===void 0&&(E={});var A=E.defaultModifiers,L=A===void 0?[]:A,P=E.defaultOptions,B=P===void 0?ui:P;return function(j,te,de){de===void 0&&(de=B);var Oe,et,Pt={placement:"bottom",orderedModifiers:[],options:Object.assign({},ui,B),modifiersData:{},elements:{reference:j,popper:te},attributes:{},styles:{}},Mr=[],Qr=!1,Xn={state:Pt,setOptions:function(li){var Mn=typeof li=="function"?li(Pt.options):li;ii(),Pt.options=Object.assign({},B,Pt.options,Mn),Pt.scrollParents={reference:gt(j)?nt(j):j.contextElement?nt(j.contextElement):[],popper:nt(te)};var wn,Vn,br=function(si){var Ti=Dn(si);return Ke.reduce(function(ka,So){return ka.concat(Ti.filter(function(Mo){return Mo.phase===So}))},[])}((wn=[].concat(L,Pt.options.modifiers),Vn=wn.reduce(function(si,Ti){var ka=si[Ti.name];return si[Ti.name]=ka?Object.assign({},ka,Ti,{options:Object.assign({},ka.options,Ti.options),data:Object.assign({},ka.data,Ti.data)}):Ti,si},{}),Object.keys(Vn).map(function(si){return Vn[si]})));return Pt.orderedModifiers=br.filter(function(si){return si.enabled}),Pt.orderedModifiers.forEach(function(si){var Ti=si.options,ka=si.effect;if(typeof ka=="function"){var So=ka({state:Pt,name:si.name,instance:Xn,options:Ti===void 0?{}:Ti});Mr.push(So||function(){})}}),Xn.update()},forceUpdate:function(){if(!Qr){var li=Pt.elements,Mn=li.reference,wn=li.popper;if(di(Mn,wn)){Pt.rects={reference:Sn(Mn,Vt(wn),Pt.options.strategy==="fixed"),popper:oe(wn)},Pt.reset=!1,Pt.placement=Pt.options.placement,Pt.orderedModifiers.forEach(function(ka){return Pt.modifiersData[ka.name]=Object.assign({},ka.data)});for(var Vn=0;Pt.orderedModifiers.length>Vn;Vn++)if(Pt.reset!==!0){var br=Pt.orderedModifiers[Vn],si=br.fn,Ti=br.options;typeof si=="function"&&(Pt=si({state:Pt,options:Ti===void 0?{}:Ti,name:br.name,instance:Xn})||Pt)}else Pt.reset=!1,Vn=-1}}},update:(Oe=function(){return new Promise(function(li){Xn.forceUpdate(),li(Pt)})},function(){return et||(et=new Promise(function(li){Promise.resolve().then(function(){et=void 0,li(Oe())})})),et}),destroy:function(){ii(),Qr=!0}};if(!di(j,te))return Xn;function ii(){Mr.forEach(function(li){return li()}),Mr=[]}return Xn.setOptions(de).then(function(li){!Qr&&de.onFirstUpdate&&de.onFirstUpdate(li)}),Xn}}var Ni=ca({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(E){var A=E.state,L=E.instance,P=E.options,B=P.scroll,j=B===void 0||B,te=P.resize,de=te===void 0||te,Oe=Xe(A.elements.popper),et=[].concat(A.scrollParents.reference,A.scrollParents.popper);return j&&et.forEach(function(Pt){Pt.addEventListener("scroll",L.update,Ci)}),de&&Oe.addEventListener("resize",L.update,Ci),function(){j&&et.forEach(function(Pt){Pt.removeEventListener("scroll",L.update,Ci)}),de&&Oe.removeEventListener("resize",L.update,Ci)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(E){var A=E.state;A.modifiersData[E.name]=er({reference:A.rects.reference,element:A.rects.popper,strategy:"absolute",placement:A.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(E){var A=E.state,L=E.options,P=L.gpuAcceleration,B=P===void 0||P,j=L.adaptive,te=j===void 0||j,de=L.roundOffsets,Oe=de===void 0||de,et={placement:Ae(A.placement),variation:Ea(A.placement),popper:A.elements.popper,popperRect:A.rects.popper,gpuAcceleration:B,isFixed:A.options.strategy==="fixed"};A.modifiersData.popperOffsets!=null&&(A.styles.popper=Object.assign({},A.styles.popper,ci(Object.assign({},et,{offsets:A.modifiersData.popperOffsets,position:A.options.strategy,adaptive:te,roundOffsets:Oe})))),A.modifiersData.arrow!=null&&(A.styles.arrow=Object.assign({},A.styles.arrow,ci(Object.assign({},et,{offsets:A.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:Oe})))),A.attributes.popper=Object.assign({},A.attributes.popper,{"data-popper-placement":A.placement})},data:{}},ve,gr,Qt,pn,Dt,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(E){var A=E.state,L=E.name,P=A.rects.reference,B=A.rects.popper,j=A.modifiersData.preventOverflow,te=$r(A,{elementContext:"reference"}),de=$r(A,{altBoundary:!0}),Oe=Br(te,P),et=Br(de,B,j),Pt=bn(Oe),Mr=bn(et);A.modifiersData[L]={referenceClippingOffsets:Oe,popperEscapeOffsets:et,isReferenceHidden:Pt,hasPopperEscaped:Mr},A.attributes.popper=Object.assign({},A.attributes.popper,{"data-popper-reference-hidden":Pt,"data-popper-escaped":Mr})}}]}),Wa="tippy-content",Ba="tippy-arrow",Ia="tippy-svg-arrow",an={passive:!0,capture:!0},Ln=function(){return document.body};function re(E,A,L){if(Array.isArray(E)){var P=E[A];return P==null?Array.isArray(L)?L[A]:L:P}return E}function he(E,A){var L={}.toString.call(E);return L.indexOf("[object")===0&&L.indexOf(A+"]")>-1}function V(E,A){return typeof E=="function"?E.apply(void 0,A):E}function Et(E,A){return A===0?E:function(P){clearTimeout(L),L=setTimeout(function(){E(P)},A)};var L}function Bt(E){return[].concat(E)}function Le(E,A){E.indexOf(A)===-1&&E.push(A)}function St(E){return[].slice.call(E)}function tt(E){return Object.keys(E).reduce(function(A,L){return E[L]!==void 0&&(A[L]=E[L]),A},{})}function At(){return document.createElement("div")}function tr(E){return["Element","Fragment"].some(function(A){return he(E,A)})}function en(E){return he(E,"MouseEvent")}function Kr(E){return tr(E)?[E]:function(A){return he(A,"NodeList")}(E)?St(E):Array.isArray(E)?E:St(document.querySelectorAll(E))}function Ft(E,A){E.forEach(function(L){L&&(L.style.transitionDuration=A+"ms")})}function rr(E,A){E.forEach(function(L){L&&L.setAttribute("data-state",A)})}function ot(E){var A,L=Bt(E)[0];return L!=null&&(A=L.ownerDocument)!=null&&A.body?L.ownerDocument:document}function Li(E,A,L){var P=A+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(B){E[P](B,L)})}function Hr(E,A){for(var L=A;L;){var P;if(E.contains(L))return!0;L=L.getRootNode==null||(P=L.getRootNode())==null?void 0:P.host}return!1}var _i={isTouch:!1},vi=0;function It(){_i.isTouch||(_i.isTouch=!0,window.performance&&document.addEventListener("mousemove",Yr))}function Yr(){var E=performance.now();20>E-vi&&(_i.isTouch=!1,document.removeEventListener("mousemove",Yr)),vi=E}function Dr(){var E,A=document.activeElement;(E=A)&&E._tippy&&E._tippy.reference===E&&A.blur&&!A._tippy.state.isVisible&&A.blur()}var Jn=typeof window!="undefined"&&typeof document!="undefined"&&!!window.msCrypto,Kt=Object.assign({appendTo:Ln,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),hr=Object.keys(Kt);function Fr(E){var A=(E.plugins||[]).reduce(function(L,P){var B,j=P.name;return j&&(L[j]=E[j]!==void 0?E[j]:(B=Kt[j])!=null?B:P.defaultValue),L},{});return Object.assign({},E,A)}function qr(E,A){var L=Object.assign({},A,{content:V(A.content,[E])},A.ignoreAttributes?{}:function(P,B){return(B?Object.keys(Fr(Object.assign({},Kt,{plugins:B}))):hr).reduce(function(j,te){var de=(P.getAttribute("data-tippy-"+te)||"").trim();if(!de)return j;if(te==="content")j[te]=de;else try{j[te]=JSON.parse(de)}catch(Oe){j[te]=de}return j},{})}(E,A.plugins));return L.aria=Object.assign({},Kt.aria,L.aria),L.aria={expanded:L.aria.expanded==="auto"?A.interactive:L.aria.expanded,content:L.aria.content==="auto"?A.interactive?null:"describedby":L.aria.content},L}function An(E,A){E.innerHTML=A}function Ui(E){var A=At();return E===!0?A.className=Ba:(A.className=Ia,tr(E)?A.appendChild(E):An(A,E)),A}function fa(E,A){tr(A.content)?(An(E,""),E.appendChild(A.content)):typeof A.content!="function"&&(A.allowHTML?An(E,A.content):E.textContent=A.content)}function Wi(E){var A=E.firstElementChild,L=St(A.children);return{box:A,content:L.find(function(P){return P.classList.contains(Wa)}),arrow:L.find(function(P){return P.classList.contains(Ba)||P.classList.contains(Ia)}),backdrop:L.find(function(P){return P.classList.contains("tippy-backdrop")})}}function ct(E){var A=At(),L=At();L.className="tippy-box",L.setAttribute("data-state","hidden"),L.setAttribute("tabindex","-1");var P=At();function B(j,te){var de=Wi(A),Oe=de.box,et=de.content,Pt=de.arrow;te.theme?Oe.setAttribute("data-theme",te.theme):Oe.removeAttribute("data-theme"),typeof te.animation=="string"?Oe.setAttribute("data-animation",te.animation):Oe.removeAttribute("data-animation"),te.inertia?Oe.setAttribute("data-inertia",""):Oe.removeAttribute("data-inertia"),Oe.style.maxWidth=typeof te.maxWidth=="number"?te.maxWidth+"px":te.maxWidth,te.role?Oe.setAttribute("role",te.role):Oe.removeAttribute("role"),j.content===te.content&&j.allowHTML===te.allowHTML||fa(et,E.props),te.arrow?Pt?j.arrow!==te.arrow&&(Oe.removeChild(Pt),Oe.appendChild(Ui(te.arrow))):Oe.appendChild(Ui(te.arrow)):Pt&&Oe.removeChild(Pt)}return P.className=Wa,P.setAttribute("data-state","hidden"),fa(P,E.props),A.appendChild(L),L.appendChild(P),B(E.props,E.props),{popper:A,onUpdate:B}}ct.$$tippy=!0;var qi=1,Na=[],To=[];function ao(E,A){var L,P,B,j,te,de,Oe,et,Pt=qr(E,Object.assign({},Kt,Fr(tt(A)))),Mr=!1,Qr=!1,Xn=!1,ii=!1,li=[],Mn=Et(yr,Pt.interactiveDebounce),wn=qi++,Vn=(et=Pt.plugins).filter(function(vn,$i){return et.indexOf(vn)===$i}),br={id:wn,reference:E,popper:At(),popperInstance:null,props:Pt,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:Vn,clearDelayTimeouts:function(){clearTimeout(L),clearTimeout(P),cancelAnimationFrame(B)},setProps:function(vn){if(!br.state.isDestroyed){y("onBeforeUpdate",[br,vn]),sr();var $i=br.props,ki=qr(E,Object.assign({},$i,tt(vn),{ignoreAttributes:!0}));br.props=ki,or(),$i.interactiveDebounce!==ki.interactiveDebounce&&(z(),Mn=Et(yr,ki.interactiveDebounce)),$i.triggerTarget&&!ki.triggerTarget?Bt($i.triggerTarget).forEach(function(eo){eo.removeAttribute("aria-expanded")}):ki.triggerTarget&&E.removeAttribute("aria-expanded"),R(),c(),ka&&ka($i,ki),br.popperInstance&&(Nn(),Xr().forEach(function(eo){requestAnimationFrame(eo._tippy.popperInstance.forceUpdate)})),y("onAfterUpdate",[br,vn])}},setContent:function(vn){br.setProps({content:vn})},show:function(){var vn=br.state.isVisible,$i=br.state.isDestroyed,ki=!br.state.isEnabled,eo=_i.isTouch&&!br.props.touch,Ha=re(br.props.duration,0,Kt.duration);if(!(vn||$i||ki||eo)&&!Qo().hasAttribute("disabled")&&(y("onShow",[br],!1),br.props.onShow(br)!==!1)){if(br.state.isVisible=!0,Co()&&(Ti.style.visibility="visible"),c(),ze(),br.state.isMounted||(Ti.style.transition="none"),Co()){var Ta=o();Ft([Ta.box,Ta.content],0)}de=function(){var Ro;if(br.state.isVisible&&!ii){if(ii=!0,Ti.style.transition=br.props.moveTransition,Co()&&br.props.animation){var No=o(),vs=No.box,oo=No.content;Ft([vs,oo],Ha),rr([vs,oo],"visible")}C(),R(),Le(To,br),(Ro=br.popperInstance)==null||Ro.forceUpdate(),y("onMount",[br]),br.props.animation&&Co()&&function(Qs,Lu){ut(Qs,Lu)}(Ha,function(){br.state.isShown=!0,y("onShown",[br])})}},function(){var Ro,No=br.props.appendTo,vs=Qo();Ro=br.props.interactive&&No===Ln||No==="parent"?vs.parentNode:V(No,[vs]),Ro.contains(Ti)||Ro.appendChild(Ti),br.state.isMounted=!0,Nn()}()}},hide:function(){var vn=!br.state.isVisible,$i=br.state.isDestroyed,ki=!br.state.isEnabled,eo=re(br.props.duration,1,Kt.duration);if(!(vn||$i||ki)&&(y("onHide",[br],!1),br.props.onHide(br)!==!1)){if(br.state.isVisible=!1,br.state.isShown=!1,ii=!1,Mr=!1,Co()&&(Ti.style.visibility="hidden"),z(),qe(),c(!0),Co()){var Ha=o(),Ta=Ha.box,Ro=Ha.content;br.props.animation&&(Ft([Ta,Ro],eo),rr([Ta,Ro],"hidden"))}C(),R(),br.props.animation?Co()&&function(No,vs){ut(No,function(){!br.state.isVisible&&Ti.parentNode&&Ti.parentNode.contains(Ti)&&vs()})}(eo,br.unmount):br.unmount()}},hideWithInteractivity:function(vn){bu().addEventListener("mousemove",Mn),Le(Na,Mn),Mn(vn)},enable:function(){br.state.isEnabled=!0},disable:function(){br.hide(),br.state.isEnabled=!1},unmount:function(){br.state.isVisible&&br.hide(),br.state.isMounted&&(pi(),Xr().forEach(function(vn){vn._tippy.unmount()}),Ti.parentNode&&Ti.parentNode.removeChild(Ti),To=To.filter(function(vn){return vn!==br}),br.state.isMounted=!1,y("onHidden",[br]))},destroy:function(){br.state.isDestroyed||(br.clearDelayTimeouts(),br.unmount(),sr(),delete E._tippy,br.state.isDestroyed=!0,y("onDestroy",[br]))}};if(!Pt.render)return br;var si=Pt.render(br),Ti=si.popper,ka=si.onUpdate;Ti.setAttribute("data-tippy-root",""),Ti.id="tippy-"+br.id,br.popper=Ti,E._tippy=br,Ti._tippy=br;var So=Vn.map(function(vn){return vn.fn(br)}),Mo=E.hasAttribute("aria-expanded");return or(),R(),c(),y("onCreate",[br]),Pt.showOnCreate&&ua(),Ti.addEventListener("mouseenter",function(){br.props.interactive&&br.state.isVisible&&br.clearDelayTimeouts()}),Ti.addEventListener("mouseleave",function(){br.props.interactive&&br.props.trigger.indexOf("mouseenter")>=0&&bu().addEventListener("mousemove",Mn)}),br;function rs(){var vn=br.props.touch;return Array.isArray(vn)?vn:[vn,0]}function pu(){return rs()[0]==="hold"}function Co(){var vn;return!((vn=br.props.render)==null||!vn.$$tippy)}function Qo(){return Oe||E}function bu(){var vn=Qo().parentNode;return vn?ot(vn):document}function o(){return Wi(Ti)}function u(vn){return br.state.isMounted&&!br.state.isVisible||_i.isTouch||j&&j.type==="focus"?0:re(br.props.delay,vn?0:1,Kt.delay)}function c(vn){vn===void 0&&(vn=!1),Ti.style.pointerEvents=br.props.interactive&&!vn?"":"none",Ti.style.zIndex=""+br.props.zIndex}function y(vn,$i,ki){var eo;ki===void 0&&(ki=!0),So.forEach(function(Ha){Ha[vn]&&Ha[vn].apply(Ha,$i)}),ki&&(eo=br.props)[vn].apply(eo,$i)}function C(){var vn=br.props.aria;if(vn.content){var $i="aria-"+vn.content,ki=Ti.id;Bt(br.props.triggerTarget||E).forEach(function(eo){var Ha=eo.getAttribute($i);if(br.state.isVisible)eo.setAttribute($i,Ha?Ha+" "+ki:ki);else{var Ta=Ha&&Ha.replace(ki,"").trim();Ta?eo.setAttribute($i,Ta):eo.removeAttribute($i)}})}}function R(){!Mo&&br.props.aria.expanded&&Bt(br.props.triggerTarget||E).forEach(function(vn){br.props.interactive?vn.setAttribute("aria-expanded",br.state.isVisible&&vn===Qo()?"true":"false"):vn.removeAttribute("aria-expanded")})}function z(){bu().removeEventListener("mousemove",Mn),Na=Na.filter(function(vn){return vn!==Mn})}function Q(vn){if(!_i.isTouch||!Xn&&vn.type!=="mousedown"){var $i=vn.composedPath&&vn.composedPath()[0]||vn.target;if(!br.props.interactive||!Hr(Ti,$i)){if(Bt(br.props.triggerTarget||E).some(function(ki){return Hr(ki,$i)})){if(_i.isTouch||br.state.isVisible&&br.props.trigger.indexOf("click")>=0)return}else y("onClickOutside",[br,vn]);br.props.hideOnClick===!0&&(br.clearDelayTimeouts(),br.hide(),Qr=!0,setTimeout(function(){Qr=!1}),br.state.isMounted||qe())}}}function pe(){Xn=!0}function Ie(){Xn=!1}function ze(){var vn=bu();vn.addEventListener("mousedown",Q,!0),vn.addEventListener("touchend",Q,an),vn.addEventListener("touchstart",Ie,an),vn.addEventListener("touchmove",pe,an)}function qe(){var vn=bu();vn.removeEventListener("mousedown",Q,!0),vn.removeEventListener("touchend",Q,an),vn.removeEventListener("touchstart",Ie,an),vn.removeEventListener("touchmove",pe,an)}function ut(vn,$i){var ki=o().box;function eo(Ha){Ha.target===ki&&(Li(ki,"remove",eo),$i())}if(vn===0)return $i();Li(ki,"remove",te),Li(ki,"add",eo),te=eo}function wt(vn,$i,ki){ki===void 0&&(ki=!1),Bt(br.props.triggerTarget||E).forEach(function(eo){eo.addEventListener(vn,$i,ki),li.push({node:eo,eventType:vn,handler:$i,options:ki})})}function or(){var vn;pu()&&(wt("touchstart",mr,{passive:!0}),wt("touchend",rn,{passive:!0})),(vn=br.props.trigger,vn.split(/\s+/).filter(Boolean)).forEach(function($i){if($i!=="manual")switch(wt($i,mr),$i){case"mouseenter":wt("mouseleave",rn);break;case"focus":wt(Jn?"focusout":"blur",_n);break;case"focusin":wt("focusout",_n)}})}function sr(){li.forEach(function(vn){vn.node.removeEventListener(vn.eventType,vn.handler,vn.options)}),li=[]}function mr(vn){var $i,ki=!1;if(br.state.isEnabled&&!kn(vn)&&!Qr){var eo=(($i=j)==null?void 0:$i.type)==="focus";j=vn,Oe=vn.currentTarget,R(),!br.state.isVisible&&en(vn)&&Na.forEach(function(Ha){return Ha(vn)}),vn.type==="click"&&(0>br.props.trigger.indexOf("mouseenter")||Mr)&&br.props.hideOnClick!==!1&&br.state.isVisible?ki=!0:ua(vn),vn.type==="click"&&(Mr=!ki),ki&&!eo&&Ir(vn)}}function yr(vn){var $i=vn.target,ki=Qo().contains($i)||Ti.contains($i);if(vn.type!=="mousemove"||!ki){var eo=Xr().concat(Ti).map(function(Ha){var Ta,Ro=(Ta=Ha._tippy.popperInstance)==null?void 0:Ta.state;return Ro?{popperRect:Ha.getBoundingClientRect(),popperState:Ro,props:Pt}:null}).filter(Boolean);(function(Ha,Ta){var Ro=Ta.clientX,No=Ta.clientY;return Ha.every(function(vs){var oo=vs.popperRect,Qs=vs.popperState,Lu=vs.props.interactiveBorder,cl=Qs.placement.split("-")[0],qu=Qs.modifiersData.offset;return!qu||oo.top-No+(cl==="bottom"?qu.top.y:0)>Lu||No-oo.bottom-(cl==="top"?qu.bottom.y:0)>Lu||oo.left-Ro+(cl==="right"?qu.left.x:0)>Lu||Ro-oo.right-(cl==="left"?qu.right.x:0)>Lu})})(eo,vn)&&(z(),Ir(vn))}}function rn(vn){kn(vn)||br.props.trigger.indexOf("click")>=0&&Mr||(br.props.interactive?br.hideWithInteractivity(vn):Ir(vn))}function _n(vn){0>br.props.trigger.indexOf("focusin")&&vn.target!==Qo()||br.props.interactive&&vn.relatedTarget&&Ti.contains(vn.relatedTarget)||Ir(vn)}function kn(vn){return!!_i.isTouch&&pu()!==vn.type.indexOf("touch")>=0}function Nn(){pi();var vn=br.props,$i=vn.popperOptions,ki=vn.placement,eo=vn.offset,Ha=vn.getReferenceClientRect,Ta=vn.moveTransition,Ro=Co()?Wi(Ti).arrow:null,No=Ha?{getBoundingClientRect:Ha,contextElement:Ha.contextElement||Qo()}:E,vs={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Qs){var Lu=Qs.state;if(Co()){var cl=o().box;["placement","reference-hidden","escaped"].forEach(function(qu){qu==="placement"?cl.setAttribute("data-placement",Lu.placement):Lu.attributes.popper["data-popper-"+qu]?cl.setAttribute("data-"+qu,""):cl.removeAttribute("data-"+qu)}),Lu.attributes.popper={}}}},oo=[{name:"offset",options:{offset:eo}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Ta}},vs];Co()&&Ro&&oo.push({name:"arrow",options:{element:Ro,padding:3}}),oo.push.apply(oo,($i==null?void 0:$i.modifiers)||[]),br.popperInstance=Ni(No,Ti,Object.assign({},$i,{placement:ki,onFirstUpdate:de,modifiers:oo}))}function pi(){br.popperInstance&&(br.popperInstance.destroy(),br.popperInstance=null)}function Xr(){return St(Ti.querySelectorAll("[data-tippy-root]"))}function ua(vn){br.clearDelayTimeouts(),vn&&y("onTrigger",[br,vn]),ze();var $i=u(!0),ki=rs(),eo=ki[1];_i.isTouch&&ki[0]==="hold"&&eo&&($i=eo),$i?L=setTimeout(function(){br.show()},$i):br.show()}function Ir(vn){if(br.clearDelayTimeouts(),y("onUntrigger",[br,vn]),br.state.isVisible){if(0>br.props.trigger.indexOf("mouseenter")||0>br.props.trigger.indexOf("click")||0>["mouseleave","mousemove"].indexOf(vn.type)||!Mr){var $i=u(!1);$i?P=setTimeout(function(){br.state.isVisible&&br.hide()},$i):B=requestAnimationFrame(function(){br.hide()})}}else qe()}}function Ga(E,A){A===void 0&&(A={});var L=Kt.plugins.concat(A.plugins||[]);document.addEventListener("touchstart",It,an),window.addEventListener("blur",Dr);var P=Object.assign({},A,{plugins:L}),B=Kr(E).reduce(function(j,te){var de=te&&ao(te,P);return de&&j.push(de),j},[]);return tr(E)?B[0]:B}Ga.defaultProps=Kt,Ga.setDefaultProps=function(E){Object.keys(E).forEach(function(A){Kt[A]=E[A]})},Ga.currentInput=_i,Object.assign({},ve,{effect:function(E){var A=E.state,L={popper:{position:A.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(A.elements.popper.style,L.popper),A.styles=L,A.elements.arrow&&Object.assign(A.elements.arrow.style,L.arrow)}});var Ko={clientX:0,clientY:0},ws=[];function Fo(E){Ko={clientX:E.clientX,clientY:E.clientY}}var su={name:"followCursor",defaultValue:!1,fn:function(E){var A=E.reference,L=ot(E.props.triggerTarget||A),P=!1,B=!1,j=!0,te=E.props;function de(){return E.props.followCursor==="initial"&&E.state.isVisible}function Oe(){L.addEventListener("mousemove",Mr)}function et(){L.removeEventListener("mousemove",Mr)}function Pt(){P=!0,E.setProps({getReferenceClientRect:null}),P=!1}function Mr(ii){var li=!ii.target||A.contains(ii.target),Mn=E.props.followCursor,wn=ii.clientX,Vn=ii.clientY,br=A.getBoundingClientRect(),si=wn-br.left,Ti=Vn-br.top;!li&&E.props.interactive||E.setProps({getReferenceClientRect:function(){var ka=A.getBoundingClientRect(),So=wn,Mo=Vn;Mn==="initial"&&(So=ka.left+si,Mo=ka.top+Ti);var rs=Mn==="horizontal"?ka.top:Mo,pu=Mn==="vertical"?ka.right:So,Co=Mn==="horizontal"?ka.bottom:Mo,Qo=Mn==="vertical"?ka.left:So;return{width:pu-Qo,height:Co-rs,top:rs,right:pu,bottom:Co,left:Qo}}})}function Qr(){E.props.followCursor&&(ws.push({instance:E,doc:L}),function(ii){ii.addEventListener("mousemove",Fo)}(L))}function Xn(){(ws=ws.filter(function(ii){return ii.instance!==E})).filter(function(ii){return ii.doc===L}).length===0&&function(ii){ii.removeEventListener("mousemove",Fo)}(L)}return{onCreate:Qr,onDestroy:Xn,onBeforeUpdate:function(){te=E.props},onAfterUpdate:function(ii,li){var Mn=li.followCursor;P||Mn!==void 0&&te.followCursor!==Mn&&(Xn(),Mn?(Qr(),!E.state.isMounted||B||de()||Oe()):(et(),Pt()))},onMount:function(){E.props.followCursor&&!B&&(j&&(Mr(Ko),j=!1),de()||Oe())},onTrigger:function(ii,li){en(li)&&(Ko={clientX:li.clientX,clientY:li.clientY}),B=li.type==="focus"},onHidden:function(){E.props.followCursor&&(Pt(),et(),j=!0)}}}};Ga.setDefaultProps({render:ct});var zo,ns,ls,_o,Po,Ss,Wu={showTotalDistance:!1,showDashDistance:!0,showWhen:["normal","active"],format:function(E){return 1e3>E?+E.toFixed(2)+"m":+(E/1e3).toFixed(2)+"km"}},$s={showWhen:["normal","active"],format:function(E){return E>1e6?"".concat(+(E/1e6).toFixed(2),"km\xB2"):"".concat(+E.toFixed(2),"m\xB2")}},uu={maxSize:100},Jo={remove:["del","backspace"],revert:["command+z","ctrl+z"],redo:["command+shift+z","ctrl+shift+z"]},ms={allowHTML:!0,followCursor:!0,placement:"bottom-start",offset:[-10,20],plugins:[su],trigger:"manual",hideOnClick:!1,theme:"light"},eu={data:"drawData",pointAdsorbPixel:12,lineAdsorbPixel:10};function Bs(E,A){var L=Object.keys(E);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(E);A&&(P=P.filter(function(B){return Object.getOwnPropertyDescriptor(E,B).enumerable})),L.push.apply(L,P)}return L}function fi(E){for(var A=1;arguments.length>A;A++){var L=arguments[A]!=null?arguments[A]:{};A%2?Bs(Object(L),!0).forEach(function(P){Gt(E,P,L[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(L)):Bs(Object(L)).forEach(function(P){Object.defineProperty(E,P,Object.getOwnPropertyDescriptor(L,P))})}return E}function is(E,A){if(!(E instanceof A))throw new TypeError("Cannot call a class as a function")}function ku(E,A){for(var L=0;A.length>L;L++){var P=A[L];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(E,$t(P.key),P)}}function mt(E,A,L){return A&&ku(E.prototype,A),L&&ku(E,L),Object.defineProperty(E,"prototype",{writable:!1}),E}function Gt(E,A,L){return(A=$t(A))in E?Object.defineProperty(E,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):E[A]=L,E}function Cr(E,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function");E.prototype=Object.create(A&&A.prototype,{constructor:{value:E,writable:!0,configurable:!0}}),Object.defineProperty(E,"prototype",{writable:!1}),A&&ji(E,A)}function Rr(E){return Rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(A){return A.__proto__||Object.getPrototypeOf(A)},Rr(E)}function ji(E,A){return ji=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(L,P){return L.__proto__=P,L},ji(E,A)}function Pa(E){if(E===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E}function Yt(E,A){if(A&&(typeof A=="object"||typeof A=="function"))return A;if(A!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pa(E)}function De(E){var A=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(L){return!1}}();return function(){var L,P=Rr(E);if(A){var B=Rr(this).constructor;L=Reflect.construct(P,arguments,B)}else L=P.apply(this,arguments);return Yt(this,L)}}function Me(E,A){for(;!Object.prototype.hasOwnProperty.call(E,A)&&(E=Rr(E))!==null;);return E}function ce(){return ce=typeof Reflect!="undefined"&&Reflect.get?Reflect.get.bind():function(E,A,L){var P=Me(E,A);if(P){var B=Object.getOwnPropertyDescriptor(P,A);return B.get?B.get.call(3>arguments.length?E:L):B.value}},ce.apply(this,arguments)}function He(E,A){return function(L){if(Array.isArray(L))return L}(E)||function(L,P){var B=L==null?null:typeof Symbol!="undefined"&&L[Symbol.iterator]||L["@@iterator"];if(B!=null){var j,te,de,Oe,et=[],Pt=!0,Mr=!1;try{if(de=(B=B.call(L)).next,P===0){if(Object(B)!==B)return;Pt=!1}else for(;!(Pt=(j=de.call(B)).done)&&(et.push(j.value),et.length!==P);Pt=!0);}catch(Qr){Mr=!0,te=Qr}finally{try{if(!Pt&&B.return!=null&&(Oe=B.return(),Object(Oe)!==Oe))return}finally{if(Mr)throw te}}return et}}(E,A)||Tt(E,A)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Pe(E){return function(A){if(Array.isArray(A))return Mt(A)}(E)||function(A){if(typeof Symbol!="undefined"&&A[Symbol.iterator]!=null||A["@@iterator"]!=null)return Array.from(A)}(E)||Tt(E)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Tt(E,A){if(E){if(typeof E=="string")return Mt(E,A);var L=Object.prototype.toString.call(E).slice(8,-1);return L==="Object"&&E.constructor&&(L=E.constructor.name),L==="Map"||L==="Set"?Array.from(E):L==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L)?Mt(E,A):void 0}}function Mt(E,A){(A==null||A>E.length)&&(A=E.length);for(var L=0,P=Array(A);A>L;L++)P[L]=E[L];return P}function $t(E){var A=function(L,P){if(typeof L!="object"||L===null)return L;var B=L[Symbol.toPrimitive];if(B!==void 0){var j=B.call(L,P||"default");if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(P==="string"?String:Number)(L)}(E,"string");return typeof A=="symbol"?A:A+""}(zo=D.DrawEvent||(D.DrawEvent={})).Init="init",zo.Destroy="destroy",zo.Enable="enable",zo.Disable="disable",zo.Add="add",zo.Edit="edit",zo.Remove="remove",zo.Clear="clear",zo.Change="change",zo.DragStart="dragStart",zo.Dragging="dragging",zo.DragEnd="dragEnd",zo.AddNode="addNode",zo.RemoveNode="removeNode",(ns=D.SourceEvent||(D.SourceEvent={})).Change="change",ns.Update="update",(ls=D.RenderEvent||(D.RenderEvent={})).Click="click",ls.UnClick="unclick",ls.Dragstart="dragstart",ls.Mousemove="mousemove",ls.Mouseout="mouseout",ls.Dragging="dragging",ls.Dragend="dragend",ls.DblClick="dblClick",ls.Contextmenu="contextmenu",(_o=D.LayerEvent||(D.LayerEvent={})).Mousedown="mousedown",_o.Mouseup="mouseup",_o.Click="click",_o.UnClick="unclick",_o.Dblclick="dblclick",_o.Mousemove="mousemove",_o.Mouseover="mouseover",_o.Mouseenter="mouseenter",_o.Mouseleave="mouseleave",_o.Mouseout="mouseout",_o.Contextmenu="contextmenu",(Po=D.SceneEvent||(D.SceneEvent={})).Loaded="loaded",Po.MapMove="mapmove",Po.MoveStart="movestart",Po.MoveEnd="moveend",Po.ZoomChange="zoomchange",Po.ZoomStart="zoomstart",Po.ZoomEnd="zoomend",Po.Click="click",Po.Dblclick="dblclick",Po.Mousemove="mousemove",Po.Mousewheel="mousewheel",Po.Mouseover="mouseover",Po.Mouseout="mouseout",Po.Mouseup="mouseup",Po.Mousedown="mousedown",Po.Contextmenu="contextmenu",Po.Dragstart="dragstart",Po.Dragging="dragging",Po.Dragend="dragend",(Ss=D.ControlEvent||(D.ControlEvent={})).DrawChange="drawchange",Ss.DataChange="datachange";var fr=63710088e-1,Tr={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260511392e-6,inches:39.37*fr,kilometers:6371.0088,kilometres:6371.0088,meters:fr,metres:fr,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:fr/1852,radians:1,yards:6967335223679999e-9},Sr={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function sn(E,A,L){L===void 0&&(L={});var P={type:"Feature"};return(L.id===0||L.id)&&(P.id=L.id),L.bbox&&(P.bbox=L.bbox),P.properties=A||{},P.geometry=E,P}function lt(E,A,L){if(L===void 0&&(L={}),!E)throw Error("coordinates is required");if(!Array.isArray(E))throw Error("coordinates must be an Array");if(2>E.length)throw Error("coordinates must be at least 2 numbers long");if(!H(E[0])||!H(E[1]))throw Error("coordinates must contain numbers");return sn({type:"Point",coordinates:E},A,L)}function Xt(E,A,L){L===void 0&&(L={});for(var P=0,B=E;B.length>P;P++){var j=B[P];if(4>j.length)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var te=0;j[j.length-1].length>te;te++)if(j[j.length-1][te]!==j[0][te])throw Error("First and last Position are not equivalent.")}return sn({type:"Polygon",coordinates:E},A,L)}function nr(E,A,L){if(L===void 0&&(L={}),2>E.length)throw Error("coordinates must be an array of two or more positions");return sn({type:"LineString",coordinates:E},A,L)}function ur(E,A){A===void 0&&(A={});var L={type:"FeatureCollection"};return A.id&&(L.id=A.id),A.bbox&&(L.bbox=A.bbox),L.features=E,L}function Vr(E,A,L){return L===void 0&&(L={}),sn({type:"MultiLineString",coordinates:E},A,L)}function ln(E,A,L){return L===void 0&&(L={}),sn({type:"MultiPoint",coordinates:E},A,L)}function Un(E,A,L){return L===void 0&&(L={}),sn({type:"MultiPolygon",coordinates:E},A,L)}function Gn(E,A){A===void 0&&(A="kilometers");var L=Tr[A];if(!L)throw Error(A+" units is invalid");return E*L}function qn(E,A){A===void 0&&(A="kilometers");var L=Tr[A];if(!L)throw Error(A+" units is invalid");return E/L}function oi(E){return 180*(E%(2*Math.PI))/Math.PI}function T(E){return E%360*Math.PI/180}function H(E){return!isNaN(E)&&E!==null&&!Array.isArray(E)}function _e(E){return!!E&&E.constructor===Object}var ne=Object.freeze({__proto__:null,earthRadius:fr,factors:Tr,unitsFactors:{centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/fr,yards:1.0936133},areaFactors:Sr,feature:sn,geometry:function(E,A,L){switch(E){case"Point":return lt(A).geometry;case"LineString":return nr(A).geometry;case"Polygon":return Xt(A).geometry;case"MultiPoint":return ln(A).geometry;case"MultiLineString":return Vr(A).geometry;case"MultiPolygon":return Un(A).geometry;default:throw Error(E+" is invalid")}},point:lt,points:function(E,A,L){return L===void 0&&(L={}),ur(E.map(function(P){return lt(P,A)}),L)},polygon:Xt,polygons:function(E,A,L){return L===void 0&&(L={}),ur(E.map(function(P){return Xt(P,A)}),L)},lineString:nr,lineStrings:function(E,A,L){return L===void 0&&(L={}),ur(E.map(function(P){return nr(P,A)}),L)},featureCollection:ur,multiLineString:Vr,multiPoint:ln,multiPolygon:Un,geometryCollection:function(E,A,L){return L===void 0&&(L={}),sn({type:"GeometryCollection",geometries:E},A,L)},round:function(E,A){if(A===void 0&&(A=0),A&&A<0)throw Error("precision must be a positive number");var L=Math.pow(10,A||0);return Math.round(E*L)/L},radiansToLength:Gn,lengthToRadians:qn,lengthToDegrees:function(E,A){return oi(qn(E,A))},bearingToAzimuth:function(E){var A=E%360;return 0>A&&(A+=360),A},radiansToDegrees:oi,degreesToRadians:T,convertLength:function(E,A,L){if(A===void 0&&(A="kilometers"),L===void 0&&(L="kilometers"),E<0)throw Error("length must be a positive number");return Gn(qn(E,A),L)},convertArea:function(E,A,L){if(A===void 0&&(A="meters"),L===void 0&&(L="kilometers"),E<0)throw Error("area must be a positive number");var P=Sr[A];if(!P)throw Error("invalid original units");var B=Sr[L];if(!B)throw Error("invalid final units");return E/P*B},isNumber:H,isObject:_e,validateBBox:function(E){if(!E)throw Error("bbox is required");if(!Array.isArray(E))throw Error("bbox must be an Array");if(E.length!==4&&E.length!==6)throw Error("bbox must be an Array of 4 or 6 numbers");E.forEach(function(A){if(!H(A))throw Error("bbox must only contain numbers")})},validateId:function(E){if(!E)throw Error("id is required");if(["string","number"].indexOf(typeof E)===-1)throw Error("id must be a number or a string")}});function $e(E,A,L){if(E!==null)for(var P,B,j,te,de,Oe,et,Pt,Mr=0,Qr=0,Xn=E.type,ii=Xn==="FeatureCollection",li=Xn==="Feature",Mn=ii?E.features.length:1,wn=0;Mn>wn;wn++){de=(Pt=!!(et=ii?E.features[wn].geometry:li?E.geometry:E)&&et.type==="GeometryCollection")?et.geometries.length:1;for(var Vn=0;de>Vn;Vn++){var br=0,si=0;if((te=Pt?et.geometries[Vn]:et)!==null){Oe=te.coordinates;var Ti=te.type;switch(Mr=!L||Ti!=="Polygon"&&Ti!=="MultiPolygon"?0:1,Ti){case null:break;case"Point":if(A(Oe,Qr,wn,br,si)===!1)return!1;Qr++,br++;break;case"LineString":case"MultiPoint":for(P=0;Oe.length>P;P++){if(A(Oe[P],Qr,wn,br,si)===!1)return!1;Qr++,Ti==="MultiPoint"&&br++}Ti==="LineString"&&br++;break;case"Polygon":case"MultiLineString":for(P=0;Oe.length>P;P++){for(B=0;Oe[P].length-Mr>B;B++){if(A(Oe[P][B],Qr,wn,br,si)===!1)return!1;Qr++}Ti==="MultiLineString"&&br++,Ti==="Polygon"&&si++}Ti==="Polygon"&&br++;break;case"MultiPolygon":for(P=0;Oe.length>P;P++){for(si=0,B=0;Oe[P].length>B;B++){for(j=0;Oe[P][B].length-Mr>j;j++){if(A(Oe[P][B][j],Qr,wn,br,si)===!1)return!1;Qr++}si++}br++}break;case"GeometryCollection":for(P=0;te.geometries.length>P;P++)if($e(te.geometries[P],A,L)===!1)return!1;break;default:throw Error("Unknown Geometry Type")}}}}}function xt(E,A){var L;switch(E.type){case"FeatureCollection":for(L=0;E.features.length>L&&A(E.features[L].properties,L)!==!1;L++);break;case"Feature":A(E.properties,0)}}function zt(E,A){if(E.type==="Feature")A(E,0);else if(E.type==="FeatureCollection")for(var L=0;E.features.length>L&&A(E.features[L],L)!==!1;L++);}function _r(E){var A=[];return $e(E,function(L){A.push(L)}),A}function xr(E,A){var L,P,B,j,te,de,Oe,et,Pt,Mr,Qr=0,Xn=E.type==="FeatureCollection",ii=E.type==="Feature",li=Xn?E.features.length:1;for(L=0;li>L;L++){for(et=Xn?E.features[L].properties:ii?E.properties:{},Pt=Xn?E.features[L].bbox:ii?E.bbox:void 0,Mr=Xn?E.features[L].id:ii?E.id:void 0,te=(Oe=!!(de=Xn?E.features[L].geometry:ii?E.geometry:E)&&de.type==="GeometryCollection")?de.geometries.length:1,B=0;te>B;B++)if((j=Oe?de.geometries[B]:de)!==null)switch(j.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(A(j,Qr,et,Pt,Mr)===!1)return!1;break;case"GeometryCollection":for(P=0;j.geometries.length>P;P++)if(A(j.geometries[P],Qr,et,Pt,Mr)===!1)return!1;break;default:throw Error("Unknown Geometry Type")}else if(A(null,Qr,et,Pt,Mr)===!1)return!1;Qr++}}function dn(E,A,L){var P=L;return xr(E,function(B,j,te,de,Oe){P=j===0&&L===void 0?B:A(P,B,j,te,de,Oe)}),P}function Bn(E,A){xr(E,function(L,P,B,j,te){var de,Oe=L===null?null:L.type;switch(Oe){case null:case"Point":case"LineString":case"Polygon":return A(sn(L,B,{bbox:j,id:te}),P,0)!==!1&&void 0}switch(Oe){case"MultiPoint":de="Point";break;case"MultiLineString":de="LineString";break;case"MultiPolygon":de="Polygon"}for(var et=0;L.coordinates.length>et;et++)if(A(sn({type:de,coordinates:L.coordinates[et]},B),P,et)===!1)return!1})}function zi(E,A){Bn(E,function(L,P,B){var j=0;if(L.geometry){var te=L.geometry.type;if(te!=="Point"&&te!=="MultiPoint"){var de,Oe=0,et=0,Pt=0;return $e(L,function(Mr,Qr,Xn,ii,li){if(de===void 0||P>Oe||ii>et||li>Pt)return de=Mr,Oe=P,et=ii,Pt=li,void(j=0);var Mn=nr([de,Mr],L.properties);if(A(Mn,P,B,li,j)===!1)return!1;j++,de=Mr})!==!1&&void 0}}})}function Vi(E,A,L){var P=L,B=!1;return zi(E,function(j,te,de,Oe,et){P=B===!1&&L===void 0?j:A(P,j,te,de,Oe,et),B=!0}),P}function Ei(E,A){if(!E)throw Error("geojson is required");Bn(E,function(L,P,B){if(L.geometry!==null){var j=L.geometry.coordinates;switch(L.geometry.type){case"LineString":if(A(L,P,B,0,0)===!1)return!1;break;case"Polygon":for(var te=0;j.length>te;te++)if(A(nr(j[te],L.properties),P,B,te)===!1)return!1}}})}var qa=Object.freeze({__proto__:null,coordAll:_r,coordEach:$e,coordReduce:function(E,A,L,P){var B=L;return $e(E,function(j,te,de,Oe,et){B=te===0&&L===void 0?j:A(B,j,te,de,Oe,et)},P),B},featureEach:zt,featureReduce:function(E,A,L){var P=L;return zt(E,function(B,j){P=j===0&&L===void 0?B:A(P,B,j)}),P},findPoint:function(E,A){if(!_e(A=A||{}))throw Error("options is invalid");var L,P=A.featureIndex||0,B=A.multiFeatureIndex||0,j=A.geometryIndex||0,te=A.coordIndex||0,de=A.properties;switch(E.type){case"FeatureCollection":0>P&&(P=E.features.length+P),de=de||E.features[P].properties,L=E.features[P].geometry;break;case"Feature":de=de||E.properties,L=E.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=E;break;default:throw Error("geojson is invalid")}if(L===null)return null;var Oe=L.coordinates;switch(L.type){case"Point":return lt(Oe,de,A);case"MultiPoint":return 0>B&&(B=Oe.length+B),lt(Oe[B],de,A);case"LineString":return 0>te&&(te=Oe.length+te),lt(Oe[te],de,A);case"Polygon":return 0>j&&(j=Oe.length+j),0>te&&(te=Oe[j].length+te),lt(Oe[j][te],de,A);case"MultiLineString":return 0>B&&(B=Oe.length+B),0>te&&(te=Oe[B].length+te),lt(Oe[B][te],de,A);case"MultiPolygon":return 0>B&&(B=Oe.length+B),0>j&&(j=Oe[B].length+j),0>te&&(te=Oe[B][j].length-te),lt(Oe[B][j][te],de,A)}throw Error("geojson is invalid")},findSegment:function(E,A){if(!_e(A=A||{}))throw Error("options is invalid");var L,P=A.featureIndex||0,B=A.multiFeatureIndex||0,j=A.geometryIndex||0,te=A.segmentIndex||0,de=A.properties;switch(E.type){case"FeatureCollection":0>P&&(P=E.features.length+P),de=de||E.features[P].properties,L=E.features[P].geometry;break;case"Feature":de=de||E.properties,L=E.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=E;break;default:throw Error("geojson is invalid")}if(L===null)return null;var Oe=L.coordinates;switch(L.type){case"Point":case"MultiPoint":return null;case"LineString":return 0>te&&(te=Oe.length+te-1),nr([Oe[te],Oe[te+1]],de,A);case"Polygon":return 0>j&&(j=Oe.length+j),0>te&&(te=Oe[j].length+te-1),nr([Oe[j][te],Oe[j][te+1]],de,A);case"MultiLineString":return 0>B&&(B=Oe.length+B),0>te&&(te=Oe[B].length+te-1),nr([Oe[B][te],Oe[B][te+1]],de,A);case"MultiPolygon":return 0>B&&(B=Oe.length+B),0>j&&(j=Oe[B].length+j),0>te&&(te=Oe[B][j].length-te-1),nr([Oe[B][j][te],Oe[B][j][te+1]],de,A)}throw Error("geojson is invalid")},flattenEach:Bn,flattenReduce:function(E,A,L){var P=L;return Bn(E,function(B,j,te){P=j===0&&te===0&&L===void 0?B:A(P,B,j,te)}),P},geomEach:xr,geomReduce:dn,lineEach:Ei,lineReduce:function(E,A,L){var P=L;return Ei(E,function(B,j,te,de){P=j===0&&L===void 0?B:A(P,B,j,te,de)}),P},propEach:xt,propReduce:function(E,A,L){var P=L;return xt(E,function(B,j){P=j===0&&L===void 0?B:A(P,B,j)}),P},segmentEach:zi,segmentReduce:Vi});function $a(E){var A=[1/0,1/0,-1/0,-1/0];return $e(E,function(L){A[0]>L[0]&&(A[0]=L[0]),A[1]>L[1]&&(A[1]=L[1]),L[0]>A[2]&&(A[2]=L[0]),L[1]>A[3]&&(A[3]=L[1])}),A}$a.default=$a;var La=Object.freeze({__proto__:null,default:$a});function to(E){if(!E)throw Error("coord is required");if(!Array.isArray(E)){if(E.type==="Feature"&&E.geometry!==null&&E.geometry.type==="Point")return E.geometry.coordinates;if(E.type==="Point")return E.coordinates}if(Array.isArray(E)&&E.length>=2&&!Array.isArray(E[0])&&!Array.isArray(E[1]))return E;throw Error("coord must be GeoJSON Point or an Array of numbers")}function Ho(E){if(Array.isArray(E))return E;if(E.type==="Feature"){if(E.geometry!==null)return E.geometry.coordinates}else if(E.coordinates)return E.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function xo(E){return E.type==="Feature"?E.geometry:E}function bo(E,A){return E.type==="FeatureCollection"?"FeatureCollection":E.type==="GeometryCollection"?"GeometryCollection":E.type==="Feature"&&E.geometry!==null?E.geometry.type:E.type}function so(E,A,L,P,B){Cs(E,A,L||0,P||E.length-1,B||Rs)}function Cs(E,A,L,P,B){for(;P>L;){if(P-L>600){var j=P-L+1,te=A-L+1,de=Math.log(j),Oe=.5*Math.exp(2*de/3),et=.5*Math.sqrt(de*Oe*(j-Oe)/j)*(0>te-j/2?-1:1);Cs(E,A,Math.max(L,Math.floor(A-te*Oe/j+et)),Math.min(P,Math.floor(A+(j-te)*Oe/j+et)),B)}var Pt=E[A],Mr=L,Qr=P;for(Ls(E,L,A),B(E[P],Pt)>0&&Ls(E,L,P);Qr>Mr;){for(Ls(E,Mr,Qr),Mr++,Qr--;0>B(E[Mr],Pt);)Mr++;for(;B(E[Qr],Pt)>0;)Qr--}B(E[L],Pt)===0?Ls(E,L,Qr):Ls(E,++Qr,P),Qr>A||(L=Qr+1),A>Qr||(P=Qr-1)}}function Ls(E,A,L){var P=E[A];E[A]=E[L],E[L]=P}function Rs(E,A){return A>E?-1:E>A?1:0}function lu(E,A,L){if(!L)return A.indexOf(E);for(let P=0;A.length>P;P++)if(L(E,A[P]))return P;return-1}function ps(E,A){Go(E,0,E.children.length,A,E)}function Go(E,A,L,P,B){B||(B=es(null)),B.minX=1/0,B.minY=1/0,B.maxX=-1/0,B.maxY=-1/0;for(let j=A;L>j;j++){const te=E.children[j];zu(B,E.leaf?P(te):te)}return B}function zu(E,A){return E.minX=Math.min(E.minX,A.minX),E.minY=Math.min(E.minY,A.minY),E.maxX=Math.max(E.maxX,A.maxX),E.maxY=Math.max(E.maxY,A.maxY),E}function al(E,A){return E.minX-A.minX}function ou(E,A){return E.minY-A.minY}function Xu(E){return(E.maxX-E.minX)*(E.maxY-E.minY)}function Nu(E){return E.maxX-E.minX+(E.maxY-E.minY)}function ks(E,A){const L=Math.max(E.minX,A.minX),P=Math.max(E.minY,A.minY),B=Math.min(E.maxX,A.maxX),j=Math.min(E.maxY,A.maxY);return Math.max(0,B-L)*Math.max(0,j-P)}function Sc(E,A){return!(E.minX>A.minX||E.minY>A.minY||A.maxX>E.maxX||A.maxY>E.maxY)}function vl(E,A){return!(A.minX>E.maxX||A.minY>E.maxY||E.minX>A.maxX||E.minY>A.maxY)}function es(E){return{children:E,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Al(E,A,L,P,B){const j=[A,L];for(;j.length;){if(P>=(L=j.pop())-(A=j.pop()))continue;const te=A+Math.ceil((L-A)/P/2)*P;so(E,te,A,L,B),j.push(A,te,te,L)}}var tf=Object.freeze({__proto__:null,default:class{constructor(E=9){this._maxEntries=Math.max(4,E),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(E){let A=this.data;const L=[];if(!vl(E,A))return L;const P=this.toBBox,B=[];for(;A;){for(let j=0;A.children.length>j;j++){const te=A.children[j],de=A.leaf?P(te):te;vl(E,de)&&(A.leaf?L.push(te):Sc(E,de)?this._all(te,L):B.push(te))}A=B.pop()}return L}collides(E){let A=this.data;if(!vl(E,A))return!1;const L=[];for(;A;){for(let P=0;A.children.length>P;P++){const B=A.children[P],j=A.leaf?this.toBBox(B):B;if(vl(E,j)){if(A.leaf||Sc(E,j))return!0;L.push(B)}}A=L.pop()}return!1}load(E){if(!E||!E.length)return this;if(this._minEntries>E.length){for(let L=0;E.length>L;L++)this.insert(E[L]);return this}let A=this._build(E.slice(),0,E.length-1,0);if(this.data.children.length)if(this.data.height===A.height)this._splitRoot(this.data,A);else{if(A.height>this.data.height){const L=this.data;this.data=A,A=L}this._insert(A,this.data.height-A.height-1,!0)}else this.data=A;return this}insert(E){return E&&this._insert(E,this.data.height-1),this}clear(){return this.data=es([]),this}remove(E,A){if(!E)return this;let L=this.data;const P=this.toBBox(E),B=[],j=[];let te,de,Oe;for(;L||B.length;){if(L||(L=B.pop(),de=B[B.length-1],te=j.pop(),Oe=!0),L.leaf){const et=lu(E,L.children,A);if(et!==-1)return L.children.splice(et,1),B.push(L),this._condense(B),this}Oe||L.leaf||!Sc(L,P)?de?(te++,L=de.children[te],Oe=!1):L=null:(B.push(L),j.push(te),te=0,de=L,L=L.children[0])}return this}toBBox(E){return E}compareMinX(E,A){return E.minX-A.minX}compareMinY(E,A){return E.minY-A.minY}toJSON(){return this.data}fromJSON(E){return this.data=E,this}_all(E,A){const L=[];for(;E;)E.leaf?A.push(...E.children):L.push(...E.children),E=L.pop();return A}_build(E,A,L,P){const B=L-A+1;let j,te=this._maxEntries;if(te>=B)return j=es(E.slice(A,L+1)),ps(j,this.toBBox),j;P||(te=Math.ceil(B/Math.pow(te,(P=Math.ceil(Math.log(B)/Math.log(te)))-1))),j=es([]),j.leaf=!1,j.height=P;const de=Math.ceil(B/te),Oe=de*Math.ceil(Math.sqrt(te));Al(E,A,L,Oe,this.compareMinX);for(let et=A;L>=et;et+=Oe){const Pt=Math.min(et+Oe-1,L);Al(E,et,Pt,de,this.compareMinY);for(let Mr=et;Pt>=Mr;Mr+=de)j.children.push(this._build(E,Mr,Math.min(Mr+de-1,Pt),P-1))}return ps(j,this.toBBox),j}_chooseSubtree(E,A,L,P){for(;P.push(A),!A.leaf&&P.length-1!==L;){let te,de=1/0,Oe=1/0;for(let et=0;A.children.length>et;et++){const Pt=A.children[et],Mr=Xu(Pt),Qr=(Math.max((j=Pt).maxX,(B=E).maxX)-Math.min(j.minX,B.minX))*(Math.max(j.maxY,B.maxY)-Math.min(j.minY,B.minY))-Mr;Oe>Qr?(Oe=Qr,de=de>Mr?Mr:de,te=Pt):Qr===Oe&&de>Mr&&(de=Mr,te=Pt)}A=te||A.children[0]}var B,j;return A}_insert(E,A,L){const P=L?E:this.toBBox(E),B=[],j=this._chooseSubtree(P,this.data,A,B);for(j.children.push(E),zu(j,P);A>=0&&B[A].children.length>this._maxEntries;)this._split(B,A),A--;this._adjustParentBBoxes(P,B,A)}_split(E,A){const L=E[A],P=L.children.length,B=this._minEntries;this._chooseSplitAxis(L,B,P);const j=this._chooseSplitIndex(L,B,P),te=es(L.children.splice(j,L.children.length-j));te.height=L.height,te.leaf=L.leaf,ps(L,this.toBBox),ps(te,this.toBBox),A?E[A-1].children.push(te):this._splitRoot(L,te)}_splitRoot(E,A){this.data=es([E,A]),this.data.height=E.height+1,this.data.leaf=!1,ps(this.data,this.toBBox)}_chooseSplitIndex(E,A,L){let P,B=1/0,j=1/0;for(let te=A;L-A>=te;te++){const de=Go(E,0,te,this.toBBox),Oe=Go(E,te,L,this.toBBox),et=ks(de,Oe),Pt=Xu(de)+Xu(Oe);B>et?(B=et,P=te,j=j>Pt?Pt:j):et===B&&j>Pt&&(j=Pt,P=te)}return P||L-A}_chooseSplitAxis(E,A,L){const P=E.leaf?this.compareMinX:al,B=E.leaf?this.compareMinY:ou,j=this._allDistMargin(E,A,L,P);this._allDistMargin(E,A,L,B)>j&&E.children.sort(P)}_allDistMargin(E,A,L,P){E.children.sort(P);const B=this.toBBox,j=Go(E,0,A,B),te=Go(E,L-A,L,B);let de=Nu(j)+Nu(te);for(let Oe=A;L-A>Oe;Oe++){const et=E.children[Oe];zu(j,E.leaf?B(et):et),de+=Nu(j)}for(let Oe=L-A-1;Oe>=A;Oe--){const et=E.children[Oe];zu(te,E.leaf?B(et):et),de+=Nu(te)}return de}_adjustParentBBoxes(E,A,L){for(let P=L;P>=0;P--)zu(A[P],E)}_condense(E){for(let A,L=E.length-1;L>=0;L--)E[L].children.length===0?L>0?(A=E[L-1].children,A.splice(A.indexOf(E[L]),1)):this.clear():ps(E[L],this.toBBox)}}});function Zl(E,A){return A>E?-1:E>A?1:0}var uc=Object.freeze({__proto__:null,default:class{constructor(E=[],A=Zl){if(this.data=E,this.length=this.data.length,this.compare=A,this.length>0)for(let L=(this.length>>1)-1;L>=0;L--)this._down(L)}push(E){this.data.push(E),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const E=this.data[0],A=this.data.pop();return this.length--,this.length>0&&(this.data[0]=A,this._down(0)),E}peek(){return this.data[0]}_up(E){const{data:A,compare:L}=this,P=A[E];for(;E>0;){const B=E-1>>1,j=A[B];if(L(P,j)>=0)break;A[E]=j,E=B}A[E]=P}_down(E){const{data:A,compare:L}=this,P=this.length>>1,B=A[E];for(;P>E;){let j=1+(E<<1),te=A[j];const de=j+1;if(this.length>de&&0>L(A[de],te)&&(j=de,te=A[de]),L(te,B)>=0)break;A[E]=te,E=j}A[E]=B}}}),pf=function(E,A,L,P){var B=E[0],j=E[1],te=!1;L===void 0&&(L=0),P===void 0&&(P=A.length);for(var de=(P-L)/2,Oe=0,et=de-1;de>Oe;et=Oe++){var Pt=A[L+2*Oe+0],Mr=A[L+2*Oe+1],Qr=A[L+2*et+1];Mr>j!=Qr>j&&(A[L+2*et+0]-Pt)*(j-Mr)/(Qr-Mr)+Pt>B&&(te=!te)}return te},ql=function(E,A,L,P){var B=E[0],j=E[1],te=!1;L===void 0&&(L=0),P===void 0&&(P=A.length);for(var de=P-L,Oe=0,et=de-1;de>Oe;et=Oe++){var Pt=A[Oe+L][0],Mr=A[Oe+L][1],Qr=A[et+L][1];Mr>j!=Qr>j&&(A[et+L][0]-Pt)*(j-Mr)/(Qr-Mr)+Pt>B&&(te=!te)}return te},Cu=function(E,A,L,P){return A.length>0&&Array.isArray(A[0])?ql(E,A,L,P):pf(E,A,L,P)},rf=pf;Cu.nested=ql,Cu.flat=rf;var ol=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof I.g!="undefined"?I.g:typeof self!="undefined"?self:{};function as(E,A,L){return E(L={path:A,exports:{},require:function(P,B){return function(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},L.exports),L.exports}function Ds(E){if(E.__esModule)return E;var A=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(E).forEach(function(L){var P=Object.getOwnPropertyDescriptor(E,L);Object.defineProperty(A,L,P.get?P:{enumerable:!0,get:function(){return E[L]}})}),A}var Tl=as(function(E,A){(function(L){const B=33306690738754706e-32;function j(li,Mn,wn,Vn,br){let si,Ti,ka,So,Mo=Mn[0],rs=Vn[0],pu=0,Co=0;rs>Mo==rs>-Mo?(si=Mo,Mo=Mn[++pu]):(si=rs,rs=Vn[++Co]);let Qo=0;if(li>pu&&wn>Co)for(rs>Mo==rs>-Mo?(ka=si-((Ti=Mo+si)-Mo),Mo=Mn[++pu]):(ka=si-((Ti=rs+si)-rs),rs=Vn[++Co]),si=Ti,ka!==0&&(br[Qo++]=ka);li>pu&&wn>Co;)rs>Mo==rs>-Mo?(ka=si-((Ti=si+Mo)-(So=Ti-si))+(Mo-So),Mo=Mn[++pu]):(ka=si-((Ti=si+rs)-(So=Ti-si))+(rs-So),rs=Vn[++Co]),si=Ti,ka!==0&&(br[Qo++]=ka);for(;li>pu;)ka=si-((Ti=si+Mo)-(So=Ti-si))+(Mo-So),Mo=Mn[++pu],si=Ti,ka!==0&&(br[Qo++]=ka);for(;wn>Co;)ka=si-((Ti=si+rs)-(So=Ti-si))+(rs-So),rs=Vn[++Co],si=Ti,ka!==0&&(br[Qo++]=ka);return si===0&&Qo!==0||(br[Qo++]=si),Qo}function te(li){return new Float64Array(li)}const de=33306690738754716e-32,Oe=22204460492503146e-32,et=11093356479670487e-47,Pt=te(4),Mr=te(8),Qr=te(12),Xn=te(16),ii=te(4);L.orient2d=function(li,Mn,wn,Vn,br,si){const Ti=(Mn-si)*(wn-br),ka=(li-br)*(Vn-si),So=Ti-ka;if(Ti===0||ka===0||Ti>0!=ka>0)return So;const Mo=Math.abs(Ti+ka);return de*Mo>Math.abs(So)?-function(rs,pu,Co,Qo,bu,o,u){let c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or,sr,mr,yr,rn,_n;const kn=rs-bu,Nn=Co-bu,pi=pu-o,Xr=Qo-o;z=(mr=(Ie=kn-(pe=(Q=134217729*kn)-(Q-kn)))*(qe=Xr-(ze=(Q=134217729*Xr)-(Q-Xr)))-((sr=kn*Xr)-pe*ze-Ie*ze-pe*qe))-(ut=mr-(rn=(Ie=pi-(pe=(Q=134217729*pi)-(Q-pi)))*(qe=Nn-(ze=(Q=134217729*Nn)-(Q-Nn)))-((yr=pi*Nn)-pe*ze-Ie*ze-pe*qe))),Pt[0]=mr-(ut+z)+(z-rn),z=(or=sr-((wt=sr+ut)-(z=wt-sr))+(ut-z))-(ut=or-yr),Pt[1]=or-(ut+z)+(z-yr),z=(_n=wt+ut)-wt,Pt[2]=wt-(_n-z)+(ut-z),Pt[3]=_n;let ua=function(eo,Ha){let Ta=Ha[0];for(let Ro=1;eo>Ro;Ro++)Ta+=Ha[Ro];return Ta}(4,Pt),Ir=Oe*u;if(ua>=Ir||-ua>=Ir||(c=rs-(kn+(z=rs-kn))+(z-bu),C=Co-(Nn+(z=Co-Nn))+(z-bu),y=pu-(pi+(z=pu-pi))+(z-o),R=Qo-(Xr+(z=Qo-Xr))+(z-o),c===0&&y===0&&C===0&&R===0)||(Ir=et*u+B*Math.abs(ua),(ua+=kn*R+Xr*c-(pi*C+Nn*y))>=Ir||-ua>=Ir))return ua;z=(mr=(Ie=c-(pe=(Q=134217729*c)-(Q-c)))*(qe=Xr-(ze=(Q=134217729*Xr)-(Q-Xr)))-((sr=c*Xr)-pe*ze-Ie*ze-pe*qe))-(ut=mr-(rn=(Ie=y-(pe=(Q=134217729*y)-(Q-y)))*(qe=Nn-(ze=(Q=134217729*Nn)-(Q-Nn)))-((yr=y*Nn)-pe*ze-Ie*ze-pe*qe))),ii[0]=mr-(ut+z)+(z-rn),z=(or=sr-((wt=sr+ut)-(z=wt-sr))+(ut-z))-(ut=or-yr),ii[1]=or-(ut+z)+(z-yr),z=(_n=wt+ut)-wt,ii[2]=wt-(_n-z)+(ut-z),ii[3]=_n;const vn=j(4,Pt,4,ii,Mr);z=(mr=(Ie=kn-(pe=(Q=134217729*kn)-(Q-kn)))*(qe=R-(ze=(Q=134217729*R)-(Q-R)))-((sr=kn*R)-pe*ze-Ie*ze-pe*qe))-(ut=mr-(rn=(Ie=pi-(pe=(Q=134217729*pi)-(Q-pi)))*(qe=C-(ze=(Q=134217729*C)-(Q-C)))-((yr=pi*C)-pe*ze-Ie*ze-pe*qe))),ii[0]=mr-(ut+z)+(z-rn),z=(or=sr-((wt=sr+ut)-(z=wt-sr))+(ut-z))-(ut=or-yr),ii[1]=or-(ut+z)+(z-yr),z=(_n=wt+ut)-wt,ii[2]=wt-(_n-z)+(ut-z),ii[3]=_n;const $i=j(vn,Mr,4,ii,Qr);z=(mr=(Ie=c-(pe=(Q=134217729*c)-(Q-c)))*(qe=R-(ze=(Q=134217729*R)-(Q-R)))-((sr=c*R)-pe*ze-Ie*ze-pe*qe))-(ut=mr-(rn=(Ie=y-(pe=(Q=134217729*y)-(Q-y)))*(qe=C-(ze=(Q=134217729*C)-(Q-C)))-((yr=y*C)-pe*ze-Ie*ze-pe*qe))),ii[0]=mr-(ut+z)+(z-rn),z=(or=sr-((wt=sr+ut)-(z=wt-sr))+(ut-z))-(ut=or-yr),ii[1]=or-(ut+z)+(z-yr),z=(_n=wt+ut)-wt,ii[2]=wt-(_n-z)+(ut-z),ii[3]=_n;const ki=j($i,Qr,4,ii,Xn);return Xn[ki-1]}(li,Mn,wn,Vn,br,si,Mo):So},L.orient2dfast=function(li,Mn,wn,Vn,br,si){return(Mn-si)*(wn-br)-(li-br)*(Vn-si)},Object.defineProperty(L,"__esModule",{value:!0})})(A)}),Yu=Ds(tf),Ml=Ds(uc),xl=Tl.orient2d;Ml.default&&(Ml=Ml.default);var nf=Vc;function Vc(E,A,L){A=Math.max(0,A===void 0?2:A),L=L||0;var P=function(Vn){for(var br=Vn[0],si=Vn[0],Ti=Vn[0],ka=Vn[0],So=0;Vn.length>So;So++){var Mo=Vn[So];br[0]>Mo[0]&&(br=Mo),Mo[0]>Ti[0]&&(Ti=Mo),si[1]>Mo[1]&&(si=Mo),Mo[1]>ka[1]&&(ka=Mo)}var rs=[br,si,Ti,ka],pu=rs.slice();for(So=0;Vn.length>So;So++)Cu(Vn[So],rs)||pu.push(Vn[So]);return function(Co){Co.sort(Mu);for(var Qo=[],bu=0;Co.length>bu;bu++){for(;Qo.length>=2&&0>=Jl(Qo[Qo.length-2],Qo[Qo.length-1],Co[bu]);)Qo.pop();Qo.push(Co[bu])}for(var o=[],u=Co.length-1;u>=0;u--){for(;o.length>=2&&0>=Jl(o[o.length-2],o[o.length-1],Co[u]);)o.pop();o.push(Co[u])}return o.pop(),Qo.pop(),Qo.concat(o)}(pu)}(E),B=new Yu(16);B.toBBox=function(Vn){return{minX:Vn[0],minY:Vn[1],maxX:Vn[0],maxY:Vn[1]}},B.compareMinX=function(Vn,br){return Vn[0]-br[0]},B.compareMinY=function(Vn,br){return Vn[1]-br[1]},B.load(E);for(var j,te=[],de=0;P.length>de;de++){var Oe=P[de];B.remove(Oe),j=gs(Oe,j),te.push(j)}var et=new Yu(16);for(de=0;te.length>de;de++)et.insert(ts(te[de]));for(var Pt=A*A,Mr=L*L;te.length;){var Qr=te.shift(),Xn=Qr.p,ii=Qr.next.p,li=$o(Xn,ii);if(li>=Mr){var Mn=li/Pt;(Oe=Zf(B,Qr.prev.p,Xn,ii,Qr.next.next.p,Mn,et))&&Math.min($o(Oe,Xn),$o(Oe,ii))<=Mn&&(te.push(Qr),te.push(gs(Oe,Qr)),B.remove(Oe),et.remove(Qr),et.insert(ts(Qr)),et.insert(ts(Qr.next)))}}Qr=j;var wn=[];do wn.push(Qr.p),Qr=Qr.next;while(Qr!==j);return wn.push(Qr.p),wn}function Zf(E,A,L,P,B,j,te){for(var de=new Ml([],Hc),Oe=E.data;Oe;){for(var et=0;Oe.children.length>et;et++){var Pt=Oe.children[et],Mr=Oe.leaf?ds(Pt,L,P):Ql(L,P,Pt);j<Mr||de.push({node:Pt,dist:Mr})}for(;de.length&&!de.peek().node.children;){var Qr=de.pop(),Xn=Qr.node,ii=ds(Xn,A,L),li=ds(Xn,P,B);if(ii>Qr.dist&&li>Qr.dist&&vc(L,Xn,te)&&vc(P,Xn,te))return Xn}(Oe=de.pop())&&(Oe=Oe.node)}return null}function Hc(E,A){return E.dist-A.dist}function Ql(E,A,L){if(sl(E,L)||sl(A,L))return 0;var P=Ns(E[0],E[1],A[0],A[1],L.minX,L.minY,L.maxX,L.minY);if(P===0)return 0;var B=Ns(E[0],E[1],A[0],A[1],L.minX,L.minY,L.minX,L.maxY);if(B===0)return 0;var j=Ns(E[0],E[1],A[0],A[1],L.maxX,L.minY,L.maxX,L.maxY);if(j===0)return 0;var te=Ns(E[0],E[1],A[0],A[1],L.minX,L.maxY,L.maxX,L.maxY);return te===0?0:Math.min(P,B,j,te)}function sl(E,A){return!(A.minX>E[0]||E[0]>A.maxX||A.minY>E[1]||E[1]>A.maxY)}function vc(E,A,L){for(var P,B,j,te,de=L.search({minX:Math.min(E[0],A[0]),minY:Math.min(E[1],A[1]),maxX:Math.max(E[0],A[0]),maxY:Math.max(E[1],A[1])}),Oe=0;de.length>Oe;Oe++)if(B=de[Oe].next.p,j=E,(P=de[Oe].p)!==(te=A)&&B!==j&&Jl(P,B,j)>0!=Jl(P,B,te)>0&&Jl(j,te,P)>0!=Jl(j,te,B)>0)return!1;return!0}function Jl(E,A,L){return xl(E[0],E[1],A[0],A[1],L[0],L[1])}function ts(E){var A=E.p,L=E.next.p;return E.minX=Math.min(A[0],L[0]),E.minY=Math.min(A[1],L[1]),E.maxX=Math.max(A[0],L[0]),E.maxY=Math.max(A[1],L[1]),E}function gs(E,A){var L={p:E,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return A?(L.next=A.next,L.prev=A,A.next.prev=L,A.next=L):(L.prev=L,L.next=L),L}function $o(E,A){var L=E[0]-A[0],P=E[1]-A[1];return L*L+P*P}function ds(E,A,L){var P=A[0],B=A[1],j=L[0]-P,te=L[1]-B;if(j!==0||te!==0){var de=((E[0]-P)*j+(E[1]-B)*te)/(j*j+te*te);de>1?(P=L[0],B=L[1]):de>0&&(P+=j*de,B+=te*de)}return(j=E[0]-P)*j+(te=E[1]-B)*te}function Ns(E,A,L,P,B,j,te,de){var Oe,et,Pt,Mr,Qr=L-E,Xn=P-A,ii=te-B,li=de-j,Mn=E-B,wn=A-j,Vn=Qr*Qr+Xn*Xn,br=Qr*ii+Xn*li,si=ii*ii+li*li,Ti=Qr*Mn+Xn*wn,ka=ii*Mn+li*wn,So=Vn*si-br*br,Mo=So,rs=So;So===0?(et=0,Mo=1,Mr=ka,rs=si):(Mr=Vn*ka-br*Ti,0>(et=br*ka-si*Ti)?(et=0,Mr=ka,rs=si):et>Mo&&(et=Mo,Mr=ka+br,rs=si)),0>Mr?(Mr=0,0>-Ti?et=0:-Ti>Vn?et=Mo:(et=-Ti,Mo=Vn)):Mr>rs&&(Mr=rs,0>-Ti+br?et=0:-Ti+br>Vn?et=Mo:(et=-Ti+br,Mo=Vn));var pu=(1-(Pt=Mr===0?0:Mr/rs))*B+Pt*te-((1-(Oe=et===0?0:et/Mo))*E+Oe*L),Co=(1-Pt)*j+Pt*de-((1-Oe)*A+Oe*P);return pu*pu+Co*Co}function Mu(E,A){return E[0]===A[0]?E[1]-A[1]:E[0]-A[0]}function ec(E,A,L){L===void 0&&(L={});var P=to(E),B=to(A),j=T(B[1]-P[1]),te=T(B[0]-P[0]),de=T(P[1]),Oe=T(B[1]),et=Math.pow(Math.sin(j/2),2)+Math.pow(Math.sin(te/2),2)*Math.cos(de)*Math.cos(Oe);return Gn(2*Math.atan2(Math.sqrt(et),Math.sqrt(1-et)),L.units)}function zs(E){return function(A,L){L===void 0&&(L={});var P=Number(A[0]),B=Number(A[1]),j=Number(A[2]),te=Number(A[3]);if(A.length===6)throw Error("@turf/bbox-polygon does not support BBox with 6 positions");var de=[P,B];return Xt([[de,[j,B],[j,te],[P,te],de]],L.properties,{bbox:A,id:L.id})}($a(E))}function df(E,A,L,P){P===void 0&&(P={});var B=to(E),j=T(B[0]),te=T(B[1]),de=T(L),Oe=qn(A,P.units),et=Math.asin(Math.sin(te)*Math.cos(Oe)+Math.cos(te)*Math.sin(Oe)*Math.cos(de));return lt([oi(j+Math.atan2(Math.sin(de)*Math.sin(Oe)*Math.cos(te),Math.cos(Oe)-Math.sin(te)*Math.sin(et))),oi(et)],P.properties)}function ha(E,A,L){if(L===void 0&&(L={}),L.final===!0)return function(et,Pt){var Mr=ha(Pt,et);return Mr=(Mr+180)%360}(E,A);var P=to(E),B=to(A),j=T(P[0]),te=T(B[0]),de=T(P[1]),Oe=T(B[1]);return oi(Math.atan2(Math.sin(te-j)*Math.cos(Oe),Math.cos(de)*Math.sin(Oe)-Math.sin(de)*Math.cos(Oe)*Math.cos(te-j)))}function Gc(E,A){A===void 0&&(A={});var L=$a(E);return lt([(L[0]+L[2])/2,(L[1]+L[3])/2],A.properties,A)}function kc(E,A){A===void 0&&(A={});var L=0,P=0,B=0;return $e(E,function(j){L+=j[0],P+=j[1],B++},!0),lt([L/B,P/B],A.properties)}function un(E,A){switch(A===void 0&&(A={}),bo(E)){case"Point":return lt(to(E),A.properties);case"Polygon":var L=[];$e(E,function(br){L.push(br)});var P,B,j,te,de,Oe,et,Pt,Mr=kc(E,{properties:A.properties}),Qr=Mr.geometry.coordinates,Xn=0,ii=0,li=0,Mn=L.map(function(br){return[br[0]-Qr[0],br[1]-Qr[1]]});for(P=0;L.length-1>P;P++)li+=Pt=(te=(B=Mn[P])[0])*(et=(j=Mn[P+1])[1])-(de=j[0])*(Oe=B[1]),Xn+=(te+de)*Pt,ii+=(Oe+et)*Pt;if(li===0)return Mr;var wn=1/(6*(.5*li));return lt([Qr[0]+wn*Xn,Qr[1]+wn*ii],A.properties);default:var Vn=function(br,si){si===void 0&&(si={}),si.concavity=si.concavity||1/0;var Ti=[];if($e(br,function(So){Ti.push([So[0],So[1]])}),!Ti.length)return null;var ka=nf(Ti,si.concavity);return ka.length>3?Xt([ka]):null}(E);return Vn?un(Vn,{properties:A.properties}):kc(E,{properties:A.properties})}}function Mi(E){if(!E)throw Error("geojson is required");var A=[];return Bn(E,function(L){(function(P,B){var j=[],te=P.geometry;if(te!==null){switch(te.type){case"Polygon":j=Ho(te);break;case"LineString":j=[Ho(te)]}j.forEach(function(de){var Oe=function(et,Pt){var Mr=[];return et.reduce(function(Qr,Xn){var ii,li,Mn,wn,Vn,br,si=nr([Qr,Xn],Pt);return si.bbox=[(Vn=(li=Xn)[0])>(Mn=(ii=Qr)[0])?Mn:Vn,(br=li[1])>(wn=ii[1])?wn:br,Mn>Vn?Mn:Vn,wn>br?wn:br],Mr.push(si),Xn}),Mr}(de,P.properties);Oe.forEach(function(et){et.id=B.length,B.push(et)})})}})(L,A)}),ur(A)}nf.default=Vc;function ei(E,A,L){if(!L)return A.indexOf(E);for(let P=0;A.length>P;P++)if(L(E,A[P]))return P;return-1}function za(E,A){Za(E,0,E.children.length,A,E)}function Za(E,A,L,P,B){B||(B=mc(null)),B.minX=1/0,B.minY=1/0,B.maxX=-1/0,B.maxY=-1/0;for(let j=A;L>j;j++){const te=E.children[j];Oo(B,E.leaf?P(te):te)}return B}function Oo(E,A){return E.minX=Math.min(E.minX,A.minX),E.minY=Math.min(E.minY,A.minY),E.maxX=Math.max(E.maxX,A.maxX),E.maxY=Math.max(E.maxY,A.maxY),E}function mu(E,A){return E.minX-A.minX}function Au(E,A){return E.minY-A.minY}function Rl(E){return(E.maxX-E.minX)*(E.maxY-E.minY)}function xh(E){return E.maxX-E.minX+(E.maxY-E.minY)}function vf(E,A){const L=Math.max(E.minX,A.minX),P=Math.max(E.minY,A.minY),B=Math.min(E.maxX,A.maxX),j=Math.min(E.maxY,A.maxY);return Math.max(0,B-L)*Math.max(0,j-P)}function Wh(E,A){return!(E.minX>A.minX||E.minY>A.minY||A.maxX>E.maxX||A.maxY>E.maxY)}function oh(E,A){return!(A.minX>E.maxX||A.minY>E.maxY||E.minX>A.maxX||E.minY>A.maxY)}function mc(E){return{children:E,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function lc(E,A,L,P,B){const j=[A,L];for(;j.length;){if(P>=(L=j.pop())-(A=j.pop()))continue;const te=A+Math.ceil((L-A)/P/2)*P;so(E,te,A,L,B),j.push(A,te,te,L)}}var Ku=Object.freeze({__proto__:null,default:class{constructor(E=9){this._maxEntries=Math.max(4,E),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(E){let A=this.data;const L=[];if(!oh(E,A))return L;const P=this.toBBox,B=[];for(;A;){for(let j=0;A.children.length>j;j++){const te=A.children[j],de=A.leaf?P(te):te;oh(E,de)&&(A.leaf?L.push(te):Wh(E,de)?this._all(te,L):B.push(te))}A=B.pop()}return L}collides(E){let A=this.data;if(!oh(E,A))return!1;const L=[];for(;A;){for(let P=0;A.children.length>P;P++){const B=A.children[P],j=A.leaf?this.toBBox(B):B;if(oh(E,j)){if(A.leaf||Wh(E,j))return!0;L.push(B)}}A=L.pop()}return!1}load(E){if(!E||!E.length)return this;if(this._minEntries>E.length){for(let L=0;E.length>L;L++)this.insert(E[L]);return this}let A=this._build(E.slice(),0,E.length-1,0);if(this.data.children.length)if(this.data.height===A.height)this._splitRoot(this.data,A);else{if(A.height>this.data.height){const L=this.data;this.data=A,A=L}this._insert(A,this.data.height-A.height-1,!0)}else this.data=A;return this}insert(E){return E&&this._insert(E,this.data.height-1),this}clear(){return this.data=mc([]),this}remove(E,A){if(!E)return this;let L=this.data;const P=this.toBBox(E),B=[],j=[];let te,de,Oe;for(;L||B.length;){if(L||(L=B.pop(),de=B[B.length-1],te=j.pop(),Oe=!0),L.leaf){const et=ei(E,L.children,A);if(et!==-1)return L.children.splice(et,1),B.push(L),this._condense(B),this}Oe||L.leaf||!Wh(L,P)?de?(te++,L=de.children[te],Oe=!1):L=null:(B.push(L),j.push(te),te=0,de=L,L=L.children[0])}return this}toBBox(E){return E}compareMinX(E,A){return E.minX-A.minX}compareMinY(E,A){return E.minY-A.minY}toJSON(){return this.data}fromJSON(E){return this.data=E,this}_all(E,A){const L=[];for(;E;)E.leaf?A.push(...E.children):L.push(...E.children),E=L.pop();return A}_build(E,A,L,P){const B=L-A+1;let j,te=this._maxEntries;if(te>=B)return j=mc(E.slice(A,L+1)),za(j,this.toBBox),j;P||(te=Math.ceil(B/Math.pow(te,(P=Math.ceil(Math.log(B)/Math.log(te)))-1))),j=mc([]),j.leaf=!1,j.height=P;const de=Math.ceil(B/te),Oe=de*Math.ceil(Math.sqrt(te));lc(E,A,L,Oe,this.compareMinX);for(let et=A;L>=et;et+=Oe){const Pt=Math.min(et+Oe-1,L);lc(E,et,Pt,de,this.compareMinY);for(let Mr=et;Pt>=Mr;Mr+=de)j.children.push(this._build(E,Mr,Math.min(Mr+de-1,Pt),P-1))}return za(j,this.toBBox),j}_chooseSubtree(E,A,L,P){for(;P.push(A),!A.leaf&&P.length-1!==L;){let te,de=1/0,Oe=1/0;for(let et=0;A.children.length>et;et++){const Pt=A.children[et],Mr=Rl(Pt),Qr=(Math.max((j=Pt).maxX,(B=E).maxX)-Math.min(j.minX,B.minX))*(Math.max(j.maxY,B.maxY)-Math.min(j.minY,B.minY))-Mr;Oe>Qr?(Oe=Qr,de=de>Mr?Mr:de,te=Pt):Qr===Oe&&de>Mr&&(de=Mr,te=Pt)}A=te||A.children[0]}var B,j;return A}_insert(E,A,L){const P=L?E:this.toBBox(E),B=[],j=this._chooseSubtree(P,this.data,A,B);for(j.children.push(E),Oo(j,P);A>=0&&B[A].children.length>this._maxEntries;)this._split(B,A),A--;this._adjustParentBBoxes(P,B,A)}_split(E,A){const L=E[A],P=L.children.length,B=this._minEntries;this._chooseSplitAxis(L,B,P);const j=this._chooseSplitIndex(L,B,P),te=mc(L.children.splice(j,L.children.length-j));te.height=L.height,te.leaf=L.leaf,za(L,this.toBBox),za(te,this.toBBox),A?E[A-1].children.push(te):this._splitRoot(L,te)}_splitRoot(E,A){this.data=mc([E,A]),this.data.height=E.height+1,this.data.leaf=!1,za(this.data,this.toBBox)}_chooseSplitIndex(E,A,L){let P,B=1/0,j=1/0;for(let te=A;L-A>=te;te++){const de=Za(E,0,te,this.toBBox),Oe=Za(E,te,L,this.toBBox),et=vf(de,Oe),Pt=Rl(de)+Rl(Oe);B>et?(B=et,P=te,j=j>Pt?Pt:j):et===B&&j>Pt&&(j=Pt,P=te)}return P||L-A}_chooseSplitAxis(E,A,L){const P=E.leaf?this.compareMinX:mu,B=E.leaf?this.compareMinY:Au,j=this._allDistMargin(E,A,L,P);this._allDistMargin(E,A,L,B)>j&&E.children.sort(P)}_allDistMargin(E,A,L,P){E.children.sort(P);const B=this.toBBox,j=Za(E,0,A,B),te=Za(E,L-A,L,B);let de=xh(j)+xh(te);for(let Oe=A;L-A>Oe;Oe++){const et=E.children[Oe];Oo(j,E.leaf?B(et):et),de+=xh(j)}for(let Oe=L-A-1;Oe>=A;Oe--){const et=E.children[Oe];Oo(te,E.leaf?B(et):et),de+=xh(te)}return de}_adjustParentBBoxes(E,A,L){for(let P=L;P>=0;P--)Oo(A[P],E)}_condense(E){for(let A,L=E.length-1;L>=0;L--)E[L].children.length===0?L>0?(A=E[L-1].children,A.splice(A.indexOf(E[L]),1)):this.clear():za(E[L],this.toBBox)}}}),xs=Ds(Ku),sh=Ds(ne),bl=Ds(qa),Ca=Ds(La).default,Zu=bl.featureEach,$c=sh.featureCollection;function os(E){var A=new xs(E);return A.insert=function(L){if(L.type!=="Feature")throw Error("invalid feature");return L.bbox=L.bbox?L.bbox:Ca(L),xs.prototype.insert.call(this,L)},A.load=function(L){var P=[];return Array.isArray(L)?L.forEach(function(B){if(B.type!=="Feature")throw Error("invalid features");B.bbox=B.bbox?B.bbox:Ca(B),P.push(B)}):Zu(L,function(B){if(B.type!=="Feature")throw Error("invalid features");B.bbox=B.bbox?B.bbox:Ca(B),P.push(B)}),xs.prototype.load.call(this,P)},A.remove=function(L,P){if(L.type!=="Feature")throw Error("invalid feature");return L.bbox=L.bbox?L.bbox:Ca(L),xs.prototype.remove.call(this,L,P)},A.clear=function(){return xs.prototype.clear.call(this)},A.search=function(L){var P=xs.prototype.search.call(this,this.toBBox(L));return $c(P)},A.collides=function(L){return xs.prototype.collides.call(this,this.toBBox(L))},A.all=function(){var L=xs.prototype.all.call(this);return $c(L)},A.toJSON=function(){return xs.prototype.toJSON.call(this)},A.fromJSON=function(L){return xs.prototype.fromJSON.call(this,L)},A.toBBox=function(L){var P;if(L.bbox)P=L.bbox;else if(Array.isArray(L)&&L.length===4)P=L;else if(Array.isArray(L)&&L.length===6)P=[L[0],L[1],L[3],L[4]];else if(L.type==="Feature")P=Ca(L);else{if(L.type!=="FeatureCollection")throw Error("invalid geojson");P=Ca(L)}return{minX:P[0],minY:P[1],maxX:P[2],maxY:P[3]}},A}var yo=os;function As(E,A){var L={},P=[];if(E.type==="LineString"&&(E=sn(E)),A.type==="LineString"&&(A=sn(A)),E.type==="Feature"&&A.type==="Feature"&&E.geometry!==null&&A.geometry!==null&&E.geometry.type==="LineString"&&A.geometry.type==="LineString"&&E.geometry.coordinates.length===2&&A.geometry.coordinates.length===2){var B=Ul(E,A);return B&&P.push(B),ur(P)}var j=yo();return j.load(Mi(A)),zt(Mi(E),function(te){zt(j.search(te),function(de){var Oe=Ul(te,de);if(Oe){var et=Ho(Oe).join(",");L[et]||(L[et]=!0,P.push(Oe))}})}),ur(P)}function Ul(E,A){var L=Ho(E),P=Ho(A);if(L.length!==2)throw Error("<intersects> line1 must only contain 2 coordinates");if(P.length!==2)throw Error("<intersects> line2 must only contain 2 coordinates");var B=L[0][0],j=L[0][1],te=L[1][0],de=L[1][1],Oe=P[0][0],et=P[0][1],Pt=P[1][0],Mr=P[1][1],Qr=(Mr-et)*(te-B)-(Pt-Oe)*(de-j),Xn=(Pt-Oe)*(j-et)-(Mr-et)*(B-Oe),ii=(te-B)*(j-et)-(de-j)*(B-Oe);if(Qr===0)return null;var li=Xn/Qr,Mn=ii/Qr;return 0>li||li>1||0>Mn||Mn>1?null:lt([B+li*(te-B),j+li*(de-j)])}yo.default=os;var Xi=6378137;function cc(E){return dn(E,function(A,L){return A+function(P){var B,j=0;switch(P.type){case"Polygon":return Dc(P.coordinates);case"MultiPolygon":for(B=0;P.coordinates.length>B;B++)j+=Dc(P.coordinates[B]);return j;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(L)},0)}function Dc(E){var A=0;if(E&&E.length>0){A+=Math.abs(af(E[0]));for(var L=1;E.length>L;L++)A-=Math.abs(af(E[L]))}return A}function af(E){var A,L,P,B,j,te,de=0,Oe=E.length;if(Oe>2){for(te=0;Oe>te;te++)te===Oe-2?(P=Oe-2,B=Oe-1,j=0):te===Oe-1?(P=Oe-1,B=0,j=1):(P=te,B=te+1,j=te+2),A=E[P],L=E[B],de+=(Ws(E[j][0])-Ws(A[0]))*Math.sin(Ws(L[1]));de=de*Xi*Xi/2}return de}function Ws(E){return E*Math.PI/180}function kl(E,A){return A===void 0&&(A={}),Vi(E,function(L,P){var B=P.geometry.coordinates;return L+ec(B[0],B[1],A)},0)}function Cc(E,A){A===void 0&&(A={});var L=xo(E);switch(A.properties||E.type!=="Feature"||(A.properties=E.properties),L.type){case"Polygon":return function(P,B){B===void 0&&(B={});var j=xo(P),te=j.coordinates,de=B.properties?B.properties:P.type==="Feature"?P.properties:{};return fc(te,de)}(L,A);case"MultiPolygon":return function(P,B){B===void 0&&(B={});var j=xo(P),te=j.coordinates,de=B.properties?B.properties:P.type==="Feature"?P.properties:{},Oe=[];return te.forEach(function(et){Oe.push(fc(et,de))}),ur(Oe)}(L,A);default:throw Error("invalid poly")}}function fc(E,A){return E.length>1?Vr(E,A):nr(E[0],A)}function Fc(E){for(var A,L,P=Ho(E),B=0,j=1;P.length>j;)A=L||P[0],B+=((L=P[j])[0]-A[0])*(L[1]+A[1]),j++;return B>0}var Sf=as(function(E){var A=Object.prototype.hasOwnProperty,L="~";function P(){}function B(Oe,et,Pt){this.fn=Oe,this.context=et,this.once=Pt||!1}function j(Oe,et,Pt,Mr,Qr){if(typeof Pt!="function")throw new TypeError("The listener must be a function");var Xn=new B(Pt,Mr||Oe,Qr),ii=L?L+et:et;return Oe._events[ii]?Oe._events[ii].fn?Oe._events[ii]=[Oe._events[ii],Xn]:Oe._events[ii].push(Xn):(Oe._events[ii]=Xn,Oe._eventsCount++),Oe}function te(Oe,et){--Oe._eventsCount==0?Oe._events=new P:delete Oe._events[et]}function de(){this._events=new P,this._eventsCount=0}Object.create&&(P.prototype=Object.create(null),new P().__proto__||(L=!1)),de.prototype.eventNames=function(){var Oe,et,Pt=[];if(this._eventsCount===0)return Pt;for(et in Oe=this._events)A.call(Oe,et)&&Pt.push(L?et.slice(1):et);return Object.getOwnPropertySymbols?Pt.concat(Object.getOwnPropertySymbols(Oe)):Pt},de.prototype.listeners=function(Oe){var et=this._events[L?L+Oe:Oe];if(!et)return[];if(et.fn)return[et.fn];for(var Pt=0,Mr=et.length,Qr=Array(Mr);Mr>Pt;Pt++)Qr[Pt]=et[Pt].fn;return Qr},de.prototype.listenerCount=function(Oe){var et=this._events[L?L+Oe:Oe];return et?et.fn?1:et.length:0},de.prototype.emit=function(Oe,et,Pt,Mr,Qr,Xn){var ii=L?L+Oe:Oe;if(!this._events[ii])return!1;var li,Mn,wn=this._events[ii],Vn=arguments.length;if(wn.fn){switch(wn.once&&this.removeListener(Oe,wn.fn,void 0,!0),Vn){case 1:return wn.fn.call(wn.context),!0;case 2:return wn.fn.call(wn.context,et),!0;case 3:return wn.fn.call(wn.context,et,Pt),!0;case 4:return wn.fn.call(wn.context,et,Pt,Mr),!0;case 5:return wn.fn.call(wn.context,et,Pt,Mr,Qr),!0;case 6:return wn.fn.call(wn.context,et,Pt,Mr,Qr,Xn),!0}for(Mn=1,li=Array(Vn-1);Vn>Mn;Mn++)li[Mn-1]=arguments[Mn];wn.fn.apply(wn.context,li)}else{var br,si=wn.length;for(Mn=0;si>Mn;Mn++)switch(wn[Mn].once&&this.removeListener(Oe,wn[Mn].fn,void 0,!0),Vn){case 1:wn[Mn].fn.call(wn[Mn].context);break;case 2:wn[Mn].fn.call(wn[Mn].context,et);break;case 3:wn[Mn].fn.call(wn[Mn].context,et,Pt);break;case 4:wn[Mn].fn.call(wn[Mn].context,et,Pt,Mr);break;default:if(!li)for(br=1,li=Array(Vn-1);Vn>br;br++)li[br-1]=arguments[br];wn[Mn].fn.apply(wn[Mn].context,li)}}return!0},de.prototype.on=function(Oe,et,Pt){return j(this,Oe,et,Pt,!1)},de.prototype.once=function(Oe,et,Pt){return j(this,Oe,et,Pt,!0)},de.prototype.removeListener=function(Oe,et,Pt,Mr){var Qr=L?L+Oe:Oe;if(!this._events[Qr])return this;if(!et)return te(this,Qr),this;var Xn=this._events[Qr];if(Xn.fn)Xn.fn!==et||Mr&&!Xn.once||Pt&&Xn.context!==Pt||te(this,Qr);else{for(var ii=0,li=[],Mn=Xn.length;Mn>ii;ii++)(Xn[ii].fn!==et||Mr&&!Xn[ii].once||Pt&&Xn[ii].context!==Pt)&&li.push(Xn[ii]);li.length?this._events[Qr]=li.length===1?li[0]:li:te(this,Qr)}return this},de.prototype.removeAllListeners=function(Oe){var et;return Oe?this._events[et=L?L+Oe:Oe]&&te(this,et):(this._events=new P,this._eventsCount=0),this},de.prototype.off=de.prototype.removeListener,de.prototype.addListener=de.prototype.on,de.prefixed=L,de.EventEmitter=de,E.exports=de}),hc=function(E){Cr(L,E);var A=De(L);function L(P,B){var j,te=B.style;return is(this,L),(j=A.call(this)).scene=void 0,j.style=void 0,j.layers=void 0,j.data=[],j.scene=P,j.style=te,j.layers=j.getLayers(),j.layers.forEach(function(de){P.addLayer(de)}),te.callback instanceof Function&&te.callback(j.layers),j}return mt(L,[{key:"show",value:function(){this.layers.forEach(function(P){P.show()})}},{key:"hide",value:function(){this.layers.forEach(function(P){P.hide()})}},{key:"setData",value:function(P){this.data=P;var B=ur(P);this.layers.forEach(function(j){j.setData(B)})}},{key:"destroy",value:function(){var P=this;this.layers.forEach(function(B){P.scene.removeLayer(B)})}}]),L}(Sf.EventEmitter),ap=function(E){Cr(L,E);var A=De(L);function L(){return is(this,L),A.apply(this,arguments)}return mt(L,[{key:"getLayers",value:function(){var P=this.style,B=P.normal,j=P.style,te=P.options;return[new k.LineLayer(te!=null?te:{}).source(ur([])).size(B.size).color(B.color).shape("line").style(j)]}}]),L}(hc),jl=function(E){var A=typeof E;return E!=null&&(A=="object"||A=="function")},op=typeof ol=="object"&&ol&&ol.Object===Object&&ol,tc=typeof self=="object"&&self&&self.Object===Object&&self,Tu=op||tc||Function("return this")(),bs=function(){return Tu.Date.now()},Xf=/\s/,Cf=function(E){for(var A=E.length;A--&&Xf.test(E.charAt(A)););return A},cu=/^\s+/,Dl=function(E){return E&&E.slice(0,Cf(E)+1).replace(cu,"")},mf=Tu.Symbol,Fl=Object.prototype,Ac=Fl.hasOwnProperty,Yf=Fl.toString,Qi=mf?mf.toStringTag:void 0,Xa=function(E){var A=Ac.call(E,Qi),L=E[Qi];try{E[Qi]=void 0;var P=!0}catch(j){}var B=Yf.call(E);return P&&(A?E[Qi]=L:delete E[Qi]),B},of=Object.prototype.toString,Pl=function(E){return of.call(E)},Bc=mf?mf.toStringTag:void 0,Qu=function(E){return E==null?E===void 0?"[object Undefined]":"[object Null]":Bc&&Bc in Object(E)?Xa(E):Pl(E)},ul=function(E){return E!=null&&typeof E=="object"},uh=function(E){return typeof E=="symbol"||ul(E)&&Qu(E)=="[object Symbol]"},sp=/^[-+]0x[0-9a-f]+$/i,fu=/^0b[01]+$/i,Pu=/^0o[0-7]+$/i,up=parseInt,Ja=function(E){if(typeof E=="number")return E;if(uh(E))return NaN;if(jl(E)){var A=typeof E.valueOf=="function"?E.valueOf():E;E=jl(A)?A+"":A}if(typeof E!="string")return E===0?E:+E;E=Dl(E);var L=fu.test(E);return L||Pu.test(E)?up(E.slice(2),L?2:8):sp.test(E)?NaN:+E},Kn=Math.max,Wc=Math.min,Ju=function(E,A,L){var P,B,j,te,de,Oe,et=0,Pt=!1,Mr=!1,Qr=!0;if(typeof E!="function")throw new TypeError("Expected a function");function Xn(br){var si=P,Ti=B;return P=B=void 0,et=br,te=E.apply(Ti,si)}function ii(br){return et=br,de=setTimeout(Mn,A),Pt?Xn(br):te}function li(br){var si=br-Oe;return Oe===void 0||si>=A||0>si||Mr&&br-et>=j}function Mn(){var br=bs();if(li(br))return wn(br);de=setTimeout(Mn,function(si){var Ti=A-(si-Oe);return Mr?Wc(Ti,j-(si-et)):Ti}(br))}function wn(br){return de=void 0,Qr&&P?Xn(br):(P=B=void 0,te)}function Vn(){var br=bs(),si=li(br);if(P=arguments,B=this,Oe=br,si){if(de===void 0)return ii(Oe);if(Mr)return clearTimeout(de),de=setTimeout(Mn,A),Xn(Oe)}return de===void 0&&(de=setTimeout(Mn,A)),te}return A=Ja(A)||0,jl(L)&&(Pt=!!L.leading,j=(Mr="maxWait"in L)?Kn(Ja(L.maxWait)||0,A):j,Qr="trailing"in L?!!L.trailing:Qr),Vn.cancel=function(){de!==void 0&&clearTimeout(de),et=0,P=Oe=B=de=void 0},Vn.flush=function(){return de===void 0?te:wn(bs())},Vn},Nt=function(E){Cr(L,E);var A=De(L);function L(){var P;is(this,L);for(var B=arguments.length,j=Array(B),te=0;B>te;te++)j[te]=arguments[te];return(P=A.call.apply(A,[this].concat(j))).onMouseMove=function(de){P.emit(D.RenderEvent.Mousemove,de)},P.onMouseOut=function(de){P.emit(D.RenderEvent.Mouseout,de)},P.onMouseDown=function(de){P.emit(D.RenderEvent.Dragstart,de)},P.onDragging=function(de){P.emit(D.RenderEvent.Dragging,de)},P.onDragEnd=Ju(function(de){P.emit(D.RenderEvent.Dragend,de)},0),P.onUnClick=function(de){P.emit(D.RenderEvent.UnClick,de)},P.enableHover=function(){var de,Oe;P.disableHover(),(de=P.layers[0])===null||de===void 0||de.on(D.LayerEvent.Mousemove,P.onMouseMove),(Oe=P.layers[0])===null||Oe===void 0||Oe.on(D.LayerEvent.Mouseout,P.onMouseOut)},P.disableHover=function(){var de,Oe;(de=P.layers[0])===null||de===void 0||de.off(D.LayerEvent.Mousemove,P.onMouseMove),(Oe=P.layers[0])===null||Oe===void 0||Oe.off(D.LayerEvent.Mouseout,P.onMouseOut)},P}return mt(L,[{key:"getLayers",value:function(){var P=this.style,B=P.normal,j=P.hover,te=P.active,de=P.style,Oe=P.options;return[new k.LineLayer(Oe!=null?Oe:{}).source(ur([])).size("isHover*isActive",function(et,Pt){return Pt?te.size:et?j.size:B.size}).color("isHover*isActive",function(et,Pt){return Pt?te.color:et?j.color:B.color}).shape("line").style(de)]}},{key:"enableDrag",value:function(){this.disableDrag(),this.layers[0].on(D.LayerEvent.Mousedown,this.onMouseDown),this.scene.on(D.SceneEvent.Dragging,this.onDragging),this.scene.on(D.SceneEvent.Mouseup,this.onDragEnd),this.scene.on(D.SceneEvent.Dragend,this.onDragEnd)}},{key:"disableDrag",value:function(){this.layers[0].off(D.LayerEvent.Mousedown,this.onMouseDown),this.scene.off(D.SceneEvent.Dragging,this.onDragging),this.scene.off(D.SceneEvent.Mouseup,this.onDragEnd),this.scene.off(D.SceneEvent.Dragend,this.onDragEnd)}},{key:"enableUnClick",value:function(){this.disableUnClick(),this.layers[0].on(D.LayerEvent.UnClick,this.onUnClick)}},{key:"disableUnClick",value:function(){this.layers[0].off(D.LayerEvent.UnClick,this.onUnClick)}}]),L}(hc),Xc=function(E){Cr(L,E);var A=De(L);function L(){var P;is(this,L);for(var B=arguments.length,j=Array(B),te=0;B>te;te++)j[te]=arguments[te];return(P=A.call.apply(A,[this].concat(j))).onMouseMove=function(de){P.emit(D.RenderEvent.Mousemove,de)},P.onMouseOut=function(de){P.emit(D.RenderEvent.Mouseout,de)},P.onMouseDown=function(de){P.emit(D.RenderEvent.Click,de)},P}return mt(L,[{key:"getLayers",value:function(){var P=this.style,B=P.normal,j=P.style,te=P.options,de=B.shape,Oe=B.size,et=B.color,Pt=B.stroke;return[new k.PointLayer(te!=null?te:{}).source(ur([])).size(Oe).color(et).shape(de).style(fi({stroke:Pt},j))]}},{key:"enableClick",value:function(){this.disableClick(),this.layers[0].on(D.LayerEvent.Mousedown,this.onMouseDown)}},{key:"disableClick",value:function(){this.layers[0].off(D.LayerEvent.Mousedown,this.onMouseDown)}},{key:"enableHover",value:function(){var P,B;this.disableHover(),(P=this.layers[0])===null||P===void 0||P.on(D.LayerEvent.Mousemove,this.onMouseMove),(B=this.layers[0])===null||B===void 0||B.on(D.LayerEvent.Mouseout,this.onMouseOut)}},{key:"disableHover",value:function(){var P,B;(P=this.layers[0])===null||P===void 0||P.off(D.LayerEvent.Mousemove,this.onMouseMove),(B=this.layers[0])===null||B===void 0||B.off(D.LayerEvent.Mouseout,this.onMouseOut)}}]),L}(hc),ss=function(E){Cr(L,E);var A=De(L);function L(){var P;is(this,L);for(var B=arguments.length,j=Array(B),te=0;B>te;te++)j[te]=arguments[te];return(P=A.call.apply(A,[this].concat(j))).onCreate=function(de){P.emit(D.RenderEvent.UnClick,de)},P.onMouseMove=function(de){P.emit(D.RenderEvent.Mousemove,de)},P.onMouseOut=function(de){P.emit(D.RenderEvent.Mouseout,de)},P.onMouseDown=function(de){P.emit(D.RenderEvent.Dragstart,de)},P.onDragging=function(de){P.emit(D.RenderEvent.Dragging,de)},P.onDragEnd=Ju(function(de){P.emit(D.RenderEvent.Dragend,de)},0),P.onClick=function(de){P.emit(D.RenderEvent.Click,de)},P.onContextmenu=function(de){P.emit(D.RenderEvent.Contextmenu,de)},P}return mt(L,[{key:"getLayers",value:function(){var P=this.style,B=P.normal,j=P.hover,te=P.active,de=P.style,Oe=P.options;return[new k.PointLayer(Oe!=null?Oe:{}).source(ur([])).size("isHover*isActive",function(et,Pt){return Pt?te.size:et?j.size:B.size}).color("isHover*isActive",function(et,Pt){return Pt?te.color:et?j.color:B.color}).shape("isHover*isActive",function(et,Pt){return Pt?te.shape:et?j.shape:B.shape}).style(fi({stroke:["isHover*isActive",function(et,Pt){return Pt?te.stroke:et?j.stroke:B.stroke}]},de))]}},{key:"enableCreate",value:function(){this.disableCreate(),this.layers[0].on(D.LayerEvent.UnClick,this.onCreate)}},{key:"disableCreate",value:function(){this.layers[0].off(D.LayerEvent.UnClick,this.onCreate)}},{key:"enableHover",value:function(){var P,B;this.disableHover(),(P=this.layers[0])===null||P===void 0||P.on(D.LayerEvent.Mousemove,this.onMouseMove),(B=this.layers[0])===null||B===void 0||B.on(D.LayerEvent.Mouseout,this.onMouseOut)}},{key:"disableHover",value:function(){var P,B;(P=this.layers[0])===null||P===void 0||P.off(D.LayerEvent.Mousemove,this.onMouseMove),(B=this.layers[0])===null||B===void 0||B.off(D.LayerEvent.Mouseout,this.onMouseOut)}},{key:"enableDrag",value:function(){this.disableDrag(),this.layers[0].on(D.LayerEvent.Mousedown,this.onMouseDown),this.scene.on(D.SceneEvent.Dragging,this.onDragging),this.scene.on(D.SceneEvent.Mouseup,this.onDragEnd),this.scene.on(D.SceneEvent.Dragend,this.onDragEnd)}},{key:"disableDrag",value:function(){this.layers[0].off(D.LayerEvent.Mousedown,this.onMouseDown),this.scene.off(D.SceneEvent.Dragging,this.onDragging),this.scene.off(D.SceneEvent.Mouseup,this.onDragEnd),this.scene.off(D.SceneEvent.Dragend,this.onDragEnd)}},{key:"enableClick",value:function(){this.disableClick(),this.layers[0].on(D.LayerEvent.Click,this.onClick)}},{key:"disableClick",value:function(){this.layers[0].off(D.LayerEvent.Click,this.onClick)}},{key:"enableContextMenu",value:function(){this.disableContextMenu(),this.layers[0].on(D.LayerEvent.Contextmenu,this.onContextmenu)}},{key:"disableContextMenu",value:function(){this.layers[0].off(D.LayerEvent.Contextmenu,this.onContextmenu)}}]),L}(hc),Uu=function(E){Cr(L,E);var A=De(L);function L(){var P;is(this,L);for(var B=arguments.length,j=Array(B),te=0;B>te;te++)j[te]=arguments[te];return(P=A.call.apply(A,[this].concat(j))).onMouseMove=function(de){P.emit(D.RenderEvent.Mousemove,de)},P.onMouseOut=function(de){P.emit(D.RenderEvent.Mouseout,de)},P.onMouseDown=function(de){P.emit(D.RenderEvent.Dragstart,de)},P.onDragging=function(de){P.emit(D.RenderEvent.Dragging,de)},P.onDragEnd=Ju(function(de){P.emit(D.RenderEvent.Dragend,de)},0),P.onUnClick=function(de){P.emit(D.RenderEvent.UnClick,de)},P.enableHover=function(){var de,Oe;P.disableHover(),(de=P.layers[0])===null||de===void 0||de.on(D.LayerEvent.Mousemove,P.onMouseMove),(Oe=P.layers[0])===null||Oe===void 0||Oe.on(D.LayerEvent.Mouseout,P.onMouseOut)},P.disableHover=function(){var de,Oe;(de=P.layers[0])===null||de===void 0||de.off(D.LayerEvent.Mousemove,P.onMouseMove),(Oe=P.layers[0])===null||Oe===void 0||Oe.off(D.LayerEvent.Mouseout,P.onMouseOut)},P}return mt(L,[{key:"getLayers",value:function(){var P=this.style,B=P.normal,j=P.hover,te=P.active,de=P.style,Oe=P.options,et=new k.PolygonLayer(Oe!=null?Oe:{});return et.source(ur([])).color("isHover*isActive",function(Pt,Mr){return Mr?te.color:Pt?j.color:B.color}).style(de),[et]}},{key:"enableDrag",value:function(){this.disableDrag(),this.layers[0].on(D.LayerEvent.Mousedown,this.onMouseDown),this.scene.on(D.SceneEvent.Dragging,this.onDragging),this.scene.on(D.SceneEvent.Mouseup,this.onDragEnd),this.scene.on(D.SceneEvent.Dragend,this.onDragEnd)}},{key:"disableDrag",value:function(){this.layers[0].off(D.LayerEvent.Mousedown,this.onMouseDown),this.scene.off(D.SceneEvent.Dragging,this.onDragging),this.scene.off(D.SceneEvent.Mouseup,this.onDragEnd),this.scene.off(D.SceneEvent.Dragend,this.onDragEnd)}},{key:"enableUnClick",value:function(){this.disableUnClick(),this.layers[0].on(D.LayerEvent.UnClick,this.onUnClick)}},{key:"disableUnClick",value:function(){this.layers[0].off(D.LayerEvent.UnClick,this.onUnClick)}}]),L}(hc),cs=function(E){Cr(L,E);var A=De(L);function L(P){var B;return is(this,L),(B=A.call(this)).scene=void 0,B.previousClick=void 0,B.onDblClick=function(j){var te,de,Oe=(te=(de=j.pixel)!==null&&de!==void 0?de:j.point)!==null&&te!==void 0?te:{},et=Oe.x,Pt=et===void 0?0:et,Mr=Oe.y,Qr=Mr===void 0?0:Mr,Xn=Date.now();if(B.previousClick){var ii=B.previousClick,li=ii.y;300>Xn-ii.time&&5>Math.abs(Pt-ii.x)&&5>Math.abs(Qr-li)&&B.emit(D.RenderEvent.DblClick,j)}B.previousClick={x:Pt,y:Qr,time:Xn}},B.onMouseMove=function(j){B.emit(D.RenderEvent.Mousemove,j)},B.onMouseDown=function(j){B.emit(D.RenderEvent.Dragstart,j)},B.onDragging=function(j){B.emit(D.RenderEvent.Dragging,j)},B.onDragEnd=Ju(function(j){B.emit(D.RenderEvent.Dragend,j)},0),B.scene=P,B}return mt(L,[{key:"enableDrag",value:function(){this.disableDrag(),this.scene.on(D.SceneEvent.Mousedown,this.onMouseDown),this.scene.on(D.SceneEvent.Dragging,this.onDragging),this.scene.on(D.SceneEvent.Mouseup,this.onDragEnd),this.scene.on(D.SceneEvent.Dragend,this.onDragEnd)}},{key:"disableDrag",value:function(){this.scene.off(D.SceneEvent.Mousedown,this.onMouseDown),this.scene.off(D.SceneEvent.Dragging,this.onDragging),this.scene.off(D.SceneEvent.Mouseup,this.onDragEnd),this.scene.off(D.SceneEvent.Dragend,this.onDragEnd)}},{key:"enableMouseMove",value:function(){this.disableMouseMove(),this.scene.on(D.SceneEvent.Mousemove,this.onMouseMove)}},{key:"disableMouseMove",value:function(){this.scene.off(D.SceneEvent.Mousemove,this.onMouseMove)}},{key:"enableDblClick",value:function(){this.disableDblClick(),this.scene.on(D.SceneEvent.Mousedown,this.onDblClick)}},{key:"disableDblClick",value:function(){this.scene.off(D.SceneEvent.Mousedown,this.onDblClick)}}]),L}(Sf),Kf=function(E){Cr(L,E);var A=De(L);function L(){return is(this,L),A.apply(this,arguments)}return mt(L,[{key:"getLayers",value:function(){var P=this.style,B=P.normal,j=P.active,te=P.style,de=P.options;return[new k.PointLayer(de!=null?de:{}).source(ur([])).size("isActive",function(Oe){return Oe?j.size:B.size}).color("isActive",function(Oe){return Oe?j.color:B.color}).shape("text","text").style(fi({stroke:["isActive",function(Oe){return Oe?j.stroke:B.stroke}]},te))]}}]),L}(hc),Uf={point:ss,line:Nt,dashLine:ap,midPoint:Xc,text:Kf,polygon:Uu},Nc="#1990FF",Tc="#ED9D48",gf={blend:"normal",pickingBuffer:5},lh={color:Nc,shape:"circle",size:6,stroke:"#ffffff"},Af={color:Tc,shape:"circle",size:6,stroke:"#ffffff"},Tf={shape:"circle",size:6,color:Tc,stroke:"#ffffff"},Mf={options:gf,normal:lh,hover:fi(fi({},lh),{},{size:8}),active:fi(fi({},lh),{},{size:8,color:Tc}),style:{strokeWidth:2}},Pf={options:gf,normal:Af,hover:fi(fi({},Af),{},{size:8}),active:fi(fi({},Af),{},{size:8}),style:{strokeWidth:2}},ju={color:Nc,size:12,stroke:"#ffffff"},gp={point:Pf,line:{options:gf,normal:{color:Nc,size:2},hover:{color:Nc,size:2},active:{color:Tc,size:2},style:{}},polygon:{options:gf,normal:{color:Nc},hover:{color:Nc},active:{color:Tc},style:{opacity:.15}},midPoint:{options:gf,normal:Tf},dashLine:{options:gf,normal:{color:Tc,size:2},style:{lineType:"dash",dashArray:[6,6]}},text:{options:gf,normal:ju,active:fi(fi({},ju),{},{color:Tc}),style:{fontWeight:"800",textOffset:[0,ju.size+6],textAllowOverlap:!0,strokeWidth:2}}},qf=function(E,A){return E===A||E!=E&&A!=A},h=function(E,A){for(var L=E.length;L--;)if(qf(E[L][0],A))return L;return-1},g=Array.prototype.splice,p=function(E){var A=this.__data__,L=h(A,E);return L>=0&&(L==A.length-1?A.pop():g.call(A,L,1),--this.size,!0)},b=function(E){var A=this.__data__,L=h(A,E);return 0>L?void 0:A[L][1]},N=function(E){return h(this.__data__,E)>-1},q=function(E,A){var L=this.__data__,P=h(L,E);return 0>P?(++this.size,L.push([E,A])):L[P][1]=A,this};function ee(E){var A=-1,L=E==null?0:E.length;for(this.clear();++A<L;){var P=E[A];this.set(P[0],P[1])}}ee.prototype.clear=function(){this.__data__=[],this.size=0},ee.prototype.delete=p,ee.prototype.get=b,ee.prototype.has=N,ee.prototype.set=q;var ge=ee,Ue=function(){this.__data__=new ge,this.size=0},st=function(E){var A=this.__data__,L=A.delete(E);return this.size=A.size,L},kt=function(E){return this.__data__.get(E)},Lt=function(E){return this.__data__.has(E)},Zt,vr=function(E){if(!jl(E))return!1;var A=Qu(E);return A=="[object Function]"||A=="[object GeneratorFunction]"||A=="[object AsyncFunction]"||A=="[object Proxy]"},pr=Tu["__core-js_shared__"],Nr=(Zt=/[^.]+$/.exec(pr&&pr.keys&&pr.keys.IE_PROTO||""))?"Symbol(src)_1."+Zt:"",cr=function(E){return!!Nr&&Nr in E},zr=Function.prototype.toString,Ur=function(E){if(E!=null){try{return zr.call(E)}catch(A){}try{return E+""}catch(A){}}return""},Tn=/^\[object .+?Constructor\]$/,ti=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yn=function(E){return!(!jl(E)||cr(E))&&(vr(E)?ti:Tn).test(Ur(E))},ai=function(E,A){return E==null?void 0:E[A]},Pi=function(E,A){var L=ai(E,A);return Yn(L)?L:void 0},va=Pi(Tu,"Map"),na=Pi(Object,"create"),Ua=function(E){var A=this.has(E)&&delete this.__data__[E];return this.size-=A?1:0,A},co=Object.prototype.hasOwnProperty,Eo=function(E){var A=this.__data__;if(na){var L=A[E];return L==="__lodash_hash_undefined__"?void 0:L}return co.call(A,E)?A[E]:void 0},ho=Object.prototype.hasOwnProperty,qo=function(E){var A=this.__data__;return na?A[E]!==void 0:ho.call(A,E)},ga=function(E,A){var L=this.__data__;return this.size+=this.has(E)?0:1,L[E]=na&&A===void 0?"__lodash_hash_undefined__":A,this};function Zo(E){var A=-1,L=E==null?0:E.length;for(this.clear();++A<L;){var P=E[A];this.set(P[0],P[1])}}Zo.prototype.clear=function(){this.__data__=na?na(null):{},this.size=0},Zo.prototype.delete=Ua,Zo.prototype.get=Eo,Zo.prototype.has=qo,Zo.prototype.set=ga;var Uo=Zo,Do=function(E){var A=typeof E;return A=="string"||A=="number"||A=="symbol"||A=="boolean"?E!=="__proto__":E===null},po=function(E,A){var L=E.__data__;return Do(A)?L[typeof A=="string"?"string":"hash"]:L.map},us=function(E){var A=po(this,E).delete(E);return this.size-=A?1:0,A},ko=function(E){return po(this,E).get(E)},Io=function(E){return po(this,E).has(E)},El=function(E,A){var L=po(this,E),P=L.size;return L.set(E,A),this.size+=L.size==P?0:1,this};function Ou(E){var A=-1,L=E==null?0:E.length;for(this.clear();++A<L;){var P=E[A];this.set(P[0],P[1])}}Ou.prototype.clear=function(){this.size=0,this.__data__={hash:new Uo,map:new(va||ge),string:new Uo}},Ou.prototype.delete=us,Ou.prototype.get=ko,Ou.prototype.has=Io,Ou.prototype.set=El;var nu=Ou,rc=function(E,A){var L=this.__data__;if(L instanceof ge){var P=L.__data__;if(!va||199>P.length)return P.push([E,A]),this.size=++L.size,this;L=this.__data__=new nu(P)}return L.set(E,A),this.size=L.size,this};function Du(E){var A=this.__data__=new ge(E);this.size=A.size}Du.prototype.clear=Ue,Du.prototype.delete=st,Du.prototype.get=kt,Du.prototype.has=Lt,Du.prototype.set=rc;var gu=Du,gc=function(E,A){for(var L=-1,P=E==null?0:E.length;++L<P&&A(E[L],L,E)!==!1;);return E},Vl=function(){try{var E=Pi(Object,"defineProperty");return E({},"",{}),E}catch(A){}}(),ml=function(E,A,L){A=="__proto__"&&Vl?Vl(E,A,{configurable:!0,enumerable:!0,value:L,writable:!0}):E[A]=L},Mc=Object.prototype.hasOwnProperty,hl=function(E,A,L){var P=E[A];Mc.call(E,A)&&qf(P,L)&&(L!==void 0||A in E)||ml(E,A,L)},yc=function(E,A,L,P){var B=!L;L||(L={});for(var j=-1,te=A.length;++j<te;){var de=A[j],Oe=P?P(L[de],E[de],de,L,E):void 0;Oe===void 0&&(Oe=E[de]),B?ml(L,de,Oe):hl(L,de,Oe)}return L},lp=function(E,A){for(var L=-1,P=Array(E);++L<E;)P[L]=A(L);return P},Dh=function(E){return ul(E)&&Qu(E)=="[object Arguments]"},jf=Object.prototype,bh=jf.hasOwnProperty,Qf=jf.propertyIsEnumerable,sf=Dh(function(){return arguments}())?Dh:function(E){return ul(E)&&bh.call(E,"callee")&&!Qf.call(E,"callee")},ch=sf,Pc=Array.isArray,Hl=function(){return!1},zc=as(function(E,A){var L=A&&!A.nodeType&&A,P=L&&E&&!E.nodeType&&E,B=P&&P.exports===L?Tu.Buffer:void 0;E.exports=(B?B.isBuffer:void 0)||Hl}),fh=/^(?:0|[1-9]\d*)$/,Eh=function(E,A){var L=typeof E;return!!(A=A==null?9007199254740991:A)&&(L=="number"||L!="symbol"&&fh.test(E))&&E>-1&&E%1==0&&A>E},iu=function(E){return typeof E=="number"&&E>-1&&E%1==0&&9007199254740991>=E},Xs={};Xs["[object Float32Array]"]=Xs["[object Float64Array]"]=Xs["[object Int8Array]"]=Xs["[object Int16Array]"]=Xs["[object Int32Array]"]=Xs["[object Uint8Array]"]=Xs["[object Uint8ClampedArray]"]=Xs["[object Uint16Array]"]=Xs["[object Uint32Array]"]=!0,Xs["[object Arguments]"]=Xs["[object Array]"]=Xs["[object ArrayBuffer]"]=Xs["[object Boolean]"]=Xs["[object DataView]"]=Xs["[object Date]"]=Xs["[object Error]"]=Xs["[object Function]"]=Xs["[object Map]"]=Xs["[object Number]"]=Xs["[object Object]"]=Xs["[object RegExp]"]=Xs["[object Set]"]=Xs["[object String]"]=Xs["[object WeakMap]"]=!1;var Yc=function(E){return ul(E)&&iu(E.length)&&!!Xs[Qu(E)]},hh=function(E){return function(A){return E(A)}},Jf=as(function(E,A){var L=A&&!A.nodeType&&A,P=L&&E&&!E.nodeType&&E,B=P&&P.exports===L&&op.process,j=function(){try{var te=P&&P.require&&P.require("util").types;return te||B&&B.binding&&B.binding("util")}catch(de){}}();E.exports=j}),Fh=Jf&&Jf.isTypedArray,Xh=Fh?hh(Fh):Yc,Of=Object.prototype.hasOwnProperty,eh=function(E,A){var L=Pc(E),P=!L&&ch(E),B=!L&&!P&&zc(E),j=!L&&!P&&!B&&Xh(E),te=L||P||B||j,de=te?lp(E.length,String):[],Oe=de.length;for(var et in E)!A&&!Of.call(E,et)||te&&(et=="length"||B&&(et=="offset"||et=="parent")||j&&(et=="buffer"||et=="byteLength"||et=="byteOffset")||Eh(et,Oe))||de.push(et);return de},If=Object.prototype,Vf=function(E){var A=E&&E.constructor;return E===(typeof A=="function"&&A.prototype||If)},Yh=function(E,A){return function(L){return E(A(L))}},yf=Yh(Object.keys,Object),Gl=Object.prototype.hasOwnProperty,Bh=function(E){if(!Vf(E))return yf(E);var A=[];for(var L in Object(E))Gl.call(E,L)&&L!="constructor"&&A.push(L);return A},Kh=function(E){return E!=null&&iu(E.length)&&!vr(E)},yu=function(E){return Kh(E)?eh(E):Bh(E)},$p=function(E,A){return E&&yc(A,yu(A),E)},Kc=function(E){var A=[];if(E!=null)for(var L in Object(E))A.push(L);return A},Mp=Object.prototype.hasOwnProperty,Hf=function(E){if(!jl(E))return Kc(E);var A=Vf(E),L=[];for(var P in E)(P!="constructor"||!A&&Mp.call(E,P))&&L.push(P);return L},$l=function(E){return Kh(E)?eh(E,!0):Hf(E)},cd=function(E,A){return E&&yc(A,$l(A),E)},Wp=as(function(E,A){var L=A&&!A.nodeType&&A,P=L&&E&&!E.nodeType&&E,B=P&&P.exports===L?Tu.Buffer:void 0,j=B?B.allocUnsafe:void 0;E.exports=function(te,de){if(de)return te.slice();var Oe=te.length,et=j?j(Oe):new te.constructor(Oe);return te.copy(et),et}}),Es=function(E,A){var L=-1,P=E.length;for(A||(A=Array(P));++L<P;)A[L]=E[L];return A},Xp=function(E,A){for(var L=-1,P=E==null?0:E.length,B=0,j=[];++L<P;){var te=E[L];A(te,L,E)&&(j[B++]=te)}return j},Nd=function(){return[]},fd=Object.prototype.propertyIsEnumerable,cp=Object.getOwnPropertySymbols,Pp=cp?function(E){return E==null?[]:Xp(cp(E=Object(E)),function(A){return fd.call(E,A)})}:Nd,hd=function(E,A){return yc(E,Pp(E),A)},wh=function(E,A){for(var L=-1,P=A.length,B=E.length;++L<P;)E[B+L]=A[L];return E},pd=Yh(Object.getPrototypeOf,Object),ll=Object.getOwnPropertySymbols?function(E){for(var A=[];E;)wh(A,Pp(E)),E=pd(E);return A}:Nd,zd=function(E,A){return yc(E,ll(E),A)},yp=function(E,A,L){var P=A(E);return Pc(E)?P:wh(P,L(E))},Sd=function(E){return yp(E,yu,Pp)},hu=function(E){return yp(E,$l,ll)},Lf=Pi(Tu,"DataView"),Sh=Pi(Tu,"Promise"),_p=Pi(Tu,"Set"),Ch=Pi(Tu,"WeakMap"),Op="[object Map]",Ah="[object Promise]",fp="[object Set]",Nh="[object WeakMap]",zh="[object DataView]",qc=Ur(Lf),Cd=Ur(va),Rf=Ur(Sh),Yp=Ur(_p),Kp=Ur(Ch),ph=Qu;(Lf&&ph(new Lf(new ArrayBuffer(1)))!=zh||va&&ph(new va)!=Op||Sh&&ph(Sh.resolve())!=Ah||_p&&ph(new _p)!=fp||Ch&&ph(new Ch)!=Nh)&&(ph=function(E){var A=Qu(E),L=A=="[object Object]"?E.constructor:void 0,P=L?Ur(L):"";if(P)switch(P){case qc:return zh;case Cd:return Op;case Rf:return Ah;case Yp:return fp;case Kp:return Nh}return A});var th=ph,Ip=Object.prototype.hasOwnProperty,Oc=function(E){var A=E.length,L=new E.constructor(A);return A&&typeof E[0]=="string"&&Ip.call(E,"index")&&(L.index=E.index,L.input=E.input),L},qh=Tu.Uint8Array,Th=function(E){var A=new E.constructor(E.byteLength);return new qh(A).set(new qh(E)),A},Zh=function(E,A){var L=A?Th(E.buffer):E.buffer;return new E.constructor(L,E.byteOffset,E.byteLength)},dd=/\w*$/,Ad=function(E){var A=new E.constructor(E.source,dd.exec(E));return A.lastIndex=E.lastIndex,A},nc=mf?mf.prototype:void 0,kf=nc?nc.valueOf:void 0,Td=function(E){return kf?Object(kf.call(E)):{}},vd=function(E,A){var L=A?Th(E.buffer):E.buffer;return new E.constructor(L,E.byteOffset,E.length)},hp=function(E,A,L){var P=E.constructor;switch(A){case"[object ArrayBuffer]":return Th(E);case"[object Boolean]":case"[object Date]":return new P(+E);case"[object DataView]":return Zh(E,L);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return vd(E,L);case"[object Map]":case"[object Set]":return new P;case"[object Number]":case"[object String]":return new P(E);case"[object RegExp]":return Ad(E);case"[object Symbol]":return Td(E)}},Lp=Object.create,qp=function(){function E(){}return function(A){if(!jl(A))return{};if(Lp)return Lp(A);E.prototype=A;var L=new E;return E.prototype=void 0,L}}(),Gf=function(E){return typeof E.constructor!="function"||Vf(E)?{}:qp(pd(E))},qd=function(E){return ul(E)&&th(E)=="[object Map]"},Rp=Jf&&Jf.isMap,Uh=Rp?hh(Rp):qd,_f=function(E){return ul(E)&&th(E)=="[object Set]"},Md=Jf&&Jf.isSet,Qp=Md?hh(Md):_f,Mh="[object Arguments]",dh="[object Function]",Ph="[object Object]",_u={};_u[Mh]=_u["[object Array]"]=_u["[object ArrayBuffer]"]=_u["[object DataView]"]=_u["[object Boolean]"]=_u["[object Date]"]=_u["[object Float32Array]"]=_u["[object Float64Array]"]=_u["[object Int8Array]"]=_u["[object Int16Array]"]=_u["[object Int32Array]"]=_u["[object Map]"]=_u["[object Number]"]=_u[Ph]=_u["[object RegExp]"]=_u["[object Set]"]=_u["[object String]"]=_u["[object Symbol]"]=_u["[object Uint8Array]"]=_u["[object Uint8ClampedArray]"]=_u["[object Uint16Array]"]=_u["[object Uint32Array]"]=!0,_u["[object Error]"]=_u[dh]=_u["[object WeakMap]"]=!1;var md=function E(A,L,P,B,j,te){var de,Oe=1&L,et=2&L,Pt=4&L;if(P&&(de=j?P(A,B,j,te):P(A)),de!==void 0)return de;if(!jl(A))return A;var Mr=Pc(A);if(Mr){if(de=Oc(A),!Oe)return Es(A,de)}else{var Qr=th(A),Xn=Qr==dh||Qr=="[object GeneratorFunction]";if(zc(A))return Wp(A,Oe);if(Qr==Ph||Qr==Mh||Xn&&!j){if(de=et||Xn?{}:Gf(A),!Oe)return et?zd(A,cd(de,A)):hd(A,$p(de,A))}else{if(!_u[Qr])return j?A:{};de=hp(A,Qr,Oe)}}te||(te=new gu);var ii=te.get(A);if(ii)return ii;te.set(A,de),Qp(A)?A.forEach(function(Mn){de.add(E(Mn,L,P,Mn,A,te))}):Uh(A)&&A.forEach(function(Mn,wn){de.set(wn,E(Mn,L,P,wn,A,te))});var li=Mr?void 0:(Pt?et?hu:Sd:et?$l:yu)(A);return gc(li||A,function(Mn,wn){li&&(Mn=A[wn=Mn]),hl(de,wn,E(Mn,L,P,wn,A,te))}),de},_c=function(E){return md(E,5)},kp=function(E){for(var A=-1,L=E==null?0:E.length,P={};++A<L;){var B=E[A];P[B[0]]=B[1]}return P},xp=function(E){return this.__data__.has(E)};function Ks(E){var A=-1,L=E==null?0:E.length;for(this.__data__=new nu;++A<L;)this.add(E[A])}Ks.prototype.add=Ks.prototype.push=function(E){return this.__data__.set(E,"__lodash_hash_undefined__"),this},Ks.prototype.has=xp;var Qh=Ks,Bl=function(E,A){for(var L=-1,P=E==null?0:E.length;++L<P;)if(A(E[L],L,E))return!0;return!1},Df=function(E,A){return E.has(A)},Jp=function(E,A,L,P,B,j){var te=1&L,de=E.length,Oe=A.length;if(!(de==Oe||te&&Oe>de))return!1;var et=j.get(E),Pt=j.get(A);if(et&&Pt)return et==A&&Pt==E;var Mr=-1,Qr=!0,Xn=2&L?new Qh:void 0;for(j.set(E,A),j.set(A,E);++Mr<de;){var ii=E[Mr],li=A[Mr];if(P)var Mn=te?P(li,ii,Mr,A,E,j):P(ii,li,Mr,E,A,j);if(Mn!==void 0){if(Mn)continue;Qr=!1;break}if(Xn){if(!Bl(A,function(wn,Vn){if(!Df(Xn,Vn)&&(ii===wn||B(ii,wn,L,P,j)))return Xn.push(Vn)})){Qr=!1;break}}else if(ii!==li&&!B(ii,li,L,P,j)){Qr=!1;break}}return j.delete(E),j.delete(A),Qr},jh=function(E){var A=-1,L=Array(E.size);return E.forEach(function(P,B){L[++A]=[B,P]}),L},Jh=function(E){var A=-1,L=Array(E.size);return E.forEach(function(P){L[++A]=P}),L},Pd=mf?mf.prototype:void 0,Qd=Pd?Pd.valueOf:void 0,ep=function(E,A,L,P,B,j,te){switch(L){case"[object DataView]":if(E.byteLength!=A.byteLength||E.byteOffset!=A.byteOffset)return!1;E=E.buffer,A=A.buffer;case"[object ArrayBuffer]":return!(E.byteLength!=A.byteLength||!j(new qh(E),new qh(A)));case"[object Boolean]":case"[object Date]":case"[object Number]":return qf(+E,+A);case"[object Error]":return E.name==A.name&&E.message==A.message;case"[object RegExp]":case"[object String]":return E==A+"";case"[object Map]":var de=jh;case"[object Set]":if(de||(de=Jh),E.size!=A.size&&!(1&P))return!1;var Oe=te.get(E);if(Oe)return Oe==A;P|=2,te.set(E,A);var et=Jp(de(E),de(A),P,B,j,te);return te.delete(E),et;case"[object Symbol]":if(Qd)return Qd.call(E)==Qd.call(A)}return!1},gd=Object.prototype.hasOwnProperty,Ov=function(E,A,L,P,B,j){var te=1&L,de=Sd(E),Oe=de.length;if(Oe!=Sd(A).length&&!te)return!1;for(var et=Oe;et--;){var Pt=de[et];if(!(te?Pt in A:gd.call(A,Pt)))return!1}var Mr=j.get(E),Qr=j.get(A);if(Mr&&Qr)return Mr==A&&Qr==E;var Xn=!0;j.set(E,A),j.set(A,E);for(var ii=te;++et<Oe;){var li=E[Pt=de[et]],Mn=A[Pt];if(P)var wn=te?P(Mn,li,Pt,A,E,j):P(li,Mn,Pt,E,A,j);if(!(wn===void 0?li===Mn||B(li,Mn,L,P,j):wn)){Xn=!1;break}ii||(ii=Pt=="constructor")}if(Xn&&!ii){var Vn=E.constructor,br=A.constructor;Vn==br||!("constructor"in E)||!("constructor"in A)||typeof Vn=="function"&&Vn instanceof Vn&&typeof br=="function"&&br instanceof br||(Xn=!1)}return j.delete(E),j.delete(A),Xn},Ff="[object Arguments]",Dp="[object Array]",pp="[object Object]",Fp=Object.prototype.hasOwnProperty,Fu=function(E,A,L,P,B,j){var te=Pc(E),de=Pc(A),Oe=te?Dp:th(E),et=de?Dp:th(A),Pt=(Oe=Oe==Ff?pp:Oe)==pp,Mr=(et=et==Ff?pp:et)==pp,Qr=Oe==et;if(Qr&&zc(E)){if(!zc(A))return!1;te=!0,Pt=!1}if(Qr&&!Pt)return j||(j=new gu),te||Xh(E)?Jp(E,A,L,P,B,j):ep(E,A,Oe,L,P,B,j);if(!(1&L)){var Xn=Pt&&Fp.call(E,"__wrapped__"),ii=Mr&&Fp.call(A,"__wrapped__");if(Xn||ii){var li=Xn?E.value():E,Mn=ii?A.value():A;return j||(j=new gu),B(li,Mn,L,P,j)}}return!!Qr&&(j||(j=new gu),Ov(E,A,L,P,B,j))},bp=function E(A,L,P,B,j){return A===L||(A==null||L==null||!ul(A)&&!ul(L)?A!=A&&L!=L:Fu(A,L,P,B,E,j))},jo=function(E,A){return bp(E,A)},Oh=function(E,A,L){(L!==void 0&&!qf(E[A],L)||L===void 0&&!(A in E))&&ml(E,A,L)},Bp=function(E){return function(A,L,P){for(var B=-1,j=Object(A),te=P(A),de=te.length;de--;){var Oe=te[E?de:++B];if(L(j[Oe],Oe,j)===!1)break}return A}},Np=Bp(),ke=function(E){return ul(E)&&Kh(E)},Ut=Function.prototype.toString,Ar=Object.prototype.hasOwnProperty,On=Ut.call(Object),bi=function(E){if(!ul(E)||Qu(E)!="[object Object]")return!1;var A=pd(E);if(A===null)return!0;var L=Ar.call(A,"constructor")&&A.constructor;return typeof L=="function"&&L instanceof L&&Ut.call(L)==On},zn=function(E,A){if((A!=="constructor"||typeof E[A]!="function")&&A!="__proto__")return E[A]},hi=function(E){return yc(E,$l(E))},Fi=function(E,A,L,P,B,j,te){var de=zn(E,L),Oe=zn(A,L),et=te.get(Oe);if(et)Oh(E,L,et);else{var Pt=j?j(de,Oe,L+"",E,A,te):void 0,Mr=Pt===void 0;if(Mr){var Qr=Pc(Oe),Xn=!Qr&&zc(Oe),ii=!Qr&&!Xn&&Xh(Oe);Pt=Oe,Qr||Xn||ii?Pc(de)?Pt=de:ke(de)?Pt=Es(de):Xn?(Mr=!1,Pt=Wp(Oe,!0)):ii?(Mr=!1,Pt=vd(Oe,!0)):Pt=[]:bi(Oe)||ch(Oe)?(Pt=de,ch(de)?Pt=hi(de):jl(de)&&!vr(de)||(Pt=Gf(Oe))):Mr=!1}Mr&&(te.set(Oe,Pt),B(Pt,Oe,P,j,te),te.delete(Oe)),Oh(E,L,Pt)}},Gi=function E(A,L,P,B,j){A!==L&&Np(L,function(te,de){if(j||(j=new gu),jl(te))Fi(A,L,de,P,E,B,j);else{var Oe=B?B(zn(A,de),te,de+"",A,L,j):void 0;Oe===void 0&&(Oe=te),Oh(A,de,Oe)}},$l)},Ki=function(E){return E},ia=function(E,A,L){switch(L.length){case 0:return E.call(A);case 1:return E.call(A,L[0]);case 2:return E.call(A,L[0],L[1]);case 3:return E.call(A,L[0],L[1],L[2])}return E.apply(A,L)},oa=Math.max,sa=function(E,A,L){return A=oa(A===void 0?E.length-1:A,0),function(){for(var P=arguments,B=-1,j=oa(P.length-A,0),te=Array(j);++B<j;)te[B]=P[A+B];B=-1;for(var de=Array(A+1);++B<A;)de[B]=P[B];return de[A]=L(te),ia(E,this,de)}},Bi=function(E){return function(){return E}},Ji=Date.now,yn=function(E){var A=0,L=0;return function(){var P=Ji(),B=16-(P-L);if(L=P,B>0){if(++A>=800)return arguments[0]}else A=0;return E.apply(void 0,arguments)}},Qn=yn(Vl?function(E,A){return Vl(E,"toString",{configurable:!0,enumerable:!1,value:Bi(A),writable:!0})}:Ki),Yi=function(E,A){return Qn(sa(E,A,Ki),E+"")},wa=function(E,A,L){if(!jl(L))return!1;var P=typeof A;return!!(P=="number"?Kh(L)&&Eh(A,L.length):P=="string"&&A in L)&&qf(L[A],E)},yi=function(E){return Yi(function(A,L){var P=-1,B=L.length,j=B>1?L[B-1]:void 0,te=B>2?L[2]:void 0;for(j=E.length>3&&typeof j=="function"?(B--,j):void 0,te&&wa(L[0],L[1],te)&&(j=3>B?void 0:j,B=1),A=Object(A);++P<B;){var de=L[P];de&&E(A,de,P,j)}return A})},Ri=yi(function(E,A,L){Gi(E,A,L)}),ta=function(E,A){for(var L=-1,P=E==null?0:E.length,B=Array(P);++L<P;)B[L]=A(E[L],L,E);return B},wo=function(E,A){return ta(A,function(L){return[L,E[L]]})},mi=function(E){var A=-1,L=Array(E.size);return E.forEach(function(P){L[++A]=[P,P]}),L},xi=function(E){return function(A){var L=th(A);return L=="[object Map]"?jh(A):L=="[object Set]"?mi(A):wo(A,E(A))}}(yu),Qa=as(function(E){(function(A,L,P){if(A){for(var B,j={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},te={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},de={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},Oe={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},et=1;20>et;++et)j[111+et]="f"+et;for(et=0;9>=et;++et)j[et+96]=""+et;Mn.prototype.bind=function(wn,Vn,br){var si=this;return si._bindMultiple.call(si,wn=wn instanceof Array?wn:[wn],Vn,br),si},Mn.prototype.unbind=function(wn,Vn){return this.bind.call(this,wn,function(){},Vn)},Mn.prototype.trigger=function(wn,Vn){var br=this;return br._directMap[wn+":"+Vn]&&br._directMap[wn+":"+Vn]({},wn),br},Mn.prototype.reset=function(){var wn=this;return wn._callbacks={},wn._directMap={},wn},Mn.prototype.stopCallback=function(wn,Vn){if((" "+Vn.className+" ").indexOf(" mousetrap ")>-1||li(Vn,this.target))return!1;if("composedPath"in wn&&typeof wn.composedPath=="function"){var br=wn.composedPath()[0];br!==wn.target&&(Vn=br)}return Vn.tagName=="INPUT"||Vn.tagName=="SELECT"||Vn.tagName=="TEXTAREA"||Vn.isContentEditable},Mn.prototype.handleKey=function(){var wn=this;return wn._handleKey.apply(wn,arguments)},Mn.addKeycodes=function(wn){for(var Vn in wn)wn.hasOwnProperty(Vn)&&(j[Vn]=wn[Vn]);B=null},Mn.init=function(){var wn=Mn(L);for(var Vn in wn)Vn.charAt(0)!=="_"&&(Mn[Vn]=function(br){return function(){return wn[br].apply(wn,arguments)}}(Vn))},Mn.init(),A.Mousetrap=Mn,E.exports&&(E.exports=Mn)}function Pt(wn,Vn,br){wn.addEventListener?wn.addEventListener(Vn,br,!1):wn.attachEvent("on"+Vn,br)}function Mr(wn){if(wn.type=="keypress"){var Vn=String.fromCharCode(wn.which);return wn.shiftKey||(Vn=Vn.toLowerCase()),Vn}return j[wn.which]?j[wn.which]:te[wn.which]?te[wn.which]:String.fromCharCode(wn.which).toLowerCase()}function Qr(wn){return wn=="shift"||wn=="ctrl"||wn=="alt"||wn=="meta"}function Xn(wn,Vn,br){return br||(br=function(){if(!B)for(var si in B={},j)si>95&&112>si||j.hasOwnProperty(si)&&(B[j[si]]=si);return B}()[wn]?"keydown":"keypress"),br=="keypress"&&Vn.length&&(br="keydown"),br}function ii(wn,Vn){var br,si,Ti,ka=[];for(br=function(So){return So==="+"?["+"]:(So=So.replace(/\+{2}/g,"+plus")).split("+")}(wn),Ti=0;br.length>Ti;++Ti)Oe[si=br[Ti]]&&(si=Oe[si]),Vn&&Vn!="keypress"&&de[si]&&(si=de[si],ka.push("shift")),Qr(si)&&ka.push(si);return{key:si,modifiers:ka,action:Vn=Xn(si,ka,Vn)}}function li(wn,Vn){return wn!==null&&wn!==L&&(wn===Vn||li(wn.parentNode,Vn))}function Mn(wn){var Vn=this;if(wn=wn||L,!(Vn instanceof Mn))return new Mn(wn);Vn.target=wn,Vn._callbacks={},Vn._directMap={};var br,si={},Ti=!1,ka=!1,So=!1;function Mo(o){o=o||{};var u,c=!1;for(u in si)o[u]?c=!0:si[u]=0;c||(So=!1)}function rs(o,u,c,y,C,R){var z,Q,pe,Ie=[],ze=c.type;if(!Vn._callbacks[o])return[];for(ze=="keyup"&&Qr(o)&&(u=[o]),z=0;Vn._callbacks[o].length>z;++z)Q=Vn._callbacks[o][z],(y||!Q.seq||si[Q.seq]==Q.level)&&ze==Q.action&&(ze=="keypress"&&!c.metaKey&&!c.ctrlKey||(pe=Q.modifiers,u.sort().join(",")===pe.sort().join(",")))&&((!y&&Q.combo==C||y&&Q.seq==y&&Q.level==R)&&Vn._callbacks[o].splice(z,1),Ie.push(Q));return Ie}function pu(o,u,c,y){Vn.stopCallback(u,u.target||u.srcElement,c,y)||o(u,c)===!1&&(function(C){C.preventDefault?C.preventDefault():C.returnValue=!1}(u),function(C){C.stopPropagation?C.stopPropagation():C.cancelBubble=!0}(u))}function Co(o){typeof o.which!="number"&&(o.which=o.keyCode);var u=Mr(o);u&&(o.type!="keyup"||Ti!==u?Vn.handleKey(u,function(c){var y=[];return c.shiftKey&&y.push("shift"),c.altKey&&y.push("alt"),c.ctrlKey&&y.push("ctrl"),c.metaKey&&y.push("meta"),y}(o),o):Ti=!1)}function Qo(o,u,c,y){function C(pe){return function(){So=pe,++si[o],clearTimeout(br),br=setTimeout(Mo,1e3)}}function R(pe){pu(c,pe,o),y!=="keyup"&&(Ti=Mr(pe)),setTimeout(Mo,10)}si[o]=0;for(var z=0;u.length>z;++z){var Q=z+1===u.length?R:C(y||ii(u[z+1]).action);bu(u[z],Q,y,o,z)}}function bu(o,u,c,y,C){Vn._directMap[o+":"+c]=u;var R,z=(o=o.replace(/\s+/g," ")).split(" ");z.length>1?Qo(o,z,u,c):(R=ii(o,c),Vn._callbacks[R.key]=Vn._callbacks[R.key]||[],rs(R.key,R.modifiers,{type:R.action},y,o,C),Vn._callbacks[R.key][y?"unshift":"push"]({callback:u,modifiers:R.modifiers,action:R.action,seq:y,level:C,combo:o}))}Vn._handleKey=function(o,u,c){var y,C=rs(o,u,c),R={},z=0,Q=!1;for(y=0;C.length>y;++y)C[y].seq&&(z=Math.max(z,C[y].level));for(y=0;C.length>y;++y)if(C[y].seq){if(C[y].level!=z)continue;Q=!0,R[C[y].seq]=1,pu(C[y].callback,c,C[y].combo,C[y].seq)}else Q||pu(C[y].callback,c,C[y].combo);var pe=c.type=="keypress"&&ka;c.type!=So||Qr(o)||pe||Mo(R),ka=Q&&c.type=="keydown"},Vn._bindMultiple=function(o,u,c){for(var y=0;o.length>y;++y)bu(o[y],u,c)},Pt(wn,"keypress",Co),Pt(wn,"keydown",Co),Pt(wn,"keyup",Co)}})(typeof window!="undefined"?window:null,typeof window!="undefined"?document:null)}),Aa,ri=function(E){return E&&E.length?E[0]:void 0},_a=(Aa=1,function(E){return"".concat(E,"-").concat(Aa++)}),Zi=function(E,A){var L,P;return!(!E||!A||((L=E.properties)===null||L===void 0?void 0:L.id)!==((P=A.properties)===null||P===void 0?void 0:P.id))},vo=function(E){var A=E.target,L=E.targetHandler,P=E.otherHandler;return E.data.map(function(B,j){var te,de=Zi(B,A)?L:P;return(te=de==null?void 0:de(B,j))!==null&&te!==void 0?te:B})},Bo=function(){return{id:_a("point"),isHover:!1,isActive:!1,isDrag:!1,createTime:Date.now()}},Hi=function(){return{id:_a("line"),isHover:!1,isActive:!1,isDrag:!1,isDraw:!1,createTime:Date.now()}},ba=function(){return{id:_a("polygon"),isHover:!1,isActive:!1,isDrag:!1,isDraw:!1,createTime:Date.now()}},go=function(E){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return lt(E,fi(fi({},Bo()),A))},Wo=function(E){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return{type:"Feature",properties:fi(fi({},Hi()),{},{nodes:E},A),geometry:{type:"LineString",coordinates:_r(ur(E))}}},Ps=function(E){return nr(E,{id:_a("dashLine")})},xu=function(E){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return{type:"Feature",properties:fi(fi({},ba()),{},{nodes:E},A),geometry:{type:"Polygon",coordinates:[_r(ur([].concat(Pe(E),[ri(E)])))]}}},el=function(E){return function(A,L,P){P===void 0&&(P={});for(var B=xo(A).coordinates,j=0,te=0;B.length>te&&(j>L||te!==B.length-1);te++){if(j>=L){var de=L-j;if(de){var Oe=ha(B[te],B[te-1])-180;return df(B[te],de,Oe,P)}return lt(B[te])}j+=ec(B[te],B[te+1],P)}return lt(B[B.length-1])}(E,kl(E,{units:"meters"})/2,{units:"meters"})},Fs=function(E,A){var L=A.showTotalDistance,P=A.format,B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},j=[];if(L){var te=el(E),de=kl(E,{units:"meters"});te.properties=fi({id:_a("text"),isActive:!1,meters:de,text:P(de),type:"totalDistance"},B),j.push(te)}else for(var Oe=E.geometry.coordinates,et=0;Oe.length-1>et;et++){var Pt=lt(Oe[et]),Mr=lt(Oe[et+1]),Qr=ec(Pt,Mr,{units:"meters"}),Xn=Gc(ur([Pt,Mr]));Xn.properties=fi({id:_a("text"),isActive:!1,meters:Qr,text:P(Qr),type:"distance"},B),j.push(Xn)}return j},pc=function(E,A){var L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},P=A.format,B=cc(E);return un(E,{properties:fi({meters:B,text:P(B),type:"area",isActive:!1},L)})},pl=function(E){var A,L,P=E.getContainer();return(A=(L=P==null?void 0:P.querySelector(".l7-marker-container"))!==null&&L!==void 0?L:P==null?void 0:P.querySelector(".amap-maps"))!==null&&A!==void 0?A:null},Ol=function(E){return E.lngLat||E.lnglat},Vu=function(E){var A=Ol(E);return[A.lng,A.lat]},Wl=function(E){return[E.lng,E.lat]},dc=function(E){for(var A=Number.MAX_SAFE_INTEGER,L=0,P=E.length,B=0;P>B;B++)A>E[B]&&(A=E[B],L=B);return L},Qc=function(E,A){var L=[],P=[];return E.forEach(function(B){jo(B,A)?P.length&&(L.push(P),P=[]):P.push(B)}),P.length&&L.push(P),L},Il=function(E,A,L){var P=[],B=[],j=[];return(P=E==="drawData"?A.getData():E instanceof Function?E(L):E).length&&(B=P.map(function(te){var de,Oe=(de=te.properties)!==null&&de!==void 0?de:{},et=Oe.nodes,Pt=et===void 0?[]:et,Mr=Oe.isActive;return Mr!==void 0&&Mr?Pt.filter(function(Qr){return!jo(Qr.geometry.coordinates,L)}):Pt}).flat().filter(function(te){return te}),B.length||(B=_r(ur(P)).map(function(te){return lt(te)})),j=P.map(function(te){var de,Oe,et,Pt=(de=(Oe=te.properties)===null||Oe===void 0?void 0:Oe.line)!==null&&de!==void 0?de:te;return!((et=te.properties)===null||et===void 0)&&et.isActive?Qc(Pt.properties.nodes.map(function(Mr){return Mr.geometry.coordinates}),L).filter(function(Mr){return Mr.length>1}).map(function(Mr){return nr(Mr)}):[Pt]}).flat().filter(function(te){return te}),j.length||P.forEach(function(te){var de=bo(te);if(/linestring/i.test(de)&&j.push(te),/polygon/i.test(de)){var Oe,et,Pt=Cc(te);return(Oe=j).push.apply(Oe,Pe((et=Pt==null?void 0:Pt.features)!==null&&et!==void 0?et:[Pt]))}})),{points:B,lines:j}},ys=function(E,A,L,P){var B=L.pointAdsorbPixel,j=He(E,2),te=P.lngLatToPixel([j[0],j[1]]),de=te.x,Oe=te.y,et=A.map(function(Mr){var Qr=He(Mr.geometry.coordinates,2),Xn=P.lngLatToPixel([Qr[0],Qr[1]]),ii=Xn.y;return Math.pow(de-Xn.x,2)+Math.pow(Oe-ii,2)}),Pt=dc(et);return Math.pow(et[Pt],.5)>B?null:A[Pt].geometry.coordinates},tl=function(E,A,L,P){var B=L.lineAdsorbPixel,j=He(E,2),te=P.lngLatToPixel([j[0],j[1]]),de=te.x,Oe=te.y,et=A.filter(function(Qr){return _r(Qr).length>1}).map(function(Qr){return function(Xn,ii,li){li===void 0&&(li={});var Mn=lt([1/0,1/0],{dist:1/0}),wn=0;return Bn(Xn,function(Vn){for(var br=Ho(Vn),si=0;br.length-1>si;si++){var Ti=lt(br[si]);Ti.properties.dist=ec(ii,Ti,li);var ka=lt(br[si+1]);ka.properties.dist=ec(ii,ka,li);var So=ec(Ti,ka,li),Mo=Math.max(Ti.properties.dist,ka.properties.dist),rs=ha(Ti,ka),pu=df(ii,Mo,rs+90,li),Co=df(ii,Mo,rs-90,li),Qo=As(nr([pu.geometry.coordinates,Co.geometry.coordinates]),nr([Ti.geometry.coordinates,ka.geometry.coordinates])),bu=null;Qo.features.length>0&&((bu=Qo.features[0]).properties.dist=ec(ii,bu,li),bu.properties.location=wn+ec(Ti,bu,li)),Mn.properties.dist>Ti.properties.dist&&((Mn=Ti).properties.index=si,Mn.properties.location=wn),Mn.properties.dist>ka.properties.dist&&((Mn=ka).properties.index=si+1,Mn.properties.location=wn+So),bu&&Mn.properties.dist>bu.properties.dist&&((Mn=bu).properties.index=si),wn+=So}}),Mn}(Qr,E)}),Pt=et.map(function(Qr){var Xn=He(Qr.geometry.coordinates,2),ii=P.lngLatToPixel([Xn[0],Xn[1]]),li=ii.y;return Math.pow(de-ii.x,2)+Math.pow(Oe-li,2)}),Mr=dc(Pt);return Math.pow(Pt[Mr],.5)>B?null:et[Mr].geometry.coordinates},Ts=function(E,A){var L=He(A,2),P=L[0],B=L[1];E.lngLat&&(E.lngLat={lng:P,lat:B}),E.lnglat&&(E.lnglat={lng:P,lat:B})},Jc=function(){function E(A,L){is(this,E),this.container=void 0,this.cursor=null,this.options=void 0,this.container=pl(A),this.options=L}return mt(E,[{key:"setCursor",value:function(A){A!==this.cursor&&this.container&&(this.container.style.cursor=A?this.options[A]:"",this.cursor=A)}},{key:"destroy",value:function(){this.setCursor(null)}}]),E}();function Vo(E,A){A===void 0&&(A={});var L=A.insertAt;if(E&&typeof document!="undefined"){var P=document.head||document.getElementsByTagName("head")[0],B=document.createElement("style");B.type="text/css",L==="top"&&P.firstChild?P.insertBefore(B,P.firstChild):P.appendChild(B),B.styleSheet?B.styleSheet.cssText=E:B.appendChild(document.createTextNode(E))}}Vo('.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;white-space:normal;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}'),Vo(".tippy-box[data-theme~=light]{color:#26323d;box-shadow:0 0 20px 4px rgba(154,161,177,.15),0 4px 80px -8px rgba(36,40,47,.25),0 4px 4px -2px rgba(91,94,105,.15);background-color:#fff}.tippy-box[data-theme~=light][data-placement^=top]>.tippy-arrow:before{border-top-color:#fff}.tippy-box[data-theme~=light][data-placement^=bottom]>.tippy-arrow:before{border-bottom-color:#fff}.tippy-box[data-theme~=light][data-placement^=left]>.tippy-arrow:before{border-left-color:#fff}.tippy-box[data-theme~=light][data-placement^=right]>.tippy-arrow:before{border-right-color:#fff}.tippy-box[data-theme~=light]>.tippy-backdrop{background-color:#fff}.tippy-box[data-theme~=light]>.tippy-svg-arrow{fill:#fff}");var js=function(){function E(A,L){var P=this;is(this,E),this.content="",this.tippy=void 0,this.scene=void 0,this.isMouseInner=!1,this.onMouseMove=function(){P.isMouseInner=!0,P.checkTippyShow()},this.onMouseOut=function(){P.isMouseInner=!1,P.checkTippyShow()},this.setContent=Ju(function(B){P.content=B!=null?B:"",P.tippy.setContent(B!=null?B:""),P.checkTippyShow()},16,{maxWait:16}),this.tippy=Ga(pl(A),fi(fi({},ms),L)),this.tippy.hide(),this.scene=A,A.on(D.SceneEvent.Mousemove,this.onMouseMove),A.on(D.SceneEvent.Mouseout,this.onMouseOut)}return mt(E,[{key:"getContent",value:function(){return this.content}},{key:"checkTippyShow",value:function(){this.content&&this.isMouseInner?this.tippy.show():this.tippy.hide()}},{key:"destroy",value:function(){this.scene.off(D.SceneEvent.Mousemove,this.onMouseMove),this.scene.off(D.SceneEvent.Mouseout,this.onMouseOut),this.tippy.destroy()}}]),E}(),Iu=function(){function E(A){var L=A.config;is(this,E),this.historyList=[],this.historyIndex=0,this.config=void 0,this.config=L}return mt(E,[{key:"save",value:function(A){if(this.config){var L=this.config.maxSize;this.historyIndex&&(this.historyList=this.historyList.slice(this.historyIndex),this.historyIndex=0),L>this.historyList.length||this.historyList.pop();var P=_c(A);return this.historyList.unshift(P),P}}},{key:"revert",value:function(){if(this.historyList.length&&this.historyList.length-1>this.historyIndex){var A=this.historyList[++this.historyIndex];return A?_c(A):void 0}}},{key:"redo",value:function(){if(this.historyList.length&&this.historyIndex>0){var A=this.historyList[--this.historyIndex];return A?_c(A):void 0}}}]),E}(),ic=function(E){Cr(L,E);var A=De(L);function L(P){var B,j=P.data,te=P.render,de=P.history;return is(this,L),(B=A.call(this)).render=void 0,B.data=_c(ae),B.timeout=null,B.diffData={},B.history=void 0,B.render=te,de&&(B.history=new Iu({config:de})),j&&B.setData(j),B}return mt(L,[{key:"saveHistory",value:function(){var P;return(P=this.history)===null||P===void 0?void 0:P.save(this.data)}},{key:"revertHistory",value:function(){var P,B=(P=this.history)===null||P===void 0?void 0:P.revert();if(B)return this.setData(B),B}},{key:"redoHistory",value:function(){var P,B=(P=this.history)===null||P===void 0?void 0:P.redo();if(B)return this.setData(B),B}},{key:"setData",value:function(P){var B=this;return Object.keys(P).length&&(this.data=fi(fi({},this.data),P),this.diffData=fi(fi({},this.diffData),P),this.timeout||(this.timeout=requestAnimationFrame(function(){return B.updateDiffData()})),this.emit(D.SourceEvent.Change,{data:this.data})),this.data}},{key:"getData",value:function(){return this.data}},{key:"getRenderData",value:function(P){return this.data[P]}},{key:"setRenderData",value:function(P,B){var j=typeof B=="function"?B(this.getRenderData(P)):B;return this.setData(Gt({},P,Pe(j).sort(function(te,de){return+te.properties.isActive-+de.properties.isActive}))),this.emit(D.SourceEvent.Change,this.data),j}},{key:"updateDiffData",value:function(){var P=this,B=Object.entries(this.diffData);B.length&&(B.forEach(function(j){var te,de=He(j,2),Oe=de[0],et=de[1];Array.isArray(et)&&((te=P.getRender(Oe))===null||te===void 0||te.setData(et))}),this.emit(D.SourceEvent.Update,this.data,this.diffData),this.diffData={},this.timeout=null)}},{key:"getRender",value:function(P){return this.render[P]}},{key:"clear",value:function(){this.setData(kp(Object.keys(this.render).map(function(P){return[P,[]]})))}}]),L}(Sf),Vh=function(E){Cr(L,E);var A=De(L);function L(P,B){var j;is(this,L),(j=A.call(this)).scene=void 0,j.source=void 0,j.render=void 0,j.cursor=void 0,j.options=void 0,j.enabled=!1,j.allowCreate=!1,j.sceneRender=void 0,j.mouseLngLat={lng:0,lat:0},j.popup=void 0,j.addCount=0,j.saveMouseLngLat=Ju(function(et){j.mouseLngLat=Ol(et)},100,{maxWait:100}),j.saveHistory=Ju(function(){j.options.history&&j.source.saveHistory()},100),j.bindThis(),j.scene=P,j.sceneRender=new cs(P),j.options=Ri({},j.getDefaultOptions(B),B),j.render=j.initRender(),j.source=new ic({render:j.render,history:j.options.history||void 0}),j.cursor=new Jc(P,j.options.cursor);var te=j.options,de=te.initialData,Oe=te.popup;return de&&j.setData(de),Oe&&(j.popup=new js(P,Oe instanceof Object?Oe:{})),j.saveHistory(),j.bindCommonEvent(),j.emit(D.DrawEvent.Init,Pa(j)),j.bindEnableEvent(),j}return mt(L,[{key:"addable",get:function(){var P=this.getData(),B=this.options,j=B.multiple,te=B.maxCount,de=P.find(function(Oe){return Oe.properties.isDraw});return!(!this.enabled||!this.allowCreate)&&(!!(j&&0>=te||de)||!(!j&&this.addCount>=1)&&(0>=te||te>P.length))}},{key:"getOptions",value:function(){return this.options}},{key:"getEditItem",value:function(){return this.editItem}},{key:"getDragItem",value:function(){return this.dragItem}},{key:"setHelper",value:function(P){var B,j,te=this.options.helper;if(te){var de=(B=P in te?te[P]:P)!==null&&B!==void 0?B:null;(j=this.popup)===null||j===void 0||j.setContent(de)}}},{key:"isEnable",value:function(){return this.enabled}},{key:"bindThis",value:function(){this.initRender=this.initRender.bind(this),this.getData=this.getData.bind(this),this.setData=this.setData.bind(this),this.emitChangeEvent=this.emitChangeEvent.bind(this),this.saveHistory=this.saveHistory.bind(this),this.onSceneMouseMove=this.onSceneMouseMove.bind(this),this.revertHistory=this.revertHistory.bind(this),this.redoHistory=this.redoHistory.bind(this),this.removeActiveFeature=this.removeActiveFeature.bind(this),this.bindCommonEvent=this.bindCommonEvent.bind(this),this.bindEnableEvent=this.bindEnableEvent.bind(this),this.unbindEnableEvent=this.unbindEnableEvent.bind(this),this.setActiveFeature=this.setActiveFeature.bind(this)}},{key:"bindCommonEvent",value:function(){var P=this;this.on(D.DrawEvent.Add,this.emitChangeEvent),this.on(D.DrawEvent.Add,function(){P.addCount++}),this.on(D.DrawEvent.Edit,this.emitChangeEvent),this.on(D.DrawEvent.Remove,this.emitChangeEvent),this.on(D.DrawEvent.Clear,this.emitChangeEvent),this.on(D.DrawEvent.AddNode,this.saveHistory),this.on(D.DrawEvent.RemoveNode,this.emitChangeEvent)}},{key:"bindEnableEvent",value:function(){this.unbindKeyboardEvent(),this.scene.setMapStatus({doubleClickZoom:!1}),this.scene.on(D.SceneEvent.Mousemove,this.saveMouseLngLat),this.bindKeyboardEvent()}},{key:"unbindEnableEvent",value:function(){this.scene.setMapStatus({doubleClickZoom:!0}),this.scene.off(D.SceneEvent.Mousemove,this.saveMouseLngLat),this.unbindKeyboardEvent()}},{key:"bindKeyboardEvent",value:function(){var P=this,B=this.options.keyboard||{},j=B.revert,te=B.redo,de=B.remove;de&&Qa.bind(de,function(){P.removeActiveFeature()}),this.options.history&&(j&&Qa.bind(j,this.revertHistory),te&&Qa.bind(te,this.redoHistory))}},{key:"unbindKeyboardEvent",value:function(){var P=this.options.keyboard||{},B=P.revert,j=P.redo,te=P.remove;te&&Qa.unbind(te),this.options.history&&(B&&Qa.unbind(B),j&&Qa.unbind(j))}},{key:"emitChangeEvent",value:function(){this.emit(D.DrawEvent.Change,this.getData()),this.saveHistory()}},{key:"revertHistory",value:function(){this.enabled&&this.options.history&&this.source.revertHistory()&&this.correctDrawItem()}},{key:"redoHistory",value:function(){this.enabled&&this.options.history&&this.source.redoHistory()&&this.correctDrawItem()}},{key:"getRenderLayers",value:function(){return kp(xi(this.render).map(function(P){var B=He(P,2);return[B[0],B[1].getLayers()]}))}},{key:"getTargetFeature",value:function(P){var B,j,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getData(),de=null;return P&&(de=(B=te.find(function(Oe){var et;return Oe.properties.id===(typeof P=="string"?P:(et=P.properties)===null||et===void 0?void 0:et.id)}))!==null&&B!==void 0?B:null,!de&&P instanceof Object&&(de=(j=te.find(function(Oe){return jo(P.geometry,Oe.geometry)}))!==null&&j!==void 0?j:null)),de}},{key:"removeActiveFeature",value:function(){var P=this.getData().find(function(B){var j=B.properties;return j.isActive||j.isDraw});return P&&this.removeFeature(P),P}},{key:"removeFeature",value:function(P){var B=this.getData(),j=this.getTargetFeature(P);j&&(this.setData(B.filter(function(te){return!Zi(j,te)})),this.emit(D.DrawEvent.Remove,P,this.getData()))}},{key:"correctDrawItem",value:function(){this.getData().find(function(P){return P.properties.isDraw})&&this.onSceneMouseMove({type:"mousemove",lnglat:this.mouseLngLat,lngLat:this.mouseLngLat})}},{key:"initRender",value:function(){var P,B={},j=function(de,Oe){var et=typeof Symbol!="undefined"&&de[Symbol.iterator]||de["@@iterator"];if(!et){if(Array.isArray(de)||(et=Tt(de))||Oe&&de&&typeof de.length=="number"){et&&(de=et);var Pt=0,Mr=function(){};return{s:Mr,n:function(){return de.length>Pt?{done:!1,value:de[Pt++]}:{done:!0}},e:function(li){throw li},f:Mr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Qr,Xn=!0,ii=!1;return{s:function(){et=et.call(de)},n:function(){var li=et.next();return Xn=li.done,li},e:function(li){ii=!0,Qr=li},f:function(){try{Xn||et.return==null||et.return()}finally{if(ii)throw Qr}}}}(this.getRenderTypes());try{for(j.s();!(P=j.n()).done;){var te=P.value;B[te]=new Uf[te](this.scene,{style:this.options.style[te]})}}catch(de){j.e(de)}finally{j.f()}return B}},{key:"getCommonOptions",value:function(P){return{initialData:[],autoActive:!0,cursor:_c(m),editable:!0,style:_c(gp),multiple:!0,history:_c(uu),keyboard:_c(Jo),popup:!0,helper:{},maxCount:-1}}},{key:"setCursor",value:function(P){this.cursor.setCursor(P)}},{key:"resetCursor",value:function(){this.setCursor(this.addable?"draw":null)}},{key:"enable",value:function(){var P=this,B=0>=arguments.length||arguments[0]===void 0||arguments[0];this.allowCreate=B,this.addCount=0,this.enabled=!0,this.bindEnableEvent(),this.resetCursor(),this.setHelper(this.addable?"draw":null),setTimeout(function(){P.emit(D.DrawEvent.Enable,P)},0)}},{key:"disable",value:function(){var P=this;this.resetFeatures(),this.enabled=!1,this.setCursor(null),this.unbindEnableEvent(),this.addCount=0,this.setHelper(null),setTimeout(function(){P.emit(D.DrawEvent.Disable,P)},0)}},{key:"clear",value:function(){var P=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.source.clear(),this.emit(D.DrawEvent.Clear,this),P&&this.disable()}},{key:"show",value:function(){return Object.values(this.render).forEach(function(P){P.show()})}},{key:"hide",value:function(){return Object.values(this.render).forEach(function(P){P.hide()})}},{key:"destroy",value:function(){var P,B=this;Object.values(this.render).forEach(function(j){j.destroy()}),Object.values(D.RenderEvent).forEach(function(j){Object.values(B.render).forEach(function(te){te.removeAllListeners(j)}),B.sceneRender.removeAllListeners(j)}),setTimeout(function(){Object.values(D.DrawEvent).forEach(function(j){B.removeAllListeners(j)})},0),(P=this.popup)===null||P===void 0||P.destroy(),this.cursor.destroy(),this.emit(D.DrawEvent.Destroy,this)}}]),L}(Sf),lr=function(E){var A=E==null?0:E.length;return A?E[A-1]:void 0},Wn=function(E){Cr(L,E);var A=De(L);function L(){return is(this,L),A.apply(this,arguments)}return mt(L,[{key:"pointRender",get:function(){return this.render.point}},{key:"dragPoint",get:function(){return this.getPointData().find(function(P){return P.properties.isDrag})}},{key:"editPoint",get:function(){return this.getPointData().find(function(P){return P.properties.isActive})}},{key:"hoverPoint",get:function(){return this.getPointData().find(function(P){return P.properties.isHover})}},{key:"getDragPoint",value:function(){return this.dragPoint}},{key:"getEditPoint",value:function(){return this.editPoint}},{key:"getPointData",value:function(){return this.source.getRenderData("point")}},{key:"setPointData",value:function(P){return this.source.setRenderData("point",P)}},{key:"bindPointRenderEvent",value:function(){var P,B,j,te,de,Oe;(P=this.pointRender)===null||P===void 0||P.on(D.RenderEvent.UnClick,this.onPointCreate.bind(this)),(B=this.pointRender)===null||B===void 0||B.on(D.RenderEvent.Mousemove,this.onPointMouseMove.bind(this)),(j=this.pointRender)===null||j===void 0||j.on(D.RenderEvent.Mouseout,this.onPointMouseOut.bind(this)),(te=this.pointRender)===null||te===void 0||te.on(D.RenderEvent.Dragstart,this.onPointDragStart.bind(this)),(de=this.pointRender)===null||de===void 0||de.on(D.RenderEvent.Dragging,this.onPointDragging.bind(this)),(Oe=this.pointRender)===null||Oe===void 0||Oe.on(D.RenderEvent.Dragend,this.onPointDragEnd.bind(this))}},{key:"handleCreatePoint",value:function(P){var B=this.options,j=B.autoActive,te=B.editable,de=go(P);return this.setPointData(function(Oe){return vo({target:de,data:[].concat(Pe(Oe),[de]),targetHandler:function(et){et.properties=fi(fi({},et.properties),{},{isHover:te,isActive:j&&te})},otherHandler:function(et){et.properties=fi(fi({},et.properties),{},{isHover:!1,isActive:!1,isDrag:!1})}})}),de}},{key:"handlePointHover",value:function(P){return this.setCursor("pointHover"),Zi(P,this.hoverPoint)||this.setPointData(function(B){return vo({target:P,data:B,targetHandler:function(j){j.properties.isHover=!0},otherHandler:function(j){j.properties.isHover=!1}})}),P}},{key:"handlePointUnHover",value:function(P){return this.resetCursor(),this.setPointData(function(B){return B.map(function(j){return j.properties.isHover=!1,j})}),P}},{key:"handlePointDragStart",value:function(P){return this.setPointData(function(B){return vo({target:P,data:B,targetHandler:function(j){j.properties=fi(fi({},j.properties),{},{isDrag:!0,isActive:!0})},otherHandler:function(j){j.properties=fi(fi({},j.properties),{},{isDrag:!1,isActive:!1})}})}),this.scene.setMapStatus({dragEnable:!1}),this.setCursor("pointDrag"),P}},{key:"handlePointDragging",value:function(P,B){return this.setPointData(function(j){return vo({target:P,data:j,targetHandler:function(te){te.geometry.coordinates=Wl(B)}})}),this.scene.setMapStatus({dragEnable:!1}),this.setCursor("pointDrag"),P}},{key:"handlePointDragEnd",value:function(P){return this.setPointData(function(B){return vo({target:P,data:B,targetHandler:function(j){j.properties.isDrag=!1}})}),this.scene.setMapStatus({dragEnable:!0}),this.setCursor("pointHover"),P}},{key:"onPointCreate",value:function(P){return this.handleCreatePoint(Wl(Ol(P)))}},{key:"onPointMouseMove",value:function(P){return this.handlePointHover(P.feature)}},{key:"onPointMouseOut",value:function(P){return this.handlePointUnHover(P.feature)}},{key:"onPointDragStart",value:function(P){if(this.options.editable)return this.handlePointDragStart(P.feature)}},{key:"onPointDragging",value:function(P){var B=this.dragPoint;if(this.options.editable&&B)return this.handlePointDragging(B,Ol(P))}},{key:"onPointDragEnd",value:function(P){var B=this.dragPoint;if(this.options.editable&&B)return this.handlePointDragEnd(B)}},{key:"enablePointRenderAction",value:function(){var P,B,j,te,de=this.options.editable;this.enabled&&((B=this.pointRender)===null||B===void 0||B.enableCreate()),(P=this.pointRender)===null||P===void 0||P.enableClick(),de&&((j=this.pointRender)===null||j===void 0||j.enableHover(),(te=this.pointRender)===null||te===void 0||te.enableDrag())}},{key:"disablePointRenderAction",value:function(){var P,B,j,te;(P=this.pointRender)===null||P===void 0||P.disableCreate(),(B=this.pointRender)===null||B===void 0||B.disableHover(),(j=this.pointRender)===null||j===void 0||j.disableDrag(),(te=this.pointRender)===null||te===void 0||te.disableClick()}}]),L}(Vh),Rn=function(E){Cr(L,E);var A=De(L);function L(){return is(this,L),A.apply(this,arguments)}return mt(L,[{key:"midPointRender",get:function(){return this.render.midPoint}},{key:"getCommonOptions",value:function(P){return fi(fi({},ce(Rr(L.prototype),"getCommonOptions",this).call(this,P)),{},{showMidPoint:!0})}},{key:"bindMidPointRenderEvent",value:function(){var P,B,j;(P=this.midPointRender)===null||P===void 0||P.on(D.RenderEvent.Click,this.onMidPointClick.bind(this)),(B=this.midPointRender)===null||B===void 0||B.on(D.RenderEvent.Mousemove,this.onMidPointHover.bind(this)),(j=this.midPointRender)===null||j===void 0||j.on(D.RenderEvent.Mouseout,this.onMidPointUnHover.bind(this))}},{key:"getMidPointData",value:function(){return this.source.getRenderData("midPoint")}},{key:"setMidPointData",value:function(P){return this.source.setRenderData("midPoint",P)}},{key:"getMidPointsByLine",value:function(P){var B=P.properties.nodes;if(!this.options.showMidPoint||2>B.length)return[];for(var j=[],te=0;B.length-1>te;te++){var de,Oe,et,Pt,Mr=Gc(ur([B[te],B[te+1]]),{properties:{id:_a("midPoint"),startId:(de=(Oe=B[te].properties)===null||Oe===void 0?void 0:Oe.id)!==null&&de!==void 0?de:"",endId:(et=(Pt=B[te+1].properties)===null||Pt===void 0?void 0:Pt.id)!==null&&et!==void 0?et:""}});j.push(Mr)}return j}},{key:"onMidPointHover",value:function(P){this.setCursor("pointHover")}},{key:"onMidPointUnHover",value:function(P){this.resetCursor()}},{key:"enableMidPointRenderAction",value:function(){var P,B;(P=this.midPointRender)===null||P===void 0||P.enableClick(),(B=this.midPointRender)===null||B===void 0||B.enableHover()}},{key:"disableMidPointRenderAction",value:function(){var P,B;(P=this.midPointRender)===null||P===void 0||P.disableClick(),(B=this.midPointRender)===null||B===void 0||B.disableHover()}}]),L}(Wn),ro={draw:"\u5355\u51FB\u7ED8\u5236\u70B9",pointHover:"\u53EF\u62D6\u62FD\u8C03\u6574\u70B9\u4F4D\u7F6E",pointDrag:null},qs={draw:"\u5355\u51FB\u7ED8\u5236\u9996\u4E2A\u8282\u70B9",pointHover:"\u53EF\u62D6\u62FD\u8C03\u6574\u8282\u70B9\u4F4D\u7F6E",pointDrag:null,lineHover:"\u53EF\u62D6\u62FD\u8C03\u6574\u7EBF\u4F4D\u7F6E",lineDrag:null,midPointHover:"\u5355\u51FB\u5728\u8BE5\u4F4D\u7F6E\u65B0\u589E\u8282\u70B9",drawFinish:"\u5355\u51FB\u7EE7\u7EED\u7ED8\u5236\uFF0C\u53CC\u51FB\u7ED3\u675F\u7ED8\u5236"},ir={draw:"\u5355\u51FB\u7ED8\u5236\u9996\u4E2A\u8282\u70B9",drawContinue:"\u5355\u51FB\u7EE7\u7EED\u7ED8\u5236",drawFinish:"\u5355\u51FB\u7EE7\u7EED\u7ED8\u5236\uFF0C\u53CC\u51FB\u7ED3\u675F\u7ED8\u5236",midPointHover:"\u5355\u51FB\u5728\u8BE5\u4F4D\u7F6E\u65B0\u589E\u8282\u70B9",pointHover:"\u53EF\u62D6\u62FD\u8C03\u6574\u8282\u70B9\u4F4D\u7F6E",pointDrag:null,lineHover:"\u53EF\u62D6\u62FD\u8C03\u6574\u9762\u4F4D\u7F6E",lineDrag:null,polygonHover:"\u53EF\u62D6\u62FD\u8C03\u6574\u9762\u4F4D\u7F6E",polygonDrag:null},Rt=fi(fi({},ir),{},{draw:"\u5355\u51FB\u7ED8\u5236\u9996\u4E2A\u8282\u70B9",drawFinish:"\u5355\u51FB\u7ED3\u675F\u7ED8\u5236"}),Zr={draw:"\u62D6\u62FD\u5F00\u59CB\u7ED8\u5236",drawFinish:"\u677E\u5F00\u9F20\u6807\u7ED3\u675F\u7ED8\u5236"},cn={lineHover:"\u53EF\u62D6\u62FD\u8C03\u6574\u77E9\u5F62\u4F4D\u7F6E",polygonHover:"\u53EF\u62D6\u62FD\u8C03\u6574\u77E9\u5F62\u4F4D\u7F6E"},jn={lineHover:"\u53EF\u62D6\u62FD\u8C03\u6574\u5706\u4F4D\u7F6E",polygonHover:"\u53EF\u62D6\u62FD\u8C03\u6574\u5706\u4F4D\u7F6E"},Wr=function(E){Cr(L,E);var A=De(L);function L(){var P;is(this,L);for(var B=arguments.length,j=Array(B),te=0;B>te;te++)j[te]=arguments[te];return(P=A.call.apply(A,[this].concat(j))).previousPosition=[0,0],P}return mt(L,[{key:"lineRender",get:function(){return this.render.line}},{key:"dragLine",get:function(){return this.getLineData().find(function(P){return P.properties.isDrag})}},{key:"drawLine",get:function(){return this.getLineData().find(function(P){return P.properties.isDraw})}},{key:"editLine",get:function(){return this.getLineData().find(function(P){var B=P.properties;return!B.isDraw&&B.isActive})}},{key:"hoverLine",get:function(){return this.getLineData().find(function(P){return P.properties.isHover})}},{key:"getDragLine",value:function(){return this.dragLine}},{key:"getDrawLine",value:function(){return this.drawLine}},{key:"getEditLine",value:function(){return this.editLine}},{key:"getDefaultOptions",value:function(P){var B=fi(fi({},this.getCommonOptions(P)),{},{showMidPoint:!0,distanceOptions:!1,helper:_c(qs)});return P.distanceOptions&&(B.distanceOptions=fi(fi({},Wu),B.distanceOptions)),P.adsorbOptions&&(B.adsorbOptions=fi(fi({},eu),B.adsorbOptions)),B}},{key:"getAdsorbPosition",value:function(P){var B=this.options.adsorbOptions;if(typeof B=="boolean")return P;var j=this.scene,te=B.pointAdsorbPixel,de=B.lineAdsorbPixel,Oe=null,et=Il(B.data,this,P),Pt=et.points,Mr=et.lines;return Pt.length&&te>0&&(Oe=ys(P,Pt,B,j)),!Oe&&Mr.length&&de>0&&(Oe=tl(P,Mr,B,j)),Oe}},{key:"bindSceneEvent",value:function(){this.sceneRender.on(D.RenderEvent.Mousemove,this.onSceneMouseMove.bind(this))}},{key:"bindPointRenderEvent",value:function(){var P;ce(Rr(L.prototype),"bindPointRenderEvent",this).call(this),(P=this.pointRender)===null||P===void 0||P.on(D.RenderEvent.Click,this.onPointClick.bind(this))}},{key:"bindLineRenderEvent",value:function(){var P,B,j,te,de,Oe;(P=this.lineRender)===null||P===void 0||P.on(D.RenderEvent.UnClick,this.onLineUnClick.bind(this)),(B=this.lineRender)===null||B===void 0||B.on(D.RenderEvent.Mousemove,this.onLineMouseMove.bind(this)),(j=this.lineRender)===null||j===void 0||j.on(D.RenderEvent.Mouseout,this.onLineMouseOut.bind(this)),(te=this.lineRender)===null||te===void 0||te.on(D.RenderEvent.Dragstart,this.onLineDragStart.bind(this)),(de=this.lineRender)===null||de===void 0||de.on(D.RenderEvent.Dragging,this.onLineDragging.bind(this)),(Oe=this.lineRender)===null||Oe===void 0||Oe.on(D.RenderEvent.Dragend,this.onLineDragEnd.bind(this))}},{key:"getDashLineDistanceTexts",value:function(P,B){var j=B.showTotalDistance,te=B.format;return B.showDashDistance?P.map(function(de){return Fs(de,{showTotalDistance:j,format:te},{isActive:!0,type:"dash"})}).flat():[]}},{key:"getLineDistanceTexts",value:function(P,B){var j=B.showTotalDistance,te=B.format,de=B.showWhen,Oe=[];if(de.includes("active")){var et=P.filter(function(Mr){return Mr.properties.isActive&&Mr.properties.nodes.length>1});Oe.push.apply(Oe,Pe(et.map(function(Mr){return Fs(Mr,{showTotalDistance:j,format:te},{isActive:!0})}).flat()))}if(de.includes("normal")){var Pt=P.filter(function(Mr){return!Mr.properties.isActive&&Mr.properties.nodes.length>1});Oe.push.apply(Oe,Pe(Pt.map(function(Mr){return Fs(Mr,{showTotalDistance:j,format:te})}).flat()))}return Oe}},{key:"getDistanceTexts",value:function(){var P=this.options.distanceOptions;if(!P)return[];var B=[],j=P.showWhen,te=P.showDashDistance,de=P.format,Oe=P.showTotalDistance;return B.push.apply(B,Pe(this.getDashLineDistanceTexts(this.getDashLineData(),{showTotalDistance:!1,format:de,showDashDistance:te})).concat(Pe(this.getLineDistanceTexts(this.getLineData(),{showTotalDistance:Oe,format:de,showWhen:j})))),B}},{key:"getAllTexts",value:function(){return this.getDistanceTexts()}},{key:"handleCreateLine",value:function(P){var B=Wo([P],{isActive:!0,isDraw:!0});return this.setLineData(function(j){return vo({target:B,data:[].concat(Pe(j),[B]),otherHandler:function(te){te.properties.isActive=!1}})}),this.setPointData([P]),this.setTextData(this.getAllTexts()),B}},{key:"syncLineNodes",value:function(P,B){return P.properties.nodes=B,P.geometry.coordinates=_r(ur(B)),this.setLineData(function(j){return j.map(function(te){return Zi(te,P)?P:te})}),Zi(this.editLine,P)&&this.setMidPointData(this.getMidPointsByLine(P)),this.setPointData(P.properties.nodes),this.setTextData(this.getAllTexts()),P}},{key:"setActiveLine",value:function(P){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.setLineData(function(j){return vo({target:P,data:j,targetHandler:function(te){te.properties=fi(fi({},te.properties),{},{isDraw:!1,isActive:!0,isDrag:!1,isHover:!1},B)},otherHandler:function(te){te.properties=fi(fi({},te.properties),{},{isDraw:!1,isActive:!1,isDrag:!1})}})}),this.setPointData(P.properties.nodes.map(function(j){return j.properties=fi(fi({},j.properties),{},{isHover:!1,isActive:!1}),j})),this.setMidPointData(this.getMidPointsByLine(P)),this.setDashLineData([]),this.setTextData(this.getAllTexts()),P}},{key:"clearActiveLine",value:function(){this.source.setData({point:[],line:this.getLineData().map(function(P){return P.properties=fi(fi({},P.properties),{},{isActive:!1,isHover:!1}),P}),midPoint:[],text:this.getAllTexts()})}},{key:"handleLineUnClick",value:function(P){return this.clearActiveLine(),P}},{key:"handleLineHover",value:function(P){if(!this.drawLine)return this.setCursor("lineHover"),Zi(P,this.hoverLine)||this.setLineData(function(B){return vo({target:P,data:B,targetHandler:function(j){j.properties.isHover=!0},otherHandler:function(j){j.properties.isHover=!1}})}),P}},{key:"handleLineUnHover",value:function(P){if(!this.drawLine)return this.resetCursor(),this.setLineData(function(B){return B.map(function(j){return j.properties.isHover=!1,j})}),P}},{key:"handleLineDragStart",value:function(P){return this.setActiveLine(P,{isDrag:!0,isActive:!0}),this.scene.setMapStatus({dragEnable:!1}),this.setCursor("lineDrag"),P}},{key:"handleLineDragging",value:function(P,B){var j=B.lng,te=B.lat,de=P.properties.nodes,Oe=He(this.previousPosition,2),et=Oe[0],Pt=Oe[1];return de.forEach(function(Mr){var Qr=Mr.geometry.coordinates;Mr.geometry.coordinates=[Qr[0]+j-et,Qr[1]+te-Pt]}),this.syncLineNodes(P,de),this.setActiveLine(P,{isDrag:!0}),this.setCursor("lineDrag"),this.previousPosition=[j,te],P}},{key:"handleLineDragEnd",value:function(P){return P.properties.isDrag=!1,this.setLineData(function(B){return B}),this.scene.setMapStatus({dragEnable:!0}),P}},{key:"resetAdsorbLngLat",value:function(P){if(this.options.adsorbOptions){var B=this.getAdsorbPosition(Wl(Ol(P)));return B&&Ts(P,B),B}}},{key:"onPointCreate",value:function(P){if(!this.editLine){this.resetAdsorbLngLat(P);var B=ce(Rr(L.prototype),"onPointCreate",this).call(this,P),j=this.drawLine;if(B)return j?(this.syncLineNodes(j,[].concat(Pe(j.properties.nodes),[B])),this.setDashLineData([])):this.handleCreateLine(B),B}}},{key:"onPointDragStart",value:function(P){if(this.editLine)return this.setHelper("pointDrag"),ce(Rr(L.prototype),"onPointDragStart",this).call(this,P)}},{key:"onPointDragging",value:function(P){var B=ce(Rr(L.prototype),"onPointDragging",this).call(this,P);if(B){var j=this.resetAdsorbLngLat(P);j&&(B.geometry.coordinates=_c(j))}var te=this.editLine;return te&&B&&(this.syncLineNodes(te,te.properties.nodes.map(function(de){return Zi(B,de)?B:de})),this.setActiveLine(te)),B}},{key:"onPointDragEnd",value:function(P){if(this.editLine){var B=ce(Rr(L.prototype),"onPointDragEnd",this).call(this,P);return this.setPointData(function(j){return j.map(function(te){return te.properties.isActive=!1,te})}),this.setHelper("pointHover"),B}}},{key:"onLineUnClick",value:function(P){var B=this.editLine;if(B)return this.handleLineUnClick(B)}},{key:"onLineMouseMove",value:function(P){if(!this.drawLine)return this.dragLine||this.drawLine||!this.options.editable||this.setHelper("lineHover"),this.handleLineHover(P.feature)}},{key:"onLineMouseOut",value:function(P){if(!this.drawLine)return this.dragLine||this.drawLine||this.setHelper(this.addable?"draw":null),this.handleLineUnHover(P.feature)}},{key:"onLineDragStart",value:function(P){if(this.options.editable&&!this.drawLine)return this.previousPosition=Vu(P),this.setHelper("lineDrag"),this.handleLineDragStart(P.feature)}},{key:"onLineDragging",value:function(P){var B=this.dragLine;if(B)return this.handleLineDragging(B,Ol(P))}},{key:"onLineDragEnd",value:function(P){var B=this.dragLine;if(B)return this.setHelper("lineHover"),this.handleLineDragEnd(B)}},{key:"onPointMouseMove",value:function(P){var B=ce(Rr(L.prototype),"onPointMouseMove",this).call(this,P);return this.dragLine||this.drawLine||this.dragPoint||this.setHelper("pointHover"),B}},{key:"onPointMouseOut",value:function(P){var B=ce(Rr(L.prototype),"onPointMouseOut",this).call(this,P);return this.dragLine||this.drawLine||this.dragPoint||this.setHelper(this.addable?"draw":null),B}},{key:"onMidPointHover",value:function(P){ce(Rr(L.prototype),"onMidPointHover",this).call(this,P),this.setHelper("midPointHover")}},{key:"onMidPointUnHover",value:function(P){ce(Rr(L.prototype),"onMidPointUnHover",this).call(this,P),this.setHelper(null)}},{key:"onPointClick",value:function(P){}},{key:"getLineData",value:function(){return this.source.getRenderData("line")}},{key:"setLineData",value:function(P){return this.source.setRenderData("line",P)}},{key:"getTextData",value:function(){return this.source.getRenderData("text")}},{key:"setTextData",value:function(P){return this.source.setRenderData("text",P)}},{key:"getDashLineData",value:function(){return this.source.getRenderData("dashLine")}},{key:"setDashLineData",value:function(P){return this.source.setRenderData("dashLine",P)}},{key:"onMidPointClick",value:function(P){var B=this.editLine,j=P.feature;if(B&&j&&!this.dragPoint){var te=B.properties.nodes,de=j.properties,Oe=de.startId,et=de.endId,Pt=te.findIndex(function(Xn){return Xn.properties.id===Oe}),Mr=te.findIndex(function(Xn){return Xn.properties.id===et});if(Pt>-1&&Mr>-1){var Qr=go(j.geometry.coordinates,{isDrag:!0,isHover:!0});return this.setHelper("pointDrag"),te.splice(Mr,0,Qr),B.geometry.coordinates=_r(ur(te)),this.syncLineNodes(B,te),this.setActiveLine(B),Qr}}}},{key:"enableSceneRenderAction",value:function(){this.sceneRender.enableDrag(),this.sceneRender.enableMouseMove(),this.sceneRender.enableDblClick()}},{key:"disableSceneRenderAction",value:function(){this.sceneRender.disableDrag(),this.sceneRender.disableMouseMove(),this.sceneRender.disableDblClick()}},{key:"enableLineRenderAction",value:function(){var P,B,j,te=this.options.editable;(P=this.lineRender)===null||P===void 0||P.enableUnClick(),te&&((B=this.lineRender)===null||B===void 0||B.enableHover(),(j=this.lineRender)===null||j===void 0||j.enableDrag())}},{key:"disableLineRenderAction",value:function(){var P,B,j;(P=this.lineRender)===null||P===void 0||P.disableUnClick(),(B=this.lineRender)===null||B===void 0||B.disableHover(),(j=this.lineRender)===null||j===void 0||j.disableDrag()}}]),L}(Rn),wr=function(E){Cr(L,E);var A=De(L);function L(){return is(this,L),A.apply(this,arguments)}return mt(L,[{key:"dragItem",get:function(){return this.dragPolygon}},{key:"editItem",get:function(){return this.editPolygon}},{key:"polygonRender",get:function(){return this.render.polygon}},{key:"dragPolygon",get:function(){return this.getPolygonData().find(function(P){return P.properties.isDrag})}},{key:"drawPolygon",get:function(){return this.getPolygonData().find(function(P){return P.properties.isDraw})}},{key:"editPolygon",get:function(){return this.getPolygonData().find(function(P){var B=P.properties;return!B.isDraw&&B.isActive})}},{key:"hoverPolygon",get:function(){return this.getPolygonData().find(function(P){return P.properties.isHover})}},{key:"getDragPolygon",value:function(){return this.dragPolygon}},{key:"getDrawPolygon",value:function(){return this.drawPolygon}},{key:"getEditPolygon",value:function(){return this.editPolygon}},{key:"getRenderTypes",value:function(){return["polygon","line","dashLine","midPoint","point","text"]}},{key:"getData",value:function(){return this.getPolygonData()}},{key:"getDefaultOptions",value:function(P){var B=fi(fi({},ce(Rr(L.prototype),"getDefaultOptions",this).call(this,P)),{},{areaOptions:!1,helper:_c(ir)});return P.areaOptions&&(B.areaOptions=fi(fi({},$s),P.areaOptions)),B}},{key:"getAreaTexts",value:function(P){var B=this.options.areaOptions;if(!B)return[];var j=B.format,te=B.showWhen,de=[],Oe=P.filter(function(et){return et.geometry.coordinates[0].length>=4});return te.includes("active")&&Oe.filter(function(et){return et.properties.isActive}).forEach(function(et){de.push(pc(et,{format:j},{isActive:!0}))}),te.includes("normal")&&Oe.filter(function(et){return!et.properties.isActive}).forEach(function(et){de.push(pc(et,{format:j},{isActive:!1}))}),de}},{key:"getAllTexts",value:function(){return[].concat(Pe(ce(Rr(L.prototype),"getAllTexts",this).call(this)),Pe(this.getAreaTexts(this.getPolygonData())))}},{key:"getPolygonData",value:function(){return this.source.getRenderData("polygon")}},{key:"setPolygonData",value:function(P){return this.source.setRenderData("polygon",P)}},{key:"handleCreatePolygon",value:function(P,B){var j=xu(P,{nodes:P,line:B,isActive:!0,isDraw:!0});return this.setPolygonData(function(te){return vo({target:j,data:[].concat(Pe(te),[j]),otherHandler:function(de){de.properties.isActive=!1}})}),j}},{key:"handlePolygonUnClick",value:function(P){return this.clearActivePolygon(),P}},{key:"handlePolygonHover",value:function(P){return this.setCursor("polygonHover"),Zi(P,this.hoverPolygon)||this.setPolygonData(function(B){return vo({target:P,data:B,targetHandler:function(j){j.properties.isHover=!0},otherHandler:function(j){j.properties.isHover=!1}})}),P}},{key:"handlePolygonUnHover",value:function(){this.resetCursor(),this.setPolygonData(function(P){return P.map(function(B){return B.properties.isHover=!1,B})})}},{key:"handlePolygonDragStart",value:function(P){return this.setActivePolygon(P,{isDrag:!0}),this.scene.setMapStatus({dragEnable:!1}),this.setCursor("polygonDrag"),P}},{key:"bindPolygonRenderEvent",value:function(){var P,B,j,te;(P=this.polygonRender)===null||P===void 0||P.on(D.RenderEvent.UnClick,this.onPolygonUnClick.bind(this)),(B=this.polygonRender)===null||B===void 0||B.on(D.RenderEvent.Mousemove,this.onPolygonHover.bind(this)),(j=this.polygonRender)===null||j===void 0||j.on(D.RenderEvent.Mouseout,this.onPolygonUnHover.bind(this)),(te=this.polygonRender)===null||te===void 0||te.on(D.RenderEvent.Dragstart,this.onPolygonDragStart.bind(this))}},{key:"syncPolygonNodes",value:function(P,B){var j=_r(ur([].concat(Pe(B),[ri(B)]))),te=P.properties,de=te.line;if(P.properties.nodes=B,P.geometry.coordinates=[Fc(nr(j))?j:j.reverse()],this.setPolygonData(function(Qr){return Qr.map(function(Xn){return Zi(Xn,P)?P:Xn})}),!Zi(this.drawPolygon,P)){var Oe=de.properties.nodes,et=Pe(B),Pt=ri(et);et.push(Oe.length===B.length?go(Pt.geometry.coordinates):lr(Oe));var Mr=lr(et);jo(Pt.geometry.coordinates,Mr.geometry.coordinates)||(Mr.geometry.coordinates=_c(Pt.geometry.coordinates)),this.syncLineNodes(de,et)}return P}},{key:"setActivePolygon",value:function(P){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.setActiveLine(P.properties.line,B),this.setPolygonData(function(j){return vo({target:P,data:j,targetHandler:function(te){te.properties=fi(fi({},te.properties),{},{isDraw:!1,isActive:!0,isDrag:!1,isHover:!1},B)},otherHandler:function(te){te.properties=fi(fi({},te.properties),{},{isDraw:!1,isActive:!1,isDrag:!1})}})}),this.setTextData(this.getAllTexts()),P}},{key:"clearActivePolygon",value:function(){this.setPolygonData(function(P){return P.map(function(B){return B.properties=fi(fi({},B.properties),{},{isActive:!1,isHover:!1}),B})}),this.clearActiveLine()}},{key:"onLineDragStart",value:function(P){var B=ce(Rr(L.prototype),"onLineDragStart",this).call(this,P),j=this.getPolygonData().find(function(te){return Zi(te.properties.line,B)});return j&&(this.setActivePolygon(j,{isDrag:!0}),this.emit(D.DrawEvent.DragStart,j,this.getPolygonData())),B}},{key:"onLineUnClick",value:function(P){return this.editLine}},{key:"onLineDragEnd",value:function(P){var B=ce(Rr(L.prototype),"onLineDragEnd",this).call(this,P),j=this.dragPolygon;return B&&j&&(j.properties.isDrag=!1,this.emit(D.DrawEvent.DragEnd,j,this.getPolygonData()),this.emit(D.DrawEvent.Edit,j,this.getPolygonData())),B}},{key:"onPolygonUnClick",value:function(P){var B=this.editPolygon;if(B)return this.handlePolygonUnClick(B)}},{key:"onPolygonHover",value:function(P){if(!this.drawPolygon)return this.dragPolygon||this.setHelper("polygonHover"),this.handlePolygonHover(P.feature)}},{key:"onPolygonUnHover",value:function(P){if(!this.drawPolygon)return this.setHelper(this.addable?"draw":null),this.handlePolygonUnHover()}},{key:"onPolygonDragStart",value:function(P){if(this.options.editable&&!this.drawPolygon){var B=P.feature;return this.previousPosition=Vu(P),this.setHelper("polygonDrag"),this.emit(D.DrawEvent.DragStart,B,this.getPolygonData()),this.handlePolygonDragStart(B)}}},{key:"onMidPointClick",value:function(P){var B=this.editPolygon,j=ce(Rr(L.prototype),"onMidPointClick",this).call(this,P);if(j&&B){var te=B.properties.line.properties.nodes;this.syncPolygonNodes(B,te.slice(0,te.length-1)),this.setActivePolygon(B)}return j}},{key:"onPointDragEnd",value:function(P){var B=this.editPolygon,j=ce(Rr(L.prototype),"onPointDragEnd",this).call(this,P);return j&&B&&this.emit(D.DrawEvent.Edit,B,this.getPolygonData()),j}},{key:"enablePolygonRenderAction",value:function(){var P,B,j,te=this.options.editable;(P=this.polygonRender)===null||P===void 0||P.enableUnClick(),te&&((B=this.polygonRender)===null||B===void 0||B.enableHover(),(j=this.polygonRender)===null||j===void 0||j.enableDrag())}},{key:"disablePolygonRenderAction",value:function(){var P,B,j;(P=this.polygonRender)===null||P===void 0||P.disableUnClick(),(B=this.polygonRender)===null||B===void 0||B.disableHover(),(j=this.polygonRender)===null||j===void 0||j.disableDrag()}},{key:"bindEnableEvent",value:function(){ce(Rr(L.prototype),"bindEnableEvent",this).call(this),this.enableSceneRenderAction(),this.enablePointRenderAction(),this.enableLineRenderAction(),this.enableMidPointRenderAction(),this.enablePolygonRenderAction()}},{key:"unbindEnableEvent",value:function(){ce(Rr(L.prototype),"unbindEnableEvent",this).call(this),this.disableSceneRenderAction(),this.disablePointRenderAction(),this.disableLineRenderAction(),this.disableMidPointRenderAction(),this.disablePolygonRenderAction()}},{key:"bindThis",value:function(){ce(Rr(L.prototype),"bindThis",this).call(this),this.bindPointRenderEvent=this.bindPointRenderEvent.bind(this),this.bindSceneEvent=this.bindSceneEvent.bind(this),this.bindLineRenderEvent=this.bindLineRenderEvent.bind(this),this.bindMidPointRenderEvent=this.bindMidPointRenderEvent.bind(this),this.bindPolygonRenderEvent=this.bindPolygonRenderEvent.bind(this)}},{key:"setActiveFeature",value:function(P){var B=this.getTargetFeature(P);B?this.setActivePolygon(B):this.clearActivePolygon()}},{key:"resetFeatures",value:function(){var P=this.getPolygonData();this.drawPolygon&&(P=P.filter(function(B){return!B.properties.isDraw}),this.source.setData({point:[],dashLine:[],midPoint:[]}),this.setLineData(function(B){return B.filter(function(j){return!j.properties.isDraw})}),this.setTextData(function(B){return B.filter(function(j){return!j.properties.isActive})})),this.editPolygon&&this.handlePolygonUnClick(this.editPolygon),this.setPolygonData(P.map(function(B){return B.properties=fi(fi({},B.properties),{},{isDrag:!1,isActive:!1,isHover:!1}),B}))}}]),L}(Wr),nn=function(E){Cr(L,E);var A=De(L);function L(P,B){var j;return is(this,L),(j=A.call(this,P,B)).onSceneDragStart=j.onSceneDragStart.bind(Pa(j)),j.onSceneDragEnd=j.onSceneDragEnd.bind(Pa(j)),j}return mt(L,[{key:"drawLine",get:function(){var P;return(P=this.drawPolygon)===null||P===void 0?void 0:P.properties.line}},{key:"isDragTrigger",get:function(){return this.options.trigger==="drag"}},{key:"isClickTrigger",get:function(){return this.options.trigger==="click"}},{key:"getDefaultOptions",value:function(P){var B=fi(fi({},ce(Rr(L.prototype),"getDefaultOptions",this).call(this,P)),{},{showMidPoint:!1,trigger:"click",autoActive:!1,helper:_c(Rt)});return P.trigger==="drag"&&(B.helper=fi(fi({},B.helper),Zr)),B}},{key:"getMidPointsByLine",value:function(P){return[]}},{key:"handleCreatePolygon",value:function(P,B){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},te=B.properties.nodes;return xu(te.slice(0,te.length-1),fi({nodes:P,line:B},j))}},{key:"handleFirstNodeCreate",value:function(P){var B=go(P.geometry.coordinates),j=this.handleCreatePolygonLine(P,B,{isDraw:!0,isActive:!0}),te=this.handleCreatePolygon([P,B],j,{isDraw:!0,isActive:!0});return this.setPolygonData(function(de){return vo({target:te,data:[].concat(Pe(de),[te]),targetHandler:function(Oe){Oe.properties=fi(fi({},Oe.properties),{},{isDraw:!0,isActive:!0})}})}),this.emit(D.DrawEvent.AddNode,P,this.drawPolygon,this.getPolygonData()),this.setHelper("drawFinish"),P}},{key:"handleLastNodeCreate",value:function(P){var B=this.options,j=B.autoActive,te=B.editable,de=this.drawPolygon;return de&&(this.setLineData(function(Oe){return[].concat(Pe(Oe),[de.properties.line])}),this.setActivePolygon(de),j&&te||this.handlePolygonUnClick(de),this.emit(D.DrawEvent.Add,de,this.getPolygonData()),this.emit(D.DrawEvent.AddNode,de.properties.nodes[1],this.drawPolygon,this.getPolygonData()),this.setHelper(te?j?"pointHover":"polygonHover":this.addable?"draw":null)),P}},{key:"onPointCreate",value:function(P){var B=this;if(this.addable&&!this.dragPoint&&!this.editLine&&this.isClickTrigger){var j=this.drawPolygon,te=Vu(P),de=this.handleCreatePoint(te);return j?requestAnimationFrame(function(){B.handleLastNodeCreate(de)}):this.handleFirstNodeCreate(de),de}}},{key:"setActivePolygon",value:function(P){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.setActiveLine(P.properties.line,B),this.setPolygonData(function(te){return vo({target:P,data:te,targetHandler:function(de){de.properties=fi(fi({},de.properties),{},{isDraw:!1,isActive:!0,isDrag:!1,isHover:!1},B)},otherHandler:function(de){de.properties=fi(fi({},de.properties),{},{isDraw:!1,isActive:!1,isDrag:!1})}})}),this.setPointData(P.properties.nodes),this.setDashLineData([]);var j=this.getAllTexts();return this.setTextData(j),P}},{key:"onPointDragging",value:function(P){var B=this.dragPoint;if(B){var j=this.handlePointDragging(B,Ol(P)),te=this.editPolygon;return j&&te&&(this.syncPolygonNodes(te,te.properties.nodes.map(function(de){return Zi(de,j)?j:de})),this.setActivePolygon(te)),j}}},{key:"onSceneDragStart",value:function(P){this.isDragTrigger&&this.addable&&!this.dragPoint&&!this.editLine&&(this.scene.setMapStatus({dragEnable:!1}),this.handleFirstNodeCreate(this.handleCreatePoint(Vu(P))))}},{key:"onSceneDragEnd",value:function(P){this.isDragTrigger&&this.addable&&!this.dragPoint&&!this.editLine&&this.drawPolygon&&(this.scene.setMapStatus({dragEnable:!1}),this.handleLastNodeCreate(this.handleCreatePoint(Vu(P))))}},{key:"onSceneMouseMove",value:function(P){var B=this.drawPolygon;if(B){var j=B.properties.nodes,te=ri(j),de=lr(j);de.geometry.coordinates=Vu(P),this.syncPolygonNodes(B,[te,de]),this.setDashLineData([B.properties.line]),this.setTextData(this.getAllTexts()),this.resetCursor()}}},{key:"bindSceneDragEvent",value:function(){this.unbindSceneDragEvent(),this.sceneRender.on(D.RenderEvent.Dragstart,this.onSceneDragStart),this.sceneRender.on(D.RenderEvent.Dragend,this.onSceneDragEnd),this.scene.setMapStatus({dragEnable:!1})}},{key:"unbindSceneDragEvent",value:function(){this.sceneRender.off(D.RenderEvent.Dragstart,this.onSceneDragStart),this.sceneRender.off(D.RenderEvent.Dragend,this.onSceneDragEnd),this.scene.setMapStatus({dragEnable:!0})}},{key:"bindEnableEvent",value:function(){ce(Rr(L.prototype),"bindEnableEvent",this).call(this),this.isDragTrigger&&this.bindSceneDragEvent()}},{key:"unbindEnableEvent",value:function(){ce(Rr(L.prototype),"unbindEnableEvent",this).call(this),this.isDragTrigger&&this.unbindSceneDragEvent()}},{key:"bindThis",value:function(){ce(Rr(L.prototype),"bindThis",this).call(this),this.onSceneDragStart=this.onSceneDragStart.bind(this),this.onSceneDragEnd=this.onSceneDragEnd.bind(this)}}]),L}(wr),Wt=function(E){Cr(L,E);var A=De(L);function L(P,B){var j;return is(this,L),(j=A.call(this,P,B)).bindPointRenderEvent(),j.bindSceneEvent(),j.bindMidPointRenderEvent(),j.bindLineRenderEvent(),j.bindPolygonRenderEvent(),j}return mt(L,[{key:"getDefaultOptions",value:function(P){var B=fi(fi({},ce(Rr(L.prototype),"getDefaultOptions",this).call(this,P)),{},{showMidPoint:!1,circleSteps:60});return B.distanceOptions&&(B.distanceOptions.showTotalDistance=!0,B.distanceOptions.showOnRadius===void 0&&(B.distanceOptions.showOnRadius=!0)),B.helper&&(B.helper=fi(fi({},B.helper),jn)),B}},{key:"getDistanceTexts",value:function(){var P=this.options.distanceOptions;if(!P)return[];var B=[],j=P.showWhen,te=P.showDashDistance,de=P.format,Oe=P.showTotalDistance;return B.push.apply(B,Pe(this.getDashLineDistanceTexts(this.getDashLineData(),{showTotalDistance:!0,format:de,showDashDistance:te})).concat(Pe(this.getLineDistanceTexts(this.getLineData(),{showTotalDistance:Oe,format:de,showWhen:j})))),B}},{key:"setData",value:function(P){var B=this,j=P.map(function(te){var de,Oe,et;te.properties=fi(fi({},ba()),te.properties);var Pt=(de=te.properties)===null||de===void 0?void 0:de.nodes;if(((Oe=Pt)===null||Oe===void 0?void 0:Oe.length)!==2){var Mr=He(Gc(te).geometry.coordinates,2),Qr=Mr[0],Xn=Mr[1],ii=$a(te),li=ii[2],Mn=(ii[1]+ii[3])/2;Pt=[go([Qr,Xn]),go([li,Mn])],te.properties.nodes=Pt}var wn=Pt[0],Vn=Pt[1],br=!!(!((et=te.properties)===null||et===void 0)&&et.isActive),si=te.properties.line;return si||(si=B.handleCreatePolygonLine(wn,Vn,{isActive:br}),te.properties.line=si),B.handleCreatePolygon([wn,Vn],si,fi(fi({},te.properties),{},{isActive:br}))});this.source.setData({point:[],midPoint:[],dashLine:[],polygon:j,line:j.map(function(te){return te.properties.line})}),this.setTextData(this.getAllTexts()),this.editPolygon&&this.setActivePolygon(this.editPolygon)}},{key:"handleCreatePolygonLine",value:function(P,B){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},te=this.getBoundaryPositions(P,B),de=te.map(function(Oe){return go(Oe)});return Wo(de,j)}},{key:"syncPolygonNodes",value:function(P,B){var j=P.properties.line,te=this.getBoundaryPositions(B[0],B[1]);return P.properties.nodes=B,P.geometry.coordinates=[te],this.setPolygonData(function(de){return de.map(function(Oe){return Zi(Oe,P)?P:Oe})}),this.setPointData(P.properties.isDraw?[B[0]]:B),j.properties.nodes.forEach(function(de,Oe){de.geometry.coordinates=te[Oe]}),j.geometry.coordinates=te,P}},{key:"onLineDragging",value:function(P){var B=this.dragPolygon,j=He(this.previousPosition,2),te=j[0],de=j[1],Oe=ce(Rr(L.prototype),"onLineDragging",this).call(this,P);if(B){var et=He(Vu(P),2),Pt=et[0],Mr=et[1];B.properties.nodes.forEach(function(Qr){var Xn=He(Qr.geometry.coordinates,2);Qr.geometry.coordinates=[Xn[0]+Pt-te,Xn[1]+Mr-de]}),this.syncPolygonNodes(B,B.properties.nodes),this.setActivePolygon(B,{isDrag:!0}),this.emit(D.DrawEvent.Dragging,B,this.getPolygonData())}return Oe}},{key:"getBoundaryPositions",value:function(P,B){for(var j=this.options.circleSteps,te=ec(P,B,{units:"meters"}),de=ha(P,B),Oe=360/j,et=[Pe(B.geometry.coordinates)],Pt=1;j-1>=Pt;Pt++)et.push(df(P,te,de+Oe*Pt,{units:"meters"}).geometry.coordinates);return et.push(Pe(B.geometry.coordinates)),et}}]),L}(nn),Or=function(E){Cr(L,E);var A=De(L);function L(P,B){var j;return is(this,L),(j=A.call(this,P,B)).drawLineFinish=function(){var te,de=j.drawLine,Oe=(te=de==null?void 0:de.properties.nodes)!==null&&te!==void 0?te:[];if(de&&(Oe==null?void 0:Oe.length)>1){j.setActiveLine(de);var et=j.options,Pt=et.autoActive,Mr=et.editable;Pt&&Mr||j.handleLineUnClick(de),j.setHelper(Mr&&Pt?"pointHover":j.addable?"draw":null),j.emit(D.DrawEvent.Add,de,j.getLineData())}},j.sceneRender.on(D.RenderEvent.DblClick,j.drawLineFinish),j.bindPointRenderEvent(),j.bindSceneEvent(),j.bindMidPointRenderEvent(),j.bindLineRenderEvent(),j}return mt(L,[{key:"dragItem",get:function(){return this.dragLine}},{key:"editItem",get:function(){return this.editLine}},{key:"setData",value:function(P){var B=P.map(function(j){var te,de;return j.properties=fi(fi({},Hi()),(te=j.properties)!==null&&te!==void 0?te:{}),!((de=j.properties.nodes)===null||de===void 0)&&de.length||(j.properties.nodes=_r(j).map(function(Oe){return go(Oe)})),j});this.source.setData({point:[],midPoint:[],dashLine:[],line:B}),this.setTextData(this.getAllTexts()),this.editLine&&this.setActiveLine(this.editLine)}},{key:"getData",value:function(){return this.getLineData()}},{key:"getRenderTypes",value:function(){return["line","dashLine","midPoint","point","text"]}},{key:"bindPointRenderEvent",value:function(){var P;ce(Rr(L.prototype),"bindPointRenderEvent",this).call(this),(P=this.pointRender)===null||P===void 0||P.on(D.RenderEvent.Contextmenu,this.onPointContextMenu.bind(this))}},{key:"onPointClick",value:function(P){var B,j=this,te=this.drawLine,de=(B=te==null?void 0:te.properties.nodes)!==null&&B!==void 0?B:[],Oe=P.feature;if(Zi(Oe,lr(de)))requestAnimationFrame(function(){j.drawLineFinish()});else{var et=He(Oe.geometry.coordinates,2);P.lngLat={lng:et[0],lat:et[1]},this.onPointCreate(P)}}},{key:"removeNode",value:function(P,B){var j,te=this.getTargetFeature(B),de=this.getTargetFeature(P,(j=te==null?void 0:te.properties.nodes)!==null&&j!==void 0?j:[]);if(te&&de){var Oe,et=(Oe=te==null?void 0:te.properties.nodes)!==null&&Oe!==void 0?Oe:[];if(3>et.length)return;this.syncLineNodes(te,et.filter(function(Pt){return!Zi(de,Pt)})),this.emit(D.DrawEvent.RemoveNode,de,te,this.getLineData()),this.emit(D.DrawEvent.Edit,te,this.getLineData())}}},{key:"onPointContextMenu",value:function(P){var B,j=this.editLine,te=P.feature,de=(B=j==null?void 0:j.properties.nodes)!==null&&B!==void 0?B:[];if(j&&de.length>=3)return this.removeNode(te,j),te}},{key:"onPointCreate",value:function(P){if(this.addable){var B=ce(Rr(L.prototype),"onPointCreate",this).call(this,P);return B&&(this.setHelper("drawFinish"),this.emit(D.DrawEvent.AddNode,B,this.drawLine,this.getLineData())),B}}},{key:"onPointDragEnd",value:function(P){var B=this.editLine,j=ce(Rr(L.prototype),"onPointDragEnd",this).call(this,P);return B&&j&&this.emit(D.DrawEvent.Edit,B,this.getLineData()),j}},{key:"onLineDragStart",value:function(P){var B=ce(Rr(L.prototype),"onLineDragStart",this).call(this,P);return B&&this.emit(D.DrawEvent.DragStart,B,this.getLineData()),B}},{key:"onLineDragging",value:function(P){var B=ce(Rr(L.prototype),"onLineDragging",this).call(this,P);return B&&this.emit(D.DrawEvent.Dragging,B,this.getLineData()),B}},{key:"onLineDragEnd",value:function(P){var B=ce(Rr(L.prototype),"onLineDragEnd",this).call(this,P);return B&&(this.emit(D.DrawEvent.DragEnd,B,this.getLineData()),this.emit(D.DrawEvent.Edit,B,this.getLineData())),B}},{key:"onMidPointClick",value:function(P){var B=this.editLine,j=ce(Rr(L.prototype),"onMidPointClick",this).call(this,P);return B&&j&&(this.emit(D.DrawEvent.Edit,B,this.getLineData()),this.emit(D.DrawEvent.AddNode,j,B,this.getLineData())),j}},{key:"onSceneMouseMove",value:function(P){var B=this.drawLine;if(B){var j,te=lr(B.properties.nodes),de=Vu(P);this.options.adsorbOptions&&(de=(j=this.getAdsorbPosition(de))!==null&&j!==void 0?j:de),this.setDashLineData([Ps([de,te.geometry.coordinates])]),this.setTextData(this.getAllTexts())}}},{key:"setActiveFeature",value:function(P){var B=this.getTargetFeature(P);B?this.setActiveLine(B):this.clearActiveLine()}},{key:"resetFeatures",value:function(){var P=this.getLineData();this.drawLine&&(P=P.filter(function(B){return!B.properties.isDraw}),this.source.setData({point:[],dashLine:[],midPoint:[]}),this.setTextData(function(B){return B.filter(function(j){return!j.properties.isActive})})),this.editLine&&this.handleLineUnClick(this.editLine),this.setLineData(P.map(function(B){return B.properties=fi(fi({},B.properties),{},{isDrag:!1,isActive:!1,isHover:!1}),B}))}},{key:"enablePointRenderAction",value:function(){var P;ce(Rr(L.prototype),"enablePointRenderAction",this).call(this),this.options.editable&&((P=this.pointRender)===null||P===void 0||P.enableContextMenu())}},{key:"disablePointRenderAction",value:function(){var P;ce(Rr(L.prototype),"disablePointRenderAction",this).call(this),(P=this.pointRender)===null||P===void 0||P.disableContextMenu()}},{key:"bindEnableEvent",value:function(){ce(Rr(L.prototype),"bindEnableEvent",this).call(this),this.enableSceneRenderAction(),this.enablePointRenderAction(),this.enableLineRenderAction(),this.enableMidPointRenderAction(),this.sceneRender.enableDblClick()}},{key:"unbindEnableEvent",value:function(){ce(Rr(L.prototype),"unbindEnableEvent",this).call(this),this.disableSceneRenderAction(),this.disablePointRenderAction(),this.disableLineRenderAction(),this.disableMidPointRenderAction(),this.sceneRender.disableDblClick()}},{key:"bindThis",value:function(){ce(Rr(L.prototype),"bindThis",this).call(this),this.bindPointRenderEvent=this.bindPointRenderEvent.bind(this),this.bindSceneEvent=this.bindSceneEvent.bind(this),this.bindLineRenderEvent=this.bindLineRenderEvent.bind(this),this.bindMidPointRenderEvent=this.bindMidPointRenderEvent.bind(this)}}]),L}(Wr),ar=function(E){Cr(L,E);var A=De(L);function L(P,B){var j;return is(this,L),(j=A.call(this,P,B)).bindPointRenderEvent(),j}return mt(L,[{key:"dragItem",get:function(){return this.dragPoint}},{key:"editItem",get:function(){return this.editPoint}},{key:"getDefaultOptions",value:function(P){var B=fi(fi({},this.getCommonOptions(P)),{},{helper:_c(ro)});return B.style.point=Mf,B}},{key:"bindEnableEvent",value:function(){ce(Rr(L.prototype),"bindEnableEvent",this).call(this),this.enablePointRenderAction()}},{key:"unbindEnableEvent",value:function(){ce(Rr(L.prototype),"unbindEnableEvent",this).call(this),this.disablePointRenderAction()}},{key:"getRenderTypes",value:function(){return["point"]}},{key:"setData",value:function(P){this.setPointData(P.map(function(B){var j;return B.properties=fi(fi({},Bo()),(j=B.properties)!==null&&j!==void 0?j:{}),B}))}},{key:"getData",value:function(){return this.getPointData()}},{key:"onPointCreate",value:function(P){if(this.addable){var B=ce(Rr(L.prototype),"onPointCreate",this).call(this,P);if(B)return this.options.editable&&this.setHelper("pointHover"),this.emit(D.DrawEvent.Add,B,this.getData()),B}else this.setPointData(function(j){return j.map(function(te){return te.properties=fi(fi({},te.properties),{},{isHover:!1,isActive:!1}),te})})}},{key:"onPointMouseMove",value:function(P){var B=ce(Rr(L.prototype),"onPointMouseMove",this).call(this,P);return this.options.editable&&!this.dragPoint&&this.setHelper("pointHover"),B}},{key:"onPointMouseOut",value:function(P){var B=ce(Rr(L.prototype),"onPointMouseOut",this).call(this,P);return this.setHelper(this.addable?"draw":null),B}},{key:"onPointDragStart",value:function(P){var B=ce(Rr(L.prototype),"onPointDragStart",this).call(this,P);return this.setHelper("pointDrag"),this.emit(D.DrawEvent.DragStart,B,this.getData()),B}},{key:"onPointDragging",value:function(P){var B=ce(Rr(L.prototype),"onPointDragging",this).call(this,P);return B&&this.options.editable&&this.emit(D.DrawEvent.Dragging,B,this.getData()),B}},{key:"onPointDragEnd",value:function(P){var B=ce(Rr(L.prototype),"onPointDragEnd",this).call(this,P);return B&&this.options.editable&&(this.setHelper("pointHover"),this.emit(D.DrawEvent.DragEnd,B,this.getData()),this.emit(D.DrawEvent.Edit,B,this.getData())),B}},{key:"bindThis",value:function(){ce(Rr(L.prototype),"bindThis",this).call(this),this.bindPointRenderEvent=this.bindPointRenderEvent.bind(this)}},{key:"onSceneMouseMove",value:function(P){}},{key:"setActiveFeature",value:function(P){var B=this.getTargetFeature(P);this.setPointData(function(j){return j.map(function(te){return te.properties.isActive=Zi(B,te),te})})}},{key:"resetFeatures",value:function(){this.setPointData(function(P){return P.map(function(B){return B.properties=fi(fi({},B.properties),{},{isDrag:!1,isActive:!1,isHover:!1}),B})})}}]),L}(Wn),xn=function(E){Cr(L,E);var A=De(L);function L(P,B){var j;return is(this,L),(j=A.call(this,P,B)).drawPolygonFinish=function(){var te,de=j.drawPolygon,Oe=(te=de==null?void 0:de.properties.nodes)!==null&&te!==void 0?te:[];if(de&&Oe.length>=3){de.properties.isDraw=!1,j.syncPolygonNodes(de,Oe),j.setActivePolygon(de);var et=j.options,Pt=et.autoActive,Mr=et.editable;Pt&&Mr||j.handlePolygonUnClick(de),j.setHelper(Mr?Pt?"pointHover":"polygonHover":j.addable?"draw":null),j.emit(D.DrawEvent.Add,de,j.getPolygonData())}},j.sceneRender.on(D.RenderEvent.DblClick,j.drawPolygonFinish),j.bindPointRenderEvent(),j.bindSceneEvent(),j.bindMidPointRenderEvent(),j.bindLineRenderEvent(),j.bindPolygonRenderEvent(),j}return mt(L,[{key:"getDefaultOptions",value:function(P){return fi(fi({},ce(Rr(L.prototype),"getDefaultOptions",this).call(this,P)),{},{liveUpdate:!1})}},{key:"setData",value:function(P){var B=P.map(function(j){var te,de;if(j.properties=fi(fi({},ba()),(te=j.properties)!==null&&te!==void 0?te:{}),!(!((de=j.properties.nodes)===null||de===void 0)&&de.length)){var Oe=_r(j);Oe=Oe.slice(0,Oe.length-1),j.properties.nodes=Oe.map(function(Pt){return go(Pt)})}if(!j.properties.line){var et=j.properties.nodes;j.properties.line=Wo([].concat(Pe(et),[go(ri(et).geometry.coordinates)]))}return j});this.source.setData({point:[],midPoint:[],dashLine:[],polygon:B,line:B.map(function(j){return j.properties.line})}),this.setTextData(this.getAllTexts()),this.editPolygon&&this.setActivePolygon(this.editPolygon)}},{key:"onPointCreate",value:function(P){if(this.addable&&!this.dragPoint){var B=ce(Rr(L.prototype),"onPointCreate",this).call(this,P),j=this.drawPolygon,te=this.drawLine;return B&&(j?(this.syncPolygonNodes(j,[].concat(Pe(j.properties.nodes),[B])),this.setDashLineData([Ps([Vu(P),j.properties.nodes[0].geometry.coordinates])]),j.properties.nodes.length>1&&this.setHelper("drawFinish")):te&&(this.handleCreatePolygon([B],te),this.setHelper("drawContinue")),this.emit(D.DrawEvent.AddNode,B,j,this.getPolygonData())),B}}},{key:"onPointClick",value:function(P){var B=this,j=this.drawPolygon,te=P.feature;if(j){var de=j.properties.nodes;if(de.length<3||!Zi(ri(de),te)&&!Zi(lr(de),te)){var Oe=He(te.geometry.coordinates,2);P.lngLat={lng:Oe[0],lat:Oe[1]},this.onPointCreate(P)}else requestAnimationFrame(function(){B.drawPolygonFinish()})}}},{key:"onPointDragging",value:function(P){var B=this.dragPoint,j=this.editPolygon;if(B&&j){var te=j.properties.line;te.properties.nodes=te.properties.nodes.map(function(Xn){return Zi(Xn,B)?B:Xn});var de=te.properties.nodes,Oe=de.slice(0,de.length-1),et=ri(de),Pt=lr(de),Mr=Zi(et,B)||Zi(Pt,B);if(Mr&&(et.geometry.coordinates=Pt.geometry.coordinates=Vu(P)),this.options.adsorbOptions&&Mr){var Qr=this.resetAdsorbLngLat(P);Qr&&(et.geometry.coordinates=Pt.geometry.coordinates=Qr)}ce(Rr(L.prototype),"onPointDragging",this).call(this,P),this.syncPolygonNodes(j,Oe),this.setActivePolygon(j)}return B}},{key:"onLineDragging",value:function(P){var B=this.dragPolygon,j=ce(Rr(L.prototype),"onLineDragging",this).call(this,P);if(j&&B){var te=j.properties.nodes;this.syncPolygonNodes(B,te.slice(0,te.length-1)),this.emit(D.DrawEvent.Dragging,B,this.getPolygonData())}return j}},{key:"onMidPointClick",value:function(P){var B=ce(Rr(L.prototype),"onMidPointClick",this).call(this,P),j=this.editPolygon;return B&&j&&(this.emit(D.DrawEvent.Edit,j,this.getPolygonData()),this.emit(D.DrawEvent.AddNode,B,j,this.getPolygonData())),B}},{key:"onSceneMouseMove",value:function(P){var B,j=this.drawPolygon,te=(B=j==null?void 0:j.properties.nodes)!==null&&B!==void 0?B:[];if(j&&te.length){this.options.adsorbOptions&&this.resetAdsorbLngLat(P);var de=Vu(P),Oe=[];if(Oe.push(Ps([de,ri(te).geometry.coordinates])),te.length>1&&Oe.push(Ps([de,lr(te).geometry.coordinates])),this.options.liveUpdate&&te.length>=2){var et=_r(ur(te));j.geometry.coordinates=[[].concat(Pe(et),[de,et[0]])],this.setPolygonData(this.getPolygonData())}this.setDashLineData(Oe),this.setTextData(this.getAllTexts())}}},{key:"removeNode",value:function(P,B){var j,te=this.getTargetFeature(B),de=this.getTargetFeature(P,(j=te==null?void 0:te.properties.nodes)!==null&&j!==void 0?j:[]);if(te&&de){var Oe,et=(Oe=te==null?void 0:te.properties.nodes)!==null&&Oe!==void 0?Oe:[];if(4>et.length)return;this.syncPolygonNodes(te,et.filter(function(Pt){return!Zi(de,Pt)})),this.emit(D.DrawEvent.RemoveNode,de,te,this.getLineData()),this.emit(D.DrawEvent.Edit,te,this.getPolygonData())}}},{key:"onPointContextMenu",value:function(P){var B,j=this.editPolygon,te=P.feature,de=(B=j==null?void 0:j.properties.nodes)!==null&&B!==void 0?B:[];if(j&&de.length>=4)return de.find(function(Oe){return Zi(Oe,te)})||(te=de[0]),this.removeNode(te,j),te}},{key:"bindPointRenderEvent",value:function(){var P;ce(Rr(L.prototype),"bindPointRenderEvent",this).call(this),(P=this.pointRender)===null||P===void 0||P.on(D.RenderEvent.Contextmenu,this.onPointContextMenu.bind(this))}},{key:"enablePointRenderAction",value:function(){var P;ce(Rr(L.prototype),"enablePointRenderAction",this).call(this),this.options.editable&&((P=this.pointRender)===null||P===void 0||P.enableContextMenu())}},{key:"disablePointRenderAction",value:function(){var P;ce(Rr(L.prototype),"disablePointRenderAction",this).call(this),(P=this.pointRender)===null||P===void 0||P.disableContextMenu()}}]),L}(wr),mn=function(E){Cr(L,E);var A=De(L);function L(P,B){var j;return is(this,L),(j=A.call(this,P,B)).bindPointRenderEvent(),j.bindSceneEvent(),j.bindMidPointRenderEvent(),j.bindLineRenderEvent(),j.bindPolygonRenderEvent(),j}return mt(L,[{key:"getDefaultOptions",value:function(P){var B=ce(Rr(L.prototype),"getDefaultOptions",this).call(this,P);return B.helper&&(B.helper=fi(fi({},B.helper),cn)),B}},{key:"setData",value:function(P){var B=this,j=P.map(function(te){var de,Oe,et;te.properties=fi(fi({},ba()),(de=te.properties)!==null&&de!==void 0?de:{});var Pt=te.properties.nodes;if(((Oe=Pt)===null||Oe===void 0?void 0:Oe.length)!==2){var Mr=He($a(te),4),Qr=Mr[2],Xn=Mr[3];Pt=[go([Mr[0],Mr[1]]),go([Qr,Xn])],te.properties.nodes=Pt}var ii=He(Pt,2),li=ii[0],Mn=ii[1],wn=!!(!((et=te.properties)===null||et===void 0)&&et.isActive),Vn=te.properties.line;return Vn||(Vn=B.handleCreatePolygonLine(li,Mn,{isActive:wn}),te.properties.line=Vn),B.handleCreatePolygon([li,Mn],Vn,fi(fi({},te.properties),{},{isActive:wn}))});this.source.setData({point:[],midPoint:[],dashLine:[],polygon:j,line:j.map(function(te){return te.properties.line})}),this.setTextData(this.getAllTexts()),this.editPolygon&&this.setActivePolygon(this.editPolygon)}},{key:"handleCreatePolygonLine",value:function(P,B){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},te=_r(zs(ur([P,B]))),de=te.map(function(Oe,et){return et===0?P:et===2?B:go(Oe)});return Wo(de,j)}},{key:"syncPolygonNodes",value:function(P,B){var j=P.properties.line,te=_r(zs(ur(B)));P.properties.nodes=B,P.geometry.coordinates=[te],this.setPolygonData(function(et){return et.map(function(Pt){return Zi(Pt,P)?P:Pt})}),this.setPointData(P.properties.isDraw?[B[0]]:B);var de=j.properties.nodes,Oe=te.filter(function(et){return!jo(et,B[0].geometry.coordinates)&&!jo(et,B[1].geometry.coordinates)});return de.forEach(function(et,Pt){var Mr=[0,0];switch(Pt){case 0:Mr=B[0].geometry.coordinates;break;case 1:Mr=Oe[0];break;case 2:Mr=B[1].geometry.coordinates;break;case 3:Mr=Oe[1];break;case 4:Mr=_c(B[0].geometry.coordinates)}et.geometry.coordinates=Mr}),j.geometry.coordinates=te,P}},{key:"onLineDragging",value:function(P){var B=ce(Rr(L.prototype),"onLineDragging",this).call(this,P),j=this.dragPolygon;if(B&&j){var te=j.properties.line.properties.nodes;this.syncPolygonNodes(j,[te[0],te[2]]),this.setActivePolygon(j,{isDrag:!0}),this.emit(D.DrawEvent.Dragging,j,this.getPolygonData())}return B}}]),L}(nn),wi=function(E,A){for(var L=E;L&&!Array.from(L.classList).includes(A);)L=L.parentElement;return L},ya={point:"#l7draw-point",line:"#l7draw-line",polygon:"#l7draw-polygon",rect:"#l7draw-rect",circle:"#l7draw-circle",clear:"#l7draw-qingkong"},xa={point:ar,line:Or,polygon:xn,rect:mn,circle:Wt},Sa="data-draw-type",aa="l7-draw-control",no="".concat(aa,"__btn"),Ya="".concat(no,"--active");(function(E){var A,L,P,B,j,te='<svg><symbol id="l7draw-qingkong" viewBox="0 0 1024 1024"><path d="M778.96777344 334.02148437h-148.31542969V284.58300781A71.78466797 71.78466797 0 0 0 556.49462891 215.36914062H467.50537109a71.78466797 71.78466797 0 0 0-74.15771484 69.11499024V334.02148437h-148.31542969a29.66308594 29.66308594 0 1 0 0 59.32617188h29.66308594v326.29394531A88.98925781 88.98925781 0 0 0 363.68457031 808.63085938h296.63085938a88.98925781 88.98925781 0 0 0 88.98925781-88.98925782V393.34765625h29.66308594a29.66308594 29.66308594 0 0 0 0-59.32617188zM452.67382812 284.58300781c0-4.74609375 6.22924805-9.78881836 14.83154297-9.78881836h88.98925782c8.60229492 0 14.83154297 5.04272461 14.83154296 9.78881836V334.02148437H452.67382812V284.53356934z m237.30468751 435.10803223a29.66308594 29.66308594 0 0 1-29.66308594 29.66308593H363.68457031a29.66308594 29.66308594 0 0 1-29.66308593-29.66308594V393.34765625h355.95703124v326.29394531z"  ></path><path d="M437.84228516 660.31542969c6.57531739 0 12.85400391-3.46069336 17.5012207-9.64050294A39.20471192 39.20471192 0 0 0 462.56152344 627.33996582V495.5369873a39.20471192 39.20471192 0 0 0-7.21801758-23.33496093A22.09899903 22.09899903 0 0 0 437.84228516 462.56152344c-6.57531739 0-12.85400391 3.46069336-17.50122071 9.64050293A39.20471192 39.20471192 0 0 0 413.12304687 495.5369873v131.80297853c0 8.75061036 2.62023926 17.15515137 7.21801758 23.33496092 4.6472168 6.17980958 10.92590333 9.64050293 17.50122071 9.64050294zM586.15771484 660.31542969c6.57531739 0 12.85400391-3.46069336 17.50122071-9.64050294a39.20471192 39.20471192 0 0 0 7.21801758-23.33496093V495.5369873a39.20471192 39.20471192 0 0 0-7.21801758-23.33496093A22.09899903 22.09899903 0 0 0 586.15771484 462.56152344c-6.57531739 0-12.85400391 3.46069336-17.5012207 9.64050293A39.20471192 39.20471192 0 0 0 561.43847656 495.5369873v131.80297853c0 8.75061036 2.62023926 17.15515137 7.21801758 23.33496092 4.6472168 6.17980958 10.92590333 9.64050293 17.5012207 9.64050294z"  ></path></symbol><symbol id="l7draw-rect" viewBox="0 0 1024 1024"><path d="M736.14 648.79V330c0-23.16-18.84-42-42-42H375.49c-11.07-19.13-31.74-32.01-55.43-32.01-35.35 0-64.01 28.66-64.01 64.01 0 23.69 12.88 44.36 32.01 55.43v318.8c0 23.16 18.84 42 42 42H648.7c11.07 19.13 31.74 32.01 55.43 32.01 35.35 0 64.01-28.66 64.01-64.01 0.01-23.7-12.87-44.37-32-55.44zM352.06 375.43A64.281 64.281 0 0 0 375.49 352h296.64v296.8a64.357 64.357 0 0 0-23.43 23.43H352.06v-296.8z"  ></path></symbol><symbol id="l7draw-circle" viewBox="0 0 1024 1024"><path d="M467.013228 557.765038a64.01 64.01 0 1 0 90.52223-90.52539 64.01 64.01 0 1 0-90.52223 90.52539Z"  ></path><path d="M832.16 512.22c0-26.06-15.58-48.46-37.93-58.45-11.21-54.67-38.11-104.92-78.48-145.3-54.42-54.42-126.78-84.4-203.75-84.4s-149.33 29.97-203.75 84.4c-54.42 54.42-84.4 126.79-84.4 203.75s29.97 149.33 84.4 203.75c54.42 54.42 126.78 84.4 203.75 84.4s149.33-29.97 203.75-84.4c40.37-40.37 67.28-90.62 78.48-145.3 22.35-9.98 37.93-32.39 37.93-58.45zM670.5 670.72c-42.34 42.34-98.62 65.65-158.5 65.65-59.87 0-116.16-23.32-158.5-65.65-42.34-42.34-65.65-98.62-65.65-158.5s23.32-116.16 65.65-158.5c42.34-42.34 98.62-65.65 158.5-65.65 59.87 0 116.16 23.32 158.5 65.65 29.9 29.9 50.3 66.77 59.71 106.95-15.81 11.66-26.07 30.4-26.07 51.55s10.26 39.9 26.07 51.55c-9.41 40.18-29.81 77.05-59.71 106.95z"  ></path></symbol><symbol id="l7draw-polygon" viewBox="0 0 1024 1024"><path d="M705.97 640.31c-5.79 0-11.39 0.78-16.72 2.22L381.94 336.66a64.079 64.079 0 0 0 2.14-16.43c0-35.35-28.66-64.01-64.01-64.01s-64.01 28.66-64.01 64.01c0 23.69 12.88 44.36 32.01 55.43V648.8c-19.13 11.07-32.01 31.74-32.01 55.43 0 35.35 28.66 64.01 64.01 64.01 23.69 0 44.35-12.87 55.42-32l275.05 0.07c11.07 19.14 31.74 32.03 55.44 32.03 35.35 0 64.01-28.66 64.01-64.01s-28.66-64.02-64.02-64.02z m-353.91 8.48V397.22L628.44 672.3l-252.94-0.07a64.411 64.411 0 0 0-23.44-23.44z"  ></path></symbol><symbol id="l7draw-line" viewBox="0 0 1024 1024"><path d="M832.16 449.21c0-35.35-28.66-64.01-64.01-64.01-29.2 0-53.81 19.56-61.5 46.28l-390.9 96.82 72.18-144.18c33.56-1.99 60.17-29.83 60.17-63.89 0-35.35-28.66-64.01-64.01-64.01s-64.01 28.66-64.01 64.01c0 13.04 3.91 25.17 10.61 35.28l-78.42 156.65c-33.58 1.97-60.21 29.81-60.21 63.89 0 35.35 28.66 64.01 64.01 64.01 29.2 0 53.81-19.56 61.5-46.28l390.8-96.79-71.97 143.34c-33.62 1.93-60.28 29.8-60.28 63.9 0 35.35 28.66 64.01 64.01 64.01s64.01-28.66 64.01-64.01c0-13-3.89-25.09-10.54-35.18l78.28-155.93c33.61-1.95 60.28-29.81 60.28-63.91z"  ></path></symbol><symbol id="l7draw-point" viewBox="0 0 1024 1024"><path d="M331.46 330.08m-64.01 0a64.01 64.01 0 1 0 128.02 0 64.01 64.01 0 1 0-128.02 0Z"  ></path><path d="M384.12 735.84m-64.01 0a64.01 64.01 0 1 0 128.02 0 64.01 64.01 0 1 0-128.02 0Z"  ></path><path d="M769.11 512.7m-64.01 0a64.01 64.01 0 1 0 128.02 0 64.01 64.01 0 1 0-128.02 0Z"  ></path></symbol></svg>',de=(de=document.getElementsByTagName("script"))[de.length-1].getAttribute("data-injectcss");if(de&&!E.__iconfont__svg__cssinject__){E.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(et){console&&console.log(et)}}function Oe(){j||(j=!0,P())}A=function(){var et,Pt=document.createElement("div");Pt.innerHTML=te,te=null,(Pt=Pt.getElementsByTagName("svg")[0])&&(Pt.setAttribute("aria-hidden","true"),Pt.style.position="absolute",Pt.style.width=0,Pt.style.height=0,Pt.style.overflow="hidden",(et=document.body).firstChild?function(Mr,Qr){Qr.parentNode.insertBefore(Mr,Qr)}(Pt,et.firstChild):et.appendChild(Pt))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(A,0):(L=function(){document.removeEventListener("DOMContentLoaded",L,!1),A()},document.addEventListener("DOMContentLoaded",L,!1)):document.attachEvent&&(P=A,B=E.document,j=!1,function et(){try{B.documentElement.doScroll("left")}catch(Pt){return void setTimeout(et,50)}Oe()}(),B.onreadystatechange=function(){B.readyState=="complete"&&(B.onreadystatechange=null,Oe())})})(window),Vo(".l7-draw-control{display:flex;overflow:hidden;background:#fff;border-radius:2px}.l7-draw-control__btn{display:inline-flex;align-items:center;justify-content:center;width:30px;height:30px;padding:0;text-align:center;background:transparent;border-width:0;border-right:1px solid #e0e0e0;outline:0;cursor:pointer}.l7-draw-control__btn:hover{background-color:#e5e5e5}.l7-draw-control__btn:last-child{border-bottom:0}.l7-draw-control__btn .l7-draw-icon{width:26px;height:26px;overflow:hidden;fill:currentColor}.l7-draw-control__btn--active svg{color:#0370fe}");var io=function(E){Cr(L,E);var A=De(L);function L(P){var B,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return is(this,L),(B=A.call(this,j)).controlOption=void 0,B.sceneInstance=void 0,B.drawMap={},B.btnMap={},B.activeType=null,B.emitDataChange=Ju(function(){B.emit(D.ControlEvent.DataChange,B.getDrawData())},16),B.sceneInstance=P,B.controlOption=fi(fi({},B.getDefault()),j||{}),B.onBtnClick=B.onBtnClick.bind(Pa(B)),B}return mt(L,[{key:"getActiveType",value:function(){return this.activeType}},{key:"getDefault",value:function(){return fi(fi({},ce(Rr(L.prototype),"getDefault",this).call(this)),{},{className:"",buttonClassName:"",activeButtonClassName:"",style:"",position:"topleft",commonDrawOptions:{},drawConfig:{point:!0,line:!0,polygon:!0,rect:!0,circle:!0,clear:!0}})}},{key:"addTo",value:function(P){return ce(Rr(L.prototype),"addTo",this).call(this,P),this.init(),this}},{key:"onAdd",value:function(){var P=this.controlOption,B=P.className,j=P.style,te=k.DOM.create("div","".concat(aa," ").concat(B));return j&&te.setAttribute("style",j),te}},{key:"onRemove",value:function(){Object.values(this.drawMap).forEach(function(P){P.clear(!0)})}},{key:"init",value:function(){var P,B=this,j=[];Object.entries(this.controlOption.drawConfig).forEach(function(te){var de=He(te,2),Oe=de[0],et=de[1];if(et){var Pt=B.initBtn(Oe);Pt.addEventListener("click",B.onBtnClick),j.push(Pt),B.btnMap[Oe]=Pt;var Mr=xa[Oe];if(Mr&&B.sceneInstance){var Qr=new Mr(B.sceneInstance,fi(fi({},B.controlOption.commonDrawOptions),typeof et=="boolean"?{}:et));Qr.on(D.DrawEvent.Change,B.emitDataChange),B.drawMap[Oe]=Qr}}}),(P=this.container).append.apply(P,j),this.controlOption.defaultActiveType&&this.onDrawClick(this.controlOption.defaultActiveType)}},{key:"getDrawData",value:function(){return kp(xi(this.drawMap).map(function(P){var B=He(P,2);return[B[0],B[1].getData()]}))}},{key:"getTypeDraw",value:function(P){var B;return(B=this.drawMap[P])!==null&&B!==void 0?B:null}},{key:"onBtnClick",value:function(P){var B=wi(P.target,no);if(B){var j=B.getAttribute(Sa);j==="clear"?this.clearDrawData():this.onDrawClick(j)}}},{key:"setActiveType",value:function(P){var B=null,j=this.activeType;if(j){var te,de=this.btnMap[j];if(de){k.DOM.removeClass(de,Ya);var Oe=this.controlOption.activeButtonClassName;Oe&&k.DOM.removeClass(de,Oe)}(te=this.drawMap[j])===null||te===void 0||te.disable(),B=null}if(j!==P&&P){var et;(et=this.drawMap[P])===null||et===void 0||et.enable();var Pt=this.btnMap[P];Pt&&k.DOM.addClass(Pt,"".concat(Ya," ").concat(this.controlOption.activeButtonClassName)),B=P}this.activeType=B,this.emit(D.ControlEvent.DrawChange,B)}},{key:"onDrawClick",value:function(P){this.setActiveType(P)}},{key:"clearDrawData",value:function(){Object.values(this.drawMap).forEach(function(P){P==null||P.clear()})}},{key:"initBtn",value:function(P){var B=k.DOM.create("button","".concat(no," ").concat(this.controlOption.buttonClassName));return B.innerHTML=`<svg class="l7-draw-icon" aria-hidden="true">
      <use xlink:href="`.concat(ya[P],`"></use>
    </svg>`),B.setAttribute(Sa,P),B}}]),L}(k.Control);D.ACTIVE_COLOR=Tc,D.BaseMode=Vh,D.CircleDrawer=Wt,D.DEFAULT_ADSORB_CONFIG=eu,D.DEFAULT_AREA_OPTIONS=$s,D.DEFAULT_COMMON_OPTIONS=gf,D.DEFAULT_CURSOR_MAP=m,D.DEFAULT_DISTANCE_OPTIONS=Wu,D.DEFAULT_HISTORY_CONFIG=uu,D.DEFAULT_KEYBOARD_CONFIG=Jo,D.DEFAULT_MID_POINT_STYLE=Tf,D.DEFAULT_NODE_NORMAL_STYLE=Af,D.DEFAULT_NODE_STYLE=Pf,D.DEFAULT_POINT_NORMAL_STYLE=lh,D.DEFAULT_POINT_STYLE=Mf,D.DEFAULT_POPUP_CONFIG=ms,D.DEFAULT_SOURCE_DATA=ae,D.DEFAULT_STYLE=gp,D.DEFAULT_TEXT_NORMAL_STYLE=ju,D.DashLineRender=ap,D.DragPolygonMode=nn,D.DrawCircle=Wt,D.DrawControl=io,D.DrawLine=Or,D.DrawPoint=ar,D.DrawPolygon=xn,D.DrawRect=mn,D.LayerRender=hc,D.LineDrawer=Or,D.LineMode=Wr,D.LineRender=Nt,D.MidPointMode=Rn,D.MidPointRender=Xc,D.NORMAL_COLOR=Nc,D.PointDrawer=ar,D.PointMode=Wn,D.PointRender=ss,D.PolygonDrawer=xn,D.PolygonMode=wr,D.PolygonRender=Uu,D.RENDER_MAP=Uf,D.RectDrawer=mn,D.SceneRender=cs,D.Source=ic,D.TextRender=Kf,D.calcAreaText=pc,D.calcDistanceTextsByLine=Fs,D.createDashLine=Ps,D.createLineFeature=Wo,D.createPointFeature=go,D.createPolygonFeature=xu,D.findMinIndex=dc,D.getAdsorbFeature=Il,D.getAdsorbLine=tl,D.getAdsorbPoint=ys,D.getDefaultLineProperties=Hi,D.getDefaultPointProperties=Bo,D.getDefaultPolygonProperties=ba,D.getLineCenterPoint=el,D.getLngLat=Ol,D.getMapDom=pl,D.getParentByClassName=wi,D.getPosition=Vu,D.getUuid=_a,D.isDev=!1,D.isSameFeature=Zi,D.resetEventLngLat=Ts,D.splitByPosition=Qc,D.transLngLat2Position=Wl,D.updateTargetFeature=vo,Object.defineProperty(D,"__esModule",{value:!0})})},34789:function(Ne,fe,I){"use strict";I.r(fe),I.d(fe,{$XMLHttpRequest:function(){return Gc},$location:function(){return kc},$window:function(){return ha},AJAXError:function(){return ei},AttributeType:function(){return Da},BKDRHash:function(){return yc},BaseLayer:function(){return Dd},BaseMapService:function(){return Sb},BaseMapWrapper:function(){return Yg},BaseModel:function(){return il},BasePostProcessingPass:function(){return sv},BlendType:function(){return Rd},ButtonControl:function(){return Av},CameraUniform:function(){return jv},CanvasLayer:function(){return u5},CanvasUpdateType:function(){return U0},CityBuildingLayer:function(){return u4},Control:function(){return l0},CoordinateSystem:function(){return Wf},CoordinateUniform:function(){return Hd},DOM:function(){return D},Earth:function(){return RF},EarthLayer:function(){return $6},ExportImage:function(){return w},FrequencyController:function(){return Nr},Fullscreen:function(){return uo},GaodeMap:function(){return L3},GaodeMapV1:function(){return _8},GaodeMapV2:function(){return L3},GeoLocate:function(){return fo},GeometryLayer:function(){return M4},HeatmapLayer:function(){return nP},IDebugLog:function(){return nh},ILayerStage:function(){return ih},ImageLayer:function(){return gC},InteractionEvent:function(){return Lh},LRUCache:function(){return Of},LayerPopup:function(){return kM},LayerSwitch:function(){return Os},LineLayer:function(){return yw},LineTriangulation:function(){return A},LinearDir:function(){return Vm},LoadTileDataStatus:function(){return $l},Logo:function(){return wl},Map:function(){return jF},MapServiceEvent:function(){return Nm},MapTheme:function(){return fl},Mapbox:function(){return eB},Marker:function(){return vx},MarkerLayer:function(){return mx},MaskLayer:function(){return Lx},MouseLocation:function(){return Zn},PassType:function(){return Sv},PointFillTriangulation:function(){return L},PointLayer:function(){return Ox},PolygonLayer:function(){return ZC},PopperControl:function(){return qy},Popup:function(){return kh},PositionType:function(){return jp},RasterLayer:function(){return Ix},RasterTileType:function(){return kd},Satistics:function(){return k},Scale:function(){return Fa},ScaleTypes:function(){return sc},Scene:function(){return xB},SceneEventList:function(){return zm},SelectControl:function(){return Qy},SizeUnitType:function(){return Ng},Source:function(){return Hv},SourceTile:function(){return fp},StyleScaleType:function(){return Cv},TYPES:function(){return Ir},TextureBlend:function(){return Ex},TileDebugLayer:function(){return A6},TilesetManager:function(){return ph},UpdateTileStrategy:function(){return Hf},Version:function(){return ah},Viewport:function(){return rb},WindLayer:function(){return xL},WorkerSourceMap:function(){return et},Zoom:function(){return Ll},aProjectFlat:function(){return ga},amap2Project:function(){return Uo},amap2UnProject:function(){return Do},anchorTranslate:function(){return Ku},anchorType:function(){return lc},applyAnchorClass:function(){return xs},bBoxToBounds:function(){return El},bindAll:function(){return pr},boundsContains:function(){return Io},calAngle:function(){return gu},calDistance:function(){return nu},calculateCentroid:function(){return ml},calculatePointsCenterAndRadius:function(){return Mc},container:function(){return bd},createLayerContainer:function(){return Fm},createSceneContainer:function(){return Gy},decodePickingColor:function(){return Xa},dispatchMapCameraParams:function(){return $o},dispatchMouseDown:function(){return Sc},dispatchMouseMove:function(){return vl},dispatchMouseUp:function(){return es},dispatchPointerDown:function(){return Ml},dispatchPointerMove:function(){return xl},dispatchPointerUp:function(){return nf},dispatchTouchEnd:function(){return gs},dispatchTouchMove:function(){return ts},dispatchTouchStart:function(){return Jl},djb2hash:function(){return lp},encodePickingColor:function(){return of},executeWorkerTask:function(){return ka},expandUrl:function(){return Ip},extent:function(){return ai},flow:function(){return Vl},generateCatRamp:function(){return Qu},generateColorRamp:function(){return Pl},generateCustomRamp:function(){return uh},generateLinearRamp:function(){return Bc},generateQuantizeRamp:function(){return ul},getAngle:function(){return gc},getArrayBuffer:function(){return Au},getBBoxFromPoints:function(){return hl},getCullFace:function(){return up},getDefaultDomain:function(){return fu},getImage:function(){return mc},getJSON:function(){return mu},getMask:function(){return yu},getReferrer:function(){return st},getTileIndices:function(){return _p},getTileWarpXY:function(){return Ch},getURLFromTemplate:function(){return Oc},getWMTSURLFromTemplate:function(){return qh},gl:function(){return Ve},guid:function(){return Dh},isAndroid:function(){return Zt},isColor:function(){return Yf},isImageBitmap:function(){return ge},isMini:function(){return zs},isMiniAli:function(){return Mu},isMiniScene:function(){return ds},isPC:function(){return vr},isURLTemplate:function(){return th},isWeChatMiniProgram:function(){return ec},isWorker:function(){return Ue},isiOS:function(){return Lt},latitude:function(){return ho},lazyInject:function(){return Rg},lazyMultiInject:function(){return Hy},lineAtOffset:function(){return Jf},lineAtOffsetAsyc:function(){return Fh},lineStyleType:function(){return lw},lngLatInExtent:function(){return Yn},lngLatToMeters:function(){return Ua},lnglatDistance:function(){return po},longitude:function(){return Eo},makeXMLHttpRequestPromise:function(){return Za},metersToLngLat:function(){return co},miniWindow:function(){return df},normalize:function(){return Ou},osmLonLat2TileXY:function(){return hu},osmTileXY2LonLat:function(){return Lf},packCircleVertex:function(){return wE},padBounds:function(){return ko},polygonFillTriangulation:function(){return P},postData:function(){return Rl},project:function(){return us},rgb2arr:function(){return Qi},sameOrigin:function(){return xh},setL7WorkerSource:function(){return si},setMiniScene:function(){return Ns},tileToBounds:function(){return Sh},tranfrormCoord:function(){return va},unProjectFlat:function(){return Zo},validateLngLat:function(){return qo},version:function(){return bB}});var D={};I.r(D),I.d(D,{DPR:function(){return ju},addClass:function(){return cs},addStyle:function(){return gp},appendElementType:function(){return ee},clearChildren:function(){return N},create:function(){return ss},css2Style:function(){return g},empty:function(){return gf},getClass:function(){return Tc},getContainer:function(){return Wc},getDiffRect:function(){return p},getStyleList:function(){return qf},getViewPortScale:function(){return Pf},hasClass:function(){return Uf},printCanvas:function(){return Mf},remove:function(){return Uu},removeClass:function(){return Kf},removeStyle:function(){return h},setChecked:function(){return b},setClass:function(){return Nc},setTransform:function(){return Af},setUnDraggable:function(){return q},splitWords:function(){return Nt},triggerResize:function(){return Tf},trim:function(){return Ju}});var k={};I.r(k),I.d(k,{getColumn:function(){return Bh},getSatByColumn:function(){return Kh},max:function(){return eh},mean:function(){return Yh},min:function(){return If},mode:function(){return yf},statMap:function(){return Gl},sum:function(){return Vf}});var m={};I.r(m),I.d(m,{add:function(){return id},adjoint:function(){return rd},clone:function(){return rh},copy:function(){return Jd},create:function(){return rl},determinant:function(){return dp},equals:function(){return Fv},exactEquals:function(){return Jv},frob:function(){return qv},fromQuat:function(){return q0},fromQuat2:function(){return vv},fromRotation:function(){return Rv},fromRotationTranslation:function(){return ev},fromRotationTranslationScale:function(){return Zp},fromRotationTranslationScaleOrigin:function(){return m0},fromScaling:function(){return Lv},fromTranslation:function(){return dv},fromValues:function(){return Iv},fromXRotation:function(){return tp},fromYRotation:function(){return kv},fromZRotation:function(){return yd},frustum:function(){return g0},getRotation:function(){return Ih},getScaling:function(){return nd},getTranslation:function(){return mv},identity:function(){return Zd},invert:function(){return td},lookAt:function(){return mp},mul:function(){return J0},multiply:function(){return ef},multiplyScalar:function(){return Dv},multiplyScalarAndAdd:function(){return Qv},ortho:function(){return Up},orthoNO:function(){return Yo},orthoZO:function(){return Cp},perspective:function(){return _d},perspectiveFromFieldOfView:function(){return Sp},perspectiveNO:function(){return y0},perspectiveZO:function(){return Q0},rotate:function(){return Rc},rotateX:function(){return wp},rotateY:function(){return zp},rotateZ:function(){return vp},scale:function(){return Ru},set:function(){return pv},str:function(){return Nl},sub:function(){return Bv},subtract:function(){return Ud},targetTo:function(){return _0},translate:function(){return Lc},transpose:function(){return Kv}});var ae={};I.r(ae),I.d(ae,{add:function(){return h5},angle:function(){return hw},bezier:function(){return E5},ceil:function(){return p5},clone:function(){return l5},copy:function(){return c5},create:function(){return j0},cross:function(){return Sx},dist:function(){return D5},distance:function(){return WS},div:function(){return k5},divide:function(){return $S},dot:function(){return qS},equals:function(){return L5},exactEquals:function(){return I5},floor:function(){return d5},forEach:function(){return z5},fromValues:function(){return Kl},hermite:function(){return b5},inverse:function(){return _5},len:function(){return B5},length:function(){return HS},lerp:function(){return x5},max:function(){return m5},min:function(){return v5},mul:function(){return R5},multiply:function(){return cw},negate:function(){return KS},normalize:function(){return V0},random:function(){return w5},rotateX:function(){return A5},rotateY:function(){return T5},rotateZ:function(){return M5},round:function(){return g5},scale:function(){return fw},scaleAndAdd:function(){return y5},set:function(){return f5},sqrDist:function(){return F5},sqrLen:function(){return N5},squaredDistance:function(){return XS},squaredLength:function(){return YS},str:function(){return O5},sub:function(){return pw},subtract:function(){return GS},transformMat3:function(){return S5},transformMat4:function(){return Hm},transformQuat:function(){return C5},zero:function(){return P5}});var F={},K={},W=function(i){return K[i]},Y=function(i,r){K[i]=r},G=function(i){return F[i]},$=function(i,r){F[i]=r},xe={},Fe={},Ce=34,We=10,me=13;function Ge(e){return new Function("d","return {"+e.map(function(i,r){return JSON.stringify(i)+": d["+r+'] || ""'}).join(",")+"}")}function Ke(e,i){var r=Ge(e);return function(n,t){return i(r(n),t,e)}}function pt(e){var i=Object.create(null),r=[];return e.forEach(function(n){for(var t in n)t in i||r.push(i[t]=t)}),r}function Xe(e,i){var r=e+"",n=r.length;return n<i?new Array(i-n+1).join(0)+r:r}function gt(e){return e<0?"-"+Xe(-e,6):e>9999?"+"+Xe(e,6):Xe(e,4)}function ie(e){var i=e.getUTCHours(),r=e.getUTCMinutes(),n=e.getUTCSeconds(),t=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":gt(e.getUTCFullYear(),4)+"-"+Xe(e.getUTCMonth()+1,2)+"-"+Xe(e.getUTCDate(),2)+(t?"T"+Xe(i,2)+":"+Xe(r,2)+":"+Xe(n,2)+"."+Xe(t,3)+"Z":n?"T"+Xe(i,2)+":"+Xe(r,2)+":"+Xe(n,2)+"Z":r||i?"T"+Xe(i,2)+":"+Xe(r,2)+"Z":"")}function ft(e){var i=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function n(O,Z){var U,se,le=t(O,function(ye,Be){if(U)return U(ye,Be-1);se=ye,U=Z?Ke(ye,Z):Ge(ye)});return le.columns=se||[],le}function t(O,Z){var U=[],se=O.length,le=0,ye=0,Be,rt=se<=0,Je=!1;O.charCodeAt(se-1)===We&&--se,O.charCodeAt(se-1)===me&&--se;function Ot(){if(rt)return Fe;if(Je)return Je=!1,xe;var dr,Lr=le,jr;if(O.charCodeAt(Lr)===Ce){for(;le++<se&&O.charCodeAt(le)!==Ce||O.charCodeAt(++le)===Ce;);return(dr=le)>=se?rt=!0:(jr=O.charCodeAt(le++))===We?Je=!0:jr===me&&(Je=!0,O.charCodeAt(le)===We&&++le),O.slice(Lr+1,dr-1).replace(/""/g,'"')}for(;le<se;){if((jr=O.charCodeAt(dr=le++))===We)Je=!0;else if(jr===me)Je=!0,O.charCodeAt(le)===We&&++le;else if(jr!==r)continue;return O.slice(Lr,dr)}return rt=!0,O.slice(Lr,se)}for(;(Be=Ot())!==Fe;){for(var jt=[];Be!==xe&&Be!==Fe;)jt.push(Be),Be=Ot();Z&&(jt=Z(jt,ye++))==null||U.push(jt)}return U}function a(O,Z){return O.map(function(U){return Z.map(function(se){return S(U[se])}).join(e)})}function s(O,Z){return Z==null&&(Z=pt(O)),[Z.map(S).join(e)].concat(a(O,Z)).join(`
`)}function l(O,Z){return Z==null&&(Z=pt(O)),a(O,Z).join(`
`)}function f(O){return O.map(d).join(`
`)}function d(O){return O.map(S).join(e)}function S(O){return O==null?"":O instanceof Date?ie(O):i.test(O+="")?'"'+O.replace(/"/g,'""')+'"':O}return{parse:n,parseRows:t,format:s,formatBody:l,formatRows:f,formatRow:d,formatValue:S}}var ve=ft(","),Ae=ve.parse,Re=ve.parseRows,Ye=ve.format,at=ve.formatBody,ht=ve.formatRows,Se=ve.formatRow,Qe=ve.formatValue,oe=I(74902),ue=I(1413),be=I(38163),vt=I.n(be),bt=I(36987),Ht=I(39034);function Er(e,i){var r=i.x,n=i.y,t=i.x1,a=i.y1,s=i.coordinates,l=i.geometry,f=[];if(!Array.isArray(e))return{dataArray:[]};if(l)return e.filter(function(Be){return Be[l]&&Be[l].type&&Be[l].coordinates&&Be[l].coordinates.length>0}).forEach(function(Be,rt){var Je=vt()((0,ue.Z)({},Be[l]),!0);(0,Ht.nG)(Je,function(Ot){var jt=(0,bt.r7)(Ot),dr=(0,ue.Z)((0,ue.Z)({},Be),{},{_id:rt,coordinates:jt});f.push(dr)})}),{dataArray:f};for(var d=0;d<e.length;d++){var S=e[d],O=[];if(s){var Z="Polygon";Array.isArray(s[0])||(Z="Point"),Array.isArray(s[0])&&!Array.isArray(s[0][0])&&(Z="LineString");var U=vt()({type:Z,coordinates:(0,oe.Z)(S[s])},!0);O=U.coordinates}else if(r&&n&&t&&a){var se=[parseFloat(S[r]),parseFloat(S[n])],le=[parseFloat(S[t]),parseFloat(S[a])];O=[se,le]}else r&&n&&(O=[parseFloat(S[r]),parseFloat(S[n])]);var ye=(0,ue.Z)((0,ue.Z)({},S),{},{_id:d,coordinates:O});f.push(ye)}return{dataArray:f}}function Vt(e,i){var r=Ae(e);return Er(r,i)}var on=I(71002);function hn(e){for(var i=e.toString(),r=5381,n=i.length;n;)r=r*33^i.charCodeAt(--n);return r>>>0}function gi(e,i){return i===void 0?null:(0,on.Z)(e.properties[i])*1==="number"?e.properties[i]*1:e.properties&&e.properties[i]?hn(e.properties[i]+"")%1000019:null}function Hn(e,i){var r=[],n={};return e.features?(e.features=e.features.filter(function(t){var a=t.geometry;return t!=null&&a&&a.type&&a.coordinates&&a.coordinates.length>0}),vt()(e,!0),e.features.length===0?{dataArray:[],featureKeys:n}:((0,Ht.nG)(e,function(t,a){var s=gi(t,i==null?void 0:i.featureId);s===null&&(s=a);var l=s,f=(0,bt.r7)(t),d=(0,ue.Z)((0,ue.Z)({},t.properties),{},{coordinates:f,_id:l});r.push(d)}),{dataArray:r,featureKeys:n})):(e.features=[],{dataArray:[]})}var Dt=I(15861),Ea=I(64687),Ze=I.n(Ea);function ci(e,i,r,n){for(var t=n,a=r-i>>1,s=r-i,l,f=e[i],d=e[i+1],S=e[r],O=e[r+1],Z=i+3;Z<r;Z+=3){var U=Ci(e[Z],e[Z+1],f,d,S,O);if(U>t)l=Z,t=U;else if(U===t){var se=Math.abs(Z-a);se<s&&(l=Z,s=se)}}t>n&&(l-i>3&&ci(e,i,l,n),e[l+2]=t,r-l>3&&ci(e,l,r,n))}function Ci(e,i,r,n,t,a){var s=t-r,l=a-n;if(s!==0||l!==0){var f=((e-r)*s+(i-n)*l)/(s*s+l*l);f>1?(r=t,n=a):f>0&&(r+=s*f,n+=l*f)}return s=e-r,l=i-n,s*s+l*l}function Oi(e,i,r,n){var t={id:typeof e=="undefined"?null:e,type:i,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return ea(t),t}function ea(e){var i=e.geometry,r=e.type;if(r==="Point"||r==="MultiPoint"||r==="LineString")fn(e,i);else if(r==="Polygon"||r==="MultiLineString")for(var n=0;n<i.length;n++)fn(e,i[n]);else if(r==="MultiPolygon")for(n=0;n<i.length;n++)for(var t=0;t<i[n].length;t++)fn(e,i[n][t])}function fn(e,i){for(var r=0;r<i.length;r+=3)e.minX=Math.min(e.minX,i[r]),e.minY=Math.min(e.minY,i[r+1]),e.maxX=Math.max(e.maxX,i[r]),e.maxY=Math.max(e.maxY,i[r+1])}function tn(e,i){var r=[];if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)da(r,e.features[n],i,n);else e.type==="Feature"?da(r,e,i):da(r,{geometry:e},i);return r}function da(e,i,r,n){if(i.geometry){var t=i.geometry.coordinates,a=i.geometry.type,s=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),l=[],f=i.id;if(r.promoteId?f=i.properties[r.promoteId]:r.generateId&&(f=n||0),a==="Point")Ii(t,l);else if(a==="MultiPoint")for(var d=0;d<t.length;d++)Ii(t[d],l);else if(a==="LineString")Ai(t,l,s,!1);else if(a==="MultiLineString")if(r.lineMetrics){for(d=0;d<t.length;d++)l=[],Ai(t[d],l,s,!1),e.push(Oi(f,"LineString",l,i.properties));return}else Pr(t,l,s,!1);else if(a==="Polygon")Pr(t,l,s,!0);else if(a==="MultiPolygon")for(d=0;d<t.length;d++){var S=[];Pr(t[d],S,s,!0),l.push(S)}else if(a==="GeometryCollection"){for(d=0;d<i.geometry.geometries.length;d++)da(e,{id:f,geometry:i.geometry.geometries[d],properties:i.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(Oi(f,a,l,i.properties))}}function Ii(e,i){i.push(nt(e[0])),i.push(it(e[1])),i.push(0)}function Ai(e,i,r,n){for(var t,a,s=0,l=0;l<e.length;l++){var f=nt(e[l][0]),d=it(e[l][1]);i.push(f),i.push(d),i.push(0),l>0&&(n?s+=(t*d-f*a)/2:s+=Math.sqrt(Math.pow(f-t,2)+Math.pow(d-a,2))),t=f,a=d}var S=i.length-3;i[2]=1,ci(i,0,S,r),i[S+2]=1,i.size=Math.abs(s),i.start=0,i.end=i.size}function Pr(e,i,r,n){for(var t=0;t<e.length;t++){var a=[];Ai(e[t],a,r,n),i.push(a)}}function nt(e){return e/360+.5}function it(e){var i=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+i)/(1-i))/Math.PI;return r<0?0:r>1?1:r}function _t(e,i,r,n,t,a,s,l){if(r/=i,n/=i,a>=r&&s<n)return e;if(s<r||a>=n)return null;for(var f=[],d=0;d<e.length;d++){var S=e[d],O=S.geometry,Z=S.type,U=t===0?S.minX:S.minY,se=t===0?S.maxX:S.maxY;if(U>=r&&se<n){f.push(S);continue}else if(se<r||U>=n)continue;var le=[];if(Z==="Point"||Z==="MultiPoint")we(O,le,r,n,t);else if(Z==="LineString")er(O,le,r,n,t,!1,l.lineMetrics);else if(Z==="MultiLineString")Fn(O,le,r,n,t,!1);else if(Z==="Polygon")Fn(O,le,r,n,t,!0);else if(Z==="MultiPolygon")for(var ye=0;ye<O.length;ye++){var Be=[];Fn(O[ye],Be,r,n,t,!0),Be.length&&le.push(Be)}if(le.length){if(l.lineMetrics&&Z==="LineString"){for(ye=0;ye<le.length;ye++)f.push(Oi(S.id,Z,le[ye],S.tags));continue}(Z==="LineString"||Z==="MultiLineString")&&(le.length===1?(Z="LineString",le=le[0]):Z="MultiLineString"),(Z==="Point"||Z==="MultiPoint")&&(Z=le.length===3?"Point":"MultiPoint"),f.push(Oi(S.id,Z,le,S.tags))}}return f.length?f:null}function we(e,i,r,n,t){for(var a=0;a<e.length;a+=3){var s=e[a+t];s>=r&&s<=n&&(i.push(e[a]),i.push(e[a+1]),i.push(e[a+2]))}}function er(e,i,r,n,t,a,s){for(var l=$r(e),f=t===0?Br:bn,d=e.start,S,O,Z=0;Z<e.length-3;Z+=3){var U=e[Z],se=e[Z+1],le=e[Z+2],ye=e[Z+3],Be=e[Z+4],rt=t===0?U:se,Je=t===0?ye:Be,Ot=!1;s&&(S=Math.sqrt(Math.pow(U-ye,2)+Math.pow(se-Be,2))),rt<r?Je>r&&(O=f(l,U,se,ye,Be,r),s&&(l.start=d+S*O)):rt>n?Je<n&&(O=f(l,U,se,ye,Be,n),s&&(l.start=d+S*O)):Qt(l,U,se,le),Je<r&&rt>=r&&(O=f(l,U,se,ye,Be,r),Ot=!0),Je>n&&rt<=n&&(O=f(l,U,se,ye,Be,n),Ot=!0),!a&&Ot&&(s&&(l.end=d+S*O),i.push(l),l=$r(e)),s&&(d+=S)}var jt=e.length-3;U=e[jt],se=e[jt+1],le=e[jt+2],rt=t===0?U:se,rt>=r&&rt<=n&&Qt(l,U,se,le),jt=l.length-3,a&&jt>=3&&(l[jt]!==l[0]||l[jt+1]!==l[1])&&Qt(l,l[0],l[1],l[2]),l.length&&i.push(l)}function $r(e){var i=[];return i.size=e.size,i.start=e.start,i.end=e.end,i}function Fn(e,i,r,n,t,a){for(var s=0;s<e.length;s++)er(e[s],i,r,n,t,a,!1)}function Qt(e,i,r,n){e.push(i),e.push(r),e.push(n)}function Br(e,i,r,n,t,a){var s=(a-i)/(n-i);return e.push(a),e.push(r+(t-r)*s),e.push(1),s}function bn(e,i,r,n,t,a){var s=(a-r)/(t-r);return e.push(i+(n-i)*s),e.push(a),e.push(1),s}function gr(e,i){var r=i.buffer/i.extent,n=e,t=_t(e,1,-1-r,r,0,-1,2,i),a=_t(e,1,1-r,2+r,0,-1,2,i);return(t||a)&&(n=_t(e,1,-r,1+r,0,-1,2,i)||[],t&&(n=pn(t,1).concat(n)),a&&(n=n.concat(pn(a,-1)))),n}function pn(e,i){for(var r=[],n=0;n<e.length;n++){var t=e[n],a=t.type,s;if(a==="Point"||a==="MultiPoint"||a==="LineString")s=Sn(t.geometry,i);else if(a==="MultiLineString"||a==="Polygon"){s=[];for(var l=0;l<t.geometry.length;l++)s.push(Sn(t.geometry[l],i))}else if(a==="MultiPolygon")for(s=[],l=0;l<t.geometry.length;l++){for(var f=[],d=0;d<t.geometry[l].length;d++)f.push(Sn(t.geometry[l][d],i));s.push(f)}r.push(Oi(t.id,a,s,t.tags))}return r}function Sn(e,i){var r=[];r.size=e.size,e.start!==void 0&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+i,e[n+1],e[n+2]);return r}function Dn(e,i){if(e.transformed)return e;var r=1<<e.z,n=e.x,t=e.y,a,s,l;for(a=0;a<e.features.length;a++){var f=e.features[a],d=f.geometry,S=f.type;if(f.geometry=[],S===1)for(s=0;s<d.length;s+=2)f.geometry.push(ui(d[s],d[s+1],i,r,n,t));else for(s=0;s<d.length;s++){var O=[];for(l=0;l<d[s].length;l+=2)O.push(ui(d[s][l],d[s][l+1],i,r,n,t));f.geometry.push(O)}}return e.transformed=!0,e}function ui(e,i,r,n,t,a){return[Math.round(r*(e*n-t)),Math.round(r*(i*n-a))]}function di(e,i,r,n,t){for(var a=i===t.maxZoom?0:t.tolerance/((1<<i)*t.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:i,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},l=0;l<e.length;l++){s.numFeatures++,ca(s,e[l],a,t);var f=e[l].minX,d=e[l].minY,S=e[l].maxX,O=e[l].maxY;f<s.minX&&(s.minX=f),d<s.minY&&(s.minY=d),S>s.maxX&&(s.maxX=S),O>s.maxY&&(s.maxY=O)}return s}function ca(e,i,r,n){var t=i.geometry,a=i.type,s=[];if(a==="Point"||a==="MultiPoint")for(var l=0;l<t.length;l+=3)s.push(t[l]),s.push(t[l+1]),e.numPoints++,e.numSimplified++;else if(a==="LineString")Ni(s,t,e,r,!1,!1);else if(a==="MultiLineString"||a==="Polygon")for(l=0;l<t.length;l++)Ni(s,t[l],e,r,a==="Polygon",l===0);else if(a==="MultiPolygon")for(var f=0;f<t.length;f++){var d=t[f];for(l=0;l<d.length;l++)Ni(s,d[l],e,r,!0,l===0)}if(s.length){var S=i.tags||null;if(a==="LineString"&&n.lineMetrics){S={};for(var O in i.tags)S[O]=i.tags[O];S.mapbox_clip_start=t.start/t.size,S.mapbox_clip_end=t.end/t.size}var Z={geometry:s,type:a==="Polygon"||a==="MultiPolygon"?3:a==="LineString"||a==="MultiLineString"?2:1,tags:S};i.id!==null&&(Z.id=i.id),e.features.push(Z)}}function Ni(e,i,r,n,t,a){var s=n*n;if(n>0&&i.size<(t?s:n)){r.numPoints+=i.length/3;return}for(var l=[],f=0;f<i.length;f+=3)(n===0||i[f+2]>s)&&(r.numSimplified++,l.push(i[f]),l.push(i[f+1])),r.numPoints++;t&&Wa(l,a),e.push(l)}function Wa(e,i){for(var r=0,n=0,t=e.length,a=t-2;n<t;a=n,n+=2)r+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(r>0===i)for(n=0,t=e.length;n<t/2;n+=2){var s=e[n],l=e[n+1];e[n]=e[t-2-n],e[n+1]=e[t-1-n],e[t-2-n]=s,e[t-1-n]=l}}function Ba(e,i){return new Ia(e,i)}function Ia(e,i){i=this.options=Ln(Object.create(this.options),i);var r=i.debug;if(r&&console.time("preprocess data"),i.maxZoom<0||i.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(i.promoteId&&i.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=tn(e,i);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",i.indexMaxZoom,i.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=gr(n,i),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Ia.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ia.prototype.splitTile=function(e,i,r,n,t,a,s){for(var l=[e,i,r,n],f=this.options,d=f.debug;l.length;){n=l.pop(),r=l.pop(),i=l.pop(),e=l.pop();var S=1<<i,O=an(i,r,n),Z=this.tiles[O];if(!Z&&(d>1&&console.time("creation"),Z=this.tiles[O]=di(e,i,r,n,f),this.tileCoords.push({z:i,x:r,y:n}),d)){d>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",i,r,n,Z.numFeatures,Z.numPoints,Z.numSimplified),console.timeEnd("creation"));var U="z"+i;this.stats[U]=(this.stats[U]||0)+1,this.total++}if(Z.source=e,t){if(i===f.maxZoom||i===t)continue;var se=1<<t-i;if(r!==Math.floor(a/se)||n!==Math.floor(s/se))continue}else if(i===f.indexMaxZoom||Z.numPoints<=f.indexMaxPoints)continue;if(Z.source=null,e.length!==0){d>1&&console.time("clipping");var le=.5*f.buffer/f.extent,ye=.5-le,Be=.5+le,rt=1+le,Je,Ot,jt,dr,Lr,jr;Je=Ot=jt=dr=null,Lr=_t(e,S,r-le,r+Be,0,Z.minX,Z.maxX,f),jr=_t(e,S,r+ye,r+rt,0,Z.minX,Z.maxX,f),e=null,Lr&&(Je=_t(Lr,S,n-le,n+Be,1,Z.minY,Z.maxY,f),Ot=_t(Lr,S,n+ye,n+rt,1,Z.minY,Z.maxY,f),Lr=null),jr&&(jt=_t(jr,S,n-le,n+Be,1,Z.minY,Z.maxY,f),dr=_t(jr,S,n+ye,n+rt,1,Z.minY,Z.maxY,f),jr=null),d>1&&console.timeEnd("clipping"),l.push(Je||[],i+1,r*2,n*2),l.push(Ot||[],i+1,r*2,n*2+1),l.push(jt||[],i+1,r*2+1,n*2),l.push(dr||[],i+1,r*2+1,n*2+1)}}},Ia.prototype.getTile=function(e,i,r){var n=this.options,t=n.extent,a=n.debug;if(e<0||e>24)return null;var s=1<<e;i=(i%s+s)%s;var l=an(e,i,r);if(this.tiles[l])return Dn(this.tiles[l],t);a>1&&console.log("drilling down to z%d-%d-%d",e,i,r);for(var f=e,d=i,S=r,O;!O&&f>0;)f--,d=Math.floor(d/2),S=Math.floor(S/2),O=this.tiles[an(f,d,S)];return!O||!O.source?null:(a>1&&console.log("found parent tile z%d-%d-%d",f,d,S),a>1&&console.time("drilling down"),this.splitTile(O.source,f,d,S,e,i,r),a>1&&console.timeEnd("drilling down"),this.tiles[l]?Dn(this.tiles[l],t):null)};function an(e,i,r){return((1<<e)*r+i)*32+e}function Ln(e,i){for(var r in i)e[r]=i[r];return e}var re=I(15671),he=I(43144),V=I(4942),Et=function(){function e(i,r,n,t){(0,re.Z)(this,e),(0,V.Z)(this,"vectorLayerCache",{}),this.x=r,this.y=n,this.z=t,this.vectorTile=i}return(0,he.Z)(e,[{key:"getTileData",value:function(r){if(!r||!this.vectorTile.layers[r])return[];if(this.vectorLayerCache[r])return this.vectorLayerCache[r];var n=this.vectorTile.layers[r];return n.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),Bt={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function Le(e){for(var i=0,r=0,n=e.length,t=n-1,a,s;r<n;t=r++)a=e[r],s=e[t],i+=(s.x-a.x)*(a.y+s.y);return i}function St(e){var i=e.length;if(i<=1)return[e];for(var r=[],n,t,a=0;a<i;a++){var s=Le(e[a]);s!==0&&(t===void 0&&(t=s<0),t===s<0?(n&&r.push(n),n=[e[a]]):n.push(e[a]))}return n&&r.push(n),r}var tt=["Unknown","Point","LineString","Polygon"];function At(e,i,r,n,t){var a=t.geometry,s=t.type,l=t.tags,f=t.id,d=e*Math.pow(2,n),S=e*i,O=e*r,Z=tt[s],U,se;function le(rt){for(var Je=0;Je<rt.length;Je++){var Ot=rt[Je];if(Ot[3])break;var jt=180-(Ot[1]+O)*360/d,dr=(Ot[0]+S)*360/d-180,Lr=360/Math.PI*Math.atan(Math.exp(jt*Math.PI/180))-90;rt[Je]=[dr,Lr,0,1]}}switch(s){case 1:var ye=[];for(U=0;U<a.length;U++)ye[U]=a[U][0];a=ye,le(a);break;case 2:for(U=0;U<a.length;U++)le(a[U]);break;case 3:for(a=St(a),U=0;U<a.length;U++)for(se=0;se<a[U].length;se++)le(a[U][se]);break}a.length===1?a=a[0]:Z="Multi"+Z;var Be={type:"Feature",geometry:{type:Z,coordinates:a},properties:l,id:f,tileOrigin:[0,0],coord:""};return Be}var tr=function(){var e=(0,Dt.Z)(Ze().mark(function i(r,n,t,a){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",new Promise(function(f){var d=n.getTile(r.z,r.x,r.y),S=d?d.features.map(function(U){return At(a,t.x,t.y,t.z,U)}):[],O={layers:{defaultLayer:{features:S}}},Z=new Et(O,r.x,r.y,r.z);f(Z)}));case 1:case"end":return l.stop()}},i)}));return function(r,n,t,a){return e.apply(this,arguments)}}();function en(e){var i={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions=="undefined"?i:(0,ue.Z)((0,ue.Z)({},i),e.geojsonvtOptions)}function Kr(e,i){var r=en(i),n=r.extent||4096,t=Ba(e,r),a=function(f,d){return tr(d,t,f,n)},s=(0,ue.Z)((0,ue.Z)((0,ue.Z)({},Bt),i),{},{getTileData:a});return{data:e,dataArray:[],tilesetOptions:s,isTile:!0}}var Ft=I(60136),rr=I(82963),ot=I(61120),Li=I(89611);function Hr(e){return Function.toString.call(e).indexOf("[native code]")!==-1}var _i=I(78814);function vi(e,i,r){return(0,_i.Z)()?vi=Reflect.construct.bind():vi=function(t,a,s){var l=[null];l.push.apply(l,a);var f=Function.bind.apply(t,l),d=new f;return s&&(0,Li.Z)(d,s.prototype),d},vi.apply(null,arguments)}function It(e){var i=typeof Map=="function"?new Map:void 0;return It=function(n){if(n===null||!Hr(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof i!="undefined"){if(i.has(n))return i.get(n);i.set(n,t)}function t(){return vi(n,arguments,(0,ot.Z)(this).constructor)}return t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),(0,Li.Z)(t,n)},It(e)}var Yr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Dr(e){this.message=e}Dr.prototype=new Error,Dr.prototype.name="InvalidCharacterError";function Jn(e){var i=String(e).replace(/=+$/,"");if(i.length%4===1)throw new Dr("'atob' failed: The string to be decoded is not correctly encoded.");for(var r="",n=0,t,a,s=0;a=i.charAt(s++);~a&&(t=n%4?t*64+a:a,n++%4)?r+=String.fromCharCode(255&t>>(-2*n&6)):0)a=Yr.indexOf(a);return r}function Kt(e){e=String(e);for(var i,r,n,t,a="",s=0,l=e.length%3;s<e.length;){if((r=e.charCodeAt(s++))>255||(n=e.charCodeAt(s++))>255||(t=e.charCodeAt(s++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");i=r<<16|n<<8|t,a+=Yr.charAt(i>>18&63)+Yr.charAt(i>>12&63)+Yr.charAt(i>>6&63)+Yr.charAt(i&63)}return l?a.slice(0,l-3)+"===".substring(l):a}var hr=function(){function e(i,r){(0,re.Z)(this,e),this.buffers=i,this.type=r}return(0,he.Z)(e,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(r,n,t){throw new Error("not implemented")}}]),e}(),Fr,qr=function(){return Fr||(Fr=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof I.g!="undefined"?I.g:{})};Fr=qr();var An;typeof window=="undefined"?An={devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(i){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(i){return null},clearMeasures:function(i){return null},clearMarks:function(i){return null},measure:function(i,r,n){return{duration:0}},now:function(){return new Date().getTime()}},Blob:"",dispatchEvent:function(i){return!0},Event:function(i,r){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:An=window;var Ui=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,fa=Ui?my.getSystemInfoSync().pixelRatio:An.devicePixelRatio,Wi=(0,he.Z)(function e(i,r){(0,re.Z)(this,e),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=i,this.timeStamp=Date.now()}),ct=I(97326);function qi(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Na(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Na(e,i){if(e){if(typeof e=="string")return To(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return To(e,i)}}function To(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var ao=new WeakMap,Ga=function(){function e(){(0,re.Z)(this,e),ao.set(this,{})}return(0,he.Z)(e,[{key:"addEventListener",value:function(r,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=ao.get(this);a||(a={}),a[r]||(a[r]=[]),a[r].push(n),ao.set(this,a),t.capture,t.once,t.passive}},{key:"removeEventListener",value:function(r,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=ao.get(this);if(a){var s=a[r];if(s&&s.length>0){for(var l=s.length;l--;l>0)if(s[l]===n){s.splice(l,1);break}}}}},{key:"dispatchEvent",value:function(r){var n=ao.get(this)[r.type];if(n){var t=qi(n),a;try{for(t.s();!(a=t.n()).done;){var s=a.value;s(r)}}catch(l){t.e(l)}finally{t.f()}}}}]),e}();function Ko(e){var i=ws();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function ws(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fo=function(e){(0,Ft.Z)(r,e);var i=Ko(r);function r(){var n;return(0,re.Z)(this,r),n=i.call(this),n.childNodes=[],n}return(0,he.Z)(r,[{key:"appendChild",value:function(t){this.childNodes.push(t)}},{key:"cloneNode",value:function(){var t=Object.create(this);return Object.assign(t,this),t}},{key:"removeChild",value:function(t){var a=this.childNodes.findIndex(function(s){return s===t});return a>-1?this.childNodes.splice(a,1):null}}]),r}(Ga);function su(e){var i=zo();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function zo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ns=function(e){(0,Ft.Z)(r,e);var i=su(r);function r(){var n;return(0,re.Z)(this,r),n=i.call(this),n.className="",n.children=[],n}return(0,he.Z)(r,[{key:"setAttribute",value:function(t,a){this[t]=a}},{key:"getAttribute",value:function(t){return this[t]}},{key:"setAttributeNS",value:function(t,a){this[t]=a}},{key:"getAttributeNS",value:function(t){return this[t]}}]),r}(Fo),ls=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,_o,Po,Ss,Wu;if(ls){var $s=my.getSystemInfoSync();_o=$s.screenWidth,Po=$s.screenHeight,Ss=$s.windowWidth,Wu=$s.windowHeight}else{var uu=An.innerWidth,Jo=An.innerHeight;_o=uu,Po=Jo,Ss=uu,Wu=Jo}var ms={width:_o,height:Po,availWidth:Ss,availHeight:Wu,availLeft:0,availTop:0},eu=ms.availWidth,Bs=ms.availHeight,fi={style:[]};function is(e,i){if(!("parentNode"in e)){var r;i===0?r=function(){return null}:i===1?r=function(){return fi}:r=function(){return null},Object.defineProperty(e,"parentNode",{enumerable:!0,get:r})}if(!("parentElement"in e)){var n;i===0?n=function(){return null}:i===1?n=function(){return fi}:n=function(){return null},Object.defineProperty(e,"parentElement",{enumerable:!0,get:n})}}function ku(e){e.style=e.style||{},Object.assign(e.style,{top:"0px",left:"0px",width:eu+"px",height:Bs+"px",margin:"0px",padding:"0px"})}function mt(e){"clientLeft"in e||(e.clientLeft=0,e.clientTop=0),"clientWidth"in e||(e.clientWidth=eu,e.clientHeight=Bs),"getBoundingClientRect"in e||(e.getBoundingClientRect=function(){var i={x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight};return i})}function Gt(e){"offsetLeft"in e||(e.offsetLeft=0,e.offsetTop=0),"offsetWidth"in e||(e.offsetWidth=eu,e.offsetHeight=Bs)}function Cr(e){"scrollLeft"in e||(e.scrollLeft=0,e.scrollTop=0),"scrollWidth"in e||(e.scrollWidth=eu,e.scrollHeight=Bs)}function Rr(e){var i=function(){return!0};e.classList=[],e.classList.add=i,e.classList.remove=i,e.classList.contains=i,e.classList.toggle=i}function ji(e){var i=Pa();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Pa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Yt(){}var De=function(e){(0,Ft.Z)(r,e);var i=ji(r);function r(){var n,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0;return(0,re.Z)(this,r),n=i.call(this),n.className="",n.children=[],n.focus=Yt,n.blur=Yt,n.insertBefore=Yt,n.appendChild=Yt,n.removeChild=Yt,n.remove=Yt,n.innerHTML="",n.tagName=t.toUpperCase(),is((0,ct.Z)(n),a),ku((0,ct.Z)(n)),Rr((0,ct.Z)(n)),mt((0,ct.Z)(n)),Gt((0,ct.Z)(n)),Cr((0,ct.Z)(n)),n}return(0,he.Z)(r)}(ns);function Me(e){var i=ce();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function ce(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var He=function(e){(0,Ft.Z)(r,e);var i=Me(r);function r(n){return(0,re.Z)(this,r),i.call(this,n)}return(0,he.Z)(r,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),r}(De);function Pe(e){var i=Tt();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Tt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Mt=function(e){(0,Ft.Z)(r,e);var i=Pe(r);function r(){return(0,re.Z)(this,r),i.call(this,"video")}return(0,he.Z)(r)}(He),$t={},fr={};function Tr(e,i){$t=e,$t.id=i,"tagName"in $t||($t.tagName="CANVAS"),$t.type="canvas",Mixin.parentNode($t),Mixin.style($t),Mixin.classList($t),Mixin.clientRegion($t),Mixin.offsetRegion($t),$t.focus=function(){},$t.blur=function(){}}function Sr(e,i){var r=1024,n=1024;fr={width:r,height:n,clientWidth:r/devicePixelRatio,clientHeight:n/devicePixelRatio,id:i,type:"canvas"},"tagName"in fr||(fr.tagName="CANVAS"),Mixin.parentNode(fr),Mixin.style(fr),Mixin.classList(fr),Mixin.clientRegion(fr),Mixin.offsetRegion(fr),fr.getContext=function(t){if(t==="2d")return e},fr.focus=function(){},fr.blur=function(){}}function sn(){return $t}function lt(){return fr}var Xt=(0,he.Z)(function e(){(0,re.Z)(this,e);var i=sn(),r=i.createImage&&i.createImage()||{};return"tagName"in r||(r.tagName="IMG",r.__proto__=e.prototype),is(r),Rr(r),Object.assign(r,{addEventListener:function(t,a){r["on".concat(t)]=a.bind(r)},removeEventListener:function(t){r["on".concat(t)]=null}}),r}),nr={href:"",protocol:"",host:""};function ur(e){var i=Vr();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Vr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ln=function(e){(0,Ft.Z)(r,e);var i=ur(r);function r(){return(0,re.Z)(this,r),i.call(this,"body",0)}return(0,he.Z)(r,[{key:"addEventListener",value:function(t,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(t,a,s){}},{key:"dispatchEvent",value:function(t){}}]),r}(De),Un=function(e){(0,Ft.Z)(r,e);var i=ur(r);function r(){return(0,re.Z)(this,r),i.call(this,"html",0)}return(0,he.Z)(r,[{key:"addEventListener",value:function(t,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(t,a){}},{key:"dispatchEvent",value:function(t){}}]),r}(De),Gn={},qn={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:nr,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(i){return i=i.toLowerCase(),i==="canvas"?my.createOffscreenCanvas(1024,128,"2d"):i==="img"?new Xt:i==="video"?new Mt:new De(i)},createElementNS:function(i,r){return this.createElement(r)},createTextNode:function(i){return i},getElementById:function(i){return null},getElementsByTagName:function(i){return i=i.toLowerCase(),[]},getElementsByTagNameNS:function(i,r){return this.getElementsByTagName(r)},getElementsByName:function(i){return[]},querySelector:function(i){return null},querySelectorAll:function(i){return[]},addEventListener:function(i,r,n){Gn[i]||(Gn[i]=[]),Gn[i].push(r)},removeEventListener:function(i,r){var n=Gn[i];if(n&&n.length>0){for(var t=n.length;t--;t>0)if(n[t]===r){n.splice(t,1);break}}},dispatchEvent:function(i){var r=i.type,n=Gn[r];if(n)for(var t=0;t<n.length;t++)n[t](i);i.target&&typeof i.target["on"+r]=="function"&&i.target["on"+r](i)},createEvent:function(i){return new Wi(i)}};qn.documentElement=new Un,qn.head=new De("head"),qn.body=new ln;var oi=Object,T=function(){function e(){(0,re.Z)(this,e);var i=arguments.length;if(i===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){this._w=arguments[0],this._h=arguments[1],this._data=new Uint8ClampedArray(this._w*this._h*4);return}}else i===3&&(0,on.Z)(arguments[0])==="object"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return(0,he.Z)(e,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),e}(),H=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,_e,ne,$e;if(H){var xt=my.getSystemInfoSync();_e=xt.system,ne=xt.platform,$e=xt.language}else{var zt={versions:function(){var e=An.navigator.userAgent;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")===-1,mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:e.indexOf("Safari")===-1,weixin:e.indexOf("MicroMessenger")>-1,qq:e.match(/\sQQ/i)===" qq"}}(),language:(An.navigator.browserLanguage||An.navigator.language).toLowerCase()};zt.versions.android?ne="android":zt.versions.trident?ne="IE":zt.versions.presto?ne="Opera":zt.versions.webKit?ne="webKit":zt.versions.gecko?ne="Firefox":zt.versions.mobile?ne="mobile":zt.versions.ios?ne="ios":zt.versions.iPhone?ne="iPhone":zt.versions.iPad?ne="ipad":zt.versions.webApp?ne="webApp":zt.versions.weixin?ne="weixin":zt.versions.qq&&(ne="qq"),_e=An.navigator.userAgent,$e=zt.language}var _r=_e.toLowerCase().indexOf("android")!==-1,xr=_r?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",dn="Mozilla/5.0 (".concat(xr,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat($e),Bn={platform:ne,language:$e,appVersion:"5.0 (".concat(xr,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:dn},zi={mark:function(i){return null},clearMeasures:function(i){return null},clearMarks:function(i){return null},measure:function(i,r,n){return{duration:0}},now:function(){}},Vi=0,Ei=0;function qa(e){var i=Date.now(),r=Math.max(Vi+23,i);return Ei=setTimeout(function(){e(Vi=r)},r-i),Ei}function $a(e){var i=sn();return i.requestAnimationFrame?i.requestAnimationFrame(e):qa(e)}function La(e){var i=sn();return i.cancelAnimationFrame?i.cancelAnimationFrame(e):clearTimeout(e)}var to=function(){function e(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if((0,re.Z)(this,e),i.indexOf("http://")==0||i.indexOf("https://")==0){this.href=i;return}this.href=r+i}return(0,he.Z)(e,null,[{key:"createObjectURL",value:function(r){var n=r.buffers[0],t=r.type,a=Ho(n),s="data:".concat(t,";base64, ");return s+a}}]),e}();function Ho(e){for(var i="",r=new Uint8Array(e),n=r.byteLength,t=0;t<n;t++)i+=String.fromCharCode(r[t]);return Kt(i)}var xo={GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:18446744073709552e3,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},bo={};function so(e){var i=Cs();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Cs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ls=new Map,Rs=new Map,lu=new Map,ps={json:"application/json",text:"application/text",arraybuffer:"application/octet-stream"};function Go(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:this};typeof this["on".concat(e)]=="function"&&this["on".concat(e)].call(this,i)}function zu(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{readyState:e};this.readyState=e,Go.call(this,"readystatechange",i)}var al=function(e){(0,Ft.Z)(r,e);var i=so(r);function r(){var n;return(0,re.Z)(this,r),n=i.call(this),n.onabort=null,n.onerror=null,n.onload=null,n.onloadstart=null,n.onprogress=null,n.ontimeout=null,n.onloadend=null,n.onreadystatechange=null,n.readyState=0,n.response=null,n.responseText=null,n._responseType="text",n.responseXML=null,n.status=0,n.statusText="",n.upload={},n.withCredentials=!1,Ls.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),n}return(0,he.Z)(r,[{key:"responseType",set:function(t){this._responseType=t}},{key:"abort",value:function(){var t=lu.get("requestTask");t&&t.abort()}},{key:"getAllResponseHeaders",value:function(){var t=Rs.get("responseHeader");return Object.keys(t).map(function(a){return"".concat(a,": ").concat(t[a])}).join(`
`)}},{key:"getResponseHeader",value:function(t){return Rs.get("responseHeader")[t]}},{key:"open",value:function(t,a,s){this._method=t,this._url=a}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:""}},{key:"setRequestHeader",value:function(t,a){var s=Ls.get("requestHeader");s[t]=a,Ls.set("requestHeader",s)}},{key:"addEventListener",value:function(t,a){var s=this;typeof a=="function"&&(this["on"+t]=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};l.target=l.target||s,a.call(s,l)})}},{key:"removeEventListener",value:function(t,a){this["on"+t]===a&&(this["on"+t]=null)}}]),r}(Ga);al.UNSEND=0,al.OPENED=1,al.HEADERS_RECEIVED=2,al.LOADING=3,al.DONE=4;function ou(e){var i=Xu();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Xu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Nu=function(e){(0,Ft.Z)(r,e);var i=ou(r);function r(n){return(0,re.Z)(this,r),i.call(this,n)}return(0,he.Z)(r)}(Wi);function ks(e){return function(i){i.type=e,qn.dispatchEvent(i)}}var Sc=ks("mousedown"),vl=ks("mousemove"),es=ks("mouseup");function Al(e){var i=tf();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function tf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Zl=function(e){(0,Ft.Z)(r,e);var i=Al(r);function r(n){var t;return(0,re.Z)(this,r),t=i.call(this,n),t.target=sn(),t.currentTarget=sn(),t}return(0,he.Z)(r)}(Wi),uc=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","pageX","pageY","timeStamp"],pf=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,0,0,0],ql="touch";function Cu(e,i,r){for(var n=new Zl(e),t=0;t<uc.length;t++){var a=uc[t];n[a]=i[a]||pf[t]}return n.type=e,n.target=sn(),n.currentTarget=sn(),n.buttons=rf(e),n.which=n.buttons,n.pointerId=(i.identifier||0)+2,n.bubbles=!0,n.cancelable=!0,n.button=0,n.width=(i.radiusX||.5)*2,n.height=(i.radiusY||.5)*2,n.pressure=i.force||.5,n.isPrimary=as(i),n.pointerType=ql,n.altKey=r.altKey,n.ctrlKey=r.ctrlKey,n.metaKey=r.metaKey,n.shiftKey=r.shiftKey,r.preventDefault&&(n.preventDefault=function(){r.preventDefault()}),n}function rf(e){var i=0;return(e==="touchstart"||e==="touchmove"||e==="pointerdown"||e==="pointermove")&&(i=1),i}var ol=null;function as(e){return ol===e.identifier}function Ds(e){ol===null&&(ol=e.identifier)}function Tl(e){ol===e.identifier&&(ol=null)}function Yu(e){return function(i){for(var r=i.changedTouches,n=0;n<r.length;n++){var t=r[n];n===0&&e==="pointerdown"?Ds(t):(e==="pointerup"||e==="pointercancel")&&Tl(t);var a=Cu(e,t,i);qn.dispatchEvent(a)}}}var Ml=Yu("pointerdown"),xl=Yu("pointermove"),nf=Yu("pointerup");function Vc(e){var i=Zf();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Zf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Hc=function(e){(0,Ft.Z)(r,e);var i=Vc(r);function r(n){var t;return(0,re.Z)(this,r),t=i.call(this,n),t.touches=[],t.targetTouches=[],t.changedTouches=[],t.target=sn(),t.currentTarget=sn(),t}return(0,he.Z)(r)}(Wi);function Ql(e){var i=e||{},r=i.x,n=r===void 0?0:r,t=i.y,a=t===void 0?0:t,s=i.clientX,l=s===void 0?0:s,f=i.clientY,d=f===void 0?0:f;Object.keys(e).indexOf("x")!==-1?(e.pageX=e.clientX=n,e.pageY=e.clientY=a):(e.x=l,e.y=d)}function sl(e){return function(i){var r=new Hc(e);r.changedTouches=i.changedTouches,r.touches=i.touches,r.targetTouches=Array.prototype.slice.call(i.touches),r.timeStamp=i.timeStamp,r.changedTouches.forEach(function(n){return Ql(n)}),r.touches.forEach(function(n){return Ql(n)}),r.targetTouches.forEach(function(n){return Ql(n)}),qn.dispatchEvent(r)}}function vc(e){return function(i){i.type=e,qn.dispatchEvent(i)}}var Jl=sl("touchstart"),ts=sl("touchmove"),gs=sl("touchend"),$o=vc("mapCameaParams"),ds=!1;function Ns(e){ds=e}var Mu=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ec=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),zs=(Mu||ec)&&ds,df={atob:Jn,btoa:Kt,devicePixelRatio:fa,Blob:hr,document:qn,Element:ns,Event:Wi,EventTarget:Ga,HTMLCanvasElement:oi,HTMLElement:De,HTMLMediaElement:He,HTMLVideoElement:Mt,Image:Xt,ImageData:T,navigator:Bn,Node:Fo,requestAnimationFrame:$a,cancelAnimationFrame:La,screen:ms,XMLHttpRequest:al,performance:zi,URL:to,WebGLRenderingContext:xo,WebGL2RenderingContext:bo,addEventListener:function(i,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};qn.addEventListener(i,r,n)},removeEventListener:function(i,r,n){qn.removeEventListener(i,r)},dispatchEvent:function(i){qn.dispatchEvent(i)},innerWidth:ms.availWidth,innerHeight:ms.availHeight,setTimeout,clearTimeout,setInterval,clearInterval},ha=zs?df:An,Gc=zs?al:An.XMLHttpRequest,kc=zs?nr:An.location;function un(e){var i=Mi();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Mi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ei=function(e){(0,Ft.Z)(r,e);var i=un(r);function r(n,t,a,s){var l;return(0,re.Z)(this,r),l=i.call(this,"AJAXError: ".concat(t," (").concat(n,"): ").concat(a)),l.status=n,l.statusText=t,l.url=a,l.body=s,l}return(0,he.Z)(r)}(It(Error));function za(e,i){var r=new Gc,n=Array.isArray(e.url)?e.url[0]:e.url;r.open(e.method||"GET",n,!0),e.type==="arrayBuffer"&&(r.responseType="arraybuffer");for(var t in e.headers)e.headers.hasOwnProperty(t)&&r.setRequestHeader(t,e.headers[t]);return e.type==="json"&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials=e.credentials==="include",r.onerror=function(){i(new Error(r.statusText))},r.onload=function(){if((r.status>=200&&r.status<300||r.status===0)&&r.response!==null){var a=r.response;if(e.type==="json")try{a=JSON.parse(r.response)}catch(l){return i(l)}i(null,a,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"),r)}else{var s=new Blob([r.response],{type:r.getResponseHeader("Content-Type")});i(new ei(r.status,r.statusText,n.toString(),s))}},r.send(e.body),r}function Za(e){return new Promise(function(i,r){za(e,function(n,t,a,s,l){n?r({err:n,data:null,xhr:l}):i({err:null,data:t,cacheControl:a,expires:s,xhr:l})})})}function Oo(e,i){return za(e,i)}var mu=function(i,r){return Oo((0,ue.Z)((0,ue.Z)({},i),{},{type:"json"}),r)},Au=function(i,r){return Oo((0,ue.Z)((0,ue.Z)({},i),{},{type:"arrayBuffer"}),r)},Rl=function(i,r){return Oo((0,ue.Z)((0,ue.Z)({},i),{},{method:"POST"}),r)};function xh(e){var i=ha.document.createElement("a");return i.href=e,i.protocol===ha.document.location.protocol&&i.host===ha.document.location.host}var vf="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Wh(e,i){var r=new ha.Image,n=ha.URL||ha.webkitURL;r.crossOrigin="anonymous",r.onload=function(){i(null,r),n.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(function(){r.src=vf})},r.onerror=function(){return i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var t=new Blob([new Uint8Array(e)],{type:"image/png"});r.src=e.byteLength?n.createObjectURL(t):vf}function oh(e,i){var r=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(r).then(function(n){i(null,n)}).catch(function(n){i(new Error("Could not load image because of ".concat(n.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var mc=function(i,r,n){var t=function(s,l){if(s)r(s);else if(l){var f=typeof createImageBitmap=="function",d=n?n(l):l;f?oh(d,r):Wh(d,r)}};return i.type==="json"?mu(i,t):Au(i,t)},lc;(function(e){e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e["BOTTOM-RIGHT"]="bottom-right",e.LEFT="left",e.RIGHT="right"})(lc||(lc={}));var Ku={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xs(e,i,r){var n=e.classList;for(var t in Ku)Ku.hasOwnProperty(t)&&n.remove("l7-".concat(r,"-anchor-").concat(t));n.add("l7-".concat(r,"-anchor-").concat(i))}function sh(e,i,r){e.prototype=i.prototype=r,r.constructor=e}function bl(e,i){var r=Object.create(e.prototype);for(var n in i)r[n]=i[n];return r}function Ca(){}var Zu=.7,$c=1/Zu,os="\\s*([+-]?\\d+)\\s*",yo="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",As="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ul=/^#([0-9a-f]{3,8})$/,Xi=new RegExp("^rgb\\("+[os,os,os]+"\\)$"),cc=new RegExp("^rgb\\("+[As,As,As]+"\\)$"),Dc=new RegExp("^rgba\\("+[os,os,os,yo]+"\\)$"),af=new RegExp("^rgba\\("+[As,As,As,yo]+"\\)$"),Ws=new RegExp("^hsl\\("+[yo,As,As]+"\\)$"),kl=new RegExp("^hsla\\("+[yo,As,As,yo]+"\\)$"),Cc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};sh(Ca,hc,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:fc,formatHex:fc,formatHsl:Fc,formatRgb:Sf,toString:Sf});function fc(){return this.rgb().formatHex()}function Fc(){return Dl(this).formatHsl()}function Sf(){return this.rgb().formatRgb()}function hc(e){var i,r;return e=(e+"").trim().toLowerCase(),(i=Ul.exec(e))?(r=i[1].length,i=parseInt(i[1],16),r===6?ap(i):r===3?new Tu(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):r===8?jl(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):r===4?jl(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=Xi.exec(e))?new Tu(i[1],i[2],i[3],1):(i=cc.exec(e))?new Tu(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=Dc.exec(e))?jl(i[1],i[2],i[3],i[4]):(i=af.exec(e))?jl(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=Ws.exec(e))?cu(i[1],i[2]/100,i[3]/100,1):(i=kl.exec(e))?cu(i[1],i[2]/100,i[3]/100,i[4]):Cc.hasOwnProperty(e)?ap(Cc[e]):e==="transparent"?new Tu(NaN,NaN,NaN,0):null}function ap(e){return new Tu(e>>16&255,e>>8&255,e&255,1)}function jl(e,i,r,n){return n<=0&&(e=i=r=NaN),new Tu(e,i,r,n)}function op(e){return e instanceof Ca||(e=hc(e)),e?(e=e.rgb(),new Tu(e.r,e.g,e.b,e.opacity)):new Tu}function tc(e,i,r,n){return arguments.length===1?op(e):new Tu(e,i,r,n==null?1:n)}function Tu(e,i,r,n){this.r=+e,this.g=+i,this.b=+r,this.opacity=+n}sh(Tu,tc,bl(Ca,{brighter:function(e){return e=e==null?$c:Math.pow($c,e),new Tu(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Zu:Math.pow(Zu,e),new Tu(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bs,formatHex:bs,formatRgb:Xf,toString:Xf}));function bs(){return"#"+Cf(this.r)+Cf(this.g)+Cf(this.b)}function Xf(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Cf(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function cu(e,i,r,n){return n<=0?e=i=r=NaN:r<=0||r>=1?e=i=NaN:i<=0&&(e=NaN),new Fl(e,i,r,n)}function Dl(e){if(e instanceof Fl)return new Fl(e.h,e.s,e.l,e.opacity);if(e instanceof Ca||(e=hc(e)),!e)return new Fl;if(e instanceof Fl)return e;e=e.rgb();var i=e.r/255,r=e.g/255,n=e.b/255,t=Math.min(i,r,n),a=Math.max(i,r,n),s=NaN,l=a-t,f=(a+t)/2;return l?(i===a?s=(r-n)/l+(r<n)*6:r===a?s=(n-i)/l+2:s=(i-r)/l+4,l/=f<.5?a+t:2-a-t,s*=60):l=f>0&&f<1?0:s,new Fl(s,l,f,e.opacity)}function mf(e,i,r,n){return arguments.length===1?Dl(e):new Fl(e,i,r,n==null?1:n)}function Fl(e,i,r,n){this.h=+e,this.s=+i,this.l=+r,this.opacity=+n}sh(Fl,mf,bl(Ca,{brighter:function(e){return e=e==null?$c:Math.pow($c,e),new Fl(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Zu:Math.pow(Zu,e),new Fl(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,i=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*i,t=2*r-n;return new Tu(Ac(e>=240?e-240:e+120,t,n),Ac(e,t,n),Ac(e<120?e+240:e-120,t,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Ac(e,i,r){return(e<60?i+(r-i)*e/60:e<180?r:e<240?i+(r-i)*(240-e)/60:i)*255}function Yf(e){return typeof e=="string"?!!hc(e):!1}function Qi(e){var i=hc(e),r=[0,0,0,0];return i!=null&&(r[0]=i.r/255,r[1]=i.g/255,r[2]=i.b/255,r[3]=i.opacity),r}function Xa(e){var i=e&&e[0],r=e&&e[1],n=e&&e[2],t=i+r*256+n*65536-1;return t}function of(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function Pl(e){var i=ha.document.createElement("canvas"),r=i.getContext("2d");i.width=256,i.height=1;for(var n=null,t=r.createLinearGradient(0,0,256,1),a=e.positions[0],s=e.positions[e.positions.length-1],l=0;l<e.colors.length;++l){var f=(e.positions[l]-a)/(s-a);t.addColorStop(f,e.colors[l])}if(r.fillStyle=t,r.fillRect(0,0,256,1),zs)return n=new Uint8ClampedArray(r.getImageData(0,0,256,1).data),i=null,r=null,{data:n,width:256,height:1};n=r.getImageData(0,0,256,1).data;for(var d=r.createImageData(256,1),S=0;S<d.data.length;S+=4)d.data[S+0]=n[S+0],d.data[S+1]=n[S+1],d.data[S+2]=n[S+2],d.data[S+3]=n[S+3];return i=null,r=null,d}function Bc(e,i){var r=ha.document.createElement("canvas"),n=r.getContext("2d");r.width=256,r.height=1;for(var t=n.createLinearGradient(0,0,256,1),a=i[1]-i[0],s=0;s<e.colors.length;++s){var l=Math.max((e.positions[s]-i[0])/a,0);t.addColorStop(l,e.colors[s])}n.fillStyle=t,n.fillRect(0,0,256,1);var f=n.getImageData(0,0,256,1).data,d=sp(n,f);return r=null,n=null,d}function Qu(e){var i=ha.document.createElement("canvas"),r=i.getContext("2d");i.width=256,i.height=1;var n=r.createImageData(256,1);return n.data.fill(0),e.positions.forEach(function(t,a){var s=Qi(e.colors[a]);n.data[t*4+0]=s[0]*255,n.data[t*4+1]=s[1]*255,n.data[t*4+2]=s[2]*255,n.data[t*4+3]=s[3]*255}),i=null,r=null,n}function ul(e){var i=ha.document.createElement("canvas"),r=i.getContext("2d");r.globalAlpha=1,i.width=256,i.height=1;for(var n=256/e.colors.length,t=0;t<e.colors.length;t++)r.beginPath(),r.lineWidth=2,r.strokeStyle=e.colors[t],r.moveTo(t*n,0),r.lineTo((t+1)*n,0),r.stroke();var a=r.getImageData(0,0,256,1).data,s=sp(r,a);return i=null,r=null,s}function uh(e,i){var r=ha.document.createElement("canvas"),n=r.getContext("2d");n.globalAlpha=1,r.width=256,r.height=1;var t=i[1]-i[0];e.positions.length-e.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(var a=0;a<e.colors.length;a++)n.beginPath(),n.lineWidth=2,n.strokeStyle=e.colors[a],n.moveTo((e.positions[a]-i[0])/t*255,0),n.lineTo((e.positions[a+1]-i[0])/t*255,0),n.stroke();var s=n.getImageData(0,0,256,1).data,l=sp(n,s);return r=null,n=null,l}function sp(e,i){for(var r=e.createImageData(256,1),n=0;n<r.data.length;n+=4)r.data[n+0]=i[n+0],r.data[n+1]=i[n+1],r.data[n+2]=i[n+2],r.data[n+3]=i[n+3];return r}function fu(e){switch(e.type){case"cat":return[0,255];default:return[0,1]}}var Pu={BACK:1029,FRONT:1028};function up(e){switch(e){case"GAODE1.x":return Pu.BACK;case"GAODE2.x":return Pu.BACK;case"MAPBOX":return Pu.FRONT;case"SIMPLE":return Pu.FRONT;case"GLOBEL":return Pu.BACK;case"DEBAULT":return Pu.FRONT;default:return Pu.FRONT}}var Ja=I(97685),Kn=I(96486);function Wc(e){var i=e;return typeof e=="string"&&(i=ha.document.getElementById(e)),i}function Ju(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Nt(e){return Ju(e).split(/\s+/)}function Xc(e){var i,r,n=ha==null||(i=ha.document)===null||i===void 0||(r=i.documentElement)===null||r===void 0?void 0:r.style;if(!n)return e[0];for(var t in e)if(e[t]&&e[t]in n)return e[t];return e[0]}function ss(e,i,r){var n=ha.document.createElement(e);return i&&(n.className=i||""),r&&r.appendChild(n),n}function Uu(e){var i=e.parentNode;i&&i.removeChild(e)}function cs(e,i){if(e.classList!==void 0)for(var r=Nt(i),n=0,t=r.length;n<t;n++)e.classList.add(r[n]);else if(!Uf(e,i)){var a=Tc(e);Nc(e,(a?a+" ":"")+i)}}function Kf(e,i){e.classList!==void 0?e.classList.remove(i):Nc(e,Ju((" "+Tc(e)+" ").replace(" "+i+" "," ")))}function Uf(e,i){if(e.classList!==void 0)return e.classList.contains(i);var r=Tc(e);return r.length>0&&new RegExp("(^|\\s)"+i+"(\\s|$)").test(r)}function Nc(e,i){e instanceof HTMLElement?e.className=i:e.className.baseVal=i}function Tc(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function gf(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}var lh=Xc(["transform","WebkitTransform"]);function Af(e,i){e.style[lh]=i}function Tf(){if(typeof Event=="function")ha.dispatchEvent(new Event("resize"));else{var e=ha.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,ha,0),ha.dispatchEvent(e)}}function Mf(e){var i=["padding: "+(e.height/2-8)+"px "+e.width/2+"px;","line-height: "+e.height+"px;","background-image: url("+e.toDataURL()+");"];console.log(`%c
`,i.join(""))}function Pf(){var e,i=ha.document.querySelector('meta[name="viewport"]');if(!i)return 1;var r=(e=i.content)===null||e===void 0?void 0:e.split(","),n=r.find(function(t){var a=t.split("="),s=(0,Ja.Z)(a,1),l=s[0];return l==="initial-scale"});return n?n.split("=")[1]*1:1}var ju=Pf()<1?1:ha.devicePixelRatio;function gp(e,i){e.setAttribute("style","".concat(e.style.cssText).concat(i))}function qf(e){return e.split(";").map(function(i){return i.trim()}).filter(function(i){return i})}function h(e,i){var r,n=qf((r=e.getAttribute("style"))!==null&&r!==void 0?r:""),t=qf(i),a=Kn.pull.apply(void 0,[n].concat((0,oe.Z)(t)));e.setAttribute("style",a.join(";"))}function g(e){return Object.entries(e).map(function(i){var r=(0,Ja.Z)(i,2),n=r[0],t=r[1];return"".concat(n,": ").concat(t)}).join(";")}function p(e,i){return{left:e.left-i.left,top:e.top-i.top,right:i.left+i.width-e.left-e.width,bottom:i.top+i.height-e.top-e.height}}function b(e,i){e.checked=i,i?e.setAttribute("checked","true"):e.removeAttribute("checked")}function N(e){e.innerHTML=""}function q(e){e.setAttribute("draggable","false")}function ee(e,i){if(typeof i=="string"){var r=document.createElement("div");for(r.innerHTML=i;r.firstChild;)e.append(r.firstChild)}else Array.isArray(i)?e.append.apply(e,(0,oe.Z)(i)):e.append(i)}function ge(e){return typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap}function Ue(){return typeof importScripts=="function"}var st=Ue()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href},kt=navigator.userAgent,Lt=!!kt.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),Zt=kt.indexOf("Android")>-1||kt.indexOf("Adr")>-1;function vr(){for(var e=navigator.userAgent,i=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],r=!0,n=0,t=i;n<t.length;n++){var a=t[n];if(e.indexOf(a)>0){r=!1;break}}return r}function pr(e,i){e.forEach(function(r){i[r]&&(i[r]=i[r].bind(i))})}var Nr=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16;(0,re.Z)(this,e),(0,V.Z)(this,"duration",16),(0,V.Z)(this,"timestamp",new Date().getTime()),this.duration=i}return(0,he.Z)(e,[{key:"run",value:function(r){var n=new Date().getTime(),t=n-this.timestamp;this.timestamp=n,t>=this.duration&&r()}}]),e}();function cr(e){var i=[1/0,1/0,-1/0,-1/0];return(0,Ht.pZ)(e,function(r){i[0]>r[0]&&(i[0]=r[0]),i[1]>r[1]&&(i[1]=r[1]),i[2]<r[0]&&(i[2]=r[0]),i[3]<r[1]&&(i[3]=r[1])}),i}cr.default=cr;var zr=cr,Ur=I(1449);function Tn(e){return typeof e=="number"}var ti=2*Math.PI*6378137/2;function Yn(e,i){var r=(0,Ja.Z)(i,4),n=r[0],t=r[1],a=r[2],s=r[3];return e.lng>n&&e.lng<=a&&e.lat>t&&e.lat<=s}function ai(e){var i=[1/0,1/0,-1/0,-1/0];return e.forEach(function(r){var n=r.coordinates;Pi(i,n)}),i}function Pi(e,i){return Array.isArray(i[0])?i.forEach(function(r){Pi(e,r)}):(e[0]>i[0]&&(e[0]=i[0]),e[1]>i[1]&&(e[1]=i[1]),e[2]<i[0]&&(e[2]=i[0]),e[3]<i[1]&&(e[3]=i[1])),e}function va(e,i){return na(e,i)}function na(e,i){return Array.isArray(e[0])?e.map(function(r){return na(r,i)}):i(e)}function Ua(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};e=qo(e,i);var n=e[0],t=e[1],a=n*ti/180,s=Math.log(Math.tan((90+t)*Math.PI/360))/(Math.PI/180);return s=s*ti/180,r.enable&&(a=Number(a.toFixed(r.decimal)),s=Number(s.toFixed(r.decimal))),e.length===3?[a,s,e[2]]:[a,s]}function co(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,r=e[0],n=e[1],t=r/ti*180,a=n/ti*180;return a=180/Math.PI*(2*Math.atan(Math.exp(a*Math.PI/180))-Math.PI/2),i!=null&&(t=Number(t.toFixed(i)),a=Number(a.toFixed(i))),e.length===3?[t,a,e[2]]:[t,a]}function Eo(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function ho(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function qo(e,i){if(i===!1)return e;var r=Eo(e[0]),n=ho(e[1]);return n>85&&(n=85),n<-85&&(n=-85),e.length===3?[r,n,e[2]]:[r,n]}function ga(e){var i=85.0511287798,r=Math.max(Math.min(i,e[1]),-i),n=256<<20,t=Math.PI/180,a=e[0]*t,s=r*t;s=Math.log(Math.tan(Math.PI/4+s/2));var l=.5/Math.PI,f=.5,d=-.5/Math.PI;return t=.5,a=n*(l*a+f),s=n*(d*s+t),[Math.floor(a),Math.floor(s)]}function Zo(e){var i=.5/Math.PI,r=.5,n=-.5/Math.PI,t=.5,a=256<<20,s=(0,Ja.Z)(e,2),l=s[0],f=s[1];l=(l/a-r)/i,f=(f/a-t)/n,f=(Math.atan(Math.pow(Math.E,f))-Math.PI/4)*2,t=Math.PI/180;var d=f/t,S=l/t;return[S,d]}function Uo(e,i){var r=85.0511287798,n=Math.PI/180,t=6378137;return i=Math.max(Math.min(r,i),-r),e*=n,i*=n,i=Math.log(Math.tan(Math.PI/4+i/2)),[e*t,i*t]}function Do(e,i){var r=Math.PI/180,n=6378137,t=e/n/r,a=2*(Math.atan(Math.exp(i/n))-Math.PI/4)/r;return[t,a]}function po(e,i,r){var n=(0,Ur.Ht)(i[1]-e[1]),t=(0,Ur.Ht)(i[0]-e[0]),a=(0,Ur.Ht)(e[1]),s=(0,Ur.Ht)(i[1]),l=Math.pow(Math.sin(n/2),2)+Math.pow(Math.sin(t/2),2)*Math.cos(a)*Math.cos(s);return(0,Ur.DL)(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),r="meters")}function us(e){var i=Math.PI/180,r=85.0511287798,n=6378137,t=Math.max(Math.min(r,e[1]),-r),a=Math.sin(t*i),s=n*e[0]*i,l=n*Math.log((1+a)/(1-a))/2;return[s,l]}function ko(e,i){var r=Math.abs(e[1][1]-e[0][1])*i,n=Math.abs(e[1][0]-e[0][0])*i;return[[e[0][0]-n,e[0][1]-r],[e[1][0]+n,e[1][1]+r]]}function Io(e,i){return e[0][0]<=i[0][0]&&e[0][1]<=i[0][1]&&e[1][0]>=i[1][0]&&e[1][1]>=i[1][1]}function El(e){return[[e[0],e[1]],[e[2],e[3]]]}function Ou(e){var i=nu(e,[0,0]);return[e[0]/i,e[1]/i]}function nu(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function rc(e,i){return e[0]*i[0]+e[1]*i[1]}function Du(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function gu(e,i){return Math.acos(rc(e,i)/(Du(e)*Du(i)))*180/Math.PI}function gc(e,i){return i[0]>0?i[1]>0?90-Math.atan(i[1]/i[0])*180/Math.PI:90+Math.atan(-i[1]/i[0])*180/Math.PI:i[1]<0?180+(90-Math.atan(i[1]/i[0])*180/Math.PI):270+Math.atan(i[1]/-i[0])*180/Math.PI}function Vl(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!e||e.length<2)){for(var r=[0,1],n=0,t=[],a=0;a<e.length-1;a++){var s=e[a],l=e[a+1],f=nu(s,l);n+=f;var d=[s[0]-l[0],s[1]-l[1]],S=gc(r,d);if(a>0){var O=t[a-1].rotation;O-S>360-O+S&&(S=S+360)}t.push({start:s,end:l,dis:f,rotation:S,duration:0})}return t.map(function(Z){Z.duration=i*(Z.dis/n)}),t}}function ml(e){if(Tn(e[0]))return e;if(Tn(e[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Tn(e[0][0][0])){var i=e,r=0,n=0,t=0;return i.forEach(function(a){a.forEach(function(s){r+=s[0],n+=s[1],t++})}),[r/t,n/t,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Mc(e){for(var i=e[0],r=e[1],n=e[0],t=e[1],a=0,s=0,l=0,f=0;f<e.length;f+=2){var d=e[f],S=e[f+1];d&&S&&(i=Math.max(d,i),r=Math.max(S,r),n=Math.min(d,n),t=Math.min(S,t),a+=d,s+=S,l++)}return{center:[a/l,s/l],radius:Math.sqrt(Math.pow(i-n,2)+Math.pow(r-t,2))/2}}function hl(e){return zr((0,Ur.uf)([(0,Ur.Tu)(e)]))}function yc(e){var i=131,r=137,n=0;e+="x";for(var t=Math.floor(9007199254740991/r),a=0;a<e.length;a++)n>t&&(n=Math.floor(n/r)),n=n*i+e.charCodeAt(a);return n}function lp(e){e=e.toString();for(var i=5381,r=e.length;r;)i=i*33^e.charCodeAt(--r);return i>>>0}function Dh(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var i=Math.random()*16|0,r=e==="x"?i:i&3|8;return r.toString(16)})}var jf;(function(e){e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.DEFAULT="DEFAUlTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL"})(jf||(jf={}));function bh(e,i,r,n,t){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,s=arguments.length>6?arguments[6]:void 0,l=r;return s&&(l=Math.round(r*(a-1))/(a-1)),n?Pc(e,i,l,n,t):Pc(e,i,l,.314,t)}function Qf(e,i){var r=1-i;return(e[0]*r+e[1]*i)*r+(e[1]*r+e[2]*i)*i}function sf(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function ch(e,i,r){var n=[i[0]-e[0],i[1]-e[1]],t=sf(n,[0,0]),a=Math.atan2(n[1],n[0]),s=t/2/Math.cos(r),l=a+r,f=[s*Math.cos(l)+e[0],s*Math.sin(l)+e[1]];return f}function Pc(e,i,r,n,t){if(t===jf["GAODE2.x"]){var a=Uo(e[0],e[1]),s=Uo(i[0],i[1]),l=ch(a,s,n),f=[a[0],l[0],s[0]],d=[a[1],l[1],s[1]];return[].concat((0,oe.Z)(Do(Qf(f,r),Qf(d,r))),[0])}else{var S=ch(e,i,n),O=[e[0],S[0],i[0]],Z=[e[1],S[1],i[1]];return[Qf(O,r),Qf(Z,r),0]}}function Hl(e,i,r,n,t){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,s=arguments.length>6?arguments[6]:void 0,l=r;return s&&(l=Math.round(r*29)/29),iu(e,i,l,t)}function zc(e,i){var r=[i[0]-e[0],i[1]-e[1]],n=nu(r,[0,0]),t=Math.atan2(r[1],r[0]),a=.314,s=n/2/Math.cos(a),l=t+a,f=[s*Math.cos(l)+e[0],s*Math.sin(l)+e[1]];return f}function fh(e,i){var r=1-i;return(e[0]*r+e[1]*i)*r+(e[1]*r+e[2]*i)*i}function Eh(e,i){var r=[e[0]-i[0],e[1]-i[1]],n=[Math.sin(r[0]/2),Math.sin(r[1]/2)],t=n[1]*n[1]+Math.cos(e[1])*Math.cos(i[1])*n[0]*n[0];return 2*Math.atan2(Math.sqrt(t),Math.sqrt(1-t))}function iu(e,i,r,n){var t=[(0,Ur.Ht)(e[0]),(0,Ur.Ht)(e[1])],a=[(0,Ur.Ht)(i[0]),(0,Ur.Ht)(i[1])];if(n==="GAODE2.x"){var s=zc(t,a),l=[t[0],s[0],a[0]],f=[t[1],s[1],a[1]];return[fh(l,r),fh(f,r),0]}else{var d=Eh(t,a);if(Math.abs(d-Math.PI)<.001)return[(1-r)*t[0]+r*a[0],(1-r)*t[1]+r*a[1]];var S=Math.sin((1-r)*d)/Math.sin(d),O=Math.sin(r*d)/Math.sin(d),Z=[Math.sin(t[0]),Math.sin(t[1])],U=[Math.cos(t[0]),Math.cos(t[1])],se=[Math.sin(a[0]),Math.sin(a[1])],le=[Math.cos(a[0]),Math.cos(a[1])],ye=S*U[1]*U[0]+O*le[1]*le[0],Be=S*U[1]*Z[0]+O*le[1]*se[0],rt=S*Z[1]+O*se[1];return[(0,Ur.vi)(Math.atan2(Be,ye)),(0,Ur.vi)(Math.atan2(rt,Math.sqrt(ye*ye+Be*Be)))]}}function Xs(e,i){for(var r=0,n=[],t=0;t<e.length-1;t++){var a=e[t],s=e[t+1],l=hh(a,s),f=r;r+=l,n.push({p1:a,p2:s,totalDistance:r,distance:l,lastTotalDistance:f})}for(var d=r*i,S,O,Z=0,U=n;Z<U.length;Z++){var se=U[Z],le=se.totalDistance;if(le>d){var ye=se.p1,Be=se.p2,rt=(d-se.lastTotalDistance)/se.distance,Je=Yc(Be,ye,rt);S=Je[0],O=Je[1];break}}return{lng:S,lat:O,height:0}}function Yc(e,i,r){return[e[0]*r+i[0]*(1-r),e[1]*r+i[1]*(1-r)]}function hh(e,i){return Math.sqrt(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2))}function Jf(e,i){var r=i.featureId,n=e.data.dataArray;return typeof r=="number"&&(n=n.filter(function(t){var a=t.id;return a===r})),n.map(function(t){var a=Xh(t,i);return(0,ue.Z)((0,ue.Z)({},t),a)})}function Fh(e,i){return new Promise(function(r){e.inited?r(Jf(e,i)):e.once("update",function(){r(Jf(e,i))})})}function Xh(e,i){var r=i.offset,n=i.shape,t=i.thetaOffset,a=i.mapVersion,s=i.segmentNumber,l=s===void 0?30:s,f=i.autoFit,d=f===void 0?!0:f,S=e.coordinates;if(n==="line")return Xs(S,r);var O=S[0],Z=S[1],U=typeof t=="string"?e[t]||0:t,se;switch(n){case"arc":se=bh;break;case"greatcircle":se=Hl;break;default:se=bh}var le=se(O,Z,r,U,a,l,d),ye=(0,Ja.Z)(le,3),Be=ye[0],rt=ye[1],Je=ye[2];return{lng:Be,lat:rt,height:Je}}var Of=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,r=arguments.length>1?arguments[1]:void 0;(0,re.Z)(this,e),this.limit=i,this.destroy=r||this.defaultDestroy,this.order=[],this.clear()}return(0,he.Z)(e,[{key:"clear",value:function(){var r=this;this.order.forEach(function(n){r.delete(n)}),this.cache={},this.order=[]}},{key:"get",value:function(r){var n=this.cache[r];return n&&(this.deleteOrder(r),this.appendOrder(r)),n}},{key:"set",value:function(r,n){this.cache[r]?(this.delete(r),this.cache[r]=n,this.appendOrder(r)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[r]=n,this.appendOrder(r))}},{key:"delete",value:function(r){var n=this.cache[r];n&&(this.deleteCache(r),this.deleteOrder(r),this.destroy(n,r))}},{key:"deleteCache",value:function(r){delete this.cache[r]}},{key:"deleteOrder",value:function(r){var n=this.order.findIndex(function(t){return t===r});n>=0&&this.order.splice(n,1)}},{key:"appendOrder",value:function(r){this.order.push(r)}},{key:"defaultDestroy",value:function(r,n){return null}}]),e}();function eh(e){if(e.length===0)throw new Error("max requires at least one data point");for(var i=e[0],r=1;r<e.length;r++)e[r]>i&&(i=e[r]);return i*1}function If(e){if(e.length===0)throw new Error("min requires at least one data point");for(var i=e[0],r=1;r<e.length;r++)e[r]<i&&(i=e[r]);return i*1}function Vf(e){if(e.length===0)return 0;for(var i=e[0]*1,r=1;r<e.length;r++)i+=e[r]*1;return i}function Yh(e){if(e.length===0)throw new Error("mean requires at least one data point");return Vf(e)/e.length}function yf(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var i=e[0],r=NaN,n=0,t=1,a=1;a<e.length+1;a++)e[a]!==i?(t>n&&(n=t,r=i),t=1,i=e[a]):t++;return r*1}var Gl={min:If,max:eh,mean:Yh,sum:Vf,mode:yf};function Bh(e,i){return e.map(function(r){return r[i]})}function Kh(e,i){return Gl[e](i)}function yu(e,i){return{enable:e,mask:255,func:{cmp:514,ref:i?1:0,mask:255}}}function $p(e,i){i===void 0&&(i={});var r=Number(e[0]),n=Number(e[1]),t=Number(e[2]),a=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[r,n],l=[r,a],f=[t,a],d=[t,n];return(0,Ur.yu)([[s,d,f,l,s]],i.properties,{bbox:e,id:i.id})}var Kc=I(26729),Mp=I.n(Kc),Hf;(function(e){e.Realtime="realtime",e.Overlap="overlap",e.Replace="replace"})(Hf||(Hf={}));var $l;(function(e){e.Loading="Loading",e.Loaded="Loaded",e.Failure="Failure",e.Cancelled="Cancelled"})($l||($l={}));var cd=0,Wp=1,Es=2;function Xp(e){e.forEach(function(i){i.isCurrent&&(i.isVisible=i.isLoaded)})}function Nd(e){e.forEach(function(i){i.properties.state=cd}),e.forEach(function(i){i.isCurrent&&!cp(i)&&Pp(i)}),e.forEach(function(i){i.isVisible=Boolean(i.properties.state&Es)})}function fd(e){e.forEach(function(r){r.properties.state=cd}),e.forEach(function(r){r.isCurrent&&cp(r)});var i=e.slice().sort(function(r,n){return r.z-n.z});i.forEach(function(r){r.isVisible=Boolean(r.properties.state&Es),r.children.length&&(r.isVisible||r.properties.state&Wp)?r.children.forEach(function(n){n.properties.state=Wp}):r.isCurrent&&Pp(r)})}function cp(e){for(;e;){if(e.isLoaded)return e.properties.state|=Es,!0;e=e.parent}return!1}function Pp(e){e.children.forEach(function(i){i.isLoaded?i.properties.state|=Es:Pp(i)})}var hd,wh=256,pd=[-1/0,-1/0,1/0,1/0],ll=.2,zd=5,yp=(hd={},(0,V.Z)(hd,Hf.Realtime,Xp),(0,V.Z)(hd,Hf.Overlap,Nd),(0,V.Z)(hd,Hf.Replace,fd),hd),Sd=function(){};function hu(e,i,r){var n=Math.floor((e+180)/360*Math.pow(2,r)),t=Math.floor((1-Math.log(Math.tan(i*Math.PI/180)+1/Math.cos(i*Math.PI/180))/Math.PI)/2*Math.pow(2,r));return[n,t]}function Lf(e,i,r){var n=e/Math.pow(2,r)*360-180,t=Math.PI-2*Math.PI*i/Math.pow(2,r),a=180/Math.PI*Math.atan(.5*(Math.exp(t)-Math.exp(-t)));return[n,a]}var Sh=function(i,r,n){var t=Lf(i,r,n),a=(0,Ja.Z)(t,2),s=a[0],l=a[1],f=Lf(i+1,r+1,n),d=(0,Ja.Z)(f,2),S=d[0],O=d[1];return[s,O,S,l]};function _p(e){var i=e.zoom,r=e.latLonBounds,n=e.maxZoom,t=n===void 0?1/0:n,a=e.minZoom,s=a===void 0?0:a,l=e.zoomOffset,f=l===void 0?0:l,d=e.extent,S=d===void 0?pd:d,O=Math.ceil(i)+f;if(Number.isFinite(s)&&O<s)return[];Number.isFinite(t)&&O>t&&(O=t);for(var Z=(0,Ja.Z)(r,4),U=Z[0],se=Z[1],le=Z[2],ye=Z[3],Be=[Math.max(U,S[0]),Math.max(se,S[1]),Math.min(le,S[2]),Math.min(ye,S[3])],rt=[],Je=hu(Be[0],Be[1],O),Ot=(0,Ja.Z)(Je,2),jt=Ot[0],dr=Ot[1],Lr=hu(Be[2],Be[3],O),jr=(0,Ja.Z)(Lr,2),Jr=jr[0],Pn=jr[1],In=jt;In<=Jr;In++)for(var Si=Pn;Si<=dr;Si++)rt.push({x:In,y:Si,z:O});var ra=(Jr+jt)/2,Va=(dr+Pn)/2,Ms=function(Bu,zl){return Math.abs(Bu-ra)+Math.abs(zl-Va)};return rt.sort(function(vu,Bu){return Ms(vu.x,vu.y)-Ms(Bu.x,Bu.y)}),rt}var Ch=function(i,r,n){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Math.pow(2,n),s=a-1,l=a,f=i,d=r;return t&&(f<0?f=f+l:f>s&&(f=f%l)),{warpX:f,warpY:d}};function Op(e){var i=Ah();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Ah(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fp=function(e){(0,Ft.Z)(r,e);var i=Op(r);function r(n){var t;(0,re.Z)(this,r),t=i.call(this),(0,V.Z)((0,ct.Z)(t),"tileSize",256),(0,V.Z)((0,ct.Z)(t),"isVisible",!1),(0,V.Z)((0,ct.Z)(t),"isCurrent",!1),(0,V.Z)((0,ct.Z)(t),"isVisibleChange",!1),(0,V.Z)((0,ct.Z)(t),"loadedLayers",0),(0,V.Z)((0,ct.Z)(t),"isLayerLoaded",!1),(0,V.Z)((0,ct.Z)(t),"isLoad",!1),(0,V.Z)((0,ct.Z)(t),"isChildLoad",!1),(0,V.Z)((0,ct.Z)(t),"parent",null),(0,V.Z)((0,ct.Z)(t),"children",[]),(0,V.Z)((0,ct.Z)(t),"data",null),(0,V.Z)((0,ct.Z)(t),"properties",{}),(0,V.Z)((0,ct.Z)(t),"loadDataId",0);var a=n.x,s=n.y,l=n.z,f=n.tileSize,d=n.warp,S=d===void 0?!0:d;return t.x=a,t.y=s,t.z=l,t.warp=S||!0,t.tileSize=f,t}return(0,he.Z)(r,[{key:"isLoading",get:function(){return this.loadStatus===$l.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===$l.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===$l.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===$l.Cancelled}},{key:"isDone",get:function(){return[$l.Loaded,$l.Cancelled,$l.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return Sh(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var t=(0,Ja.Z)(this.bounds,4),a=t[0],s=t[1],l=t[2],f=t[3],d=[(l-a)/2,(f-s)/2],S=$p(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:d,meta:`
      `.concat(this.key,`
      `)}});return S}},{key:"key",get:function(){var t="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return t}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s){var l,f,d,S,O,Z,U,se,le,ye,Be,rt,Je,Ot,jt,dr,Lr;return Ze().wrap(function(Jr){for(;;)switch(Jr.prev=Jr.next){case 0:return l=s.getData,f=s.onLoad,d=s.onError,this.loadDataId++,S=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=$l.Loading,O=null,Jr.prev=7,U=this.x,se=this.y,le=this.z,ye=this.bounds,Be=this.tileSize,rt=this.warp,Je=Ch(U,se,le,rt),Ot=Je.warpX,jt=Je.warpY,dr=this.abortController.signal,Lr={x:Ot,y:jt,z:le,bounds:ye,tileSize:Be,signal:dr,warp:rt},Jr.next=14,l(Lr,this);case 14:O=Jr.sent,Jr.next=20;break;case 17:Jr.prev=17,Jr.t0=Jr.catch(7),Z=Jr.t0;case 20:if(S===this.loadDataId){Jr.next=22;break}return Jr.abrupt("return");case 22:if(!(this.isCancelled&&!O)){Jr.next=24;break}return Jr.abrupt("return");case 24:if(!(Z||!O)){Jr.next=28;break}return this.loadStatus=$l.Failure,d(Z,this),Jr.abrupt("return");case 28:this.loadStatus=$l.Loaded,this.data=O,f(this);case 31:case"end":return Jr.stop()}},a,this,[[7,17]])}));function t(a){return n.apply(this,arguments)}return t}()},{key:"reloadData",value:function(t){this.isLoading&&this.abortLoad(),this.loadData(t)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=$l.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),r}(Kc.EventEmitter),Nh=function(i,r){var n=El(i),t=ko(n,r),a=360*3-180,s=85.0511287798065,l=[Math.max(t[0][0],-a),Math.max(t[0][1],-s),Math.min(t[1][0],a),Math.min(t[1][1],s)];return l},zh=function(i,r){var n=El(i),t=El(r),a=Io(n,t);return a};function qc(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Cd(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Cd(e,i){if(e){if(typeof e=="string")return Rf(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rf(e,i)}}function Rf(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}function Yp(e){var i=Kp();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Kp(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ph=function(e){(0,Ft.Z)(r,e);var i=Yp(r);function r(n){var t;return(0,re.Z)(this,r),t=i.call(this),(0,V.Z)((0,ct.Z)(t),"currentTiles",[]),(0,V.Z)((0,ct.Z)(t),"cacheTiles",new Map),(0,V.Z)((0,ct.Z)(t),"throttleUpdate",(0,Kn.throttle)(function(a,s){t.update(a,s)},16)),(0,V.Z)((0,ct.Z)(t),"onTileLoad",function(a){t.emit("tile-loaded",a),t.updateTileVisible()}),(0,V.Z)((0,ct.Z)(t),"onTileError",function(a,s){t.emit("tile-error",{error:a,tile:s}),t.updateTileVisible()}),(0,V.Z)((0,ct.Z)(t),"onTileUnload",function(a){t.emit("tile-unload",a)}),t.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:pd,getTileData:Sd,warp:!0,updateStrategy:Hf.Overlap},t.updateOptions(n),t}return(0,he.Z)(r,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(t){return t.isDone})}},{key:"tiles",get:function(){var t=Array.from(this.cacheTiles.values()).sort(function(a,s){return a.z-s.z});return t}},{key:"updateOptions",value:function(t){var a=t.minZoom===void 0?this.options.minZoom:Math.ceil(t.minZoom),s=t.maxZoom===void 0?this.options.maxZoom:Math.floor(t.maxZoom);this.options=(0,ue.Z)((0,ue.Z)((0,ue.Z)({},this.options),t),{},{minZoom:a,maxZoom:s})}},{key:"update",value:function(t,a){var s=this,l=Math.max(0,Math.ceil(t));if(!(this.lastViewStates&&this.lastViewStates.zoom===l&&zh(this.lastViewStates.latLonBoundsBuffer,a))){var f=Nh(a,ll);this.lastViewStates={zoom:l,latLonBounds:a,latLonBoundsBuffer:f};var d=!1,S=this.getTileIndices(l,f).filter(function(O){return s.options.warp||O.x>=0&&O.x<Math.pow(2,l)});this.currentTiles=S.map(function(O){var Z=O.x,U=O.y,se=O.z,le=s.getTile(Z,U,se);if(le){var ye,Be,rt=((ye=le)===null||ye===void 0?void 0:ye.isFailure)||((Be=le)===null||Be===void 0?void 0:Be.isCancelled);return rt&&le.loadData({getData:s.options.getTileData,onLoad:s.onTileLoad,onError:s.onTileError}),le}return le=s.createTile(Z,U,se),d=!0,le}),d&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var t=qc(this.cacheTiles),a;try{for(t.s();!(a=t.n()).done;){var s=(0,Ja.Z)(a.value,2),l=s[0],f=s[1];this.currentTiles.includes(f)||(this.cacheTiles.delete(l),this.onTileUnload(f)),this.onTileUnload(f),f.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(d){t.e(d)}finally{t.f()}}},{key:"pruneRequests",value:function(){var t=[],a=qc(this.cacheTiles.values()),s;try{for(a.s();!(s=a.n()).done;){var l=s.value;l.isLoading&&!l.isCurrent&&!l.isVisible&&t.push(l)}}catch(d){a.e(d)}finally{a.f()}for(;t.length>0;){var f=t.shift();f.abortLoad()}}},{key:"getTileByLngLat",value:function(t,a,s){var l=this.options.zoomOffset,f=Math.ceil(s)+l,d=hu(t,a,f),S=this.tiles.filter(function(O){return O.key==="".concat(d[0],"_").concat(d[1],"_").concat(f)});return S[0]}},{key:"destroy",value:function(){var t=qc(this.cacheTiles.values()),a;try{for(t.s();!(a=t.n()).done;){var s=a.value;s.isLoading&&s.abortLoad()}}catch(l){t.e(l)}finally{t.f()}this.cacheTiles.clear(),this.currentTiles=[],this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var t=this.options.updateStrategy,a=new Map,s=qc(this.cacheTiles.values()),l;try{for(s.s();!(l=s.n()).done;){var f=l.value;a.set(f.key,f.isVisible),f.isCurrent=!1,f.isVisible=!1}}catch(se){s.e(se)}finally{s.f()}var d=qc(this.currentTiles),S;try{for(d.s();!(S=d.n()).done;){var O=S.value;O.isCurrent=!0,O.isVisible=!0}}catch(se){d.e(se)}finally{d.f()}var Z=Array.from(this.cacheTiles.values());typeof t=="function"?t(Z):yp[t](Z);var U=!1;Array.from(this.cacheTiles.values()).forEach(function(se){se.isVisible!==a.get(se.key)?(se.isVisibleChange=!0,U=!0):se.isVisibleChange=!1}),U&&this.emit("tile-update")}},{key:"getTileIndices",value:function(t,a){var s=this.options,l=s.tileSize,f=s.extent,d=s.zoomOffset,S=Math.floor(this.options.maxZoom),O=Math.ceil(this.options.minZoom),Z=_p({maxZoom:S,minZoom:O,zoomOffset:d,tileSize:l,zoom:t,latLonBounds:a,extent:f});return Z}},{key:"getTileId",value:function(t,a,s){var l="".concat(t,",").concat(a,",").concat(s);return l}},{key:"getTile",value:function(t,a,s){var l=this.getTileId(t,a,s),f=this.cacheTiles.get(l);return f}},{key:"createTile",value:function(t,a,s){var l=this.getTileId(t,a,s),f=new fp({x:t,y:a,z:s,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(l,f),f.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),f}},{key:"resizeCacheTiles",value:function(){var t=zd*this.currentTiles.length,a=this.cacheTiles.size>t;if(a){var s=qc(this.cacheTiles),l;try{for(s.s();!(l=s.n()).done;){var f=(0,Ja.Z)(l.value,2),d=f[0],S=f[1];if(!S.isVisible&&!this.currentTiles.includes(S)&&(this.cacheTiles.delete(d),this.onTileUnload(S)),this.cacheTiles.size<=t)break}}catch(O){s.e(O)}finally{s.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var t=qc(this.cacheTiles.values()),a;try{for(t.s();!(a=t.n()).done;){var s=a.value;s.parent=null,s.children.length=0}}catch(O){t.e(O)}finally{t.f()}var l=qc(this.cacheTiles.values()),f;try{for(l.s();!(f=l.n()).done;){var d=f.value,S=this.getNearestAncestor(d.x,d.y,d.z);d.parent=S,S!=null&&S.children&&S.children.push(d)}}catch(O){l.e(O)}finally{l.f()}}},{key:"getNearestAncestor",value:function(t,a,s){for(;s>this.options.minZoom;){t=Math.floor(t/2),a=Math.floor(a/2),s=s-1;var l=this.getTile(t,a,s);if(l)return l}return null}}]),r}(Mp());function th(e){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(e)}function Ip(e){var i=[],r=/\{([a-z])-([a-z])\}/.exec(e);if(r){var n=r[1].charCodeAt(0),t=r[2].charCodeAt(0),a;for(a=n;a<=t;++a)i.push(e.replace(r[0],String.fromCharCode(a)));return i}if(r=/\{(\d+)-(\d+)\}/.exec(e),r){for(var s=parseInt(r[2],10),l=parseInt(r[1],10);l<=s;l++)i.push(e.replace(r[0],l.toString()));return i}return i.push(e),i}function Oc(e,i){if(!e||!e.length)throw new Error("url is not allowed to be empty");var r=i.x,n=i.y,t=i.z,a=Ip(e),s=Math.abs(r+n)%a.length,l=a[s];return l.replace(/\{x\}/g,r.toString()).replace(/\{y\}/g,n.toString()).replace(/\{z\}/g,t.toString()).replace(/\{bbox\}/g,Sh(r,n,t).join(",")).replace(/\{-y\}/g,(Math.pow(2,t)-n-1).toString())}function qh(e,i){var r=i.x,n=i.y,t=i.z,a=i.layer,s=i.version,l=s===void 0?"1.0.0":s,f=i.style,d=f===void 0?"default":f,S=i.format,O=i.service,Z=O===void 0?"WMTS":O,U=i.tileMatrixset,se="".concat(e,"&SERVICE=").concat(Z,"&REQUEST=GetTile&VERSION=").concat(l,"&LAYER=").concat(a,"&STYLE=").concat(d,"&TILEMATRIXSET=").concat(U,"&FORMAT=").concat(S,"&TILECOL=").concat(r,"&TILEROW=").concat(n,"&TILEMATRIX=").concat(t);return se}function Th(e,i){if(!e)throw new Error(i||"web worker helper assertion failed.")}var Zh={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},dd=Zh.self||Zh.window||{},Ad=Zh.window||Zh.self||{},nc=Zh.self||Zh.window||{},kf=Zh.document||{},Td=typeof importScripts=="function",vd=typeof window!="undefined"&&typeof window.orientation!="undefined",hp=function(){function e(i,r){var n=this;this.name=i,this.workerThread=r,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(t,a){n.resolve=t,n.reject=a})}return e.prototype.postMessage=function(i,r){this.workerThread.postMessage({source:"Main thread",type:i,payload:r})},e.prototype.done=function(i){Th(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(i)},e.prototype.error=function(i){Th(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(i)},e}(),Lp=hp,qp=new Map;function Gf(e){Th(e.source&&!e.url||!e.source&&e.url);var i=qp.get(e.source||e.url);return i||(e.url&&(i=qd(e.url),qp.set(e.url,i)),e.source&&(i=Rp(e.source),qp.set(e.source,i))),Th(i),i}function qd(e){if(!e.startsWith("http"))return e;var i=Uh(e);return Rp(i)}function Rp(e){var i=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(i)}function Uh(e){return`try {
  importScripts('`+e+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function _f(e,i,r){i===void 0&&(i=!0);var n=r||new Set;if(e){if(Md(e))n.add(e);else if(Md(e.buffer))n.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(i&&typeof e=="object")for(var t in e)_f(e[t],i,n)}}return r===void 0?Array.from(n):[]}function Md(e){return e?e instanceof ArrayBuffer||typeof MessagePort!="undefined"&&e instanceof MessagePort||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&e instanceof OffscreenCanvas:!1}var Qp=function(){},Mh=function(){function e(i){this.terminated=!1,this.loadableURL="";var r=i.name,n=i.source,t=i.url;Th(n||t),this.name=r,this.source=n,this.url=t,this.onMessage=Qp,this.onError=function(a){return console.log(a)},this.worker=this.createBrowserWorker()}return e.isSupported=function(){return typeof Worker!="undefined"},e.prototype.destroy=function(){this.onMessage=Qp,this.onError=Qp,this.worker.terminate(),this.terminated=!0},Object.defineProperty(e.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(i,r){r=r||_f(i),this.worker.postMessage(i,r)},e.prototype.getErrorFromErrorEvent=function(i){var r="Failed to load ";return r+="worker "+this.name+" from "+this.url+". ",i.message&&(r+=i.message+" in "),i.lineno&&(r+=":"+i.lineno+":"+i.colno),new Error(r)},e.prototype.createBrowserWorker=function(){var i=this;this.loadableURL=Gf({source:this.source,url:this.url});var r=new Worker(this.loadableURL,{name:this.name});return r.onmessage=function(n){n.data?i.onMessage(n.data):i.onError(new Error("No data received"))},r.onerror=function(n){i.onError(i.getErrorFromErrorEvent(n)),i.terminated=!0},r.onmessageerror=function(n){return console.error("worker "+i.name+", message error: "+n)},r},e}(),dh=Mh,Ph=function(){return Ph=Object.assign||function(e){for(var i,r=1,n=arguments.length;r<n;r++){i=arguments[r];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])}return e},Ph.apply(this,arguments)},_u=function(e,i,r,n){function t(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(S){try{d(n.next(S))}catch(O){s(O)}}function f(S){try{d(n.throw(S))}catch(O){s(O)}}function d(S){S.done?a(S.value):t(S.value).then(l,f)}d((n=n.apply(e,i||[])).next())})},md=function(e,i){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,t,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(d){return function(S){return f([d,S])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,t&&(a=d[0]&2?t.return:d[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,d[1])).done)return a;switch(t=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,t=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=i.call(e,r)}catch(S){d=[6,S],t=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},_c=function(){function e(i){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=i.source,this.url=i.url,this.setProps(i)}return e.prototype.destroy=function(){this.idleQueue.forEach(function(i){return i.destroy()}),this.isDestroyed=!0},e.prototype.setProps=function(i){this.props=Ph(Ph({},this.props),i),i.name!==void 0&&(this.name=i.name),i.maxConcurrency!==void 0&&(this.maxConcurrency=i.maxConcurrency),i.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=i.maxMobileConcurrency),i.reuseWorkers!==void 0&&(this.reuseWorkers=i.reuseWorkers),i.onDebug!==void 0&&(this.onDebug=i.onDebug)},e.prototype.startJob=function(i,r,n){return r===void 0&&(r=function(t,a,s){return t.done(s)}),n===void 0&&(n=function(t,a){return t.error(a)}),_u(this,void 0,void 0,function(){var t,a=this;return md(this,function(s){switch(s.label){case 0:return t=new Promise(function(l){return a.jobQueue.push({name:i,onMessage:r,onError:n,onStart:l}),a}),this.startQueuedJob(),[4,t];case 1:return[2,s.sent()]}})})},e.prototype.startQueuedJob=function(){return _u(this,void 0,void 0,function(){var i,r,n;return md(this,function(t){switch(t.label){case 0:if(!this.jobQueue.length)return[2];if(i=this.getAvailableWorker(),!i)return[2];if(r=this.jobQueue.shift(),!r)return[3,4];this.onDebug({message:"Starting job",name:r.name,backlog:this.jobQueue.length,workerThread:i}),n=new Lp(r.name,i),i.onMessage=function(a){return r.onMessage(n,a.type,a.payload)},i.onError=function(a){return r.onError(n,a)},r.onStart(n),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,n.result];case 2:return t.sent(),[3,4];case 3:return this.returnWorkerToQueue(i),[7];case 4:return[2]}})})},e.prototype.returnWorkerToQueue=function(i){var r=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();r?(i.destroy(),this.count--):this.idleQueue.push(i),this.isDestroyed||this.startQueuedJob()},e.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var i=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new dh({name:i,source:this.source,url:this.url})}return null},e.prototype.getMaxConcurrency=function(){return vd?this.maxMobileConcurrency:this.maxConcurrency},e}(),kp=_c,xp=function(){return xp=Object.assign||function(e){for(var i,r=1,n=arguments.length;r<n;r++){i=arguments[r];for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])}return e},xp.apply(this,arguments)},Ks=function(e){var i=typeof Symbol=="function"&&Symbol.iterator,r=i&&e[i],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},Qh={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},Bl=function(){function e(i){this.workerPools=new Map,this.props=xp({},Qh),this.setProps(i),this.workerPools=new Map}return e.isSupported=function(){return dh.isSupported()},e.getWorkerFarm=function(i){return i===void 0&&(i={}),e.workerFarm=e.workerFarm||new e({}),e.workerFarm.setProps(i),e.workerFarm},e.prototype.destroy=function(){var i,r;try{for(var n=Ks(this.workerPools.values()),t=n.next();!t.done;t=n.next()){var a=t.value;a.destroy()}}catch(s){i={error:s}}finally{try{t&&!t.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}},e.prototype.setProps=function(i){var r,n;this.props=xp(xp({},this.props),i);try{for(var t=Ks(this.workerPools.values()),a=t.next();!a.done;a=t.next()){var s=a.value;s.setProps(this.getWorkerPoolProps())}}catch(l){r={error:l}}finally{try{a&&!a.done&&(n=t.return)&&n.call(t)}finally{if(r)throw r.error}}},e.prototype.getWorkerPool=function(i){var r=i.name,n=i.source,t=i.url,a=this.workerPools.get(r);return a||(a=new kp({name:r,source:n,url:t}),a.setProps(this.getWorkerPoolProps()),this.workerPools.set(r,a)),a},e.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},e}(),Df=Bl,Jp=new Map,jh=function(){function e(){}return Object.defineProperty(e,"onmessage",{set:function(i){self.onmessage=function(r){if(Pd(r)){var n=r.data,t=n.type,a=n.payload;i(t,a)}}},enumerable:!1,configurable:!0}),e.addEventListener=function(i){var r=Jp.get(i);r||(r=function(n){if(Pd(n)){var t=n.data,a=t.type,s=t.payload;i(a,s)}}),self.addEventListener("message",r)},e.removeEventListener=function(i){var r=Jp.get(i);Jp.delete(i),self.removeEventListener("message",r)},e.postMessage=function(i,r){if(self){var n={source:"Worker thread",type:i,payload:r},t=_f(r);self.postMessage(n,t)}},e}(),Jh=jh;function Pd(e){var i=e.type,r=e.data;return i==="message"&&r&&typeof r.source=="string"&&r.source==="Main thread"}function Qd(e){return JSON.parse(ep(e))}function ep(e){var i=new Set;return JSON.stringify(e,function(r,n){if(typeof n=="object"&&n!==null){if(i.has(n))try{return JSON.parse(JSON.stringify(n))}catch(t){return}i.add(n)}return n})}function gd(e){return""+e.name}function Ov(e,i){i===void 0&&(i={});var r=i[e.id]||{},n=e.name+".worker.js",t=r.workerUrl;return i._workerType==="test"&&(t=e.module+"/dist/"+n),t||(t="https://unpkg.com/"+e.module+"/dist/"+n),assert(t),t}var Ff=function(e,i,r,n){function t(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(S){try{d(n.next(S))}catch(O){s(O)}}function f(S){try{d(n.throw(S))}catch(O){s(O)}}function d(S){S.done?a(S.value):t(S.value).then(l,f)}d((n=n.apply(e,i||[])).next())})},Dp=function(e,i){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,t,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(d){return function(S){return f([d,S])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,t&&(a=d[0]&2?t.return:d[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,d[1])).done)return a;switch(t=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,t=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=i.call(e,r)}catch(S){d=[6,S],t=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};function pp(e,i){return WorkerFarm.isSupported()?e.worker&&(i==null?void 0:i.worker):!1}function Fp(e,i,r,n){return r===void 0&&(r={}),n===void 0&&(n={}),Ff(this,void 0,void 0,function(){var t,a,s,l,f,d,S,O;return Dp(this,function(Z){switch(Z.label){case 0:return t=getWorkerName(e),a=getWorkerURL(e,r),s=WorkerFarm.getWorkerFarm(r),l=s.getWorkerPool({name:t,url:a}),f=r.jobName||e.name,[4,l.startJob(f,Fu.bind(null,n))];case 1:return d=Z.sent(),S=removeNontransferableOptions(r),d.postMessage("process",{input:i,options:S}),[4,d.result];case 2:return O=Z.sent(),[2,O.result]}})})}function Fu(e,i,r,n){return Ff(this,void 0,void 0,function(){var t,a,s,l,f,d,S;return Dp(this,function(O){switch(O.label){case 0:switch(t=r,t){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return i.done(n),[3,9];case 2:return i.error(new Error(n.error)),[3,9];case 3:a=n.id,s=n.input,l=n.options,O.label=4;case 4:return O.trys.push([4,6,,7]),e.process?[4,e.process(s,l)]:(i.postMessage("error",{id:a,error:"Worker not set up to process on main thread"}),[2]);case 5:return f=O.sent(),i.postMessage("done",{id:a,result:f}),[3,7];case 6:return d=O.sent(),S=d instanceof Error?d.message:"unknown error",i.postMessage("error",{id:a,error:S}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+r),O.label=9;case 9:return[2]}})})}var bp=function(){function e(){this._values=[],this._settlers=[],this._closed=!1}return e.prototype[Symbol.asyncIterator]=function(){return this},e.prototype.push=function(i){return this.enqueue(i)},e.prototype.enqueue=function(i){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var r=this._settlers.shift();i instanceof Error?r.reject(i):r.resolve({value:i})}else this._values.push(i)},e.prototype.close=function(){for(;this._settlers.length>0;){var i=this._settlers.shift();i.resolve({done:!0})}this._closed=!0},e.prototype.next=function(){var i=this;if(this._values.length>0){var r=this._values.shift();return r instanceof Error?Promise.reject(r):Promise.resolve({done:!1,value:r})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(n,t){i._settlers.push({resolve:n,reject:t})})},e}(),jo=bp,Oh=function(e,i,r,n){function t(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(S){try{d(n.next(S))}catch(O){s(O)}}function f(S){try{d(n.throw(S))}catch(O){s(O)}}function d(S){S.done?a(S.value):t(S.value).then(l,f)}d((n=n.apply(e,i||[])).next())})},Bp=function(e,i){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,t,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(d){return function(S){return f([d,S])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,t&&(a=d[0]&2?t.return:d[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,d[1])).done)return a;switch(t=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,t=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=i.call(e,r)}catch(S){d=[6,S],t=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},Np=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e[Symbol.asyncIterator],r;return i?i.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=e[a]&&function(s){return new Promise(function(l,f){s=e[a](s),t(l,f,s.done,s.value)})}}function t(a,s,l,f){Promise.resolve(f).then(function(d){a({value:d,done:l})},s)}},ke=0,Ut,Ar;function On(e,i){var r=this;if(typeof self!="undefined"){var n={process:bi};Jh.onmessage=function(t,a){return Oh(r,void 0,void 0,function(){var s,l,f,d,S,O,Z,U,se,le,ye;return Bp(this,function(Be){switch(Be.label){case 0:switch(Be.trys.push([0,19,,20]),s=t,s){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!e)throw new Error("Worker does not support atomic processing");return[4,e(a.input,a.options||{},n)];case 2:return l=Be.sent(),Jh.postMessage("done",{result:l}),[3,18];case 3:if(!i)throw new Error("Worker does not support batched processing");Ut=new jo,Ar=a.options||{},f=i(Ut,Ar,n),Be.label=4;case 4:Be.trys.push([4,9,10,15]),d=Np(f),Be.label=5;case 5:return[4,d.next()];case 6:if(S=Be.sent(),!!S.done)return[3,8];O=S.value,Jh.postMessage("output-batch",{result:O}),Be.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return Z=Be.sent(),le={error:Z},[3,15];case 10:return Be.trys.push([10,,13,14]),S&&!S.done&&(ye=d.return)?[4,ye.call(d)]:[3,12];case 11:Be.sent(),Be.label=12;case 12:return[3,14];case 13:if(le)throw le.error;return[7];case 14:return[7];case 15:return Jh.postMessage("done",{}),[3,18];case 16:return Ut.push(a.input),[3,18];case 17:return Ut.close(),[3,18];case 18:return[3,20];case 19:return U=Be.sent(),se=U instanceof Error?U.message:"",Jh.postMessage("error",{error:se}),[3,20];case 20:return[2]}})})}}}function bi(e,i){return i===void 0&&(i={}),new Promise(function(r,n){var t=ke++,a=function(l,f){if(f.id===t)switch(l){case"done":Jh.removeEventListener(a),r(f.result);break;case"error":Jh.removeEventListener(a),n(f.error);break;default:}};Jh.addEventListener(a);var s={id:t,input:e,options:i};Jh.postMessage("process",s)})}var zn=function(e,i,r,n){function t(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(S){try{d(n.next(S))}catch(O){s(O)}}function f(S){try{d(n.throw(S))}catch(O){s(O)}}function d(S){S.done?a(S.value):t(S.value).then(l,f)}d((n=n.apply(e,i||[])).next())})},hi=function(e,i){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,t,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(d){return function(S){return f([d,S])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,t&&(a=d[0]&2?t.return:d[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,d[1])).done)return a;switch(t=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,t=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=i.call(e,r)}catch(S){d=[6,S],t=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},Fi={};function Gi(e,i,r){return i===void 0&&(i=null),r===void 0&&(r={}),zn(this,void 0,void 0,function(){return hi(this,function(n){switch(n.label){case 0:return i&&(e=Ki(e,i,r)),Fi[e]=Fi[e]||ia(e),[4,Fi[e]];case 1:return[2,n.sent()]}})})}function Ki(e,i,r){if(e.startsWith("http"))return e;var n=r.modules||{};return n[e]?n[e]:r.CDN?(assert(r.CDN.startsWith("http")),r.CDN+"/"+i+"/dist/libs/"+e):isWorker?"../src/libs/"+e:"modules/"+i+"/src/libs/"+e}function ia(e){return zn(this,void 0,void 0,function(){var i,r,n;return hi(this,function(t){switch(t.label){case 0:return e.endsWith("wasm")?[4,fetch(e)]:[3,3];case 1:return i=t.sent(),[4,i.arrayBuffer()];case 2:return[2,t.sent()];case 3:return isWorker?[2,importScripts(e)]:[4,fetch(e)];case 4:return r=t.sent(),[4,r.text()];case 5:return n=t.sent(),[2,oa(n,e)]}})})}function oa(e,i){if(isWorker)return eval.call(global,e),null;var r=document.createElement("script");r.id=i;try{r.appendChild(document.createTextNode(e))}catch(n){r.text=e}return document.body.appendChild(r),null}var sa="0.0.3",Bi={id:"null",name:"null",module:"web-worker-helper",options:{}};function Ji(e){var i=e.color;return!i||!i.length?[1,1,1,1]:i}function yn(e,i,r){return r.length===2?[r[0],r[1],0]:[r[0],r[1],r[2]]}function Qn(e){var i=e.filter;return i?[1]:[0]}function Yi(e,i){return[i]}var wa=I(9187),yi=I.n(wa),Ri=1e-6,ta=typeof Float32Array!="undefined"?Float32Array:Array,wo=Math.random;function mi(e){ta=e}var xi=Math.PI/180;function Qa(e){return e*xi}function Aa(e,i){return Math.abs(e-i)<=Ri*Math.max(1,Math.abs(e),Math.abs(i))}Math.hypot||(Math.hypot=function(){for(var e=0,i=arguments.length;i--;)e+=arguments[i]*arguments[i];return Math.sqrt(e)});function ri(){var e=new ta(2);return ta!=Float32Array&&(e[0]=0,e[1]=0),e}function _a(e){var i=new glMatrix.ARRAY_TYPE(2);return i[0]=e[0],i[1]=e[1],i}function Zi(e,i){var r=new ta(2);return r[0]=e,r[1]=i,r}function vo(e,i){return e[0]=i[0],e[1]=i[1],e}function Bo(e,i,r){return e[0]=i,e[1]=r,e}function Hi(e,i,r){return e[0]=i[0]+r[0],e[1]=i[1]+r[1],e}function ba(e,i,r){return e[0]=i[0]-r[0],e[1]=i[1]-r[1],e}function go(e,i,r){return e[0]=i[0]*r[0],e[1]=i[1]*r[1],e}function Wo(e,i,r){return e[0]=i[0]/r[0],e[1]=i[1]/r[1],e}function Ps(e,i){return e[0]=Math.ceil(i[0]),e[1]=Math.ceil(i[1]),e}function xu(e,i){return e[0]=Math.floor(i[0]),e[1]=Math.floor(i[1]),e}function el(e,i,r){return e[0]=Math.min(i[0],r[0]),e[1]=Math.min(i[1],r[1]),e}function Fs(e,i,r){return e[0]=Math.max(i[0],r[0]),e[1]=Math.max(i[1],r[1]),e}function pc(e,i){return e[0]=Math.round(i[0]),e[1]=Math.round(i[1]),e}function pl(e,i,r){return e[0]=i[0]*r,e[1]=i[1]*r,e}function Ol(e,i,r,n){return e[0]=i[0]+r[0]*n,e[1]=i[1]+r[1]*n,e}function Vu(e,i){var r=i[0]-e[0],n=i[1]-e[1];return Math.hypot(r,n)}function Wl(e,i){var r=i[0]-e[0],n=i[1]-e[1];return r*r+n*n}function dc(e){var i=e[0],r=e[1];return Math.hypot(i,r)}function Qc(e){var i=e[0],r=e[1];return i*i+r*r}function Il(e,i){return e[0]=-i[0],e[1]=-i[1],e}function ys(e,i){return e[0]=1/i[0],e[1]=1/i[1],e}function tl(e,i){var r=i[0],n=i[1],t=r*r+n*n;return t>0&&(t=1/Math.sqrt(t)),e[0]=i[0]*t,e[1]=i[1]*t,e}function Ts(e,i){return e[0]*i[0]+e[1]*i[1]}function Jc(e,i,r){var n=i[0]*r[1]-i[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function Vo(e,i,r,n){var t=i[0],a=i[1];return e[0]=t+n*(r[0]-t),e[1]=a+n*(r[1]-a),e}function js(e,i){i=i||1;var r=glMatrix.RANDOM()*2*Math.PI;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e}function Iu(e,i,r){var n=i[0],t=i[1];return e[0]=r[0]*n+r[2]*t,e[1]=r[1]*n+r[3]*t,e}function ic(e,i,r){var n=i[0],t=i[1];return e[0]=r[0]*n+r[2]*t+r[4],e[1]=r[1]*n+r[3]*t+r[5],e}function Vh(e,i,r){var n=i[0],t=i[1];return e[0]=r[0]*n+r[3]*t+r[6],e[1]=r[1]*n+r[4]*t+r[7],e}function lr(e,i,r){var n=i[0],t=i[1];return e[0]=r[0]*n+r[4]*t+r[12],e[1]=r[1]*n+r[5]*t+r[13],e}function Wn(e,i,r,n){var t=i[0]-r[0],a=i[1]-r[1],s=Math.sin(n),l=Math.cos(n);return e[0]=t*l-a*s+r[0],e[1]=t*s+a*l+r[1],e}function Rn(e,i){var r=e[0],n=e[1],t=i[0],a=i[1],s=Math.sqrt(r*r+n*n)*Math.sqrt(t*t+a*a),l=s&&(r*t+n*a)/s;return Math.acos(Math.min(Math.max(l,-1),1))}function ro(e){return e[0]=0,e[1]=0,e}function qs(e){return"vec2("+e[0]+", "+e[1]+")"}function ir(e,i){return e[0]===i[0]&&e[1]===i[1]}function Rt(e,i){var r=e[0],n=e[1],t=i[0],a=i[1];return Math.abs(r-t)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(t))&&Math.abs(n-a)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))}var Zr=null,cn=ba,jn=null,Wr=null,wr=null,nn=null,Wt=null,Or=function(){var e=ri();return function(i,r,n,t,a,s){var l,f;for(r||(r=2),n||(n=0),t?f=Math.min(t*r+n,i.length):f=i.length,l=n;l<f;l+=r)e[0]=i[l],e[1]=i[l+1],a(e,e,s),i[l]=e[0],i[l+1]=e[1];return i}}(),ar=ri(),xn=ri(),mn=ri(),wi=ri(),ya=ri();function xa(e,i,r,n,t){Hi(e,r,n),tl(e,e),i=Zi(-e[1],e[0]);var a=Zi(-r[1],r[0]);return[t/Ts(i,a),i]}function Sa(e,i){return Bo(e,-i[1],i[0])}function aa(e,i,r){return cn(e,i,r),tl(e,e),e}function no(e,i){return e[0]===i[0]&&e[1]===i[1]}function Ya(e){for(var i=new Map,r=0;r<e.length;r++){var n=e[0].toString()+"-"+e[1].toString();i.get(n)?(e.splice(r,1),r++):i.set(n,n)}return e}var io=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,re.Z)(this,e),(0,V.Z)(this,"lastFlip",-1),(0,V.Z)(this,"miter",Zi(0,0)),(0,V.Z)(this,"started",!1),(0,V.Z)(this,"dash",!1),(0,V.Z)(this,"totalDistance",0),(0,V.Z)(this,"currentIndex",0),this.join=i.join||"miter",this.cap=i.cap||"butt",this.miterLimit=i.miterLimit||10,this.thickness=i.thickness||1,this.dash=i.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,he.Z)(e,[{key:"extrude_gaode2",value:function(r,n){var t=this.complex;if(r.length<=1)return t;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,s=t.startIndex,l=1;l<a;l++){var f,d,S,O=r[l-1];O.push((f=n[l-1][2])!==null&&f!==void 0?f:0);var Z=n[l-1],U=r[l];U.push((d=n[l][2])!==null&&d!==void 0?d:0);var se=n[l],le=l<r.length-1?[].concat((0,oe.Z)(r[l+1]),[(S=n[l+1][2])!==null&&S!==void 0?S:0]):null,ye=l<n.length-1?n[l+1]:null,Be=this.segment_gaode2(t,s,O,U,le,Z,se,ye);s+=Be}if(this.dash)for(var rt=0;rt<t.positions.length/6;rt++)t.positions[rt*6+5]=this.totalDistance;return t.startIndex=t.positions.length/6,t}},{key:"simpleExtrude_gaode2",value:function(r,n){var t=this.complex;if(r.length<=1)return t;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,s=t.startIndex,l=1;l<a;l++){var f,d,S,O=r[l-1];O.push((f=n[l-1][2])!==null&&f!==void 0?f:0);var Z=n[l-1],U=r[l];U.push((d=n[l][2])!==null&&d!==void 0?d:0);var se=n[l],le=l<r.length-1?[].concat((0,oe.Z)(r[l+1]),[(S=n[l+1][2])!==null&&S!==void 0?S:0]):null,ye=l<n.length-1?n[l+1]:null,Be=this.simpleSegment(t,s,O,U,le,Z,se,ye);s+=Be}if(this.dash)for(var rt=0;rt<t.positions.length/6;rt++)t.positions[rt*6+5]=this.totalDistance;return t.startIndex=t.positions.length/6,t}},{key:"extrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var t=r.length,a=n.startIndex,s=1;s<t;s++){var l=r[s-1],f=r[s],d=s<r.length-1?r[s+1]:null,S=this.segment(n,a,l,f,d);a+=S}if(this.dash)for(var O=0;O<n.positions.length/6;O++)n.positions[O*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var t=r.length,a=n.startIndex,s=1;s<t;s++){var l=r[s-1],f=r[s],d=s<r.length-1?r[s+1]:null,S=this.simpleSegment(n,a,l,f,d);a+=S}if(this.dash)for(var O=0;O<n.positions.length/6;O++)n.positions[O*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"segment_gaode2",value:function(r,n,t,a,s,l,f,d){var S=0,O=r.indices,Z=r.positions,U=r.normals,se=this.cap==="square",le=this.join==="bevel",ye=ga([f[0],f[1]]),Be=ga([l[0],l[1]]);aa(mn,a,t);var rt=0;if(this.dash&&(rt=this.lineSegmentDistance(ye,Be),this.totalDistance+=rt),this.normal||(this.normal=ri(),Sa(this.normal,mn)),!this.started)if(this.started=!0,se){var Je=ri(),Ot=ri();Hi(Je,this.normal,mn),Hi(Ot,this.normal,mn),U.push(Ot[0],Ot[1],0),U.push(Je[0],Je[1],0),Z.push(t[0],t[1],t[2]|0,this.totalDistance-rt,-this.thickness,t[2]|0),this.complex.indexes.push(this.currentIndex),Z.push(t[0],t[1],t[2]|0,this.totalDistance-rt,this.thickness,t[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(Z,U,t,this.normal,this.thickness,this.totalDistance-rt);if(O.push(n+0,n+1,n+2),s){no(a,s)&&Hi(s,a,tl(s,ba(s,a,t))),aa(wi,s,a);var Lr=xa(ya,ri(),mn,wi,this.thickness),jr=(0,Ja.Z)(Lr,2),Jr=jr[0],Pn=jr[1],In=Ts(ya,this.normal)<0?-1:1,Si=le;if(!Si&&this.join==="miter"){var ra=Jr;ra>this.miterLimit&&(Si=!0)}Si?(U.push(this.normal[0],this.normal[1],0),U.push(Pn[0],Pn[1],0),Z.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*In,a[2]|0),this.complex.indexes.push(this.currentIndex),Z.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*In,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,O.push.apply(O,(0,oe.Z)(this.lastFlip!==-In?[n,n+2,n+3]:[n+2,n+1,n+3])),O.push(n+2,n+3,n+4),Sa(ar,wi),vo(this.normal,ar),U.push(this.normal[0],this.normal[1],0),Z.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*In,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,S+=3):(this.extrusions(Z,U,a,Pn,Jr,this.totalDistance),O.push.apply(O,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),In=-1,vo(this.normal,Pn),S+=2),this.lastFlip=In}else{if(Sa(this.normal,mn),se){var jt=ri(),dr=ri();cn(dr,mn,this.normal),Hi(jt,mn,this.normal),U.push(dr[0],dr[1],0),U.push(jt[0],jt[1],0),Z.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),Z.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(Z,U,a,this.normal,this.thickness,this.totalDistance);O.push.apply(O,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),S+=2}return S}},{key:"simpleSegment",value:function(r,n,t,a,s){var l=0,f=r.indices,d=r.positions,S=r.normals,O=ga([a[0],a[1]]),Z=ga([t[0],t[1]]);aa(mn,O,Z);var U=0;if(this.dash&&(U=this.lineSegmentDistance(O,Z),this.totalDistance+=U),this.normal||(this.normal=ri(),Sa(this.normal,mn)),this.started||(this.started=!0,this.extrusions(d,S,t,this.normal,this.thickness,this.totalDistance-U)),f.push(n+0,n+1,n+2),!s)Sa(this.normal,mn),this.extrusions(d,S,a,this.normal,this.thickness,this.totalDistance),f.push.apply(f,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),l+=2;else{var se=ga([s[0],s[1]]);no(O,se)&&Hi(se,O,tl(se,ba(se,O,Z))),aa(wi,se,O);var le=xa(ya,ri(),mn,wi,this.thickness),ye=(0,Ja.Z)(le,2),Be=ye[0],rt=ye[1],Je=Ts(ya,this.normal)<0?-1:1;this.extrusions(d,S,a,rt,Be,this.totalDistance),f.push.apply(f,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Je=-1,vo(this.normal,rt),l+=2,this.lastFlip=Je}return l}},{key:"segment",value:function(r,n,t,a,s){var l=0,f=r.indices,d=r.positions,S=r.normals,O=this.cap==="square",Z=this.join==="bevel",U=ga([a[0],a[1]]),se=ga([t[0],t[1]]);aa(mn,U,se);var le=0;if(this.dash&&(le=this.lineSegmentDistance(U,se),this.totalDistance+=le),this.normal||(this.normal=ri(),Sa(this.normal,mn)),!this.started)if(this.started=!0,O){var ye=ri(),Be=ri();Hi(ye,this.normal,mn),Hi(Be,this.normal,mn),S.push(Be[0],Be[1],0),S.push(ye[0],ye[1],0),d.push(t[0],t[1],t[2]|0,this.totalDistance-le,-this.thickness,t[2]|0),this.complex.indexes.push(this.currentIndex),d.push(t[0],t[1],t[2]|0,this.totalDistance-le,this.thickness,t[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(d,S,t,this.normal,this.thickness,this.totalDistance-le);if(f.push(n+0,n+1,n+2),s){var Ot=ga([s[0],s[1]]);no(U,Ot)&&Hi(Ot,U,tl(Ot,ba(Ot,U,se))),aa(wi,Ot,U);var jt=xa(ya,ri(),mn,wi,this.thickness),dr=(0,Ja.Z)(jt,2),Lr=dr[0],jr=dr[1],Jr=Ts(ya,this.normal)<0?-1:1,Pn=Z;if(!Pn&&this.join==="miter"){var In=Lr;In>this.miterLimit&&(Pn=!0)}Pn?(S.push(this.normal[0],this.normal[1],0),S.push(jr[0],jr[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Jr,a[2]|0),this.complex.indexes.push(this.currentIndex),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*Jr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,f.push.apply(f,(0,oe.Z)(this.lastFlip!==-Jr?[n,n+2,n+3]:[n+2,n+1,n+3])),f.push(n+2,n+3,n+4),Sa(ar,wi),vo(this.normal,ar),S.push(this.normal[0],this.normal[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Jr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,l+=3):(this.extrusions(d,S,a,jr,Lr,this.totalDistance),f.push.apply(f,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Jr=-1,vo(this.normal,jr),l+=2),this.lastFlip=Jr}else{if(Sa(this.normal,mn),O){var rt=ri(),Je=ri();cn(Je,mn,this.normal),Hi(rt,mn,this.normal),S.push(Je[0],Je[1],0),S.push(rt[0],rt[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(d,S,a,this.normal,this.thickness,this.totalDistance);f.push.apply(f,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),l+=2}return l}},{key:"extrusions",value:function(r,n,t,a,s,l){n.push(a[0],a[1],0),n.push(a[0],a[1],0),r.push(t[0],t[1],t[2]|0,l,-s,t[2]|0),this.complex.indexes.push(this.currentIndex),r.push(t[0],t[1],t[2]|0,l,s,t[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(r,n){var t=n[0]-r[0],a=n[1]-r[1];return Math.sqrt(t*t+a*a)}}]),e}(),E=85.0511287798;function A(e){var i=e.coordinates,r=e.originCoordinates,n=e.version,t=new io({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var a=i;Array.isArray(a[0][0])||(a=[i]);var s=r;Array.isArray(s[0][0])||(s=[r]);for(var l=0;l<a.length;l++){var f=a[l],d=s[l];t.extrude_gaode2(f,d)}}else{var S=i;S[0]&&!Array.isArray(S[0][0])&&(S=[i]),S.forEach(function(Z){t.extrude(Z)})}var O=t.complex;return{vertices:O.positions,indices:O.indices,normals:O.normals,indexes:O.indexes,size:6}}function L(e){var i=ml(e.coordinates);return{vertices:[].concat((0,oe.Z)(i),(0,oe.Z)(i),(0,oe.Z)(i),(0,oe.Z)(i)),indices:[0,1,2,2,3,0],size:i.length}}function P(e){var i=e.coordinates,r=yi().flatten(i),n=r.vertices,t=r.dimensions,a=r.holes,s=yi()(n,a,t);return{indices:s,vertices:n,size:t}}function B(e,i){var r=i;return i>E&&(r=E),i<-E&&(r=-E),[Math.PI*e/180+Math.PI,Math.PI-Math.log(Math.tan(Math.PI*.25+Math.PI*r/180*.5))]}function j(e,i){return[(e-Math.PI)*180/Math.PI,(Math.atan(Math.exp(Math.PI-i))-Math.PI*.25)*2*180/Math.PI]}var te=function(){var e=(0,Dt.Z)(Ze().mark(function i(r){var n,t,a,s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return n=r.descriptors,t=r.features,a=r.enablePicking,s=r.iconMap,l={a_Color:Ji,a_Position:yn,filter:Qn,a_vertexId:Yi,a_PickingColor:function(le){var ye=le.id;return a?of(ye):[0,0,0]},a_DistanceAndIndex:function(le,ye,Be,rt,Je,Ot){return Ot===void 0?[Be[3],10]:[Be[3],Ot]},a_Total_Distance:function(le,ye,Be){return[Be[5]]},a_Size:function(le){var ye=le.size,Be=ye===void 0?1:ye;return Array.isArray(Be)?[Be[0],Be[1]]:[Be,0]},a_Normal:function(le,ye,Be,rt,Je){return Je},a_Miter:function(le,ye,Be){return[Be[4]]},a_iconMapUV:function(le){var ye=le.texture,Be=s[ye]||{x:0,y:0},rt=Be.x,Je=Be.y;return[rt,Je]}},f={sizePerElement:0,elements:[]},d=0,S=[],O=3,t.forEach(function(se,le){var ye=A(se),Be=ye.indices,rt=ye.vertices,Je=ye.normals,Ot=ye.size,jt=ye.indexes;Be.forEach(function(Jr){S.push(Jr+d)}),O=Ot;var dr=rt.length/Ot;f.sizePerElement=O,f.elements.push({featureIdx:le,vertices:rt,normals:Je,offset:d}),d+=dr;for(var Lr=function(Pn){var In=(Je==null?void 0:Je.slice(Pn*3,Pn*3+3))||[],Si=rt.slice(Pn*Ot,Pn*Ot+Ot),ra=0;jt&&jt[Pn]!==void 0&&(ra=jt[Pn]),n.forEach(function(Va){if(Va&&l[Va.name]){var Ms;(Ms=Va.buffer.data).push.apply(Ms,(0,oe.Z)(l[Va.name](se,le,Si,Pn,In,ra)))}})},jr=0;jr<dr;jr++)Lr(jr)}),U.abrupt("return",{descriptors:n,featureLayout:f,indices:S});case 8:case"end":return U.stop()}},i)}));return function(r){return e.apply(this,arguments)}}(),de=function(){var e=(0,Dt.Z)(Ze().mark(function i(r){var n,t,a,s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return n=r.descriptors,t=r.features,a=r.enablePicking,s=r.shape2d,l={a_Color:Ji,a_Position:yn,filter:Qn,a_vertexId:Yi,a_PickingColor:function(le){var ye=le.id;return a?of(ye):[0,0,0]},a_Shape:function(le){var ye=le.shape,Be=ye===void 0?2:ye,rt=s.indexOf(Be);return[rt]},a_Extrude:function(le,ye,Be,rt){var Je=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],Ot=rt%4*3;return[Je[Ot],Je[Ot+1],Je[Ot+2]]},a_Size:function(le){var ye=le.size,Be=ye===void 0?5:ye;return Array.isArray(Be)?[Be[0]]:[Be]}},f={sizePerElement:0,elements:[]},d=0,S=[],O=3,t.forEach(function(se,le){var ye=L(se),Be=ye.indices,rt=ye.vertices,Je=ye.normals,Ot=ye.size,jt=ye.indexes;Be.forEach(function(Jr){S.push(Jr+d)}),O=Ot;var dr=rt.length/Ot;f.sizePerElement=O,f.elements.push({featureIdx:le,vertices:rt,normals:Je,offset:d}),d+=dr;for(var Lr=function(Pn){var In=(Je==null?void 0:Je.slice(Pn*3,Pn*3+3))||[],Si=rt.slice(Pn*Ot,Pn*Ot+Ot),ra=0;jt&&jt[Pn]!==void 0&&(ra=jt[Pn]),n.forEach(function(Va){if(Va&&l[Va.name]){var Ms;(Ms=Va.buffer.data).push.apply(Ms,(0,oe.Z)(l[Va.name](se,le,Si,Pn,In,ra)))}})},jr=0;jr<dr;jr++)Lr(jr)}),U.abrupt("return",{descriptors:n,featureLayout:f,indices:S});case 8:case"end":return U.stop()}},i)}));return function(r){return e.apply(this,arguments)}}(),Oe=function(){var e=(0,Dt.Z)(Ze().mark(function i(r){var n,t,a,s,l,f,d,S;return Ze().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return n=r.descriptors,t=r.features,a=r.enablePicking,s={a_Color:Ji,a_Position:yn,filter:Qn,a_vertexId:Yi,a_PickingColor:function(se){var le=se.id;return a?of(le):[0,0,0]}},l={sizePerElement:0,elements:[]},f=0,d=[],S=3,t.forEach(function(U,se){var le=P(U),ye=le.indices,Be=le.vertices,rt=le.normals,Je=le.size,Ot=le.indexes;ye.forEach(function(jr){d.push(jr+f)}),S=Je;var jt=Be.length/Je;l.sizePerElement=S,l.elements.push({featureIdx:se,vertices:Be,normals:rt,offset:f}),f+=jt;for(var dr=function(Jr){var Pn=(rt==null?void 0:rt.slice(Jr*3,Jr*3+3))||[],In=Be.slice(Jr*Je,Jr*Je+Je),Si=0;Ot&&Ot[Jr]!==void 0&&(Si=Ot[Jr]),n.forEach(function(ra){if(ra&&s[ra.name]){var Va;(Va=ra.buffer.data).push.apply(Va,(0,oe.Z)(s[ra.name](U,se,In,Jr,Pn,Si)))}})},Lr=0;Lr<jt;Lr++)dr(Lr)}),Z.abrupt("return",{descriptors:n,featureLayout:l,indices:d});case 8:case"end":return Z.stop()}},i)}));return function(r){return e.apply(this,arguments)}}(),et={pointFill:de,line:te,polygonFill:Oe},Pt=(0,ue.Z)({},et);function Mr(e){return Qr.apply(this,arguments)}function Qr(){return Qr=(0,Dt.Z)(Ze().mark(function e(i){var r,n;return Ze().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=i.workerType,n=i.data,!Pt[r]){a.next=3;break}return a.abrupt("return",Pt[r](n));case 3:return a.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(r,'" non-existent.'))));case 4:case"end":return a.stop()}},e)})),Qr.apply(this,arguments)}On(Mr);var Xn=new Map;function ii(e,i){Xn.set(e,i)}function li(e){var i=Xn.get(e);return i}var Mn=`var L7=function(t){"use strict";function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(){r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new O(n||[]);return i._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=w(a,r);if(u){if(u===l)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=f(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(t,r,a),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l={};function h(){}function p(){}function v(){}var d={};s(d,i,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(S([])));g&&g!==e&&n.call(g,i)&&(d=g);var m=v.prototype=h.prototype=Object.create(d);function x(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){var r;this._invoke=function(o,i){function a(){return new e((function(r,a){!function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function w(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=f(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},x(b.prototype),s(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=S,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}function n(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,s,"next",t)}function s(t){n(a,o,i,u,s,"throw",t)}u(void 0)}))}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(t){if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function b(t,e){return t(e={exports:{}},e.exports),e.exports}var w,E,A=function(t){return t&&t.Math==Math&&t},O=A("object"==typeof globalThis&&globalThis)||A("object"==typeof window&&window)||A("object"==typeof self&&self)||A("object"==typeof x&&x)||function(){return this}()||Function("return this")(),S=Object.defineProperty,T=function(t,e){try{S(O,t,{value:e,configurable:!0,writable:!0})}catch(r){O[t]=e}return e},k=O["__core-js_shared__"]||T("__core-js_shared__",{}),I=b((function(t){(t.exports=function(t,e){return k[t]||(k[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.25.5",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"})})),j=function(t){try{return!!t()}catch(t){return!0}},P=!j((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),_=Function.prototype,M=_.call,L=P&&_.bind.bind(M,M),R=function(t){return P?L(t):function(){return M.apply(t,arguments)}},C=R({}.toString),N=R("".slice),D=function(t){return N(C(t),8,-1)},F=function(t){if("Function"===D(t))return R(t)},W=function(t){return null==t},z=TypeError,B=function(t){if(W(t))throw z("Can't call method on "+t);return t},U=Object,G=function(t){return U(B(t))},H=F({}.hasOwnProperty),V=Object.hasOwn||function(t,e){return H(G(t),e)},q=0,Z=Math.random(),Y=F(1..toString),$=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Y(++q+Z,36)},K="object"==typeof document&&document.all,Q={all:K,IS_HTMLDDA:void 0===K&&void 0!==K},X=Q.all,J=Q.IS_HTMLDDA?function(t){return"function"==typeof t||t===X}:function(t){return"function"==typeof t},tt=function(t){return J(t)?t:void 0},et=function(t,e){return arguments.length<2?tt(O[t]):O[t]&&O[t][e]},rt=et("navigator","userAgent")||"",nt=O.process,ot=O.Deno,it=nt&&nt.versions||ot&&ot.version,at=it&&it.v8;at&&(E=(w=at.split("."))[0]>0&&w[0]<4?1:+(w[0]+w[1])),!E&&rt&&(!(w=rt.match(/Edge\\/(\\d+)/))||w[1]>=74)&&(w=rt.match(/Chrome\\/(\\d+)/))&&(E=+w[1]);var ut=E,st=!!Object.getOwnPropertySymbols&&!j((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ut&&ut<41})),ct=st&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ft=I("wks"),lt=O.Symbol,ht=lt&&lt.for,pt=ct?lt:lt&&lt.withoutSetter||$,vt=function(t){if(!V(ft,t)||!st&&"string"!=typeof ft[t]){var e="Symbol."+t;st&&V(lt,t)?ft[t]=lt[t]:ft[t]=ct&&ht?ht(e):pt(e)}return ft[t]},dt={};dt[vt("toStringTag")]="z";var yt="[object z]"===String(dt),gt=!j((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),mt=Q.all,xt=Q.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:J(t)||t===mt}:function(t){return"object"==typeof t?null!==t:J(t)},bt=O.document,wt=xt(bt)&&xt(bt.createElement),Et=function(t){return wt?bt.createElement(t):{}},At=!gt&&!j((function(){return 7!=Object.defineProperty(Et("div"),"a",{get:function(){return 7}}).a})),Ot=gt&&j((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),St=String,Tt=TypeError,kt=function(t){if(xt(t))return t;throw Tt(St(t)+" is not an object")},It=Function.prototype.call,jt=P?It.bind(It):function(){return It.apply(It,arguments)},Pt=F({}.isPrototypeOf),_t=Object,Mt=ct?function(t){return"symbol"==typeof t}:function(t){var e=et("Symbol");return J(e)&&Pt(e.prototype,_t(t))},Lt=String,Rt=function(t){try{return Lt(t)}catch(t){return"Object"}},Ct=TypeError,Nt=function(t){if(J(t))return t;throw Ct(Rt(t)+" is not a function")},Dt=function(t,e){var r=t[e];return W(r)?void 0:Nt(r)},Ft=TypeError,Wt=TypeError,zt=vt("toPrimitive"),Bt=function(t,e){if(!xt(t)||Mt(t))return t;var r,n=Dt(t,zt);if(n){if(void 0===e&&(e="default"),r=jt(n,t,e),!xt(r)||Mt(r))return r;throw Wt("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var r,n;if("string"===e&&J(r=t.toString)&&!xt(n=jt(r,t)))return n;if(J(r=t.valueOf)&&!xt(n=jt(r,t)))return n;if("string"!==e&&J(r=t.toString)&&!xt(n=jt(r,t)))return n;throw Ft("Can't convert object to primitive value")}(t,e)},Ut=function(t){var e=Bt(t,"string");return Mt(e)?e:e+""},Gt=TypeError,Ht=Object.defineProperty,Vt=Object.getOwnPropertyDescriptor,qt={f:gt?Ot?function(t,e,r){if(kt(t),e=Ut(e),kt(r),"function"==typeof t&&"prototype"===e&&"value"in r&&"writable"in r&&!r.writable){var n=Vt(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return Ht(t,e,r)}:Ht:function(t,e,r){if(kt(t),e=Ut(e),kt(r),At)try{return Ht(t,e,r)}catch(t){}if("get"in r||"set"in r)throw Gt("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},Zt=Function.prototype,Yt=gt&&Object.getOwnPropertyDescriptor,$t=V(Zt,"name"),Kt={EXISTS:$t,PROPER:$t&&"something"===function(){}.name,CONFIGURABLE:$t&&(!gt||gt&&Yt(Zt,"name").configurable)},Qt=F(Function.toString);J(k.inspectSource)||(k.inspectSource=function(t){return Qt(t)});var Xt,Jt,te,ee=k.inspectSource,re=O.WeakMap,ne=J(re)&&/native code/.test(String(re)),oe=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},ie=gt?function(t,e,r){return qt.f(t,e,oe(1,r))}:function(t,e,r){return t[e]=r,t},ae=I("keys"),ue=function(t){return ae[t]||(ae[t]=$(t))},se={},ce=O.TypeError,fe=O.WeakMap;if(ne||k.state){var le=k.state||(k.state=new fe);le.get=le.get,le.has=le.has,le.set=le.set,Xt=function(t,e){if(le.has(t))throw ce("Object already initialized");return e.facade=t,le.set(t,e),e},Jt=function(t){return le.get(t)||{}},te=function(t){return le.has(t)}}else{var he=ue("state");se[he]=!0,Xt=function(t,e){if(V(t,he))throw ce("Object already initialized");return e.facade=t,ie(t,he,e),e},Jt=function(t){return V(t,he)?t[he]:{}},te=function(t){return V(t,he)}}var pe={set:Xt,get:Jt,has:te,enforce:function(t){return te(t)?Jt(t):Xt(t,{})},getterFor:function(t){return function(e){var r;if(!xt(e)||(r=Jt(e)).type!==t)throw ce("Incompatible receiver, "+t+" required");return r}}},ve=b((function(t){var e=Kt.CONFIGURABLE,r=pe.enforce,n=pe.get,o=Object.defineProperty,i=gt&&!j((function(){return 8!==o((function(){}),"length",{value:8}).length})),a=String(String).split("String"),u=t.exports=function(t,n,u){"Symbol("===String(n).slice(0,7)&&(n="["+String(n).replace(/^Symbol\\(([^)]*)\\)/,"$1")+"]"),u&&u.getter&&(n="get "+n),u&&u.setter&&(n="set "+n),(!V(t,"name")||e&&t.name!==n)&&(gt?o(t,"name",{value:n,configurable:!0}):t.name=n),i&&u&&V(u,"arity")&&t.length!==u.arity&&o(t,"length",{value:u.arity});try{u&&V(u,"constructor")&&u.constructor?gt&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var s=r(t);return V(s,"source")||(s.source=a.join("string"==typeof n?n:"")),t};Function.prototype.toString=u((function(){return J(this)&&n(this).source||ee(this)}),"toString")})),de=function(t,e,r,n){n||(n={});var o=n.enumerable,i=void 0!==n.name?n.name:e;if(J(r)&&ve(r,i,n),n.global)o?t[e]=r:T(e,r);else{try{n.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=r:qt.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},ye=vt("toStringTag"),ge=Object,me="Arguments"==D(function(){return arguments}()),xe=yt?D:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=ge(t),ye))?r:me?D(e):"Object"==(n=D(e))&&J(e.callee)?"Arguments":n},be=yt?{}.toString:function(){return"[object "+xe(this)+"]"};yt||de(Object.prototype,"toString",be,{unsafe:!0});var we={}.propertyIsEnumerable,Ee=Object.getOwnPropertyDescriptor,Ae={f:Ee&&!we.call({1:2},1)?function(t){var e=Ee(this,t);return!!e&&e.enumerable}:we},Oe=Object,Se=F("".split),Te=j((function(){return!Oe("z").propertyIsEnumerable(0)}))?function(t){return"String"==D(t)?Se(t,""):Oe(t)}:Oe,ke=function(t){return Te(B(t))},Ie=Object.getOwnPropertyDescriptor,je={f:gt?Ie:function(t,e){if(t=ke(t),e=Ut(e),At)try{return Ie(t,e)}catch(t){}if(V(t,e))return oe(!jt(Ae.f,t,e),t[e])}},Pe=Math.ceil,_e=Math.floor,Me=Math.trunc||function(t){var e=+t;return(e>0?_e:Pe)(e)},Le=function(t){var e=+t;return e!=e||0===e?0:Me(e)},Re=Math.max,Ce=Math.min,Ne=function(t,e){var r=Le(t);return r<0?Re(r+e,0):Ce(r,e)},De=Math.min,Fe=function(t){return t>0?De(Le(t),9007199254740991):0},We=function(t){return Fe(t.length)},ze=function(t){return function(e,r,n){var o,i=ke(e),a=We(i),u=Ne(n,a);if(t&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}},Be={includes:ze(!0),indexOf:ze(!1)},Ue=Be.indexOf,Ge=F([].push),He=function(t,e){var r,n=ke(t),o=0,i=[];for(r in n)!V(se,r)&&V(n,r)&&Ge(i,r);for(;e.length>o;)V(n,r=e[o++])&&(~Ue(i,r)||Ge(i,r));return i},Ve=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],qe=Ve.concat("length","prototype"),Ze={f:Object.getOwnPropertyNames||function(t){return He(t,qe)}},Ye={f:Object.getOwnPropertySymbols},$e=F([].concat),Ke=et("Reflect","ownKeys")||function(t){var e=Ze.f(kt(t)),r=Ye.f;return r?$e(e,r(t)):e},Qe=function(t,e,r){for(var n=Ke(e),o=qt.f,i=je.f,a=0;a<n.length;a++){var u=n[a];V(t,u)||r&&V(r,u)||o(t,u,i(e,u))}},Xe=/#|\\.prototype\\./,Je=function(t,e){var r=er[tr(t)];return r==nr||r!=rr&&(J(e)?j(e):!!e)},tr=Je.normalize=function(t){return String(t).replace(Xe,".").toLowerCase()},er=Je.data={},rr=Je.NATIVE="N",nr=Je.POLYFILL="P",or=Je,ir=je.f,ar=function(t,e){var r,n,o,i,a,u=t.target,s=t.global,c=t.stat;if(r=s?O:c?O[u]||T(u,{}):(O[u]||{}).prototype)for(n in e){if(i=e[n],o=t.dontCallGetSet?(a=ir(r,n))&&a.value:r[n],!or(s?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Qe(i,o)}(t.sham||o&&o.sham)&&ie(i,"sham",!0),de(r,n,i,t)}},ur="process"==D(O.process),sr=String,cr=TypeError,fr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=F(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return kt(r),function(t){if("object"==typeof t||J(t))return t;throw cr("Can't set "+sr(t)+" as a prototype")}(n),e?t(r,n):r.__proto__=n,r}}():void 0),lr=qt.f,hr=vt("toStringTag"),pr=function(t,e,r){t&&!r&&(t=t.prototype),t&&!V(t,hr)&&lr(t,hr,{configurable:!0,value:e})},vr=vt("species"),dr=function(t){var e=et(t),r=qt.f;gt&&e&&!e[vr]&&r(e,vr,{configurable:!0,get:function(){return this}})},yr=TypeError,gr=function(t,e){if(Pt(e,t))return t;throw yr("Incorrect invocation")},mr=function(){},xr=[],br=et("Reflect","construct"),wr=/^\\s*(?:class|function)\\b/,Er=F(wr.exec),Ar=!wr.exec(mr),Or=function(t){if(!J(t))return!1;try{return br(mr,xr,t),!0}catch(t){return!1}},Sr=function(t){if(!J(t))return!1;switch(xe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Ar||!!Er(wr,ee(t))}catch(t){return!0}};Sr.sham=!0;var Tr,kr,Ir,jr,Pr=!br||j((function(){var t;return Or(Or.call)||!Or(Object)||!Or((function(){t=!0}))||t}))?Sr:Or,_r=TypeError,Mr=function(t){if(Pr(t))return t;throw _r(Rt(t)+" is not a constructor")},Lr=vt("species"),Rr=function(t,e){var r,n=kt(t).constructor;return void 0===n||W(r=kt(n)[Lr])?e:Mr(r)},Cr=Function.prototype,Nr=Cr.apply,Dr=Cr.call,Fr="object"==typeof Reflect&&Reflect.apply||(P?Dr.bind(Nr):function(){return Dr.apply(Nr,arguments)}),Wr=F(F.bind),zr=function(t,e){return Nt(t),void 0===e?t:P?Wr(t,e):function(){return t.apply(e,arguments)}},Br=et("document","documentElement"),Ur=F([].slice),Gr=TypeError,Hr=function(t,e){if(t<e)throw Gr("Not enough arguments");return t},Vr=/(?:ipad|iphone|ipod).*applewebkit/i.test(rt),qr=O.setImmediate,Zr=O.clearImmediate,Yr=O.process,$r=O.Dispatch,Kr=O.Function,Qr=O.MessageChannel,Xr=O.String,Jr=0,tn={};try{Tr=O.location}catch(t){}var en=function(t){if(V(tn,t)){var e=tn[t];delete tn[t],e()}},rn=function(t){return function(){en(t)}},nn=function(t){en(t.data)},on=function(t){O.postMessage(Xr(t),Tr.protocol+"//"+Tr.host)};qr&&Zr||(qr=function(t){Hr(arguments.length,1);var e=J(t)?t:Kr(t),r=Ur(arguments,1);return tn[++Jr]=function(){Fr(e,void 0,r)},kr(Jr),Jr},Zr=function(t){delete tn[t]},ur?kr=function(t){Yr.nextTick(rn(t))}:$r&&$r.now?kr=function(t){$r.now(rn(t))}:Qr&&!Vr?(jr=(Ir=new Qr).port2,Ir.port1.onmessage=nn,kr=zr(jr.postMessage,jr)):O.addEventListener&&J(O.postMessage)&&!O.importScripts&&Tr&&"file:"!==Tr.protocol&&!j(on)?(kr=on,O.addEventListener("message",nn,!1)):kr="onreadystatechange"in Et("script")?function(t){Br.appendChild(Et("script")).onreadystatechange=function(){Br.removeChild(this),en(t)}}:function(t){setTimeout(rn(t),0)});var an,un,sn,cn,fn,ln,hn,pn,vn={set:qr,clear:Zr},dn=/ipad|iphone|ipod/i.test(rt)&&void 0!==O.Pebble,yn=/web0s(?!.*chrome)/i.test(rt),gn=je.f,mn=vn.set,xn=O.MutationObserver||O.WebKitMutationObserver,bn=O.document,wn=O.process,En=O.Promise,An=gn(O,"queueMicrotask"),On=An&&An.value;On||(an=function(){var t,e;for(ur&&(t=wn.domain)&&t.exit();un;){e=un.fn,un=un.next;try{e()}catch(t){throw un?cn():sn=void 0,t}}sn=void 0,t&&t.enter()},Vr||ur||yn||!xn||!bn?!dn&&En&&En.resolve?((hn=En.resolve(void 0)).constructor=En,pn=zr(hn.then,hn),cn=function(){pn(an)}):ur?cn=function(){wn.nextTick(an)}:(mn=zr(mn,O),cn=function(){mn(an)}):(fn=!0,ln=bn.createTextNode(""),new xn(an).observe(ln,{characterData:!0}),cn=function(){ln.data=fn=!fn}));var Sn=On||function(t){var e={fn:t,next:void 0};sn&&(sn.next=e),un||(un=e,cn()),sn=e},Tn=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},kn=function(){this.head=null,this.tail=null};kn.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var In,jn,Pn,_n=kn,Mn=O.Promise,Ln="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Rn=!Ln&&!ur&&"object"==typeof window&&"object"==typeof document,Cn=(Mn&&Mn.prototype,vt("species")),Nn=!1,Dn=J(O.PromiseRejectionEvent),Fn={CONSTRUCTOR:or("Promise",(function(){var t=ee(Mn),e=t!==String(Mn);if(!e&&66===ut)return!0;if(!ut||ut<51||!/native code/.test(t)){var r=new Mn((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[Cn]=n,!(Nn=r.then((function(){}))instanceof n))return!0}return!e&&(Rn||Ln)&&!Dn})),REJECTION_EVENT:Dn,SUBCLASSING:Nn},Wn=TypeError,zn=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw Wn("Bad Promise constructor");e=t,r=n})),this.resolve=Nt(e),this.reject=Nt(r)},Bn={f:function(t){return new zn(t)}},Un=vn.set,Gn=Fn.CONSTRUCTOR,Hn=Fn.REJECTION_EVENT,Vn=Fn.SUBCLASSING,qn=pe.getterFor("Promise"),Zn=pe.set,Yn=Mn&&Mn.prototype,$n=Mn,Kn=Yn,Qn=O.TypeError,Xn=O.document,Jn=O.process,to=Bn.f,eo=to,ro=!!(Xn&&Xn.createEvent&&O.dispatchEvent),no=function(t){var e;return!(!xt(t)||!J(e=t.then))&&e},oo=function(t,e){var r,n,o,i=e.value,a=1==e.state,u=a?t.ok:t.fail,s=t.resolve,c=t.reject,f=t.domain;try{u?(a||(2===e.rejection&&co(e),e.rejection=1),!0===u?r=i:(f&&f.enter(),r=u(i),f&&(f.exit(),o=!0)),r===t.promise?c(Qn("Promise-chain cycle")):(n=no(r))?jt(n,r,s,c):s(r)):c(i)}catch(t){f&&!o&&f.exit(),c(t)}},io=function(t,e){t.notified||(t.notified=!0,Sn((function(){for(var r,n=t.reactions;r=n.get();)oo(r,t);t.notified=!1,e&&!t.rejection&&uo(t)})))},ao=function(t,e,r){var n,o;ro?((n=Xn.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),O.dispatchEvent(n)):n={promise:e,reason:r},!Hn&&(o=O["on"+t])?o(n):"unhandledrejection"===t&&function(t,e){var r=O.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)},uo=function(t){jt(Un,O,(function(){var e,r=t.facade,n=t.value;if(so(t)&&(e=Tn((function(){ur?Jn.emit("unhandledRejection",n,r):ao("unhandledrejection",r,n)})),t.rejection=ur||so(t)?2:1,e.error))throw e.value}))},so=function(t){return 1!==t.rejection&&!t.parent},co=function(t){jt(Un,O,(function(){var e=t.facade;ur?Jn.emit("rejectionHandled",e):ao("rejectionhandled",e,t.value)}))},fo=function(t,e,r){return function(n){t(e,n,r)}},lo=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,io(t,!0))},ho=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Qn("Promise can't be resolved itself");var n=no(e);n?Sn((function(){var r={done:!1};try{jt(n,e,fo(ho,r,t),fo(lo,r,t))}catch(e){lo(r,e,t)}})):(t.value=e,t.state=1,io(t,!1))}catch(e){lo({done:!1},e,t)}}};if(Gn&&(Kn=($n=function(t){gr(this,Kn),Nt(t),jt(In,this);var e=qn(this);try{t(fo(ho,e),fo(lo,e))}catch(t){lo(e,t)}}).prototype,(In=function(t){Zn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new _n,rejection:!1,state:0,value:void 0})}).prototype=de(Kn,"then",(function(t,e){var r=qn(this),n=to(Rr(this,$n));return r.parent=!0,n.ok=!J(t)||t,n.fail=J(e)&&e,n.domain=ur?Jn.domain:void 0,0==r.state?r.reactions.add(n):Sn((function(){oo(n,r)})),n.promise})),jn=function(){var t=new In,e=qn(t);this.promise=t,this.resolve=fo(ho,e),this.reject=fo(lo,e)},Bn.f=to=function(t){return t===$n||void 0===t?new jn(t):eo(t)},J(Mn)&&Yn!==Object.prototype)){Pn=Yn.then,Vn||de(Yn,"then",(function(t,e){var r=this;return new $n((function(t,e){jt(Pn,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete Yn.constructor}catch(t){}fr&&fr(Yn,Kn)}ar({global:!0,constructor:!0,wrap:!0,forced:Gn},{Promise:$n}),pr($n,"Promise",!1),dr("Promise");var po={},vo=vt("iterator"),yo=Array.prototype,go=function(t){return void 0!==t&&(po.Array===t||yo[vo]===t)},mo=vt("iterator"),xo=function(t){if(!W(t))return Dt(t,mo)||Dt(t,"@@iterator")||po[xe(t)]},bo=TypeError,wo=function(t,e){var r=arguments.length<2?xo(t):e;if(Nt(r))return kt(jt(r,t));throw bo(Rt(t)+" is not iterable")},Eo=function(t,e,r){var n,o;kt(t);try{if(!(n=Dt(t,"return"))){if("throw"===e)throw r;return r}n=jt(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw r;if(o)throw n;return kt(n),r},Ao=TypeError,Oo=function(t,e){this.stopped=t,this.result=e},So=Oo.prototype,To=function(t,e,r){var n,o,i,a,u,s,c,f=r&&r.that,l=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),v=!(!r||!r.INTERRUPTED),d=zr(e,f),y=function(t){return n&&Eo(n,"normal",t),new Oo(!0,t)},g=function(t){return l?(kt(t),v?d(t[0],t[1],y):d(t[0],t[1])):v?d(t,y):d(t)};if(h)n=t.iterator;else if(p)n=t;else{if(!(o=xo(t)))throw Ao(Rt(t)+" is not iterable");if(go(o)){for(i=0,a=We(t);a>i;i++)if((u=g(t[i]))&&Pt(So,u))return u;return new Oo(!1)}n=wo(t,o)}for(s=h?t.next:n.next;!(c=jt(s,n)).done;){try{u=g(c.value)}catch(t){Eo(n,"throw",t)}if("object"==typeof u&&u&&Pt(So,u))return u}return new Oo(!1)},ko=vt("iterator"),Io=!1;try{var jo=0,Po={next:function(){return{done:!!jo++}},return:function(){Io=!0}};Po[ko]=function(){return this},Array.from(Po,(function(){throw 2}))}catch(t){}var _o=function(t,e){if(!e&&!Io)return!1;var r=!1;try{var n={};n[ko]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},Mo=Fn.CONSTRUCTOR||!_o((function(t){Mn.all(t).then(void 0,(function(){}))}));ar({target:"Promise",stat:!0,forced:Mo},{all:function(t){var e=this,r=Bn.f(e),n=r.resolve,o=r.reject,i=Tn((function(){var r=Nt(e.resolve),i=[],a=0,u=1;To(t,(function(t){var s=a++,c=!1;u++,jt(r,e,t).then((function(t){c||(c=!0,i[s]=t,--u||n(i))}),o)})),--u||n(i)}));return i.error&&o(i.value),r.promise}});var Lo=Fn.CONSTRUCTOR,Ro=Mn&&Mn.prototype;if(ar({target:"Promise",proto:!0,forced:Lo,real:!0},{catch:function(t){return this.then(void 0,t)}}),J(Mn)){var Co=et("Promise").prototype.catch;Ro.catch!==Co&&de(Ro,"catch",Co,{unsafe:!0})}ar({target:"Promise",stat:!0,forced:Mo},{race:function(t){var e=this,r=Bn.f(e),n=r.reject,o=Tn((function(){var o=Nt(e.resolve);To(t,(function(t){jt(o,e,t).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}}),ar({target:"Promise",stat:!0,forced:Fn.CONSTRUCTOR},{reject:function(t){var e=Bn.f(this);return jt(e.reject,void 0,t),e.promise}});var No=Fn.CONSTRUCTOR;et("Promise");function Do(t,e){if(!t)throw new Error(e||"web worker helper assertion failed.")}ar({target:"Promise",stat:!0,forced:No},{resolve:function(t){return function(t,e){if(kt(t),xt(e)&&e.constructor===t)return e;var r=Bn.f(t);return(0,r.resolve)(e),r.promise}(this,t)}});var Fo="undefined"!=typeof window&&void 0!==window.orientation,Wo=function(){function t(t,e){var r=this;this.name=t,this.workerThread=e,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise((function(t,e){r.resolve=t,r.reject=e}))}return t.prototype.postMessage=function(t,e){this.workerThread.postMessage({source:"Main thread",type:t,payload:e})},t.prototype.done=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},t.prototype.error=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},t}(),zo=new Map;function Bo(t){Do(t.source&&!t.url||!t.source&&t.url);var e=zo.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Uo((e=t,"try {\\n  importScripts('"+e+"');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}"));var e}(t.url),zo.set(t.url,e)),t.source&&(e=Uo(t.source),zo.set(t.source,e))),Do(e),e}function Uo(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Go(t,e,r){void 0===e&&(e=!0);var n=r||new Set;if(t){if(Ho(t))n.add(t);else if(Ho(t.buffer))n.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(var o in t)Go(t[o],e,n)}else;return void 0===r?Array.from(n):[]}function Ho(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var Vo=function(){},qo=function(){function t(t){this.terminated=!1,this.loadableURL="";var e=t.name,r=t.source,n=t.url;Do(r||n),this.name=e,this.source=r,this.url=n,this.onMessage=Vo,this.onError=function(t){return console.log(t)},this.worker=this.createBrowserWorker()}return t.isSupported=function(){return"undefined"!=typeof Worker},t.prototype.destroy=function(){this.onMessage=Vo,this.onError=Vo,this.worker.terminate(),this.terminated=!0},Object.defineProperty(t.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),t.prototype.postMessage=function(t,e){e=e||Go(t),this.worker.postMessage(t,e)},t.prototype.getErrorFromErrorEvent=function(t){var e="Failed to load ";return e+="worker "+this.name+" from "+this.url+". ",t.message&&(e+=t.message+" in "),t.lineno&&(e+=":"+t.lineno+":"+t.colno),new Error(e)},t.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=Bo({source:this.source,url:this.url});var e=new Worker(this.loadableURL,{name:this.name});return e.onmessage=function(e){e.data?t.onMessage(e.data):t.onError(new Error("No data received"))},e.onerror=function(e){t.onError(t.getErrorFromErrorEvent(e)),t.terminated=!0},e.onmessageerror=function(e){return console.error("worker "+t.name+", message error: "+e)},e},t}(),Zo=self&&self.__assign||function(){return(Zo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Yo=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},$o=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ko=function(){function t(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return t.prototype.destroy=function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0},t.prototype.setProps=function(t){this.props=Zo(Zo({},this.props),t),void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)},t.prototype.startJob=function(t,e,r){return void 0===e&&(e=function(t,e,r){return t.done(r)}),void 0===r&&(r=function(t,e){return t.error(e)}),Yo(this,void 0,void 0,(function(){var n,o=this;return $o(this,(function(i){switch(i.label){case 0:return n=new Promise((function(n){return o.jobQueue.push({name:t,onMessage:e,onError:r,onStart:n}),o})),this.startQueuedJob(),[4,n];case 1:return[2,i.sent()]}}))}))},t.prototype.startQueuedJob=function(){return Yo(this,void 0,void 0,(function(){var t,e,r;return $o(this,(function(n){switch(n.label){case 0:if(!this.jobQueue.length)return[2];if(!(t=this.getAvailableWorker()))return[2];if(!(e=this.jobQueue.shift()))return[3,4];this.onDebug({message:"Starting job",name:e.name,backlog:this.jobQueue.length,workerThread:t}),r=new Wo(e.name,t),t.onMessage=function(t){return e.onMessage(r,t.type,t.payload)},t.onError=function(t){return e.onError(r,t)},e.onStart(r),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r.result];case 2:return n.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}}))}))},t.prototype.returnWorkerToQueue=function(t){this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},t.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new qo({name:t,source:this.source,url:this.url})}return null},t.prototype.getMaxConcurrency=function(){return Fo?this.maxMobileConcurrency:this.maxConcurrency},t}(),Qo=self&&self.__assign||function(){return(Qo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Xo=self&&self.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Jo={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},ti=(function(){function t(t){this.workerPools=new Map,this.props=Qo({},Jo),this.setProps(t),this.workerPools=new Map}t.isSupported=function(){return qo.isSupported()},t.getWorkerFarm=function(e){return void 0===e&&(e={}),t.workerFarm=t.workerFarm||new t({}),t.workerFarm.setProps(e),t.workerFarm},t.prototype.destroy=function(){var t,e;try{for(var r=Xo(this.workerPools.values()),n=r.next();!n.done;n=r.next()){n.value.destroy()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.setProps=function(t){var e,r;this.props=Qo(Qo({},this.props),t);try{for(var n=Xo(this.workerPools.values()),o=n.next();!o.done;o=n.next()){o.value.setProps(this.getWorkerPoolProps())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.getWorkerPool=function(t){var e=t.name,r=t.source,n=t.url,o=this.workerPools.get(e);return o||((o=new Ko({name:e,source:r,url:n})).setProps(this.getWorkerPoolProps()),this.workerPools.set(e,o)),o},t.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(),new Map),ei=function(){function t(){}return Object.defineProperty(t,"onmessage",{set:function(t){self.onmessage=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}},enumerable:!1,configurable:!0}),t.addEventListener=function(t){var e=ti.get(t);e||(e=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}),self.addEventListener("message",e)},t.removeEventListener=function(t){var e=ti.get(t);ti.delete(t),self.removeEventListener("message",e)},t.postMessage=function(t,e){if(self){var r={source:"Worker thread",type:t,payload:e},n=Go(e);self.postMessage(r,n)}},t}();function ri(t){var e=t.type,r=t.data;return"message"===e&&r&&"string"==typeof r.source&&"Main thread"===r.source}self&&self.__awaiter,self&&self.__generator;var ni,oi,ii=function(){function t(){this._values=[],this._settlers=[],this._closed=!1}return t.prototype[Symbol.asyncIterator]=function(){return this},t.prototype.push=function(t){return this.enqueue(t)},t.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var e=this._settlers.shift();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.push(t)},t.prototype.close=function(){for(;this._settlers.length>0;){this._settlers.shift().resolve({done:!0})}this._closed=!0},t.prototype.next=function(){var t=this;if(this._values.length>0){var e=this._values.shift();return e instanceof Error?Promise.reject(e):Promise.resolve({done:!1,value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise((function(e,r){t._settlers.push({resolve:e,reject:r})}))},t}(),ai=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},ui=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},si=self&&self.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}},ci=0;function fi(t,e){var r=this;if("undefined"!=typeof self){var n={process:li};ei.onmessage=function(o,i){return ai(r,void 0,void 0,(function(){var r,a,u,s,c,f,l,h,p,v;return ui(this,(function(d){switch(d.label){case 0:switch(d.trys.push([0,19,,20]),o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!t)throw new Error("Worker does not support atomic processing");return[4,t(i.input,i.options||{},n)];case 2:return r=d.sent(),ei.postMessage("done",{result:r}),[3,18];case 3:if(!e)throw new Error("Worker does not support batched processing");ni=new ii,oi=i.options||{},a=e(ni,oi,n),d.label=4;case 4:d.trys.push([4,9,10,15]),u=si(a),d.label=5;case 5:return[4,u.next()];case 6:if((s=d.sent()).done)return[3,8];c=s.value,ei.postMessage("output-batch",{result:c}),d.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return f=d.sent(),p={error:f},[3,15];case 10:return d.trys.push([10,,13,14]),s&&!s.done&&(v=u.return)?[4,v.call(u)]:[3,12];case 11:d.sent(),d.label=12;case 12:return[3,14];case 13:if(p)throw p.error;return[7];case 14:return[7];case 15:return ei.postMessage("done",{}),[3,18];case 16:return ni.push(i.input),[3,18];case 17:return ni.close(),[3,18];case 18:return[3,20];case 19:return l=d.sent(),h=l instanceof Error?l.message:"",ei.postMessage("error",{error:h}),[3,20];case 20:return[2]}}))}))}}}function li(t,e){return void 0===e&&(e={}),new Promise((function(r,n){var o=ci++,i=function(t,e){if(e.id===o)switch(t){case"done":ei.removeEventListener(i),r(e.result);break;case"error":ei.removeEventListener(i),n(e.error)}};ei.addEventListener(i);var a={id:o,input:t,options:e};ei.postMessage("process",a)}))}self&&self.__awaiter,self&&self.__generator;var hi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},pi=Et("span").classList,vi=pi&&pi.constructor&&pi.constructor.prototype,di=vi===Object.prototype?void 0:vi,yi=Array.isArray||function(t){return"Array"==D(t)},gi=vt("species"),mi=Array,xi=function(t,e){return new(function(t){var e;return yi(t)&&(e=t.constructor,(Pr(e)&&(e===mi||yi(e.prototype))||xt(e)&&null===(e=e[gi]))&&(e=void 0)),void 0===e?mi:e}(t))(0===e?0:e)},bi=F([].push),wi=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,u=5==t||i;return function(s,c,f,l){for(var h,p,v=G(s),d=Te(v),y=zr(c,f),g=We(d),m=0,x=l||xi,b=e?x(s,g):r||a?x(s,0):void 0;g>m;m++)if((u||m in d)&&(p=y(h=d[m],m,v),t))if(e)b[m]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return m;case 2:bi(b,h)}else switch(t){case 4:return!1;case 7:bi(b,h)}return i?-1:n||o?o:b}},Ei={forEach:wi(0),map:wi(1),filter:wi(2),some:wi(3),every:wi(4),find:wi(5),findIndex:wi(6),filterReject:wi(7)},Ai=function(t,e){var r=[][t];return!!r&&j((function(){r.call(null,e||function(){return 1},1)}))},Oi=Ei.forEach,Si=Ai("forEach")?[].forEach:function(t){return Oi(this,t,arguments.length>1?arguments[1]:void 0)},Ti=function(t){if(t&&t.forEach!==Si)try{ie(t,"forEach",Si)}catch(e){t.forEach=Si}};for(var ki in hi)hi[ki]&&Ti(O[ki]&&O[ki].prototype);Ti(di);var Ii=function(t,e,r){var n=Ut(e);n in t?qt.f(t,n,oe(0,r)):t[n]=r},ji=vt("species"),Pi=function(t){return ut>=51||!j((function(){var e=[];return(e.constructor={})[ji]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},_i=Pi("slice"),Mi=vt("species"),Li=Array,Ri=Math.max;ar({target:"Array",proto:!0,forced:!_i},{slice:function(t,e){var r,n,o,i=ke(this),a=We(i),u=Ne(t,a),s=Ne(void 0===e?a:e,a);if(yi(i)&&(r=i.constructor,(Pr(r)&&(r===Li||yi(r.prototype))||xt(r)&&null===(r=r[Mi]))&&(r=void 0),r===Li||void 0===r))return Ur(i,u,s);for(n=new(void 0===r?Li:r)(Ri(s-u,0)),o=0;u<s;u++,o++)u in i&&Ii(n,o,i[u]);return n.length=o,n}});var Ci=Kt.EXISTS,Ni=qt.f,Di=Function.prototype,Fi=F(Di.toString),Wi=/function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/,zi=F(Wi.exec);gt&&!Ci&&Ni(Di,"name",{configurable:!0,get:function(){try{return zi(Wi,Fi(this))[1]}catch(t){return""}}});var Bi=Ei.map,Ui=Pi("map");ar({target:"Array",proto:!0,forced:!Ui},{map:function(t){return Bi(this,t,arguments.length>1?arguments[1]:void 0)}});var Gi,Hi=Object.keys||function(t){return He(t,Ve)},Vi={f:gt&&!Ot?Object.defineProperties:function(t,e){kt(t);for(var r,n=ke(e),o=Hi(e),i=o.length,a=0;i>a;)qt.f(t,r=o[a++],n[r]);return t}},qi=ue("IE_PROTO"),Zi=function(){},Yi=function(t){return"<script>"+t+"<\\/script>"},$i=function(t){t.write(Yi("")),t.close();var e=t.parentWindow.Object;return t=null,e},Ki=function(){try{Gi=new ActiveXObject("htmlfile")}catch(t){}var t,e;Ki="undefined"!=typeof document?document.domain&&Gi?$i(Gi):((e=Et("iframe")).style.display="none",Br.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Yi("document.F=Object")),t.close(),t.F):$i(Gi);for(var r=Ve.length;r--;)delete Ki.prototype[Ve[r]];return Ki()};se[qi]=!0;var Qi=Object.create||function(t,e){var r;return null!==t?(Zi.prototype=kt(t),r=new Zi,Zi.prototype=null,r[qi]=t):r=Ki(),void 0===e?r:Vi.f(r,e)},Xi=qt.f,Ji=vt("unscopables"),ta=Array.prototype;null==ta[Ji]&&Xi(ta,Ji,{configurable:!0,value:Qi(null)});var ea,ra,na,oa=function(t){ta[Ji][t]=!0},ia=!j((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),aa=ue("IE_PROTO"),ua=Object,sa=ua.prototype,ca=ia?ua.getPrototypeOf:function(t){var e=G(t);if(V(e,aa))return e[aa];var r=e.constructor;return J(r)&&e instanceof r?r.prototype:e instanceof ua?sa:null},fa=vt("iterator"),la=!1;[].keys&&("next"in(na=[].keys())?(ra=ca(ca(na)))!==Object.prototype&&(ea=ra):la=!0),(!xt(ea)||j((function(){var t={};return ea[fa].call(t)!==t})))&&(ea={}),J(ea[fa])||de(ea,fa,(function(){return this}));var ha={IteratorPrototype:ea,BUGGY_SAFARI_ITERATORS:la},pa=ha.IteratorPrototype,va=function(){return this},da=Kt.PROPER,ya=Kt.CONFIGURABLE,ga=ha.IteratorPrototype,ma=ha.BUGGY_SAFARI_ITERATORS,xa=vt("iterator"),ba=function(){return this},wa=function(t,e,r,n,o,i,a){!function(t,e,r,n){var o=e+" Iterator";t.prototype=Qi(pa,{next:oe(+!n,r)}),pr(t,o,!1),po[o]=va}(r,e,n);var u,s,c,f=function(t){if(t===o&&d)return d;if(!ma&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},l=e+" Iterator",h=!1,p=t.prototype,v=p[xa]||p["@@iterator"]||o&&p[o],d=!ma&&v||f(o),y="Array"==e&&p.entries||v;if(y&&(u=ca(y.call(new t)))!==Object.prototype&&u.next&&(ca(u)!==ga&&(fr?fr(u,ga):J(u[xa])||de(u,xa,ba)),pr(u,l,!0)),da&&"values"==o&&v&&"values"!==v.name&&(ya?ie(p,"name","values"):(h=!0,d=function(){return jt(v,this)})),o)if(s={values:f("values"),keys:i?d:f("keys"),entries:f("entries")},a)for(c in s)(ma||h||!(c in p))&&de(p,c,s[c]);else ar({target:e,proto:!0,forced:ma||h},s);return p[xa]!==d&&de(p,xa,d,{name:o}),po[e]=d,s},Ea=function(t,e){return{value:t,done:e}},Aa=qt.f,Oa=pe.set,Sa=pe.getterFor("Array Iterator"),Ta=wa(Array,"Array",(function(t,e){Oa(this,{type:"Array Iterator",target:ke(t),index:0,kind:e})}),(function(){var t=Sa(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,Ea(void 0,!0)):Ea("keys"==r?n:"values"==r?e[n]:[n,e[n]],!1)}),"values"),ka=po.Arguments=po.Array;if(oa("keys"),oa("values"),oa("entries"),gt&&"values"!==ka.name)try{Aa(ka,"name",{value:"values"})}catch(t){}var Ia,ja,Pa,_a="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Ma=qt.f,La=pe.enforce,Ra=pe.get,Ca=O.Int8Array,Na=Ca&&Ca.prototype,Da=O.Uint8ClampedArray,Fa=Da&&Da.prototype,Wa=Ca&&ca(Ca),za=Na&&ca(Na),Ba=Object.prototype,Ua=O.TypeError,Ga=vt("toStringTag"),Ha=$("TYPED_ARRAY_TAG"),Va=_a&&!!fr&&"Opera"!==xe(O.opera),qa=!1,Za={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ya={BigInt64Array:8,BigUint64Array:8},$a=function(t){var e=ca(t);if(xt(e)){var r=Ra(e);return r&&V(r,"TypedArrayConstructor")?r.TypedArrayConstructor:$a(e)}},Ka=function(t){if(!xt(t))return!1;var e=xe(t);return V(Za,e)||V(Ya,e)};for(Ia in Za)(Pa=(ja=O[Ia])&&ja.prototype)?La(Pa).TypedArrayConstructor=ja:Va=!1;for(Ia in Ya)(Pa=(ja=O[Ia])&&ja.prototype)&&(La(Pa).TypedArrayConstructor=ja);if((!Va||!J(Wa)||Wa===Function.prototype)&&(Wa=function(){throw Ua("Incorrect invocation")},Va))for(Ia in Za)O[Ia]&&fr(O[Ia],Wa);if((!Va||!za||za===Ba)&&(za=Wa.prototype,Va))for(Ia in Za)O[Ia]&&fr(O[Ia].prototype,za);if(Va&&ca(Fa)!==za&&fr(Fa,za),gt&&!V(za,Ga))for(Ia in qa=!0,Ma(za,Ga,{get:function(){return xt(this)?this[Ha]:void 0}}),Za)O[Ia]&&ie(O[Ia],Ha,Ia);var Qa={NATIVE_ARRAY_BUFFER_VIEWS:Va,TYPED_ARRAY_TAG:qa&&Ha,aTypedArray:function(t){if(Ka(t))return t;throw Ua("Target is not a typed array")},aTypedArrayConstructor:function(t){if(J(t)&&(!fr||Pt(Wa,t)))return t;throw Ua(Rt(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(gt){if(r)for(var o in Za){var i=O[o];if(i&&V(i.prototype,t))try{delete i.prototype[t]}catch(r){try{i.prototype[t]=e}catch(t){}}}za[t]&&!r||de(za,t,r?e:Va&&Na[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(gt){if(fr){if(r)for(n in Za)if((o=O[n])&&V(o,t))try{delete o[t]}catch(t){}if(Wa[t]&&!r)return;try{return de(Wa,t,r?e:Va&&Wa[t]||e)}catch(t){}}for(n in Za)!(o=O[n])||o[t]&&!r||de(o,t,e)}},getTypedArrayConstructor:$a,isView:function(t){if(!xt(t))return!1;var e=xe(t);return"DataView"===e||V(Za,e)||V(Ya,e)},isTypedArray:Ka,TypedArray:Wa,TypedArrayPrototype:za},Xa=Qa.NATIVE_ARRAY_BUFFER_VIEWS,Ja=O.ArrayBuffer,tu=O.Int8Array,eu=!Xa||!j((function(){tu(1)}))||!j((function(){new tu(-1)}))||!_o((function(t){new tu,new tu(null),new tu(1.5),new tu(t)}),!0)||j((function(){return 1!==new tu(new Ja(2),1,void 0).length})),ru=function(t,e,r){for(var n in e)de(t,n,e[n],r);return t},nu=RangeError,ou=function(t){if(void 0===t)return 0;var e=Le(t),r=Fe(e);if(e!==r)throw nu("Wrong length or index");return r},iu=Array,au=Math.abs,uu=Math.pow,su=Math.floor,cu=Math.log,fu=Math.LN2,lu=function(t,e,r){var n,o,i,a=iu(r),u=8*r-e-1,s=(1<<u)-1,c=s>>1,f=23===e?uu(2,-24)-uu(2,-77):0,l=t<0||0===t&&1/t<0?1:0,h=0;for((t=au(t))!=t||t===1/0?(o=t!=t?1:0,n=s):(n=su(cu(t)/fu),t*(i=uu(2,-n))<1&&(n--,i*=2),(t+=n+c>=1?f/i:f*uu(2,1-c))*i>=2&&(n++,i/=2),n+c>=s?(o=0,n=s):n+c>=1?(o=(t*i-1)*uu(2,e),n+=c):(o=t*uu(2,c-1)*uu(2,e),n=0));e>=8;)a[h++]=255&o,o/=256,e-=8;for(n=n<<e|o,u+=e;u>0;)a[h++]=255&n,n/=256,u-=8;return a[--h]|=128*l,a},hu=function(t,e){var r,n=t.length,o=8*n-e-1,i=(1<<o)-1,a=i>>1,u=o-7,s=n-1,c=t[s--],f=127&c;for(c>>=7;u>0;)f=256*f+t[s--],u-=8;for(r=f&(1<<-u)-1,f>>=-u,u+=e;u>0;)r=256*r+t[s--],u-=8;if(0===f)f=1-a;else{if(f===i)return r?NaN:c?-1/0:1/0;r+=uu(2,e),f-=a}return(c?-1:1)*r*uu(2,f-e)},pu=function(t){for(var e=G(this),r=We(e),n=arguments.length,o=Ne(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:Ne(i,r);a>o;)e[o++]=t;return e},vu=Array,du=Math.max,yu=function(t,e,r){for(var n=We(t),o=Ne(e,n),i=Ne(void 0===r?n:r,n),a=vu(du(i-o,0)),u=0;o<i;o++,u++)Ii(a,u,t[o]);return a.length=u,a},gu=Ze.f,mu=qt.f,xu=Kt.PROPER,bu=Kt.CONFIGURABLE,wu=pe.get,Eu=pe.set,Au=O.ArrayBuffer,Ou=Au,Su=Ou&&Ou.prototype,Tu=O.DataView,ku=Tu&&Tu.prototype,Iu=Object.prototype,ju=O.Array,Pu=O.RangeError,_u=F(pu),Mu=F([].reverse),Lu=lu,Ru=hu,Cu=function(t){return[255&t]},Nu=function(t){return[255&t,t>>8&255]},Du=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},Fu=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Wu=function(t){return Lu(t,23,4)},zu=function(t){return Lu(t,52,8)},Bu=function(t,e){mu(t.prototype,e,{get:function(){return wu(this)[e]}})},Uu=function(t,e,r,n){var o=ou(r),i=wu(t);if(o+e>i.byteLength)throw Pu("Wrong index");var a=wu(i.buffer).bytes,u=o+i.byteOffset,s=yu(a,u,u+e);return n?s:Mu(s)},Gu=function(t,e,r,n,o,i){var a=ou(r),u=wu(t);if(a+e>u.byteLength)throw Pu("Wrong index");for(var s=wu(u.buffer).bytes,c=a+u.byteOffset,f=n(+o),l=0;l<e;l++)s[c+l]=f[i?l:e-l-1]};if(_a){var Hu=xu&&"ArrayBuffer"!==Au.name;if(j((function(){Au(1)}))&&j((function(){new Au(-1)}))&&!j((function(){return new Au,new Au(1.5),new Au(NaN),1!=Au.length||Hu&&!bu})))Hu&&bu&&ie(Au,"name","ArrayBuffer");else{(Ou=function(t){return gr(this,Su),new Au(ou(t))}).prototype=Su;for(var Vu,qu=gu(Au),Zu=0;qu.length>Zu;)(Vu=qu[Zu++])in Ou||ie(Ou,Vu,Au[Vu]);Su.constructor=Ou}fr&&ca(ku)!==Iu&&fr(ku,Iu);var Yu=new Tu(new Ou(2)),$u=F(ku.setInt8);Yu.setInt8(0,2147483648),Yu.setInt8(1,2147483649),!Yu.getInt8(0)&&Yu.getInt8(1)||ru(ku,{setInt8:function(t,e){$u(this,t,e<<24>>24)},setUint8:function(t,e){$u(this,t,e<<24>>24)}},{unsafe:!0})}else Su=(Ou=function(t){gr(this,Su);var e=ou(t);Eu(this,{bytes:_u(ju(e),0),byteLength:e}),gt||(this.byteLength=e)}).prototype,ku=(Tu=function(t,e,r){gr(this,ku),gr(t,Su);var n=wu(t).byteLength,o=Le(e);if(o<0||o>n)throw Pu("Wrong offset");if(o+(r=void 0===r?n-o:Fe(r))>n)throw Pu("Wrong length");Eu(this,{buffer:t,byteLength:r,byteOffset:o}),gt||(this.buffer=t,this.byteLength=r,this.byteOffset=o)}).prototype,gt&&(Bu(Ou,"byteLength"),Bu(Tu,"buffer"),Bu(Tu,"byteLength"),Bu(Tu,"byteOffset")),ru(ku,{getInt8:function(t){return Uu(this,1,t)[0]<<24>>24},getUint8:function(t){return Uu(this,1,t)[0]},getInt16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return Ru(Uu(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return Ru(Uu(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Gu(this,1,t,Cu,e)},setUint8:function(t,e){Gu(this,1,t,Cu,e)},setInt16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Gu(this,4,t,Wu,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Gu(this,8,t,zu,e,arguments.length>2?arguments[2]:void 0)}});pr(Ou,"ArrayBuffer"),pr(Tu,"DataView");var Ku={ArrayBuffer:Ou,DataView:Tu},Qu=Math.floor,Xu=Number.isInteger||function(t){return!xt(t)&&isFinite(t)&&Qu(t)===t},Ju=RangeError,ts=RangeError,es=function(t,e){var r=function(t){var e=Le(t);if(e<0)throw Ju("The argument can't be less than 0");return e}(t);if(r%e)throw ts("Wrong offset");return r},rs=F("".slice),ns=function(t){return"Big"===rs(xe(t),0,3)},os=TypeError,is=function(t){var e=Bt(t,"number");if("number"==typeof e)throw os("Can't convert number to bigint");return BigInt(e)},as=Qa.aTypedArrayConstructor,us=function(t){var e,r,n,o,i,a,u,s,c=Mr(this),f=G(t),l=arguments.length,h=l>1?arguments[1]:void 0,p=void 0!==h,v=xo(f);if(v&&!go(v))for(s=(u=wo(f,v)).next,f=[];!(a=jt(s,u)).done;)f.push(a.value);for(p&&l>2&&(h=zr(h,arguments[2])),r=We(f),n=new(as(c))(r),o=ns(n),e=0;r>e;e++)i=p?h(f[e],e):f[e],n[e]=o?is(i):+i;return n},ss=function(t,e,r){var n,o;return fr&&J(n=e.constructor)&&n!==r&&xt(o=n.prototype)&&o!==r.prototype&&fr(t,o),t},cs=b((function(t){var e=Ze.f,r=Ei.forEach,n=pe.get,o=pe.set,i=pe.enforce,a=qt.f,u=je.f,s=Math.round,c=O.RangeError,f=Ku.ArrayBuffer,l=f.prototype,h=Ku.DataView,p=Qa.NATIVE_ARRAY_BUFFER_VIEWS,v=Qa.TYPED_ARRAY_TAG,d=Qa.TypedArray,y=Qa.TypedArrayPrototype,g=Qa.aTypedArrayConstructor,m=Qa.isTypedArray,x=function(t,e){g(t);for(var r=0,n=e.length,o=new t(n);n>r;)o[r]=e[r++];return o},b=function(t,e){a(t,e,{get:function(){return n(this)[e]}})},w=function(t){var e;return Pt(l,t)||"ArrayBuffer"==(e=xe(t))||"SharedArrayBuffer"==e},E=function(t,e){return m(t)&&!Mt(e)&&e in t&&Xu(+e)&&e>=0},A=function(t,e){return e=Ut(e),E(t,e)?oe(2,t[e]):u(t,e)},S=function(t,e,r){return e=Ut(e),!(E(t,e)&&xt(r)&&V(r,"value"))||V(r,"get")||V(r,"set")||r.configurable||V(r,"writable")&&!r.writable||V(r,"enumerable")&&!r.enumerable?a(t,e,r):(t[e]=r.value,t)};gt?(p||(je.f=A,qt.f=S,b(y,"buffer"),b(y,"byteOffset"),b(y,"byteLength"),b(y,"length")),ar({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:A,defineProperty:S}),t.exports=function(t,u,l){var g=t.match(/\\d+$/)[0]/8,b=t+(l?"Clamped":"")+"Array",E="get"+t,A="set"+t,S=O[b],T=S,k=T&&T.prototype,I={},j=function(t,e){a(t,e,{get:function(){return function(t,e){var r=n(t);return r.view[E](e*g+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var o=n(t);l&&(r=(r=s(r))<0?0:r>255?255:255&r),o.view[A](e*g+o.byteOffset,r,!0)}(this,e,t)},enumerable:!0})};p?eu&&(T=u((function(t,e,r,n){return gr(t,k),ss(xt(e)?w(e)?void 0!==n?new S(e,es(r,g),n):void 0!==r?new S(e,es(r,g)):new S(e):m(e)?x(T,e):jt(us,T,e):new S(ou(e)),t,T)})),fr&&fr(T,d),r(e(S),(function(t){t in T||ie(T,t,S[t])})),T.prototype=k):(T=u((function(t,e,r,n){gr(t,k);var i,a,u,s=0,l=0;if(xt(e)){if(!w(e))return m(e)?x(T,e):jt(us,T,e);i=e,l=es(r,g);var p=e.byteLength;if(void 0===n){if(p%g)throw c("Wrong length");if((a=p-l)<0)throw c("Wrong length")}else if((a=Fe(n)*g)+l>p)throw c("Wrong length");u=a/g}else u=ou(e),i=new f(a=u*g);for(o(t,{buffer:i,byteOffset:l,byteLength:a,length:u,view:new h(i)});s<u;)j(t,s++)})),fr&&fr(T,d),k=T.prototype=Qi(y)),k.constructor!==T&&ie(k,"constructor",T),i(k).TypedArrayConstructor=T,v&&ie(k,v,b);var P=T!=S;I[b]=T,ar({global:!0,constructor:!0,forced:P,sham:!p},I),"BYTES_PER_ELEMENT"in T||ie(T,"BYTES_PER_ELEMENT",g),"BYTES_PER_ELEMENT"in k||ie(k,"BYTES_PER_ELEMENT",g),dr(b)}):t.exports=function(){}}));cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0);var fs=TypeError,ls=function(t,e){if(!delete t[e])throw fs("Cannot delete property "+Rt(e)+" of "+Rt(t))},hs=Math.min,ps=F([].copyWithin||function(t,e){var r=G(this),n=We(r),o=Ne(t,n),i=Ne(e,n),a=arguments.length>2?arguments[2]:void 0,u=hs((void 0===a?n:Ne(a,n))-i,n-o),s=1;for(i<o&&o<i+u&&(s=-1,i+=u-1,o+=u-1);u-- >0;)i in r?r[o]=r[i]:ls(r,o),o+=s,i+=s;return r}),vs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("copyWithin",(function(t,e){return ps(vs(this),t,e,arguments.length>2?arguments[2]:void 0)}));var ds=Ei.every,ys=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("every",(function(t){return ds(ys(this),t,arguments.length>1?arguments[1]:void 0)}));var gs=Qa.aTypedArray,ms=Qa.exportTypedArrayMethod,xs=F("".slice);ms("fill",(function(t){var e=arguments.length;gs(this);var r="Big"===xs(xe(this),0,3)?is(t):+t;return jt(pu,this,r,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),j((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var bs=Qa.aTypedArrayConstructor,ws=Qa.getTypedArrayConstructor,Es=function(t){return bs(Rr(t,ws(t)))},As=function(t,e){return function(t,e){for(var r=0,n=We(e),o=new t(n);n>r;)o[r]=e[r++];return o}(Es(t),e)},Os=Ei.filter,Ss=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("filter",(function(t){var e=Os(Ss(this),t,arguments.length>1?arguments[1]:void 0);return As(this,e)}));var Ts=Ei.find,ks=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("find",(function(t){return Ts(ks(this),t,arguments.length>1?arguments[1]:void 0)}));var Is=Ei.findIndex,js=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("findIndex",(function(t){return Is(js(this),t,arguments.length>1?arguments[1]:void 0)}));var Ps=Ei.forEach,_s=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("forEach",(function(t){Ps(_s(this),t,arguments.length>1?arguments[1]:void 0)}));var Ms=Be.includes,Ls=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("includes",(function(t){return Ms(Ls(this),t,arguments.length>1?arguments[1]:void 0)}));var Rs=Be.indexOf,Cs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("indexOf",(function(t){return Rs(Cs(this),t,arguments.length>1?arguments[1]:void 0)}));var Ns=vt("iterator"),Ds=O.Uint8Array,Fs=F(Ta.values),Ws=F(Ta.keys),zs=F(Ta.entries),Bs=Qa.aTypedArray,Us=Qa.exportTypedArrayMethod,Gs=Ds&&Ds.prototype,Hs=!j((function(){Gs[Ns].call([1])})),Vs=!!Gs&&Gs.values&&Gs[Ns]===Gs.values&&"values"===Gs.values.name,qs=function(){return Fs(Bs(this))};Us("entries",(function(){return zs(Bs(this))}),Hs),Us("keys",(function(){return Ws(Bs(this))}),Hs),Us("values",qs,Hs||!Vs,{name:"values"}),Us(Ns,qs,Hs||!Vs,{name:"values"});var Zs=Qa.aTypedArray,Ys=Qa.exportTypedArrayMethod,$s=F([].join);Ys("join",(function(t){return $s(Zs(this),t)}));var Ks=Math.min,Qs=[].lastIndexOf,Xs=!!Qs&&1/[1].lastIndexOf(1,-0)<0,Js=Ai("lastIndexOf"),tc=Xs||!Js?function(t){if(Xs)return Fr(Qs,this,arguments)||0;var e=ke(this),r=We(e),n=r-1;for(arguments.length>1&&(n=Ks(n,Le(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:Qs,ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("lastIndexOf",(function(t){var e=arguments.length;return Fr(tc,ec(this),e>1?[t,arguments[1]]:[t])}));var rc=Ei.map,nc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("map",(function(t){return rc(nc(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(Es(t))(e)}))}));var oc=TypeError,ic=function(t){return function(e,r,n,o){Nt(r);var i=G(e),a=Te(i),u=We(i),s=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=c;break}if(s+=c,t?s<0:u<=s)throw oc("Reduce of empty array with no initial value")}for(;t?s>=0:u>s;s+=c)s in a&&(o=r(o,a[s],s,i));return o}},ac={left:ic(!1),right:ic(!0)},uc=ac.left,sc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduce",(function(t){var e=arguments.length;return uc(sc(this),t,e,e>1?arguments[1]:void 0)}));var cc=ac.right,fc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduceRight",(function(t){var e=arguments.length;return cc(fc(this),t,e,e>1?arguments[1]:void 0)}));var lc=Qa.aTypedArray,hc=Qa.exportTypedArrayMethod,pc=Math.floor;hc("reverse",(function(){for(var t,e=lc(this).length,r=pc(e/2),n=0;n<r;)t=this[n],this[n++]=this[--e],this[e]=t;return this}));var vc=O.RangeError,dc=O.Int8Array,yc=dc&&dc.prototype,gc=yc&&yc.set,mc=Qa.aTypedArray,xc=Qa.exportTypedArrayMethod,bc=!j((function(){var t=new Uint8ClampedArray(2);return jt(gc,t,{length:1,0:3},1),3!==t[1]})),wc=bc&&Qa.NATIVE_ARRAY_BUFFER_VIEWS&&j((function(){var t=new dc(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));xc("set",(function(t){mc(this);var e=es(arguments.length>1?arguments[1]:void 0,1),r=G(t);if(bc)return jt(gc,this,r,e);var n=this.length,o=We(r),i=0;if(o+e>n)throw vc("Wrong length");for(;i<o;)this[e+i]=r[i++]}),!bc||wc);var Ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("slice",(function(t,e){for(var r=Ur(Ec(this),t,e),n=Es(this),o=0,i=r.length,a=new n(i);i>o;)a[o]=r[o++];return a}),j((function(){new Int8Array(1).slice()})));var Ac=Ei.some,Oc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("some",(function(t){return Ac(Oc(this),t,arguments.length>1?arguments[1]:void 0)}));var Sc=Math.floor,Tc=function(t,e){var r=t.length,n=Sc(r/2);return r<8?kc(t,e):Ic(t,Tc(yu(t,0,n),e),Tc(yu(t,n),e),e)},kc=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},Ic=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,u=0;a<o||u<i;)t[a+u]=a<o&&u<i?n(e[a],r[u])<=0?e[a++]:r[u++]:a<o?e[a++]:r[u++];return t},jc=Tc,Pc=rt.match(/firefox\\/(\\d+)/i),_c=!!Pc&&+Pc[1],Mc=/MSIE|Trident/.test(rt),Lc=rt.match(/AppleWebKit\\/(\\d+)\\./),Rc=!!Lc&&+Lc[1],Cc=Qa.aTypedArray,Nc=Qa.exportTypedArrayMethod,Dc=O.Uint16Array,Fc=Dc&&F(Dc.prototype.sort),Wc=!(!Fc||j((function(){Fc(new Dc(2),null)}))&&j((function(){Fc(new Dc(2),{})}))),zc=!!Fc&&!j((function(){if(ut)return ut<74;if(_c)return _c<67;if(Mc)return!0;if(Rc)return Rc<602;var t,e,r=new Dc(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(Fc(r,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0}));Nc("sort",(function(t){return void 0!==t&&Nt(t),zc?Fc(this,t):jc(Cc(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))}),!zc||Wc);var Bc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("subarray",(function(t,e){var r=Bc(this),n=r.length,o=Ne(t,n);return new(Es(r))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,Fe((void 0===e?n:Ne(e,n))-o))}));var Uc=O.Int8Array,Gc=Qa.aTypedArray,Hc=Qa.exportTypedArrayMethod,Vc=[].toLocaleString,qc=!!Uc&&j((function(){Vc.call(new Uc(1))}));Hc("toLocaleString",(function(){return Fr(Vc,qc?Ur(Gc(this)):Gc(this),Ur(arguments))}),j((function(){return[1,2].toLocaleString()!=new Uc([1,2]).toLocaleString()}))||!j((function(){Uc.prototype.toLocaleString.call([1,2])})));var Zc=Qa.exportTypedArrayMethod,Yc=O.Uint8Array,$c=Yc&&Yc.prototype||{},Kc=[].toString,Qc=F([].join);j((function(){Kc.call({})}))&&(Kc=function(){return Qc(this)});var Xc=$c.toString!=Kc;Zc("toString",Kc,Xc);var Jc,tf,ef=String,rf=function(t){if("Symbol"===xe(t))throw TypeError("Cannot convert a Symbol value to a string");return ef(t)},nf=function(){var t=kt(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},of=O.RegExp,af=j((function(){var t=of("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),uf=af||j((function(){return!of("a","y").sticky})),sf={BROKEN_CARET:af||j((function(){var t=of("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:uf,UNSUPPORTED_Y:af},cf=O.RegExp,ff=j((function(){var t=cf(".","s");return!(t.dotAll&&t.exec("\\n")&&"s"===t.flags)})),lf=O.RegExp,hf=j((function(){var t=lf("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),pf=pe.get,vf=I("native-string-replace",String.prototype.replace),df=RegExp.prototype.exec,yf=df,gf=F("".charAt),mf=F("".indexOf),xf=F("".replace),bf=F("".slice),wf=(tf=/b*/g,jt(df,Jc=/a/,"a"),jt(df,tf,"a"),0!==Jc.lastIndex||0!==tf.lastIndex),Ef=sf.BROKEN_CARET,Af=void 0!==/()??/.exec("")[1];(wf||Af||Ef||ff||hf)&&(yf=function(t){var e,r,n,o,i,a,u,s=this,c=pf(s),f=rf(t),l=c.raw;if(l)return l.lastIndex=s.lastIndex,e=jt(yf,l,f),s.lastIndex=l.lastIndex,e;var h=c.groups,p=Ef&&s.sticky,v=jt(nf,s),d=s.source,y=0,g=f;if(p&&(v=xf(v,"y",""),-1===mf(v,"g")&&(v+="g"),g=bf(f,s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\\n"!==gf(f,s.lastIndex-1))&&(d="(?: "+d+")",g=" "+g,y++),r=new RegExp("^(?:"+d+")",v)),Af&&(r=new RegExp("^"+d+"$(?!\\\\s)",v)),wf&&(n=s.lastIndex),o=jt(df,p?r:s,g),p?o?(o.input=bf(o.input,y),o[0]=bf(o[0],y),o.index=s.lastIndex,s.lastIndex+=o[0].length):s.lastIndex=0:wf&&o&&(s.lastIndex=s.global?o.index+o[0].length:n),Af&&o&&o.length>1&&jt(vf,o[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&h)for(o.groups=a=Qi(null),i=0;i<h.length;i++)a[(u=h[i])[0]]=o[u[1]];return o});var Of=yf;ar({target:"RegExp",proto:!0,forced:/./.exec!==Of},{exec:Of});var Sf,Tf=vt("species"),kf=RegExp.prototype,If=function(t,e,r,n){var o=vt(t),i=!j((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),a=i&&!j((function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[Tf]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return e=!0,null},r[o](""),!e}));if(!i||!a||r){var u=F(/./[o]),s=e(o,""[t],(function(t,e,r,n,o){var a=F(t),s=e.exec;return s===Of||s===kf.exec?i&&!o?{done:!0,value:u(e,r,n)}:{done:!0,value:a(r,e,n)}:{done:!1}}));de(String.prototype,t,s[0]),de(kf,o,s[1])}n&&ie(kf[o],"sham",!0)},jf=F("".charAt),Pf=F("".charCodeAt),_f=F("".slice),Mf=function(t){return function(e,r){var n,o,i=rf(B(e)),a=Le(r),u=i.length;return a<0||a>=u?t?"":void 0:(n=Pf(i,a))<55296||n>56319||a+1===u||(o=Pf(i,a+1))<56320||o>57343?t?jf(i,a):n:t?_f(i,a,a+2):o-56320+(n-55296<<10)+65536}},Lf={codeAt:Mf(!1),charAt:Mf(!0)},Rf=Lf.charAt,Cf=function(t,e,r){return e+(r?Rf(t,e).length:1)},Nf=Math.floor,Df=F("".charAt),Ff=F("".replace),Wf=F("".slice),zf=/\\$([$&'\`]|\\d{1,2}|<[^>]*>)/g,Bf=/\\$([$&'\`]|\\d{1,2})/g,Uf=function(t,e,r,n,o,i){var a=r+t.length,u=n.length,s=Bf;return void 0!==o&&(o=G(o),s=zf),Ff(i,s,(function(i,s){var c;switch(Df(s,0)){case"$":return"$";case"&":return t;case"\`":return Wf(e,0,r);case"'":return Wf(e,a);case"<":c=o[Wf(s,1,-1)];break;default:var f=+s;if(0===f)return i;if(f>u){var l=Nf(f/10);return 0===l?i:l<=u?void 0===n[l-1]?Df(s,1):n[l-1]+Df(s,1):i}c=n[f-1]}return void 0===c?"":c}))},Gf=TypeError,Hf=function(t,e){var r=t.exec;if(J(r)){var n=jt(r,t,e);return null!==n&&kt(n),n}if("RegExp"===D(t))return jt(Of,t,e);throw Gf("RegExp#exec called on incompatible receiver")},Vf=vt("replace"),qf=Math.max,Zf=Math.min,Yf=F([].concat),$f=F([].push),Kf=F("".indexOf),Qf=F("".slice),Xf="$0"==="a".replace(/./,"$0"),Jf=!!/./[Vf]&&""===/./[Vf]("a","$0");function tl(t){this.message=t}If("replace",(function(t,e,r){var n=Jf?"$":"$0";return[function(t,r){var n=B(this),o=W(t)?void 0:Dt(t,Vf);return o?jt(o,t,n,r):jt(e,rf(n),t,r)},function(t,o){var i=kt(this),a=rf(t);if("string"==typeof o&&-1===Kf(o,n)&&-1===Kf(o,"$<")){var u=r(e,i,a,o);if(u.done)return u.value}var s=J(o);s||(o=rf(o));var c=i.global;if(c){var f=i.unicode;i.lastIndex=0}for(var l=[];;){var h=Hf(i,a);if(null===h)break;if($f(l,h),!c)break;""===rf(h[0])&&(i.lastIndex=Cf(a,Fe(i.lastIndex),f))}for(var p,v="",d=0,y=0;y<l.length;y++){for(var g=rf((h=l[y])[0]),m=qf(Zf(Le(h.index),a.length),0),x=[],b=1;b<h.length;b++)$f(x,void 0===(p=h[b])?p:String(p));var w=h.groups;if(s){var E=Yf([g],x,m,a);void 0!==w&&$f(E,w);var A=rf(Fr(o,void 0,E))}else A=Uf(g,a,m,x,w,o);m>=d&&(v+=Qf(a,d,m)+A,d=m+g.length)}return v+Qf(a,d)}]}),!!j((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!Xf||Jf),tl.prototype=new Error,tl.prototype.name="InvalidCharacterError",ar({global:!0,forced:O.globalThis!==O},{globalThis:O}),Sf="undefined"==typeof window?{devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(t){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,e,r){return{duration:0}},now:function(){return(new Date).getTime()}},Blob:"",dispatchEvent:function(t){return!0},Event:function(t,e){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:window,"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM?my.getSystemInfoSync().pixelRatio:Sf.devicePixelRatio;var el=TypeError,rl=Object.getOwnPropertyDescriptor,nl=gt&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(yi(t)&&!rl(t,"length").writable)throw el("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},ol=TypeError,il=function(t){if(t>9007199254740991)throw ol("Maximum allowed index exceeded");return t},al=Pi("splice"),ul=Math.max,sl=Math.min;ar({target:"Array",proto:!0,forced:!al},{splice:function(t,e){var r,n,o,i,a,u,s=G(this),c=We(s),f=Ne(t,c),l=arguments.length;for(0===l?r=n=0:1===l?(r=0,n=c-f):(r=l-2,n=sl(ul(Le(e),0),c-f)),il(c+r-n),o=xi(s,n),i=0;i<n;i++)(a=f+i)in s&&Ii(o,i,s[a]);if(o.length=n,r<n){for(i=f;i<c-n;i++)u=i+r,(a=i+n)in s?s[u]=s[a]:ls(s,u);for(i=c;i>c-n+r;i--)ls(s,i-1)}else if(r>n)for(i=c-n;i>f;i--)u=i+r-1,(a=i+n-1)in s?s[u]=s[a]:ls(s,u);for(i=0;i<r;i++)s[i+f]=arguments[i+2];return nl(s,c-n+r),o}});var cl=u((function t(e,r){i(this,t),s(this,"cancelBubble",void 0),s(this,"cancelable",void 0),s(this,"target",void 0),s(this,"currentTarget",void 0),s(this,"preventDefault",void 0),s(this,"stopPropagation",void 0),s(this,"type",void 0),s(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=e,this.timeStamp=Date.now()})),fl=Object.assign,ll=Object.defineProperty,hl=F([].concat),pl=!fl||j((function(){if(gt&&1!==fl({b:1},fl(ll({},"a",{enumerable:!0,get:function(){ll(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=fl({},t)[r]||"abcdefghijklmnopqrst"!=Hi(fl({},e)).join("")}))?function(t,e){for(var r=G(t),n=arguments.length,o=1,i=Ye.f,a=Ae.f;n>o;)for(var u,s=Te(arguments[o++]),c=i?hl(Hi(s),i(s)):Hi(s),f=c.length,l=0;f>l;)u=c[l++],gt&&!jt(a,s,u)||(r[u]=s[u]);return r}:fl;ar({target:"Object",stat:!0,arity:2,forced:Object.assign!==pl},{assign:pl});var vl=Ei.findIndex,dl=!0;"findIndex"in[]&&Array(1).findIndex((function(){dl=!1})),ar({target:"Array",proto:!0,forced:dl},{findIndex:function(t){return vl(this,t,arguments.length>1?arguments[1]:void 0)}}),oa("findIndex");var yl=Lf.charAt,gl=pe.set,ml=pe.getterFor("String Iterator");wa(String,"String",(function(t){gl(this,{type:"String Iterator",string:rf(t),index:0})}),(function(){var t,e=ml(this),r=e.string,n=e.index;return n>=r.length?Ea(void 0,!0):(t=yl(r,n),e.index+=t.length,Ea(t,!1))}));var xl=Ze.f,bl="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],wl={f:function(t){return bl&&"Window"==D(t)?function(t){try{return xl(t)}catch(t){return yu(bl)}}(t):xl(ke(t))}},El=j((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Al=Object.isExtensible,Ol=j((function(){Al(1)}))||El?function(t){return!!xt(t)&&((!El||"ArrayBuffer"!=D(t))&&(!Al||Al(t)))}:Al,Sl=!j((function(){return Object.isExtensible(Object.preventExtensions({}))})),Tl=b((function(t){var e=qt.f,r=!1,n=$("meta"),o=0,i=function(t){e(t,n,{value:{objectID:"O"+o++,weakData:{}}})},a=t.exports={enable:function(){a.enable=function(){},r=!0;var t=Ze.f,e=F([].splice),o={};o[n]=1,t(o).length&&(Ze.f=function(r){for(var o=t(r),i=0,a=o.length;i<a;i++)if(o[i]===n){e(o,i,1);break}return o},ar({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:wl.f}))},fastKey:function(t,e){if(!xt(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!V(t,n)){if(!Ol(t))return"F";if(!e)return"E";i(t)}return t[n].objectID},getWeakData:function(t,e){if(!V(t,n)){if(!Ol(t))return!0;if(!e)return!1;i(t)}return t[n].weakData},onFreeze:function(t){return Sl&&r&&Ol(t)&&!V(t,n)&&i(t),t}};se[n]=!0})),kl=(Tl.enable,Tl.fastKey,Tl.getWeakData,Tl.onFreeze,function(t,e,r){var n=-1!==t.indexOf("Map"),o=-1!==t.indexOf("Weak"),i=n?"set":"add",a=O[t],u=a&&a.prototype,s=a,c={},f=function(t){var e=F(u[t]);de(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(o&&!xt(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return o&&!xt(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(o&&!xt(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(or(t,!J(a)||!(o||u.forEach&&!j((function(){(new a).entries().next()})))))s=r.getConstructor(e,t,n,i),Tl.enable();else if(or(t,!0)){var l=new s,h=l[i](o?{}:-0,1)!=l,p=j((function(){l.has(1)})),v=_o((function(t){new a(t)})),d=!o&&j((function(){for(var t=new a,e=5;e--;)t[i](e,e);return!t.has(-0)}));v||((s=e((function(t,e){gr(t,u);var r=ss(new a,t,s);return W(e)||To(e,r[i],{that:r,AS_ENTRIES:n}),r}))).prototype=u,u.constructor=s),(p||d)&&(f("delete"),f("has"),n&&f("get")),(d||h)&&f(i),o&&u.clear&&delete u.clear}return c[t]=s,ar({global:!0,constructor:!0,forced:s!=a},c),pr(s,t),o||r.setStrong(s,t,n),s}),Il=Tl.getWeakData,jl=pe.set,Pl=pe.getterFor,_l=Ei.find,Ml=Ei.findIndex,Ll=F([].splice),Rl=0,Cl=function(t){return t.frozen||(t.frozen=new Nl)},Nl=function(){this.entries=[]},Dl=function(t,e){return _l(t.entries,(function(t){return t[0]===e}))};Nl.prototype={get:function(t){var e=Dl(this,t);if(e)return e[1]},has:function(t){return!!Dl(this,t)},set:function(t,e){var r=Dl(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=Ml(this.entries,(function(e){return e[0]===t}));return~e&&Ll(this.entries,e,1),!!~e}};var Fl,Wl={getConstructor:function(t,e,r,n){var o=t((function(t,o){gr(t,i),jl(t,{type:e,id:Rl++,frozen:void 0}),W(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Pl(e),u=function(t,e,r){var n=a(t),o=Il(kt(e),!0);return!0===o?Cl(n).set(e,r):o[n.id]=r,t};return ru(i,{delete:function(t){var e=a(this);if(!xt(t))return!1;var r=Il(t);return!0===r?Cl(e).delete(t):r&&V(r,e.id)&&delete r[e.id]},has:function(t){var e=a(this);if(!xt(t))return!1;var r=Il(t);return!0===r?Cl(e).has(t):r&&V(r,e.id)}}),ru(i,r?{get:function(t){var e=a(this);if(xt(t)){var r=Il(t);return!0===r?Cl(e).get(t):r?r[e.id]:void 0}},set:function(t,e){return u(this,t,e)}}:{add:function(t){return u(this,t,!0)}}),o}},zl=pe.enforce,Bl=!O.ActiveXObject&&"ActiveXObject"in O,Ul=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Gl=kl("WeakMap",Ul,Wl);if(ne&&Bl){Fl=Wl.getConstructor(Ul,"WeakMap",!0),Tl.enable();var Hl=Gl.prototype,Vl=F(Hl.delete),ql=F(Hl.has),Zl=F(Hl.get),Yl=F(Hl.set);ru(Hl,{delete:function(t){if(xt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),Vl(this,t)||e.frozen.delete(t)}return Vl(this,t)},has:function(t){if(xt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)||e.frozen.has(t)}return ql(this,t)},get:function(t){if(xt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)?Zl(this,t):e.frozen.get(t)}return Zl(this,t)},set:function(t,e){if(xt(t)&&!Ol(t)){var r=zl(this);r.frozen||(r.frozen=new Fl),ql(this,t)?Yl(this,t,e):r.frozen.set(t,e)}else Yl(this,t,e);return this}})}var $l=vt("iterator"),Kl=vt("toStringTag"),Ql=Ta.values,Xl=function(t,e){if(t){if(t[$l]!==Ql)try{ie(t,$l,Ql)}catch(e){t[$l]=Ql}if(t[Kl]||ie(t,Kl,e),hi[e])for(var r in Ta)if(t[r]!==Ta[r])try{ie(t,r,Ta[r])}catch(e){t[r]=Ta[r]}}};for(var Jl in hi)Xl(O[Jl]&&O[Jl].prototype,Jl);Xl(di,"DOMTokenList");var th,eh,rh,nh,oh=new WeakMap,ih=function(){function t(){i(this,t),oh.set(this,{})}return u(t,[{key:"addEventListener",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=oh.get(this);n||(n={}),n[t]||(n[t]=[]),n[t].push(e),oh.set(this,n),r.capture,r.once,r.passive}},{key:"removeEventListener",value:function(t,e){var r=oh.get(this);if(r){var n=r[t];if(n&&n.length>0)for(var o=n.length;o--;o>0)if(n[o]===e){n.splice(o,1);break}}}},{key:"dispatchEvent",value:function(t){var e=oh.get(this)[t.type];if(e){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=g(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(e);try{for(n.s();!(r=n.n()).done;){(0,r.value)(t)}}catch(t){n.e(t)}finally{n.f()}}}}]),t}(),ah=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),t.className="",t.children=[],t}return u(r,[{key:"setAttribute",value:function(t,e){this[t]=e}},{key:"getAttribute",value:function(t){return this[t]}},{key:"setAttributeNS",value:function(t,e){this[t]=e}},{key:"getAttributeNS",value:function(t){return this[t]}}]),r}(function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"childNodes",void 0),t.childNodes=[],t}return u(r,[{key:"appendChild",value:function(t){this.childNodes.push(t)}},{key:"cloneNode",value:function(){var t=Object.create(this);return Object.assign(t,this),t}},{key:"removeChild",value:function(t){var e=this.childNodes.findIndex((function(e){return e===t}));return e>-1?this.childNodes.splice(e,1):null}}]),r}(ih));if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var uh=my.getSystemInfoSync();th=uh.screenWidth,eh=uh.screenHeight,rh=uh.windowWidth,nh=uh.windowHeight}else{var sh=Sf.innerWidth,ch=Sf.innerHeight;th=sh,eh=ch,rh=sh,nh=ch}var fh={width:th,height:eh,availWidth:rh,availHeight:nh,availLeft:0,availTop:0},lh=fh.availWidth,hh=fh.availHeight,ph={style:[]};function vh(t,e){var r,n;"parentNode"in t||(r=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentNode",{enumerable:!0,get:r}));"parentElement"in t||(n=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentElement",{enumerable:!0,get:n}))}function dh(t){t.style=t.style||{},Object.assign(t.style,{top:"0px",left:"0px",width:lh+"px",height:hh+"px",margin:"0px",padding:"0px"})}function yh(t){"clientLeft"in t||(t.clientLeft=0,t.clientTop=0),"clientWidth"in t||(t.clientWidth=lh,t.clientHeight=hh),"getBoundingClientRect"in t||(t.getBoundingClientRect=function(){return{x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight}})}function gh(t){"offsetLeft"in t||(t.offsetLeft=0,t.offsetTop=0),"offsetWidth"in t||(t.offsetWidth=lh,t.offsetHeight=hh)}function mh(t){"scrollLeft"in t||(t.scrollLeft=0,t.scrollTop=0),"scrollWidth"in t||(t.scrollWidth=lh,t.scrollHeight=hh)}function xh(t){var e=function(){return!0};t.classList=[],t.classList.add=e,t.classList.remove=e,t.classList.contains=e,t.classList.toggle=e}function bh(){}var wh=function(t){c(r,t);var e=v(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),s(h(t),"focus",void 0),s(h(t),"blur",void 0),s(h(t),"insertBefore",void 0),s(h(t),"appendChild",void 0),s(h(t),"removeChild",void 0),s(h(t),"remove",void 0),s(h(t),"innerHTML",void 0),s(h(t),"tagName",void 0),t.className="",t.children=[],t.focus=bh,t.blur=bh,t.insertBefore=bh,t.appendChild=bh,t.removeChild=bh,t.remove=bh,t.innerHTML="",t.tagName=n.toUpperCase(),vh(h(t),o),dh(h(t)),xh(h(t)),yh(h(t)),gh(h(t)),mh(h(t)),t}return u(r)}(ah),Eh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"video")}return u(r)}(function(t){c(r,t);var e=v(r);function r(t){return i(this,r),e.call(this,t)}return u(r,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),r}(wh)),Ah={};function Oh(){return Ah}var Sh=u((function t(){i(this,t);var e=Oh(),r=e.createImage&&e.createImage()||{};return"tagName"in r||(r.tagName="IMG",r.__proto__=t.prototype),vh(r),xh(r),Object.assign(r,{addEventListener:function(t,e){r["on".concat(t)]=e.bind(r)},removeEventListener:function(t){r["on".concat(t)]=null}}),r})),Th={href:"",protocol:"",host:""},kh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"body",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e,r){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),Ih=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"html",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),jh={},Ph={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:Th,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(t){return"canvas"===(t=t.toLowerCase())?my.createOffscreenCanvas(1024,128,"2d"):"img"===t?new Sh:"video"===t?new Eh:new wh(t)},createElementNS:function(t,e){return this.createElement(e)},createTextNode:function(t){return t},getElementById:function(t){return null},getElementsByTagName:function(t){return t=t.toLowerCase(),[]},getElementsByTagNameNS:function(t,e){return this.getElementsByTagName(e)},getElementsByName:function(t){return[]},querySelector:function(t){return null},querySelectorAll:function(t){return[]},addEventListener:function(t,e,r){jh[t]||(jh[t]=[]),jh[t].push(e)},removeEventListener:function(t,e){var r=jh[t];if(r&&r.length>0)for(var n=r.length;n--;n>0)if(r[n]===e){r.splice(n,1);break}},dispatchEvent:function(t){var e=t.type,r=jh[e];if(r)for(var n=0;n<r.length;n++)r[n](t);t.target&&"function"==typeof t.target["on"+e]&&t.target["on"+e](t)},createEvent:function(t){return new cl(t)}};Ph.documentElement=new Ih,Ph.head=new wh("head"),Ph.body=new kh,If("match",(function(t,e,r){return[function(e){var r=B(this),n=W(e)?void 0:Dt(e,t);return n?jt(n,e,r):new RegExp(e)[t](rf(r))},function(t){var n=kt(this),o=rf(t),i=r(e,n,o);if(i.done)return i.value;if(!n.global)return Hf(n,o);var a=n.unicode;n.lastIndex=0;for(var u,s=[],c=0;null!==(u=Hf(n,o));){var f=rf(u[0]);s[c]=f,""===f&&(n.lastIndex=Cf(o,Fe(n.lastIndex),a)),c++}return 0===c?null:s}]}));var _h,Mh,Lh=vt("isConcatSpreadable"),Rh=ut>=51||!j((function(){var t=[];return t[Lh]=!1,t.concat()[0]!==t})),Ch=Pi("concat"),Nh=function(t){if(!xt(t))return!1;var e=t[Lh];return void 0!==e?!!e:yi(t)};if(ar({target:"Array",proto:!0,arity:1,forced:!Rh||!Ch},{concat:function(t){var e,r,n,o,i,a=G(this),u=xi(a,0),s=0;for(e=-1,n=arguments.length;e<n;e++)if(Nh(i=-1===e?a:arguments[e]))for(o=We(i),il(s+o),r=0;r<o;r++,s++)r in i&&Ii(u,s,i[r]);else il(s+1),Ii(u,s++,i);return u.length=s,u}}),"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var Dh=my.getSystemInfoSync();_h=Dh.system,Dh.platform,Dh.language}else{var Fh={versions:(Mh=Sf.navigator.userAgent,{trident:Mh.indexOf("Trident")>-1,presto:Mh.indexOf("Presto")>-1,webKit:Mh.indexOf("AppleWebKit")>-1,gecko:Mh.indexOf("Gecko")>-1&&-1===Mh.indexOf("KHTML"),mobile:!!Mh.match(/AppleWebKit.*Mobile.*/),ios:!!Mh.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),android:Mh.indexOf("Android")>-1||Mh.indexOf("Linux")>-1,iPhone:Mh.indexOf("iPhone")>-1,iPad:Mh.indexOf("iPad")>-1,webApp:-1===Mh.indexOf("Safari"),weixin:Mh.indexOf("MicroMessenger")>-1,qq:" qq"===Mh.match(/\\sQQ/i)}),language:(Sf.navigator.browserLanguage||Sf.navigator.language).toLowerCase()};Fh.versions.android?"android":Fh.versions.trident?"IE":Fh.versions.presto?"Opera":Fh.versions.webKit?"webKit":Fh.versions.gecko?"Firefox":Fh.versions.mobile?"mobile":Fh.versions.ios?"ios":Fh.versions.iPhone?"iPhone":Fh.versions.iPad?"ipad":Fh.versions.webApp?"webApp":Fh.versions.weixin?"weixin":Fh.versions.qq&&"qq",_h=Sf.navigator.userAgent,Fh.language}_h.toLowerCase().indexOf("android");cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}));var Wh=qt.f,zh=Tl.fastKey,Bh=pe.set,Uh=pe.getterFor;kl("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(t,e,r,n){var o=t((function(t,o){gr(t,i),Bh(t,{type:e,index:Qi(null),first:void 0,last:void 0,size:0}),gt||(t.size=0),W(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Uh(e),u=function(t,e,r){var n,o,i=a(t),u=s(t,e);return u?u.value=r:(i.last=u={index:o=zh(e,!0),key:e,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=u),n&&(n.next=u),gt?i.size++:t.size++,"F"!==o&&(i.index[o]=u)),t},s=function(t,e){var r,n=a(t),o=zh(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==e)return r};return ru(i,{clear:function(){for(var t=a(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,gt?t.size=0:this.size=0},delete:function(t){var e=a(this),r=s(this,t);if(r){var n=r.next,o=r.previous;delete e.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first==r&&(e.first=n),e.last==r&&(e.last=o),gt?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=a(this),n=zr(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!s(this,t)}}),ru(i,r?{get:function(t){var e=s(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),gt&&Wh(i,"size",{get:function(){return a(this).size}}),o},setStrong:function(t,e,r){var n=e+" Iterator",o=Uh(e),i=Uh(n);wa(t,e,(function(t,e){Bh(this,{type:n,target:t,state:o(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?Ea("keys"==e?r.key:"values"==e?r.value:[r.key,r.value],!1):(t.target=void 0,Ea(void 0,!0))}),r?"entries":"values",!r,!0),dr(e)}});var Gh=F([].join),Hh=Te!=Object,Vh=Ai("join",",");ar({target:"Array",proto:!0,forced:Hh||!Vh},{join:function(t){return Gh(ke(this),void 0===t?",":t)}});var qh=j((function(){Hi(1)}));ar({target:"Object",stat:!0,forced:qh},{keys:function(t){return Hi(G(t))}});var Zh=new Map,Yh=new Map,$h=new Map,Kh=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"onabort",void 0),s(h(t),"onerror",void 0),s(h(t),"onload",void 0),s(h(t),"onloadstart",void 0),s(h(t),"onprogress",void 0),s(h(t),"ontimeout",void 0),s(h(t),"onloadend",void 0),s(h(t),"onreadystatechange",void 0),s(h(t),"readyState",void 0),s(h(t),"response",void 0),s(h(t),"responseText",void 0),s(h(t),"_responseType",void 0),s(h(t),"responseXML",void 0),s(h(t),"status",void 0),s(h(t),"statusText",void 0),s(h(t),"upload",void 0),s(h(t),"withCredentials",void 0),s(h(t),"timeout",void 0),s(h(t),"_url",void 0),s(h(t),"_method",void 0),t.onabort=null,t.onerror=null,t.onload=null,t.onloadstart=null,t.onprogress=null,t.ontimeout=null,t.onloadend=null,t.onreadystatechange=null,t.readyState=0,t.response=null,t.responseText=null,t._responseType="text",t.responseXML=null,t.status=0,t.statusText="",t.upload={},t.withCredentials=!1,Zh.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),t}return u(r,[{key:"responseType",set:function(t){this._responseType=t}},{key:"abort",value:function(){var t=$h.get("requestTask");t&&t.abort()}},{key:"getAllResponseHeaders",value:function(){var t=Yh.get("responseHeader");return Object.keys(t).map((function(e){return"".concat(e,": ").concat(t[e])})).join("\\n")}},{key:"getResponseHeader",value:function(t){return Yh.get("responseHeader")[t]}},{key:"open",value:function(t,e,r){this._method=t,this._url=e}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(t,e){var r=Zh.get("requestHeader");r[t]=e,Zh.set("requestHeader",r)}},{key:"addEventListener",value:function(t,e){var r=this;"function"==typeof e&&(this["on"+t]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.target=t.target||r,e.call(r,t)})}},{key:"removeEventListener",value:function(t,e){this["on"+t]===e&&(this["on"+t]=null)}}]),r}(ih);s(Kh,"UNSEND",void 0),s(Kh,"OPENED",void 0),s(Kh,"HEADERS_RECEIVED",void 0),s(Kh,"LOADING",void 0),s(Kh,"DONE",void 0),Kh.UNSEND=0,Kh.OPENED=1,Kh.HEADERS_RECEIVED=2,Kh.LOADING=3,Kh.DONE=4;var Qh="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,Xh="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),Jh=Qh||Xh;Jh||Sf.XMLHttpRequest,Jh||Sf.location;function tp(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]}var ep=Ei.filter,rp=Pi("filter");function np(t){var e=t.color;return e&&e.length?e:[1,1,1,1]}function op(t,e,r){return 2===r.length?[r[0],r[1],0]:[r[0],r[1],r[2]]}function ip(t){return t.filter?[1]:[0]}function ap(t,e){return[e]}ar({target:"Array",proto:!0,forced:!rp},{filter:function(t){return ep(this,t,arguments.length>1?arguments[1]:void 0)}});var up=cp,sp=cp;function cp(t,e,r){r=r||2;var n,o,i,a,u,s,c,f=e&&e.length,l=f?e[0]*r:t.length,h=fp(t,0,l,r,!0),p=[];if(!h||h.next===h.prev)return p;if(f&&(h=function(t,e,r,n){var o,i,a,u,s,c=[];for(o=0,i=e.length;o<i;o++)a=e[o]*n,u=o<i-1?e[o+1]*n:t.length,(s=fp(t,a,u,n,!1))===s.next&&(s.steiner=!0),c.push(wp(s));for(c.sort(gp),o=0;o<c.length;o++)r=mp(c[o],r);return r}(t,e,h,r)),t.length>80*r){n=i=t[0],o=a=t[1];for(var v=r;v<l;v+=r)(u=t[v])<n&&(n=u),(s=t[v+1])<o&&(o=s),u>i&&(i=u),s>a&&(a=s);c=0!==(c=Math.max(i-n,a-o))?32767/c:0}return hp(h,p,r,n,o,c,0),p}function fp(t,e,r,n,o){var i,a;if(o===Rp(t,e,r,n)>0)for(i=e;i<r;i+=n)a=_p(i,t[i],t[i+1],a);else for(i=r-n;i>=e;i-=n)a=_p(i,t[i],t[i+1],a);return a&&Sp(a,a.next)&&(Mp(a),a=a.next),a}function lp(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Sp(n,n.next)&&0!==Op(n.prev,n,n.next))n=n.next;else{if(Mp(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function hp(t,e,r,n,o,i,a){if(t){!a&&i&&function(t,e,r,n){var o=t;do{0===o.z&&(o.z=bp(o.x,o.y,e,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,r,n,o,i,a,u,s,c=1;do{for(r=t,t=null,i=null,a=0;r;){for(a++,n=r,u=0,e=0;e<c&&(u++,n=n.nextZ);e++);for(s=c;u>0||s>0&&n;)0!==u&&(0===s||!n||r.z<=n.z)?(o=r,r=r.nextZ,u--):(o=n,n=n.nextZ,s--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;r=n}i.nextZ=null,c*=2}while(a>1)}(o)}(t,n,o,i);for(var u,s,c=t;t.prev!==t.next;)if(u=t.prev,s=t.next,i?vp(t,n,o,i):pp(t))e.push(u.i/r|0),e.push(t.i/r|0),e.push(s.i/r|0),Mp(t),t=s.next,c=s.next;else if((t=s)===c){a?1===a?hp(t=dp(lp(t),e,r),e,r,n,o,i,2):2===a&&yp(t,e,r,n,o,i):hp(lp(t),e,r,n,o,i,1);break}}}function pp(t){var e=t.prev,r=t,n=t.next;if(Op(e,r,n)>=0)return!1;for(var o=e.x,i=r.x,a=n.x,u=e.y,s=r.y,c=n.y,f=o<i?o<a?o:a:i<a?i:a,l=u<s?u<c?u:c:s<c?s:c,h=o>i?o>a?o:a:i>a?i:a,p=u>s?u>c?u:c:s>c?s:c,v=n.next;v!==e;){if(v.x>=f&&v.x<=h&&v.y>=l&&v.y<=p&&Ep(o,u,i,s,a,c,v.x,v.y)&&Op(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function vp(t,e,r,n){var o=t.prev,i=t,a=t.next;if(Op(o,i,a)>=0)return!1;for(var u=o.x,s=i.x,c=a.x,f=o.y,l=i.y,h=a.y,p=u<s?u<c?u:c:s<c?s:c,v=f<l?f<h?f:h:l<h?l:h,d=u>s?u>c?u:c:s>c?s:c,y=f>l?f>h?f:h:l>h?l:h,g=bp(p,v,e,r,n),m=bp(d,y,e,r,n),x=t.prevZ,b=t.nextZ;x&&x.z>=g&&b&&b.z<=m;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=m;){if(b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function dp(t,e,r){var n=t;do{var o=n.prev,i=n.next.next;!Sp(o,i)&&Tp(o,n,n.next,i)&&jp(o,i)&&jp(i,o)&&(e.push(o.i/r|0),e.push(n.i/r|0),e.push(i.i/r|0),Mp(n),Mp(n.next),n=t=i),n=n.next}while(n!==t);return lp(n)}function yp(t,e,r,n,o,i){var a=t;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&Ap(a,u)){var s=Pp(a,u);return a=lp(a,a.next),s=lp(s,s.next),hp(a,e,r,n,o,i,0),void hp(s,e,r,n,o,i,0)}u=u.next}a=a.next}while(a!==t)}function gp(t,e){return t.x-e.x}function mp(t,e){var r=function(t,e){var r,n=e,o=t.x,i=t.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var u=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=o&&u>a&&(a=u,r=n.x<n.next.x?n:n.next,u===o))return r}n=n.next}while(n!==e);if(!r)return null;var s,c=r,f=r.x,l=r.y,h=1/0;n=r;do{o>=n.x&&n.x>=f&&o!==n.x&&Ep(i<l?o:a,i,f,l,i<l?a:o,i,n.x,n.y)&&(s=Math.abs(i-n.y)/(o-n.x),jp(n,t)&&(s<h||s===h&&(n.x>r.x||n.x===r.x&&xp(r,n)))&&(r=n,h=s)),n=n.next}while(n!==c);return r}(t,e);if(!r)return e;var n=Pp(r,t);return lp(n,n.next),lp(r,r.next)}function xp(t,e){return Op(t.prev,t,e.prev)<0&&Op(e.next,t,t.next)<0}function bp(t,e,r,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wp(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Ep(t,e,r,n,o,i,a,u){return(o-a)*(e-u)>=(t-a)*(i-u)&&(t-a)*(n-u)>=(r-a)*(e-u)&&(r-a)*(i-u)>=(o-a)*(n-u)}function Ap(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Tp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(jp(t,e)&&jp(e,t)&&function(t,e){var r=t,n=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(Op(t.prev,t,e.prev)||Op(t,e.prev,e))||Sp(t,e)&&Op(t.prev,t,t.next)>0&&Op(e.prev,e,e.next)>0)}function Op(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Sp(t,e){return t.x===e.x&&t.y===e.y}function Tp(t,e,r,n){var o=Ip(Op(t,e,r)),i=Ip(Op(t,e,n)),a=Ip(Op(r,n,t)),u=Ip(Op(r,n,e));return o!==i&&a!==u||(!(0!==o||!kp(t,r,e))||(!(0!==i||!kp(t,n,e))||(!(0!==a||!kp(r,t,n))||!(0!==u||!kp(r,e,n)))))}function kp(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ip(t){return t>0?1:t<0?-1:0}function jp(t,e){return Op(t.prev,t,t.next)<0?Op(t,e,t.next)>=0&&Op(t,t.prev,e)>=0:Op(t,e,t.prev)<0||Op(t,t.next,e)<0}function Pp(t,e){var r=new Lp(t.i,t.x,t.y),n=new Lp(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function _p(t,e,r,n){var o=new Lp(t,e,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Mp(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Lp(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Rp(t,e,r,n){for(var o=0,i=e,a=r-n;i<r;i+=n)o+=(t[a]-t[i])*(t[i+1]+t[a+1]),a=i;return o}cp.deviation=function(t,e,r,n){var o=e&&e.length,i=o?e[0]*r:t.length,a=Math.abs(Rp(t,0,i,r));if(o)for(var u=0,s=e.length;u<s;u++){var c=e[u]*r,f=u<s-1?e[u+1]*r:t.length;a-=Math.abs(Rp(t,c,f,r))}var l=0;for(u=0;u<n.length;u+=3){var h=n[u]*r,p=n[u+1]*r,v=n[u+2]*r;l+=Math.abs((t[h]-t[v])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[v+1]-t[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},cp.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var a=0;a<e;a++)r.vertices.push(t[o][i][a]);o>0&&(n+=t[o-1].length,r.holes.push(n))}return r},up.default=sp;var Cp=F(1..valueOf),Np=F("".replace),Dp="[\\t\\n\\v\\f\\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\\u2028\\u2029\\ufeff]",Fp=RegExp("^"+Dp+Dp+"*"),Wp=RegExp(Dp+Dp+"*$"),zp=function(t){return function(e){var r=rf(B(e));return 1&t&&(r=Np(r,Fp,"")),2&t&&(r=Np(r,Wp,"")),r}},Bp={start:zp(1),end:zp(2),trim:zp(3)},Up=Ze.f,Gp=je.f,Hp=qt.f,Vp=Bp.trim,qp=O.Number,Zp=qp.prototype,Yp=O.TypeError,$p=F("".slice),Kp=F("".charCodeAt),Qp=function(t){var e=Bt(t,"number");return"bigint"==typeof e?e:Xp(e)},Xp=function(t){var e,r,n,o,i,a,u,s,c=Bt(t,"number");if(Mt(c))throw Yp("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=Vp(c),43===(e=Kp(c,0))||45===e){if(88===(r=Kp(c,2))||120===r)return NaN}else if(48===e){switch(Kp(c,1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(a=(i=$p(c,2)).length,u=0;u<a;u++)if((s=Kp(i,u))<48||s>o)return NaN;return parseInt(i,n)}return+c};if(or("Number",!qp(" 0o1")||!qp("0b1")||qp("+0x1"))){for(var Jp,tv=function(t){var e=arguments.length<1?0:qp(Qp(t)),r=this;return Pt(Zp,r)&&j((function(){Cp(r)}))?ss(Object(e),r,tv):e},ev=gt?Up(qp):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),rv=0;ev.length>rv;rv++)V(qp,Jp=ev[rv])&&!V(tv,Jp)&&Hp(tv,Jp,Gp(qp,Jp));tv.prototype=Zp,Zp.constructor=tv,de(O,"Number",tv,{constructor:!0})}var nv=RangeError,ov=RangeError,iv=String,av=Math.floor,uv=F((function(t){var e=rf(B(this)),r="",n=Le(t);if(n<0||n==1/0)throw nv("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(r+=e);return r})),sv=F("".slice),cv=F(1..toFixed),fv=function(t,e,r){return 0===e?r:e%2==1?fv(t,e-1,r*t):fv(t*t,e/2,r)},lv=function(t,e,r){for(var n=-1,o=r;++n<6;)o+=e*t[n],t[n]=o%1e7,o=av(o/1e7)},hv=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=av(n/e),n=n%e*1e7},pv=function(t){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==t[e]){var n=iv(t[e]);r=""===r?n:r+uv("0",7-n.length)+n}return r},vv=j((function(){return"0.000"!==cv(8e-5,3)||"1"!==cv(.9,0)||"1.25"!==cv(1.255,2)||"1000000000000000128"!==cv(0xde0b6b3a7640080,0)}))||!j((function(){cv({})}));function dv(t){return"number"==typeof t}function yv(t){var e=Math.max(Math.min(85.0511287798,t[1]),-85.0511287798),r=Math.PI/180,n=t[0]*r,o=e*r;o=Math.log(Math.tan(Math.PI/4+o/2));return n=(256<<20)*(.5/Math.PI*n+.5),o=(256<<20)*(-.5/Math.PI*o+(r=.5)),[Math.floor(n),Math.floor(o)]}ar({target:"Number",proto:!0,forced:vv},{toFixed:function(t){var e,r,n,o,i=Cp(this),a=Le(t),u=[0,0,0,0,0,0],s="",c="0";if(a<0||a>20)throw ov("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return iv(i);if(i<0&&(s="-",i=-i),i>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(i*fv(2,69,1))-69)<0?i*fv(2,-e,1):i/fv(2,e,1),r*=4503599627370496,(e=52-e)>0){for(lv(u,0,r),n=a;n>=7;)lv(u,1e7,0),n-=7;for(lv(u,fv(10,n,1),0),n=e-1;n>=23;)hv(u,1<<23),n-=23;hv(u,1<<n),lv(u,1,1),hv(u,2),c=pv(u)}else lv(u,0,r),lv(u,1<<-e,0),c=pv(u)+uv("0",a);return c=a>0?s+((o=c.length)<=a?"0."+uv("0",a-o)+c:sv(c,0,o-a)+"."+sv(c,o-a)):s+c}});var gv,mv=/"/g,xv=F("".replace);ar({target:"String",proto:!0,forced:(gv="sub",j((function(){var t=""[gv]('"');return t!==t.toLowerCase()||t.split('"').length>3})))},{sub:function(){return t="sub",e="",r="",n=rf(B(this)),o="<"+t,""!==e&&(o+=" "+e+'="'+xv(rf(r),mv,"&quot;")+'"'),o+">"+n+"</"+t+">";var t,e,r,n,o}});var bv=RegExp.prototype,wv=Kt.PROPER,Ev=RegExp.prototype.toString,Av=j((function(){return"/a/b"!=Ev.call({source:"a",flags:"b"})})),Ov=wv&&"toString"!=Ev.name;(Av||Ov)&&de(RegExp.prototype,"toString",(function(){var t=kt(this);return"/"+rf(t.source)+"/"+rf(function(t){var e=t.flags;return void 0!==e||"flags"in bv||V(t,"flags")||!Pt(bv,t)?e:jt(nf,t)}(t))}),{unsafe:!0});var Sv="undefined"!=typeof Float32Array?Float32Array:Array;function Tv(){var t=new Sv(2);return Sv!=Float32Array&&(t[0]=0,t[1]=0),t}function kv(t,e){var r=new Sv(2);return r[0]=t,r[1]=e,r}function Iv(t,e){return t[0]=e[0],t[1]=e[1],t}function jv(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Pv(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function _v(t,e){var r=e[0],n=e[1],o=r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t}function Mv(t,e){return t[0]*e[0]+t[1]*e[1]}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Lv,Rv=Pv,Cv=(Lv=Tv(),Tv()),Nv=(Tv(),Tv()),Dv=Tv(),Fv=Tv();function Wv(t,e,r,n,o){return jv(t,r,n),_v(t,t),[o/Mv(e=kv(-t[1],t[0]),kv(-r[1],r[0])),e]}function zv(t,e){return function(t,e,r){return t[0]=e,t[1]=r,t}(t,-e[1],e[0])}function Bv(t,e,r){return Rv(t,e,r),_v(t,t),t}function Uv(t,e){return t[0]===e[0]&&t[1]===e[1]}var Gv=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),s(this,"complex",void 0),s(this,"join",void 0),s(this,"cap",void 0),s(this,"miterLimit",void 0),s(this,"thickness",void 0),s(this,"normal",void 0),s(this,"lastFlip",-1),s(this,"miter",kv(0,0)),s(this,"started",!1),s(this,"dash",!1),s(this,"totalDistance",0),s(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return u(t,[{key:"extrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.segment_gaode2(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.simpleSegment(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.segment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleExtrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.simpleSegment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"segment_gaode2",value:function(t,e,r,n,o,i,a,u){var s=0,c=t.indices,f=t.positions,l=t.normals,h="square"===this.cap,p="bevel"===this.join,v=yv([a[0],a[1]]),g=yv([i[0],i[1]]);Bv(Nv,n,r);var m=0;if(this.dash&&(m=this.lineSegmentDistance(v,g),this.totalDistance+=m),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,h){var x=Tv(),b=Tv();jv(x,this.normal,Nv),jv(b,this.normal,Nv),l.push(b[0],b[1],0),l.push(x[0],x[1],0),f.push(r[0],r[1],0|r[2],this.totalDistance-m,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),f.push(r[0],r[1],0|r[2],this.totalDistance-m,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,r,this.normal,this.thickness,this.totalDistance-m);if(c.push(e+0,e+1,e+2),o){Uv(n,o)&&jv(o,n,_v(o,Pv(o,n,r))),Bv(Dv,o,n);var w=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),E=w[0],A=w[1],O=Mv(Fv,this.normal)<0?-1:1,S=p;if(!S&&"miter"===this.join)E>this.miterLimit&&(S=!0);S?(l.push(this.normal[0],this.normal[1],0),l.push(A[0],A[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c.push.apply(c,y(this.lastFlip!==-O?[e,e+2,e+3]:[e+2,e+1,e+3])),c.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),l.push(this.normal[0],this.normal[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(f,l,n,A,E,this.totalDistance),c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),O=-1,Iv(this.normal,A),s+=2),this.lastFlip=O}else{if(zv(this.normal,Nv),h){var T=Tv(),k=Tv();Rv(k,Nv,this.normal),jv(T,Nv,this.normal),l.push(k[0],k[1],0),l.push(T[0],T[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,n,this.normal,this.thickness,this.totalDistance);c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),s+=2}return s}},{key:"simpleSegment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c=yv([n[0],n[1]]),f=yv([r[0],r[1]]);Bv(Nv,c,f);var l=0;if(this.dash&&(l=this.lineSegmentDistance(c,f),this.totalDistance+=l),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),this.started||(this.started=!0,this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-l)),a.push(e+0,e+1,e+2),o){var h=yv([o[0],o[1]]);Uv(c,h)&&jv(h,c,_v(h,Pv(h,c,f))),Bv(Dv,h,c);var p=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),v=p[0],g=p[1];Mv(Fv,this.normal);this.extrusions(u,s,n,g,v,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),-1,Iv(this.normal,g),i+=2,this.lastFlip=-1}else zv(this.normal,Nv),this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2;return i}},{key:"segment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c="square"===this.cap,f="bevel"===this.join,l=yv([n[0],n[1]]),h=yv([r[0],r[1]]);Bv(Nv,l,h);var p=0;if(this.dash&&(p=this.lineSegmentDistance(l,h),this.totalDistance+=p),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,c){var v=Tv(),g=Tv();jv(v,this.normal,Nv),jv(g,this.normal,Nv),s.push(g[0],g[1],0),s.push(v[0],v[1],0),u.push(r[0],r[1],0|r[2],this.totalDistance-p,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),u.push(r[0],r[1],0|r[2],this.totalDistance-p,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-p);if(a.push(e+0,e+1,e+2),o){var m=yv([o[0],o[1]]);Uv(l,m)&&jv(m,l,_v(m,Pv(m,l,h))),Bv(Dv,m,l);var x=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),b=x[0],w=x[1],E=Mv(Fv,this.normal)<0?-1:1,A=f;if(!A&&"miter"===this.join)b>this.miterLimit&&(A=!0);A?(s.push(this.normal[0],this.normal[1],0),s.push(w[0],w[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push.apply(a,y(this.lastFlip!==-E?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),s.push(this.normal[0],this.normal[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,i+=3):(this.extrusions(u,s,n,w,b,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),E=-1,Iv(this.normal,w),i+=2),this.lastFlip=E}else{if(zv(this.normal,Nv),c){var O=Tv(),S=Tv();Rv(S,Nv,this.normal),jv(O,Nv,this.normal),s.push(S[0],S[1],0),s.push(O[0],O[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance);a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2}return i}},{key:"extrusions",value:function(t,e,r,n,o,i){e.push(n[0],n[1],0),e.push(n[0],n[1],0),t.push(r[0],r[1],0|r[2],i,-o,0|r[2]),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],0|r[2],i,o,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}}]),t}();function Hv(t){var e=t.coordinates,r=t.originCoordinates,n=t.version,o=new Gv({dash:!0,join:"bevel"});if("GAODE2.x"===n){var i=e;Array.isArray(i[0][0])||(i=[e]);var a=r;Array.isArray(a[0][0])||(a=[r]);for(var u=0;u<i.length;u++){var s=i[u],c=a[u];o.extrude_gaode2(s,c)}}else{var f=e;f[0]&&!Array.isArray(f[0][0])&&(f=[e]),f.forEach((function(t){o.extrude(t)}))}var l=o.complex;return{vertices:l.positions,indices:l.indices,normals:l.normals,indexes:l.indexes,size:6}}function Vv(t){var e=function(t){if(dv(t[0]))return t;if(dv(t[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(dv(t[0][0][0])){var e=0,r=0,n=0;return t.forEach((function(t){t.forEach((function(t){e+=t[0],r+=t[1],n++}))})),[e/n,r/n,0]}throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}(t.coordinates);return{vertices:[].concat(y(e),y(e),y(e),y(e)),indices:[0,1,2,2,3,0],size:e.length}}function qv(t){var e=t.coordinates,r=up.flatten(e),n=r.vertices,o=r.dimensions,i=r.holes;return{indices:up(n,i,o),vertices:n,size:o}}var Zv=function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.iconMap,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_DistanceAndIndex:function(t,e,r,n,o,i){return void 0===i?[r[3],10]:[r[3],i]},a_Total_Distance:function(t,e,r){return[r[5]]},a_Size:function(t){var e=t.size,r=void 0===e?1:e;return Array.isArray(r)?[r[0],r[1]]:[r,0]},a_Normal:function(t,e,r,n,o){return o},a_Miter:function(t,e,r){return[r[4]]},a_iconMapUV:function(t){var e=t.texture,r=a[e]||{x:0,y:0};return[r.x,r.y]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Hv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size,p=r.indexes;o.forEach((function(t){f.push(t+c)})),l=h;var v=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=v;for(var d=function(r){var o=(null==a?void 0:a.slice(3*r,3*r+3))||[],s=i.slice(r*h,r*h+h),c=0;p&&void 0!==p[r]&&(c=p[r]),n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,s,r,o,c)))}))},g=0;g<v;g++)d(g)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Yv={pointFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.shape2d,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_Shape:function(t){var e=t.shape,r=void 0===e?2:e;return[a.indexOf(r)]},a_Extrude:function(t,e,r,n){var o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],i=n%4*3;return[o[i],o[i+1],o[i+2]]},a_Size:function(t){var e=t.size,r=void 0===e?5:e;return Array.isArray(r)?[r[0]]:[r]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Vv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size;o.forEach((function(t){f.push(t+c)})),l=h;var p=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=p;for(var v=function(r){var o=[],a=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,a,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),line:Zv,polygonFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]}},u={sizePerElement:0,elements:[]},s=0,c=[],f=3,o.forEach((function(t,e){var r=qv(t),o=r.indices,i=r.vertices,l=r.normals,h=r.size;o.forEach((function(t){c.push(t+s)})),f=h;var p=i.length/h;u.sizePerElement=f,u.elements.push({featureIdx:e,vertices:i,normals:l,offset:s}),s+=p;for(var v=function(r){var o=[],u=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&a[n.name]&&(i=n.buffer.data).push.apply(i,y(a[n.name](t,e,u,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:u,indices:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},$v=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Yv);function Kv(t){return Qv.apply(this,arguments)}function Qv(){return(Qv=o(r().mark((function t(e){var n,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.workerType,o=e.data,!$v[n]){t.next=3;break}return t.abrupt("return",$v[n](o));case 3:return t.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(n,'" non-existent.'))));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return fi(Kv),t.WorkerSourceMap=Yv,t.createWorker=fi,t.worker=Kv,t}({});
`,wn="l7-worker",Vn=3,br=!0;function si(e){ii(wn,e)}function Ti(){var e=li(wn);if(!e)throw new Error("get worker failed by workerName: ".concat(wn,"."));return e}function ka(e,i){return So.apply(this,arguments)}function So(){return So=(0,Dt.Z)(Ze().mark(function e(i,r){var n,t,a,s,l;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return n=Ti(),t=Df.getWorkerFarm({maxConcurrency:Vn,reuseWorkers:br}),a=t.getWorkerPool({name:wn,source:n}),d.next=5,a.startJob(wn,function(S,O,Z){return S.done(Z)});case 5:return s=d.sent,s.postMessage("process",{input:{workerType:i,data:r}}),d.next=9,s.result;case 9:return l=d.sent,d.abrupt("return",l.result);case 11:case"end":return d.stop()}},e)})),So.apply(this,arguments)}si(Mn);function Mo(e,i){var r=i.extent,n=r===void 0?[121.168,30.2828,121.384,30.4219]:r,t=new Promise(function(s){e instanceof HTMLImageElement||ge(e)?s([e]):rs(e,function(l){s(l)})}),a={originData:e,images:t,_id:1,dataArray:[{_id:0,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return a}function rs(e,i){var r=e,n=[];if(typeof r=="string")mc({url:r},function(s,l){l&&(n.push(l),i(n))});else{var t=r.length,a=0;r.forEach(function(s){mc({url:s},function(l,f){a++,f&&n.push(f),a===t&&i(n)})})}return Mo}var pu=I(38929),Co=I(3614),Qo=I.n(Co),bu=function(){function e(i,r,n,t){(0,re.Z)(this,e),(0,V.Z)(this,"vectorLayerCache",{}),this.x=r,this.y=n,this.z=t,this.vectorTile=new pu.VectorTile(new(Qo())(i))}return(0,he.Z)(e,[{key:"getTileData",value:function(r){if(!r||!this.vectorTile.layers[r])return[];if(this.vectorLayerCache[r])return this.vectorLayerCache[r];var n=this.vectorTile.layers[r];if(Array.isArray(n.features))return this.vectorLayerCache[r]=n.features,n.features;for(var t=[],a=0;a<n.length;a++){var s=n.feature(a),l=s.toGeoJSON(this.x,this.y,this.z);t.push((0,ue.Z)((0,ue.Z)({},l),{},{properties:(0,ue.Z)({id:l.id},l.properties)}))}return this.vectorLayerCache[r]=t,t}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),e}(),o={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},u=function(){var e=(0,Dt.Z)(Ze().mark(function i(r,n,t,a,s){var l;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return l=Oc(r,n),d.abrupt("return",new Promise(function(S){if(s)s({x:t.x,y:t.y,z:t.z},function(Z,U){if(Z||!U)S(void 0);else{var se=new bu(U,t.x,t.y,t.z);S(se)}});else{var O=Au((0,ue.Z)((0,ue.Z)({},a),{},{url:l}),function(Z,U){if(Z||!U)S(void 0);else{var se=new bu(U,t.x,t.y,t.z);S(se)}});t.xhrCancel=function(){return O.abort()}}}));case 2:case"end":return d.stop()}},i)}));return function(r,n,t,a,s){return e.apply(this,arguments)}}();function c(e,i){var r=Array.isArray(e)?e[0]:e,n=function(s,l){return u(r,s,l,i==null?void 0:i.requestParameters,i==null?void 0:i.getCustomData)},t=(0,ue.Z)((0,ue.Z)((0,ue.Z)({},o),i),{},{getTileData:n});return{data:r,dataArray:[],tilesetOptions:t,isTile:!0}}function y(e,i,r){switch(e){case"+":return i+r;case"-":return i-r;case"*":return i*r;case"/":return i/r;case"%":return i%r;case"^":return Math.pow(i,r);case"abs":return Math.abs(i);case"floor":return Math.floor(i);case"round":return Math.round(i);case"ceil":return Math.ceil(i);case"sin":return Math.sin(i);case"cos":return Math.cos(i);case"atan":return r===-1?Math.atan(i):Math.atan2(i,r);case"min":return Math.min(i,r);case"max":return Math.max(i,r);case"log10":return Math.log(i);case"log2":return Math.log2(i);default:return console.warn("Calculate symbol err! Return default 0"),0}}function C(e,i){for(var r=i[0],n=r.width,t=r.height,a=i.map(function(U){return U.rasterData}),s=n*t,l=[],f=JSON.stringify(e),d=0;d<s;d++){var S=JSON.parse(f),O=R(S,a,d);if(typeof O=="number")l.push(O);else{var Z=Q(S);l.push(Z)}}return l}function R(e,i,r){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return i[e[1]][r]}catch(n){return console.warn("Raster Data err!"),0}e.map(function(n,t){if(Array.isArray(n)&&n.length>0)switch(n[0]){case"band":try{e[t]=i[n[1]][r]}catch(a){console.warn("Raster Data err!"),e[t]=0}break;default:R(n,i,r)}})}function z(e){var i=(0,Ja.Z)(e,3),r=i[0],n=i[1],t=n===void 0?-1:n,a=i[2],s=a===void 0?-1:a;if(r===void 0)return console.warn("Express err!"),["+",0,0];var l=r.replace(/\s+/g,"");return[l,t,s]}function Q(e){var i=z(e),r=i[0],n=i[1],t=i[2];return Array.isArray(n)&&(n=Q(e[1])),Array.isArray(t)&&(t=Q(e[2])),y(r,n,t)}var pe={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:Ie}};function Ie(e,i){for(var r=e[0].rasterData,n=e[1].rasterData,t=e[2].rasterData,a=[],s=(i==null?void 0:i.countCut)||[2,98],l=(0,Ja.Z)(s,2),f=l[0],d=l[1],S=(i==null?void 0:i.RMinMax)||ze(r,f,d),O=(i==null?void 0:i.GMinMax)||ze(n,f,d),Z=(i==null?void 0:i.BMinMax)||ze(t,f,d),U=0;U<r.length;U++)a.push(Math.max(0,r[U]-S[0])),a.push(Math.max(0,n[U]-O[0])),a.push(Math.max(0,t[U]-Z[0]));return{rasterData:a,rMinMax:S,gMinMax:O,bMinMax:Z}}function ze(e,i,r){var n=e.slice().sort(function(l,f){return l-f}),t=n.length,a=n[Math.ceil(t*i/100)],s=n[Math.ceil(t*r/100)];return[a,s]}function qe(e,i,r){return ut.apply(this,arguments)}function ut(){return ut=(0,Dt.Z)(Ze().mark(function e(i,r,n){var t,a,s,l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(i.length!==0){O.next=2;break}return O.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return O.next=4,Promise.all(i.map(function(Z){var U=Z.data,se=Z.bands,le=se===void 0?[0]:se;return r(U,le)}));case 4:t=O.sent,a=[],t.forEach(function(Z){Array.isArray(Z)?a.push.apply(a,(0,oe.Z)(Z)):a.push(Z)}),s=a[0],l=s.width,f=s.height,O.t0=(0,on.Z)(n),O.next=O.t0==="function"?11:O.t0==="object"?13:15;break;case 11:return d=n(a),O.abrupt("break",16);case 13:return Array.isArray(n)?d={rasterData:C(n,a)}:d=wt(n,a),O.abrupt("break",16);case 15:d={rasterData:a[0].rasterData};case 16:return O.abrupt("return",(0,ue.Z)((0,ue.Z)({},d),{},{width:l,height:f}));case 17:case"end":return O.stop()}},e)})),ut.apply(this,arguments)}function wt(e,i){var r=pe[e.type];if(r.type==="function")return r.method(i,e==null?void 0:e.options);if(r.type==="operation")return e.type==="rgb"?or(r.expression,i):{rasterData:C(r.expression,i)}}function or(e,i){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var r=C(e.r||["band",0],i),n=C(e.g||["band",0],i),t=C(e.b||["band",0],i);return[r,n,t]}function sr(e,i,r,n){return mr.apply(this,arguments)}function mr(){return mr=(0,Dt.Z)(Ze().mark(function e(i,r,n,t){var a;return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,qe(i,r,n);case 2:a=l.sent,t(null,{data:a});case 4:case"end":return l.stop()}},e)})),mr.apply(this,arguments)}function yr(e,i){return e.map(function(r){return r[i]*1})}function rn(e){return e===void 0?!1:!Array.isArray(e)&&e.data!==void 0}function _n(e){return Array.isArray(e)?e.length===0?!1:!!rn(e[0]):!1}function kn(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function Nn(e,i){var r=i.extent,n=i.width,t=i.height,a=i.min,s=i.max,l=i.format,f=i.operation,d,S,O;if(l===void 0||kn(e))d=Array.from(e),S=n,O=t;else{var Z=Array.isArray(e)?e:[e];d=qe(Z,l,f)}var U={_id:1,dataArray:[{_id:1,data:d,width:S,height:O,min:a,max:s,coordinates:[[r[0],r[1]],[r[2],r[3]]]}]};return U}var pi=I(28660),Xr=I(86700),ua=I(84879),Ir={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),IDebugService:Symbol.for("IDebugService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},vn=I(31745),$i=I.n(vn);function ki(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=eo(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function eo(e,i){if(e){if(typeof e=="string")return Ha(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ha(e,i)}}function Ha(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var Ta=30;function Ro(e){var i=e.characterSet,r=e.getFontWidth,n=e.fontHeight,t=e.buffer,a=e.maxCanvasWidth,s=e.mapping,l=s===void 0?{}:s,f=e.xOffset,d=f===void 0?0:f,S=e.yOffset,O=S===void 0?0:S,Z=0,U=d;Array.from(i).forEach(function(le,ye){if(!l[le]){var Be=r(le,ye);U+Ta>a&&(U=0,Z++),l[le]={x:U,y:O+Z*Ta,width:Ta,height:Ta,advance:Be},U+=Ta}});var se=n+t*2;return{mapping:l,xOffset:U,yOffset:O+Z*se,canvasHeight:oo(O+(Z+1)*se)}}function No(e,i,r){var n=0,t=0,a=0,s=[],l={},f=ki(e),d;try{for(f.s();!(d=f.n()).done;){var S=d.value;if(!l[S.id]){var O=S.size;n+O+i>r&&(vs(l,s,t),n=0,t=a+t+i,a=0,s=[]),s.push({icon:S,xOffset:n}),n=n+O+i,a=Math.max(a,O)}}}catch(U){f.e(U)}finally{f.f()}s.length>0&&vs(l,s,t);var Z=oo(a+t+i);return{mapping:l,canvasHeight:Z}}function vs(e,i,r){var n=ki(i),t;try{for(n.s();!(t=n.n()).done;){var a=t.value,s=a.icon,l=a.xOffset;e[s.id]=(0,ue.Z)((0,ue.Z)({},s),{},{x:l,y:r,image:s.image,width:s.width,height:s.height})}}catch(f){n.e(f)}finally{n.f()}}function oo(e){return Math.pow(2,Math.ceil(Math.log2(e)))}var Qs,Lu;function cl(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=qu(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function qu(e,i){if(e){if(typeof e=="string")return Xl(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xl(e,i)}}function Xl(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}function ac(e){var i=Zc();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Zc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var xf=Yl(),vh="sans-serif",uf="normal",fs=24,Ic=3,bf=.25,Vs=8,Eu=1024,wu=1,tu=1,mh=3,Bf=null;function Yl(){for(var e=[],i=32;i<128;i++)e.push(String.fromCharCode(i));return e}function Uc(e,i,r,n){e.font="".concat(n," ").concat(r,"px ").concat(i),e.fillStyle="black",e.textBaseline="middle"}function $f(e,i){for(var r=0;r<e.length;r++)i.data[4*r+3]=e[r]}var Hu=(Qs=(0,Xr.b2)(),Qs(Lu=function(e){(0,Ft.Z)(r,e);var i=ac(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"fontAtlas",void 0),(0,V.Z)((0,ct.Z)(n),"iconFontMap",void 0),(0,V.Z)((0,ct.Z)(n),"iconFontGlyphs",{}),(0,V.Z)((0,ct.Z)(n),"fontOptions",void 0),(0,V.Z)((0,ct.Z)(n),"key",void 0),(0,V.Z)((0,ct.Z)(n),"cache",new Of(mh)),n}return(0,he.Z)(r,[{key:"scale",get:function(){return tu}},{key:"canvas",get:function(){var t=this.cache.get(this.key);return t&&t.data}},{key:"mapping",get:function(){var t=this.cache.get(this.key);return t&&t.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:vh,fontWeight:uf,characterSet:xf,fontSize:fs,buffer:Ic,sdf:!0,cutoff:bf,radius:Vs,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(t){var a=this;t.forEach(function(s){a.iconFontGlyphs[s.name]=s.unicode})}},{key:"addIconFont",value:function(t,a){this.iconFontMap.set(t,a)}},{key:"getIconFontKey",value:function(t){return this.iconFontMap.get(t)||t}},{key:"getGlyph",value:function(t){return this.iconFontGlyphs[t]?String.fromCharCode(parseInt(this.iconFontGlyphs[t],16)):""}},{key:"setFontOptions",value:function(t){this.fontOptions=(0,ue.Z)((0,ue.Z)({},this.fontOptions),t),this.key=this.getKey();var a=this.getNewChars(this.key,this.fontOptions.characterSet),s=this.cache.get(this.key);if(!(s&&a.length===0)){var l=this.generateFontAtlas(this.key,a,s);this.fontAtlas=l,this.cache.set(this.key,l)}}},{key:"addFontFace",value:function(t,a){var s=this,l=document.createElement("style");l.type="text/css",l.innerText=`
        @font-face{
            font-family: '`.concat(t,`';
            src: url('`).concat(a,`') format('woff2'),
            url('`).concat(a,`') format('woff'),
            url('`).concat(a,`') format('truetype');
        }`),l.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(t),"L7text"),document.fonts.ready.then(function(){s.emit("fontloaded",{fontFamily:t})})}catch(f){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(f)}},document.getElementsByTagName("head")[0].appendChild(l)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(t,a,s){var l=this.fontOptions,f=l.fontFamily,d=l.fontWeight,S=l.fontSize,O=l.buffer,Z=l.sdf,U=l.radius,se=l.cutoff,le=l.iconfont,ye=s&&s.data;ye||(ye=ha.document.createElement("canvas"),ye.width=Eu);var Be=ye.getContext("2d",{willReadFrequently:!0});Uc(Be,f,S,d);var rt=Ro((0,ue.Z)({getFontWidth:function(_l){return Be.measureText(_l).width},fontHeight:S*tu,buffer:O,characterSet:a,maxCanvasWidth:Eu},s&&{mapping:s.mapping,xOffset:s.xOffset,yOffset:s.yOffset})),Je=rt.mapping,Ot=rt.canvasHeight,jt=rt.xOffset,dr=rt.yOffset,Lr=Be.getImageData(0,0,ye.width,ye.height);if(ye.height=Ot,Be.putImageData(Lr,0,0),Uc(Be,f,S,d),Z){var jr=new($i())(S,O,U,se,f,d),Jr=Be.getImageData(0,0,jr.size,jr.size),Pn=cl(a),In;try{for(Pn.s();!(In=Pn.n()).done;){var Si=In.value;if(le){var ra=String.fromCharCode(parseInt(Si.replace("&#x","").replace(";",""),16)),Va=jr.draw(ra);$f(Va,Jr)}else $f(jr.draw(Si),Jr);Be.putImageData(Jr,Je[Si].x,Je[Si].y)}}catch(zl){Pn.e(zl)}finally{Pn.f()}}else{var Ms=cl(a),vu;try{for(Ms.s();!(vu=Ms.n()).done;){var Bu=vu.value;Be.fillText(Bu,Je[Bu].x,Je[Bu].y+S*wu)}}catch(zl){Ms.e(zl)}finally{Ms.f()}}return{xOffset:jt,yOffset:dr,mapping:Je,data:ye,width:ye.width,height:ye.height}}},{key:"getKey",value:function(){var t=this.fontOptions,a=t.fontFamily,s=t.fontWeight;return"".concat(a,"_").concat(s)}},{key:"getNewChars",value:function(t,a){var s=this.cache.get(t);if(!s)return a;var l=[],f=s.mapping,d=new Set(Object.keys(f)),S=new Set(a);return S.forEach(function(O){d.has(O)||l.push(O)}),l}}]),r}(Kc.EventEmitter))||Lu),Ef,gh;function ed(e){var i=gl();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function gl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Zs=3,Ep=1024,lf=64,xc=(Ef=(0,Xr.b2)(),Ef(gh=function(e){(0,Ft.Z)(r,e);var i=ed(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"canvasHeight",128),(0,V.Z)((0,ct.Z)(n),"texture",void 0),(0,V.Z)((0,ct.Z)(n),"canvas",void 0),(0,V.Z)((0,ct.Z)(n),"iconData",void 0),(0,V.Z)((0,ct.Z)(n),"iconMap",void 0),(0,V.Z)((0,ct.Z)(n),"ctx",void 0),(0,V.Z)((0,ct.Z)(n),"loadingImageCount",0),n}return(0,he.Z)(r,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=ha.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s,l){var f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return f=new Image,this.loadingImageCount++,this.hasImage(s)?console.warn("Image Id already exists"):this.iconData.push({id:s,size:lf}),this.updateIconMap(),O.next=6,this.loadImage(l);case 6:f=O.sent,d=this.iconData.find(function(Z){return Z.id===s}),d&&(d.image=f,d.width=f.width,d.height=f.height),this.update();case 10:case"end":return O.stop()}},a,this)}));function t(a,s){return n.apply(this,arguments)}return t}()},{key:"addImageMini",value:function(t,a,s){var l=this,f=s.getSceneConfig().canvas,d=f.createImage();if(this.loadingImageCount++,this.hasImage(t))throw new Error("Image Id already exists");this.iconData.push({id:t,size:lf}),this.updateIconMap(),this.loadImageMini(a,f).then(function(S){d=S;var O=l.iconData.find(function(Z){return Z.id===t});O&&(O.image=d,O.width=d.width,O.height=d.height),l.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(t){return this.iconMap.hasOwnProperty(t)}},{key:"removeImage",value:function(t){this.hasImage(t)&&(this.iconData=this.iconData.filter(function(a){return a.id!==t}),delete this.iconMap[t],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(t){return new Promise(function(a,s){if(t instanceof HTMLImageElement){a(t);return}var l=new Image;l.crossOrigin="anonymous",l.onload=function(){a(l)},l.onerror=function(){s(new Error("Could not load image at "+t))},l.src=t instanceof File?URL.createObjectURL(t):t})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var t=this;this.canvas.width=Ep,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(a){var s=t.iconMap[a],l=s.x,f=s.y,d=s.image,S=s.width,O=S===void 0?64:S,Z=s.height,U=Z===void 0?64:Z,se=Math.max(O,U),le=se/lf,ye=U/le,Be=O/le;d&&t.ctx.drawImage(d,l+(lf-Be)/2,f+(lf-ye)/2,Be,ye)})}},{key:"updateIconMap",value:function(){var t=No(this.iconData,Zs,Ep),a=t.mapping,s=t.canvasHeight;this.iconMap=a,this.canvasHeight=s}},{key:"loadImageMini",value:function(t,a){return new Promise(function(s,l){var f=a.createImage();f.crossOrigin="anonymous",f.onload=function(){s(f)},f.onerror=function(){l(new Error("Could not load image at "+t))},f.src=t})}}]),r}(Kc.EventEmitter))||gh);function rl(){var e=new ta(16);return ta!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function rh(e){var i=new ta(16);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Jd(e,i){return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e}function Iv(e,i,r,n,t,a,s,l,f,d,S,O,Z,U,se,le){var ye=new ta(16);return ye[0]=e,ye[1]=i,ye[2]=r,ye[3]=n,ye[4]=t,ye[5]=a,ye[6]=s,ye[7]=l,ye[8]=f,ye[9]=d,ye[10]=S,ye[11]=O,ye[12]=Z,ye[13]=U,ye[14]=se,ye[15]=le,ye}function pv(e,i,r,n,t,a,s,l,f,d,S,O,Z,U,se,le,ye){return e[0]=i,e[1]=r,e[2]=n,e[3]=t,e[4]=a,e[5]=s,e[6]=l,e[7]=f,e[8]=d,e[9]=S,e[10]=O,e[11]=Z,e[12]=U,e[13]=se,e[14]=le,e[15]=ye,e}function Zd(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Kv(e,i){if(e===i){var r=i[1],n=i[2],t=i[3],a=i[6],s=i[7],l=i[11];e[1]=i[4],e[2]=i[8],e[3]=i[12],e[4]=r,e[6]=i[9],e[7]=i[13],e[8]=n,e[9]=a,e[11]=i[14],e[12]=t,e[13]=s,e[14]=l}else e[0]=i[0],e[1]=i[4],e[2]=i[8],e[3]=i[12],e[4]=i[1],e[5]=i[5],e[6]=i[9],e[7]=i[13],e[8]=i[2],e[9]=i[6],e[10]=i[10],e[11]=i[14],e[12]=i[3],e[13]=i[7],e[14]=i[11],e[15]=i[15];return e}function td(e,i){var r=i[0],n=i[1],t=i[2],a=i[3],s=i[4],l=i[5],f=i[6],d=i[7],S=i[8],O=i[9],Z=i[10],U=i[11],se=i[12],le=i[13],ye=i[14],Be=i[15],rt=r*l-n*s,Je=r*f-t*s,Ot=r*d-a*s,jt=n*f-t*l,dr=n*d-a*l,Lr=t*d-a*f,jr=S*le-O*se,Jr=S*ye-Z*se,Pn=S*Be-U*se,In=O*ye-Z*le,Si=O*Be-U*le,ra=Z*Be-U*ye,Va=rt*ra-Je*Si+Ot*In+jt*Pn-dr*Jr+Lr*jr;return Va?(Va=1/Va,e[0]=(l*ra-f*Si+d*In)*Va,e[1]=(t*Si-n*ra-a*In)*Va,e[2]=(le*Lr-ye*dr+Be*jt)*Va,e[3]=(Z*dr-O*Lr-U*jt)*Va,e[4]=(f*Pn-s*ra-d*Jr)*Va,e[5]=(r*ra-t*Pn+a*Jr)*Va,e[6]=(ye*Ot-se*Lr-Be*Je)*Va,e[7]=(S*Lr-Z*Ot+U*Je)*Va,e[8]=(s*Si-l*Pn+d*jr)*Va,e[9]=(n*Pn-r*Si-a*jr)*Va,e[10]=(se*dr-le*Ot+Be*rt)*Va,e[11]=(O*Ot-S*dr-U*rt)*Va,e[12]=(l*Jr-s*In-f*jr)*Va,e[13]=(r*In-n*Jr+t*jr)*Va,e[14]=(le*Je-se*jt-ye*rt)*Va,e[15]=(S*jt-O*Je+Z*rt)*Va,e):null}function rd(e,i){var r=i[0],n=i[1],t=i[2],a=i[3],s=i[4],l=i[5],f=i[6],d=i[7],S=i[8],O=i[9],Z=i[10],U=i[11],se=i[12],le=i[13],ye=i[14],Be=i[15];return e[0]=l*(Z*Be-U*ye)-O*(f*Be-d*ye)+le*(f*U-d*Z),e[1]=-(n*(Z*Be-U*ye)-O*(t*Be-a*ye)+le*(t*U-a*Z)),e[2]=n*(f*Be-d*ye)-l*(t*Be-a*ye)+le*(t*d-a*f),e[3]=-(n*(f*U-d*Z)-l*(t*U-a*Z)+O*(t*d-a*f)),e[4]=-(s*(Z*Be-U*ye)-S*(f*Be-d*ye)+se*(f*U-d*Z)),e[5]=r*(Z*Be-U*ye)-S*(t*Be-a*ye)+se*(t*U-a*Z),e[6]=-(r*(f*Be-d*ye)-s*(t*Be-a*ye)+se*(t*d-a*f)),e[7]=r*(f*U-d*Z)-s*(t*U-a*Z)+S*(t*d-a*f),e[8]=s*(O*Be-U*le)-S*(l*Be-d*le)+se*(l*U-d*O),e[9]=-(r*(O*Be-U*le)-S*(n*Be-a*le)+se*(n*U-a*O)),e[10]=r*(l*Be-d*le)-s*(n*Be-a*le)+se*(n*d-a*l),e[11]=-(r*(l*U-d*O)-s*(n*U-a*O)+S*(n*d-a*l)),e[12]=-(s*(O*ye-Z*le)-S*(l*ye-f*le)+se*(l*Z-f*O)),e[13]=r*(O*ye-Z*le)-S*(n*ye-t*le)+se*(n*Z-t*O),e[14]=-(r*(l*ye-f*le)-s*(n*ye-t*le)+se*(n*f-t*l)),e[15]=r*(l*Z-f*O)-s*(n*Z-t*O)+S*(n*f-t*l),e}function dp(e){var i=e[0],r=e[1],n=e[2],t=e[3],a=e[4],s=e[5],l=e[6],f=e[7],d=e[8],S=e[9],O=e[10],Z=e[11],U=e[12],se=e[13],le=e[14],ye=e[15],Be=i*s-r*a,rt=i*l-n*a,Je=i*f-t*a,Ot=r*l-n*s,jt=r*f-t*s,dr=n*f-t*l,Lr=d*se-S*U,jr=d*le-O*U,Jr=d*ye-Z*U,Pn=S*le-O*se,In=S*ye-Z*se,Si=O*ye-Z*le;return Be*Si-rt*In+Je*Pn+Ot*Jr-jt*jr+dr*Lr}function ef(e,i,r){var n=i[0],t=i[1],a=i[2],s=i[3],l=i[4],f=i[5],d=i[6],S=i[7],O=i[8],Z=i[9],U=i[10],se=i[11],le=i[12],ye=i[13],Be=i[14],rt=i[15],Je=r[0],Ot=r[1],jt=r[2],dr=r[3];return e[0]=Je*n+Ot*l+jt*O+dr*le,e[1]=Je*t+Ot*f+jt*Z+dr*ye,e[2]=Je*a+Ot*d+jt*U+dr*Be,e[3]=Je*s+Ot*S+jt*se+dr*rt,Je=r[4],Ot=r[5],jt=r[6],dr=r[7],e[4]=Je*n+Ot*l+jt*O+dr*le,e[5]=Je*t+Ot*f+jt*Z+dr*ye,e[6]=Je*a+Ot*d+jt*U+dr*Be,e[7]=Je*s+Ot*S+jt*se+dr*rt,Je=r[8],Ot=r[9],jt=r[10],dr=r[11],e[8]=Je*n+Ot*l+jt*O+dr*le,e[9]=Je*t+Ot*f+jt*Z+dr*ye,e[10]=Je*a+Ot*d+jt*U+dr*Be,e[11]=Je*s+Ot*S+jt*se+dr*rt,Je=r[12],Ot=r[13],jt=r[14],dr=r[15],e[12]=Je*n+Ot*l+jt*O+dr*le,e[13]=Je*t+Ot*f+jt*Z+dr*ye,e[14]=Je*a+Ot*d+jt*U+dr*Be,e[15]=Je*s+Ot*S+jt*se+dr*rt,e}function Lc(e,i,r){var n=r[0],t=r[1],a=r[2],s,l,f,d,S,O,Z,U,se,le,ye,Be;return i===e?(e[12]=i[0]*n+i[4]*t+i[8]*a+i[12],e[13]=i[1]*n+i[5]*t+i[9]*a+i[13],e[14]=i[2]*n+i[6]*t+i[10]*a+i[14],e[15]=i[3]*n+i[7]*t+i[11]*a+i[15]):(s=i[0],l=i[1],f=i[2],d=i[3],S=i[4],O=i[5],Z=i[6],U=i[7],se=i[8],le=i[9],ye=i[10],Be=i[11],e[0]=s,e[1]=l,e[2]=f,e[3]=d,e[4]=S,e[5]=O,e[6]=Z,e[7]=U,e[8]=se,e[9]=le,e[10]=ye,e[11]=Be,e[12]=s*n+S*t+se*a+i[12],e[13]=l*n+O*t+le*a+i[13],e[14]=f*n+Z*t+ye*a+i[14],e[15]=d*n+U*t+Be*a+i[15]),e}function Ru(e,i,r){var n=r[0],t=r[1],a=r[2];return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=i[3]*n,e[4]=i[4]*t,e[5]=i[5]*t,e[6]=i[6]*t,e[7]=i[7]*t,e[8]=i[8]*a,e[9]=i[9]*a,e[10]=i[10]*a,e[11]=i[11]*a,e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e}function Rc(e,i,r,n){var t=n[0],a=n[1],s=n[2],l=Math.hypot(t,a,s),f,d,S,O,Z,U,se,le,ye,Be,rt,Je,Ot,jt,dr,Lr,jr,Jr,Pn,In,Si,ra,Va,Ms;return l<Ri?null:(l=1/l,t*=l,a*=l,s*=l,f=Math.sin(r),d=Math.cos(r),S=1-d,O=i[0],Z=i[1],U=i[2],se=i[3],le=i[4],ye=i[5],Be=i[6],rt=i[7],Je=i[8],Ot=i[9],jt=i[10],dr=i[11],Lr=t*t*S+d,jr=a*t*S+s*f,Jr=s*t*S-a*f,Pn=t*a*S-s*f,In=a*a*S+d,Si=s*a*S+t*f,ra=t*s*S+a*f,Va=a*s*S-t*f,Ms=s*s*S+d,e[0]=O*Lr+le*jr+Je*Jr,e[1]=Z*Lr+ye*jr+Ot*Jr,e[2]=U*Lr+Be*jr+jt*Jr,e[3]=se*Lr+rt*jr+dr*Jr,e[4]=O*Pn+le*In+Je*Si,e[5]=Z*Pn+ye*In+Ot*Si,e[6]=U*Pn+Be*In+jt*Si,e[7]=se*Pn+rt*In+dr*Si,e[8]=O*ra+le*Va+Je*Ms,e[9]=Z*ra+ye*Va+Ot*Ms,e[10]=U*ra+Be*Va+jt*Ms,e[11]=se*ra+rt*Va+dr*Ms,i!==e&&(e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e)}function wp(e,i,r){var n=Math.sin(r),t=Math.cos(r),a=i[4],s=i[5],l=i[6],f=i[7],d=i[8],S=i[9],O=i[10],Z=i[11];return i!==e&&(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e[4]=a*t+d*n,e[5]=s*t+S*n,e[6]=l*t+O*n,e[7]=f*t+Z*n,e[8]=d*t-a*n,e[9]=S*t-s*n,e[10]=O*t-l*n,e[11]=Z*t-f*n,e}function zp(e,i,r){var n=Math.sin(r),t=Math.cos(r),a=i[0],s=i[1],l=i[2],f=i[3],d=i[8],S=i[9],O=i[10],Z=i[11];return i!==e&&(e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e[0]=a*t-d*n,e[1]=s*t-S*n,e[2]=l*t-O*n,e[3]=f*t-Z*n,e[8]=a*n+d*t,e[9]=s*n+S*t,e[10]=l*n+O*t,e[11]=f*n+Z*t,e}function vp(e,i,r){var n=Math.sin(r),t=Math.cos(r),a=i[0],s=i[1],l=i[2],f=i[3],d=i[4],S=i[5],O=i[6],Z=i[7];return i!==e&&(e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e[0]=a*t+d*n,e[1]=s*t+S*n,e[2]=l*t+O*n,e[3]=f*t+Z*n,e[4]=d*t-a*n,e[5]=S*t-s*n,e[6]=O*t-l*n,e[7]=Z*t-f*n,e}function dv(e,i){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function Lv(e,i){return e[0]=i[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=i[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Rv(e,i,r){var n=r[0],t=r[1],a=r[2],s=Math.hypot(n,t,a),l,f,d;return s<Ri?null:(s=1/s,n*=s,t*=s,a*=s,l=Math.sin(i),f=Math.cos(i),d=1-f,e[0]=n*n*d+f,e[1]=t*n*d+a*l,e[2]=a*n*d-t*l,e[3]=0,e[4]=n*t*d-a*l,e[5]=t*t*d+f,e[6]=a*t*d+n*l,e[7]=0,e[8]=n*a*d+t*l,e[9]=t*a*d-n*l,e[10]=a*a*d+f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function tp(e,i){var r=Math.sin(i),n=Math.cos(i);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function kv(e,i){var r=Math.sin(i),n=Math.cos(i);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function yd(e,i){var r=Math.sin(i),n=Math.cos(i);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ev(e,i,r){var n=i[0],t=i[1],a=i[2],s=i[3],l=n+n,f=t+t,d=a+a,S=n*l,O=n*f,Z=n*d,U=t*f,se=t*d,le=a*d,ye=s*l,Be=s*f,rt=s*d;return e[0]=1-(U+le),e[1]=O+rt,e[2]=Z-Be,e[3]=0,e[4]=O-rt,e[5]=1-(S+le),e[6]=se+ye,e[7]=0,e[8]=Z+Be,e[9]=se-ye,e[10]=1-(S+U),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function vv(e,i){var r=new ta(3),n=-i[0],t=-i[1],a=-i[2],s=i[3],l=i[4],f=i[5],d=i[6],S=i[7],O=n*n+t*t+a*a+s*s;return O>0?(r[0]=(l*s+S*n+f*a-d*t)*2/O,r[1]=(f*s+S*t+d*n-l*a)*2/O,r[2]=(d*s+S*a+l*t-f*n)*2/O):(r[0]=(l*s+S*n+f*a-d*t)*2,r[1]=(f*s+S*t+d*n-l*a)*2,r[2]=(d*s+S*a+l*t-f*n)*2),ev(e,i,r),e}function mv(e,i){return e[0]=i[12],e[1]=i[13],e[2]=i[14],e}function nd(e,i){var r=i[0],n=i[1],t=i[2],a=i[4],s=i[5],l=i[6],f=i[8],d=i[9],S=i[10];return e[0]=Math.hypot(r,n,t),e[1]=Math.hypot(a,s,l),e[2]=Math.hypot(f,d,S),e}function Ih(e,i){var r=new ta(3);nd(r,i);var n=1/r[0],t=1/r[1],a=1/r[2],s=i[0]*n,l=i[1]*t,f=i[2]*a,d=i[4]*n,S=i[5]*t,O=i[6]*a,Z=i[8]*n,U=i[9]*t,se=i[10]*a,le=s+S+se,ye=0;return le>0?(ye=Math.sqrt(le+1)*2,e[3]=.25*ye,e[0]=(O-U)/ye,e[1]=(Z-f)/ye,e[2]=(l-d)/ye):s>S&&s>se?(ye=Math.sqrt(1+s-S-se)*2,e[3]=(O-U)/ye,e[0]=.25*ye,e[1]=(l+d)/ye,e[2]=(Z+f)/ye):S>se?(ye=Math.sqrt(1+S-s-se)*2,e[3]=(Z-f)/ye,e[0]=(l+d)/ye,e[1]=.25*ye,e[2]=(O+U)/ye):(ye=Math.sqrt(1+se-s-S)*2,e[3]=(l-d)/ye,e[0]=(Z+f)/ye,e[1]=(O+U)/ye,e[2]=.25*ye),e}function Zp(e,i,r,n){var t=i[0],a=i[1],s=i[2],l=i[3],f=t+t,d=a+a,S=s+s,O=t*f,Z=t*d,U=t*S,se=a*d,le=a*S,ye=s*S,Be=l*f,rt=l*d,Je=l*S,Ot=n[0],jt=n[1],dr=n[2];return e[0]=(1-(se+ye))*Ot,e[1]=(Z+Je)*Ot,e[2]=(U-rt)*Ot,e[3]=0,e[4]=(Z-Je)*jt,e[5]=(1-(O+ye))*jt,e[6]=(le+Be)*jt,e[7]=0,e[8]=(U+rt)*dr,e[9]=(le-Be)*dr,e[10]=(1-(O+se))*dr,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function m0(e,i,r,n,t){var a=i[0],s=i[1],l=i[2],f=i[3],d=a+a,S=s+s,O=l+l,Z=a*d,U=a*S,se=a*O,le=s*S,ye=s*O,Be=l*O,rt=f*d,Je=f*S,Ot=f*O,jt=n[0],dr=n[1],Lr=n[2],jr=t[0],Jr=t[1],Pn=t[2],In=(1-(le+Be))*jt,Si=(U+Ot)*jt,ra=(se-Je)*jt,Va=(U-Ot)*dr,Ms=(1-(Z+Be))*dr,vu=(ye+rt)*dr,Bu=(se+Je)*Lr,zl=(ye-rt)*Lr,_l=(1-(Z+le))*Lr;return e[0]=In,e[1]=Si,e[2]=ra,e[3]=0,e[4]=Va,e[5]=Ms,e[6]=vu,e[7]=0,e[8]=Bu,e[9]=zl,e[10]=_l,e[11]=0,e[12]=r[0]+jr-(In*jr+Va*Jr+Bu*Pn),e[13]=r[1]+Jr-(Si*jr+Ms*Jr+zl*Pn),e[14]=r[2]+Pn-(ra*jr+vu*Jr+_l*Pn),e[15]=1,e}function q0(e,i){var r=i[0],n=i[1],t=i[2],a=i[3],s=r+r,l=n+n,f=t+t,d=r*s,S=n*s,O=n*l,Z=t*s,U=t*l,se=t*f,le=a*s,ye=a*l,Be=a*f;return e[0]=1-O-se,e[1]=S+Be,e[2]=Z-ye,e[3]=0,e[4]=S-Be,e[5]=1-d-se,e[6]=U+le,e[7]=0,e[8]=Z+ye,e[9]=U-le,e[10]=1-d-O,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function g0(e,i,r,n,t,a,s){var l=1/(r-i),f=1/(t-n),d=1/(a-s);return e[0]=a*2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*f,e[6]=0,e[7]=0,e[8]=(r+i)*l,e[9]=(t+n)*f,e[10]=(s+a)*d,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*a*2*d,e[15]=0,e}function y0(e,i,r,n,t){var a=1/Math.tan(i/2),s;return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,t!=null&&t!==1/0?(s=1/(n-t),e[10]=(t+n)*s,e[14]=2*t*n*s):(e[10]=-1,e[14]=-2*n),e}var _d=y0;function Q0(e,i,r,n,t){var a=1/Math.tan(i/2),s;return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,t!=null&&t!==1/0?(s=1/(n-t),e[10]=t*s,e[14]=t*n*s):(e[10]=-1,e[14]=-n),e}function Sp(e,i,r,n){var t=Math.tan(i.upDegrees*Math.PI/180),a=Math.tan(i.downDegrees*Math.PI/180),s=Math.tan(i.leftDegrees*Math.PI/180),l=Math.tan(i.rightDegrees*Math.PI/180),f=2/(s+l),d=2/(t+a);return e[0]=f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=d,e[6]=0,e[7]=0,e[8]=-((s-l)*f*.5),e[9]=(t-a)*d*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function Yo(e,i,r,n,t,a,s){var l=1/(i-r),f=1/(n-t),d=1/(a-s);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(i+r)*l,e[13]=(t+n)*f,e[14]=(s+a)*d,e[15]=1,e}var Up=Yo;function Cp(e,i,r,n,t,a,s){var l=1/(i-r),f=1/(n-t),d=1/(a-s);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=d,e[11]=0,e[12]=(i+r)*l,e[13]=(t+n)*f,e[14]=a*d,e[15]=1,e}function mp(e,i,r,n){var t,a,s,l,f,d,S,O,Z,U,se=i[0],le=i[1],ye=i[2],Be=n[0],rt=n[1],Je=n[2],Ot=r[0],jt=r[1],dr=r[2];return Math.abs(se-Ot)<Ri&&Math.abs(le-jt)<Ri&&Math.abs(ye-dr)<Ri?Zd(e):(S=se-Ot,O=le-jt,Z=ye-dr,U=1/Math.hypot(S,O,Z),S*=U,O*=U,Z*=U,t=rt*Z-Je*O,a=Je*S-Be*Z,s=Be*O-rt*S,U=Math.hypot(t,a,s),U?(U=1/U,t*=U,a*=U,s*=U):(t=0,a=0,s=0),l=O*s-Z*a,f=Z*t-S*s,d=S*a-O*t,U=Math.hypot(l,f,d),U?(U=1/U,l*=U,f*=U,d*=U):(l=0,f=0,d=0),e[0]=t,e[1]=l,e[2]=S,e[3]=0,e[4]=a,e[5]=f,e[6]=O,e[7]=0,e[8]=s,e[9]=d,e[10]=Z,e[11]=0,e[12]=-(t*se+a*le+s*ye),e[13]=-(l*se+f*le+d*ye),e[14]=-(S*se+O*le+Z*ye),e[15]=1,e)}function _0(e,i,r,n){var t=i[0],a=i[1],s=i[2],l=n[0],f=n[1],d=n[2],S=t-r[0],O=a-r[1],Z=s-r[2],U=S*S+O*O+Z*Z;U>0&&(U=1/Math.sqrt(U),S*=U,O*=U,Z*=U);var se=f*Z-d*O,le=d*S-l*Z,ye=l*O-f*S;return U=se*se+le*le+ye*ye,U>0&&(U=1/Math.sqrt(U),se*=U,le*=U,ye*=U),e[0]=se,e[1]=le,e[2]=ye,e[3]=0,e[4]=O*ye-Z*le,e[5]=Z*se-S*ye,e[6]=S*le-O*se,e[7]=0,e[8]=S,e[9]=O,e[10]=Z,e[11]=0,e[12]=t,e[13]=a,e[14]=s,e[15]=1,e}function Nl(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function qv(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function id(e,i,r){return e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e[3]=i[3]+r[3],e[4]=i[4]+r[4],e[5]=i[5]+r[5],e[6]=i[6]+r[6],e[7]=i[7]+r[7],e[8]=i[8]+r[8],e[9]=i[9]+r[9],e[10]=i[10]+r[10],e[11]=i[11]+r[11],e[12]=i[12]+r[12],e[13]=i[13]+r[13],e[14]=i[14]+r[14],e[15]=i[15]+r[15],e}function Ud(e,i,r){return e[0]=i[0]-r[0],e[1]=i[1]-r[1],e[2]=i[2]-r[2],e[3]=i[3]-r[3],e[4]=i[4]-r[4],e[5]=i[5]-r[5],e[6]=i[6]-r[6],e[7]=i[7]-r[7],e[8]=i[8]-r[8],e[9]=i[9]-r[9],e[10]=i[10]-r[10],e[11]=i[11]-r[11],e[12]=i[12]-r[12],e[13]=i[13]-r[13],e[14]=i[14]-r[14],e[15]=i[15]-r[15],e}function Dv(e,i,r){return e[0]=i[0]*r,e[1]=i[1]*r,e[2]=i[2]*r,e[3]=i[3]*r,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=i[7]*r,e[8]=i[8]*r,e[9]=i[9]*r,e[10]=i[10]*r,e[11]=i[11]*r,e[12]=i[12]*r,e[13]=i[13]*r,e[14]=i[14]*r,e[15]=i[15]*r,e}function Qv(e,i,r,n){return e[0]=i[0]+r[0]*n,e[1]=i[1]+r[1]*n,e[2]=i[2]+r[2]*n,e[3]=i[3]+r[3]*n,e[4]=i[4]+r[4]*n,e[5]=i[5]+r[5]*n,e[6]=i[6]+r[6]*n,e[7]=i[7]+r[7]*n,e[8]=i[8]+r[8]*n,e[9]=i[9]+r[9]*n,e[10]=i[10]+r[10]*n,e[11]=i[11]+r[11]*n,e[12]=i[12]+r[12]*n,e[13]=i[13]+r[13]*n,e[14]=i[14]+r[14]*n,e[15]=i[15]+r[15]*n,e}function Jv(e,i){return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]&&e[3]===i[3]&&e[4]===i[4]&&e[5]===i[5]&&e[6]===i[6]&&e[7]===i[7]&&e[8]===i[8]&&e[9]===i[9]&&e[10]===i[10]&&e[11]===i[11]&&e[12]===i[12]&&e[13]===i[13]&&e[14]===i[14]&&e[15]===i[15]}function Fv(e,i){var r=e[0],n=e[1],t=e[2],a=e[3],s=e[4],l=e[5],f=e[6],d=e[7],S=e[8],O=e[9],Z=e[10],U=e[11],se=e[12],le=e[13],ye=e[14],Be=e[15],rt=i[0],Je=i[1],Ot=i[2],jt=i[3],dr=i[4],Lr=i[5],jr=i[6],Jr=i[7],Pn=i[8],In=i[9],Si=i[10],ra=i[11],Va=i[12],Ms=i[13],vu=i[14],Bu=i[15];return Math.abs(r-rt)<=Ri*Math.max(1,Math.abs(r),Math.abs(rt))&&Math.abs(n-Je)<=Ri*Math.max(1,Math.abs(n),Math.abs(Je))&&Math.abs(t-Ot)<=Ri*Math.max(1,Math.abs(t),Math.abs(Ot))&&Math.abs(a-jt)<=Ri*Math.max(1,Math.abs(a),Math.abs(jt))&&Math.abs(s-dr)<=Ri*Math.max(1,Math.abs(s),Math.abs(dr))&&Math.abs(l-Lr)<=Ri*Math.max(1,Math.abs(l),Math.abs(Lr))&&Math.abs(f-jr)<=Ri*Math.max(1,Math.abs(f),Math.abs(jr))&&Math.abs(d-Jr)<=Ri*Math.max(1,Math.abs(d),Math.abs(Jr))&&Math.abs(S-Pn)<=Ri*Math.max(1,Math.abs(S),Math.abs(Pn))&&Math.abs(O-In)<=Ri*Math.max(1,Math.abs(O),Math.abs(In))&&Math.abs(Z-Si)<=Ri*Math.max(1,Math.abs(Z),Math.abs(Si))&&Math.abs(U-ra)<=Ri*Math.max(1,Math.abs(U),Math.abs(ra))&&Math.abs(se-Va)<=Ri*Math.max(1,Math.abs(se),Math.abs(Va))&&Math.abs(le-Ms)<=Ri*Math.max(1,Math.abs(le),Math.abs(Ms))&&Math.abs(ye-vu)<=Ri*Math.max(1,Math.abs(ye),Math.abs(vu))&&Math.abs(Be-Bu)<=Ri*Math.max(1,Math.abs(Be),Math.abs(Bu))}var J0=ef,Bv=Ud,x0,b0,em=(x0=(0,Xr.b2)(),x0(b0=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"viewport",void 0),(0,V.Z)(this,"overridedViewProjectionMatrix",void 0),(0,V.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,V.Z)(this,"jitteredProjectionMatrix",void 0),(0,V.Z)(this,"viewMatrixInverse",void 0),(0,V.Z)(this,"cameraPosition",void 0)}return(0,he.Z)(e,[{key:"init",value:function(){}},{key:"update",value:function(r){this.viewport=r,this.viewMatrixInverse=rl(),td(this.viewMatrixInverse,r.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var r=this.viewport.getCenter(),n=(0,Ja.Z)(r,2),t=n[0],a=n[1];return[t,a]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(r,n){return this.viewport.projectFlat(r,n)}},{key:"setViewProjectionMatrix",value:function(r){this.overridedViewProjectionMatrix=r}},{key:"jitterProjectionMatrix",value:function(r,n){var t=dv(rl(),[r,n,0]);this.jitteredProjectionMatrix=ef(rl(),t,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=ef(rl(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}())||b0),jp;(function(e){e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter",e.LEFTTOP="lefttop",e.RIGHTTOP="righttop",e.LEFTBOTTOM="leftbottom",e.RIGHTBOTTOM="rightbottom"})(jp||(jp={}));var E0,rp;function e0(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Nv(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Nv(e,i){if(e){if(typeof e=="string")return ad(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ad(e,i)}}function ad(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var w0={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},tm=(E0=(0,Xr.b2)(),E0(rp=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"container",void 0),(0,V.Z)(this,"controlCorners",void 0),(0,V.Z)(this,"controlContainer",void 0),(0,V.Z)(this,"scene",void 0),(0,V.Z)(this,"mapsService",void 0),(0,V.Z)(this,"controls",[]),(0,V.Z)(this,"unAddControls",[])}return(0,he.Z)(e,[{key:"init",value:function(r,n){this.container=r.container,this.scene=n,this.mapsService=n.get(Ir.IMapService),this.initControlPos()}},{key:"addControl",value:function(r,n){var t=n.get(Ir.IMapService);t.map?(r.addTo(this.scene),this.controls.push(r)):this.unAddControls.push(r)}},{key:"getControlByName",value:function(r){return this.controls.find(function(n){return n.controlOption.name===r})}},{key:"removeControl",value:function(r){var n=this.controls.indexOf(r);return n>-1&&this.controls.splice(n,1),r.remove(),this}},{key:"addControls",value:function(){var r=this;this.unAddControls.forEach(function(n){n.addTo(r.scene),r.controls.push(n)}),this.unAddControls=[]}},{key:"destroy",value:function(){var r=e0(this.controls),n;try{for(r.s();!(n=r.n()).done;){var t=n.value;t.remove()}}catch(a){r.e(a)}finally{r.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var r=this.controlCorners={},n="l7-",t=this.controlContainer=ss("div",n+"control-container",this.container);function a(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],f=l.map(function(d){return n+d}).join(" ");r[l.filter(function(d){return!["row","column"].includes(d)}).join("")]=ss("div",f,t)}function s(l){var f=l.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat((0,oe.Z)(f),[w0[l]])}Object.values(jp).forEach(function(l){a(s(l))})}},{key:"clearControlPos",value:function(){for(var r in this.controlCorners)this.controlCorners[r]&&Uu(this.controlCorners[r]);this.controlContainer&&Uu(this.controlContainer)}}]),e}())||rp),Od,jd,cf=(Od=(0,Xr.b2)(),Od(jd=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"container",void 0),(0,V.Z)(this,"scene",void 0),(0,V.Z)(this,"mapsService",void 0),(0,V.Z)(this,"markers",[]),(0,V.Z)(this,"markerLayers",[]),(0,V.Z)(this,"unAddMarkers",[]),(0,V.Z)(this,"unAddMarkerLayers",[])}return(0,he.Z)(e,[{key:"addMarkerLayer",value:function(r){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(r),r.addTo(this.scene)):this.unAddMarkerLayers.push(r)}},{key:"removeMarkerLayer",value:function(r){r.destroy(),this.markerLayers.indexOf(r);var n=this.markerLayers.indexOf(r);n>-1&&this.markerLayers.splice(n,1)}},{key:"addMarker",value:function(r){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(r),r.addTo(this.scene)):this.unAddMarkers.push(r)}},{key:"addMarkers",value:function(){var r=this;this.unAddMarkers.forEach(function(n){n.addTo(r.scene),r.markers.push(n)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var r=this;this.unAddMarkerLayers.forEach(function(n){r.markerLayers.push(n),n.addTo(r.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(r){r.remove(),this.markers.indexOf(r);var n=this.markers.indexOf(r);n>-1&&this.markers.splice(n,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(r){this.scene=r,this.mapsService=r.get(Ir.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(r){r.remove()}),this.markers=[],this.markerLayers.forEach(function(r){r.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(r){r.destroy()}}]),e}())||jd),Nf,tv,rm=(Nf=(0,Xr.b2)(),Nf(tv=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"scene",void 0),(0,V.Z)(this,"mapsService",void 0),(0,V.Z)(this,"popups",[]),(0,V.Z)(this,"unAddPopups",[])}return(0,he.Z)(e,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(r){r!=null&&r.isOpen()&&r.remove();var n=this.popups.indexOf(r);n>-1&&this.popups.splice(n,1);var t=this.unAddPopups.indexOf(r);t>-1&&this.unAddPopups.splice(t,1)}},{key:"destroy",value:function(){this.popups.forEach(function(r){return r.remove()})}},{key:"addPopup",value:function(r){var n=this;r&&r.getOptions().autoClose&&[].concat((0,oe.Z)(this.popups),(0,oe.Z)(this.unAddPopups)).forEach(function(t){t.getOptions().autoClose&&n.removePopup(t)}),this.isMarkerReady?(r.addTo(this.scene),this.popups.push(r)):this.unAddPopups.push(r),r.on("close",function(){n.removePopup(r)})}},{key:"initPopup",value:function(){var r=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(n){r.addPopup(n),r.unAddPopups=[]})}},{key:"init",value:function(r){this.scene=r,this.mapsService=r.get(Ir.IMapService)}}]),e}())||tv),nm={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},S0=nm,t0,gv,C0={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,isMini:!1,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},xd={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},im=(t0=(0,Xr.b2)(),t0(gv=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"sceneConfigCache",{}),(0,V.Z)(this,"layerConfigCache",{}),(0,V.Z)(this,"layerAttributeConfigCache",{})}return(0,he.Z)(e,[{key:"getSceneConfig",value:function(r){return this.sceneConfigCache[r]}},{key:"getSceneWarninfo",value:function(r){return S0[r]}},{key:"setSceneConfig",value:function(r,n){this.sceneConfigCache[r]=(0,ue.Z)((0,ue.Z)({},C0),n)}},{key:"getLayerConfig",value:function(r){return this.layerConfigCache[r]}},{key:"setLayerConfig",value:function(r,n,t){this.layerConfigCache[n]=(0,ue.Z)({},(0,Kn.merge)({},this.sceneConfigCache[r],xd,t))}},{key:"getAttributeConfig",value:function(r){return this.layerAttributeConfigCache[r]}},{key:"setAttributeConfig",value:function(r,n){this.layerAttributeConfigCache[r]=(0,ue.Z)((0,ue.Z)({},this.layerAttributeConfigCache[r]),n)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}())||gv);function Ys(e,i,r,n){r&&Object.defineProperty(e,i,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function Hs(e,i,r,n,t){var a={};return Object.keys(n).forEach(function(s){a[s]=n[s]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=r.slice().reverse().reduce(function(s,l){return l(e,i,s)||s},a),t&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(t):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(e,i,a),a=null),a}function zv(){var e=new ta(4);return ta!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function A0(e){var i=new glMatrix.ARRAY_TYPE(4);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}function T0(e,i,r,n){var t=new ta(4);return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}function og(e,i){return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}function am(e,i,r,n,t){return e[0]=i,e[1]=r,e[2]=n,e[3]=t,e}function om(e,i,r){return e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e[3]=i[3]+r[3],e}function oc(e,i,r){return e[0]=i[0]-r[0],e[1]=i[1]-r[1],e[2]=i[2]-r[2],e[3]=i[3]-r[3],e}function sg(e,i,r){return e[0]=i[0]*r[0],e[1]=i[1]*r[1],e[2]=i[2]*r[2],e[3]=i[3]*r[3],e}function M0(e,i,r){return e[0]=i[0]/r[0],e[1]=i[1]/r[1],e[2]=i[2]/r[2],e[3]=i[3]/r[3],e}function P0(e,i){return e[0]=Math.ceil(i[0]),e[1]=Math.ceil(i[1]),e[2]=Math.ceil(i[2]),e[3]=Math.ceil(i[3]),e}function r0(e,i){return e[0]=Math.floor(i[0]),e[1]=Math.floor(i[1]),e[2]=Math.floor(i[2]),e[3]=Math.floor(i[3]),e}function ug(e,i,r){return e[0]=Math.min(i[0],r[0]),e[1]=Math.min(i[1],r[1]),e[2]=Math.min(i[2],r[2]),e[3]=Math.min(i[3],r[3]),e}function sm(e,i,r){return e[0]=Math.max(i[0],r[0]),e[1]=Math.max(i[1],r[1]),e[2]=Math.max(i[2],r[2]),e[3]=Math.max(i[3],r[3]),e}function O0(e,i){return e[0]=Math.round(i[0]),e[1]=Math.round(i[1]),e[2]=Math.round(i[2]),e[3]=Math.round(i[3]),e}function um(e,i,r){return e[0]=i[0]*r,e[1]=i[1]*r,e[2]=i[2]*r,e[3]=i[3]*r,e}function lg(e,i,r,n){return e[0]=i[0]+r[0]*n,e[1]=i[1]+r[1]*n,e[2]=i[2]+r[2]*n,e[3]=i[3]+r[3]*n,e}function iy(e,i){var r=i[0]-e[0],n=i[1]-e[1],t=i[2]-e[2],a=i[3]-e[3];return Math.hypot(r,n,t,a)}function ay(e,i){var r=i[0]-e[0],n=i[1]-e[1],t=i[2]-e[2],a=i[3]-e[3];return r*r+n*n+t*t+a*a}function cg(e){var i=e[0],r=e[1],n=e[2],t=e[3];return Math.hypot(i,r,n,t)}function Id(e){var i=e[0],r=e[1],n=e[2],t=e[3];return i*i+r*r+n*n+t*t}function I0(e,i){return e[0]=-i[0],e[1]=-i[1],e[2]=-i[2],e[3]=-i[3],e}function lm(e,i){return e[0]=1/i[0],e[1]=1/i[1],e[2]=1/i[2],e[3]=1/i[3],e}function yv(e,i){var r=i[0],n=i[1],t=i[2],a=i[3],s=r*r+n*n+t*t+a*a;return s>0&&(s=1/Math.sqrt(s)),e[0]=r*s,e[1]=n*s,e[2]=t*s,e[3]=a*s,e}function n0(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]+e[3]*i[3]}function rv(e,i,r,n){var t=r[0]*n[1]-r[1]*n[0],a=r[0]*n[2]-r[2]*n[0],s=r[0]*n[3]-r[3]*n[0],l=r[1]*n[2]-r[2]*n[1],f=r[1]*n[3]-r[3]*n[1],d=r[2]*n[3]-r[3]*n[2],S=i[0],O=i[1],Z=i[2],U=i[3];return e[0]=O*d-Z*f+U*l,e[1]=-(S*d)+Z*s-U*a,e[2]=S*f-O*s+U*t,e[3]=-(S*l)+O*a-Z*t,e}function Mb(e,i,r,n){var t=i[0],a=i[1],s=i[2],l=i[3];return e[0]=t+n*(r[0]-t),e[1]=a+n*(r[1]-a),e[2]=s+n*(r[2]-s),e[3]=l+n*(r[3]-l),e}function Pb(e,i){i=i||1;var r,n,t,a,s,l;do r=glMatrix.RANDOM()*2-1,n=glMatrix.RANDOM()*2-1,s=r*r+n*n;while(s>=1);do t=glMatrix.RANDOM()*2-1,a=glMatrix.RANDOM()*2-1,l=t*t+a*a;while(l>=1);var f=Math.sqrt((1-s)/l);return e[0]=i*r,e[1]=i*n,e[2]=i*t*f,e[3]=i*a*f,e}function Zv(e,i,r){var n=i[0],t=i[1],a=i[2],s=i[3];return e[0]=r[0]*n+r[4]*t+r[8]*a+r[12]*s,e[1]=r[1]*n+r[5]*t+r[9]*a+r[13]*s,e[2]=r[2]*n+r[6]*t+r[10]*a+r[14]*s,e[3]=r[3]*n+r[7]*t+r[11]*a+r[15]*s,e}function S1(e,i,r){var n=i[0],t=i[1],a=i[2],s=r[0],l=r[1],f=r[2],d=r[3],S=d*n+l*a-f*t,O=d*t+f*n-s*a,Z=d*a+s*t-l*n,U=-s*n-l*t-f*a;return e[0]=S*d+U*-s+O*-f-Z*-l,e[1]=O*d+U*-l+Z*-s-S*-f,e[2]=Z*d+U*-f+S*-l-O*-s,e[3]=i[3],e}function Ob(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function oy(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function cm(e,i){return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]&&e[3]===i[3]}function fg(e,i){var r=e[0],n=e[1],t=e[2],a=e[3],s=i[0],l=i[1],f=i[2],d=i[3];return Math.abs(r-s)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(t-f)<=glMatrix.EPSILON*Math.max(1,Math.abs(t),Math.abs(f))&&Math.abs(a-d)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))}var fm=null,Ib=null,Lb=null,Rb=null,kb=null,hm=null,pm=null,dm=function(){var e=zv();return function(i,r,n,t,a,s){var l,f;for(r||(r=4),n||(n=0),t?f=Math.min(t*r+n,i.length):f=i.length,l=n;l<f;l+=r)e[0]=i[l],e[1]=i[l+1],e[2]=i[l+2],e[3]=i[l+3],a(e,e,s),i[l]=e[0],i[l+1]=e[1],i[l+2]=e[2],i[l+3]=e[3];return i}}(),Vd=Math.PI/180,nv=512,_v=4003e4;function xv(e){var i=e.latitude,r=i===void 0?0:i,n=e.zoom,t=n===void 0?0:n,a=e.scale,s=e.highPrecision,l=s===void 0?!1:s,f=e.flipY,d=f===void 0?!1:f;a=a!==void 0?a:Math.pow(2,t);var S={},O=nv*a,Z=Math.cos(r*Vd),U=O/360,se=U/Z,le=O/_v/Z;if(S.pixelsPerMeter=[le,-le,le],S.metersPerPixel=[1/le,-1/le,1/le],S.pixelsPerDegree=[U,-se,le],S.degreesPerPixel=[1/U,-1/se,1/le],l){var ye=Vd*Math.tan(r*Vd)/Z,Be=U*ye/2,rt=O/_v*ye,Je=rt/se*le;S.pixelsPerDegree2=[0,-Be,rt],S.pixelsPerMeter2=[Je,0,Je],d&&(S.pixelsPerDegree2[1]=-S.pixelsPerDegree2[1],S.pixelsPerMeter2[1]=-S.pixelsPerMeter2[1])}return d&&(S.pixelsPerMeter[1]=-S.pixelsPerMeter[1],S.metersPerPixel[1]=-S.metersPerPixel[1],S.pixelsPerDegree[1]=-S.pixelsPerDegree[1],S.degreesPerPixel[1]=-S.degreesPerPixel[1]),S}var Wf;(function(e){e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.P20=5]="P20",e[e.P20_OFFSET=6]="P20_OFFSET",e[e.METER_OFFSET=7]="METER_OFFSET",e[e.P20_2=8]="P20_2"})(Wf||(Wf={}));var Hd={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},iv,hg,Hh,bv,vm,sy=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],C1=(iv=(0,Xr.b2)(),hg=(0,Xr.f3)(Ir.ICameraService),iv(Hh=(bv=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"needRefresh",!0),Ys(this,"cameraService",vm,this),(0,V.Z)(this,"coordinateSystem",void 0),(0,V.Z)(this,"viewportCenter",void 0),(0,V.Z)(this,"viewportCenterProjection",void 0),(0,V.Z)(this,"pixelsPerDegree",void 0),(0,V.Z)(this,"pixelsPerDegree2",void 0),(0,V.Z)(this,"pixelsPerMeter",void 0)}return(0,he.Z)(e,[{key:"refresh",value:function(r){var n=this.cameraService.getZoom(),t=this.cameraService.getZoomScale(),a=r||this.cameraService.getCenter(),s=xv({latitude:a[1],zoom:n}),l=s.pixelsPerMeter,f=s.pixelsPerDegree;this.viewportCenter=a,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=l,this.pixelsPerDegree=f,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Wf.LNGLAT||this.coordinateSystem===Wf.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Wf.LNGLAT_OFFSET?this.calculateLnglatOffset(a,n):this.coordinateSystem===Wf.P20_OFFSET&&this.calculateLnglatOffset(a,n,t,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(r){this.coordinateSystem=r}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(r,n,t,a){var s=xv({latitude:r[1],zoom:n,scale:t,flipY:a,highPrecision:!0}),l=s.pixelsPerMeter,f=s.pixelsPerDegree,d=s.pixelsPerDegree2,S=this.cameraService.getViewMatrix(),O=this.cameraService.getProjectionMatrix(),Z=ef([],O,S),U=this.cameraService.projectFlat([Math.fround(r[0]),Math.fround(r[1])],Math.pow(2,n));this.viewportCenterProjection=Zv([],[U[0],U[1],0,1],Z),S=this.cameraService.getViewMatrixUncentered()||S,Z=ef([],O,S),Z=ef([],Z,sy),this.cameraService.setViewProjectionMatrix(Z),this.pixelsPerMeter=l,this.pixelsPerDegree=f,this.pixelsPerDegree2=d}}]),e}(),vm=Hs(bv.prototype,"cameraService",[hg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bv))||Hh),av,i0;function yh(e){var i=mm();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function mm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var gm=(av=(0,Xr.b2)(),av(i0=function(e){(0,Ft.Z)(r,e);var i=yh(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"renderMap",new Map),(0,V.Z)((0,ct.Z)(n),"enable",!1),(0,V.Z)((0,ct.Z)(n),"renderEnable",!1),(0,V.Z)((0,ct.Z)(n),"cacheLogs",{}),n}return(0,he.Z)(r,[{key:"setEnable",value:function(t){this.enable=!!t}},{key:"log",value:function(t,a){var s=this;if(this.enable){var l=t.split("."),f=null;l.forEach(function(d,S){f!==null?(f[d]||(f[d]={}),S!==l.length-1&&(f=f[d])):(s.cacheLogs[d]||(s.cacheLogs[d]={}),S!==l.length-1&&(f=s.cacheLogs[d])),S===l.length-1&&(f[d]=(0,ue.Z)((0,ue.Z)({time:Date.now()},f[d]),a))})}}},{key:"getLog",value:function(t){var a=this;switch((0,on.Z)(t)){case"string":return this.cacheLogs[t];case"object":return t.map(function(s){return a.cacheLogs[s]}).filter(function(s){return s!==void 0});case"undefined":return this.cacheLogs}}},{key:"removeLog",value:function(t){delete this.cacheLogs[t]}},{key:"generateRenderUid",value:function(){return this.renderEnable?Dh():""}},{key:"renderDebug",value:function(t){this.renderEnable=t}},{key:"renderStart",value:function(t){if(!(!this.renderEnable||!this.enable)){var a=this.renderMap.get(t)||{};this.renderMap.set(t,(0,ue.Z)((0,ue.Z)({},a),{},{renderUid:t,renderStart:Date.now()}))}}},{key:"renderEnd",value:function(t){if(!(!this.renderEnable||!this.enable)){var a=this.renderMap.get(t);if(a){var s=a.renderStart,l=Date.now();this.emit("renderEnd",(0,ue.Z)((0,ue.Z)({},a),{},{renderEnd:l,renderDuration:l-s})),this.renderMap.delete(t)}}}},{key:"destroy",value:function(){this.cacheLogs=null,this.renderMap.clear()}}]),r}(Kc.EventEmitter))||i0),ym=I(20396),a0=I.n(ym),Lh;(function(e){e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag"})(Lh||(Lh={}));var _m,xm,bm,L0,R0;function Em(e){var i=uy();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function uy(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var A1={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},T1=(_m=(0,Xr.b2)(),xm=(0,Xr.f3)(Ir.IMapService),_m(bm=(L0=function(e){(0,Ft.Z)(r,e);var i=Em(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"indragging",!1),Ys((0,ct.Z)(n),"mapService",R0,(0,ct.Z)(n)),(0,V.Z)((0,ct.Z)(n),"hammertime",void 0),(0,V.Z)((0,ct.Z)(n),"lastClickTime",0),(0,V.Z)((0,ct.Z)(n),"lastClickXY",[-1,-1]),(0,V.Z)((0,ct.Z)(n),"clickTimer",void 0),(0,V.Z)((0,ct.Z)(n),"$containter",void 0),(0,V.Z)((0,ct.Z)(n),"onDrag",function(l){var f=n.interactionEvent(l);f.type=A1[f.type],f.type==="dragging"?n.indragging=!0:n.indragging=!1,n.emit(Lh.Drag,f)}),(0,V.Z)((0,ct.Z)(n),"onHammer",function(l){l.srcEvent.stopPropagation();var f=n.interactionEvent(l);n.emit(Lh.Hover,f)}),(0,V.Z)((0,ct.Z)(n),"onTouch",function(l){var f=l.touches[0];n.onHover({x:f.pageX,y:f.pageY,type:"touch"})}),(0,V.Z)((0,ct.Z)(n),"onHover",function(l){var f=l.clientX,d=l.clientY,S=f,O=d,Z=l.type,U=n.mapService.getMapContainer();if(U)if(zs)S=S-U.left-0,O=O-U.top-0;else{var se=U.getBoundingClientRect(),le=se.top,ye=se.left;S=S-ye-U.clientLeft,O=O-le-U.clientTop}var Be=n.mapService.containerToLngLat([S,O]);if(Z==="click"){if(!zs&&"ontouchstart"in document.documentElement)return;n.isDoubleTap(S,O,Be);return}if(Z==="touch"){n.isDoubleTap(S,O,Be);return}Z!=="click"&&Z!=="dblclick"&&n.emit(Lh.Hover,{x:S,y:O,lngLat:Be,type:Z,target:l})}),n}return(0,he.Z)(r,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Lh.Hover)}},{key:"triggerHover",value:function(t){var a=t.x,s=t.y;this.emit(Lh.Hover,{x:a,y:s})}},{key:"triggerSelect",value:function(t){this.emit(Lh.Select,{featureId:t})}},{key:"triggerActive",value:function(t){this.emit(Lh.Active,{featureId:t})}},{key:"handleMiniEvent",value:function(t){this.onHover({clientX:t.touches[0].pageX,clientY:t.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var t=this.mapService.getMapContainer();if(t)if(zs)ha.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var a=new(a0()).Manager(t);a.add(new(a0()).Tap({event:"dblclick",taps:2})),a.add(new(a0()).Tap({event:"click"})),a.add(new(a0()).Pan({threshold:0,pointers:0})),a.add(new(a0()).Press({})),a.on("dblclick click",this.onHammer),a.on("panstart panmove panend pancancel",this.onDrag),t.addEventListener("mousemove",this.onHover),t.addEventListener("mousedown",this.onHover,!0),t.addEventListener("mouseup",this.onHover),t.addEventListener("contextmenu",this.onHover),this.hammertime=a}}},{key:"removeEventListenerOnMap",value:function(){if(zs)ha.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var t=this.mapService.getMapContainer();t&&(t.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),t.removeEventListener("mousedown",this.onHover),t.removeEventListener("mouseup",this.onHover),t.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(t){var a=t.type,s=t.pointerType,l,f;s==="touch"?(f=Math.floor(t.pointers[0].clientY),l=Math.floor(t.pointers[0].clientX)):(f=Math.floor(t.srcEvent.y),l=Math.floor(t.srcEvent.x));var d=this.mapService.getMapContainer();if(d){var S=d.getBoundingClientRect(),O=S.top,Z=S.left;l-=Z,f-=O}var U=this.mapService.containerToLngLat([l,f]);return{x:l,y:f,lngLat:U,type:a,target:t.srcEvent}}},{key:"isDoubleTap",value:function(t,a,s){var l=this,f=new Date().getTime(),d="click";f-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-t)<10&&Math.abs(this.lastClickXY[1]-a)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),d="dblclick",this.emit(Lh.Hover,{x:t,y:a,lngLat:s,type:d})):(this.lastClickTime=f,this.lastClickXY=[t,a],this.clickTimer=setTimeout(function(){d="click",l.emit(Lh.Hover,{x:t,y:a,lngLat:s,type:d})},400))}}]),r}(Mp()),R0=Hs(L0.prototype,"mapService",[xm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L0))||bm),Ev=0;function ly(e){if(zs)return null;var i=e;if(typeof e=="string"&&(i=document.getElementById(e)),i){var r=document.createElement("div");return r.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,r.id="l7-scene-".concat(Ev++),r.classList.add("l7-scene"),i.appendChild(r),r}return null}function cy(e){var i,r,n=!0;return e==null||(i=e.target)===null||i===void 0||(r=i.path)===null||r===void 0||r.map(function(t){if(t!=null&&t.classList){var a;t==null||(a=t.classList)===null||a===void 0||a.forEach(function(s){(s==="l7-marker"||s==="l7-popup")&&(n=!1)})}}),n}var Ve;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(Ve||(Ve={}));var pg,dg,vg,k0,wm,Sm,mg,wv,gg,yg,Cm,_g,xg,M1=(pg=(0,Xr.b2)(),dg=(0,Xr.f3)(Ir.IMapService),vg=(0,Xr.f3)(Ir.IRendererService),k0=(0,Xr.f3)(Ir.IGlobalConfigService),wm=(0,Xr.f3)(Ir.IInteractionService),Sm=(0,Xr.f3)(Ir.ILayerService),pg(mg=(wv=function(){function e(){var i=this;(0,re.Z)(this,e),(0,V.Z)(this,"pickedColors",void 0),(0,V.Z)(this,"pickedTileLayers",[]),Ys(this,"mapService",gg,this),Ys(this,"rendererService",yg,this),Ys(this,"configService",Cm,this),Ys(this,"interactionService",_g,this),Ys(this,"layerService",xg,this),(0,V.Z)(this,"pickingFBO",void 0),(0,V.Z)(this,"width",0),(0,V.Z)(this,"height",0),(0,V.Z)(this,"alreadyInPicking",!1),(0,V.Z)(this,"pickBufferScale",1),(0,V.Z)(this,"pickFromPickingFBO",function(r,n){var t=n.x,a=n.y,s=n.lngLat,l=n.type,f=n.target,d=!1,S=i.rendererService,O=S.readPixels,Z=S.getContainer,U=i.getContainerSize(Z()),se=U.width,le=U.height;se*=ju,le*=ju;var ye=r.getLayerConfig(),Be=ye.enableHighlight,rt=ye.enableSelect,Je=t*ju,Ot=a*ju;if(Je>se-1*ju||Je<0||Ot>le-1*ju||Ot<0)return!1;var jt=O({x:Math.floor(Je/i.pickBufferScale),y:Math.floor((le-(a+1)*ju)/i.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:i.pickingFBO});if(i.pickedColors=jt,jt[0]!==0||jt[1]!==0||jt[2]!==0){var dr=Xa(jt),Lr=r.layerPickService.getFeatureById(dr);dr!==r.getCurrentPickId()&&l==="mousemove"&&(l="mouseenter");var jr={x:t,y:a,type:l,lngLat:s,featureId:dr,feature:Lr,target:f};Lr&&(d=!0,r.setCurrentPickId(dr),i.triggerHoverOnLayer(r,jr))}else{var Jr={x:t,y:a,lngLat:s,type:r.getCurrentPickId()!==null&&l==="mousemove"?"mouseout":"un"+l,featureId:null,target:f,feature:null};i.triggerHoverOnLayer(r,(0,ue.Z)((0,ue.Z)({},Jr),{},{type:"unpick"})),i.triggerHoverOnLayer(r,Jr),r.setCurrentPickId(null)}if(Be&&r.layerPickService.highlightPickedFeature(jt),rt&&l==="click"&&(jt==null?void 0:jt.toString())!==[0,0,0,0].toString()){var Pn=Xa(jt);r.getCurrentSelectedId()===null||Pn!==r.getCurrentSelectedId()?(r.layerPickService.selectFeature(jt),r.setCurrentSelectedId(Pn)):(r.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),r.setCurrentSelectedId(null))}return d})}return(0,he.Z)(e,[{key:"init",value:function(r){var n=this.rendererService,t=n.createTexture2D,a=n.createFramebuffer,s=n.getContainer,l=this.getContainerSize(s()),f=l.width,d=l.height;f*=ju,d*=ju,this.pickBufferScale=this.configService.getSceneConfig(r).pickBufferScale||1,this.pickingFBO=a({color:t({width:Math.round(f/this.pickBufferScale),height:Math.round(d/this.pickBufferScale),wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE})}),this.interactionService.on(Lh.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t,a,s){var l=this,f,d,S;return Ze().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:f=this.rendererService,d=f.useFramebuffer,S=f.clear,this.resizePickingFBO(),d(this.pickingFBO,function(){S({framebuffer:l.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),t.hooks.beforePickingEncode.call(),t.renderModels(),t.hooks.afterPickingEncode.call();var U=l.pickBox(t,a);s(U)});case 3:case"end":return Z.stop()}},n,this)}));function r(n,t,a){return i.apply(this,arguments)}return r}()},{key:"pickBox",value:function(r,n){var t=this,a=n.map(function(Pn){var In=Pn<0?0:Pn;return Math.floor(In*ju/t.pickBufferScale)}),s=(0,Ja.Z)(a,4),l=s[0],f=s[1],d=s[2],S=s[3],O=this.rendererService,Z=O.readPixels,U=O.getContainer,se=this.getContainerSize(U()),le=se.width,ye=se.height;if(le*=ju,ye*=ju,l>(le-1)*ju/this.pickBufferScale||d<0||f>(ye-1)*ju/this.pickBufferScale||S<0)return[];for(var Be=Math.min(le/this.pickBufferScale,d)-l,rt=Math.min(ye/this.pickBufferScale,S)-f,Je=Z({x:l,y:Math.floor(ye/this.pickBufferScale-(S+1)),width:Be,height:rt,data:new Uint8Array(Be*rt*4),framebuffer:this.pickingFBO}),Ot=[],jt={},dr=0;dr<Je.length/4;dr=dr+1){var Lr=Je.slice(dr*4,dr*4+4),jr=Xa(Lr);if(jr!==-1&&!jt[jr]){var Jr=r.layerPickService.getFeatureById(jr);Ot.push((0,ue.Z)((0,ue.Z)({},Jr),{},{pickedFeatureIdx:jr})),jt[jr]=!0}}return Ot}},{key:"handleCursor",value:function(r,n){var t=r.getLayerConfig(),a=t.cursor,s=a===void 0?"":a,l=t.cursorEnabled;if(l){var f=this.mapService.version,d=f==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),S=d==null?void 0:d.style.getPropertyValue("cursor");n==="unmousemove"&&S!==""?d==null||d.style.setProperty("cursor",""):n==="mousemove"&&(d==null||d.style.setProperty("cursor",s))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(r){return r.getContext?{width:r.width/ju,height:r.height/ju}:r.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t){return Ze().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(!this.layerService.needPick(t.type)||!this.isPickingAllLayer())){s.next=2;break}return s.abrupt("return");case 2:return this.alreadyInPicking=!0,s.next=5,this.pickingLayers(t);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return s.stop()}},n,this)}));function r(n){return i.apply(this,arguments)}return r}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var r=this.rendererService.getContainer,n=this.getContainerSize(r()),t=n.width,a=n.height;t*=ju,a*=ju,(this.width!==t||this.height!==a)&&(this.pickingFBO.resize({width:Math.round(t/this.pickBufferScale),height:Math.round(a/this.pickBufferScale)}),this.width=t,this.height=a)}},{key:"pickingLayers",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t){var a=this,s,l,f;return Ze().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:s=this.rendererService,l=s.useFramebuffer,f=s.clear,this.resizePickingFBO(),l(this.pickingFBO,function(){var O=a.layerService.getRenderList();O.filter(function(Z){return Z.needPick(t.type)}).reverse().some(function(Z){f({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Z.layerPickService.pickRender(t);var U=a.pickFromPickingFBO(Z,t);return a.layerService.pickedLayerId=U?+Z.id:-1,U&&!Z.getLayerConfig().enablePropagation})});case 3:case"end":return S.stop()}},n,this)}));function r(n){return i.apply(this,arguments)}return r}()},{key:"triggerHoverOnLayer",value:function(r,n){cy(n)&&(this.handleCursor(r,n.type),r.emit(n.type,n))}}]),e}(),gg=Hs(wv.prototype,"mapService",[dg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yg=Hs(wv.prototype,"rendererService",[vg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cm=Hs(wv.prototype,"configService",[k0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_g=Hs(wv.prototype,"interactionService",[wm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xg=Hs(wv.prototype,"layerService",[Sm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wv))||mg),_=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,re.Z)(this,e),(0,V.Z)(this,"autoStart",void 0),(0,V.Z)(this,"startTime",0),(0,V.Z)(this,"oldTime",0),(0,V.Z)(this,"running",!1),(0,V.Z)(this,"elapsedTime",0),this.autoStart=i}return(0,he.Z)(e,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var r=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=(typeof performance=="undefined"?Date:performance).now();r=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=r}return r}}]),e}(),M,J,Te,yt,Jt,Gr,gn,$n,pa;function ma(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Ra(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Ra(e,i){if(e){if(typeof e=="string")return Lo(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lo(e,i)}}function Lo(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}function _s(e){var i=Js();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Js(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Gu=(M=(0,Xr.b2)(),J=(0,Xr.f3)(Ir.IRendererService),Te=(0,Xr.f3)(Ir.IMapService),yt=(0,Xr.f3)(Ir.IDebugService),M(Jt=(Gr=function(e){(0,Ft.Z)(r,e);var i=_s(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"pickedLayerId",-1),(0,V.Z)((0,ct.Z)(n),"clock",new _),(0,V.Z)((0,ct.Z)(n),"alreadyInRendering",!1),(0,V.Z)((0,ct.Z)(n),"layers",[]),(0,V.Z)((0,ct.Z)(n),"layerList",[]),(0,V.Z)((0,ct.Z)(n),"layerRenderID",void 0),(0,V.Z)((0,ct.Z)(n),"sceneInited",!1),(0,V.Z)((0,ct.Z)(n),"animateInstanceCount",0),(0,V.Z)((0,ct.Z)(n),"shaderPicking",!0),(0,V.Z)((0,ct.Z)(n),"enableRender",!0),Ys((0,ct.Z)(n),"renderService",gn,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"mapService",$n,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"debugService",pa,(0,ct.Z)(n)),(0,V.Z)((0,ct.Z)(n),"reRender",(0,Kn.throttle)(function(){n.updateLayerRenderList(),n.renderLayers()},32)),(0,V.Z)((0,ct.Z)(n),"throttleRenderLayers",(0,Kn.throttle)(function(){n.renderLayers()},16)),n}return(0,he.Z)(r,[{key:"needPick",value:function(t){return this.layerList.some(function(a){return a.needPick(t)})}},{key:"add",value:function(t){var a=this;this.layers.push(t),this.sceneInited&&t.init().then(function(){a.updateLayerRenderList(),a.renderLayers()})}},{key:"addMask",value:function(t){var a=this;this.sceneInited&&t.init().then(function(){a.renderLayers()})}},{key:"initLayers",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s=this;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var d=(0,Dt.Z)(Ze().mark(function S(O){return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(O.startInit){U.next=4;break}return U.next=3,O.init();case 3:s.updateLayerRenderList();case 4:case"end":return U.stop()}},S)}));return function(S){return d.apply(this,arguments)}}());case 2:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(t){return this.layers.find(function(a){return a.id===t})}},{key:"getLayerByName",value:function(t){return this.layers.find(function(a){return a.name===t})}},{key:"remove",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s,l){var f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:l?(f=l.layerChildren.indexOf(s),f>-1&&l.layerChildren.splice(f,1)):(d=this.layers.indexOf(s),d>-1&&this.layers.splice(d,1)),this.updateLayerRenderList(),s.destroy(),this.reRender(),this.emit("layerChange",this.layers);case 5:case"end":return O.stop()}},a,this)}));function t(a,s){return n.apply(this,arguments)}return t}()},{key:"removeAllLayers",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:this.destroy(),this.reRender();case 2:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"setEnableRender",value:function(t){this.enableRender=t}},{key:"renderLayers",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){O.next=2;break}return O.abrupt("return");case 2:s=this.debugService.generateRenderUid(),this.debugService.renderStart(s),this.alreadyInRendering=!0,this.clear(),l=ma(this.layerList),O.prev=7,l.s();case 9:if((f=l.n()).done){O.next=21;break}if(d=f.value,d.masks.filter(function(Z){return Z.inited}).length>0&&(this.renderService.clear({stencil:0,depth:1,framebuffer:null}),d.masks.map(function(){var Z=(0,Dt.Z)(Ze().mark(function U(se){return Ze().wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:se.render();case 1:case"end":return ye.stop()}},U)}));return function(U){return Z.apply(this,arguments)}}())),!d.getLayerConfig().enableMultiPassRenderer){O.next=17;break}return O.next=15,d.renderMultiPass();case 15:O.next=19;break;case 17:return O.next=19,d.render();case 19:O.next=9;break;case 21:O.next=26;break;case 23:O.prev=23,O.t0=O.catch(7),l.e(O.t0);case 26:return O.prev=26,l.f(),O.finish(26);case 29:this.debugService.renderEnd(s),this.alreadyInRendering=!1;case 31:case"end":return O.stop()}},a,this,[[7,23,26,29]])}));function t(){return n.apply(this,arguments)}return t}()},{key:"renderMask",value:function(t){t.filter(function(a){return a.inited}).map(function(a){a.render()})}},{key:"beforeRenderData",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s){var l;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,s.hooks.beforeRenderData.promise();case 2:l=d.sent,l&&this.renderLayers();case 4:case"end":return d.stop()}},a,this)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"renderLayer",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s){var l=this;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(s.masks.filter(function(S){return S.inited}).length>0&&s.masks.map(function(S){l.renderService.clear({stencil:0,depth:1,framebuffer:null}),S.render()}),!s.getLayerConfig().enableMultiPassRenderer){d.next=6;break}return d.next=4,s.renderMultiPass();case 4:d.next=8;break;case 6:return d.next=8,s.render();case 8:case"end":return d.stop()}},a)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"updateLayerRenderList",value:function(){var t=this;this.layerList=[],this.layers.filter(function(a){return a.inited}).filter(function(a){return a.isVisible()}).sort(function(a,s){return a.zIndex-s.zIndex}).forEach(function(a){t.layerList.push(a)})}},{key:"destroy",value:function(){this.layers.forEach(function(t){t.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var t=Qi(this.mapService.bgColor);this.renderService.clear({color:t,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=ha.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){ha.cancelAnimationFrame(this.layerRenderID)}}]),r}(Kc.EventEmitter),gn=Hs(Gr.prototype,"renderService",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$n=Hs(Gr.prototype,"mapService",[Te],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pa=Hs(Gr.prototype,"debugService",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gr))||Jt),Xo=I(91),nl=function(){function e(i){var r=this;(0,re.Z)(this,e),(0,V.Z)(this,"name",void 0),(0,V.Z)(this,"type",void 0),(0,V.Z)(this,"scale",void 0),(0,V.Z)(this,"descriptor",void 0),(0,V.Z)(this,"featureBufferLayout",[]),(0,V.Z)(this,"needRescale",!1),(0,V.Z)(this,"needRemapping",!1),(0,V.Z)(this,"needRegenerateVertices",!1),(0,V.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,V.Z)(this,"vertexAttribute",void 0),(0,V.Z)(this,"defaultCallback",function(n){if(n.length===0){var t;return((t=r.scale)===null||t===void 0?void 0:t.defaultValues)||[]}return n.map(function(a,s){var l,f=(l=r.scale)===null||l===void 0?void 0:l.scalers[s].func,d=f(a);return d})}),this.setProps(i)}return(0,he.Z)(e,[{key:"setProps",value:function(r){Object.assign(this,r)}},{key:"mapping",value:function(r){var n;if((n=this.scale)!==null&&n!==void 0&&n.callback){var t,a=(t=this.scale)===null||t===void 0?void 0:t.callback.apply(t,(0,oe.Z)(r));if(!(0,Kn.isNil)(a))return[a]}return this.defaultCallback(r)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}(),yl=["modelType"],Vp=["buffer","update","name"],Ap=["buffer","update","name"],od=["buffer","update","name"],jc,sd,Ld,Am,fy,P1,O1=(jc={},(0,V.Z)(jc,Ve.FLOAT,4),(0,V.Z)(jc,Ve.UNSIGNED_BYTE,1),(0,V.Z)(jc,Ve.UNSIGNED_SHORT,2),jc),Db=(sd=(0,Xr.b2)(),Ld=(0,Xr.f3)(Ir.IRendererService),sd(Am=(fy=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"attributesAndIndices",void 0),Ys(this,"rendererService",P1,this),(0,V.Z)(this,"attributes",[]),(0,V.Z)(this,"triangulation",void 0),(0,V.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,he.Z)(e,[{key:"registerStyleAttribute",value:function(r){var n=this.getLayerStyleAttribute(r.name||"");return n?n.setProps(r):(n=new nl(r),this.attributes.push(n)),n}},{key:"updateScaleAttribute",value:function(r){this.attributes.forEach(function(n){var t,a=n.name,s=(t=n.scale)===null||t===void 0?void 0:t.field;(r[a]||s&&r[s])&&(n.needRescale=!0,n.needRemapping=!0,n.needRegenerateVertices=!0)})}},{key:"updateStyleAttribute",value:function(r,n,t){var a=this.getLayerStyleAttribute(r);a||(a=this.registerStyleAttribute((0,ue.Z)((0,ue.Z)({},n),{},{name:r})));var s=n.scale;s&&a&&(a.scale=s,a.needRescale=!0,a.needRemapping=!0,a.needRegenerateVertices=!0,t&&t.featureRange&&(a.featureRange=t.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(r){return this.attributes.find(function(n){return n.name===r})}},{key:"getLayerAttributeScale",value:function(r){var n,t=this.getLayerStyleAttribute(r),a=t==null||(n=t.scale)===null||n===void 0?void 0:n.scalers;return a&&a[0]?a[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(r,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,l=this.attributes.find(function(jt){return jt.name===r});if(l&&l.descriptor){var f=l.descriptor,d=f.update,S=f.buffer,O=f.size,Z=O===void 0?0:O,U=O1[S.type||Ve.FLOAT];if(d){var se=this.featureLayout,le=se.elements,ye=se.sizePerElement,Be=le.slice(t,a);if(!Be.length)return;var rt=Be[0].offset,Je=rt*Z*U,Ot=Be.map(function(jt,dr){for(var Lr=jt.featureIdx,jr=jt.vertices,Jr=jt.normals,Pn=jr.length/ye,In=[],Si=0;Si<Pn;Si++){var ra=Jr?Jr.slice(Si*3,Si*3+3):[];In.push.apply(In,(0,oe.Z)(d(n[Lr],Lr,jr.slice(Si*ye,Si*ye+ye),dr,ra)))}return In}).reduce(function(jt,dr){return jt.push.apply(jt,(0,oe.Z)(dr)),jt},[]);l.vertexAttribute.updateBuffer({data:Ot,offset:Je}),s==null||s.emit("legend:".concat(r),{type:r,attr:l})}}}},{key:"createAttributesAndIndicesAscy",value:function(r,n,t){var a=this;this.featureLayout={sizePerElement:0,elements:[]};var s=this.attributes.map(function(se){return se.resetDescriptor(),se.descriptor}).filter(function(se){return se}),l=t.modelType,f=(0,Xo.Z)(t,yl),d=this.rendererService,S=d.createAttribute,O=d.createBuffer,Z=d.createElements,U={};return new Promise(function(se,le){ka(l,(0,ue.Z)({descriptors:a.getDescriptorsWithOutFunc(s),features:r,segmentNumber:n},f)).then(function(ye){ye.descriptors.forEach(function(rt,Je){if(rt){var Ot=rt.buffer,jt=rt.update,dr=rt.name,Lr=(0,Xo.Z)(rt,Vp),jr=S((0,ue.Z)({buffer:O(Ot)},Lr));U[rt.name||""]=jr,a.attributes[Je].vertexAttribute=jr}}),a.featureLayout=ye.featureLayout;var Be=Z({data:ye.indices,type:Ve.UNSIGNED_INT,count:ye.indices.length});a.attributesAndIndices={attributes:U,elements:Be,count:null},se(a.attributesAndIndices)}).catch(function(ye){console.warn(ye),le(ye)})})}},{key:"createAttributesAndIndices",value:function(r,n,t){var a=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var s=this.attributes.map(function(Je){return Je.resetDescriptor(),Je.descriptor}),l=0,f=0,d=[],S=[],O=[],Z=3;r.forEach(function(Je,Ot){var jt=a.triangulation(Je,t),dr=jt.indices,Lr=jt.vertices,jr=jt.normals,Jr=jt.size,Pn=jt.indexes,In=jt.count;typeof In=="number"&&(f+=In),dr.forEach(function(Ms){S.push(Ms+l)}),Z=Jr;var Si=Lr.length/Jr;a.featureLayout.sizePerElement=Z,a.featureLayout.elements.push({featureIdx:Ot,vertices:Lr,normals:jr,offset:l}),l+=Si;for(var ra=function(vu){var Bu=(jr==null?void 0:jr.slice(vu*3,vu*3+3))||[],zl=Lr.slice(vu*Jr,vu*Jr+Jr),_l=0;Pn&&Pn[vu]!==void 0&&(_l=Pn[vu]),s.forEach(function(_h,Pv){if(_h&&_h.update){var wd;(wd=_h.buffer.data).push.apply(wd,(0,oe.Z)(_h.update(Je,Ot,zl,vu,Bu,_l)))}})},Va=0;Va<Si;Va++)ra(Va)});var U=this.rendererService,se=U.createAttribute,le=U.createBuffer,ye=U.createElements,Be={};s.forEach(function(Je,Ot){if(Je){var jt=Je.buffer,dr=Je.update,Lr=Je.name,jr=(0,Xo.Z)(Je,Ap),Jr=se((0,ue.Z)({buffer:le(jt)},jr));Be[Je.name||""]=Jr,a.attributes[Ot].vertexAttribute=Jr}});var rt=ye({data:S,type:Ve.UNSIGNED_INT,count:S.length});return this.attributesAndIndices={attributes:Be,elements:rt,count:f},this.attributesAndIndices}},{key:"createAttributes",value:function(r,n){var t=this;this.featureLayout={sizePerElement:0,elements:[]},n&&(this.triangulation=n);var a=this.attributes.map(function(U){return U.resetDescriptor(),U.descriptor}),s=0,l=[],f=3;r.forEach(function(U,se){var le=t.triangulation(U),ye=le.indices,Be=le.vertices,rt=le.normals,Je=le.size,Ot=le.indexes;ye.forEach(function(jr){l.push(jr+s)}),f=Je;var jt=Be.length/Je;t.featureLayout.sizePerElement=f,t.featureLayout.elements.push({featureIdx:se,vertices:Be,normals:rt,offset:s}),s+=jt;for(var dr=function(Jr){var Pn=(rt==null?void 0:rt.slice(Jr*3,Jr*3+3))||[],In=Be.slice(Jr*Je,Jr*Je+Je),Si=0;Ot&&Ot[Jr]!==void 0&&(Si=Ot[Jr]),a.forEach(function(ra,Va){if(ra&&ra.update){var Ms;(Ms=ra.buffer.data).push.apply(Ms,(0,oe.Z)(ra.update(U,se,In,Jr,Pn,Si)))}})},Lr=0;Lr<jt;Lr++)dr(Lr)});var d=this.rendererService,S=d.createAttribute,O=d.createBuffer,Z={};return a.forEach(function(U,se){if(U){var le=U.buffer,ye=U.update,Be=U.name,rt=(0,Xo.Z)(U,od),Je=S((0,ue.Z)({buffer:O(le)},rt));Z[U.name||""]=Je,t.attributes[se].vertexAttribute=Je}}),{attributes:Z}}},{key:"clearAllAttributes",value:function(){var r;this.attributes.forEach(function(n){n.vertexAttribute&&n.vertexAttribute.destroy()}),(r=this.attributesAndIndices)===null||r===void 0||r.elements.destroy(),this.attributes=[]}},{key:"getDescriptorsWithOutFunc",value:function(r){return r.map(function(n){return{buffer:n.buffer,name:n.name,size:n.size}})}}]),e}(),P1=Hs(fy.prototype,"rendererService",[Ld],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fy))||Am),hy=I(34155);function py(e,i,r,n){function t(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(S){try{d(n.next(S))}catch(O){s(O)}}function f(S){try{d(n.throw(S))}catch(O){s(O)}}function d(S){S.done?a(S.value):t(S.value).then(l,f)}d((n=n.apply(e,i||[])).next())})}function bg(e,i){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,t,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(d){return function(S){return f([d,S])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,t&&(a=d[0]&2?t.return:d[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,d[1])).done)return a;switch(t=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,t=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=i.call(e,r)}catch(S){d=[6,S],t=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Eg(e,i){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),t,a=[],s;try{for(;(i===void 0||i-- >0)&&!(t=n.next()).done;)a.push(t.value)}catch(l){s={error:l}}finally{try{t&&!t.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return a}function wg(e,i,r){if(r||arguments.length===2)for(var n=0,t=i.length,a;n<t;n++)(a||!(n in i))&&(a||(a=Array.prototype.slice.call(i,0,n)),a[n]=i[n]);return e.concat(a||Array.prototype.slice.call(i))}function dy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var vy={exports:{}},Sg={exports:{}},o0={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=r;function r(n){return n&&typeof n.length=="number"&&n.length>=0&&n.length%1===0}e.exports=i.default})(o0,o0.exports);var ud={},Tm={exports:{}},gy={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(r){return function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];var a=n.pop();return r.call(this,n,a)}},e.exports=i.default})(gy,gy.exports);var Uv={};Object.defineProperty(Uv,"__esModule",{value:!0}),Uv.fallback=I1,Uv.wrap=L1;var Fb=Uv.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,Bb=Uv.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Nb=Uv.hasNextTick=typeof hy=="object"&&typeof hy.nextTick=="function";function I1(e){setTimeout(e,0)}function L1(e){return function(i){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];return e(function(){return i.apply(void 0,r)})}}var Mm;Fb?Mm=queueMicrotask:Bb?Mm=setImmediate:Nb?Mm=hy.nextTick:Mm=I1,Uv.default=L1(Mm),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=f;var r=gy.exports,n=l(r),t=Uv,a=l(t),s=ud;function l(O){return O&&O.__esModule?O:{default:O}}function f(O){return(0,s.isAsync)(O)?function(){for(var Z=[],U=arguments.length;U--;)Z[U]=arguments[U];var se=Z.pop(),le=O.apply(this,Z);return d(le,se)}:(0,n.default)(function(Z,U){var se;try{se=O.apply(this,Z)}catch(le){return U(le)}if(se&&typeof se.then=="function")return d(se,U);U(null,se)})}function d(O,Z){return O.then(function(U){S(Z,null,U)},function(U){S(Z,U&&U.message?U:new Error(U))})}function S(O,Z,U){try{O(Z,U)}catch(se){(0,a.default)(function(le){throw le},se)}}e.exports=i.default}(Tm,Tm.exports),Object.defineProperty(ud,"__esModule",{value:!0}),ud.isAsyncIterable=ud.isAsyncGenerator=ud.isAsync=void 0;var zb=Tm.exports,D0=Zb(zb);function Zb(e){return e&&e.__esModule?e:{default:e}}function R1(e){return e[Symbol.toStringTag]==="AsyncFunction"}function F0(e){return e[Symbol.toStringTag]==="AsyncGenerator"}function Ub(e){return typeof e[Symbol.asyncIterator]=="function"}function Cg(e){if(typeof e!="function")throw new Error("expected a function");return R1(e)?(0,D0.default)(e):e}ud.default=Cg,ud.isAsync=R1,ud.isAsyncGenerator=F0,ud.isAsyncIterable=Ub;var s0={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=r;function r(n,t){if(t===void 0&&(t=n.length),!t)throw new Error("arity is undefined");function a(){for(var s=this,l=[],f=arguments.length;f--;)l[f]=arguments[f];return typeof l[t-1]=="function"?n.apply(this,l):new Promise(function(d,S){l[t-1]=function(O){for(var Z=[],U=arguments.length-1;U-- >0;)Z[U]=arguments[U+1];if(O)return S(O);d(Z.length>1?Z:Z[0])},n.apply(s,l)})}return a}e.exports=i.default})(s0,s0.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var r=o0.exports,n=f(r),t=ud,a=f(t),s=s0.exports,l=f(s);function f(d){return d&&d.__esModule?d:{default:d}}i.default=(0,l.default)(function(d,S,O){var Z=(0,n.default)(S)?[]:{};d(S,function(U,se,le){(0,a.default)(U)(function(ye){for(var Be,rt=[],Je=arguments.length-1;Je-- >0;)rt[Je]=arguments[Je+1];rt.length<2&&(Be=rt,rt=Be[0]),Z[se]=rt,le(ye)})},function(U){return O(U,Z)})},3),e.exports=i.default}(Sg,Sg.exports);var yy={exports:{}},Ag={exports:{}},_y={exports:{}},Pm={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=r;function r(n){function t(){for(var a=[],s=arguments.length;s--;)a[s]=arguments[s];if(n!==null){var l=n;n=null,l.apply(this,a)}}return Object.assign(t,n),t}e.exports=i.default})(Pm,Pm.exports);var xy={exports:{}},by={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(r){return r[Symbol.iterator]&&r[Symbol.iterator]()},e.exports=i.default})(by,by.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=S;var r=o0.exports,n=s(r),t=by.exports,a=s(t);function s(O){return O&&O.__esModule?O:{default:O}}function l(O){var Z=-1,U=O.length;return function(){return++Z<U?{value:O[Z],key:Z}:null}}function f(O){var Z=-1;return function(){var se=O.next();return se.done?null:(Z++,{value:se.value,key:Z})}}function d(O){var Z=O?Object.keys(O):[],U=-1,se=Z.length;return function le(){var ye=Z[++U];return ye==="__proto__"?le():U<se?{value:O[ye],key:ye}:null}}function S(O){if((0,n.default)(O))return l(O);var Z=(0,a.default)(O);return Z?f(Z):d(O)}e.exports=i.default}(xy,xy.exports);var Om={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=r;function r(n){return function(){for(var t=[],a=arguments.length;a--;)t[a]=arguments[a];if(n===null)throw new Error("Callback was already called.");var s=n;n=null,s.apply(this,t)}}e.exports=i.default})(Om,Om.exports);var Ey={exports:{}},Im={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var r={};i.default=r,e.exports=i.default})(Im,Im.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=a;var r=Im.exports,n=t(r);function t(s){return s&&s.__esModule?s:{default:s}}function a(s,l,f,d){var S=!1,O=!1,Z=!1,U=0,se=0;function le(){U>=l||Z||S||(Z=!0,s.next().then(function(rt){var Je=rt.value,Ot=rt.done;if(!(O||S)){if(Z=!1,Ot){S=!0,U<=0&&d(null);return}U++,f(Je,se,ye),se++,le()}}).catch(Be))}function ye(rt,Je){if(U-=1,!O){if(rt)return Be(rt);if(rt===!1){S=!0,O=!0;return}if(Je===n.default||S&&U<=0)return S=!0,d(null);le()}}function Be(rt){O||(Z=!1,S=!0,d(rt))}le()}e.exports=i.default}(Ey,Ey.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var r=Pm.exports,n=U(r),t=xy.exports,a=U(t),s=Om.exports,l=U(s),f=ud,d=Ey.exports,S=U(d),O=Im.exports,Z=U(O);function U(se){return se&&se.__esModule?se:{default:se}}i.default=function(se){return function(le,ye,Be){if(Be=(0,n.default)(Be),se<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!le)return Be(null);if((0,f.isAsyncGenerator)(le))return(0,S.default)(le,se,ye,Be);if((0,f.isAsyncIterable)(le))return(0,S.default)(le[Symbol.asyncIterator](),se,ye,Be);var rt=(0,a.default)(le),Je=!1,Ot=!1,jt=0,dr=!1;function Lr(Jr,Pn){if(!Ot)if(jt-=1,Jr)Je=!0,Be(Jr);else if(Jr===!1)Je=!0,Ot=!0;else{if(Pn===Z.default||Je&&jt<=0)return Je=!0,Be(null);dr||jr()}}function jr(){for(dr=!0;jt<se&&!Je;){var Jr=rt();if(Jr===null){Je=!0,jt<=0&&Be(null);return}jt+=1,ye(Jr.value,Jr.key,(0,l.default)(Lr))}dr=!1}jr()}},e.exports=i.default}(_y,_y.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var r=_y.exports,n=f(r),t=ud,a=f(t),s=s0.exports,l=f(s);function f(S){return S&&S.__esModule?S:{default:S}}function d(S,O,Z,U){return(0,n.default)(O)(S,(0,a.default)(Z),U)}i.default=(0,l.default)(d,4),e.exports=i.default}(Ag,Ag.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var r=Ag.exports,n=s(r),t=s0.exports,a=s(t);function s(f){return f&&f.__esModule?f:{default:f}}function l(f,d,S){return(0,n.default)(f,1,d,S)}i.default=(0,a.default)(l,3),e.exports=i.default}(yy,yy.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=l;var r=Sg.exports,n=s(r),t=yy.exports,a=s(t);function s(f){return f&&f.__esModule?f:{default:f}}function l(f,d){return(0,n.default)(a.default,f,d)}e.exports=i.default}(vy,vy.exports);var Tg=dy(vy.exports),ov=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var i=arguments,r=[],n=0;n<arguments.length;n++)r[n]=i[n];return this.args=r,Tg(this.tasks)},e.prototype.tap=function(i,r){var n=this;this.tasks.push(function(t){r.apply(void 0,wg([],Eg(n.args),!1)),t(null,i)})},e}(),wy={exports:{}},Lm={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var r=o0.exports,n=ye(r),t=Im.exports,a=ye(t),s=Ag.exports,l=ye(s),f=Pm.exports,d=ye(f),S=Om.exports,O=ye(S),Z=ud,U=ye(Z),se=s0.exports,le=ye(se);function ye(Ot){return Ot&&Ot.__esModule?Ot:{default:Ot}}function Be(Ot,jt,dr){dr=(0,d.default)(dr);var Lr=0,jr=0,Jr=Ot.length,Pn=!1;Jr===0&&dr(null);function In(Si,ra){Si===!1&&(Pn=!0),Pn!==!0&&(Si?dr(Si):(++jr===Jr||ra===a.default)&&dr(null))}for(;Lr<Jr;Lr++)jt(Ot[Lr],Lr,(0,O.default)(In))}function rt(Ot,jt,dr){return(0,l.default)(Ot,1/0,jt,dr)}function Je(Ot,jt,dr){var Lr=(0,n.default)(Ot)?Be:rt;return Lr(Ot,(0,U.default)(jt),dr)}i.default=(0,le.default)(Je,3),e.exports=i.default})(Lm,Lm.exports),function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=l;var r=Lm.exports,n=s(r),t=Sg.exports,a=s(t);function s(f){return f&&f.__esModule?f:{default:f}}function l(f,d){return(0,a.default)(n.default,f,d)}e.exports=i.default}(wy,wy.exports);var jb=dy(wy.exports),vS=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return jb(this.tasks)},e.prototype.tapPromise=function(i,r){var n=this;this.tasks.push(function(t){return py(n,void 0,void 0,function(){return bg(this,function(a){switch(a.label){case 0:return[4,r()];case 1:return a.sent(),t(null,i),[2]}})})})},e}(),Sy={exports:{}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var r=Pm.exports,n=S(r),t=Om.exports,a=S(t),s=ud,l=S(s),f=s0.exports,d=S(f);function S(Z){return Z&&Z.__esModule?Z:{default:Z}}function O(Z,U){if(U=(0,n.default)(U),!Array.isArray(Z))return U(new Error("First argument to waterfall must be an array of functions"));if(!Z.length)return U();var se=0;function le(Be){var rt=(0,l.default)(Z[se++]);rt.apply(void 0,Be.concat([(0,a.default)(ye)]))}function ye(Be){for(var rt=[],Je=arguments.length-1;Je-- >0;)rt[Je]=arguments[Je+1];if(Be!==!1){if(Be||se===Z.length)return U.apply(void 0,[Be].concat(rt));le(rt)}}le([])}i.default=(0,d.default)(O),e.exports=i.default})(Sy,Sy.exports);var k1=dy(Sy.exports),mS=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return k1(this.tasks)},e.prototype.tap=function(i,r){this.tasks.length===0?this.tasks.push(function(n){var t=r();n(t?null:!1,t)}):this.tasks.push(function(n,t){var a=r.apply(void 0,wg([],Eg(n),!1));t(a?null:!1,i)})},e}(),D1=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return Tg(this.tasks)},e.prototype.tap=function(i,r){this.tasks.push(function(n){var t=r();n(t,i)})},e}(),Vb=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var i=arguments,r=[],n=0;n<arguments.length;n++)r[n]=i[n];return this.args=r,Tg(this.tasks)},e.prototype.tapPromise=function(i,r){var n=this;this.tasks.push(function(t){return py(n,void 0,void 0,function(){return bg(this,function(a){switch(a.label){case 0:return[4,r.apply(void 0,wg([],Eg(this.args),!1))];case 1:return a.sent(),t(null,i),[2]}})})})},e}(),F1=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var i=arguments,r=[],n=0;n<arguments.length;n++)r[n]=i[n];return this.args=r,Tg(this.tasks)},e.prototype.tapPromise=function(i,r){var n=this;this.tasks.push(function(t){return py(n,void 0,void 0,function(){var a;return bg(this,function(s){switch(s.label){case 0:return[4,r.apply(void 0,wg([],Eg(this.args),!1))];case 1:return a=s.sent(),t(a,i),[2]}})})})},e}(),Hb=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return k1(this.tasks)},e.prototype.tapPromise=function(i,r){this.tasks.length===0?this.tasks.push(function(n){r().then(function(t){n(null,t)})}):this.tasks.push(function(n,t){r(n).then(function(a){t(null,a)})})},e}(),B1=I(67709),Gb=I.n(B1),N1,z1,Z1,U1,j1,V1,H1,Cy,G1,$1,W1,Ay,X1,Y1,K1,q1,Q1,J1,Gh,e_,t_,$b,r_,n_,i_,Ty,a_,o_,Wb,s_,u_,l_,My,c_,f_;function gS(e){var i=Xb();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Xb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Yb=(N1=(0,Xr.b2)(),z1=(0,Xr.f3)(Ir.SceneID),Z1=(0,Xr.f3)(Ir.IIconService),U1=(0,Xr.f3)(Ir.IFontService),j1=(0,Xr.f3)(Ir.IControlService),V1=(0,Xr.f3)(Ir.IGlobalConfigService),H1=(0,Xr.f3)(Ir.IMapService),Cy=(0,Xr.f3)(Ir.ICoordinateSystemService),G1=(0,Xr.f3)(Ir.IRendererService),$1=(0,Xr.f3)(Ir.ILayerService),W1=(0,Xr.f3)(Ir.IDebugService),Ay=(0,Xr.f3)(Ir.ICameraService),X1=(0,Xr.f3)(Ir.IInteractionService),Y1=(0,Xr.f3)(Ir.IPickingService),K1=(0,Xr.f3)(Ir.IShaderModuleService),q1=(0,Xr.f3)(Ir.IMarkerService),Q1=(0,Xr.f3)(Ir.IPopupService),N1(J1=(Gh=function(e){(0,Ft.Z)(r,e);var i=gS(r);function r(){var n;return(0,re.Z)(this,r),n=i.call(this),(0,V.Z)((0,ct.Z)(n),"destroyed",!1),(0,V.Z)((0,ct.Z)(n),"loaded",!1),Ys((0,ct.Z)(n),"id",e_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"iconService",t_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"fontService",$b,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"controlService",r_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"configService",n_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"map",i_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"coordinateSystemService",Ty,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"rendererService",a_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"layerService",o_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"debugService",Wb,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"cameraService",s_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"interactionService",u_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"pickingService",l_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"shaderModuleService",My,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"markerService",c_,(0,ct.Z)(n)),Ys((0,ct.Z)(n),"popupService",f_,(0,ct.Z)(n)),(0,V.Z)((0,ct.Z)(n),"inited",!1),(0,V.Z)((0,ct.Z)(n),"initPromise",void 0),(0,V.Z)((0,ct.Z)(n),"rendering",!1),(0,V.Z)((0,ct.Z)(n),"$container",void 0),(0,V.Z)((0,ct.Z)(n),"canvas",void 0),(0,V.Z)((0,ct.Z)(n),"markerContainer",void 0),(0,V.Z)((0,ct.Z)(n),"hooks",void 0),(0,V.Z)((0,ct.Z)(n),"handleWindowResized",function(){n.emit("resize"),n.$container&&(n.initContainer(),Tf(),n.coordinateSystemService.needRefresh=!0,n.render())}),(0,V.Z)((0,ct.Z)(n),"handleMapCameraChanged",function(t){n.cameraService.update(t),n.render()}),n.hooks={init:new Vb},n}return(0,he.Z)(r,[{key:"init",value:function(t){var a=this;this.configService.setSceneConfig(this.id,t),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,Dt.Z)(Ze().mark(function s(){return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return a.debugService.log("map.mapInitStart",{type:a.map.version}),f.next=3,new Promise(function(d){a.map.onCameraChanged(function(S){a.cameraService.init(),a.cameraService.update(S),d()}),a.map.init()});case 3:a.map.onCameraChanged(a.handleMapCameraChanged),a.map.addMarkerContainer(),a.markerService.addMarkers(),a.markerService.addMarkerLayers(),a.popupService.initPopup(),a.interactionService.init(),a.interactionService.on(Lh.Drag,a.addSceneEvent.bind(a));case 10:case"end":return f.stop()}},s)}))),this.hooks.init.tapPromise("initRenderer",(0,Dt.Z)(Ze().mark(function s(){var l,f;return Ze().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(l=a.map.getOverlayContainer(),l?a.$container=l:a.$container=ly(a.configService.getSceneConfig(a.id).id||""),!a.$container){S.next=13;break}return a.canvas=ss("canvas","",a.$container),a.setCanvas(),S.next=7,a.rendererService.init(a.canvas,a.configService.getSceneConfig(a.id),t.gl);case 7:a.registerContextLost(),a.initContainer(),Gb()(a.$container,a.handleWindowResized),ha.matchMedia&&((f=ha.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||f===void 0||f.addListener(a.handleWindowResized)),S.next=14;break;case 13:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 14:a.pickingService.init(a.id);case 15:case"end":return S.stop()}},s)}))),this.render()}},{key:"registerContextLost",value:function(){var t=this,a=this.rendererService.getCanvas();a&&a.addEventListener("webglcontextlost",function(){return t.emit("webglcontextlost")})}},{key:"initMiniScene",value:function(t){var a=this;this.configService.setSceneConfig(this.id,t),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return a.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,Dt.Z)(Ze().mark(function s(){return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,new Promise(function(d){a.map.onCameraChanged(function(S){a.cameraService.init(),a.cameraService.update(S),a.map.version!=="GAODE2.x"&&d()}),a.map.initMiniMap()});case 2:a.map.onCameraChanged(a.handleMapCameraChanged),a.interactionService.init(),a.interactionService.on(Lh.Drag,a.addSceneEvent.bind(a));case 5:case"end":return f.stop()}},s)}))),this.hooks.init.tapPromise("initRenderer",(0,Dt.Z)(Ze().mark(function s(){var l;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(l=t.canvas,a.$container=l||null,!a.$container){d.next=7;break}return d.next=5,a.rendererService.init(t.canvas,a.configService.getSceneConfig(a.id),void 0);case 5:d.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:a.pickingService.init(a.id);case 9:case"end":return d.stop()}},s)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(t){this.layerService.sceneService=this,this.layerService.add(t)}},{key:"addMask",value:function(t){this.layerService.sceneService=this,this.layerService.addMask(t)}},{key:"render",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(this.rendering||this.destroyed)){l.next=2;break}return l.abrupt("return");case 2:if(this.rendering=!0,this.inited){l.next=16;break}return l.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),l.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,l.next=20;break;case 16:return l.next=18,this.layerService.initLayers();case 18:return l.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"addFontFace",value:function(t,a){this.fontService.addFontFace(t,a)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s){var l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return f=(l=this.$container)===null||l===void 0?void 0:l.getElementsByTagName("canvas")[0],O.next=3,this.render();case 3:return d=s==="jpg"?f==null?void 0:f.toDataURL("image/jpeg"):f==null?void 0:f.toDataURL("image/png"),O.abrupt("return",d);case 5:case"end":return O.stop()}},a,this)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var t=this.$container.parentElement;t!==null&&(this.markerContainer=ss("div","l7-marker-container",t))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var t=this,a,s;if(!this.inited){this.destroyed=!0;return}if((0,B1.unbind)(this.$container,this.handleWindowResized),ha.matchMedia){var l;(l=ha.matchMedia("screen and (min-resolution: 2dppx)"))===null||l===void 0||l.removeListener(this.handleWindowResized)}this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var f;(f=t.$container)===null||f===void 0||f.removeChild(t.canvas),t.canvas=null,t.rendererService.destroy()}),(a=this.$container)===null||a===void 0||(s=a.parentNode)===null||s===void 0||s.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var t,a,s=ju,l=((t=this.$container)===null||t===void 0?void 0:t.clientWidth)||400,f=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,d=this.canvas;d&&(d.width=l*s,d.height=f*s),this.rendererService.viewport({x:0,y:0,width:s*l,height:s*f})}},{key:"setCanvas",value:function(){var t,a,s=ju,l=((t=this.$container)===null||t===void 0?void 0:t.clientWidth)||400,f=((a=this.$container)===null||a===void 0?void 0:a.clientHeight)||300,d=this.canvas;d.width=l*s,d.height=f*s,d.style.width="100%",d.style.height="100%"}},{key:"addSceneEvent",value:function(t){this.emit(t.type,t)}}]),r}(Kc.EventEmitter),e_=Hs(Gh.prototype,"id",[z1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t_=Hs(Gh.prototype,"iconService",[Z1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$b=Hs(Gh.prototype,"fontService",[U1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r_=Hs(Gh.prototype,"controlService",[j1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n_=Hs(Gh.prototype,"configService",[V1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i_=Hs(Gh.prototype,"map",[H1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ty=Hs(Gh.prototype,"coordinateSystemService",[Cy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a_=Hs(Gh.prototype,"rendererService",[G1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o_=Hs(Gh.prototype,"layerService",[$1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wb=Hs(Gh.prototype,"debugService",[W1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s_=Hs(Gh.prototype,"cameraService",[Ay],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u_=Hs(Gh.prototype,"interactionService",[X1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l_=Hs(Gh.prototype,"pickingService",[Y1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),My=Hs(Gh.prototype,"shaderModuleService",[K1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c_=Hs(Gh.prototype,"markerService",[q1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f_=Hs(Gh.prototype,"popupService",[Q1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gh))||J1);function Kb(e){var i=0;switch(e){case"vec2":case"ivec2":i=2;break;case"vec3":case"ivec3":i=3;break;case"vec4":case"ivec4":case"mat2":i=4;break;case"mat3":i=9;break;case"mat4":i=16;break;default:}return i}var h_=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function p_(e){var i={};return e=e.replace(h_,function(r,n,t){var a=t.split(":"),s=a[0].trim(),l="";switch(a.length>1&&(l=a[1].trim()),n){case"bool":l=l==="true";break;case"float":case"int":l=Number(l);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":l?l=l.replace("[","").replace("]","").split(",").reduce(function(f,d){return f.push(Number(d.trim())),f},[]):l=new Array(Kb(n)).fill(0);break;default:}return i[s]=l,"uniform ".concat(n," ").concat(s,`;
`)}),{content:e,uniforms:i}}var d_,qb,Qb="#define PI 3.14159265359",Rm=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,v_=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,m_=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Jb=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,e2=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,t2=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,r2=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel * u_FocalDistance ;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance ;
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom)* u_FocalDistance ;
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * 2.0 *  u_FocalDistance;;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom))  * u_FocalDistance ;
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) *  u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))  * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,n2=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,i2=`attribute float a_vertexId;

uniform mat4 u_cellTypeLayout;      // \u63CF\u8FF0\u6570\u636E\u7EB9\u7406 cell \u7ED3\u6784\u7684\u77E9\u9635
uniform sampler2D u_dataTexture;    // \u6570\u636E\u7EB9\u7406

bool hasOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 opacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeOpacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeWidth() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeWidth \u7684\u6570\u636E
  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStroke() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 stroke \u7684\u6570\u636E
  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasOffsets() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 offsets \u7684\u6570\u636E
  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasThetaOffset() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 thetaOffset \u7684\u6570\u636E
  return u_cellTypeLayout[2][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

// \u6839\u636E\u5750\u6807\u4F4D\u7F6E\u5148\u662F\u8BA1\u7B97 uv \uFF0C\u7136\u540E\u6839\u636E uv \u4ECE\u6570\u636E\u7EB9\u7406\u4E2D\u53D6\u503C
float pos2value(vec2 pos, float columnWidth, float rowHeight) {
  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;
  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);
  return texture2D(u_dataTexture, vec2(u, v)).r;
}

/*
  currentRow \u5F53\u524D\u884C
  currentColumn \u5F53\u524D\u5217
  columnCount \u6709\u591A\u5C11\u5217
  nextStep \u9700\u8981\u8BA1\u7B97\u5F53\u524D cell \u540E\u7684\u7B2C\u51E0\u4E2A cell \uFF08\u5F53\u524D cell \u5219 nextStep = 0\uFF09
*/
vec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {
  float nextColumn = currentColumn;
  float nextRow = currentRow;
  if(currentColumn + nextStep <= columnCount){
    nextColumn = currentColumn + nextStep;
  } else {
    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4E0D\u4F1A\u51FA\u73B0\u8DE8\u4E24\u884C
    nextRow = currentRow + 1.0;
  }
  return vec2(nextColumn, nextRow);
}

// \u8BA1\u7B97\u5F53\u524D\u5355\u4E2A cell \u7684\u5927\u5C0F
float calCellCount() { 
  //   u_cellTypeLayout
  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51E0\u884C\u51E0\u5217
  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793A\u6709\u6570\u636E\u6620\u5C04\u30010.0 \u8868\u793A\u6CA1\u6709
  //   1.0, 1.0, 0.0, 0.0, // offsets thetaOffset
  //   0.0, 0.0, 0.0, 0.0
  
  return  u_cellTypeLayout[1][0] +        // opacity
          u_cellTypeLayout[1][1] +        // strokeOpacity
          u_cellTypeLayout[1][2] +        // strokeWidth
          u_cellTypeLayout[1][3] * 4.0 +  // stroke
          u_cellTypeLayout[2][0] * 2.0 +  // offsets
          u_cellTypeLayout[2][1];         // thetaOffset
}`,a2=`
// \u8BA1\u7B97 opacity \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasOpacity()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 opacity \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureOpacity, textureOffset + 1.0);
  }
}
`,g_=`
// \u8BA1\u7B97 strokeOpaicty \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeOpacity()) {
    return vec2(u_stroke_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeOpacity, textureOffset + 1.0);
  }
}
`,o2=`
// \u8BA1\u7B97 strokeWidth \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeWidth()) {
    return vec2(u_stroke_width, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeWidth, textureOffset + 1.0);
  }
}
`,s2=`
// \u8BA1\u7B97 thetaOffset \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calThetaOffsetAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasThetaOffset()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 thetaOffset \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_thetaOffset, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureThetaOffset = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureThetaOffset, textureOffset + 1.0);
  }
}
`,yS=/precision\s+(high|low|medium)p\s+float/,Mg=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,u2=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,l2=(d_=(0,Xr.b2)(),d_(qb=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"moduleCache",{}),(0,V.Z)(this,"rawContentCache",{})}return(0,he.Z)(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Qb,fs:Qb}),this.registerModule("decode",{vs:Rm,fs:""}),this.registerModule("projection",{vs:r2,fs:""}),this.registerModule("project",{vs:t2,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:n2}),this.registerModule("lighting",{vs:m_,fs:""}),this.registerModule("light",{vs:v_,fs:""}),this.registerModule("picking",{vs:e2,fs:Jb}),this.registerModule("styleMapping",{vs:i2,fs:""}),this.registerModule("styleMappingCalThetaOffset",{vs:s2,fs:""}),this.registerModule("styleMappingCalOpacity",{vs:a2,fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:g_,fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:o2,fs:""})}},{key:"registerModule",value:function(r,n){if(!this.rawContentCache[r]){var t=n.vs,a=n.fs,s=n.uniforms,l=p_(t),f=l.content,d=l.uniforms,S=p_(a),O=S.content,Z=S.uniforms;this.rawContentCache[r]={fs:O,uniforms:(0,ue.Z)((0,ue.Z)((0,ue.Z)({},d),Z),s),vs:f}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(r){var n=this;if(this.moduleCache[r])return this.moduleCache[r];var t=this.rawContentCache[r].vs,a=this.rawContentCache[r].fs,s=this.processModule(t,[],"vs"),l=s.content,f=s.includeList,d=this.processModule(a,[],"fs"),S=d.content,O=d.includeList,Z=S,U=(0,Kn.uniq)(f.concat(O).concat(r)).reduce(function(se,le){return(0,ue.Z)((0,ue.Z)({},se),n.rawContentCache[le].uniforms)},{});return yS.test(S)||(Z=Mg+S),this.moduleCache[r]={fs:Z.trim(),uniforms:U,vs:l.trim()},this.moduleCache[r]}},{key:"processModule",value:function(r,n,t){var a=this,s=r.replace(u2,function(l,f){var d=f.split(" "),S=d[0].replace(/"/g,"");if(n.indexOf(S)>-1)return"";var O=a.rawContentCache[S][t];n.push(S);var Z=a.processModule(O,n,t),U=Z.content;return U});return{content:s,includeList:n}}}]),e}())||qb);function c2(e,i){for(;!Object.prototype.hasOwnProperty.call(e,i)&&(e=(0,ot.Z)(e),e!==null););return e}function $u(){return typeof Reflect!="undefined"&&Reflect.get?$u=Reflect.get.bind():$u=function(i,r,n){var t=c2(i,r);if(t){var a=Object.getOwnPropertyDescriptor(t,r);return a.get?a.get.call(arguments.length<3?i:n):a.value}},$u.apply(this,arguments)}var Sv;(function(e){e.Normal="normal",e.PostProcessing="post-processing"})(Sv||(Sv={}));var y_,Py,B0=(y_=(0,Xr.b2)(),y_(Py=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"shaderModuleService",void 0),(0,V.Z)(this,"rendererService",void 0),(0,V.Z)(this,"cameraService",void 0),(0,V.Z)(this,"mapService",void 0),(0,V.Z)(this,"interactionService",void 0),(0,V.Z)(this,"layerService",void 0),(0,V.Z)(this,"config",void 0)}return(0,he.Z)(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Sv.Normal}},{key:"init",value:function(r,n){this.config=n,this.rendererService=r.getContainer().get(Ir.IRendererService),this.cameraService=r.getContainer().get(Ir.ICameraService),this.mapService=r.getContainer().get(Ir.IMapService),this.interactionService=r.getContainer().get(Ir.IInteractionService),this.layerService=r.getContainer().get(Ir.ILayerService),this.shaderModuleService=r.getContainer().get(Ir.IShaderModuleService)}},{key:"render",value:function(r){}}]),e}())||Py),__,x_;function f2(e){var i=b_();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function b_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var h2=(__=(0,Xr.b2)(),__(x_=function(e){(0,Ft.Z)(r,e);var i=f2(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(t,a){$u((0,ot.Z)(r.prototype),"init",this).call(this,t,a)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),r}(B0))||x_),E_,w_,S_,Oy,C_;function p2(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=d2(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function d2(e,i){if(e){if(typeof e=="string")return A_(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A_(e,i)}}function A_(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var v2=(E_=(0,Xr.b2)(),w_=(0,Xr.f3)(Ir.IPostProcessor),E_(S_=(Oy=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"passes",[]),Ys(this,"postProcessor",C_,this),(0,V.Z)(this,"layer",void 0),(0,V.Z)(this,"renderFlag",void 0),(0,V.Z)(this,"width",0),(0,V.Z)(this,"height",0)}return(0,he.Z)(e,[{key:"setLayer",value:function(r){this.layer=r}},{key:"setRenderFlag",value:function(r){this.renderFlag=r}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(){var t,a,s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:t=p2(this.passes),f.prev=1,t.s();case 3:if((a=t.n()).done){f.next=9;break}return s=a.value,f.next=7,s.render(this.layer);case 7:f.next=3;break;case 9:f.next=14;break;case 11:f.prev=11,f.t0=f.catch(1),t.e(f.t0);case 14:return f.prev=14,t.f(),f.finish(14);case 17:return f.next=19,this.postProcessor.render(this.layer);case 19:case"end":return f.stop()}},n,this,[[1,11,14,17]])}));function r(){return i.apply(this,arguments)}return r}()},{key:"resize",value:function(r,n){(this.width!==r||this.height!==n)&&(this.postProcessor.resize(r,n),this.width=r,this.height=n)}},{key:"add",value:function(r,n){r.getType()===Sv.PostProcessing?this.postProcessor.add(r,this.layer,n):(r.init(this.layer,n),this.passes.push(r))}},{key:"insert",value:function(r,n,t){r.init(this.layer,n),this.passes.splice(t,0,r)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),C_=Hs(Oy.prototype,"postProcessor",[w_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oy))||S_),Iy,T_;function m2(e){var i=g2();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function g2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var y2=(Iy=(0,Xr.b2)(),Iy(T_=function(e){(0,Ft.Z)(r,e);var i=m2(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"pickingFBO",void 0),(0,V.Z)((0,ct.Z)(n),"layer",void 0),(0,V.Z)((0,ct.Z)(n),"width",0),(0,V.Z)((0,ct.Z)(n),"height",0),(0,V.Z)((0,ct.Z)(n),"alreadyInRendering",!1),(0,V.Z)((0,ct.Z)(n),"pickFromPickingFBO",function(l){var f=l.x,d=l.y,S=l.lngLat,O=l.type;if(!(!n.layer.isVisible()||!n.layer.needPick(O))){var Z=n.rendererService,U=Z.getViewportSize,se=Z.readPixels,le=Z.useFramebuffer,ye=U(),Be=ye.width,rt=ye.height,Je=n.layer.getLayerConfig(),Ot=Je.enableHighlight,jt=Je.enableSelect,dr=f*ju,Lr=d*ju;if(!(dr>Be||dr<0||Lr>rt||Lr<0)){var jr;le(n.pickingFBO,function(){var Jr;if(jr=se({x:Math.round(dr),y:Math.round(rt-(d+1)*ju),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:n.pickingFBO}),jr[0]!==0||jr[1]!==0||jr[2]!==0){var Pn=Xa(jr),In=n.layer.getSource().getFeatureById(Pn),Si={x:f,y:d,type:O,lngLat:S,featureId:Pn,feature:In};In&&(n.layer.setCurrentPickId(Pn),n.triggerHoverOnLayer(Si))}else{var ra={x:f,y:d,lngLat:S,type:n.layer.getCurrentPickId()===null?"un"+O:"mouseout",featureId:null,feature:null};n.triggerHoverOnLayer((0,ue.Z)((0,ue.Z)({},ra),{},{type:"unpick"})),n.triggerHoverOnLayer(ra),n.layer.setCurrentPickId(null)}Ot&&n.highlightPickedFeature(jr),jt&&O==="click"&&((Jr=jr)===null||Jr===void 0?void 0:Jr.toString())!==[0,0,0,0].toString()&&n.selectFeature(jr)})}}}),n}return(0,he.Z)(r,[{key:"getType",value:function(){return Sv.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(t,a){$u((0,ot.Z)(r.prototype),"init",this).call(this,t,a),this.layer=t;var s=this.rendererService,l=s.createTexture2D,f=s.createFramebuffer,d=s.getViewportSize,S=d(),O=S.width,Z=S.height;this.pickingFBO=f({color:l({width:O,height:Z,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE})}),this.interactionService.on(Lh.Hover,this.pickFromPickingFBO),this.interactionService.on(Lh.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Lh.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(t){var a=this;if(!this.alreadyInRendering){var s=this.rendererService,l=s.getViewportSize,f=s.useFramebuffer,d=s.clear,S=l(),O=S.width,Z=S.height;this.alreadyInRendering=!0,(this.width!==O||this.height!==Z)&&(this.pickingFBO.resize({width:O,height:Z}),this.width=O,this.height=Z),f(this.pickingFBO,function(){d({framebuffer:a.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var U=a.layer.multiPassRenderer.getRenderFlag();a.layer.multiPassRenderer.setRenderFlag(!1),t.hooks.beforePickingEncode.call(),t.render(),t.hooks.afterPickingEncode.call(),a.layer.multiPassRenderer.setRenderFlag(U),a.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(t){this.layer.emit(t.type,t)}},{key:"highlightPickedFeature",value:function(t){var a=(0,Ja.Z)(t,3),s=a[0],l=a[1],f=a[2];this.layer.hooks.beforeHighlight.call([s,l,f]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(t){var a=(0,Ja.Z)(t,3),s=a[0],l=a[1],f=a[2];this.layer.hooks.beforeSelect.call([s,l,f]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(t){var a=t.featureId,s=of(a);this.selectFeature(new Uint8Array(s))}},{key:"highlightFeatureHandle",value:function(t){var a=t.featureId,s=of(a);this.highlightPickedFeature(new Uint8Array(s))}}]),r}(B0))||T_),Ly,M_,P_,Pg,O_,_2=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,sv=(Ly=(0,Xr.b2)(),M_=(0,Xr.f3)(Ir.IShaderModuleService),Ly(P_=(Pg=function(){function e(){(0,re.Z)(this,e),Ys(this,"shaderModuleService",O_,this),(0,V.Z)(this,"rendererService",void 0),(0,V.Z)(this,"config",void 0),(0,V.Z)(this,"quad",_2),(0,V.Z)(this,"enabled",!0),(0,V.Z)(this,"renderToScreen",!1),(0,V.Z)(this,"model",void 0),(0,V.Z)(this,"name",void 0),(0,V.Z)(this,"optionsToUpdate",{})}return(0,he.Z)(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(r){this.name=r}},{key:"getType",value:function(){return Sv.PostProcessing}},{key:"init",value:function(r,n){this.config=n,this.rendererService=r.getContainer().get(Ir.IRendererService),this.shaderModuleService=r.getContainer().get(Ir.IShaderModuleService);var t=this.rendererService,a=t.createAttribute,s=t.createBuffer,l=t.createModel,f=this.setupShaders(),d=f.vs,S=f.fs,O=f.uniforms;this.model=l({vs:d,fs:S,attributes:{a_Position:a({buffer:s({data:[-4,-4,4,-4,0,4],type:Ve.FLOAT}),size:2})},uniforms:(0,ue.Z)((0,ue.Z)({u_Texture:null},O),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(r,n){var t=this,a=r.multiPassRenderer.getPostProcessor(),s=this.rendererService,l=s.useFramebuffer,f=s.getViewportSize,d=s.clear,S=f(),O=S.width,Z=S.height;l(this.renderToScreen?null:a.getWriteFBO(),function(){d({framebuffer:a.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var U=(0,ue.Z)({u_BloomFinal:0,u_Texture:a.getReadFBO(),u_ViewportSize:[O,Z]},t.convertOptionsToUniforms(t.optionsToUpdate));n&&(U.u_BloomFinal=1,U.u_Texture2=n),t.model.draw({uniforms:U})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(r){this.enabled=r}},{key:"setRenderToScreen",value:function(r){this.renderToScreen=r}},{key:"updateOptions",value:function(r){this.optionsToUpdate=(0,ue.Z)((0,ue.Z)({},this.optionsToUpdate),r)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(r){var n={};return Object.keys(r).forEach(function(t){(0,Kn.isNil)(r[t])||(n["u_".concat((0,Kn.upperFirst)((0,Kn.camelCase)(t)))]=r[t])}),n}}]),e}(),O_=Hs(Pg.prototype,"shaderModuleService",[M_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pg))||P_),I_,L_;function Ry(e){var i=x2();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function x2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var b2=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,E2=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,w2=(I_=(0,Xr.b2)(),I_(L_=function(e){(0,Ft.Z)(r,e);var i=Ry(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:E2,fs:b2});var t=this.shaderModuleService.getModule("blur-pass"),a=t.vs,s=t.fs,l=t.uniforms,f=this.rendererService.getViewportSize(),d=f.width,S=f.height;return{vs:a,fs:s,uniforms:(0,ue.Z)((0,ue.Z)({},l),{},{u_ViewportSize:[d,S]})}}},{key:"convertOptionsToUniforms",value:function(t){var a={};return(0,Kn.isNil)(t.bloomRadius)||(a.u_radius=t.bloomRadius),(0,Kn.isNil)(t.bloomIntensity)||(a.u_intensity=t.bloomIntensity),(0,Kn.isNil)(t.bloomBaseRadio)||(a.u_baseRadio=t.bloomBaseRadio),a}}]),r}(sv))||L_),R_,k_;function S2(e){var i=C2();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function C2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var A2=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,T2=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,M2=(R_=(0,Xr.b2)(),R_(k_=function(e){(0,Ft.Z)(r,e);var i=S2(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:T2,fs:A2});var t=this.shaderModuleService.getModule("blur-pass"),a=t.vs,s=t.fs,l=t.uniforms,f=this.rendererService.getViewportSize(),d=f.width,S=f.height;return{vs:a,fs:s,uniforms:(0,ue.Z)((0,ue.Z)({},l),{},{u_ViewportSize:[d,S]})}}},{key:"convertOptionsToUniforms",value:function(t){var a={};return(0,Kn.isNil)(t.blurRadius)||(a.u_BlurDir=[t.blurRadius,0]),a}}]),r}(sv))||k_),ky,D_;function P2(e){var i=O2();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function O2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var I2=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,L2=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,R2=(ky=(0,Xr.b2)(),ky(D_=function(e){(0,Ft.Z)(r,e);var i=P2(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:L2,fs:I2});var t=this.shaderModuleService.getModule("blur-pass"),a=t.vs,s=t.fs,l=t.uniforms,f=this.rendererService.getViewportSize(),d=f.width,S=f.height;return{vs:a,fs:s,uniforms:(0,ue.Z)((0,ue.Z)({},l),{},{u_ViewportSize:[d,S]})}}},{key:"convertOptionsToUniforms",value:function(t){var a={};return(0,Kn.isNil)(t.blurRadius)||(a.u_BlurDir=[0,t.blurRadius]),a}}]),r}(sv))||D_),Dy,F_;function k2(e){var i=B_();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function B_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var D2=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,F2=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,B2=(Dy=(0,Xr.b2)(),Dy(F_=function(e){(0,Ft.Z)(r,e);var i=k2(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:F2,fs:D2});var t=this.shaderModuleService.getModule("colorhalftone-pass"),a=t.vs,s=t.fs,l=t.uniforms,f=this.rendererService.getViewportSize(),d=f.width,S=f.height;return{vs:a,fs:s,uniforms:(0,ue.Z)((0,ue.Z)({},l),{},{u_ViewportSize:[d,S]})}}}]),r}(sv))||F_),N_,z_;function Z_(e){var i=N2();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function N2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var z2=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Z2=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,U2=(N_=(0,Xr.b2)(),N_(z_=function(e){(0,Ft.Z)(r,e);var i=Z_(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:Z2,fs:z2}),this.shaderModuleService.getModule("copy-pass")}}]),r}(sv))||z_),U_,j_;function j2(e){var i=V2();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function V2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var H2=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,G2=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,$2=(U_=(0,Xr.b2)(),U_(j_=function(e){(0,Ft.Z)(r,e);var i=j2(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:G2,fs:H2});var t=this.shaderModuleService.getModule("hexagonalpixelate-pass"),a=t.vs,s=t.fs,l=t.uniforms,f=this.rendererService.getViewportSize(),d=f.width,S=f.height;return{vs:a,fs:s,uniforms:(0,ue.Z)((0,ue.Z)({},l),{},{u_ViewportSize:[d,S]})}}}]),r}(sv))||j_),V_,H_;function W2(e){var i=X2();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function X2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Y2=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,K2=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,q2=(V_=(0,Xr.b2)(),V_(H_=function(e){(0,Ft.Z)(r,e);var i=W2(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:K2,fs:Y2});var t=this.shaderModuleService.getModule("ink-pass"),a=t.vs,s=t.fs,l=t.uniforms,f=this.rendererService.getViewportSize(),d=f.width,S=f.height;return{vs:a,fs:s,uniforms:(0,ue.Z)((0,ue.Z)({},l),{},{u_ViewportSize:[d,S]})}}}]),r}(sv))||H_),G_,$_;function km(e){var i=Q2();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Q2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fy=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,J2=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,eE=(G_=(0,Xr.b2)(),G_($_=function(e){(0,Ft.Z)(r,e);var i=km(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:J2,fs:Fy}),this.shaderModuleService.getModule("noise-pass")}}]),r}(sv))||$_),W_,X_;function tE(e){var i=Y_();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Y_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var K_=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,rE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,Og=(W_=(0,Xr.b2)(),W_(X_=function(e){(0,Ft.Z)(r,e);var i=tE(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:K_,fs:rE}),this.shaderModuleService.getModule("sepia-pass")}}]),r}(sv))||X_),By,Ig,q_,u0,N0,Lg,Ny=(By=(0,Xr.b2)(),Ig=(0,Xr.f3)(Ir.IRendererService),q_=(0,Xr.zY)(),By(u0=(N0=function(){function e(){(0,re.Z)(this,e),Ys(this,"rendererService",Lg,this),(0,V.Z)(this,"passes",[]),(0,V.Z)(this,"readFBO",void 0),(0,V.Z)(this,"writeFBO",void 0)}return(0,he.Z)(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var r=this.rendererService,n=r.getViewportSize,t=r.createTexture2D,a=n(),s=a.width,l=a.height;return t({x:0,y:0,width:s,height:l,copy:!0})}},{key:"getReadFBOTex",value:function(){var r=this,n=this.rendererService.useFramebuffer;return new Promise(function(t){n(r.readFBO,(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:t(r.getCurrentFBOTex());case 1:case"end":return l.stop()}},a)})))})}},{key:"renderBloomPass",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t,a){var s,l;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.getReadFBOTex();case 2:s=d.sent,l=0;case 4:if(!(l<4)){d.next=11;break}return d.next=7,a.render(t,s);case 7:this.swap(),l++,d.next=4;break;case 11:case"end":return d.stop()}},n,this)}));function r(n,t){return i.apply(this,arguments)}return r}()},{key:"render",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t){var a,s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:a=0;case 1:if(!(a<this.passes.length)){f.next=15;break}if(s=this.passes[a],s.setRenderToScreen(this.isLastEnabledPass(a)),s.getName()!=="bloom"){f.next=9;break}return f.next=7,this.renderBloomPass(t,s);case 7:f.next=12;break;case 9:return f.next=11,s.render(t);case 11:a!==this.passes.length-1&&this.swap();case 12:a++,f.next=1;break;case 15:case"end":return f.stop()}},n,this)}));function r(n){return i.apply(this,arguments)}return r}()},{key:"resize",value:function(r,n){this.readFBO.resize({width:r,height:n}),this.writeFBO.resize({width:r,height:n})}},{key:"add",value:function(r,n,t){r.init(n,t),this.passes.push(r)}},{key:"insert",value:function(r,n,t,a){r.init(t,a),this.passes.splice(n,0,r)}},{key:"getPostProcessingPassByName",value:function(r){return this.passes.find(function(n){return n.getName()===r})}},{key:"init",value:function(){var r=this.rendererService,n=r.createFramebuffer,t=r.createTexture2D;this.readFBO=n({color:t({width:1,height:1,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE})}),this.writeFBO=n({color:t({width:1,height:1,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(r){for(var n=r+1;n<this.passes.length;n++)if(this.passes[n].isEnabled())return!1;return!0}},{key:"swap",value:function(){var r=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=r}}]),e}(),Lg=Hs(N0.prototype,"rendererService",[Ig],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hs(N0.prototype,"init",[q_],Object.getOwnPropertyDescriptor(N0.prototype,"init"),N0.prototype),N0))||u0),Q_,J_;function nE(e){var i=iE();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function iE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ex=(Q_=(0,Xr.b2)(),Q_(J_=function(e){(0,Ft.Z)(r,e);var i=nE(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getType",value:function(){return Sv.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(t,a){$u((0,ot.Z)(r.prototype),"init",this).call(this,t,a)}},{key:"render",value:function(t){var a=this.rendererService,s=a.useFramebuffer,l=a.clear,f=t.multiPassRenderer.getPostProcessor().getReadFBO();s(f,function(){l({color:[0,0,0,0],depth:1,stencil:0,framebuffer:f}),t.multiPassRenderer.setRenderFlag(!1),t.models.forEach(function(d){d.draw({uniforms:t.layerModel.getUninforms()})}),t.multiPassRenderer.setRenderFlag(!0)})}}]),r}(B0))||J_),zy,tx,rx,Zy,Uy;function aE(e){var i=nx();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function nx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var oE=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,jy=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Vy=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function ix(e,i){for(var r=0,n=1/i,t=e;t>0;)r=r+n*(t%i),t=Math.floor(t/i),n=n/i;return r}var sE=1,uE=(zy=(0,Xr.b2)(),tx=(0,Xr.f3)(Ir.IShaderModuleService),zy(rx=(Zy=function(e){(0,Ft.Z)(r,e);var i=aE(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),Ys((0,ct.Z)(n),"shaderModuleService",Uy,(0,ct.Z)(n)),(0,V.Z)((0,ct.Z)(n),"haltonSequence",[]),(0,V.Z)((0,ct.Z)(n),"accumulatingId",0),(0,V.Z)((0,ct.Z)(n),"frame",0),(0,V.Z)((0,ct.Z)(n),"timer",void 0),(0,V.Z)((0,ct.Z)(n),"sampleRenderTarget",void 0),(0,V.Z)((0,ct.Z)(n),"prevRenderTarget",void 0),(0,V.Z)((0,ct.Z)(n),"outputRenderTarget",void 0),(0,V.Z)((0,ct.Z)(n),"copyRenderTarget",void 0),(0,V.Z)((0,ct.Z)(n),"blendModel",void 0),(0,V.Z)((0,ct.Z)(n),"outputModel",void 0),(0,V.Z)((0,ct.Z)(n),"copyModel",void 0),n}return(0,he.Z)(r,[{key:"getType",value:function(){return Sv.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(t,a){$u((0,ot.Z)(r.prototype),"init",this).call(this,t,a);var s=this.rendererService,l=s.createFramebuffer,f=s.createTexture2D;this.sampleRenderTarget=l({color:f({width:1,height:1,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE})}),this.prevRenderTarget=l({color:f({width:1,height:1,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE})}),this.outputRenderTarget=l({color:f({width:1,height:1,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE})}),this.copyRenderTarget=l({color:f({width:1,height:1,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE})});for(var d=0;d<30;d++)this.haltonSequence.push([ix(d,2),ix(d,3)]);this.blendModel=this.createTriangleModel("blend-pass",oE),this.outputModel=this.createTriangleModel("copy-pass",jy,{blend:{enable:!0,func:{srcRGB:Ve.ONE,dstRGB:Ve.ONE_MINUS_SRC_ALPHA,srcAlpha:Ve.ONE,dstAlpha:Ve.ONE_MINUS_SRC_ALPHA},equation:{rgb:Ve.FUNC_ADD,alpha:Ve.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",jy)}},{key:"render",value:function(t){var a=this,s=this.rendererService,l=s.clear,f=s.getViewportSize,d=s.useFramebuffer,S=f(),O=S.width,Z=S.height;this.sampleRenderTarget.resize({width:O,height:Z}),this.prevRenderTarget.resize({width:O,height:Z}),this.outputRenderTarget.resize({width:O,height:Z}),this.copyRenderTarget.resize({width:O,height:Z}),this.resetFrame(),this.stopAccumulating();var U=t.multiPassRenderer.getPostProcessor().getReadFBO();d(U,function(){l({color:[0,0,0,0],depth:1,stencil:0,framebuffer:U}),t.multiPassRenderer.setRenderFlag(!1),t.render(),t.multiPassRenderer.setRenderFlag(!0)});var se=function le(ye){!a.accumulatingId||ye!==a.accumulatingId||a.isFinished()||(a.doRender(t),ha.requestAnimationFrame(function(){le(ye)}))};this.accumulatingId=sE++,this.timer=ha.setTimeout(function(){se(a.accumulatingId)},50)}},{key:"doRender",value:function(t){var a=this,s=this.rendererService,l=s.clear,f=s.getViewportSize,d=s.useFramebuffer,S=f(),O=S.width,Z=S.height,U=t.getLayerConfig(),se=U.jitterScale,le=se===void 0?1:se,ye=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((ye[0]*2-1)/O*le,(ye[1]*2-1)/Z*le),t.multiPassRenderer.setRenderFlag(!1),t.hooks.beforeRender.call(),d(this.sampleRenderTarget,function(){l({color:[0,0,0,0],depth:1,stencil:0,framebuffer:a.sampleRenderTarget}),t.render()}),t.hooks.afterRender.call(),t.multiPassRenderer.setRenderFlag(!0);var Be=t.getLayerConfig();d(this.outputRenderTarget,function(){a.blendModel.draw({uniforms:{u_opacity:Be.opacity||1,u_MixRatio:a.frame===0?1:.9,u_Diffuse1:a.sampleRenderTarget,u_Diffuse2:a.frame===0?t.multiPassRenderer.getPostProcessor().getReadFBO():a.prevRenderTarget}})}),this.frame===0&&l({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(d(this.copyRenderTarget,function(){a.outputModel.draw({uniforms:{u_Texture:a.outputRenderTarget}})}),d(t.multiPassRenderer.getPostProcessor().getReadFBO(),function(){a.copyModel.draw({uniforms:{u_Texture:a.copyRenderTarget}})}),t.multiPassRenderer.getPostProcessor().render(t));var rt=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=rt,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,ha.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(t,a,s){this.shaderModuleService.registerModule(t,{vs:Vy,fs:a});var l=this.shaderModuleService.getModule(t),f=l.vs,d=l.fs,S=l.uniforms,O=this.rendererService,Z=O.createAttribute,U=O.createBuffer,se=O.createModel;return se((0,ue.Z)({vs:f,fs:d,attributes:{a_Position:Z({buffer:U({data:[-4,-4,4,-4,0,4],type:Ve.FLOAT}),size:2})},uniforms:(0,ue.Z)({},S),depth:{enable:!1},count:3},s))}}]),r}(B0),Uy=Hs(Zy.prototype,"shaderModuleService",[tx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zy))||rx),Dm=new Xr.W2;Dm.bind(Ir.IGlobalConfigService).to(im).inSingletonScope(),(0,Xr.GW)((0,Xr.b2)(),Kc.EventEmitter),Dm.bind(Ir.IEventEmitter).to(Kc.EventEmitter);var ax=(0,ua.Z)(Dm,!1),Rg=function(i){var r=ax.lazyInject(i);return function(n,t,a){r.call(this,n,t),a&&(a.initializer=function(){return n[t]})}},Hy=function(i){var r=ax.lazyMultiInject(i);return function(n,t,a){r.call(this,n,t),a&&(a.initializer=function(){return n[t]})}},bd=Dm,lE=0;function Gy(){var e=new Xr.W2;return e.parent=Dm,e.bind(Ir.SceneID).toConstantValue("".concat(lE++)),e.bind(Ir.IShaderModuleService).to(l2).inSingletonScope(),e.bind(Ir.ILayerService).to(Gu).inSingletonScope(),e.bind(Ir.IDebugService).to(gm).inSingletonScope(),e.bind(Ir.ISceneService).to(Yb).inSingletonScope(),e.bind(Ir.ICameraService).to(em).inSingletonScope(),e.bind(Ir.ICoordinateSystemService).to(C1).inSingletonScope(),e.bind(Ir.IInteractionService).to(T1).inSingletonScope(),e.bind(Ir.IPickingService).to(M1).inSingletonScope(),e.bind(Ir.IControlService).to(tm).inSingletonScope(),e.bind(Ir.IMarkerService).to(cf).inSingletonScope(),e.bind(Ir.IIconService).to(xc).inSingletonScope(),e.bind(Ir.IFontService).to(Hu).inSingletonScope(),e.bind(Ir.IPopupService).to(rm).inSingletonScope(),e.bind(Ir.INormalPass).to(h2).whenTargetNamed("clear"),e.bind(Ir.INormalPass).to(y2).whenTargetNamed("pixelPicking"),e.bind(Ir.INormalPass).to(ex).whenTargetNamed("render"),e.bind(Ir.INormalPass).to(uE).whenTargetNamed("taa"),e.bind(Ir.IFactoryNormalPass).toFactory(function(i){return function(r){return i.container.getNamed(Ir.INormalPass,r)}}),e.bind(Ir.IPostProcessingPass).to(U2).whenTargetNamed("copy"),e.bind(Ir.IPostProcessingPass).to(w2).whenTargetNamed("bloom"),e.bind(Ir.IPostProcessingPass).to(M2).whenTargetNamed("blurH"),e.bind(Ir.IPostProcessingPass).to(R2).whenTargetNamed("blurV"),e.bind(Ir.IPostProcessingPass).to(eE).whenTargetNamed("noise"),e.bind(Ir.IPostProcessingPass).to(Og).whenTargetNamed("sepia"),e.bind(Ir.IPostProcessingPass).to(B2).whenTargetNamed("colorHalftone"),e.bind(Ir.IPostProcessingPass).to($2).whenTargetNamed("hexagonalPixelate"),e.bind(Ir.IPostProcessingPass).to(q2).whenTargetNamed("ink"),e.bind(Ir.IFactoryPostProcessingPass).toFactory(function(i){return function(r){var n=i.container.getNamed(Ir.IPostProcessingPass,r);return n.setName(r),n}}),e}function Fm(e){var i=new Xr.W2;return i.parent=e,i.bind(Ir.IStyleAttributeService).to(Db).inSingletonScope(),i.bind(Ir.IMultiPassRenderer).to(v2).inSingletonScope(),i.bind(Ir.IPostProcessor).to(Ny).inSingletonScope(),i}var cE=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function fE(e){return cE.indexOf(e)}var hE=2,_S=4,pE=64,xS=128,dE=256,vE=512,mE=8192,ox=16384,bS=32768,gE=null,Bm=131072,ES=262144,yE=524288,sx=1048576,_E=2097152,wS=4194304,xE=8388608,bE=16777216,EE=null;function kg(e,i){return e=(0,Kn.clamp)(Math.floor(e),0,255),i=(0,Kn.clamp)(Math.floor(i),0,255),256*e+i}function wE(e){var i=e.color,r=e.radius,n=e.tileX,t=e.tileY,a=e.shape,s=e.opacity,l=e.stroke,f=e.strokeWidth,d=e.strokeOpacity,S=[],O=[],Z=[],U=[kg(i[0],i[1]),kg(i[2],i[3])],se=[kg(l[0],l[1]),kg(l[2],l[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(le){var ye=(0,Ja.Z)(le,2),Be=ye[0],rt=ye[1];S.push([].concat(U,[(Be+1)*xE+(rt+1)*_E+fE(a)*Bm+r,(n+512)*yE+(t+512)*pE])),O.push([].concat(se,[f,d])),Z.push([s,0,0,0])}),{packedBuffer:S,packedBuffer2:O,packedBuffer3:Z}}function SS(e,i){if(e===0&&!i)return 0;if(e===1&&i)return 4294967295;var r=i?1:0,n=Math.floor(e*127);return n*EE+r*bE+n*Bm+r*gE+n*vE+r*dE+n*hE+r}var jv={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},nh={MapInitStart:"mapInitStart",LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"},Rd;(function(e){e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none"})(Rd||(Rd={}));var ih;(function(e){e.INIT="init",e.UPDATE="update"})(ih||(ih={}));var sc;(function(e){e.LINEAR="linear",e.SEQUENTIAL="sequential",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat",e.DIVERGING="diverging"})(sc||(sc={}));var Cv;(function(e){e.CONSTANT="constant",e.VARIABLE="variable"})(Cv||(Cv={}));var Da;(function(e){e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform"})(Da||(Da={}));var Nm=["mapload","mapchange","mapAfterFrameChange"],zm=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],kd;(function(e){e.IMAGE="image",e.ARRAYBUFFER="arraybuffer",e.RGB="rgb",e.CUSTOMRGB="customRGB",e.CUSTOMARRAYBUFFER="customArrayBuffer"})(kd||(kd={}));var SE=function(){var e=(0,Dt.Z)(Ze().mark(function i(r,n,t,a){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",new Promise(function(f,d){n({x:r.x,y:r.y,z:r.z},function(S,O){if(S||O.length===0){d(S);return}O&&sr([{data:O,bands:[0]}],t,a,function(Z,U){Z?d(Z):U&&f(U)})})}));case 1:case"end":return l.stop()}},i)}));return function(r,n,t,a){return e.apply(this,arguments)}}();function CE(e,i){return Array.isArray(e)?typeof e[0]=="string"?e.map(function(r){return Oc(r,i)}):e.map(function(r){return{url:Oc(r.url,i),bands:r.bands||[0]}}):Oc(e,i)}function ux(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(function(i){return{url:i,bands:[0]}}):e}function lx(e,i){e.xhrCancel=function(){i.map(function(r){r.abort()})}}var AE=function(){var e=(0,Dt.Z)(Ze().mark(function i(r,n,t,a,s){var l,f,d,S,O,Z;return Ze().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:if(l=ux(n.url),!(l.length>1)){se.next=15;break}return se.next=4,TE(l,n);case 4:if(f=se.sent,d=f.rasterFiles,S=f.xhrList,O=f.errList,lx(r,S),!(O.length>0)){se.next=12;break}return t(O,null),se.abrupt("return");case 12:sr(d,a,s,t),se.next=17;break;case 15:Z=Au(n,function(le,ye){if(le)t(le);else if(ye){var Be=[{data:ye,bands:l[0].bands}];sr(Be,a,s,t)}}),lx(r,[Z]);case 17:case"end":return se.stop()}},i)}));return function(r,n,t,a,s){return e.apply(this,arguments)}}();function TE(e,i){return $y.apply(this,arguments)}function $y(){return $y=(0,Dt.Z)(Ze().mark(function e(i,r){var n,t,a,s,l,f,d,S,O,Z,U;return Ze().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:n=[],t=[],a=[],s=0;case 4:if(!(s<i.length)){le.next=20;break}return l=i[s],f=(0,ue.Z)((0,ue.Z)({},r),{},{url:l.url}),d=l.bands,le.next=10,Za((0,ue.Z)((0,ue.Z)({},f),{},{type:"arrayBuffer"}));case 10:S=le.sent,O=S.err,Z=S.data,U=S.xhr,O&&a.push(O),t.push(U),n.push({data:Z,bands:d});case 17:s++,le.next=4;break;case 20:return le.abrupt("return",{rasterFiles:n,xhrList:t,errList:a});case 21:case"end":return le.stop()}},e)})),$y.apply(this,arguments)}var ME=function(){var e=(0,Dt.Z)(Ze().mark(function i(r,n,t,a,s){var l;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return l={url:CE(r,n)},d.abrupt("return",new Promise(function(S,O){AE(t,l,function(Z,U){Z?O(Z):U&&S(U)},a,s)}));case 2:case"end":return d.stop()}},i)}));return function(r,n,t,a,s){return e.apply(this,arguments)}}(),Wy=function(){var e=(0,Dt.Z)(Ze().mark(function i(r,n,t,a){var s,l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return l=Array.isArray(r)?r[0]:r,a.wmtsOptions?(f=(a==null?void 0:a.getURLFromTemplate)||qh,s=f(l,(0,ue.Z)((0,ue.Z)({},n),a.wmtsOptions))):(d=(a==null?void 0:a.getURLFromTemplate)||Oc,s=d(l,n)),O.abrupt("return",new Promise(function(Z,U){var se,le=mc({url:s,type:(a==null||(se=a.requestParameters)===null||se===void 0?void 0:se.type)||"arrayBuffer"},function(ye,Be){ye?U(ye):Be&&Z(Be)},a.transformResponse);t.xhrCancel=function(){return le.abort()}}));case 3:case"end":return O.stop()}},i)}));return function(r,n,t,a){return e.apply(this,arguments)}}(),Xy=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},PE={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},CS=[kd.ARRAYBUFFER,kd.RGB];function OE(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function IE(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(OE(e))throw new Error("tile server url is error");var r=(i==null?void 0:i.dataType)||kd.IMAGE;r===kd.RGB&&(r=kd.ARRAYBUFFER);var n=function(s,l){switch(r){case kd.IMAGE:return Wy(e,s,l,i);case kd.ARRAYBUFFER:return ME(e,s,l,(i==null?void 0:i.format)||Xy,i==null?void 0:i.operation);case kd.CUSTOMARRAYBUFFER:case kd.CUSTOMRGB:return SE(l,i==null?void 0:i.getCustomData,(i==null?void 0:i.format)||Xy,i==null?void 0:i.operation);default:return Wy(e,s,l,i)}},t=(0,ue.Z)((0,ue.Z)((0,ue.Z)({},PE),i),{},{getTileData:n});return{data:e,dataArray:[],tilesetOptions:t,isTile:!0}}var LE=["extent","min","max","width","height","format","operation"];function RE(e,i){var r=i.extent,n=i.min,t=i.max,a=i.width,s=i.height,l=i.format,f=i.operation,d=(0,Xo.Z)(i,LE),S;if(l===void 0||kn(e))S=Array.from(e);else{var O=Array.isArray(e)?e:[e];S=qe(O,l,f)}var Z={_id:1,dataArray:[(0,ue.Z)((0,ue.Z)({_id:1,data:S,width:a,height:s},d),{},{min:n,max:t,coordinates:[[r[0],r[1]],[r[2],r[3]]]})]};return Z}var kE={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},DE=function(){var e=(0,Dt.Z)(Ze().mark(function i(r){return Ze().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(a){var s=(0,Ja.Z)(r.bounds,4),l=s[0],f=s[1],d=s[2],S=s[3],O={layers:{testTile:{features:[{type:"Feature",properties:{key:r.x+"/"+r.y+"/"+r.z,textLng:(l+d)/2,textLat:(f+S)/2},geometry:{type:"LineString",coordinates:[[d,S],[d,f],[l,f],[l,f]]}}]}}};a(O)}));case 1:case"end":return t.stop()}},i)}));return function(r){return e.apply(this,arguments)}}();function FE(e,i){var r=function(a){return DE(a)},n=(0,ue.Z)((0,ue.Z)((0,ue.Z)({},kE),i),{},{getTileData:r});return{data:e,dataArray:[],tilesetOptions:n,isTile:!0}}var BE=I(69848),Dg=I.n(BE);function cx(e,i){var r=i.radius,n=r===void 0?40:r,t=i.maxZoom,a=t===void 0?18:t,s=i.minZoom,l=s===void 0?0:s,f=i.zoom,d=f===void 0?2:f;if(e.pointIndex){var S=e.pointIndex.getClusters(e.extent,Math.floor(d));return e.dataArray=Zm(S),e}var O=new(Dg())({radius:n,minZoom:l,maxZoom:a}),Z={type:"FeatureCollection",features:[]};return Z.features=e.dataArray.map(function(U){return{type:"Feature",geometry:{type:"Point",coordinates:U.coordinates},properties:(0,ue.Z)({},U)}}),O.load(Z.features),O}function Zm(e){return e.map(function(i,r){return(0,ue.Z)({coordinates:i.geometry.coordinates,_id:r+1},i.properties)})}function NE(e){if(e.length===0)throw new Error("max requires at least one data point");for(var i=e[0],r=1;r<e.length;r++)e[r]>i&&(i=e[r]);return i}function zE(e){if(e.length===0)throw new Error("min requires at least one data point");for(var i=e[0],r=1;r<e.length;r++)e[r]<i&&(i=e[r]);return i}function fx(e){if(e.length===0)return 0;for(var i=e[0],r=0,n,t=1;t<e.length;t++)n=i+e[t]*1,Math.abs(i)>=Math.abs(e[t])?r+=i-n+e[t]:r+=e[t]-n+i,i=n;return i+r*1}function Um(e){if(e.length===0)throw new Error("mean requires at least one data point");return fx(e)/e.length}var ZE={min:zE,max:NE,mean:Um,sum:fx};function UE(e){var i=jE();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function jE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function VE(e,i){if(Array.isArray(i))return i}var AS=function(e){(0,Ft.Z)(r,e);var i=UE(r);function r(n,t){var a;return(0,re.Z)(this,r),a=i.call(this),(0,V.Z)((0,ct.Z)(a),"type","source"),(0,V.Z)((0,ct.Z)(a),"isTile",!1),(0,V.Z)((0,ct.Z)(a),"inited",!1),(0,V.Z)((0,ct.Z)(a),"hooks",{init:new ov}),(0,V.Z)((0,ct.Z)(a),"parser",{type:"geojson"}),(0,V.Z)((0,ct.Z)(a),"transforms",[]),(0,V.Z)((0,ct.Z)(a),"cluster",!1),(0,V.Z)((0,ct.Z)(a),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,V.Z)((0,ct.Z)(a),"invalidExtent",!1),(0,V.Z)((0,ct.Z)(a),"dataArrayChanged",!1),(0,V.Z)((0,ct.Z)(a),"cfg",{autoRender:!0}),a.originData=n,a.initCfg(t),a.init().then(function(){a.inited=!0,a.emit("update",{type:"inited"})}),a}return(0,he.Z)(r,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(t){return this.clusterIndex.getClusters(this.caculClusterExtent(2),t)}},{key:"getClustersLeaves",value:function(t){return this.clusterIndex.getLeaves(t,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(t){var a=this,s=this.clusterOptions,l=s.method,f=l===void 0?"sum":l,d=s.field,S=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(t));this.clusterOptions.zoom=t,S.forEach(function(O){O.id||(O.properties.point_count=1)}),(d||(0,Kn.isFunction)(f))&&(S=S.map(function(O){var Z=O.id;if(Z){var U=a.clusterIndex.getLeaves(Z,1/0),se=U.map(function(Be){return Be.properties}),le;if((0,Kn.isString)(f)&&d){var ye=yr(se,d);le=ZE[f](ye)}(0,Kn.isFunction)(f)&&(le=f(se)),O.properties.stat=le}else O.properties.point_count=1;return O})),this.data=W("geojson")({type:"FeatureCollection",features:S}),this.executeTrans()}},{key:"getFeatureById",value:function(t){var a=this.parser,s=a.type,l=s===void 0?"geojson":s,f=a.geometry;if(l==="geojson"&&!this.cluster){var d=t<this.originData.features.length?this.originData.features[t]:"null",S=(0,Kn.cloneDeep)(d);if(S!=null&&S.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var O=this.data.dataArray.find(function(Z){return Z._id===t});S.properties=O}return S}else return l==="json"&&f?this.data.dataArray.find(function(Z){return Z._id===t}):t<this.data.dataArray.length?this.data.dataArray[t]:"null"}},{key:"updateFeaturePropertiesById",value:function(t,a){this.data.dataArray=this.data.dataArray.map(function(s){return s._id===t?(0,ue.Z)((0,ue.Z)({},s),a):s}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(t,a){var s=this.data.dataArray.find(function(l){return l[t]===a});return s==null?void 0:s._id}},{key:"setData",value:function(t,a){var s=this;this.originData=t,this.dataArrayChanged=!1,this.initCfg(a),this.init().then(function(){s.emit("update",{type:"update"})})}},{key:"destroy",value:function(){var t;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(t=this.tileset)===null||t===void 0||t.destroy()}},{key:"processData",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s=this;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",new Promise(function(d,S){try{s.excuteParser(),s.initCluster(),s.executeTrans(),d({})}catch(O){S(O)}}));case 1:case"end":return f.stop()}},a)}));function t(){return n.apply(this,arguments)}return t}()},{key:"initCfg",value:function(t){this.cfg=(0,Kn.mergeWith)(this.cfg,t,VE);var a=this.cfg;a&&(a.parser&&(this.parser=a.parser),a.transforms&&(this.transforms=a.transforms),this.cluster=a.cluster||!1,a.clusterOptions&&(this.cluster=!0,this.clusterOptions=(0,ue.Z)((0,ue.Z)({},this.clusterOptions),a.clusterOptions)))}},{key:"init",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.inited=!1,l.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"excuteParser",value:function(){var t=this.parser,a=t.type||"geojson",s=W(a);this.data=s(this.originData,t),this.tileset=this.initTileset(),!t.cancelExtent&&(this.extent=ai(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(t){this.center=[(t[0]+t[2])/2,(t[1]+t[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var t=this.data.tilesetOptions;if(t){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(t),this.tileset;var a=new ph((0,ue.Z)({},t));return a}}},{key:"executeTrans",value:function(){var t=this,a=this.transforms;a.forEach(function(s){var l=s.type,f=G(l)(t.data,s);Object.assign(t.data,f)})}},{key:"initCluster",value:function(){if(this.cluster){var t=this.clusterOptions||{};this.clusterIndex=cx(this.data,t)}}},{key:"caculClusterExtent",value:function(t){var a=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(a=ko(El(this.extent),t)),a[0].concat(a[1])}}]),r}(Kc.EventEmitter);function hx(e,i){var r=i.callback;return r&&(e.dataArray=e.dataArray.filter(r)),e}function Yy(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=px(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function px(e,i){if(e){if(typeof e=="string")return HE(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HE(e,i)}}function HE(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var Fg=6378e3;function TS(e,i){var r=e.dataArray,n=i.size,t=n===void 0?10:n,a=t/(2*Math.PI*Fg)*(256<<20)/2,s=GE(r,t),l=s.gridHash,f=s.gridOffset,d=WE(l,f,i);return{yOffset:a,xOffset:a,radius:a,type:"grid",dataArray:d}}function GE(e,i){var r=1/0,n=-1/0,t,a=Yy(e),s;try{for(a.s();!(s=a.n()).done;){var l=s.value;t=l.coordinates[1],Number.isFinite(t)&&(r=t<r?t:r,n=t>n?t:n)}}catch(Je){a.e(Je)}finally{a.f()}var f=(r+n)/2,d=MS(i,f);if(d.xOffset<=0||d.yOffset<=0)return{gridHash:{},gridOffset:d};var S={},O=Yy(e),Z;try{for(O.s();!(Z=O.n()).done;){var U=Z.value,se=U.coordinates[1],le=U.coordinates[0];if(Number.isFinite(se)&&Number.isFinite(le)){var ye=Math.floor((se+90)/d.yOffset),Be=Math.floor((le+180)/d.xOffset),rt="".concat(ye,"-").concat(Be);S[rt]=S[rt]||{count:0,points:[]},S[rt].count+=1,S[rt].points.push(U)}}}catch(Je){O.e(Je)}finally{O.f()}return{gridHash:S,gridOffset:d}}function MS(e,i){var r=$E(e),n=PS(i,e);return{yOffset:r,xOffset:n}}function $E(e){return e/Fg*(180/Math.PI)}function PS(e,i){return i/Fg*(180/Math.PI)/Math.cos(e*Math.PI/180)}function WE(e,i,r){return Object.keys(e).reduce(function(n,t,a){var s=t.split("-"),l=parseInt(s[0],10),f=parseInt(s[1],10),d={};if(r.field&&r.method){var S=Bh(e[t].points,r.field);d[r.method]=Gl[r.method](S)}return Object.assign(d,{_id:a,coordinates:ga([-180+i.xOffset*(f+.5),-90+i.yOffset*(l+.5)]),rawData:e[t].points,count:e[t].count}),n.push(d),n},[])}var z0=Math.PI/3,XE=[0,z0,2*z0,3*z0,4*z0,5*z0];function Vv(e){return e[0]}function OS(e){return e[1]}function YE(){var e=0,i=0,r=1,n=1,t=Vv,a=OS,s,l,f;function d(O){var Z={},U=[],se,le=O.length;for(se=0;se<le;++se)if(!(isNaN(Be=+t.call(null,ye=O[se],se,O))||isNaN(rt=+a.call(null,ye,se,O)))){var ye,Be,rt,Je=Math.round(rt=rt/f),Ot=Math.round(Be=Be/l-(Je&1)/2),jt=rt-Je;if(Math.abs(jt)*3>1){var dr=Be-Ot,Lr=Ot+(Be<Ot?-1:1)/2,jr=Je+(rt<Je?-1:1),Jr=Be-Lr,Pn=rt-jr;dr*dr+jt*jt>Jr*Jr+Pn*Pn&&(Ot=Lr+(Je&1?1:-1)/2,Je=jr)}var In=Ot+"-"+Je,Si=Z[In];Si?Si.push(ye):(U.push(Si=Z[In]=[ye]),Si.x=(Ot+(Je&1)/2)*l,Si.y=Je*f)}return U}function S(O){var Z=0,U=0;return XE.map(function(se){var le=Math.sin(se)*O,ye=-Math.cos(se)*O,Be=le-Z,rt=ye-U;return Z=le,U=ye,[Be,rt]})}return d.hexagon=function(O){return"m"+S(O==null?s:+O).join("l")+"z"},d.centers=function(){for(var O=[],Z=Math.round(i/f),U=Math.round(e/l),se=Z*f;se<n+s;se+=f,++Z)for(var le=U*l+(Z&1)*l/2;le<r+l/2;le+=l)O.push([le,se]);return O},d.mesh=function(){var O=S(s).slice(0,4).join("l");return d.centers().map(function(Z){return"M"+Z+"m"+O}).join("")},d.x=function(O){return arguments.length?(t=O,d):t},d.y=function(O){return arguments.length?(a=O,d):a},d.radius=function(O){return arguments.length?(s=+O,l=s*2*Math.sin(z0),f=s*1.5,d):s},d.size=function(O){return arguments.length?(e=i=0,r=+O[0],n=+O[1],d):[r-e,n-i]},d.extent=function(O){return arguments.length?(e=+O[0][0],i=+O[0][1],r=+O[1][0],n=+O[1][1],d):[[e,i],[r,n]]},d.radius(1)}var KE=6378e3;function qE(e,i){var r=e.dataArray,n=i.size,t=n===void 0?10:n,a=i.method,s=a===void 0?"sum":a,l=t/(2*Math.PI*KE)*(256<<20)/2,f=r.map(function(Z){var U=ga(Z.coordinates),se=(0,Ja.Z)(U,2),le=se[0],ye=se[1];return(0,ue.Z)((0,ue.Z)({},Z),{},{coordinates:[le,ye]})}),d=YE().radius(l).x(function(Z){return Z.coordinates[0]}).y(function(Z){return Z.coordinates[1]}),S=d(f),O={dataArray:S.map(function(Z,U){var se;if(i.field&&s){var le=Bh(Z,i.field);Z[s]=Gl[s](le)}return se={},(0,V.Z)(se,i.method,Z[s]),(0,V.Z)(se,"count",Z.length),(0,V.Z)(se,"rawData",Z),(0,V.Z)(se,"coordinates",[Z.x,Z.y]),(0,V.Z)(se,"_id",U),se}),radius:l,xOffset:l,yOffset:l,type:"hexagon"};return O}function jm(e,i){var r=i.sourceField,n=i.targetField,t=i.data,a={};return t.forEach(function(s){a[s[r]]=s}),e.dataArray=e.dataArray.map(function(s){var l=s[n];return(0,ue.Z)((0,ue.Z)({},s),a[l])}),e}function IS(e,i){var r=i.callback;return r&&(e.dataArray=e.dataArray.map(r)),e}Y("rasterTile",IE),Y("mvt",c),Y("geojsonvt",Kr),Y("testTile",FE),Y("geojson",Hn),Y("image",Mo),Y("csv",Vt),Y("json",Er),Y("raster",Nn),Y("rasterRgb",RE),$("cluster",cx),$("filter",hx),$("join",jm),$("map",IS),$("grid",TS),$("hexagon",qE);var Hv=AS;function dx(e){var i=Ky();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Ky(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vx=function(e){(0,Ft.Z)(r,e);var i=dx(r);function r(n){var t;return(0,re.Z)(this,r),t=i.call(this),(0,V.Z)((0,ct.Z)(t),"added",!1),(0,V.Z)((0,ct.Z)(t),"eventHandle",function(a){t.polyfillEvent(a),t.emit(a.type,{target:a,data:t.markerOption.extData,lngLat:t.lngLat})}),t.markerOption=(0,ue.Z)((0,ue.Z)({},t.getDefault()),n),pr(["update","onMove","onMapClick"],(0,ct.Z)(t)),t.init(),t}return(0,he.Z)(r,[{key:"getMarkerLayerContainerSize",value:function(){}},{key:"getDefault",value:function(){return{element:void 0,anchor:lc.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(t){this.scene=t,this.mapsService=t.get(Ir.IMapService),this.sceneSerive=t.get(Ir.ISceneService);var a=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(a),this.registerMarkerEvent(a),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();var t=this.markerOption.element;return t&&Uu(t),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(t){return this.lngLat=t,Array.isArray(t)&&(this.lngLat={lng:t[0],lat:t[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(t){var a=this;if(!this.added)return this.once("added",function(){a.setElement(t)}),this;var s=this.markerOption.element;return s&&Uu(s),this.markerOption.element=t,this.init(),this.mapsService.getMarkerContainer().appendChild(t),this.registerMarkerEvent(t),this.update(),this}},{key:"openPopup",value:function(){var t=this;if(!this.added)return this.once("added",function(){t.openPopup()}),this;var a=this.popup;return a?(a.isOpen()||a.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var t=this;this.added||this.once("added",function(){t.closePopup()});var a=this.popup;return a&&a.remove(),this}},{key:"setPopup",value:function(t){return this.popup=t,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var t=this.popup;if(t)t.isOpen()?t.remove():t.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(t){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(t){this.markerOption.extData=t}},{key:"update",value:function(){if(this.mapsService){var t=this.markerOption,a=t.element,s=t.anchor;this.updatePosition(),Af(a,"".concat(Ku[s]))}}},{key:"onMapClick",value:function(t){var a=this.markerOption.element;this.popup&&a&&this.togglePopup()}},{key:"getCurrentContainerSize",value:function(){var t=this.mapsService.getContainer();return{containerHeight:(t==null?void 0:t.scrollHeight)||0,containerWidth:(t==null?void 0:t.scrollWidth)||0,bounds:this.mapsService.getBounds()}}},{key:"updatePosition",value:function(){if(this.mapsService){var t=this.markerOption,a=t.element,s=t.offsets,l=this.lngLat,f=l.lng,d=l.lat,S=this.mapsService.lngLatToContainer([f,d]);if(a){a.style.display="block",a.style.whiteSpace="nowrap";var O=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize(),Z=O.containerHeight,U=O.containerWidth,se=O.bounds;if(!se)return;if(Math.abs(se[0][0])>180||Math.abs(se[1][0])>180){if(S.x>U){var le=this.mapsService.lngLatToContainer([f-360,d]);S.x=le.x}if(S.x<0){var ye=this.mapsService.lngLatToContainer([f+360,d]);S.x=ye.x}}(S.x>U||S.x<0||S.y>Z||S.y<0)&&(a.style.display="none"),a.style.left=S.x+s[0]+"px",a.style.top=S.y-s[1]+"px"}}}},{key:"init",value:function(){var t=this,a=this.markerOption.element,s=this.markerOption,l=s.color,f=s.anchor;if(!a){this.defaultMarker=!0,a=ss("div"),this.markerOption.element=a;var d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height","48px"),d.setAttributeNS(null,"width","48px"),d.setAttributeNS(null,"viewBox","0 0 1024 1024");var S=document.createElementNS("http://www.w3.org/2000/svg","path");S.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),S.setAttributeNS(null,"fill",l),d.appendChild(S),a.appendChild(d)}cs(a,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(O){var Z,U,se=((Z=t.markerOption)===null||Z===void 0?void 0:Z.style)&&((U=t.markerOption)===null||U===void 0?void 0:U.style[O]);a&&(a.style[O]=se)}),a.addEventListener("click",function(O){t.onMapClick(O)}),a.addEventListener("click",this.eventHandle),xs(a,f,"marker")}},{key:"registerMarkerEvent",value:function(t){t.addEventListener("mousemove",this.eventHandle),t.addEventListener("click",this.eventHandle),t.addEventListener("mousedown",this.eventHandle),t.addEventListener("mouseup",this.eventHandle),t.addEventListener("dblclick",this.eventHandle),t.addEventListener("contextmenu",this.eventHandle),t.addEventListener("mouseover",this.eventHandle),t.addEventListener("mouseout",this.eventHandle),t.addEventListener("touchstart",this.eventHandle),t.addEventListener("touchend",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var t=this.getElement();t.removeEventListener("mousemove",this.eventHandle),t.removeEventListener("click",this.eventHandle),t.removeEventListener("mousedown",this.eventHandle),t.removeEventListener("mouseup",this.eventHandle),t.removeEventListener("dblclick",this.eventHandle),t.removeEventListener("contextmenu",this.eventHandle),t.removeEventListener("mouseover",this.eventHandle),t.removeEventListener("mouseout",this.eventHandle),t.removeEventListener("touchstart",this.eventHandle),t.removeEventListener("touchend",this.eventHandle)}},{key:"polyfillEvent",value:function(t){!this.mapsService||this.mapsService.version!=="GAODE2.x"||!vr()&&Lt&&(t.type==="touchstart"&&(this.touchStartTime=Date.now()),t.type==="touchend"&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:t,data:this.markerOption.extData,lngLat:this.lngLat}))}},{key:"addDragHandler",value:function(t){return null}},{key:"onUp",value:function(t){throw new Error("Method not implemented.")}}]),r}(Kc.EventEmitter);function QE(e){var i=JE();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function JE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var mx=function(e){(0,Ft.Z)(r,e);var i=QE(r);function r(n){var t,a;return(0,re.Z)(this,r),a=i.call(this),(0,V.Z)((0,ct.Z)(a),"markers",[]),(0,V.Z)((0,ct.Z)(a),"points",[]),(0,V.Z)((0,ct.Z)(a),"clusterMarkers",[]),a.markerLayerOption=(0,Kn.merge)(a.getDefault(),n),pr(["update"],(0,ct.Z)(a)),a.zoom=((t=a.markerLayerOption.clusterOption)===null||t===void 0?void 0:t.zoom)||-99,a}return(0,he.Z)(r,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(t){return this.scene=t,this.mapsService=t.get(Ir.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}},{key:"setContainerSize",value:function(){if(this.mapsService){var t=this.mapsService.getContainer();this.containerSize={containerWidth:(t==null?void 0:t.scrollWidth)||0,containerHeight:(t==null?void 0:t.scrollHeight)||0,bounds:this.mapsService.getBounds()}}}},{key:"getContainerSize",value:function(){return this.containerSize}},{key:"addMarker",value:function(t){var a=this.markerLayerOption.cluster;if(t.getMarkerLayerContainerSize=this.getContainerSize.bind(this),a&&(this.addPoint(t,this.markers.length),this.mapsService)){var s=this.mapsService.getZoom(),l=this.mapsService.getBounds();this.bbox=ko(l,.5),this.zoom=Math.floor(s),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(t)}},{key:"removeMarker",value:function(t){this.markers.indexOf(t);var a=this.markers.indexOf(t);a>-1&&this.markers.splice(a,1)}},{key:"hide",value:function(){this.markers.map(function(t){t.getElement().style.opacity="0"}),this.clusterMarkers.map(function(t){t.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(t){t.getElement().style.opacity="1"}),this.clusterMarkers.map(function(t){t.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var t=this.markerLayerOption.cluster;return t?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var t=this;this.getMarkers().forEach(function(a){a.addTo(t.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(t){t.remove()}),this.clusterMarkers.forEach(function(t){t.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}},{key:"addPoint",value:function(t,a){var s=t.getLnglat(),l=s.lng,f=s.lat,d={geometry:{type:"Point",coordinates:[l,f]},properties:(0,ue.Z)((0,ue.Z)({},t.getExtData()),{},{marker_id:a})};this.points.push(d),this.clusterIndex&&this.clusterIndex.load(this.points)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var t=this.markerLayerOption.clusterOption,a=t.radius,s=t.minZoom,l=s===void 0?0:s,f=t.maxZoom;this.clusterIndex=new(Dg())({radius:a,minZoom:l,maxZoom:f}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(t,a){var s=this,l=t[0].concat(t[1]),f=this.clusterIndex.getClusters(l,a);this.clusterMarkers.forEach(function(d){d.remove()}),this.clusterMarkers=[],f.forEach(function(d){var S,O=s.markerLayerOption.clusterOption,Z=O.field,U=O.method;if((S=d.properties)!==null&&S!==void 0&&S.cluster_id){var se,le=s.getLeaves((se=d.properties)===null||se===void 0?void 0:se.cluster_id);if(d.properties.clusterData=le,Z&&U){var ye=le==null?void 0:le.map(function(jt){var dr=(0,V.Z)({},Z,jt.properties[Z]);return dr}),Be=Bh(ye,Z),rt=Kh(U,Be),Je="point_"+U;d.properties[Je]=rt.toFixed(2)}}var Ot=s.clusterMarker(d);s.clusterMarkers.push(Ot),Ot.addTo(s.scene)})}},{key:"getLeaves",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return t?this.clusterIndex.getLeaves(t,a,s):null}},{key:"clusterMarker",value:function(t){var a=this.markerLayerOption.clusterOption,s=a,l=s.element,f=l===void 0?this.generateElement.bind(this):l,d=new vx({element:f(t)}).setLnglat({lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1]});return d}},{key:"normalMarker",value:function(t){var a=t.properties.marker_id;return this.markers[a]}},{key:"update",value:function(){if(this.mapsService&&this.markers.length!==0){var t=this.mapsService.getZoom(),a=this.mapsService.getBounds();(!this.bbox||Math.abs(t-this.zoom)>=1||!Io(this.bbox,a))&&(this.bbox=ko(a,.5),this.zoom=Math.floor(t),this.getClusterMarker(this.bbox,this.zoom))}}},{key:"generateElement",value:function(t){var a=ss("div","l7-marker-cluster"),s=ss("div","",a),l=ss("span","",s),f=this.markerLayerOption.clusterOption,d=f.field,S=f.method;t.properties.point_count=t.properties.point_count||1;var O=d&&S?t.properties["point_"+S]||t.properties[d]:t.properties.point_count;return l.textContent=O,a}}]),r}(Kc.EventEmitter),LS=I(4157);function ew(e){var i=gx();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function gx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var l0=function(e){(0,Ft.Z)(r,e);var i=ew(r);function r(n){var t;return(0,re.Z)(this,r),t=i.call(this),r.controlCount++,t.controlOption=(0,ue.Z)((0,ue.Z)({},t.getDefault(n)),n||{}),t}return(0,he.Z)(r,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(t){var a=this.getDefault(t);Object.entries(t).forEach(function(s){var l=(0,Ja.Z)(s,2),f=l[0],d=l[1];d===void 0&&(t[f]=a[f])}),"position"in t&&this.setPosition(t.position),"className"in t&&this.setClassName(t.className),"style"in t&&this.setStyle(t.style),this.controlOption=(0,ue.Z)((0,ue.Z)({},this.controlOption),t)}},{key:"addTo",value:function(t){this.mapsService=t.get(Ir.IMapService),this.renderService=t.get(Ir.IRendererService),this.layerService=t.get(Ir.ILayerService),this.controlService=t.get(Ir.IControlService),this.configService=t.get(Ir.IGlobalConfigService),this.scene=t.get(Ir.ISceneService),this.sceneContainer=t,this.isShow=!0,this.container=this.onAdd(),cs(this.container,"l7-control");var a=this.controlOption,s=a.className,l=a.style;return s&&this.setClassName(s),l&&this.setStyle(l),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;Uu(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return ss("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var t=this.container;Kf(t,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var t=this.container;cs(t,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(t){return{position:jp.TOPRIGHT,name:"".concat(r.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(t){if(this.mapsService&&t&&t.screenX>0&&t.screenY>0){var a=this.mapsService.getContainer();a!==null&&a.focus()}}},{key:"setPosition",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jp.TOPLEFT,a=this.controlService;return a&&a.removeControl(this),this.controlOption.position=t,a&&a.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(t){var a=this.container,s=this.controlOption.className;s&&Kf(a,s),t&&cs(a,t)}},{key:"setStyle",value:function(t){var a=this.container;t?a.setAttribute("style",t):a.removeAttribute("style")}},{key:"insertContainer",value:function(){var t=this.controlOption.position,a=this.container;if(t instanceof Element)t.appendChild(a);else{var s=this.controlService.controlCorners[t];t.indexOf("bottom")!==-1?s.insertBefore(a,s.firstChild):s.appendChild(a)}}},{key:"checkUpdateOption",value:function(t,a){return a.some(function(s){return s in t})}}]),r}(Mp());(0,V.Z)(l0,"controlCount",0);function tw(e){var i=RS();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function RS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Av=function(e){(0,Ft.Z)(r,e);var i=tw(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"isDisable",!1),n}return(0,he.Z)(r,[{key:"setIsDisable",value:function(t){if(this.isDisable=t,t){var a;(a=this.button)===null||a===void 0||a.setAttribute("disabled","true")}else{var s;(s=this.button)===null||s===void 0||s.removeAttribute("disabled")}}},{key:"createButton",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ss("button","l7-button-control ".concat(t))}},{key:"onAdd",value:function(){this.button=this.createButton(),this.isDisable=!1;var t=this.controlOption,a=t.title,s=t.btnText,l=t.btnIcon;return this.setBtnTitle(a),this.setBtnText(s),this.setBtnIcon(l),this.button}},{key:"onRemove",value:function(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}},{key:"setOptions",value:function(t){var a=t.title,s=t.btnText,l=t.btnIcon;this.checkUpdateOption(t,["title"])&&this.setBtnTitle(a),this.checkUpdateOption(t,["btnIcon"])&&this.setBtnIcon(l),this.checkUpdateOption(t,["btnText"])&&this.setBtnText(s),$u((0,ot.Z)(r.prototype),"setOptions",this).call(this,t)}},{key:"setBtnTitle",value:function(t){var a;(a=this.button)===null||a===void 0||a.setAttribute("title",t!=null?t:"")}},{key:"setBtnIcon",value:function(t){if(this.buttonIcon&&Uu(this.buttonIcon),t){var a,s=(a=this.button)===null||a===void 0?void 0:a.firstChild;if(s){var l;(l=this.button)===null||l===void 0||l.insertBefore(t,s)}else{var f;(f=this.button)===null||f===void 0||f.appendChild(t)}this.buttonIcon=t}}},{key:"setBtnText",value:function(t){if(this.button)if(Kf(this.button,"l7-button-control--row"),Kf(this.button,"l7-button-control--column"),t){var a=this.buttonText;if(!a){var s;a=ss("div","l7-button-control__text"),(s=this.button)===null||s===void 0||s.appendChild(a),this.buttonText=a}a.innerText=t,cs(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!t&&this.buttonText&&(Uu(this.buttonText),this.buttonText=void 0)}}]),r}(l0);function Bg(e){var i=rw();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function rw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var yx=function(e){(0,Ft.Z)(r,e);var i=Bg(r);function r(n,t){var a;return(0,re.Z)(this,r),a=i.call(this),(0,V.Z)((0,ct.Z)(a),"isShow",!1),(0,V.Z)((0,ct.Z)(a),"timeout",null),(0,V.Z)((0,ct.Z)(a),"show",function(){return a.isShow||!a.contentDOM.innerHTML||(a.resetPopperPosition(),Kf(a.popperDOM,"l7-popper-hide"),a.isShow=!0,a.option.unique&&r.conflictPopperList.forEach(function(s){s!==(0,ct.Z)(a)&&s.isShow&&s.hide()}),a.emit("show")),(0,ct.Z)(a)}),(0,V.Z)((0,ct.Z)(a),"hide",function(){return a.isShow&&(cs(a.popperDOM,"l7-popper-hide"),a.isShow=!1,a.emit("hide")),(0,ct.Z)(a)}),(0,V.Z)((0,ct.Z)(a),"setHideTimeout",function(){a.timeout||(a.timeout=window.setTimeout(function(){a.isShow&&(a.hide(),a.timeout=null)},300))}),(0,V.Z)((0,ct.Z)(a),"clearHideTimeout",function(){a.timeout&&(window.clearTimeout(a.timeout),a.timeout=null)}),(0,V.Z)((0,ct.Z)(a),"onBtnClick",function(){a.isShow?a.hide():a.show()}),(0,V.Z)((0,ct.Z)(a),"onBtnMouseLeave",function(){a.setHideTimeout()}),(0,V.Z)((0,ct.Z)(a),"onBtnMouseMove",function(){a.clearHideTimeout(),!a.isShow&&a.show()}),a.button=n,a.option=t,a.init(),t.unique&&r.conflictPopperList.push((0,ct.Z)(a)),a}return(0,he.Z)(r,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(t){typeof t=="string"?this.contentDOM.innerHTML=t:t instanceof HTMLElement&&(N(this.contentDOM),this.contentDOM.appendChild(t)),this.content=t}},{key:"init",value:function(){var t=this.option.trigger;this.popperDOM=this.createPopper(),t==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),Uu(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var t={},a=this.option,s=a.container,l=a.offset,f=l===void 0?[0,0]:l,d=a.placement,S=(0,Ja.Z)(f,2),O=S[0],Z=S[1],U=this.button.getBoundingClientRect(),se=s.getBoundingClientRect(),le=p(U,se),ye=le.left,Be=le.right,rt=le.top,Je=le.bottom,Ot=!1,jt=!1;/^(left|right)/.test(d)?(d.includes("left")?t.right="".concat(U.width+Be,"px"):d.includes("right")&&(t.left="".concat(U.width+ye,"px")),d.includes("start")?t.top="".concat(rt,"px"):d.includes("end")?t.bottom="".concat(Je,"px"):(t.top="".concat(rt+U.height/2,"px"),jt=!0,t.transform="translate(".concat(O,"px, calc(").concat(Z,"px - 50%))"))):/^(top|bottom)/.test(d)&&(d.includes("top")?t.bottom="".concat(U.height+Je,"px"):d.includes("bottom")&&(t.top="".concat(U.height+rt,"px")),d.includes("start")?t.left="".concat(ye,"px"):d.includes("end")?t.right="".concat(Be,"px"):(t.left="".concat(ye+U.width/2,"px"),Ot=!0,t.transform="translate(calc(".concat(O,"px - 50%), ").concat(Z,"px)"))),t.transform="translate(calc(".concat(O,"px - ").concat(Ot?"50%":"0%","), calc(").concat(Z,"px - ").concat(jt?"50%":"0%",")");var dr=d.split("-");dr.length&&cs(this.popperDOM,dr.map(function(Lr){return"l7-popper-".concat(Lr)}).join(" ")),gp(this.popperDOM,g(t))}},{key:"createPopper",value:function(){var t=this.option,a=t.container,s=t.className,l=s===void 0?"":s,f=t.content,d=ss("div","l7-popper l7-popper-hide ".concat(l)),S=ss("div","l7-popper-content"),O=ss("div","l7-popper-arrow");return d.appendChild(S),d.appendChild(O),a.appendChild(d),this.popperDOM=d,this.contentDOM=S,f&&this.setContent(f),d}}]),r}(Kc.EventEmitter);(0,V.Z)(yx,"conflictPopperList",[]);function _x(e){var i=nw();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function nw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var iw={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"},qy=function(e){(0,Ft.Z)(r,e);var i=_x(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getPopper",value:function(){return this.popper}},{key:"hide",value:function(){this.popper.hide(),$u((0,ot.Z)(r.prototype),"hide",this).call(this)}},{key:"getDefault",value:function(t){var a,s=$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t),l=(a=t==null?void 0:t.position)!==null&&a!==void 0?a:s.position;return(0,ue.Z)((0,ue.Z)({},$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t)),{},{popperPlacement:l instanceof Element?"bottom":iw[l],popperTrigger:"click"})}},{key:"onAdd",value:function(){var t=$u((0,ot.Z)(r.prototype),"onAdd",this).call(this);return this.initPopper(),t}},{key:"onRemove",value:function(){this.popper.destroy()}},{key:"initPopper",value:function(){var t=this,a=this.controlOption,s=a.popperClassName,l=a.popperPlacement,f=a.popperTrigger,d=this.mapsService.getMapContainer();return this.popper=new yx(this.button,{className:s,placement:l,trigger:f,container:d,unique:!0}),this.popper.on("show",function(){t.emit("popperShow",t)}).on("hide",function(){t.emit("popperHide",t)}),this.popper}},{key:"setOptions",value:function(t){if($u((0,ot.Z)(r.prototype),"setOptions",this).call(this,t),this.checkUpdateOption(t,["popperPlacement","popperTrigger","popperClassName"])){var a=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(a)}}}]),r}(Av);function xx(e){var i=aw();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function aw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Tv;(function(e){e.ActiveOptionClassName="l7-select-control-item-active",e.OptionValueAttrKey="data-option-value",e.OptionIndexAttrKey="data-option-index"})(Tv||(Tv={}));var Qy=function(e){(0,Ft.Z)(r,e);var i=xx(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"selectValue",[]),(0,V.Z)((0,ct.Z)(n),"createNormalOption",function(l){var f=n.selectValue.includes(l.value),d=ss("div","l7-select-control-item ".concat(f?Tv.ActiveOptionClassName:""));n.getIsMultiple()&&d.appendChild(n.createCheckbox(f)),l.icon&&d.appendChild(l.icon);var S=ss("span");return S.innerText=l.text,d.appendChild(S),d}),(0,V.Z)((0,ct.Z)(n),"onItemClick",function(l){if(n.getIsMultiple()){var f=n.selectValue.findIndex(function(d){return d===l.value});f>-1?n.selectValue.splice(f,1):n.selectValue=[].concat((0,oe.Z)(n.selectValue),[l.value])}else n.selectValue=[l.value];n.setSelectValue(n.selectValue)}),n}return(0,he.Z)(r,[{key:"setOptions",value:function(t){$u((0,ot.Z)(r.prototype),"setOptions",this).call(this,t);var a=t.options;a&&this.popper.setContent(this.getPopperContent(a))}},{key:"onAdd",value:function(){var t=$u((0,ot.Z)(r.prototype),"onAdd",this).call(this),a=this.controlOption.defaultValue;return a&&(this.selectValue=this.transSelectValue(a)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),t}},{key:"getSelectValue",value:function(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}},{key:"setSelectValue",value:function(t){var a=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=this.transSelectValue(t);this.optionDOMList.forEach(function(f){var d=f.getAttribute(Tv.OptionValueAttrKey),S=a.getIsMultiple()?f.querySelector("input[type=checkbox]"):void 0;l.includes(d)?(cs(f,Tv.ActiveOptionClassName),S&&b(S,!0)):(Kf(f,Tv.ActiveOptionClassName),S&&b(S,!1))}),this.selectValue=l,s&&this.emit("selectChange",this.getIsMultiple()?l:l[0])}},{key:"getIsMultiple",value:function(){return!1}},{key:"getPopperContent",value:function(t){var a=this,s=this.isImageOptions(),l=ss("div",s?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&cs(l,"l7-select-control--multiple");var f=t.map(function(d,S){var O=s?a.createImageOption(d):a.createNormalOption(d);return O.setAttribute(Tv.OptionValueAttrKey,d.value),O.setAttribute(Tv.OptionIndexAttrKey,window.String(S)),O.addEventListener("click",a.onItemClick.bind(a,d)),O});return l.append.apply(l,(0,oe.Z)(f)),this.optionDOMList=f,l}},{key:"createImageOption",value:function(t){var a=this.selectValue.includes(t.value),s=ss("div","l7-select-control-item ".concat(a?Tv.ActiveOptionClassName:"")),l=ss("img");l.setAttribute("src",t.img),q(l),s.appendChild(l);var f=ss("div","l7-select-control-item-row");this.getIsMultiple()&&s.appendChild(this.createCheckbox(a));var d=ss("span");return d.innerText=t.text,f.appendChild(d),s.appendChild(f),s}},{key:"createCheckbox",value:function(t){var a=ss("input");return a.setAttribute("type","checkbox"),t&&b(a,!0),a}},{key:"isImageOptions",value:function(){return!!this.controlOption.options.find(function(t){return t.img})}},{key:"transSelectValue",value:function(t){return Array.isArray(t)?t:[t]}}]),r}(qy),Gv=function(i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.classList.add("l7-iconfont"),r.setAttribute("aria-hidden","true");var n=document.createElementNS("http://www.w3.org/2000/svg","use");return n.setAttributeNS("http://www.w3.org/1999/xlink","href","#".concat(i)),r.appendChild(n),r};function v(e){var i=x();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function x(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var w=function(e){(0,Ft.Z)(r,e);var i=v(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"onClick",(0,Dt.Z)(Ze().mark(function l(){var f;return Ze().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(f=n.controlOption.onExport,f!=null){S.next=5;break}S.next=10;break;case 5:return S.t0=f,S.next=8,n.getImage();case 8:S.t1=S.sent,(0,S.t0)(S.t1);case 10:case"end":return S.stop()}},l)}))),(0,V.Z)((0,ct.Z)(n),"mergeImage",(0,Dt.Z)(Ze().mark(function l(){var f,d,S,O,Z,U,se,le,ye,Be,rt,Je,Ot,jt,dr=arguments;return Ze().wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:for(S=n.controlOption.imageType,O=(f=(d=n.mapsService.getContainer())===null||d===void 0?void 0:d.getBoundingClientRect())!==null&&f!==void 0?f:{},Z=O.width,U=Z===void 0?0:Z,se=O.height,le=se===void 0?0:se,ye=document.createElement("canvas"),ye.width=U,ye.height=le,Be=ye.getContext("2d"),rt=dr.length,Je=new Array(rt),Ot=0;Ot<rt;Ot++)Je[Ot]=dr[Ot];return jr.next=9,Promise.all(Je.map(function(Jr){return new Promise(function(Pn){var In=new Image;In.onload=function(){Pn(In)},In.src=Jr})}));case 9:return jt=jr.sent,jt.forEach(function(Jr){Be==null||Be.drawImage(Jr,0,0,U,le)}),jr.abrupt("return",ye.toDataURL("image/".concat(S)));case 12:case"end":return jr.stop()}},l)}))),n}return(0,he.Z)(r,[{key:"onAdd",value:function(){var t=$u((0,ot.Z)(r.prototype),"onAdd",this).call(this);return t.addEventListener("click",this.onClick),t}},{key:"getDefault",value:function(t){return(0,ue.Z)((0,ue.Z)({},$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:Gv("l7-icon-export-picture"),imageType:"png"})}},{key:"getImage",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.mapsService.exportMap("png");case 2:return s=d.sent,d.next=5,this.scene.exportPng("png");case 5:return l=d.sent,d.abrupt("return",this.mergeImage(s,l));case 7:case"end":return d.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()}]),r}(Av);function X(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Ee(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function Ee(e,i){if(e){if(typeof e=="string")return je(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return je(e,i)}}function je(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var dt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],Ct=function(){if(typeof document=="undefined")return!1;var e=dt[0],i={},r=X(dt),n;try{for(r.s();!(n=r.n()).done;){var t=n.value,a=t==null?void 0:t[1];if(a in document){var s=X(t.entries()),l;try{for(s.s();!(l=s.n()).done;){var f=(0,Ja.Z)(l.value,2),d=f[0],S=f[1];i[e[d]]=S}}catch(O){s.e(O)}finally{s.f()}return i}}}catch(O){r.e(O)}finally{r.f()}return!1}(),qt={change:Ct.fullscreenchange,error:Ct.fullscreenerror},kr={request:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,r=arguments.length>1?arguments[1]:void 0;return new Promise(function(n,t){var a=function l(){kr.off("change",l),n()};kr.on("change",a);var s=i[Ct.requestFullscreen](r);s instanceof Promise&&s.then(a).catch(t)})},exit:function(){return new Promise(function(i,r){if(!kr.isFullscreen){i();return}var n=function a(){kr.off("change",a),i()};kr.on("change",n);var t=document[Ct.exitFullscreen]();t instanceof Promise&&t.then(n).catch(r)})},toggle:function(i,r){return kr.isFullscreen?kr.exit():kr.request(i,r)},onchange:function(i){kr.on("change",i)},onerror:function(i){kr.on("error",i)},on:function(i,r){var n=qt[i];n&&document.addEventListener(n,r,!1)},off:function(i,r){var n=qt[i];n&&document.removeEventListener(n,r,!1)},raw:Ct};Object.defineProperties(kr,{isFullscreen:{get:function(){return Boolean(document[Ct.fullscreenElement])}},element:{enumerable:!0,get:function(){var i;return(i=document[Ct.fullscreenElement])!==null&&i!==void 0?i:void 0}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[Ct.fullscreenEnabled])}}}),Ct||(kr={isEnabled:!1});var Cn=kr;function Di(e){var i=Ma();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Ma(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var uo=function(e){(0,Ft.Z)(r,e);var i=Di(r);function r(n){var t;return(0,re.Z)(this,r),t=i.call(this,n),(0,V.Z)((0,ct.Z)(t),"isFullscreen",!1),(0,V.Z)((0,ct.Z)(t),"toggleFullscreen",(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!Cn.isEnabled){l.next=3;break}return l.next=3,Cn.toggle(t.mapContainer);case 3:case"end":return l.stop()}},a)}))),(0,V.Z)((0,ct.Z)(t),"onClick",function(){t.toggleFullscreen()}),(0,V.Z)((0,ct.Z)(t),"onFullscreenChange",function(){t.isFullscreen=!!document.fullscreenElement;var a=t.controlOption,s=a.btnText,l=a.btnIcon,f=a.title,d=a.exitBtnText,S=a.exitBtnIcon,O=a.exitTitle;t.isFullscreen?(t.setBtnTitle(O),t.setBtnText(d),t.setBtnIcon(S)):(t.setBtnTitle(f),t.setBtnText(s),t.setBtnIcon(l)),t.emit("fullscreenChange",t.isFullscreen)}),Cn.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316"),t}return(0,he.Z)(r,[{key:"setOptions",value:function(t){var a=t.exitBtnText,s=t.exitBtnIcon,l=t.exitTitle;this.isFullscreen&&(this.checkUpdateOption(t,["exitBtnIcon"])&&this.setBtnIcon(s),this.checkUpdateOption(t,["exitBtnText"])&&this.setBtnText(a),this.checkUpdateOption(t,["exitTitle"])&&this.setBtnTitle(l)),$u((0,ot.Z)(r.prototype),"setOptions",this).call(this,t)}},{key:"onAdd",value:function(){var t=$u((0,ot.Z)(r.prototype),"onAdd",this).call(this);return t.addEventListener("click",this.onClick),this.mapContainer=Wc(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),t}},{key:"onRemove",value:function(){$u((0,ot.Z)(r.prototype),"onRemove",this).call(this),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}},{key:"getDefault",value:function(t){return(0,ue.Z)((0,ue.Z)({},$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t)),{},{title:"\u5168\u5C4F",btnIcon:Gv("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:Gv("l7-icon-exit-fullscreen")})}}]),r}(Av);function Ka(e){var i=Oa();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Oa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fo=function(e){(0,Ft.Z)(r,e);var i=Ka(r);function r(n){var t;return(0,re.Z)(this,r),t=i.call(this,n),(0,V.Z)((0,ct.Z)(t),"getGeoLocation",function(){return new Promise(function(a,s){window.navigator.geolocation.getCurrentPosition(function(l){var f=l.coords,d=f!=null?f:{},S=d.longitude,O=d.latitude;!(0,Kn.isNaN)(S)&&!(0,Kn.isNaN)(O)?a([S,O]):s()},function(l){s(l)})})}),(0,V.Z)((0,ct.Z)(t),"onClick",(0,Dt.Z)(Ze().mark(function a(){var s,l,f;return Ze().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(window.navigator.geolocation){S.next=2;break}return S.abrupt("return");case 2:return s=t.controlOption.transform,S.next=5,t.getGeoLocation();case 5:if(l=S.sent,f=t.mapsService.getZoom(),S.t0=t.mapsService,S.t1=f>15?f:15,!s){S.next=15;break}return S.next=12,s(l);case 12:S.t2=S.sent,S.next=16;break;case 15:S.t2=l;case 16:S.t3=S.t2,S.t0.setZoomAndCenter.call(S.t0,S.t1,S.t3);case 18:case"end":return S.stop()}},a)}))),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D"),t}return(0,he.Z)(r,[{key:"getDefault",value:function(t){return(0,ue.Z)((0,ue.Z)({},$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t)),{},{title:"\u5B9A\u4F4D",btnIcon:Gv("l7-icon-reposition")})}},{key:"onAdd",value:function(){var t=$u((0,ot.Z)(r.prototype),"onAdd",this).call(this);return t.addEventListener("click",this.onClick),t}}]),r}(Av);function Ao(e){var i=mo();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function mo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Os=function(e){(0,Ft.Z)(r,e);var i=Ao(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"onLayerChange",function(){var l;(l=n.controlOption.layers)!==null&&l!==void 0&&l.length||(n.selectValue=n.getLayerVisible(),n.setOptions({options:n.getLayerOptions()}))}),(0,V.Z)((0,ct.Z)(n),"onLayerVisibleChane",function(){n.setSelectValue(n.getLayerVisible())}),(0,V.Z)((0,ct.Z)(n),"onSelectChange",function(){n.layers.forEach(function(l){var f=n.selectValue.includes(l.name),d=l.isVisible();f&&!d&&l.show(),!f&&d&&l.hide()})}),n}return(0,he.Z)(r,[{key:"layers",get:function(){var t=this.layerService,a=this.controlOption.layers;if(Array.isArray(a)&&a.length){var s=[];return a.forEach(function(l){if(l instanceof Object&&s.push(l),typeof l=="string"){var f=t.getLayer(l)||t.getLayerByName(l);f&&s.push(f)}}),s}return t.getLayers()||[]}},{key:"getDefault",value:function(t){return(0,ue.Z)((0,ue.Z)({},$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:Gv("l7-icon-layer"),options:[]})}},{key:"getLayerVisible",value:function(){return this.layers.filter(function(t){return t.isVisible()}).map(function(t){return t.name})}},{key:"getLayerOptions",value:function(){return this.layers.map(function(t){return{text:t.name,value:t.name}})}},{key:"setOptions",value:function(t){var a=this.checkUpdateOption(t,["layers"]);$u((0,ot.Z)(r.prototype),"setOptions",this).call(this,t),a&&(this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}},{key:"onAdd",value:function(){var t;return(t=this.controlOption.options)!==null&&t!==void 0&&t.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),$u((0,ot.Z)(r.prototype),"onAdd",this).call(this)}},{key:"onRemove",value:function(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}},{key:"getIsMultiple",value:function(){return!0}}]),r}(Qy);function au(e){var i=Su();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Su(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var wl=function(e){(0,Ft.Z)(r,e);var i=au(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getDefault",value:function(){return{position:jp.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var t=ss("div","l7-control-logo");return this.setLogoContent(t),t}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(t){$u((0,ot.Z)(r.prototype),"setOptions",this).call(this,t),this.checkUpdateOption(t,["img","href"])&&(N(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(t){var a=this.controlOption,s=a.href,l=a.img,f=ss("img");if(f.setAttribute("src",l),f.setAttribute("aria-label","AntV logo"),q(f),s){var d=ss("a","l7-control-logo-link");d.target="_blank",d.href=s,d.rel="noopener nofollow",d.setAttribute("rel","noopener nofollow"),d.appendChild(f),t.appendChild(d)}else t.appendChild(f)}}]),r}(l0),Us={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},du={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};function Is(e){var i=Gs();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Gs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var fl=function(e){(0,Ft.Z)(r,e);var i=Is(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"onMapThemeChange",function(){n.mapsService.setMapStyle(n.selectValue[0])}),n}return(0,he.Z)(r,[{key:"getDefault",value:function(t){return(0,ue.Z)((0,ue.Z)({},$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:Gv("l7-icon-color"),options:[]})}},{key:"getStyleOptions",value:function(){var t=this.mapsService.getType()==="mapbox"?du:Us;return Object.entries(this.mapsService.getMapStyleConfig()).filter(function(a){var s=(0,Ja.Z)(a,2),l=s[0],f=s[1];return typeof f=="string"&&l!=="blank"}).map(function(a){var s,l=(0,Ja.Z)(a,2),f=l[0],d=l[1],S=(s=t[f])!==null&&s!==void 0?s:{},O=S.text,Z=S.img;return{text:O!=null?O:f,value:d,img:Z,key:f}})}},{key:"getMapStyle",value:function(){return this.mapsService.getMapStyle()}},{key:"onAdd",value:function(){var t,a=this;if((t=this.controlOption.options)!==null&&t!==void 0&&t.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var s,l,f=this.controlOption.defaultValue;this.controlOption.defaultValue=(s=(l=this.controlOption.options.find(function(S){return S.key===f}))===null||l===void 0?void 0:l.value)!==null&&s!==void 0?s:f}else{var d=this.getMapStyle();d?this.controlOption.defaultValue=d:this.mapsService.map.once("styledata",function(){var S=a.mapsService.getMapStyle();a.controlOption.defaultValue=S,a.setSelectValue(S,!1)})}return this.on("selectChange",this.onMapThemeChange),$u((0,ot.Z)(r.prototype),"onAdd",this).call(this)}},{key:"getIsMultiple",value:function(){return!1}}]),r}(Qy);function ni(e){var i=En();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function En(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Zn=function(e){(0,Ft.Z)(r,e);var i=ni(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"location",[0,0]),(0,V.Z)((0,ct.Z)(n),"onMouseMove",function(l){var f=n.location,d=l.lngLat||l.lnglat,S=n.controlOption.transform;d&&(f=[d.lng,d.lat]),n.location=f,S&&(f=S(f)),n.insertLocation2HTML(f),n.emit("locationChange",f)}),n}return(0,he.Z)(r,[{key:"getLocation",value:function(){return this.location}},{key:"getDefault",value:function(t){return(0,ue.Z)((0,ue.Z)({},$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t)),{},{position:jp.BOTTOMLEFT,transform:function(s){var l=(0,Ja.Z)(s,2),f=l[0],d=l[1];return[+(+f).toFixed(6),+(+d).toFixed(6)]}})}},{key:"onAdd",value:function(){var t=ss("div","l7-control-mouse-location");return t.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),t}},{key:"onRemove",value:function(){this.mapsService.off("mousemove",this.onMouseMove)}},{key:"insertLocation2HTML",value:function(t){this.container.innerText=t.join(", ")}}]),r}(l0);function la(e){var i=ja();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function ja(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Fa=function(e){(0,Ft.Z)(r,e);var i=la(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"update",function(){var l=n.mapsService,f=n.controlOption.maxWidth,d=l.getSize()[1]/2,S=l.containerToLngLat([0,d]),O=l.containerToLngLat([f,d]),Z=po([S.lng,S.lat],[O.lng,O.lat]);n.updateScales(Z)}),n}return(0,he.Z)(r,[{key:"getDefault",value:function(t){return(0,ue.Z)((0,ue.Z)({},$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t)),{},{name:"scale",position:jp.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}},{key:"onAdd",value:function(){var t="l7-control-scale",a=ss("div",t);this.resetScaleLines(a);var s=this.controlOption.updateWhenIdle;return this.mapsService.on(s?"moveend":"mapmove",this.update),this.mapsService.on(s?"zoomend":"zoomchange",this.update),a}},{key:"onRemove",value:function(){var t=this.controlOption.updateWhenIdle;this.mapsService.off(t?"zoomend":"zoomchange",this.update),this.mapsService.off(t?"moveend":"mapmove",this.update)}},{key:"setOptions",value:function(t){$u((0,ot.Z)(r.prototype),"setOptions",this).call(this,t),this.checkUpdateOption(t,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}},{key:"updateScales",value:function(t){var a=this.controlOption,s=a.metric,l=a.imperial;s&&t&&this.updateMetric(t),l&&t&&this.updateImperial(t)}},{key:"resetScaleLines",value:function(t){N(t);var a=this.controlOption,s=a.metric,l=a.imperial,f=a.maxWidth,d=a.lockWidth;d&&gp(t,"width: ".concat(f,"px")),s&&(this.mScale=ss("div","l7-control-scale-line",t)),l&&(this.iScale=ss("div","l7-control-scale-line",t)),this.update()}},{key:"updateScale",value:function(t,a,s){var l=this.controlOption.maxWidth;t.style.width=Math.round(l*s)+"px",t.innerHTML=a}},{key:"getRoundNum",value:function(t){var a=Math.pow(10,(Math.floor(t)+"").length-1),s=t/a;return s=s>=10?10:s>=5?5:s>=3?3:s>=2?2:1,a*s}},{key:"updateMetric",value:function(t){var a=this.getRoundNum(t),s=a<1e3?a+" m":a/1e3+" km";this.updateScale(this.mScale,s,a/t)}},{key:"updateImperial",value:function(t){var a=t*3.2808399,s,l,f;a>5280?(s=a/5280,l=this.getRoundNum(s),this.updateScale(this.iScale,l+" mi",l/s)):(f=this.getRoundNum(a),this.updateScale(this.iScale,f+" ft",f/a))}}]),r}(l0);function ru(e){var i=dl();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function dl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ll=function(e){(0,Ft.Z)(r,e);var i=ru(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"zoomIn",function(){!n.disabled&&n.mapsService.getZoom()<n.mapsService.getMaxZoom()&&n.mapsService.zoomIn()}),(0,V.Z)((0,ct.Z)(n),"zoomOut",function(){!n.disabled&&n.mapsService.getZoom()>n.mapsService.getMinZoom()&&n.mapsService.zoomOut()}),(0,V.Z)((0,ct.Z)(n),"updateDisabled",function(){var l=n.mapsService;n.zoomInButton.removeAttribute("disabled"),n.zoomOutButton.removeAttribute("disabled"),(n.disabled||l.getZoom()<=l.getMinZoom())&&n.zoomOutButton.setAttribute("disabled","true"),(n.disabled||l.getZoom()>=l.getMaxZoom())&&n.zoomInButton.setAttribute("disabled","true")}),n}return(0,he.Z)(r,[{key:"getDefault",value:function(t){return(0,ue.Z)((0,ue.Z)({},$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t)),{},{position:jp.BOTTOMRIGHT,name:"zoom",zoomInText:Gv("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:Gv("l7-icon-narrow"),zoomOutTitle:"Zoom out"})}},{key:"setOptions",value:function(t){$u((0,ot.Z)(r.prototype),"setOptions",this).call(this,t),this.checkUpdateOption(t,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle"])&&this.resetButtonGroup(this.container)}},{key:"onAdd",value:function(){var t=ss("div","l7-control-zoom");return this.resetButtonGroup(t),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),t}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"resetButtonGroup",value:function(t){N(t),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",t,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",t,this.zoomOut),this.updateDisabled()}},{key:"createButton",value:function(t,a,s,l,f){var d=ss("button",s,l);return typeof t=="string"?d.innerHTML=t:d.append(t),d.title=a,d.addEventListener("click",f),d}}]),r}(l0);function Rh(e){var i=ff();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function ff(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kh=function(e){(0,Ft.Z)(r,e);var i=Rh(r);function r(n){var t;(0,re.Z)(this,r),t=i.call(this),(0,V.Z)((0,ct.Z)(t),"isShow",!0),(0,V.Z)((0,ct.Z)(t),"onMouseMove",function(s){var l,f=t.mapsService.getMapContainer(),d=(l=f==null?void 0:f.getBoundingClientRect())!==null&&l!==void 0?l:{},S=d.left,O=S===void 0?0:S,Z=d.top,U=Z===void 0?0:Z;t.setPopupPosition(s.clientX-O,s.clientY-U)}),(0,V.Z)((0,ct.Z)(t),"updateLngLatPosition",function(){if(!(!t.mapsService||t.popupOption.followCursor)){var s=t.lngLat,l=s.lng,f=s.lat,d=t.mapsService.lngLatToContainer([l,f]),S=d.x,O=d.y;t.setPopupPosition(S,O)}}),(0,V.Z)((0,ct.Z)(t),"onKeyDown",function(s){s.keyCode===27&&t.remove()}),(0,V.Z)((0,ct.Z)(t),"onCloseButtonClick",function(s){s.stopPropagation&&s.stopPropagation(),t.hide()}),(0,V.Z)((0,ct.Z)(t),"update",function(){var s=!!t.lngLat,l=t.popupOption,f=l.className,d=l.style,S=l.maxWidth,O=l.anchor,Z=l.stopPropagation;if(!(!t.mapsService||!s||!t.content)){var U=t.mapsService.getMarkerContainer();if(!t.container&&U&&(t.container=ss("div","l7-popup ".concat(f!=null?f:""," ").concat(t.isShow?"":"l7-popup-hide"),U),d&&t.container.setAttribute("style",d),t.tip=ss("div","l7-popup-tip",t.container),t.container.appendChild(t.content),Z&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(ye){t.container.addEventListener(ye,function(Be){Be.stopPropagation()})}),t.container.style.whiteSpace="nowrap"),t.updateLngLatPosition(),Af(t.container,"".concat(Ku[O])),xs(t.container,O,"popup"),S){var se=t.container.getBoundingClientRect(),le=se.width;le>parseFloat(S)&&(t.container.style.width=S)}else t.container.style.removeProperty("width")}}),t.popupOption=(0,ue.Z)((0,ue.Z)({},t.getDefault(n!=null?n:{})),n);var a=t.popupOption.lngLat;return a&&(t.lngLat=a),t}return(0,he.Z)(r,[{key:"lngLat",get:function(){var t;return(t=this.popupOption.lngLat)!==null&&t!==void 0?t:{lng:0,lat:0}},set:function(t){this.popupOption.lngLat=t}},{key:"getIsShow",value:function(){return this.isShow}},{key:"addTo",value:function(t){this.mapsService=t.get(Ir.IMapService),this.sceneService=t.get(Ir.ISceneService),this.layerService=t.get(Ir.ILayerService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=t,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();var a=this.popupOption,s=a.html,l=a.text,f=a.title;return s?this.setHTML(s):l&&this.setText(l),f&&this.setTitle(f),this.emit("open"),this}},{key:"remove",value:function(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&Uu(this.content),this.container&&(Uu(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}},{key:"getOptions",value:function(){return this.popupOption}},{key:"setOptions",value:function(t){return this.show(),this.popupOption=(0,ue.Z)((0,ue.Z)({},this.popupOption),t),this.checkUpdateOption(t,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","className","style","lngLat","offsets"])&&(this.container&&(Uu(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(t,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(t,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(t,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(t,["html"])&&t.html?this.setHTML(t.html):this.checkUpdateOption(t,["text"])&&t.text&&this.setText(t.text),this.checkUpdateOption(t,["lngLat"])&&t.lngLat&&this.setLnglat(t.lngLat),this}},{key:"open",value:function(){return this.addTo(this.scene),this}},{key:"close",value:function(){return this.remove(),this}},{key:"show",value:function(){if(!this.isShow)return this.container&&Kf(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}},{key:"hide",value:function(){if(this.isShow)return this.container&&cs(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}},{key:"setHTML",value:function(t){return this.popupOption.html=t,this.setDOMContent(t)}},{key:"setText",value:function(t){return this.popupOption.text=t,this.setDOMContent(window.document.createTextNode(t))}},{key:"setTitle",value:function(t){this.show(),this.popupOption.title=t,t?(this.contentTitle||(this.contentTitle=ss("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),N(this.contentTitle),ee(this.contentTitle,t)):this.contentTitle&&(Uu(this.contentTitle),this.contentTitle=void 0)}},{key:"panToPopup",value:function(){var t=this.lngLat,a=t.lng,s=t.lat;return this.popupOption.autoPan&&this.mapsService.panTo([a,s]),this}},{key:"setLngLat",value:function(t){return this.setLnglat(t)}},{key:"setLnglat",value:function(t){var a=this;return this.show(),this.lngLat=t,Array.isArray(t)&&(this.lngLat={lng:t[0],lat:t[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(function(){a.panToPopup()},0),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setMaxWidth",value:function(t){return this.popupOption.maxWidth=t,this.update(),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"getDefault",value:function(t){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:lc.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}},{key:"setDOMContent",value:function(t){return this.show(),this.createContent(),ee(this.contentPanel,t),this.update(),this}},{key:"updateCloseOnClick",value:function(t){var a=this,s=this.mapsService;s&&(s==null||s.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!t&&requestAnimationFrame(function(){s==null||s.on("click",a.onCloseButtonClick)}))}},{key:"updateCloseOnEsc",value:function(t){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!t&&window.addEventListener("keydown",this.onKeyDown)}},{key:"updateFollowCursor",value:function(t){var a,s=(a=this.mapsService)===null||a===void 0?void 0:a.getContainer();s&&(s==null||s.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!t&&(s==null||s.addEventListener("mousemove",this.onMouseMove)))}},{key:"createContent",value:function(){var t=this;if(this.content&&Uu(this.content),this.contentTitle=void 0,this.content=ss("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){var a=Gv("l7-icon-guanbi");cs(a,"l7-popup-close-button"),this.content.appendChild(a),this.popupOption.closeButtonOffsets&&(a.style.right=this.popupOption.closeButtonOffsets[0]+"px",a.style.top=this.popupOption.closeButtonOffsets[1]+"px"),a.setAttribute("aria-label","Close popup"),a.addEventListener("click",function(){t.hide()}),this.closeButton=a}else this.closeButton=void 0;this.contentPanel=ss("div","l7-popup-content__panel",this.content)}},{key:"setPopupPosition",value:function(t,a){if(this.container){var s=this.popupOption.offsets;this.container.style.left=t+s[0]+"px",this.container.style.top=a-s[1]+"px"}}},{key:"checkUpdateOption",value:function(t,a){return a.some(function(s){return s in t})}}]),r}(Kc.EventEmitter);function LM(e){var i=RM();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function RM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kM=function(e){(0,Ft.Z)(r,e);var i=LM(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"layerConfigMap",new WeakMap),n}return(0,he.Z)(r,[{key:"layerConfigItems",get:function(){var t,a=this.popupOption,s=a.config,l=a.items;return(t=s!=null?s:l)!==null&&t!==void 0?t:[]}},{key:"addTo",value:function(t){return $u((0,ot.Z)(r.prototype),"addTo",this).call(this,t),this.bindLayerEvent(),this.hide(),this}},{key:"remove",value:function(){return $u((0,ot.Z)(r.prototype),"remove",this).call(this),this.unbindLayerEvent(),this}},{key:"setOptions",value:function(t){return this.unbindLayerEvent(),$u((0,ot.Z)(r.prototype),"setOptions",this).call(this,t),this.bindLayerEvent(),this}},{key:"getDefault",value:function(t){var a=t.trigger==="click";return(0,ue.Z)((0,ue.Z)({},$u((0,ot.Z)(r.prototype),"getDefault",this).call(this,t)),{},{trigger:"hover",followCursor:!a,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!1,autoClose:!1,closeOnEsc:!1})}},{key:"bindLayerEvent",value:function(){var t=this,a=this.popupOption.trigger;this.layerConfigItems.forEach(function(s){var l,f=t.getLayerByConfig(s);if(f){var d=(0,ue.Z)({},s);if(a==="hover"){var S=t.onLayerMouseMove.bind(t,f),O=t.onLayerMouseOut.bind(t,f);d.onMouseMove=S,d.onMouseOut=O,f==null||f.on("mousemove",S),f==null||f.on("mouseout",O)}else{var Z=t.onLayerClick.bind(t,f);d.onClick=Z,f==null||f.on("click",Z)}var U=f==null||(l=f.getSource)===null||l===void 0?void 0:l.call(f),se=t.onSourceUpdate.bind(t,f);U==null||U.on("update",se),d.onSourceUpdate=se,t.layerConfigMap.set(f,d)}})}},{key:"unbindLayerEvent",value:function(){var t=this;this.layerConfigItems.forEach(function(a){var s=t.getLayerByConfig(a),l=s&&t.layerConfigMap.get(s);if(l){var f=l.onMouseMove,d=l.onMouseOut,S=l.onClick,O=l.onSourceUpdate;if(f&&s.off("mousemove",f),d&&s.off("mouseout",d),S&&s.off("click",S),O){var Z;s==null||(Z=s.getSource())===null||Z===void 0||Z.off("update",O)}}})}},{key:"onLayerMouseMove",value:function(t,a){if(!this.isSameFeature(t,a.featureId)){var s=this.getLayerInfoFrag(t,a),l=s.title,f=s.content;this.setDOMContent(f),this.setTitle(l),this.displayFeatureInfo={layer:t,featureId:a.featureId},this.show()}}},{key:"onLayerMouseOut",value:function(t,a){this.displayFeatureInfo=void 0,this.isShow&&this.hide()}},{key:"onLayerClick",value:function(t,a){if(this.isShow&&this.isSameFeature(t,a.featureId))this.hide();else{var s=this.getLayerInfoFrag(t,a),l=s.title,f=s.content;this.setDOMContent(f),this.setLnglat(a.lngLat),this.setTitle(l),this.displayFeatureInfo={layer:t,featureId:a.featureId},this.show()}}},{key:"onSourceUpdate",value:function(t){var a;((a=this.displayFeatureInfo)===null||a===void 0?void 0:a.layer)===t&&(this.hide(),this.displayFeatureInfo=void 0)}},{key:"getLayerInfoFrag",value:function(t,a){var s=this.layerConfigMap.get(t),l,f=document.createDocumentFragment();if(s){var d=a.feature;d.type==="Feature"&&"properties"in d&&"geometry"in d&&(d=d.properties);var S=s.title,O=s.fields,Z=s.customContent;if(S){l=document.createDocumentFragment();var U=S instanceof Function?S(d):S;ee(l,U)}if(Z){var se=Z instanceof Function?Z(d):Z;ee(f,se)}else O!=null&&O.length&&(O==null||O.forEach(function(le){var ye,Be,rt=typeof le=="string"?{field:le}:le,Je=rt.field,Ot=rt.formatField,jt=rt.formatValue,dr=rt.getValue,Lr=ss("div","l7-layer-popup__row"),jr=dr?dr(a.feature):(0,Kn.get)(d,Je),Jr=(ye=Ot instanceof Function?Ot(Je,d):Ot)!==null&&ye!==void 0?ye:Je,Pn=(Be=jt instanceof Function?jt(jr,d):jt)!==null&&Be!==void 0?Be:jr,In=ss("span","l7-layer-popup__key",Lr);ee(In,Jr),ee(In,document.createTextNode("\uFF1A"));var Si=ss("span","l7-layer-popup__value",Lr);ee(Si,Pn),f.appendChild(Lr)}))}return{title:l,content:f}}},{key:"getLayerByConfig",value:function(t){var a=t.layer;if(a instanceof Object)return a;if(typeof a=="string")return this.layerService.getLayer(a)||this.layerService.getLayerByName(a)}},{key:"isSameFeature",value:function(t,a){var s=this.displayFeatureInfo;return s&&t===s.layer&&a===s.featureId}}]),r}(kh);function DM(e,i){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||n)&&(i||(i=document),!!i)){var t=i.head||i.getElementsByTagName("head")[0];if(!t){t=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(t,a):i.documentElement.appendChild(t)}var s=i.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(i.createTextNode(e)),t.appendChild(s),s}}DM(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 800;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  height: 24px;
  line-height: 24px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 16px;
  font-size: 12px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  height: 14px;
  width: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  padding: 12px 12px 0 12px;
  width: 474px;
  height: 320px;
  overflow: auto;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-select-control--image .l7-select-control-item {
  margin-right: 12px;
  border-radius: 2px;
  overflow: hidden;
  border: 1px solid #fff;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  width: calc((100% - 36px) / 3);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  margin-bottom: 12px;
  position: relative;
  font-size: 12px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 142px;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  right: 0;
  top: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control--image .l7-select-control-item:nth-child(3n) {
  margin-right: 0;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  overflow: hidden;
}
.l7-control-zoom .l7-button-control {
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
  border-radius: 0;
  font-size: 16px;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:first-child {
  border-bottom: 1px solid #f0f0f0;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
`);var Z0,ow=(Z0={},(0,V.Z)(Z0,Rd.additive,{enable:!0,func:{srcRGB:Ve.ONE,dstRGB:Ve.ONE,srcAlpha:1,dstAlpha:1}}),(0,V.Z)(Z0,Rd.none,{enable:!1}),(0,V.Z)(Z0,Rd.normal,{enable:!0,func:{srcRGB:Ve.SRC_ALPHA,dstRGB:Ve.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,V.Z)(Z0,Rd.subtractive,{enable:!0,func:{srcRGB:Ve.ONE,dstRGB:Ve.ONE,srcAlpha:Ve.ZERO,dstAlpha:Ve.ONE_MINUS_SRC_COLOR},equation:{rgb:Ve.FUNC_SUBTRACT,alpha:Ve.FUNC_SUBTRACT}}),(0,V.Z)(Z0,Rd.max,{enable:!0,func:{srcRGB:Ve.ONE,dstRGB:Ve.ONE},equation:{rgb:Ve.MAX_EXT}}),(0,V.Z)(Z0,Rd.min,{enable:!0,func:{srcRGB:Ve.ONE,dstRGB:Ve.ONE},equation:{rgb:Ve.MIN_EXT}}),Z0);function Gd(e,i,r,n,t){i.updateStyleAttribute(e,r,n,t)}function FM(e,i){i.tileLayer||i.isTileLayer||(e.opacity&&bx("opacity",i,e.opacity),e.strokeWidth&&bx("strokeWidth",i,e.strokeWidth),e.strokeOpacity&&bx("strokeOpacity",i,e.strokeOpacity),e.stroke&&BM("stroke",i,e.stroke),e.offsets&&kS("offsets",i,e.offsets),e.textOffset&&kS("textOffset",i,e.textOffset),e.thetaOffset&&bx("thetaOffset",i,e.thetaOffset))}function bx(e,i,r){(0,Kn.isString)(r)?Gd(e,i,r,function(n){return n}):(0,Kn.isNumber)(r)||(Array.isArray(r)&&r.length===2?(0,Kn.isString)(r[0])&&(0,Kn.isFunction)(r[1])||(0,Kn.isString)(r[0])&&Array.isArray(r[1])&&(0,Kn.isNumber)(r[1][0])&&(0,Kn.isNumber)(r[1][1])?Gd(e,i,r[0],r[1]):Gd(e,i,[1],void 0):Gd(e,i,[1],void 0))}function kS(e,i,r){(0,Kn.isString)(r)?Gd(e,i,r,function(n){return n}):Array.isArray(r)&&r.length===2&&(0,Kn.isString)(r[0])&&(0,Kn.isFunction)(r[1])?Gd(e,i,r[0],r[1]):Array.isArray(r)&&r.length===2&&(0,Kn.isNumber)(r[0])&&(0,Kn.isNumber)(r[1])?Gd(e,i,r,void 0):Gd(e,i,[0,0],void 0)}function BM(e,i,r){(0,Kn.isString)(r)||(Array.isArray(r)&&r.length===2&&((0,Kn.isString)(r[0])&&(0,Kn.isFunction)(r[1])||(0,Kn.isString)(r[0])&&Array.isArray(r[1])&&r[1].length>0)?Gd(e,i,r[0],r[1]):Gd(e,i,"#fff",void 0))}var ah;(function(e){e["GAODE1.x"]="GAODE1.x",e["GAODE2.x"]="GAODE2.x",e.MAPBOX="MAPBOX",e.DEFUALT="DEFUALTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL"})(ah||(ah={}));function NM(e,i){var r=[i[0]-e[0],i[1]-e[1]],n=Ou(r),t=[e[0]+n[0]*1e-4,e[1]+n[1]*1e-4];return t}function zM(e,i,r){if(e.length>0&&i.version===ah["GAODE2.x"]){var n=r.coordCenter;typeof e[0].coordinates[0]=="number"?e.filter(function(t){return!t.originCoordinates}).map(function(t){t.version=ah["GAODE2.x"],t.originCoordinates=(0,Kn.cloneDeep)(t.coordinates),t.coordinates=i.lngLatToCoordByLayer(t.coordinates,n)}):e.filter(function(t){return!t.originCoordinates}).map(function(t){t.version=ah["GAODE2.x"],t.originCoordinates=(0,Kn.cloneDeep)(t.coordinates),t.coordinates=i.lngLatToCoordsByLayer(t.coordinates,n)})}}function ZM(e,i){e.length>0&&i.version===ah.SIMPLE&&e.map(function(r){r.simpleCoordinate||(r.coordinates=UM(r.coordinates,i),r.simpleCoordinate=!0)})}function UM(e,i){if(typeof e[0]=="number")return i.simpleMapCoord.unproject(e);if(e[0]&&e[0][0]instanceof Array){var r=[];return e.map(function(t){var a=[];t.map(function(s){a.push(i.simpleMapCoord.unproject(s))}),r.push(a)}),r}else{var n=[];return e.map(function(t){n.push(i.simpleMapCoord.unproject(t))}),n}}function jM(e,i){var r;if(!e.scale)return[];var n=(e==null||(r=e.scale)===null||r===void 0?void 0:r.scalers)||[],t=[];n.forEach(function(s){var l,f=s.field;(i.hasOwnProperty(f)||((l=e.scale)===null||l===void 0?void 0:l.type)==="variable")&&t.push(i[f])});var a=e.mapping?e.mapping(t):[];return a}function VM(e,i,r,n,t){var a=t==null?void 0:t.getLayerConfig(),s=a.arrow,l=s===void 0?{enable:!1}:s,f=i.map(function(d){var S={id:d._id,coordinates:d.coordinates};if(e.filter(function(U){return U.scale!==void 0}).forEach(function(U){var se=jM(U,d);U.needRemapping=!1,U.name==="color"&&(se=se.map(function(le){return Qi(le)})),S[U.name]=Array.isArray(se)&&se.length===1?se[0]:se,U.name==="shape"&&(S.shape=r.getIconFontKey(S[U.name]))}),S.shape==="line"&&l.enable){var O=S.coordinates,Z=NM(O[0],O[1]);S.coordinates.splice(1,0,Z,Z)}return S});return zM(f,n,t),ZM(f,n),f}function HM(e,i,r,n,t,a){var s=new Hv(t,a),l=n.getLayerStyleAttributes()||[],f=s.data.dataArray,d=f,S=VM(l,d,i,r,e);return s.destroy(),S}function DS(e){return e.map(function(i){return typeof i=="string"&&(i=[i,{}]),i})}function FS(e,i,r,n){var t=e.multiPassRenderer,a=e.getLayerConfig(),s=a.enableTAA;return s?t.add(n("taa")):t.add(n("render")),DS(i).forEach(function(l){var f=(0,Ja.Z)(l,2),d=f[0],S=f[1];t.add(r(d),S)}),t.add(r("copy")),t}var GM=function(){function e(i){(0,re.Z)(this,e),this.layer=i}return(0,he.Z)(e,[{key:"pickRender",value:function(r){var n=this.layer;if(n.tileLayer)return n.tileLayer.pickRender(r);n.hooks.beforePickingEncode.call(),n.masks.length>0&&n.masks.filter(function(t){return t.inited}).forEach(function(){var t=(0,Dt.Z)(Ze().mark(function a(s){return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:s.render();case 1:case"end":return f.stop()}},a)}));return function(a){return t.apply(this,arguments)}}()),n.renderModels(!0),n.hooks.afterPickingEncode.call()}},{key:"pick",value:function(r,n){var t=this.layer.getContainer(),a=t.get(Ir.IPickingService);return r.type==="RasterLayer"?this.pickRasterLayer(r,n):(this.pickRender(n),a.pickFromPickingFBO(r,n))}},{key:"pickRasterLayer",value:function(r,n,t){var a=this.layer.getContainer(),s=a.get(Ir.IPickingService),l=a.get(Ir.IMapService),f=this.layer.getSource().extent,d=Yn(n.lngLat,f),S={x:n.x,y:n.y,type:n.type,lngLat:n.lngLat,target:n,rasterValue:null},O=t||r;if(d){var Z=this.readRasterValue(r,f,l,n.x,n.y);return S.rasterValue=Z,s.triggerHoverOnLayer(O,S),!0}else return S.type=n.type==="mousemove"?"mouseout":"un"+n.type,s.triggerHoverOnLayer(O,(0,ue.Z)((0,ue.Z)({},S),{},{type:"unpick"})),s.triggerHoverOnLayer(O,S),!1}},{key:"readRasterValue",value:function(r,n,t,a,s){var l=r.getSource().data.dataArray[0],f=(0,Ja.Z)(n,4),d=f[0],S=d===void 0?0:d,O=f[1],Z=O===void 0?0:O,U=f[2],se=U===void 0?10:U,le=f[3],ye=le===void 0?-10:le,Be=t.lngLatToContainer([S,Z]),rt=t.lngLatToContainer([se,ye]),Je=rt.x-Be.x,Ot=Be.y-rt.y,jt=[(a-Be.x)/Je,(s-rt.y)/Ot],dr=l.width||1,Lr=l.height||1,jr=Math.floor(jt[0]*dr),Jr=Math.floor(jt[1]*Lr),Pn=Math.max(0,Jr-1)*dr+jr,In=l.data[Pn];return In}},{key:"selectFeature",value:function(r){var n=this.layer,t=(0,Ja.Z)(r,3),a=t[0],s=t[1],l=t[2];n.hooks.beforeSelect.call([a,s,l])}},{key:"highlightPickedFeature",value:function(r){var n=(0,Ja.Z)(r,3),t=n[0],a=n[1],s=n[2];this.layer.hooks.beforeHighlight.call([t,a,s])}},{key:"getFeatureById",value:function(r){return this.layer.getSource().getFeatureById(r)}}]),e}(),$M=function(){function e(i){(0,re.Z)(this,e),this.layer=i;var r=this.layer.getContainer();this.rendererService=r.get(Ir.IRendererService)}return(0,he.Z)(e,[{key:"getColorTexture",value:function(r,n){var t=this.getTextureKey(r,n);return this.key===t?this.colorTexture:(this.createColorTexture(r,n),this.key=t,this.colorTexture)}},{key:"createColorTexture",value:function(r,n){var t=this.rendererService.createTexture2D,a=this.getColorRampBar(r,n),s=t({data:a.data,width:a.width,height:a.height,flipY:!1});return this.colorTexture=s,s}},{key:"setColorTexture",value:function(r,n,t){this.key=this.getTextureKey(n,t),this.colorTexture=r}},{key:"destroy",value:function(){var r;(r=this.colorTexture)===null||r===void 0||r.destroy()}},{key:"getColorRampBar",value:function(r,n){switch(r.type){case"cat":return Qu(r);case"quantize":return ul(r);case"custom":return uh(r,n);case"linear":return Bc(r,n);default:return Pl(r)}}},{key:"getTextureKey",value:function(r,n){var t;return"".concat(r.colors.join("_"),"_").concat(r==null||(t=r.positions)===null||t===void 0?void 0:t.join("_"),"_").concat(r.type,"_").concat(n==null?void 0:n.join("_"))}}]),e}(),WM=["passes"],XM=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber","workerEnabled","workerOptions"],BS,sw,NS;function YM(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=KM(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function KM(e,i){if(e){if(typeof e=="string")return zS(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zS(e,i)}}function zS(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}function qM(e){var i=QM();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function QM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ZS=0,Dd=(BS=Rg(Ir.IGlobalConfigService),sw=function(e){(0,Ft.Z)(r,e);var i=qM(r);function r(){var n,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,re.Z)(this,r),n=i.call(this),(0,V.Z)((0,ct.Z)(n),"id","".concat(ZS++)),(0,V.Z)((0,ct.Z)(n),"name","".concat(ZS)),(0,V.Z)((0,ct.Z)(n),"visible",!0),(0,V.Z)((0,ct.Z)(n),"zIndex",0),(0,V.Z)((0,ct.Z)(n),"inited",!1),(0,V.Z)((0,ct.Z)(n),"layerModelNeedUpdate",!1),(0,V.Z)((0,ct.Z)(n),"pickedFeatureID",null),(0,V.Z)((0,ct.Z)(n),"selectedFeatureID",null),(0,V.Z)((0,ct.Z)(n),"styleNeedUpdate",!1),(0,V.Z)((0,ct.Z)(n),"forceRender",!1),(0,V.Z)((0,ct.Z)(n),"clusterZoom",0),(0,V.Z)((0,ct.Z)(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,V.Z)((0,ct.Z)(n),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,V.Z)((0,ct.Z)(n),"hooks",{init:new F1,afterInit:new D1,beforeRender:new D1,beforeRenderData:new Hb,afterRender:new ov,beforePickingEncode:new ov,afterPickingEncode:new ov,beforeHighlight:new ov(["pickedColor"]),afterHighlight:new ov,beforeSelect:new ov(["pickedColor"]),afterSelect:new ov,beforeDestroy:new ov,afterDestroy:new ov}),(0,V.Z)((0,ct.Z)(n),"models",[]),(0,V.Z)((0,ct.Z)(n),"startInit",!1),(0,V.Z)((0,ct.Z)(n),"layerChildren",[]),(0,V.Z)((0,ct.Z)(n),"masks",[]),Ys((0,ct.Z)(n),"configService",NS,(0,ct.Z)(n)),(0,V.Z)((0,ct.Z)(n),"animateOptions",{enable:!1}),(0,V.Z)((0,ct.Z)(n),"currentPickId",null),(0,V.Z)((0,ct.Z)(n),"pendingStyleAttributes",[]),(0,V.Z)((0,ct.Z)(n),"scaleOptions",{}),(0,V.Z)((0,ct.Z)(n),"animateStatus",!1),(0,V.Z)((0,ct.Z)(n),"isDestroyed",!1),(0,V.Z)((0,ct.Z)(n),"encodeDataLength",0),(0,V.Z)((0,ct.Z)(n),"sourceEvent",function(){n.dataState.dataSourceNeedUpdate=!0;var a=n.getLayerConfig();a&&a.autoFit&&n.fitBounds(a.fitBoundsOptions);var s=n.layerSource.getSourceCfg().autoRender;s&&n.reRender()}),n.name=t.name||n.id,n.zIndex=t.zIndex||0,n.rawConfig=t,n}return(0,he.Z)(r,[{key:"addMaskLayer",value:function(t){this.masks.push(t)}},{key:"removeMaskLayer",value:function(t){var a=this.masks.indexOf(t);a>-1&&this.masks.splice(a,1),t.destroy()}},{key:"getAttribute",value:function(t){return this.styleAttributeService.getLayerStyleAttribute(t)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(t){var a=this;if(Object.keys(t).map(function(l){l in a.rawConfig&&(a.rawConfig[l]=t[l])}),!this.startInit)this.needUpdateConfig=(0,ue.Z)((0,ue.Z)({},this.needUpdateConfig),t);else{var s=this.container.get(Ir.SceneID);FM(t,this),this.configService.setLayerConfig(s,this.id,(0,ue.Z)((0,ue.Z)((0,ue.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),t)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(t,a){this.container=t,this.sceneContainer=a}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(t){return this.plugins.push(t),this}},{key:"init",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s=this,l,f,d,S,O,Z,U;return Ze().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:l=this.container.get(Ir.SceneID),this.startInit=!0,this.configService.setLayerConfig(l,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(Ir.IIconService),this.fontService=this.container.get(Ir.IFontService),this.rendererService=this.container.get(Ir.IRendererService),this.layerService=this.container.get(Ir.ILayerService),this.debugService=this.container.get(Ir.IDebugService),this.interactionService=this.container.get(Ir.IInteractionService),this.pickingService=this.container.get(Ir.IPickingService),this.mapService=this.container.get(Ir.IMapService),f=this.getLayerConfig(),d=f.enableMultiPassRenderer,S=f.passes,d&&S!==null&&S!==void 0&&S.length&&S.length>0&&this.mapService.on("mapAfterFrameChange",function(){s.renderLayers()}),this.cameraService=this.container.get(Ir.ICameraService),this.coordinateService=this.container.get(Ir.ICoordinateSystemService),this.shaderModuleService=this.container.get(Ir.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Ir.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Ir.IFactoryNormalPass),this.styleAttributeService=this.container.get(Ir.IStyleAttributeService),d&&(this.multiPassRenderer=this.container.get(Ir.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(ye){var Be=ye.attributeName,rt=ye.attributeField,Je=ye.attributeValues,Ot=ye.updateOptions;s.styleAttributeService.updateStyleAttribute(Be,{scale:(0,ue.Z)({field:rt},s.splitValuesAndCallbackInAttribute(Je,s.getLayerConfig()[Be]))},Ot)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Ir.ILayerPlugin),O=YM(this.plugins);try{for(O.s();!(Z=O.n()).done;)U=Z.value,U.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(ye){O.e(ye)}finally{O.f()}return this.layerPickService=new GM(this),this.textureService=new $M(this),this.log(nh.LayerInitStart),le.next=31,this.hooks.init.promise();case 31:this.log(nh.LayerInitEnd),this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 36:case"end":return le.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"log",value:function(t){var a,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"init";if(!(this.tileLayer||this.isTileLayer)){var l="".concat(this.id,".").concat(s,".").concat(t),f={id:this.id,type:this.type};(a=this.debugService)===null||a===void 0||a.log(l,f)}}},{key:"updateModelData",value:function(t){t.attributes&&t.elements?this.models.map(function(a){a.updateAttributesAndElements(t.attributes,t.elements)}):console.warn("data error")}},{key:"createModelData",value:function(t,a){var s;if((s=this.layerModel)!==null&&s!==void 0&&s.createModelData)return this.layerModel.createModelData(a);var l=this.calculateEncodeData(t,a),f=this.triangulation;return l&&f?this.styleAttributeService.createAttributesAndIndices(l,f):{attributes:void 0,elements:void 0}}},{key:"setLayerPickService",value:function(t){this.layerPickService=t}},{key:"calculateEncodeData",value:function(t,a){return this.inited?HM(this,this.fontService,this.mapService,this.styleAttributeService,t,a):(console.warn("layer not inited!"),null)}},{key:"prepareBuildModel",value:function(){this.updateLayerConfig((0,ue.Z)((0,ue.Z)((0,ue.Z)({},this.getDefaultConfig()),this.rawConfig),this.needUpdateConfig));var t=this.getLayerConfig(),a=t.animateOption;a!=null&&a.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(t,a,s){return this.updateStyleAttribute("color",t,a,s),this}},{key:"texture",value:function(t,a,s){return this.updateStyleAttribute("texture",t,a,s),this}},{key:"rotate",value:function(t,a,s){return this.updateStyleAttribute("rotate",t,a,s),this}},{key:"size",value:function(t,a,s){return this.updateStyleAttribute("size",t,a,s),this}},{key:"filter",value:function(t,a,s){var l=this.updateStyleAttribute("filter",t,a,s);return this.dataState.dataSourceNeedUpdate=l,this}},{key:"shape",value:function(t,a,s){this.shapeOption={field:t,values:a};var l=this.updateStyleAttribute("shape",t,a,s);return this.dataState.dataSourceNeedUpdate=l,this}},{key:"label",value:function(t,a,s){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:t,attributeValues:a,updateOptions:s}),this}},{key:"animate",value:function(t){var a={};return(0,Kn.isObject)(t)?(a.enable=!0,a=(0,ue.Z)((0,ue.Z)({},a),t)):a.enable=t,this.updateLayerConfig({animateOption:a}),this}},{key:"source",value:function(t,a){return(t==null?void 0:t.type)==="source"?(this.setSource(t),this):(this.sourceOption={data:t,options:a},this.clusterZoom=0,this)}},{key:"setData",value:function(t,a){var s=this;return this.inited?(this.log(nh.SourceInitStart,ih.UPDATE),this.layerSource.setData(t,a),this.log(nh.SourceInitEnd,ih.UPDATE)):this.on("inited",function(){s.log(nh.SourceInitStart,ih.UPDATE);var l=s.getSource();l?s.layerSource.setData(t,a):s.source(new Hv(t,a)),s.layerSource.once("update",function(){s.log(nh.SourceInitEnd,ih.UPDATE)})}),this}},{key:"style",value:function(t){var a=this,s=t.passes,l=(0,Xo.Z)(t,WM);return s&&DS(s).forEach(function(f){var d=a.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(f[0]);d&&d.updateOptions(f[1])}),this.rawConfig=(0,ue.Z)((0,ue.Z)({},this.rawConfig),l),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(t,a){var s=(0,ue.Z)({},this.scaleOptions);if((0,Kn.isObject)(t)?this.scaleOptions=(0,ue.Z)((0,ue.Z)({},this.scaleOptions),t):this.scaleOptions[t]=a,this.styleAttributeService&&!(0,Kn.isEqual)(s,this.scaleOptions)){var l=(0,Kn.isObject)(t)?t:(0,V.Z)({},t,a);this.styleAttributeService.updateScaleAttribute(l)}return this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(),this))}},{key:"renderMultiPass",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){l.next=2;break}return l.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){l.next=7;break}return l.next=5,this.multiPassRenderer.render();case 5:l.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"active",value:function(t){var a={};return a.enableHighlight=(0,Kn.isObject)(t)?!0:t,(0,Kn.isObject)(t)?(a.enableHighlight=!0,t.color&&(a.highlightColor=t.color),t.mix&&(a.activeMix=t.mix)):a.enableHighlight=!!t,this.updateLayerConfig(a),this}},{key:"setActive",value:function(t,a){var s=this;if((0,Kn.isObject)(t)){var l=t.x,f=l===void 0?0:l,d=t.y,S=d===void 0?0:d;this.updateLayerConfig({highlightColor:(0,Kn.isObject)(a)?a.color:this.getLayerConfig().highlightColor,activeMix:(0,Kn.isObject)(a)?a.mix:this.getLayerConfig().activeMix}),this.pick({x:f,y:S})}else this.updateLayerConfig({pickedFeatureID:t,highlightColor:(0,Kn.isObject)(a)?a.color:this.getLayerConfig().highlightColor,activeMix:(0,Kn.isObject)(a)?a.mix:this.getLayerConfig().activeMix}),this.hooks.beforeSelect.call(of(t)).then(function(){setTimeout(function(){s.reRender()},1)})}},{key:"select",value:function(t){var a={};return a.enableSelect=(0,Kn.isObject)(t)?!0:t,(0,Kn.isObject)(t)?(a.enableSelect=!0,t.color&&(a.selectColor=t.color),t.mix&&(a.selectMix=t.mix)):a.enableSelect=!!t,this.updateLayerConfig(a),this}},{key:"setSelect",value:function(t,a){var s=this;if((0,Kn.isObject)(t)){var l=t.x,f=l===void 0?0:l,d=t.y,S=d===void 0?0:d;this.updateLayerConfig({selectColor:(0,Kn.isObject)(a)?a.color:this.getLayerConfig().selectColor,selectMix:(0,Kn.isObject)(a)?a.mix:this.getLayerConfig().selectMix}),this.pick({x:f,y:S})}else this.updateLayerConfig({pickedFeatureID:t,selectColor:(0,Kn.isObject)(a)?a.color:this.getLayerConfig().selectColor,selectMix:(0,Kn.isObject)(a)?a.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(of(t)).then(function(){setTimeout(function(){s.reRender()},1)})}},{key:"setBlend",value:function(t){return this.updateLayerConfig({blend:t}),this.layerModelNeedUpdate=!0,this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(t){return this.zIndex=t,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(t){this.currentPickId=t}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(t){this.selectedFeatureID=t}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var t=this.mapService.getZoom(),a=this.getLayerConfig(),s=a.visible,l=a.minZoom,f=l===void 0?-1/0:l,d=a.maxZoom,S=d===void 0?1/0:d;return!!s&&t>=f&&t<S}},{key:"setMultiPass",value:function(t,a){if(this.updateLayerConfig({enableMultiPassRenderer:t}),a&&this.updateLayerConfig({passes:a}),t){var s=this.getLayerConfig(),l=s.passes,f=l===void 0?[]:l;this.multiPassRenderer=FS(this,f,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var d=this.rendererService.getViewportSize(),S=d.width,O=d.height;this.multiPassRenderer.resize(S,O)}return this}},{key:"setMinZoom",value:function(t){return this.updateLayerConfig({minZoom:t}),this}},{key:"getMinZoom",value:function(){var t=this.getLayerConfig(),a=t.minZoom;return a}},{key:"getMaxZoom",value:function(){var t=this.getLayerConfig(),a=t.maxZoom;return a}},{key:"get",value:function(t){var a=this.getLayerConfig();return a[t]}},{key:"setMaxZoom",value:function(t){return this.updateLayerConfig({maxZoom:t}),this}},{key:"setAutoFit",value:function(t){return this.updateLayerConfig({autoFit:t}),this}},{key:"fitBounds",value:function(t){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var a=this.getSource(),s=a.extent,l=s.some(function(f){return Math.abs(f)===1/0});return l?this:(this.mapService.fitBounds([[s[0],s[1]],[s[2],s[3]]],t),this)}},{key:"destroy",value:function(){var t,a,s,l,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isDestroyed||(this.layerChildren.map(function(d){return d.destroy(!1)}),this.layerChildren=[],this.masks.map(function(d){return d.destroy(!1)}),this.masks=[],this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(t=this.multiPassRenderer)===null||t===void 0||t.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(a=this.layerModel)===null||a===void 0||a.clearModels(f),(s=this.tileLayer)===null||s===void 0||s.destroy(),this.models=[],(l=this.debugService)===null||l===void 0||l.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0)}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var t;this.models.forEach(function(a){return a.destroy()}),(t=this.layerModel)===null||t===void 0||t.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(t){return t.needRescale||t.needRemapping||t.needRegenerateVertices}).length}},{key:"setSource",value:function(t){var a=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=t,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var s=this.mapService.getZoom();this.layerSource.updateClusterData(s)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(l){var f=l.type;if(a.coordCenter===void 0){var d,S=a.layerSource.center;a.coordCenter=S,(d=a.mapService)!==null&&d!==void 0&&d.setCoordCenter&&a.mapService.setCoordCenter(S)}f==="update"&&a.sourceEvent()})}},{key:"initSource",value:function(t){this.layerSource=t,this.clusterZoom=0,this.addSourceEvent()}},{key:"getSource",value:function(){return this.layerSource}},{key:"addSourceEvent",value:function(){var t=this;this.layerSource.on("update",function(){if(t.coordCenter===void 0){var a,s=t.layerSource.center;t.coordCenter=s,(a=t.mapService)!==null&&a!==void 0&&a.setCoordCenter&&t.mapService.setCoordCenter(s)}t.sourceEvent()})}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(t){this.encodedData=t,this.encodeDataLength=t.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(t){return this.styleAttributeService.getLayerAttributeScale(t)}},{key:"getLegend",value:function(t){var a,s,l,f=this.styleAttributeService.getLayerStyleAttribute(t),d=(f==null||(a=f.scale)===null||a===void 0?void 0:a.scalers)||[];return{type:(s=d[0].option)===null||s===void 0?void 0:s.type,field:f==null||(l=f.scale)===null||l===void 0?void 0:l.field,items:this.getLegendItems(t)}}},{key:"getLegendItems",value:function(t){var a=this.styleAttributeService.getLayerAttributeScale(t);if(!a)return[];if(a.invertExtent){var s=a.range().map(function(d){return(0,V.Z)({value:a.invertExtent(d)},t,d)});return s}else if(a.ticks){var l=a.ticks().map(function(d){return(0,V.Z)({value:d},t,a(d))});return l}else if(a!=null&&a.domain){var f=a.domain().filter(function(d){return!(0,Kn.isUndefined)(d)}).map(function(d){return(0,V.Z)({value:d},t,a(d))});return f}return[]}},{key:"pick",value:function(t){var a=t.x,s=t.y;this.interactionService.triggerHover({x:a,y:s})}},{key:"boxSelect",value:function(t,a){this.pickingService.boxPickLayer(this,t,a)}},{key:"buildLayerModel",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s){var l=this,f,d,S,O,Z,U,se,le,ye,Be,rt,Je,Ot,jt;return Ze().wrap(function(Lr){for(;;)switch(Lr.prev=Lr.next){case 0:return f=s.moduleName,d=s.vertexShader,S=s.fragmentShader,O=s.triangulation,Z=s.segmentNumber,U=s.workerEnabled,se=U===void 0?!1:U,le=s.workerOptions,ye=(0,Xo.Z)(s,XM),this.shaderModuleService.registerModule(f,{vs:d,fs:S}),Be=this.shaderModuleService.getModule(f),rt=Be.vs,Je=Be.fs,Ot=Be.uniforms,jt=this.rendererService.createModel,Lr.abrupt("return",new Promise(function(jr,Jr){if(le&&le.modelType in et&&se)l.styleAttributeService.createAttributesAndIndicesAscy(l.encodedData,Z,le).then(function(vu){var Bu=vu.attributes,zl=vu.elements,_l=jt((0,ue.Z)({attributes:Bu,uniforms:Ot,fs:Je,vs:rt,elements:zl,blend:ow[Rd.normal]},ye));jr(_l)}).catch(function(vu){return Jr(vu)});else{var Pn=l.styleAttributeService.createAttributesAndIndices(l.encodedData,O,Z),In=Pn.attributes,Si=Pn.elements,ra=Pn.count,Va=(0,ue.Z)({attributes:In,uniforms:Ot,fs:Je,vs:rt,elements:Si,blend:ow[Rd.normal]},ye);ra&&(Va.count=ra);var Ms=jt(Va);jr(Ms)}}));case 5:case"end":return Lr.stop()}},a,this)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"createAttributes",value:function(t){var a=t.triangulation,s=this.styleAttributeService.createAttributes(this.encodedData,a),l=s.attributes;return l}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(t){var a=this.getLayerConfig(),s=a.enableHighlight,l=s===void 0?!0:s,f=a.enableSelect,d=f===void 0?!0:f,S=this.eventNames().indexOf(t)!==-1||this.eventNames().indexOf("un"+t)!==-1;return(t==="click"||t==="dblclick")&&d&&(S=!0),t==="mousemove"&&(l||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(S=!0),this.isVisible()&&S}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return l.stop()}},a)}));function t(){return n.apply(this,arguments)}return t}()},{key:"rebuildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.buildModels();case 2:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"renderMulPass",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s){return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,s.render();case 2:case"end":return f.stop()}},a)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"renderModels",value:function(t){var a=this;return this.encodeDataLength<=0&&!this.forceRender?this:(this.hooks.beforeRender.call(),this.models.forEach(function(s){s.draw({uniforms:a.layerModel.getUninforms()},t)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(t,a,s,l){var f=this.configService.getAttributeConfig(this.id)||{};return(0,Kn.isEqual)(f[t],{field:a,values:s})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(t)!==-1&&this.configService.setAttributeConfig(this.id,(0,V.Z)({},t,{field:a,values:s})),this.startInit?this.styleAttributeService.updateStyleAttribute(t,{scale:(0,ue.Z)({field:a},this.splitValuesAndCallbackInAttribute(s,this.getLayerConfig()[a]))},l):this.pendingStyleAttributes.push({attributeName:t,attributeField:a,attributeValues:s,updateOptions:l}),!0)}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(t){console.warn("empty fn")}},{key:"processData",value:function(t){return t}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.models.forEach(function(f){return f.destroy()}),this.models=[],l.next=4,this.layerModel.initModels();case 4:this.models=l.sent;case 5:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(t,a){return{values:(0,Kn.isFunction)(t)?void 0:t||a,callback:(0,Kn.isFunction)(t)?t:void 0}}}]),r}(Kc.EventEmitter),NS=Hs(sw.prototype,"configService",[BS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sw),US,uw,jS;function JM(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=e5(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function e5(e,i){if(e){if(typeof e=="string")return VS(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VS(e,i)}}function VS(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var il=(US=Rg(Ir.IGlobalConfigService),uw=function(){function e(i){(0,re.Z)(this,e),Ys(this,"configService",jS,this),this.layer=i,this.rendererService=i.getContainer().get(Ir.IRendererService),this.pickingService=i.getContainer().get(Ir.IPickingService),this.shaderModuleService=i.getContainer().get(Ir.IShaderModuleService),this.styleAttributeService=i.getContainer().get(Ir.IStyleAttributeService),this.mapService=i.getContainer().get(Ir.IMapService),this.iconService=i.getContainer().get(Ir.IIconService),this.fontService=i.getContainer().get(Ir.IFontService),this.cameraService=i.getContainer().get(Ir.ICameraService),this.layerService=i.getContainer().get(Ir.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var r=this.rendererService.createTexture2D;this.createTexture2D=r,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={thetaOffset:void 0,opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8Array(4),mag:Ve.NEAREST,min:Ve.NEAREST,width:1,height:1}))}return(0,he.Z)(e,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertiesExist.hasOpacity,this.stylePropertiesExist.hasStrokeOpacity,this.stylePropertiesExist.hasStrokeWidth,this.stylePropertiesExist.hasStroke,this.stylePropertiesExist.hasOffsets,this.stylePropertiesExist.hasThetaOffset,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(r){var n=!1;return(0,Kn.isEqual)(r.thetaOffset,this.cacheStyleProperties.thetaOffset)||(n=!0,this.cacheStyleProperties.thetaOffset=r.thetaOffset),(0,Kn.isEqual)(r.opacity,this.cacheStyleProperties.opacity)||(n=!0,this.cacheStyleProperties.opacity=r.opacity),(0,Kn.isEqual)(r.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(n=!0,this.cacheStyleProperties.strokeOpacity=r.strokeOpacity),(0,Kn.isEqual)(r.strokeWidth,this.cacheStyleProperties.strokeWidth)||(n=!0,this.cacheStyleProperties.strokeWidth=r.strokeWidth),(0,Kn.isEqual)(r.stroke,this.cacheStyleProperties.stroke)||(n=!0,this.cacheStyleProperties.stroke=r.stroke),(0,Kn.isEqual)(r.offsets,this.cacheStyleProperties.offsets)||(n=!0,this.cacheStyleProperties.offsets=r.offsets),this.dataTexture===void 0&&(n=!0),n}},{key:"judgeStyleAttributes",value:function(r){this.clearLastCalRes(),r.opacity!==void 0&&!(0,Kn.isNumber)(r.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertiesExist.hasOpacity=1,this.cellLength+=1),r.strokeOpacity!==void 0&&!(0,Kn.isNumber)(r.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertiesExist.hasStrokeOpacity=1,this.cellLength+=1),r.strokeWidth!==void 0&&!(0,Kn.isNumber)(r.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertiesExist.hasStrokeWidth=1,this.cellLength+=1),r.stroke!==void 0&&!this.isStaticColor(r.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertiesExist.hasStroke=1,this.cellLength+=4),r.offsets!==void 0&&!this.isOffsetStatic(r.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertiesExist.hasOffsets=1,this.cellLength+=2),r.thetaOffset!==void 0&&!(0,Kn.isNumber)(r.thetaOffset)&&(this.cellProperties.push({attr:"thetaOffset",count:1}),this.stylePropertiesExist.hasThetaOffset=1,this.cellLength+=1)}},{key:"isStaticColor",value:function(r){return(0,Kn.isString)(r)?!!hc(r):!1}},{key:"getStrokeColor",value:function(r){if(this.isStaticColor(r)){var n=Qi(r);return n[0]=n[0]?n[0]:0,n[1]=n[1]?n[1]:0,n[2]=n[2]?n[2]:0,n[3]=n[3]?n[3]:0,n}else return[0,0,0,0]}},{key:"isOffsetStatic",value:function(r){return!!(Array.isArray(r)&&r.length===2&&(0,Kn.isNumber)(r[0])&&(0,Kn.isNumber)(r[1]))}},{key:"patchMod",value:function(r,n){for(var t=0;t<n;t++)r.push(-1)}},{key:"patchData",value:function(r,n,t){var a=JM(t),s;try{for(a.s();!(s=a.n()).done;){var l=s.value,f=l.attr,d=l.count,S=n[f];S!==void 0?f==="stroke"?r.push.apply(r,(0,oe.Z)(Qi(S))):f==="offsets"?this.isOffsetStatic(S)?r.push(-S[0],S[1]):r.push(0,0):r.push((0,Kn.isNumber)(S)?S:1):this.patchMod(r,d)}}catch(O){a.e(O)}finally{a.f()}}},{key:"calDataFrame",value:function(r,n,t){for(var a=n.length,s=Math.ceil(a*r/this.DATA_TEXTURE_WIDTH),l=s*this.DATA_TEXTURE_WIDTH,f=[],d=0;d<a;d++){var S=n[d];this.patchData(f,S,t)}for(var O=f.length;O<l;O++)f.push(-1);return{data:f,width:this.DATA_TEXTURE_WIDTH,height:s}}},{key:"getBlend",value:function(){var r=this.layer.getLayerConfig(),n=r.blend,t=n===void 0?"normal":n;return ow[Rd[t]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(){return Ze().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",!1);case 1:case"end":return a.stop()}},n)}));function r(){return i.apply(this,arguments)}return r}()},{key:"buildModels",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(){return Ze().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},n)}));function r(){return i.apply(this,arguments)}return r}()},{key:"initModels",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(){return Ze().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return a.stop()}},n)}));function r(){return i.apply(this,arguments)}return r}()},{key:"clearModels",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(r){return[r.enable?0:1,r.duration||4,r.interval||.2,r.trailLength||.1]}},{key:"startModelAnimate",value:function(){var r=this.layer.getLayerConfig(),n=r.animateOption;n.enable&&this.layer.setAnimateStartTime()}}]),e}(),jS=Hs(uw.prototype,"configService",[US],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uw),lw;(function(e){e[e.solid=0]="solid",e[e.dash=1]="dash"})(lw||(lw={}));var Vm;(function(e){e.VERTICAL="vertical",e.HORIZONTAL="horizontal"})(Vm||(Vm={}));var Ex;(function(e){e.NORMAL="normal",e.REPLACE="replace"})(Ex||(Ex={}));var Ng;(function(e){e[e.pixel=0]="pixel",e[e.meter=1]="meter"})(Ng||(Ng={}));var U0;(function(e){e.ALWAYS="always",e.DRAGEND="dragend"})(U0||(U0={}));function t5(e){var i=r5();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function r5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var n5=function(e){(0,Ft.Z)(r,e);var i=t5(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"updateMode",U0.ALWAYS),(0,V.Z)((0,ct.Z)(n),"renderUpdate",function(){var l=n.layer.getLayerConfig(),f=l.zIndex,d=f===void 0?10:f,S=l.update,O=S===void 0?U0.ALWAYS:S,Z=l.animateOption,U=Z===void 0?{enable:!1,duration:20}:Z;+n.canvas.style.zIndex===d&&(n.canvas.style.zIndex=d+""),n.updateMode!==O&&(n.updateMode=O,n.unBindListener(),n.bindListener()),n.updateMode===U0.ALWAYS&&U.enable&&n.renderCanvas()}),(0,V.Z)((0,ct.Z)(n),"unBindListener",function(){n.mapService.off("mapchange",n.renderCanvas),n.mapService.off("zoomstart",n.clearCanvas),n.mapService.off("zoomend",n.renderCanvas),n.mapService.off("movestart",n.clearCanvas),n.mapService.off("moveend",n.renderCanvas)}),(0,V.Z)((0,ct.Z)(n),"bindListener",function(){n.updateMode===U0.ALWAYS?n.mapService.on("mapchange",n.renderCanvas):(n.mapService.on("zoomstart",n.clearCanvas),n.mapService.on("zoomend",n.renderCanvas),n.mapService.on("movestart",n.clearCanvas),n.mapService.on("moveend",n.renderCanvas))}),(0,V.Z)((0,ct.Z)(n),"clearCanvas",function(){if(n.ctx){var l=n.rendererService.getViewportSize(),f=l.width,d=l.height;n.ctx.clearRect(0,0,f,d)}}),(0,V.Z)((0,ct.Z)(n),"renderCanvas",function(){var l=n.rendererService.getViewportSize(),f=l.width,d=l.height;if(n.prevSize[0]!==f||n.prevSize[1]!==d){n.prevSize=[f,d];var S=n.mapService.getSize(),O=(0,Ja.Z)(S,2),Z=O[0],U=O[1];n.canvas.width=f,n.canvas.height=d,n.canvas.style.width=Z+"px",n.canvas.style.height=U+"px"}var se=n.layer.getLayerConfig(),le=se.drawingOnCanvas;n.ctx&&le({canvas:n.canvas,ctx:n.ctx,mapService:n.mapService,size:[f,d]})}),n}return(0,he.Z)(r,[{key:"clearModels",value:function(){if(this.canvas){var t;(t=this.mapService.getContainer())===null||t===void 0||t.removeChild(this.canvas),this.canvas=null}this.unBindListener()}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f;return Ze().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return s=this.layer.getLayerConfig(),l=s.update,f=l===void 0?U0.ALWAYS:l,this.updateMode=f,this.initCanvas(),this.renderCanvas(),this.bindListener(),this.mapService.getContainer(),S.abrupt("return",[]);case 7:case"end":return S.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"initCanvas",value:function(){var t,a=this.layer.getLayerConfig(),s=a.zIndex,l=this.mapService.getSize(),f=(0,Ja.Z)(l,2),d=f[0],S=f[1],O=this.rendererService.getViewportSize(),Z=O.width,U=O.height;this.prevSize=[Z,U];var se=document.createElement("canvas");this.canvas=se,se.width=Z,se.height=U,se.style.pointerEvents="none",se.style.width=d+"px",se.style.height=S+"px",se.style.position="absolute",se.style.top="0",se.style.left="0",se.style.zIndex=s+"",(t=this.mapService.getContainer())===null||t===void 0||t.appendChild(se);var le=se.getContext("2d");this.ctx=le}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){}}]),r}(il),i5={canvas:n5},a5=i5;function o5(e){var i=s5();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function s5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var u5=function(e){(0,Ft.Z)(r,e);var i=o5(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","CanvasLayer"),(0,V.Z)((0,ct.Z)(n),"forceRender",!0),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel=new a5[s](this),f.next=4,this.initLayerModels();case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"hide",value:function(){return this.layerModel.clearCanvas&&this.layerModel.clearCanvas(),this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"renderModels",value:function(){var t,a=this;return this!==null&&this!==void 0&&(t=this.layerModel)!==null&&t!==void 0&&t.renderUpdate&&this.layerModel.renderUpdate(),this.models.forEach(function(s){s.draw({uniforms:a.layerModel.getUninforms()},!1)}),this}},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),a={canvas:{}};return a[t]}},{key:"getModelType",value:function(){return"canvas"}}]),r}(Dd);function j0(){var e=new ta(3);return ta!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function l5(e){var i=new ta(3);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i}function HS(e){var i=e[0],r=e[1],n=e[2];return Math.hypot(i,r,n)}function Kl(e,i,r){var n=new ta(3);return n[0]=e,n[1]=i,n[2]=r,n}function c5(e,i){return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function f5(e,i,r,n){return e[0]=i,e[1]=r,e[2]=n,e}function h5(e,i,r){return e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}function GS(e,i,r){return e[0]=i[0]-r[0],e[1]=i[1]-r[1],e[2]=i[2]-r[2],e}function cw(e,i,r){return e[0]=i[0]*r[0],e[1]=i[1]*r[1],e[2]=i[2]*r[2],e}function $S(e,i,r){return e[0]=i[0]/r[0],e[1]=i[1]/r[1],e[2]=i[2]/r[2],e}function p5(e,i){return e[0]=Math.ceil(i[0]),e[1]=Math.ceil(i[1]),e[2]=Math.ceil(i[2]),e}function d5(e,i){return e[0]=Math.floor(i[0]),e[1]=Math.floor(i[1]),e[2]=Math.floor(i[2]),e}function v5(e,i,r){return e[0]=Math.min(i[0],r[0]),e[1]=Math.min(i[1],r[1]),e[2]=Math.min(i[2],r[2]),e}function m5(e,i,r){return e[0]=Math.max(i[0],r[0]),e[1]=Math.max(i[1],r[1]),e[2]=Math.max(i[2],r[2]),e}function g5(e,i){return e[0]=Math.round(i[0]),e[1]=Math.round(i[1]),e[2]=Math.round(i[2]),e}function fw(e,i,r){return e[0]=i[0]*r,e[1]=i[1]*r,e[2]=i[2]*r,e}function y5(e,i,r,n){return e[0]=i[0]+r[0]*n,e[1]=i[1]+r[1]*n,e[2]=i[2]+r[2]*n,e}function WS(e,i){var r=i[0]-e[0],n=i[1]-e[1],t=i[2]-e[2];return Math.hypot(r,n,t)}function XS(e,i){var r=i[0]-e[0],n=i[1]-e[1],t=i[2]-e[2];return r*r+n*n+t*t}function YS(e){var i=e[0],r=e[1],n=e[2];return i*i+r*r+n*n}function KS(e,i){return e[0]=-i[0],e[1]=-i[1],e[2]=-i[2],e}function _5(e,i){return e[0]=1/i[0],e[1]=1/i[1],e[2]=1/i[2],e}function V0(e,i){var r=i[0],n=i[1],t=i[2],a=r*r+n*n+t*t;return a>0&&(a=1/Math.sqrt(a)),e[0]=i[0]*a,e[1]=i[1]*a,e[2]=i[2]*a,e}function qS(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]}function Sx(e,i,r){var n=i[0],t=i[1],a=i[2],s=r[0],l=r[1],f=r[2];return e[0]=t*f-a*l,e[1]=a*s-n*f,e[2]=n*l-t*s,e}function x5(e,i,r,n){var t=i[0],a=i[1],s=i[2];return e[0]=t+n*(r[0]-t),e[1]=a+n*(r[1]-a),e[2]=s+n*(r[2]-s),e}function b5(e,i,r,n,t,a){var s=a*a,l=s*(2*a-3)+1,f=s*(a-2)+a,d=s*(a-1),S=s*(3-2*a);return e[0]=i[0]*l+r[0]*f+n[0]*d+t[0]*S,e[1]=i[1]*l+r[1]*f+n[1]*d+t[1]*S,e[2]=i[2]*l+r[2]*f+n[2]*d+t[2]*S,e}function E5(e,i,r,n,t,a){var s=1-a,l=s*s,f=a*a,d=l*s,S=3*a*l,O=3*f*s,Z=f*a;return e[0]=i[0]*d+r[0]*S+n[0]*O+t[0]*Z,e[1]=i[1]*d+r[1]*S+n[1]*O+t[1]*Z,e[2]=i[2]*d+r[2]*S+n[2]*O+t[2]*Z,e}function w5(e,i){i=i||1;var r=wo()*2*Math.PI,n=wo()*2-1,t=Math.sqrt(1-n*n)*i;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e[2]=n*i,e}function Hm(e,i,r){var n=i[0],t=i[1],a=i[2],s=r[3]*n+r[7]*t+r[11]*a+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*t+r[8]*a+r[12])/s,e[1]=(r[1]*n+r[5]*t+r[9]*a+r[13])/s,e[2]=(r[2]*n+r[6]*t+r[10]*a+r[14])/s,e}function S5(e,i,r){var n=i[0],t=i[1],a=i[2];return e[0]=n*r[0]+t*r[3]+a*r[6],e[1]=n*r[1]+t*r[4]+a*r[7],e[2]=n*r[2]+t*r[5]+a*r[8],e}function C5(e,i,r){var n=r[0],t=r[1],a=r[2],s=r[3],l=i[0],f=i[1],d=i[2],S=t*d-a*f,O=a*l-n*d,Z=n*f-t*l,U=t*Z-a*O,se=a*S-n*Z,le=n*O-t*S,ye=s*2;return S*=ye,O*=ye,Z*=ye,U*=2,se*=2,le*=2,e[0]=l+S+U,e[1]=f+O+se,e[2]=d+Z+le,e}function A5(e,i,r,n){var t=[],a=[];return t[0]=i[0]-r[0],t[1]=i[1]-r[1],t[2]=i[2]-r[2],a[0]=t[0],a[1]=t[1]*Math.cos(n)-t[2]*Math.sin(n),a[2]=t[1]*Math.sin(n)+t[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function T5(e,i,r,n){var t=[],a=[];return t[0]=i[0]-r[0],t[1]=i[1]-r[1],t[2]=i[2]-r[2],a[0]=t[2]*Math.sin(n)+t[0]*Math.cos(n),a[1]=t[1],a[2]=t[2]*Math.cos(n)-t[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function M5(e,i,r,n){var t=[],a=[];return t[0]=i[0]-r[0],t[1]=i[1]-r[1],t[2]=i[2]-r[2],a[0]=t[0]*Math.cos(n)-t[1]*Math.sin(n),a[1]=t[0]*Math.sin(n)+t[1]*Math.cos(n),a[2]=t[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function hw(e,i){var r=e[0],n=e[1],t=e[2],a=i[0],s=i[1],l=i[2],f=Math.sqrt(r*r+n*n+t*t),d=Math.sqrt(a*a+s*s+l*l),S=f*d,O=S&&qS(e,i)/S;return Math.acos(Math.min(Math.max(O,-1),1))}function P5(e){return e[0]=0,e[1]=0,e[2]=0,e}function O5(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function I5(e,i){return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]}function L5(e,i){var r=e[0],n=e[1],t=e[2],a=i[0],s=i[1],l=i[2];return Math.abs(r-a)<=Ri*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=Ri*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(t-l)<=Ri*Math.max(1,Math.abs(t),Math.abs(l))}var pw=GS,R5=cw,k5=$S,D5=WS,F5=XS,B5=HS,N5=YS,z5=function(){var e=j0();return function(i,r,n,t,a,s){var l,f;for(r||(r=3),n||(n=0),t?f=Math.min(t*r+n,i.length):f=i.length,l=n;l<f;l+=r)e[0]=i[l],e[1]=i[l+1],e[2]=i[l+2],a(e,e,s),i[l]=e[0],i[l+1]=e[1],i[l+2]=e[2];return i}}(),Jy=100,QS=36,Z5=40;function JS(e){return e/180*Math.acos(-1)}function eC(e){var i=JS(e[0])+Math.PI/2,r=JS(e[1]),n=Jy+Math.random()*.4,t=n*Math.cos(r)*Math.cos(i),a=n*Math.cos(r)*Math.sin(i),s=n*Math.sin(r);return[a,s,t]}function tC(e,i){var r=rl(),n=rl(),t=Kl(0,1,0),a=Kl(0,0,0);i=i||{},e=typeof e!="undefined"?e:1;for(var s=typeof i.segments!="undefined"?i.segments:32,l=2+s,f=2*l,d=[],S=[],O=[],Z=[],U=[],se=[],le=0;le<=l;le++){for(var ye=le/l,Be=ye*Math.PI,rt=0;rt<=f;rt++){var Je=rt/f,Ot=Je*Math.PI*2;Zd(n),vp(n,n,-Be),Zd(r),zp(r,r,Ot),Hm(a,t,n),Hm(a,a,r),fw(a,a,-e),O.push(a.slice()),Z.push.apply(Z,(0,oe.Z)(a.slice())),V0(a,a),U.push.apply(U,(0,oe.Z)(a.slice())),se.push([Je,1-ye]),Z.push(Je,1-ye)}if(le>0)for(var jt=O.length,dr=jt-2*(f+1);dr+f+2<jt;dr++)d.push([dr,dr+1,dr+f+1]),S.push(dr,dr+1,dr+f+1),d.push([dr+f+1,dr+1,dr+f+2]),S.push(dr+f+1,dr+1,dr+f+2)}return{cells:d,positions:O,uvs:se,positionsArr:Z,indicesArr:S,normalArr:U}}var Cx=ri(),EB=ri(),np=ri(),H0=ri(),zg=ri();function dw(e,i,r,n,t){Hi(e,r,n),tl(e,e),i=Zi(-e[1],e[0]);var a=Zi(-r[1],r[0]);return[t/Ts(i,a),i]}function G0(e,i){return Bo(e,-i[1],i[0])}function Zg(e,i,r){return cn(e,i,r),tl(e,e),e}function vw(e,i){return e[0]===i[0]&&e[1]===i[1]}function wB(e){for(var i=new Map,r=0;r<e.length;r++){var n=e[0].toString()+"-"+e[1].toString();i.get(n)?(e.splice(r,1),r++):i.set(n,n)}return e}var U5=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,re.Z)(this,e),(0,V.Z)(this,"lastFlip",-1),(0,V.Z)(this,"miter",Zi(0,0)),(0,V.Z)(this,"started",!1),(0,V.Z)(this,"dash",!1),(0,V.Z)(this,"totalDistance",0),(0,V.Z)(this,"currentIndex",0),this.join=i.join||"miter",this.cap=i.cap||"butt",this.miterLimit=i.miterLimit||10,this.thickness=i.thickness||1,this.dash=i.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,he.Z)(e,[{key:"simpleExtrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var t=r.length,a=n.startIndex,s=1;s<t;s++){var l=r[s-1],f=r[s],d=s<r.length-1?r[s+1]:null,S=this.simpleSegment(n,a,l,f,d);a+=S}if(this.dash)for(var O=0;O<n.positions.length/6;O++)n.positions[O*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude_gaode2",value:function(r,n){var t=this.complex;if(r.length<=1)return t;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,s=t.startIndex,l=1;l<a;l++){var f,d,S,O=r[l-1];O.push((f=n[l-1][2])!==null&&f!==void 0?f:0);var Z=n[l-1],U=r[l];U.push((d=n[l][2])!==null&&d!==void 0?d:0);var se=n[l],le=l<r.length-1?[].concat((0,oe.Z)(r[l+1]),[(S=n[l+1][2])!==null&&S!==void 0?S:0]):null,ye=l<n.length-1?n[l+1]:null,Be=this.simpleSegment(t,s,O,U,le,Z,se,ye);s+=Be}if(this.dash)for(var rt=0;rt<t.positions.length/6;rt++)t.positions[rt*6+5]=this.totalDistance;return t.startIndex=t.positions.length/6,t}},{key:"extrude_gaode2",value:function(r,n){var t=this.complex;if(r.length<=1)return t;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var a=r.length,s=t.startIndex,l=1;l<a;l++){var f,d,S,O=r[l-1];O.push((f=n[l-1][2])!==null&&f!==void 0?f:0);var Z=n[l-1],U=r[l];U.push((d=n[l][2])!==null&&d!==void 0?d:0);var se=n[l],le=l<r.length-1?[].concat((0,oe.Z)(r[l+1]),[(S=n[l+1][2])!==null&&S!==void 0?S:0]):null,ye=l<n.length-1?n[l+1]:null,Be=this.segment_gaode2(t,s,O,U,le,Z,se,ye);s+=Be}if(this.dash)for(var rt=0;rt<t.positions.length/6;rt++)t.positions[rt*6+5]=this.totalDistance;return t.startIndex=t.positions.length/6,t}},{key:"extrude",value:function(r){var n=this.complex;if(r.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var t=r.length,a=n.startIndex,s=1;s<t;s++){var l=r[s-1],f=r[s],d=s<r.length-1?r[s+1]:null,S=this.segment(n,a,l,f,d);a+=S}if(this.dash)for(var O=0;O<n.positions.length/6;O++)n.positions[O*6+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleSegment",value:function(r,n,t,a,s){var l=0,f=r.indices,d=r.positions,S=r.normals,O=ga([a[0],a[1]]),Z=ga([t[0],t[1]]);Zg(np,O,Z);var U=0;if(this.dash&&(U=this.lineSegmentDistance(O,Z),this.totalDistance+=U),this.normal||(this.normal=ri(),G0(this.normal,np)),this.started||(this.started=!0,this.extrusions(d,S,t,this.normal,this.thickness,this.totalDistance-U)),f.push(n+0,n+1,n+2),!s)G0(this.normal,np),this.extrusions(d,S,a,this.normal,this.thickness,this.totalDistance),f.push.apply(f,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),l+=2;else{var se=ga([s[0],s[1]]);vw(O,se)&&Hi(se,O,tl(se,ba(se,O,Z))),Zg(H0,se,O);var le=dw(zg,ri(),np,H0,this.thickness),ye=(0,Ja.Z)(le,2),Be=ye[0],rt=ye[1],Je=Ts(zg,this.normal)<0?-1:1;this.extrusions(d,S,a,rt,Be,this.totalDistance),f.push.apply(f,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Je=-1,vo(this.normal,rt),l+=2,this.lastFlip=Je}return l}},{key:"segment_gaode2",value:function(r,n,t,a,s,l,f,d){var S=0,O=r.indices,Z=r.positions,U=r.normals,se=this.cap==="square",le=this.join==="bevel",ye=ga([f[0],f[1]]),Be=ga([l[0],l[1]]);Zg(np,a,t);var rt=0;if(this.dash&&(rt=this.lineSegmentDistance(ye,Be),this.totalDistance+=rt),this.normal||(this.normal=ri(),G0(this.normal,np)),!this.started)if(this.started=!0,se){var Je=ri(),Ot=ri();Hi(Je,this.normal,np),Hi(Ot,this.normal,np),U.push(Ot[0],Ot[1],0),U.push(Je[0],Je[1],0),Z.push(t[0],t[1],t[2]|0,this.totalDistance-rt,-this.thickness,t[2]|0),this.complex.indexes.push(this.currentIndex),Z.push(t[0],t[1],t[2]|0,this.totalDistance-rt,this.thickness,t[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(Z,U,t,this.normal,this.thickness,this.totalDistance-rt);if(O.push(n+0,n+1,n+2),s){vw(a,s)&&Hi(s,a,tl(s,ba(s,a,t))),Zg(H0,s,a);var Lr=dw(zg,ri(),np,H0,this.thickness),jr=(0,Ja.Z)(Lr,2),Jr=jr[0],Pn=jr[1],In=Ts(zg,this.normal)<0?-1:1,Si=le;if(!Si&&this.join==="miter"){var ra=Jr;ra>this.miterLimit&&(Si=!0)}Si?(U.push(this.normal[0],this.normal[1],0),U.push(Pn[0],Pn[1],0),Z.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*In,a[2]|0),this.complex.indexes.push(this.currentIndex),Z.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*In,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,O.push.apply(O,(0,oe.Z)(this.lastFlip!==-In?[n,n+2,n+3]:[n+2,n+1,n+3])),O.push(n+2,n+3,n+4),G0(Cx,H0),vo(this.normal,Cx),U.push(this.normal[0],this.normal[1],0),Z.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*In,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,S+=3):(this.extrusions(Z,U,a,Pn,Jr,this.totalDistance),O.push.apply(O,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),In=-1,vo(this.normal,Pn),S+=2),this.lastFlip=In}else{if(G0(this.normal,np),se){var jt=ri(),dr=ri();cn(dr,np,this.normal),Hi(jt,np,this.normal),U.push(dr[0],dr[1],0),U.push(jt[0],jt[1],0),Z.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),Z.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(Z,U,a,this.normal,this.thickness,this.totalDistance);O.push.apply(O,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),S+=2}return S}},{key:"segment",value:function(r,n,t,a,s){var l=0,f=r.indices,d=r.positions,S=r.normals,O=this.cap==="square",Z=this.join==="bevel",U=ga([a[0],a[1]]),se=ga([t[0],t[1]]);Zg(np,U,se);var le=0;if(this.dash&&(le=this.lineSegmentDistance(U,se),this.totalDistance+=le),this.normal||(this.normal=ri(),G0(this.normal,np)),!this.started)if(this.started=!0,O){var ye=ri(),Be=ri();Hi(ye,this.normal,np),Hi(Be,this.normal,np),S.push(Be[0],Be[1],0),S.push(ye[0],ye[1],0),d.push(t[0],t[1],t[2]|0,this.totalDistance-le,-this.thickness,t[2]|0),this.complex.indexes.push(this.currentIndex),d.push(t[0],t[1],t[2]|0,this.totalDistance-le,this.thickness,t[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(d,S,t,this.normal,this.thickness,this.totalDistance-le);if(f.push(n+0,n+1,n+2),s){var Ot=ga([s[0],s[1]]);vw(U,Ot)&&Hi(Ot,U,tl(Ot,ba(Ot,U,se))),Zg(H0,Ot,U);var jt=dw(zg,ri(),np,H0,this.thickness),dr=(0,Ja.Z)(jt,2),Lr=dr[0],jr=dr[1],Jr=Ts(zg,this.normal)<0?-1:1,Pn=Z;if(!Pn&&this.join==="miter"){var In=Lr;In>this.miterLimit&&(Pn=!0)}Pn?(S.push(this.normal[0],this.normal[1],0),S.push(jr[0],jr[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Jr,a[2]|0),this.complex.indexes.push(this.currentIndex),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness*Jr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,f.push.apply(f,(0,oe.Z)(this.lastFlip!==-Jr?[n,n+2,n+3]:[n+2,n+1,n+3])),f.push(n+2,n+3,n+4),G0(Cx,H0),vo(this.normal,Cx),S.push(this.normal[0],this.normal[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,-this.thickness*Jr,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,l+=3):(this.extrusions(d,S,a,jr,Lr,this.totalDistance),f.push.apply(f,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),Jr=-1,vo(this.normal,jr),l+=2),this.lastFlip=Jr}else{if(G0(this.normal,np),O){var rt=ri(),Je=ri();cn(Je,np,this.normal),Hi(rt,np,this.normal),S.push(Je[0],Je[1],0),S.push(rt[0],rt[1],0),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),d.push(a[0],a[1],a[2]|0,this.totalDistance,this.thickness,a[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(d,S,a,this.normal,this.thickness,this.totalDistance);f.push.apply(f,(0,oe.Z)(this.lastFlip===1?[n,n+2,n+3]:[n+2,n+1,n+3])),l+=2}return l}},{key:"extrusions",value:function(r,n,t,a,s,l){n.push(a[0],a[1],0),n.push(a[0],a[1],0),r.push(t[0],t[1],t[2]|0,l,-s,t[2]|0),this.complex.indexes.push(this.currentIndex),r.push(t[0],t[1],t[2]|0,l,s,t[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(r,n){var t=n[0]-r[0],a=n[1]-r[1];return Math.sqrt(t*t+a*a)}}]),e}();function j5(e){var i=e[0][0],r=e[0][e[0].length-1];i[0]===r[0]&&i[1]===r[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var n=e[0].length,t=yi().flatten(e),a=t.vertices,s=t.dimensions,l=[],f=[],d=0;d<a.length/s;d++)s===2?l.push(a[d*2],a[d*2+1],1):l.push(a[d*3],a[d*3+1],1);var S=yi()(t.vertices,t.holes,t.dimensions);f.push.apply(f,(0,oe.Z)(S));for(var O=function(se){var le=t.vertices.slice(se*s,(se+1)*s),ye=t.vertices.slice((se+1)*s,(se+2)*s);ye.length===0&&(ye=t.vertices.slice(0,s));var Be=l.length/3;l.push(le[0],le[1],1,ye[0],ye[1],1,le[0],le[1],0,ye[0],ye[1],0),f.push.apply(f,(0,oe.Z)([0,2,1,2,3,1].map(function(rt){return rt+Be})))},Z=0;Z<n;Z++)O(Z);return{positions:l,index:f}}function V5(e){var i=yi().flatten(e),r=yi()(i.vertices,i.holes,i.dimensions);return{positions:i.vertices,index:r}}function rC(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e[0][0],n=e[0][e[0].length-1];r[0]===n[0]&&r[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var t=e[0].length,a=yi().flatten(e),s=a.vertices,l=a.dimensions,f=[],d=[],S=[],O=0;O<s.length/l;O++)l===2?f.push(s[O*2],s[O*2+1],1,-1,-1):f.push(s[O*3],s[O*3+1],1,-1,-1),S.push(0,0,1);var Z=yi()(a.vertices,a.holes,a.dimensions);d.push.apply(d,(0,oe.Z)(Z));for(var U=function(ye){var Be=a.vertices.slice(ye*l,(ye+1)*l),rt=a.vertices.slice((ye+1)*l,(ye+2)*l);rt.length===0&&(rt=a.vertices.slice(0,l));var Je=f.length/5;f.push(Be[0],Be[1],1,0,0,rt[0],rt[1],1,.1,0,Be[0],Be[1],0,0,.8,rt[0],rt[1],0,.1,.8);var Ot=H5([rt[0],rt[1],1],[Be[0],Be[1],0],[Be[0],Be[1],1],i);S.push.apply(S,(0,oe.Z)(Ot).concat((0,oe.Z)(Ot),(0,oe.Z)(Ot),(0,oe.Z)(Ot))),d.push.apply(d,(0,oe.Z)([1,2,0,3,2,1].map(function(jt){return jt+Je})))},se=0;se<t;se++)U(se);return{positions:f,index:d,normals:S}}function H5(e,i,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,t=j0(),a=j0(),s=j0();n&&(e=Ua(e),i=Ua(i),r=Ua(r));var l=Kl.apply(ae,(0,oe.Z)(e)),f=Kl.apply(ae,(0,oe.Z)(i)),d=Kl.apply(ae,(0,oe.Z)(r));pw(t,d,f),pw(a,l,f),Sx(s,t,a);var S=j0();return V0(S,s),S}var uv,Gm;(function(e){e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn"})(Gm||(Gm={}));var $m;(function(e){e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon"})($m||($m={}));function e1(e){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=Math.PI*2/e,n=[],t=0;t<e;t++)n.push(r*t+i*Math.PI/12);var a=n.map(function(s){var l=Math.sin(s+Math.PI/4),f=Math.cos(s+Math.PI/4);return[l,f,0]});return a}function nC(){return e1(30)}function iC(){return e1(4)}function aC(){return e1(3)}function oC(){return e1(6,1)}function sC(){return e1(5)}var Ug=(uv={},(0,V.Z)(uv,$m.CIRCLE,nC),(0,V.Z)(uv,$m.HEXAGON,oC),(0,V.Z)(uv,$m.TRIANGLE,aC),(0,V.Z)(uv,$m.SQUARE,iC),(0,V.Z)(uv,$m.PENTAGON,sC),(0,V.Z)(uv,Gm.CYLINDER,nC),(0,V.Z)(uv,Gm.HEXAGONCOLUMN,oC),(0,V.Z)(uv,Gm.TRIANGLECOLUMN,aC),(0,V.Z)(uv,Gm.SQUARECOLUMN,iC),(0,V.Z)(uv,Gm.PENTAGONCOLUMN,sC),uv),Ax={};function Tx(e){var i=ml(e.coordinates);return{vertices:[].concat((0,oe.Z)(i),(0,oe.Z)(i),(0,oe.Z)(i),(0,oe.Z)(i)),indices:[0,1,2,2,3,0],size:i.length}}function uC(e){var i=ml(e.coordinates),r=eC(i);return{vertices:[].concat((0,oe.Z)(r),(0,oe.Z)(r),(0,oe.Z)(r),(0,oe.Z)(r)),indices:[0,1,2,2,3,0],size:r.length}}function mw(e){var i=e.shape,r=q5(i,!1),n=r.positions,t=r.index,a=r.normals;return{vertices:n,indices:t,normals:a,size:5}}function G5(e){var i=ml(e.coordinates);return{vertices:(0,oe.Z)(i),indices:[0],size:i.length}}function t1(e){var i=e.coordinates,r=e.originCoordinates,n=e.version,t=new U5({dash:!0,join:"bevel"});if(n==="GAODE2.x"){var a=i;Array.isArray(a[0][0])||(a=[i]);var s=r;Array.isArray(s[0][0])||(s=[r]);for(var l=0;l<a.length;l++){var f=a[l],d=s[l];t.extrude_gaode2(f,d)}}else{var S=i;S[0]&&!Array.isArray(S[0][0])&&(S=[i]),S.forEach(function(Z){t.extrude(Z)})}var O=t.complex;return{vertices:O.positions,indices:O.indices,normals:O.normals,indexes:O.indexes,size:6}}function $5(e){var i=e.coordinates,r=[];if(!Array.isArray(i[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var n=W5(i),t=n.results,a=n.totalDistance;return t.map(function(s){r.push(s[0],s[1],s[2],s[3],0,a)}),{vertices:r,indices:[],normals:[],size:6,count:t.length}}function SB(e){var i=e.coordinates,r=[];if(!Array.isArray(i[0]))return{vertices:[],indices:[],size:4,count:0};var n=X5(i),t=n.results;return t.map(function(a){r.push(a[0],a[1],a[2],a[3])}),{vertices:r,indices:[],size:4,count:t.length}}function lC(e,i){var r=i[0]-e[0],n=i[1]-e[1];return Math.sqrt(r*r+n*n)}function jg(e,i){return e.length<3&&e.push(0),i!==void 0&&e.push(i),e}function W5(e){var i=e;Array.isArray(i)&&Array.isArray(i[0])&&Array.isArray(i[0][0])&&(i=e.flat());var r=0;if(i.length<2)return{results:i,totalDistance:0};var n=[],t=jg(i[0],r);n.push(t);for(var a=1;a<i.length-1;a++){var s=lC(i[a-1],i[a]);r+=s;var l=jg(i[a],r);n.push(l),n.push(l)}var f=lC(i[i.length-2],i[i.length-1]);return r+=f,n.push(jg(i[i.length-1],r)),{results:n,totalDistance:r}}function X5(e){if(e.length<2)return{results:e};var i=[],r=jg(e[0]);i.push(r);for(var n=1;n<e.length-1;n++){var t=jg(e[n]);i.push(t),i.push(t)}return i.push(jg(e[e.length-1])),{results:i}}function gw(e){var i=e.coordinates,r=yi().flatten(i),n=r.vertices,t=r.dimensions,a=r.holes;return{indices:yi()(n,a,t),vertices:n,size:t}}function Y5(e){var i=e.coordinates,r=yi().flatten(i),n=r.vertices,t=r.dimensions,a=r.holes;return{indices:yi()(n,a,t),vertices:K5(n),size:t+4}}function K5(e){for(var i=[],r=Mc(e),n=r.center,t=r.radius,a=0;a<e.length;a+=2){var s=e[a],l=e[a+1];i.push.apply(i,[s,l,0].concat((0,oe.Z)(n),[t]))}return i}function cC(e){var i=e.coordinates,r=rC(i,!0),n=r.positions,t=r.index,a=r.normals;return{vertices:n,indices:t,normals:a,size:5}}function fC(e){var i=e.shape,r=J5(i),n=r.positions,t=r.index;return{vertices:n,indices:t,size:3}}function r1(e){var i=e.coordinates,r=[].concat((0,oe.Z)(i[0]),[0,0,1,i[1][0],i[0][1],0,1,1],(0,oe.Z)(i[1]),[0,1,0],(0,oe.Z)(i[0]),[0,0,1],(0,oe.Z)(i[1]),[0,1,0,i[0][0],i[1][1],0,0,0]),n=[0,1,2,3,4,5];return{vertices:r,indices:n,size:5}}function Mx(e,i){for(var r=i||30,n=e.coordinates,t=[],a=[],s=function(d){t.push(d,1,d,n[0][0],n[0][1],n[1][0],n[1][1],d,-1,d,n[0][0],n[0][1],n[1][0],n[1][1]),d!==r-1&&a.push.apply(a,(0,oe.Z)([0,1,2,1,3,2].map(function(S){return d*2+S})))},l=0;l<r;l++)s(l);return{vertices:t,indices:a,size:7}}function hC(e){var i=e.coordinates;i.length===2&&i.push(0);var r=Px(-1,1),n=Px(1,1),t=Px(-1,-1),a=Px(1,-1),s=[].concat((0,oe.Z)(i),(0,oe.Z)(r),(0,oe.Z)(i),(0,oe.Z)(t),(0,oe.Z)(i),(0,oe.Z)(a),(0,oe.Z)(i),(0,oe.Z)(n)),l=[0,1,2,3,0,2];return{vertices:s,indices:l,size:5}}function q5(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Ax&&Ax[e])return Ax[e];var r=Ug[e]?Ug[e]():Ug.cylinder(),n=rC([r],i);return Ax[e]=n,n}function CB(e,i){for(var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,t=new Float32Array(e.length/r*3),a,s,l,f=vec3.create(),d=vec3.create(),S=vec3.create(),O=0,Z=i.length;O<Z;O+=3){a=i[O+0]*3,s=i[O+1]*3,l=i[O+2]*3;var U=[e[a],e[a+1]],se=[e[s],e[s+1]],le=[e[l],e[l+1]];n&&(U=lngLatToMeters(U),se=lngLatToMeters(se),le=lngLatToMeters(le));var ye=U,Be=_slicedToArray(ye,2),rt=Be[0],Je=Be[1],Ot=vec3.fromValues(rt,Je,e[a+2]),jt=se,dr=_slicedToArray(jt,2),Lr=dr[0],jr=dr[1],Jr=vec3.fromValues(Lr,jr,e[s+2]),Pn=le,In=_slicedToArray(Pn,2),Si=In[0],ra=In[1],Va=vec3.fromValues(Si,ra,e[l+2]);vec3.sub(f,Va,Jr),vec3.sub(d,Ot,Jr),vec3.cross(S,f,d),t[a]+=f[0],t[a+1]+=f[1],t[a+2]+=f[2],t[s]+=f[0],t[s+1]+=f[1],t[s+2]+=f[2],t[l]+=f[0],t[l+1]+=f[1],t[l+2]+=f[2]}return Q5(t),t}function Q5(e){for(var i=0,r=e.length;i<r;i+=3){var n=vec3.fromValues(e[i],e[i+1],e[i+2]),t=vec3.create();vec3.normalize(t,n),e.set(t,i)}}function AB(e){var i=e[0][0],r=e[0][e[0].length-1];return i[0]===r[0]&&i[1]===r[1]}function J5(e){var i=["cylinder","triangleColumn","hexagonColumn","squareColumn"],r=Ug[e]?Ug[e]():Ug.circle(),n=i.indexOf(e)===-1?V5([r]):j5([r]);return n}function Px(e,i){var r=(e+1)/2,n=(i+1)/2;return[r,n]}function pC(){var e=tC(Jy,{segments:QS}),i=e.positionsArr,r=e.indicesArr,n=e.normalArr;return{vertices:i,indices:r,size:5,normals:n}}function e4(){var e=tC(Jy+Z5,{segments:QS}),i=e.positionsArr,r=e.indicesArr,n=e.normalArr;return{vertices:i,indices:r,size:5,normals:n}}function t4(e){var i=r4();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function r4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var n4=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

uniform float u_circleSweep;
uniform float u_cityMinSize;
uniform vec3 u_circleSweepColor;
uniform float u_circleSweepSpeed;

varying float v_worldDis;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }


  if(u_circleSweep > 0.0 && v_worldDis < u_cityMinSize) {
    float r = fract(((v_worldDis/u_cityMinSize) - u_time * u_circleSweepSpeed) * 2.0);
    gl_FragColor.rgb += r * r * u_circleSweepColor;
  }
   
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,i4=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;
uniform mat4 u_Mvp;

uniform float u_circleSweep;
uniform vec2 u_cityCenter;

varying float v_worldDis;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"


void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

   v_texCoord = a_Uv;

  if(u_circleSweep > 0.0) {
     vec2 lnglatscale = vec2(0.0);
    if(u_CoordinateSystem != COORDINATE_SYSTEM_P20_2) {
      lnglatscale = (a_Position.xy - u_cityCenter) * vec2(0.0, 0.135);
    }
    v_worldDis = length(a_Position.xy + lnglatscale - u_cityCenter);
  }
 
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,a4=function(e){(0,Ft.Z)(r,e);var i=t4(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.baseColor,f=l===void 0?"rgb(16,16,16)":l,d=t.brightColor,S=d===void 0?"rgb(255,176,38)":d,O=t.windowColor,Z=O===void 0?"rgb(30,60,89)":O,U=t.time,se=U===void 0?0:U,le=t.sweep,ye=le===void 0?{enable:!1,sweepRadius:1,sweepColor:"rgb(255, 255, 255)",sweepSpeed:.4,sweepCenter:this.cityCenter}:le;return{u_cityCenter:ye.sweepCenter||this.cityCenter,u_cityMinSize:this.cityMinSize*ye.sweepRadius,u_circleSweep:ye.enable?1:0,u_circleSweepColor:Qi(ye.sweepColor).slice(0,3),u_circleSweepSpeed:ye.sweepSpeed,u_opacity:s,u_baseColor:Qi(f),u_brightColor:Qi(S),u_windowColor:Qi(Z),u_time:this.layer.getLayerAnimateTime()||se}}},{key:"calCityGeo",value:function(){var t=(0,Ja.Z)(this.layer.getSource().extent,4),a=t[0],s=t[1],l=t[2],f=t[3];if(this.mapService.version==="GAODE2.x"){this.cityCenter=this.mapService.lngLatToCoord([(l+a)/2,(f+s)/2]);var d=this.mapService.lngLatToCoord([l,f]),S=this.mapService.lngLatToCoord([a,s]);this.cityMinSize=Math.sqrt(Math.pow(d[0]-S[0],2)+Math.pow(d[1]-S[1],2))/4}else{var O=l-a,Z=f-s;this.cityCenter=[(l+a)/2,(f+s)/2],this.cityMinSize=Math.sqrt(Math.pow(O,2)+Math.pow(Z,2))/4}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.calCityGeo(),this.startModelAnimate(),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:i4,fragmentShader:n4,triangulation:cC,depth:{enable:!0},cull:{enable:!0,face:Ve.BACK}});case 2:return s=f.sent,f.abrupt("return",[s]);case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f,d){return d}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?10:s;return Array.isArray(l)?[l[0]]:[l]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(il);function o4(e){var i=s4();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function s4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var u4=function(e){(0,Ft.Z)(r,e);var i=o4(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","CityBuildingLayer"),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.layerModel=new a4(this),l.next=3,this.initLayerModels();case 3:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"setLight",value:function(t){this.updateLayerConfig({time:t})}},{key:"getModelType",value:function(){return"citybuilding"}}]),r}(Dd);function l4(e){var i=c4();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function c4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var f4=`
uniform sampler2D u_texture;
uniform float u_opacity;

varying vec3 v_Color;
varying vec2 v_uv;

#pragma include "picking"
void main() {
  gl_FragColor = texture2D(u_texture, vec2(v_uv.x, 1.0 - v_uv.y));
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,h4=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform float u_raisingHeight: 0.0;
uniform mat4 u_Mvp;
uniform float u_opacity;
uniform vec2 u_size: [1.0, 1.0];
uniform mat2 u_RotateMatrix;

attribute vec3 a_Extrude;
attribute vec3 a_Position;
attribute vec2 a_Uv;
attribute vec3 a_Color;

varying vec3 v_Color;
varying vec2 v_uv;

#pragma include "projection"
#pragma include "picking"
void main() {
   vec3 extrude = a_Extrude;
   v_Color = a_Color;
   v_uv = a_Uv;

   float raiseHeight = u_raisingHeight;
   if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raiseHeight = u_raisingHeight * mapboxZoomScale;
   }

   // \u8BA1\u7B97\u7ECF\u7EAC\u5EA6\u70B9\u4F4D\u5750\u6807
   vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

   // \u8BA1\u7B97\u7ED5 z \u8F74\u65CB\u8F6C\u540E\u7684\u504F\u79FB
   vec2 offsetXY = project_pixel(u_RotateMatrix * vec2(extrude.x * u_size.x, 0.0));
   // \u7ED5 z \u8F74\u65CB\u8F6C
   float x = project_pos.x + offsetXY.x;
   float y = project_pos.y + offsetXY.y;
   // z \u8F74\u4E0D\u53C2\u4E0E\u65CB\u8F6C
   float z = project_pixel(extrude.y * u_size.y + raiseHeight);


   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      // gl_Position = u_Mvp * (vec4(project_pos.xy, a_Position.z, 1.0));
      gl_Position = u_Mvp * (vec4(x, y, z, 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(x , y, z , 1.0));
   }

   setPickingColor(a_PickingColor);
}
`,p4=function(e){(0,Ft.Z)(r,e);var i=l4(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"radian",0),(0,V.Z)((0,ct.Z)(n),"planeGeometryTriangulation",function(){var l=n.layer.getLayerConfig(),f=l.center,d=f===void 0?[120,30]:f;return{size:4,indices:[0,1,2,2,3,0],vertices:[].concat((0,oe.Z)(d),[1,1],(0,oe.Z)(d),[0,1],(0,oe.Z)(d),[0,0],(0,oe.Z)(d),[1,0])}}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=t.width,l=s===void 0?1:s,f=t.height,d=f===void 0?1:f,S=t.raisingHeight,O=S===void 0?0:S,Z=1;return(this.mapService.version==="GAODE2.x"||this.mapService.version==="GAODE1.x")&&(Z=-1),this.radian=Z*Math.PI*(this.mapService.getRotation()%360)/180,{u_raisingHeight:Number(O),u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_opacity:a||1,u_texture:this.texture,u_size:[l,d]}}},{key:"clearModels",value:function(){var t;(t=this.texture)===null||t===void 0||t.destroy()}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U;return Ze().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=s.drawCanvas,Z=this.rendererService.createTexture2D,this.texture=Z({height:0,width:0}),O&&this.updateTexture(O),le.next=6,this.layer.buildLayerModel({moduleName:"geometryBillboard",vertexShader:h4,fragmentShader:f4,triangulation:this.planeGeometryTriangulation,primitive:Ve.TRIANGLES,depth:{enable:!0},blend:this.getBlend(),stencil:yu(f,S)});case 6:return U=le.sent,le.abrupt("return",[U]);case 8:case"end":return le.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"updateTexture",value:function(t){var a=this.rendererService.createTexture2D,s=this.layer.getLayerConfig(),l=s.canvasWidth,f=l===void 0?1:l,d=s.canvasHeight,S=d===void 0?1:d,O=document.createElement("canvas");O.width=f,O.height=S;var Z=O.getContext("2d");Z&&(t(O),this.texture=a({data:O,width:O.width,height:O.height,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE}),this.layerService.reRender())}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Da.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f){var d=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],S=f%4*3;return[d[S],d[S+1],d[S+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[2],l[3]]}}})}}]),r}(il);function d4(e){var i=v4();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function v4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var m4=`
uniform sampler2D u_texture;
uniform float u_mapFlag;
uniform float u_opacity;

varying vec3 v_Color;
varying vec2 v_uv;
varying float v_clip;

#pragma include "picking"
void main() {
  // gl_FragColor = vec4(v_Color, u_opacity);
  if(u_mapFlag > 0.0) {
    gl_FragColor = texture2D(u_texture, vec2(v_uv.x, 1.0 - v_uv.y));
    gl_FragColor.a *= u_opacity;
  } else {
    // gl_FragColor = vec4(v_uv, 0.0, u_opacity);
    gl_FragColor = vec4(v_Color, u_opacity);
  }
  gl_FragColor.a *= v_clip;
  gl_FragColor = filterColor(gl_FragColor);
}
`,g4=`precision highp float;
uniform mat4 u_ModelMatrix;

uniform mat4 u_Mvp;
uniform float u_opacity;
uniform float u_terrainClipHeight;

attribute vec3 a_Position;
attribute vec2 a_Uv;
attribute vec3 a_Color;

varying vec3 v_Color;
varying vec2 v_uv;
varying float v_clip;

#pragma include "projection"
#pragma include "picking"
void main() {
   v_Color = a_Color;
   v_uv = a_Uv;
  
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   v_clip = 1.0;
   if(a_Position.z < u_terrainClipHeight) {
      v_clip = 0.0;
   }
  
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));

   // float x = 1.0;
   // float y = 0.0;
   // float z = 0.0;
   // mat3 translateMatrix = mat3(
   //    1.0, 0.0, 0.0 
   //    0.0, 1.0, 0.0
   //    -project_pos.x,    -project_pos.y,  1.0
   // );
   //  mat4 translateMatrix = mat4(
   //    1.0, 0.0, 0.0, 0.0 ,
   //    0.0, 1.0, 0.0, 0.0,
   //    0.0, 0.0, 1.0, 0.0,
   //    1.0, 0.0, 0.0, 1.0
   // );

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy, a_Position.z, 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, a_Position.z, 1.0));
   }

   setPickingColor(a_PickingColor);
}
`,y4=function(e){(0,Ft.Z)(r,e);var i=d4(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"terrainImageLoaded",!1),(0,V.Z)((0,ct.Z)(n),"planeGeometryTriangulation",function(){var l,f=n.layer.getLayerConfig(),d=f.width,S=d===void 0?1:d,O=f.height,Z=O===void 0?1:O,U=f.widthSegments,se=U===void 0?1:U,le=f.heightSegments,ye=le===void 0?1:le,Be=f.center,rt=Be===void 0?[120,30]:Be,Je=f.terrainTexture,Ot=(l=n).initPlane.apply(l,[S,Z,se,ye].concat((0,oe.Z)(rt))),jt=Ot.indices,dr=Ot.positions;return Je&&n.loadTerrainTexture(dr,jt),{vertices:dr,indices:jt,size:5}}),n}return(0,he.Z)(r,[{key:"initPlane",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:120,d=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,S=t/2,O=a/2,Z=Math.floor(s),U=Math.floor(l),se=Z+1,le=U+1,ye=t/Z,Be=a/U,rt=[],Je=[],Ot=0;Ot<le;Ot++)for(var jt=Ot*Be-O,dr=0;dr<se;dr++){var Lr=dr*ye-S;if(this.mapService.version===ah["GAODE2.x"]){var jr=this.mapService.lngLatToCoord([Lr+f,-jt+d]),Jr=(0,Ja.Z)(jr,2),Pn=Jr[0],In=Jr[1];Je.push(Pn,In,0)}else Je.push(Lr+f,-jt+d,0);Je.push(dr/Z),Je.push(1-Ot/U)}for(var Si=0;Si<U;Si++)for(var ra=0;ra<Z;ra++){var Va=ra+se*Si,Ms=ra+se*(Si+1),vu=ra+1+se*(Si+1),Bu=ra+1+se*Si;rt.push(Va,Ms,Bu),rt.push(Ms,vu,Bu)}return{indices:rt,positions:Je}}},{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=t.mapTexture,l=t.terrainClipHeight,f=l===void 0?0:l,d=t.terrainTexture;if(this.mapTexture!==s){var S;this.mapTexture=s,(S=this.texture)===null||S===void 0||S.destroy(),this.updateTexture(s)}return{u_opacity:a||1,u_mapFlag:s?1:0,u_terrainClipHeight:d?f:-1,u_texture:this.texture}}},{key:"clearModels",value:function(){var t;this.terrainImage=null,(t=this.texture)===null||t===void 0||t.destroy()}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U;return Ze().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=s.mapTexture,this.mapTexture=O,Z=this.rendererService.createTexture2D,this.texture=Z({height:0,width:0}),this.updateTexture(O),le.next=7,this.layer.buildLayerModel({moduleName:"geometryPlane",vertexShader:g4,fragmentShader:m4,triangulation:this.planeGeometryTriangulation,primitive:Ve.TRIANGLES,depth:{enable:!0},stencil:yu(f,S),blend:this.getBlend(),cull:{enable:!0,face:Ve.BACK}});case 7:return U=le.sent,le.abrupt("return",[U]);case 9:case"end":return le.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"createModelData",value:function(t){if(t){var a=this.layer.getLayerConfig(),s=a.widthSegments,l=a.heightSegments,f=a.width,d=a.height,S=t,O=S.widthSegments,Z=S.heightSegments,U=S.width,se=S.height;this.layer.style({widthSegments:O!==void 0?O:s,heightSegments:Z!==void 0?Z:l,width:U!==void 0?U:f,height:se!==void 0?se:d})}var le=this.layer.getEncodedData(),ye=this.styleAttributeService.createAttributesAndIndices(le,this.planeGeometryTriangulation);return ye}},{key:"updateTexture",value:function(t){var a=this,s=this.rendererService.createTexture2D;if(t){var l=new Image;l.crossOrigin="anonymous",l.onload=function(){a.texture=s({data:l,width:l.width,height:l.height,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE}),a.layerService.reRender()},l.src=t}else this.texture=s({width:0,height:0})}},{key:"getImageData",value:function(t){var a=document.createElement("canvas"),s=a.getContext("2d"),l=t.width,f=t.height;a.width=l,a.height=f,s.drawImage(t,0,0,l,f);var d=s.getImageData(0,0,l,f);return d}},{key:"translateVertex",value:function(t,a,s,l,f,d){for(var S=s.width,O=s.height,Z=this.getImageData(s).data,U=Math.floor(l),se=Math.floor(f),le=U+1,ye=se+1,Be=S/U,rt=O/se,Je=0;Je<ye;Je++)for(var Ot=Math.floor(Je*rt),jt=Ot*S,dr=0;dr<le;dr++){var Lr=Math.floor(dr*Be),jr=(jt+Lr)*4,Jr=Z[jr],Pn=Z[jr+1],In=Z[jr+2],Si=(Je*le+dr)*5+2;t[Si]=d(Jr,Pn,In)}var ra=this.layer.getEncodedData(),Va=this.styleAttributeService.createAttributesAndIndices(ra,function(){return{vertices:t,indices:a,size:5}});this.layer.updateModelData(Va),this.layerService.throttleRenderLayers()}},{key:"loadTerrainTexture",value:function(t,a){var s=this,l=this.layer.getLayerConfig(),f=l.widthSegments,d=f===void 0?1:f,S=l.heightSegments,O=S===void 0?1:S,Z=l.terrainTexture,U=l.rgb2height,se=U===void 0?function(ye,Be,rt){return ye+Be+rt}:U;if(this.terrainImage)this.terrainImageLoaded?this.translateVertex(t,a,this.terrainImage,d,O,se):this.terrainImage.onload=function(){s.translateVertex(t,a,s.terrainImage,d,O,se)};else{var le=new Image;this.terrainImage=le,le.crossOrigin="anonymous",le.onload=function(){s.terrainImageLoaded=!0,setTimeout(function(){return s.layer.emit("terrainImageLoaded",null)}),s.translateVertex(t,a,le,d,O,se)},le.src=Z}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(il);function _4(e){var i=x4();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function x4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var b4=`
uniform sampler2D u_texture;
uniform float u_mapFlag;
uniform float u_opacity;

varying vec3 v_Color;
varying float v_d;

void main() {

  if(v_d < 0.0) {
    discard;
  }

  if(u_mapFlag > 0.0) {
    gl_FragColor = texture2D(u_texture, gl_PointCoord);
    gl_FragColor.a *= u_opacity;
  } else {
    gl_FragColor = vec4(v_Color, u_opacity);
  }
}
`,E4=`precision highp float;

attribute vec3 a_Position;
attribute vec3 a_Color;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_opacity;
uniform float u_Scale;
varying vec3 v_Color;
varying float v_d;

#pragma include "projection"
void main() {
   v_Color = a_Color;
  
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   v_d = a_Position.z;

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy, a_Position.z, 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, a_Position.z, 1.0));
   }

   gl_PointSize = pow((u_Zoom - 1.0), 2.0) * u_Scale;
}
`,Wm;(function(e){e.UP="up",e.DOWN="down"})(Wm||(Wm={}));var w4=function(e){(0,Ft.Z)(r,e);var i=_4(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"planeGeometryUpdateTriangulation",function(){for(var l=n.layer.getLayerConfig(),f=l.spriteBottom,d=f===void 0?-1e5:f,S=n.spriteUpdate,O=d,Z=n.spriteTop,U=0;U<n.positions.length;U+=5)n.spriteAnimate===Wm.UP?(n.positions[U+2]+=S,n.positions[U+2]>Z&&(n.positions[U+2]=O)):(n.positions[U+2]-=S,n.positions[U+2]<O&&(n.positions[U+2]=Z));return{vertices:n.positions,indices:n.indices,size:5}}),(0,V.Z)((0,ct.Z)(n),"updateModel",function(){var l=n.layer.createAttributes({triangulation:n.planeGeometryUpdateTriangulation});n.layer.models.map(function(f){f.updateAttributes(l)}),n.layerService.throttleRenderLayers(),n.timer=requestAnimationFrame(n.updateModel)}),(0,V.Z)((0,ct.Z)(n),"planeGeometryTriangulation",function(){var l,f=n.layer.getLayerConfig(),d=f.center,S=d===void 0?[120,30]:d,O=f.spriteCount,Z=O===void 0?100:O,U=f.spriteRadius,se=U===void 0?10:U,le=(l=n).initSprite.apply(l,[se,Z].concat((0,oe.Z)(S))),ye=le.indices,Be=le.positions;return n.positions=Be,n.indices=ye,{vertices:Be,indices:ye,size:5}}),n}return(0,he.Z)(r,[{key:"initSprite",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:120,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:30,f=[],d=[],S=this.mapService,O=this.spriteAnimate===Wm.UP?-this.spriteTop:this.spriteTop,Z=0;Z<a;Z++){var U=Math.random()*O;d.push.apply(d,(0,oe.Z)(le(U)))}for(var se=0;se<a;se++)f.push(se);function le(ye){var Be=t*Math.random(),rt=t*Math.random(),Je=-t/2+Be,Ot=-t/2+rt;if(S.version===ah["GAODE2.x"]){var jt=S.lngLatToCoord([Je+s,-Ot+l]),dr=(0,Ja.Z)(jt,2),Lr=dr[0],jr=dr[1];return[Lr,jr,ye,0,0]}else return[Je+s,-Ot+l,ye,0,0]}return{indices:f,positions:d}}},{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=t.mapTexture,l=t.spriteScale,f=l===void 0?1:l;if(this.mapTexture!==s){var d;this.mapTexture=s,(d=this.texture)===null||d===void 0||d.destroy(),this.updateTexture(s)}return{u_opacity:a||1,u_mapFlag:s?1:0,u_texture:this.texture,u_Scale:f}}},{key:"clearModels",value:function(){var t;cancelAnimationFrame(this.timer),(t=this.texture)===null||t===void 0||t.destroy()}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s=this,l,f,d,S,O,Z,U,se,le,ye;return Ze().wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:return l=this.layer.getLayerConfig(),f=l.mapTexture,d=l.spriteTop,S=d===void 0?5e6:d,O=l.spriteUpdate,Z=O===void 0?1e4:O,U=l.spriteAnimate,se=U===void 0?Wm.DOWN:U,this.mapTexture=f,this.spriteTop=S,this.spriteUpdate=Z,se==="up"?this.spriteAnimate=Wm.UP:this.spriteAnimate=Wm.DOWN,le=this.rendererService.createTexture2D,this.texture=le({height:0,width:0}),this.updateTexture(f),setTimeout(function(){s.updateModel()},100),rt.next=11,this.layer.buildLayerModel({moduleName:"geometrySprite",vertexShader:E4,fragmentShader:b4,triangulation:this.planeGeometryTriangulation,primitive:Ve.POINTS,depth:{enable:!1},blend:this.getBlend()});case 11:return ye=rt.sent,rt.abrupt("return",[ye]);case 13:case"end":return rt.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"updateTexture",value:function(t){var a=this,s=this.rendererService.createTexture2D;if(t){var l=new Image;l.crossOrigin="anonymous",l.onload=function(){a.texture=s({data:l,width:l.width,height:l.height,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE}),a.layerService.reRender()},l.src=t}else this.texture=s({width:0,height:0})}},{key:"registerBuiltinAttributes",value:function(){return""}}]),r}(il),S4={plane:y4,sprite:w4,billboard:p4},C4=S4;function A4(e){var i=T4();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function T4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var M4=function(e){(0,Ft.Z)(r,e);var i=A4(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","GeometryLayer"),(0,V.Z)((0,ct.Z)(n),"defaultSourceConfig",{data:[{x:0,y:0}],options:{parser:{type:"json",x:"x",y:"y"}}}),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel=new C4[s](this),f.next=4,this.initLayerModels();case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),a={plane:{},sprite:{},billboard:{}};return a[t]}},{key:"getModelType",value:function(){var t,a=this.styleAttributeService.getLayerStyleAttribute("shape"),s=a==null||(t=a.scale)===null||t===void 0?void 0:t.field;return s==="plane"?"plane":s==="sprite"?"sprite":s==="billboard"?"billboard":"plane"}}]),r}(Dd);function P4(e){var i=O4();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function O4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var I4=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
uniform mat4 u_Mvp;\r
varying vec4 v_color;\r
\r
uniform vec2 u_SceneCenterMKT;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  // vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  // gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\r
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807\r
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));\r
    gl_Position = u_Mvp * (project_pos);\r
  } else {\r
     vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
    gl_Position = project_common_position_to_clipspace(project_pos);\r
  }\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,L4=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,R4=function(e){(0,Ft.Z)(r,e);var i=P4(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=t.coverage,l=t.angle;return{u_opacity:a||1,u_coverage:s||.9,u_angle:l||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,U.next=3,this.layer.buildLayerModel({moduleName:"heatmapGrid",vertexShader:I4,fragmentShader:L4,triangulation:fC,primitive:Ve.TRIANGLES,depth:{enable:!1},stencil:yu(f,S)});case 3:return O=U.sent,U.abrupt("return",[O]);case 5:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:Da.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a){var s=a.version==="GAODE2.x"?a.originCoordinates:a.coordinates;return[s[0],s[1],0]}}})}}]),r}(il);function k4(e){var i=D4();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function D4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var F4=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"


void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));


  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
 
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u7ECF\u7EAC\u5EA6
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT; // \u5C06\u7ECF\u7EAC\u5EA6\u8F6C\u6362\u4E3A\u9AD8\u5FB72.0\u9700\u8981\u7684\u5E73\u9762\u5750\u6807
    vec4 project_pos = project_position(vec4(customLnglat, a_Position.z * a_Size, 1.0));

    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
  
    gl_Position = u_Mvp * vec4(customLnglat , a_Position.z * a_Size, 1.0);
  } else {
    vec2 lnglat = unProjectFlat(a_Pos.xy + offset); // \u5B9E\u9645\u7684\u7ECF\u7EAC\u5EA6
    vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
    
    float lightWeight = calc_lighting(project_pos);
    v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);
    
    gl_Position = project_common_position_to_clipspace(project_pos);
  }



  setPickingColor(a_PickingColor);
}
`,B4=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,N4=function(e){(0,Ft.Z)(r,e);var i=k4(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=t.coverage,l=t.angle;return{u_opacity:a||1,u_coverage:s||1,u_angle:l||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,U.next=3,this.layer.buildLayerModel({moduleName:"heatmapGrid3d",vertexShader:F4,fragmentShader:B4,triangulation:mw,primitive:Ve.TRIANGLES,depth:{enable:!0},blend:this.getBlend(),stencil:yu(f,S)});case 3:return O=U.sent,U.abrupt("return",[O]);case 5:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.size;return Array.isArray(s)?[s[0]]:[s]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f,d){return d}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Da.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a){var s=a.version==="GAODE2.x"?a.originCoordinates:a.coordinates;return[s[0],s[1],0]}}})}}]),r}(il);function z4(e,i){for(var r=[],n=[],t=[],a=e+1,s=i+1,l=e/2,f=i/2,d=0;d<s;d++)for(var S=d-f,O=0;O<a;O++){var Z=O-l;n.push(Z/l,-S/f,0),t.push(O/e),t.push(1-d/i)}for(var U=0;U<i;U++)for(var se=0;se<e;se++){var le=se+a*U,ye=se+a*(U+1),Be=se+1+a*(U+1),rt=se+1+a*U;r.push(le,ye,rt),r.push(ye,Be,rt)}return{vertices:n,indices:r,uvs:t}}var dC,vC;function Z4(e){var i=U4();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function U4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var j4=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;
}
`,V4=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;


vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos = a_Uv * vec2(2.0) - vec2(1.0); // \u5C06\u539F\u672C 0 -> 1 \u7684 uv \u8F6C\u6362\u4E3A -1 -> 1 \u7684\u6807\u51C6\u5750\u6807\u7A7A\u95F4\uFF08NDC\uFF09

  vec4 p1 = vec4(pos, 0.0, 1.0); // x/y \u5E73\u9762\u4E0A\u7684\u70B9\uFF08z == 0\uFF09\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4E09\u7EF4\u4E0A\u7684\u70B9\u88AB\u6295\u5F71\u5230\u5E73\u9762\u540E\u7684\u70B9
	vec4 p2 = vec4(pos, 1.0, 1.0); // \u5E73\u884C\u4E8Ex/y\u5E73\u9762\u3001z==1 \u7684\u5E73\u9762\u4E0A\u7684\u70B9

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1; // \u6839\u636E\u89C6\u56FE\u6295\u5F71\u77E9\u9635\u7684\u9006\u77E9\u9635\u5E73\u9762\u4E0A\u7684\u53CD\u7B97\u51FA\u4E09\u7EF4\u7A7A\u95F4\u4E2D\u7684\u70B9\uFF08p1\u5E73\u9762\u4E0A\u7684\u70B9\uFF09
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w; // \u5F52\u4E00\u5316\u64CD\u4F5C\uFF08\u5F52\u4E00\u5316\u540E\u4E3A\u4E16\u754C\u5750\u6807\uFF09
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z); // ??
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0.0, 1.0, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);
 
}
`,H4=`uniform sampler2D u_texture;        // \u70ED\u529B\u5F3A\u5EA6\u56FE
uniform sampler2D u_colorTexture;   // \u6839\u636E\u5F3A\u5EA6\u5206\u5E03\u7684\u8272\u5E26
uniform float u_opacity;
varying vec2 v_texCoord;

uniform vec2 u_ViewportSize;

float getBlurIndusty() {
    float vW = 2.0/u_ViewportSize.x;
    float vH = 2.0/u_ViewportSize.y;
    vec2 vUv = v_texCoord;
    float i11 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y + 1.0 * vH) ).r;
    float i12 = texture2D( u_texture, vec2( vUv.x - 0.0 * vW, vUv.y + 1.0 * vH) ).r;
    float i13 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y + 1.0 * vH) ).r;

    float i21 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y) ).r;
    float i22 = texture2D( u_texture, vec2( vUv.x , vUv.y) ).r;
    float i23 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y) ).r;

    float i31 = texture2D( u_texture, vec2( vUv.x - 1.0 * vW, vUv.y-1.0*vH) ).r;
    float i32 = texture2D( u_texture, vec2( vUv.x - 0.0 * vW, vUv.y-1.0*vH) ).r;
    float i33 = texture2D( u_texture, vec2( vUv.x + 1.0 * vW, vUv.y-1.0*vH) ).r;

    return(
        i11 + 
        i12 + 
        i13 + 
        i21 + 
        i21 + 
        i22 + 
        i23 + 
        i31 + 
        i32 + 
        i33
        )/9.0;
}


void main(){
    // float intensity = texture2D(u_texture, v_texCoord).r;
    float intensity = getBlurIndusty();
    vec4 color = texture2D(u_colorTexture, vec2(intensity, 0.0));

    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,G4=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;

void main() {
  v_texCoord = a_Uv;

  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,$4=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,W4=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 2.5;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
        gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
        gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
}
`,mC=(dC=(0,Xr.b2)(),dC(vC=function(e){(0,Ft.Z)(r,e);var i=Z4(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"render",value:function(){var t=this,a=this.rendererService,s=a.clear,l=a.useFramebuffer;l(this.heatmapFramerBuffer,function(){s({color:[0,0,0,0],depth:1,stencil:0,framebuffer:t.heatmapFramerBuffer}),t.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le;return Ze().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return l=this.rendererService,f=l.createFramebuffer,d=l.getViewportSize,S=l.createTexture2D,O=this.styleAttributeService.getLayerStyleAttribute("shape"),Z=(O==null||(s=O.scale)===null||s===void 0?void 0:s.field)||"heatmap",this.shapeType=Z,Be.next=6,this.buildHeatMapIntensity();case 6:return this.intensityModel=Be.sent,this.colorModel=Z==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap(),U=d(),se=U.width,le=U.height,this.heatmapFramerBuffer=f({color:S({width:Math.floor(se/4),height:Math.floor(le/4),wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE,min:Ve.LINEAR,mag:Ve.LINEAR}),depth:!1}),this.updateColorTexture(),Be.abrupt("return",[this.intensityModel,this.colorModel]);case 12:case"end":return Be.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:Da.Attribute,descriptor:{name:"a_Dir",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?1:s;return[l]}}})}},{key:"buildHeatMapIntensity",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.layer.triangulation=hC,f.next=3,this.layer.buildLayerModel({moduleName:"heatmapIntensity",vertexShader:W4,fragmentShader:$4,triangulation:hC,depth:{enable:!1},cull:{enable:!0,face:up(this.mapService.version)},blend:{enable:!0,func:{srcRGB:Ve.ONE,srcAlpha:1,dstRGB:Ve.ONE,dstAlpha:1}}});case 3:return s=f.sent,f.abrupt("return",s);case 5:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildHeatmapColor",value:function(){var t=this.layer.getLayerConfig(),a=t.mask,s=a===void 0?!1:a,l=t.maskInside,f=l===void 0?!0:l;this.shaderModuleService.registerModule("heatmapColor",{vs:G4,fs:H4});var d=this.shaderModuleService.getModule("heatmapColor"),S=d.vs,O=d.fs,Z=d.uniforms,U=this.rendererService,se=U.createAttribute,le=U.createElements,ye=U.createBuffer,Be=U.createModel;return Be({vs:S,fs:O,attributes:{a_Position:se({buffer:ye({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:Ve.FLOAT}),size:3}),a_Uv:se({buffer:ye({data:[0,1,1,1,0,0,1,0],type:Ve.FLOAT}),size:2})},uniforms:(0,ue.Z)({},Z),depth:{enable:!1},blend:this.getBlend(),elements:le({data:[0,2,1,2,3,1],type:Ve.UNSIGNED_INT,count:6}),stencil:yu(s,f)})}},{key:"drawIntensityMode",value:function(){var t,a=this.layer.getLayerConfig(),s=a.opacity,l=a.intensity,f=l===void 0?10:l,d=a.radius,S=d===void 0?5:d;this.layerService.beforeRenderData(this.layer),this.layer.hooks.beforeRender.call(),(t=this.intensityModel)===null||t===void 0||t.draw({uniforms:{u_opacity:s||1,u_radius:S,u_intensity:f}}),this.layer.hooks.afterRender.call()}},{key:"drawColorMode",value:function(){var t,a=this.layer.getLayerConfig(),s=a.opacity;(t=this.colorModel)===null||t===void 0||t.draw({uniforms:{u_opacity:s||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var t,a=this.layer.getLayerConfig(),s=a.opacity,l=rl();td(l,this.cameraService.getViewProjectionMatrixUncentered()),(t=this.colorModel)===null||t===void 0||t.draw({uniforms:{u_opacity:s||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:(0,oe.Z)(l)}})}},{key:"build3dHeatMap",value:function(){var t=this.layer.getLayerConfig(),a=t.mask,s=a===void 0?!1:a,l=t.maskInside,f=l===void 0?!0:l,d=this.rendererService.getViewportSize,S=d(),O=S.width,Z=S.height,U=z4(O/4,Z/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:V4,fs:j4});var se=this.shaderModuleService.getModule("heatmap3dColor"),le=se.vs,ye=se.fs,Be=se.uniforms,rt=this.rendererService,Je=rt.createAttribute,Ot=rt.createElements,jt=rt.createBuffer,dr=rt.createModel;return dr({vs:le,fs:ye,attributes:{a_Position:Je({buffer:jt({data:U.vertices,type:Ve.FLOAT}),size:3}),a_Uv:Je({buffer:jt({data:U.uvs,type:Ve.FLOAT}),size:2})},primitive:Ve.TRIANGLES,uniforms:(0,ue.Z)({},Be),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:Ve.SRC_ALPHA,srcAlpha:1,dstRGB:Ve.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:Ot({data:U.indices,type:Ve.UNSIGNED_INT,count:U.indices.length}),stencil:yu(s,f)})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var t=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var a=this.layer.getLayerConfig(),s=a.rampColors,l=Pl(s);this.colorTexture=t({data:new Uint8Array(l.data),width:l.width,height:l.height,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE,min:Ve.NEAREST,mag:Ve.NEAREST,flipY:!1})}}]),r}(il))||vC);function X4(e){var i=Y4();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Y4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var K4=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,q4=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform vec2 u_SceneCenterMKT;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
 
  // vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xy, 0., 1.0));
    // gl_Position = u_Mvp * (vec4(a_Pos.xy + offset, 0., 1.0));
    vec2 customLnglat = customProject(lnglat) - u_SceneCenterMKT;
    vec4 project_pos = project_position(vec4(customLnglat, 0, 1.0));
    gl_Position = u_Mvp * vec4(project_pos.xy, 0.0, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,Q4=function(e){(0,Ft.Z)(r,e);var i=X4(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=t.coverage,l=t.angle;return{u_opacity:a||1,u_coverage:s||.9,u_angle:l||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,U.next=3,this.layer.buildLayerModel({moduleName:"heatmapHexagon",vertexShader:q4,fragmentShader:K4,triangulation:fC,depth:{enable:!1},primitive:Ve.TRIANGLES,blend:this.getBlend(),stencil:yu(f,S)});case 3:return O=U.sent,U.abrupt("return",[O]);case 5:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:Da.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a){var s=a.version==="GAODE2.x"?a.originCoordinates:a.coordinates;return[s[0],s[1],0]}}})}}]),r}(il),J4={heatmap:mC,heatmap3d:mC,grid:R4,grid3d:N4,hexagon:Q4},eP=J4;function tP(e){var i=rP();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function rP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var nP=function(e){(0,Ft.Z)(r,e);var i=tP(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","HeatMapLayer"),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel=new eP[s](this),f.next=4,this.initLayerModels();case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"renderModels",value:function(){var t=this,a=this.getModelType();return a==="heatmap"?(this.layerModel&&this.layerModel.render(),this):this.encodeDataLength<=0&&!this.forceRender?this:(this.hooks.beforeRender.call(),this.models.forEach(function(s){return s.draw({uniforms:t.layerModel.getUninforms()})}),this.hooks.afterRender.call(),this)}},{key:"updateModelData",value:function(t){t.attributes&&t.elements?this.models[0].updateAttributesAndElements(t.attributes,t.elements):console.warn("data error")}},{key:"getModelType",value:function(){var t,a=this.styleAttributeService.getLayerStyleAttribute("shape"),s=this.getLayerConfig(),l=s.shape3d,f=this.getSource(),d=f.data.type,S=(a==null||(t=a.scale)===null||t===void 0?void 0:t.field)||"heatmap";return S==="heatmap"||S==="heatmap3d"?"heatmap":d==="hexagon"?(l==null?void 0:l.indexOf(S))===-1?"hexagon":"grid3d":d==="grid"?(l==null?void 0:l.indexOf(S))===-1?"grid":"grid3d":"heatmap"}}]),r}(Dd);function iP(e){var i=aP();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function aP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var oP=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,sP=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,uP=function(e){(0,Ft.Z)(r,e);var i=iP(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity;return{u_opacity:a||1,u_texture:this.texture}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s=this,l,f,d,S,O,Z,U,se,le,ye,Be;return Ze().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(l=this.layer.getLayerConfig(),f=l.mask,d=f===void 0?!1:f,S=l.maskInside,O=S===void 0?!0:S,Z=this.layer.getSource(),U=this.rendererService.createTexture2D,this.texture=U({height:0,width:0}),!zs){Je.next=12;break}se=this.layerService.sceneService.getSceneConfig().canvas,le=se.createImage(),le.crossOrigin="anonymous",le.src=Z.data.originData,le.onload=function(){s.texture=U({data:le,width:le.width,height:le.height}),s.layerService.reRender()},Je.next=16;break;case 12:return Je.next=14,Z.data.images;case 14:ye=Je.sent,this.texture=U({data:ye[0],width:ye[0].width,height:ye[0].height,mag:Ve.LINEAR,min:Ve.LINEAR});case 16:return Je.next=18,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:sP,fragmentShader:oP,triangulation:r1,primitive:Ve.TRIANGLES,blend:{enable:!0},depth:{enable:!1},stencil:yu(d,O)});case 18:return Be=Je.sent,Je.abrupt("return",[Be]);case 20:case"end":return Je.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.texture)===null||t===void 0||t.destroy()}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(il),lP={image:uP},cP=lP;function fP(e){var i=hP();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function hP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var gC=function(e){(0,Ft.Z)(r,e);var i=fP(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","ImageLayer"),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel=new cP[s](this),f.next=4,this.initLayerModels();case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),a={image:{}};return a[t]}},{key:"getModelType",value:function(){return"image"}}]),r}(Dd);function pP(e){var i=dP();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function dP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vP=`
uniform float u_opacity;

varying vec4 v_dash_array;
varying vec4 v_color;

uniform float segmentNumber;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;

  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  };
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,mP=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;

  styleMappingMat[3].b = segmentIndex / segmentNumber;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  gl_PointSize = 5.0;
  setPickingColor(a_PickingColor);
}
`,gP=`
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  
  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = styleMappingMat[3].g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = styleMappingMat[3].a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
}`,yP=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  float arcThetaOffset = styleMappingMat[0][1];
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, arcThetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, arcThetaOffset), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
     styleMappingMat[3].g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,_P=`#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}`,xP=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,bP={solid:0,dash:1},EP=function(e){(0,Ft.Z)(r,e);var i=pP(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Ve.NEAREST,min:Ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.sourceColor,f=t.targetColor,d=t.textureBlend,S=d===void 0?"normal":d,O=t.lineType,Z=O===void 0?"solid":O,U=t.dashArray,se=U===void 0?[10,5]:U,le=t.forward,ye=le===void 0?!0:le,Be=t.lineTexture,rt=Be===void 0?!1:Be,Je=t.iconStep,Ot=Je===void 0?100:Je,jt=t.segmentNumber,dr=jt===void 0?30:jt,Lr=t.thetaOffset,jr=Lr===void 0?.314:Lr;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,thetaOffset:jr})){this.judgeStyleAttributes({opacity:s,thetaOffset:jr});var Jr=this.layer.getEncodedData(),Pn=this.calDataFrame(this.cellLength,Jr,this.cellProperties),In=Pn.data,Si=Pn.width,ra=Pn.height;this.rowCount=ra,this.dataTexture=this.cellLength>0&&In.length>0?this.createTexture2D({flipY:!0,data:In,format:Ve.LUMINANCE,type:Ve.FLOAT,width:Si,height:ra}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}se.length===2&&se.push(0,0);var Va=0,Ms=[0,0,0,0],vu=[0,0,0,0];return l&&f&&(Ms=Qi(l),vu=Qi(f),Va=1),this.rendererService.getDirty()&&this.texture.bind(),{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_thetaOffset:(0,Kn.isNumber)(jr)?jr:0,u_opacity:(0,Kn.isNumber)(s)?s:1,u_textureBlend:S==="normal"?0:1,segmentNumber:dr,u_line_type:bP[Z||"solid"],u_dash_array:se,u_blur:.9,u_lineDir:ye?1:-1,u_texture:this.texture,u_line_texture:rt?1:0,u_icon_step:Ot,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Va,u_sourceColor:Ms,u_targetColor:vu}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;(t=this.texture)===null||t===void 0||t.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),a=t.sourceColor,s=t.targetColor,l=t.lineType;return l==="dash"?{frag:vP,vert:mP,type:"Dash"}:a&&s?{frag:_P,vert:xP,type:"Linear"}:{frag:gP,vert:yP,type:""}}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye,Be;return Ze().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:return s=this.layer.getLayerConfig(),l=s.segmentNumber,f=l===void 0?30:l,d=s.mask,S=d===void 0?!1:d,O=s.maskInside,Z=O===void 0?!0:O,U=this.getShaders(),se=U.frag,le=U.vert,ye=U.type,Je.next=4,this.layer.buildLayerModel({moduleName:"lineArc2d"+ye,vertexShader:le,fragmentShader:se,triangulation:Mx,depth:{enable:!1},blend:this.getBlend(),segmentNumber:f,stencil:yu(S,Z)});case 4:return Be=Je.sent,Je.abrupt("return",[Be]);case 6:case"end":return Je.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.size,f=l===void 0?1:l;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Da.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:4,update:function(s,l,f){return[f[3],f[4],f[5],f[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s){var l=t.iconService.getIconMap(),f=s.texture,d=l[f]||{x:0,y:0},S=d.x,O=d.y;return[S,O]}}})}}]),r}(il);function wP(e){var i=SP();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function SP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var CP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,AP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,TP=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,MP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,PP={solid:0,dash:1},OP=function(e){(0,Ft.Z)(r,e);var i=wP(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Ve.NEAREST,min:Ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.sourceColor,f=t.targetColor,d=t.textureBlend,S=d===void 0?"normal":d,O=t.lineType,Z=O===void 0?"solid":O,U=t.dashArray,se=U===void 0?[10,5]:U,le=t.lineTexture,ye=le===void 0?!1:le,Be=t.iconStep,rt=Be===void 0?100:Be,Je=t.segmentNumber,Ot=Je===void 0?30:Je,jt=t.globalArcHeight,dr=jt===void 0?10:jt;se.length===2&&se.push(0,0);var Lr=0,jr=[0,0,0,0],Jr=[0,0,0,0];if(l&&f&&(jr=Qi(l),Jr=Qi(f),Lr=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var Pn=this.layer.getEncodedData(),In=this.calDataFrame(this.cellLength,Pn,this.cellProperties),Si=In.data,ra=In.width,Va=In.height;this.rowCount=Va,this.dataTexture=this.cellLength>0&&Si.length>0?this.createTexture2D({flipY:!0,data:Si,format:Ve.LUMINANCE,type:Ve.FLOAT,width:ra,height:Va}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:Jy,u_global_height:dr,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(s)?s:1,u_textureBlend:S==="normal"?0:1,segmentNumber:Ot,u_line_type:PP[Z]||0,u_dash_array:se,u_texture:this.texture,u_line_texture:ye?1:0,u_icon_step:rt,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Lr,u_sourceColor:jr,u_targetColor:Jr}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;(t=this.texture)===null||t===void 0||t.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),a=t.sourceColor,s=t.targetColor;return a&&s?{frag:TP,vert:MP,type:"Linear"}:{frag:CP,vert:AP,type:""}}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye,Be;return Ze().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:return s=this.layer.getLayerConfig(),l=s.segmentNumber,f=l===void 0?30:l,d=s.mask,S=d===void 0?!1:d,O=s.maskInside,Z=O===void 0?!0:O,U=this.getShaders(),se=U.frag,le=U.vert,ye=U.type,Je.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+ye,vertexShader:le,fragmentShader:se,triangulation:Mx,blend:this.getBlend(),segmentNumber:f,stencil:yu(S,Z)});case 4:return Be=Je.sent,Je.abrupt("return",[Be]);case 6:case"end":return Je.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.size,f=l===void 0?1:l;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Da.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:4,update:function(s,l,f){return[f[3],f[4],f[5],f[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s){var l=t.iconService.getIconMap(),f=s.texture,d=l[f]||{x:0,y:0},S=d.x,O=d.y;return[S,O]}}})}}]),r}(il);function IP(e){var i=LP();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function LP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var RP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,kP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,DP=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,FP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,BP={solid:0,dash:1},NP=function(e){(0,Ft.Z)(r,e);var i=IP(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Ve.NEAREST,min:Ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.sourceColor,f=t.targetColor,d=t.textureBlend,S=d===void 0?"normal":d,O=t.lineType,Z=O===void 0?"solid":O,U=t.dashArray,se=U===void 0?[10,5]:U,le=t.lineTexture,ye=le===void 0?!1:le,Be=t.iconStep,rt=Be===void 0?100:Be,Je=t.segmentNumber,Ot=Je===void 0?30:Je,jt=t.globalArcHeight,dr=jt===void 0?10:jt;se.length===2&&se.push(0,0);var Lr=0,jr=[0,0,0,0],Jr=[0,0,0,0];if(l&&f&&(jr=Qi(l),Jr=Qi(f),Lr=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var Pn=this.layer.getEncodedData(),In=this.calDataFrame(this.cellLength,Pn,this.cellProperties),Si=In.data,ra=In.width,Va=In.height;this.rowCount=Va,this.dataTexture=this.cellLength>0&&Si.length>0?this.createTexture2D({flipY:!0,data:Si,format:Ve.LUMINANCE,type:Ve.FLOAT,width:ra,height:Va}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_globel:1,u_globel_radius:Jy,u_global_height:dr,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(s)?s:1,u_textureBlend:S==="normal"?0:1,segmentNumber:Ot,u_line_type:BP[Z]||0,u_dash_array:se,u_texture:this.texture,u_line_texture:ye?1:0,u_icon_step:rt,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Lr,u_sourceColor:jr,u_targetColor:Jr}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;(t=this.texture)===null||t===void 0||t.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),a=t.sourceColor,s=t.targetColor;return a&&s?{frag:DP,vert:FP,type:"Linear"}:{frag:RP,vert:kP,type:""}}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye,Be;return Ze().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:return s=this.layer.getLayerConfig(),l=s.segmentNumber,f=l===void 0?30:l,d=s.mask,S=d===void 0?!1:d,O=s.maskInside,Z=O===void 0?!0:O,U=this.getShaders(),se=U.frag,le=U.vert,ye=U.type,Je.next=4,this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+ye,vertexShader:le,fragmentShader:se,triangulation:Mx,depth:{enable:!0},blend:this.getBlend(),segmentNumber:f,stencil:yu(S,Z)});case 4:return Be=Je.sent,Je.abrupt("return",[Be]);case 6:case"end":return Je.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.size,f=l===void 0?1:l;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Da.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:4,update:function(s,l,f){return[f[3],f[4],f[5],f[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s){var l=t.iconService.getIconMap(),f=s.texture,d=l[f]||{x:0,y:0},S=d.x,O=d.y;return[S,O]}}})}}]),r}(il);function zP(e){var i=ZP();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function ZP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var UP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0;
  float d_segmentIndex = styleMappingMat[3].g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = gl_FragColor.a/opacity;
    }

    float v = styleMappingMat[3].a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,jP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  styleMappingMat[3].g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,VP={solid:0,dash:1},HP=function(e){(0,Ft.Z)(r,e);var i=zP(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Ve.NEAREST,min:Ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.sourceColor,f=t.targetColor,d=t.textureBlend,S=d===void 0?"normal":d,O=t.lineType,Z=O===void 0?"solid":O,U=t.dashArray,se=U===void 0?[10,5]:U,le=t.lineTexture,ye=le===void 0?!1:le,Be=t.iconStep,rt=Be===void 0?100:Be,Je=t.segmentNumber,Ot=Je===void 0?30:Je;se.length===2&&se.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var jt=0,dr=[0,0,0,0],Lr=[0,0,0,0];if(l&&f&&(dr=Qi(l),Lr=Qi(f),jt=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var jr=this.layer.getEncodedData(),Jr=this.calDataFrame(this.cellLength,jr,this.cellProperties),Pn=Jr.data,In=Jr.width,Si=Jr.height;this.rowCount=Si,this.dataTexture=this.cellLength>0&&Pn.length>0?this.createTexture2D({flipY:!0,data:Pn,format:Ve.LUMINANCE,type:Ve.FLOAT,width:In,height:Si}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(s)?s:1,u_textureBlend:S==="normal"?0:1,segmentNumber:Ot,u_line_type:VP[Z]||0,u_dash_array:se,u_texture:this.texture,u_line_texture:ye?1:0,u_icon_step:rt,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:jt,u_sourceColor:dr,u_targetColor:Lr}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;(t=this.texture)===null||t===void 0||t.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,U.next=3,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:jP,fragmentShader:UP,triangulation:Mx,depth:{enable:!1},blend:this.getBlend(),stencil:yu(f,S)});case 3:return O=U.sent,U.abrupt("return",[O]);case 5:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.size,f=l===void 0?1:l;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Da.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:4,update:function(s,l,f){return[f[3],f[4],f[5],f[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s){var l=t.iconService.getIconMap(),f=s.texture,d=l[f]||{x:0,y:0},S=d.x,O=d.y;return[S,O]}}})}}]),r}(il);function GP(e){var i=$P();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function $P(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var WP=`#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0
uniform float u_CoordinateSystem;
varying vec4 v_color;
uniform float u_arrow: 0.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

varying mat4 styleMappingMat;
void main() {
  float distanceAndIndex = styleMappingMat[0][3];
  float miter = styleMappingMat[0][2];

  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B


  if(u_arrow > 0.0 && distanceAndIndex < 2.0) { // arrow
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) { 
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z < 0.0) { // amap
        discard;
      }
    } else { // amap2 mapbox map
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z > 0.0) { 
        discard;
      }
    }
  } else { // line body
    if(miter < 0.0) {
      discard;
    }
  }


  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,XP=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute vec4 a_dirPoints;
attribute vec3 a_DistanceAndIndex;

uniform vec4 u_lineDir;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - a_Miter - a_DistanceAndIndex
    0.0, 0.0, 0.0, 0.0, // originX - originY - vectorX - vectorY
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );
  styleMappingMat[0][3] = a_DistanceAndIndex.y;
  styleMappingMat[0][2] = a_Miter;

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97


  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  // styleMappingMat[1].rg = a_Position.xy + offset;

  vec2 copyOffset = vec2(offset.x, offset.y);

  float lineDistance = a_DistanceAndIndex.x;
  float total_Distance = a_DistanceAndIndex.z;
  float currentLinePointRatio = lineDistance / total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z); // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }
  
  if(u_arrow > 0.0 && a_DistanceAndIndex.y < 2.0) {
    vec2 startPoint = a_dirPoints.rg;
    vec2 endPoint = a_dirPoints.ba;
    vec4 t1 = project_position(vec4(startPoint, 0, 1.0));
    vec4 t2 = project_position(vec4(endPoint, 0, 1.0));
    // TODO\uFF1A \u540E\u7EED\u4F18\u5316\u53EF\u4EE5\u628A\u4F4D\u7F6E\u8BA1\u7B97\u653E\u5728 cpu \u4E2D\u5B8C\u6210
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      vec2 p1 = (u_Mvp * vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = (u_Mvp * vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    } else {
      vec2 p1 = project_common_position_to_clipspace(vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = project_common_position_to_clipspace(vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    }
  }

  setPickingColor(a_PickingColor);
}
`,YP=function(e){(0,Ft.Z)(r,e);var i=GP(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.sourceColor,f=t.targetColor,d=t.arrow,S=d===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:d,O=0,Z=[0,0,0,0],U=[0,0,0,0];if(l&&f&&(Z=Qi(l),U=Qi(f),O=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var se=this.layer.getEncodedData(),le=this.calDataFrame(this.cellLength,se,this.cellProperties),ye=le.data,Be=le.width,rt=le.height;this.rowCount=rt,this.dataTexture=this.cellLength>0&&ye.length>0?this.createTexture2D({flipY:!0,data:ye,format:Ve.LUMINANCE,type:Ve.FLOAT,width:Be,height:rt}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(s)?s:1,u_linearColor:O,u_sourceColor:Z,u_targetColor:U,u_arrow:Number(S.enable),u_arrowHeight:S.arrowHeight||3,u_arrowWidth:S.arrowWidth||2,u_tailWidth:S.tailWidth===void 0?1:S.tailWidth}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.dataTexture)===null||t===void 0||t.destroy()}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye;return Ze().wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=s.depth,Z=O===void 0?!1:O,U=this.getShaders(),se=U.frag,le=U.vert,this.layer.triangulation=t1,rt.next=5,this.layer.buildLayerModel({moduleName:"lineHalf",vertexShader:le,fragmentShader:se,triangulation:t1,depth:{enable:Z},blend:this.getBlend(),stencil:yu(f,S)});case 5:return ye=rt.sent,rt.abrupt("return",[ye]);case 7:case"end":return rt.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getShaders",value:function(){return{frag:WP,vert:XP,type:"normal"}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Da.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f,d,S){return S===void 0?[l[3],10,l[5]]:[l[3],S,l[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"dirPoints",type:Da.Attribute,descriptor:{name:"a_dirPoints",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:4,update:function(a){var s=a.coordinates[0]||[0,0],l=a.coordinates[3]||[0,0];return[s[0],s[1],l[0],l[1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0],l[1]]:[l,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f,d){return d}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Da.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a,s,l){return[l[4]]}}})}}]),r}(il);function KP(e){var i=qP();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function qP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var QP=`#define LineTypeSolid 0.0
uniform float u_opacity : 1.0;

varying vec4 v_color;

// dash
varying vec4 v_dash_array;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
 
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    // \u5B9E\u7EBF\u90E8\u5206
  } else {
    // \u865A\u7EBF\u90E8\u5206
    discard;
  };

  gl_FragColor = filterColor(gl_FragColor);
}
`,JP=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_DistanceAndIndex.x / a_Total_Distance; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_DistanceAndIndex.x;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));
  } else {
    float lineHeight = a_Size.y;
 
    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,eO=`#define Animate 0.0
#define LineTexture 1.0
uniform float u_opacity : 1.0;
uniform float u_textureBlend;

uniform float u_borderWidth: 0.0;

uniform vec3 u_blur;
uniform vec4 u_borderColor;
varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying vec2 v_iconMapUV;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = styleMappingMat[3].a;
  float borderWidth = min(0.5, u_borderWidth);
  // \u7ED8\u5236 border
  if(borderWidth > 0.01) {
    float borderOuterWidth = borderWidth/2.0;

    if(v >= 1.0 - borderWidth || v <= borderWidth) {
      if(v > borderWidth) {
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);
      } else if(v <= borderWidth) {
        float linear = smoothstep(0.0, 1.0, v/borderWidth);
        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = styleMappingMat[3][3];
  if(blurV < 0.5) {
    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  gl_FragColor = filterColor(gl_FragColor);
}
`,yC=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,tO=`varying vec4 v_color;
uniform float u_linearDir: 1.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3][0]; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,rO={solid:0,dash:1},_C=function(e){(0,Ft.Z)(r,e);var i=KP(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"textureEventFlag",!1),(0,V.Z)((0,ct.Z)(n),"texture",n.createTexture2D({data:[0,0,0,0],mag:Ve.NEAREST,min:Ve.NEAREST,premultiplyAlpha:!1,width:1,height:1})),(0,V.Z)((0,ct.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Ve.NEAREST,min:Ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.sourceColor,f=t.targetColor,d=t.textureBlend,S=d===void 0?"normal":d,O=t.lineType,Z=O===void 0?"solid":O,U=t.dashArray,se=U===void 0?[10,5,0,0]:U,le=t.lineTexture,ye=le===void 0?!1:le,Be=t.iconStep,rt=Be===void 0?100:Be,Je=t.vertexHeightScale,Ot=Je===void 0?20:Je,jt=t.borderWidth,dr=jt===void 0?0:jt,Lr=t.borderColor,jr=Lr===void 0?"#ccc":Lr,Jr=t.raisingHeight,Pn=Jr===void 0?0:Jr,In=t.heightfixed,Si=In===void 0?!1:In,ra=t.linearDir,Va=ra===void 0?Vm.VERTICAL:ra,Ms=t.blur,vu=Ms===void 0?[1,1,1]:Ms,Bu=t.arrow,zl=Bu===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:Bu;se.length===2&&se.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var _l=0,_h=[0,0,0,0],Pv=[0,0,0,0];if(l&&f&&(_h=Qi(l),Pv=Qi(f),_l=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var wd=this.layer.getEncodedData(),K0=this.calDataFrame(this.cellLength,wd,this.cellProperties),Xd=K0.data,hf=K0.width,$h=K0.height;this.rowCount=$h,this.dataTexture=this.cellLength>0&&Xd.length>0?this.createTexture2D({flipY:!0,data:Xd,format:Ve.LUMINANCE,type:Ve.FLOAT,width:hf,height:$h}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(s)?s:1,u_textureBlend:S===Ex.NORMAL?0:1,u_line_type:rO[Z],u_dash_array:se,u_blur:vu,u_texture:this.texture,u_line_texture:ye?1:0,u_icon_step:rt,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:dr,u_borderColor:Qi(jr),u_linearDir:Va===Vm.VERTICAL?1:0,u_linearColor:_l,u_sourceColor:_h,u_targetColor:Pv,u_heightfixed:Number(Si),u_vertexScale:Ot,u_raisingHeight:Number(Pn),u_arrow:Number(zl.enable),u_arrowHeight:zl.arrowHeight||3,u_arrowWidth:zl.arrowWidth||2,u_tailWidth:zl.tailWidth===void 0?1:zl.tailWidth}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.textureEventFlag||(this.textureEventFlag=!0,this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture)),l.abrupt("return",this.buildModels());case 2:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;(t=this.texture)===null||t===void 0||t.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye,Be,rt,Je,Ot;return Ze().wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=s.depth,Z=O===void 0?!1:O,U=s.workerEnabled,se=U===void 0?!1:U,le=s.enablePicking,ye=this.getShaders(),Be=ye.frag,rt=ye.vert,Je=ye.type,this.layer.triangulation=A,dr.next=5,this.layer.buildLayerModel({moduleName:"line"+Je,vertexShader:rt,fragmentShader:Be,triangulation:A,depth:{enable:Z},blend:this.getBlend(),stencil:yu(f,S),workerEnabled:se,workerOptions:{modelType:"line"+Je,enablePicking:le,iconMap:this.iconService.getIconMap()}});case 5:return Ot=dr.sent,dr.abrupt("return",[Ot]);case 7:case"end":return dr.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),a=t.sourceColor,s=t.targetColor,l=t.lineType;return l==="dash"?{frag:QP,vert:JP,type:"Dash"}:a&&s?{frag:tO,vert:yC,type:"Linear"}:{frag:eO,vert:yC,type:""}}},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Da.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s,l,f,d,S,O){return O===void 0?[f[3],10]:[f[3],O]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Da.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s,l,f){return[f[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s){var l=s.size,f=l===void 0?1:l;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(s,l,f,d,S){return S}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Da.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s,l,f){return[f[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s){var l=t.iconService.getIconMap(),f=s.texture,d=l[f]||{x:0,y:0},S=d.x,O=d.y;return[S,O]}}})}}]),r}(il);function nO(e){var i=iO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function iO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var aO=`uniform float u_opacity : 1.0;
uniform sampler2D u_texture;
uniform float u_linearDir: 1.0;

#pragma include "picking"

varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  gl_FragColor = texture2D(u_texture, vec2(linearRadio, 0.5));

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,oO=`
attribute float a_Miter;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

uniform float u_opacity: 1.0;

#pragma include "projection"
#pragma include "picking"

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,sO=function(e){(0,Ft.Z)(r,e);var i=nO(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;n.colorTexture&&n.colorTexture.destroy();var f=n.layer.getLayerConfig(),d=f.rampColors,S=Pl(d);n.colorTexture=l({data:new Uint8Array(S.data),width:S.width,height:S.height,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE,min:Ve.NEAREST,mag:Ve.NEAREST,flipY:!1})}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.vertexHeightScale,f=l===void 0?20:l,d=t.raisingHeight,S=d===void 0?0:d,O=t.heightfixed,Z=O===void 0?!1:O,U=t.linearDir,se=U===void 0?Vm.VERTICAL:U;if(this.rendererService.getDirty()&&this.colorTexture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var le=this.layer.getEncodedData(),ye=this.calDataFrame(this.cellLength,le,this.cellProperties),Be=ye.data,rt=ye.width,Je=ye.height;this.rowCount=Je,this.dataTexture=this.cellLength>0&&Be.length>0?this.createTexture2D({flipY:!0,data:Be,format:Ve.LUMINANCE,type:Ve.FLOAT,width:rt,height:Je}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_linearDir:se===Vm.VERTICAL?1:0,u_opacity:(0,Kn.isNumber)(s)?s:1,u_texture:this.colorTexture,u_heightfixed:Number(Z),u_vertexScale:f,u_raisingHeight:Number(S)}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),l.abrupt("return",this.buildModels());case 2:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;(t=this.colorTexture)===null||t===void 0||t.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy()}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U;return Ze().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=s.depth,Z=O===void 0?!1:O,this.layer.triangulation=t1,le.next=4,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:oO,fragmentShader:aO,triangulation:t1,depth:{enable:Z},blend:this.getBlend(),stencil:yu(f,S)});case 4:return U=le.sent,le.abrupt("return",[U]);case 6:case"end":return le.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Da.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l,f,d,S){return S===void 0?[l[3],10]:[l[3],S]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Da.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a,s,l){return[l[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0],l[1]]:[l,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f,d){return d}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Da.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a,s,l){return[l[4]]}}})}}]),r}(il);function uO(e){var i=lO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function lO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cO=`
varying vec4 v_color;
varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,fO=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];

  // styleMappingMat[3][0] \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = mix(u_sourceColor, u_targetColor, styleMappingMat[3][0]);
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,xC=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;

attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_vertexScale: 1.0;

#pragma include "projection"

varying vec4 v_color;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  v_color = a_Color; 
  styleMappingMat[3][0] = a_Distance / a_Total_Distance;

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,hO=function(e){(0,Ft.Z)(r,e);var i=uO(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.sourceColor,f=t.targetColor,d=t.vertexHeightScale,S=d===void 0?20:d,O=0,Z=[0,0,0,0],U=[0,0,0,0];if(l&&f&&(Z=Qi(l),U=Qi(f),O=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var se=this.layer.getEncodedData(),le=this.calDataFrame(this.cellLength,se,this.cellProperties),ye=le.data,Be=le.width,rt=le.height;this.rowCount=rt,this.dataTexture=this.cellLength>0&&ye.length>0?this.createTexture2D({flipY:!0,data:ye,format:Ve.LUMINANCE,type:Ve.FLOAT,width:Be,height:rt}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(s)?s:1,u_linearColor:O,u_sourceColor:Z,u_targetColor:U,u_vertexScale:S}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.dataTexture)===null||t===void 0||t.destroy()}},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),a=t.sourceColor,s=t.targetColor;return a&&s?{frag:fO,vert:xC,type:"lineSimpleLinear"}:{frag:cO,vert:xC,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le;return Ze().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=this.getShaders(),Z=O.frag,U=O.vert,se=O.type,Be.next=4,this.layer.buildLayerModel({moduleName:se,vertexShader:U,fragmentShader:Z,triangulation:$5,primitive:Ve.LINES,depth:{enable:!1},blend:this.getBlend(),stencil:yu(f,S),pick:!1});case 4:return le=Be.sent,Be.abrupt("return",[le]);case 6:case"end":return Be.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:Da.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a,s,l){return[l[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Da.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a,s,l){return[l[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0],l[1]]:[l,0]}}})}}]),r}(il);function pO(e){var i=dO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function dO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var vO=`#define Animate 0.0
#define LineTexture 1.0

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying vec2 v_iconMapUV;
varying float v_blur;
varying float v_radio;
varying vec4 v_color;
varying vec4 v_dataset;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,mO=`#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;
uniform float u_linearColor: 0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;
varying vec4 v_color;
varying float v_blur;
varying float v_radio;
varying vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,gO=function(e){(0,Ft.Z)(r,e);var i=pO(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas()}),n.layer.render();return}n.texture=l({data:n.iconService.getCanvas(),mag:Ve.NEAREST,min:Ve.NEAREST,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128})}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.sourceColor,f=t.targetColor,d=t.textureBlend,S=d===void 0?"normal":d,O=t.heightfixed,Z=O===void 0?!1:O,U=t.lineTexture,se=U===void 0?!1:U,le=t.iconStep,ye=le===void 0?100:le,Be=t.iconStepCount,rt=Be===void 0?1:Be;this.rendererService.getDirty()&&this.texture.bind();var Je=0,Ot=[0,0,0,0],jt=[0,0,0,0];return l&&f&&(Ot=Qi(l),jt=Qi(f),Je=1),{u_heightfixed:Number(Z),u_opacity:(0,Kn.isNumber)(s)?s:1,u_textureBlend:S==="normal"?0:1,u_texture:this.texture,u_line_texture:se?1:0,u_iconStepCount:rt,u_icon_step:ye,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Je,u_sourceColor:Ot,u_targetColor:jt}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption;return{u_animate:this.animateOption2Array(a),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:mO,fragmentShader:vO,triangulation:t1,depth:{enable:!1},blend:this.getBlend()});case 2:return s=f.sent,f.abrupt("return",[s]);case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:Da.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s,l,f){return[f[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Da.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s,l,f){return[f[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s){var l=s.size,f=l===void 0?1:l;return Array.isArray(f)?[f[0],f[1]]:[f,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(s,l,f,d,S){return S}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Da.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s,l,f){return[f[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s){var l=t.iconService.getIconMap(),f=s.texture,d=l[f]||{x:0,y:0},S=d.x,O=d.y;return[S,O]}}})}}]),r}(il),yO={arc:EP,arc3d:OP,greatcircle:HP,wall:gO,line:_C,halfLine:YP,simple:hO,linearline:sO,earthArc3d:NP},_O=yO;function xO(e){var i=bO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function bO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var yw=function(e){(0,Ft.Z)(r,e);var i=xO(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","LineLayer"),(0,V.Z)((0,ct.Z)(n),"arrowInsertCount",0),(0,V.Z)((0,ct.Z)(n),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel=new _O[s](this),f.next=4,this.initLayerModels();case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),a={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},halfLine:{},earthArc3d:{}};return a[t]}},{key:"getModelType",value:function(){var t;if(this.layerType)return this.layerType;var a=this.styleAttributeService.getLayerStyleAttribute("shape"),s=a==null||(t=a.scale)===null||t===void 0?void 0:t.field;return s||"line"}},{key:"processData",value:function(t){if(this.getModelType()!=="simple")return t;var a=[];return t.map(function(s){if(Array.isArray(s.coordinates)&&Array.isArray(s.coordinates[0])&&Array.isArray(s.coordinates[0][0])){var l=(0,ue.Z)({},s);s.coordinates.map(function(f){a.push((0,ue.Z)((0,ue.Z)({},l),{},{coordinates:f}))})}else a.push(s)}),a}}]),r}(Dd);function EO(e){var i=wO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function wO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var SO=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,CO=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,AO=function(e){(0,Ft.Z)(r,e);var i=EO(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"raiseCount",0),(0,V.Z)((0,ct.Z)(n),"raiseRepeat",0),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption,s=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,l=t.opacity,f=l===void 0?1:l,d=t.sourceColor,S=t.targetColor,O=t.pickLight,Z=O===void 0?!1:O,U=t.heightfixed,se=U===void 0?!1:U,le=t.opacityLinear,ye=le===void 0?{enable:!1,dir:"up"}:le,Be=t.lightEnable,rt=Be===void 0?!0:Be;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:f})){this.judgeStyleAttributes({opacity:f});var Je=this.layer.getEncodedData(),Ot=this.calDataFrame(this.cellLength,Je,this.cellProperties),jt=Ot.data,dr=Ot.width,Lr=Ot.height;this.rowCount=Lr,this.dataTexture=this.cellLength>0&&jt.length>0?this.createTexture2D({flipY:!0,data:jt,format:Ve.LUMINANCE,type:Ve.FLOAT,width:dr,height:Lr}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}var jr=0,Jr=[0,0,0,0],Pn=[0,0,0,0];if(d&&S&&(Jr=Qi(d),Pn=Qi(S),jr=1),this.raiseCount<1&&this.raiseRepeat>0&&s.enable){var In=s.speed,Si=In===void 0?.01:In;this.raiseCount+=Si,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(Z),u_heightfixed:Number(se),u_r:s.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(f)?f:1,u_linearColor:jr,u_sourceColor:Jr,u_targetColor:Pn,u_opacitylinear:Number(ye.enable),u_opacitylinear_dir:ye.dir==="up"?1:0,u_lightEnable:Number(rt)}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return s=this.layer.getLayerConfig(),l=s.animateOption.repeat,f=l===void 0?1:l,this.raiseRepeat=f,O.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:CO,fragmentShader:SO,triangulation:mw,depth:{enable:!0},cull:{enable:!0,face:up(this.mapService.version)},blend:this.getBlend()});case 4:return d=O.sent,O.abrupt("return",[d]);case 6:case"end":return O.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.dataTexture)===null||t===void 0||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a){var s=a.size;if(s){var l=[];return Array.isArray(s)&&(l=s.length===2?[s[0],s[0],s[1]]:s),Array.isArray(s)||(l=[s,s,s]),l}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f,d){return d}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Da.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a){var s=ml(a.coordinates);return eC([s[0],s[1]])}}})}}]),r}(il);function TO(e){var i=MO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function MO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var PO=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,OO=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);

  setPickingColor(a_PickingColor);
}
`,IO=function(e){(0,Ft.Z)(r,e);var i=TO(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.strokeOpacity,f=l===void 0?1:l,d=t.strokeWidth,S=d===void 0?0:d,O=t.stroke,Z=O===void 0?"rgba(0,0,0,0)":O,U=t.offsets,se=U===void 0?[0,0]:U,le=t.blend,ye=t.blur,Be=ye===void 0?0:ye;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,strokeOpacity:f,strokeWidth:S,stroke:Z,offsets:se})){this.judgeStyleAttributes({opacity:s,strokeOpacity:f,strokeWidth:S,stroke:Z,offsets:se});var rt=this.layer.getEncodedData(),Je=this.calDataFrame(this.cellLength,rt,this.cellProperties),Ot=Je.data,jt=Je.width,dr=Je.height;this.rowCount=dr,this.dataTexture=this.cellLength>0&&Ot.length>0?this.createTexture2D({flipY:!0,data:Ot,format:Ve.LUMINANCE,type:Ve.FLOAT,width:jt,height:dr}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_blur:Be,u_additive:le==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(s)?s:1,u_stroke_opacity:(0,Kn.isNumber)(f)?f:1,u_stroke_width:(0,Kn.isNumber)(S)?S:1,u_stroke_color:this.getStrokeColor(Z),u_offsets:this.isOffsetStatic(se)?se:[0,0]}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption,s=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.layer.triangulation=uC,f.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:OO,fragmentShader:PO,triangulation:uC,depth:{enable:!0},blend:this.getBlend()});case 3:return s=f.sent,f.abrupt("return",[s]);case 5:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.dataTexture)===null||t===void 0||t.destroy()}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Da.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(s,l,f,d){var S=(0,Ja.Z)(f,3),O=S[0],Z=S[1],U=S[2],se=Kl(0,0,1),le=Kl(O,0,U),ye=O>=0?hw(se,le):Math.PI*2-hw(se,le),Be=Math.PI*2-Math.asin(Z/100),rt=rl();zp(rt,rt,ye),wp(rt,rt,Be);var Je=Kl(1,1,0);Hm(Je,Je,rt),V0(Je,Je);var Ot=Kl(-1,1,0);Hm(Ot,Ot,rt),V0(Ot,Ot);var jt=Kl(-1,-1,0);Hm(jt,jt,rt),V0(jt,jt);var dr=Kl(1,-1,0);Hm(dr,dr,rt),V0(dr,dr);var Lr=[].concat((0,oe.Z)(Je),(0,oe.Z)(Ot),(0,oe.Z)(jt),(0,oe.Z)(dr)),jr=d%4*3;return[Lr[jr],Lr[jr+1],Lr[jr+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.size,f=l===void 0?5:l;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Da.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.shape,f=l===void 0?2:l,d=t.layer.getLayerConfig().shape2d,S=d.indexOf(f);return[S]}}})}}]),r}(il);function LO(e){var i=RO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function RO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var kO=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,DO=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }

  setPickingColor(a_PickingColor);
}
`,bC=function(e){(0,Ft.Z)(r,e);var i=LO(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"raiseCount",0),(0,V.Z)((0,ct.Z)(n),"raiseRepeat",0),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption,s=a===void 0?{enable:!1,speed:.01,repeat:!1}:a,l=t.opacity,f=l===void 0?1:l,d=t.sourceColor,S=t.targetColor,O=t.pickLight,Z=O===void 0?!1:O,U=t.heightfixed,se=U===void 0?!1:U,le=t.opacityLinear,ye=le===void 0?{enable:!1,dir:"up"}:le,Be=t.lightEnable,rt=Be===void 0?!0:Be;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:f})){this.judgeStyleAttributes({opacity:f});var Je=this.layer.getEncodedData(),Ot=this.calDataFrame(this.cellLength,Je,this.cellProperties),jt=Ot.data,dr=Ot.width,Lr=Ot.height;this.rowCount=Lr,this.dataTexture=this.cellLength>0&&jt.length>0?this.createTexture2D({flipY:!0,data:jt,format:Ve.LUMINANCE,type:Ve.FLOAT,width:dr,height:Lr}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}var jr=0,Jr=[0,0,0,0],Pn=[0,0,0,0];if(d&&S&&(Jr=Qi(d),Pn=Qi(S),jr=1),this.raiseCount<1&&this.raiseRepeat>0&&s.enable){var In=s.speed,Si=In===void 0?.01:In;this.raiseCount+=Si,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(Z),u_heightfixed:Number(se),u_r:s.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(f)?f:1,u_linearColor:jr,u_sourceColor:Jr,u_targetColor:Pn,u_opacitylinear:Number(ye.enable),u_opacitylinear_dir:ye.dir==="up"?1:0,u_lightEnable:Number(rt)}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.depth,f=l===void 0?!0:l,d=s.animateOption.repeat,S=d===void 0?1:d,this.raiseRepeat=S,U.next=4,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:DO,fragmentShader:kO,triangulation:mw,blend:this.getBlend(),cull:{enable:!0,face:up(this.mapService.version)},depth:{enable:f}});case 4:return O=U.sent,U.abrupt("return",[O]);case 6:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.dataTexture)===null||t===void 0||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a){var s=a.size;if(s){var l=[];return Array.isArray(s)&&(l=s.length===2?[s[0],s[0],s[1]]:s),Array.isArray(s)||(l=[s,s,s]),l}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f,d){return d}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Da.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a){var s=ml(a.coordinates);return[s[0],s[1],0]}}})}}]),r}(il);function FO(e){var i=BO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function BO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var EC=`
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

 gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  
  // \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,NO=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,_w=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform int u_Size_Unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;
if(u_Size_Unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);
  
  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_raisingHeight;

  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }
 

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position =  u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,wC=function(e){(0,Ft.Z)(r,e);var i=FO(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.strokeOpacity,f=l===void 0?1:l,d=t.strokeWidth,S=d===void 0?0:d,O=t.stroke,Z=O===void 0?"rgba(0,0,0,0)":O,U=t.offsets,se=U===void 0?[0,0]:U,le=t.blend,ye=t.blur,Be=ye===void 0?0:ye,rt=t.raisingHeight,Je=rt===void 0?0:rt,Ot=t.heightfixed,jt=Ot===void 0?!1:Ot,dr=t.unit,Lr=dr===void 0?"pixel":dr;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,strokeOpacity:f,strokeWidth:S,stroke:Z,offsets:se})){this.judgeStyleAttributes({opacity:s,strokeOpacity:f,strokeWidth:S,stroke:Z,offsets:se});var jr=this.layer.getEncodedData(),Jr=this.calDataFrame(this.cellLength,jr,this.cellProperties),Pn=Jr.data,In=Jr.width,Si=Jr.height;this.rowCount=Si,this.dataTexture=this.cellLength>0&&Pn.length>0?this.createTexture2D({flipY:!0,data:Pn,format:Ve.LUMINANCE,type:Ve.FLOAT,width:In,height:Si}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(Je),u_heightfixed:Number(jt),u_blur:Be,u_additive:le==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(s)?s:1,u_stroke_opacity:(0,Kn.isNumber)(f)?f:1,u_stroke_width:(0,Kn.isNumber)(S)?S:1,u_stroke_color:this.getStrokeColor(Z),u_Size_Unit:Ng[Lr],u_offsets:this.isOffsetStatic(se)?se:[0,0]}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption,s=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),L)}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye,Be,rt,Je,Ot,jt;return Ze().wrap(function(Lr){for(;;)switch(Lr.prev=Lr.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=s.animateOption,Z=O===void 0?{enable:!1}:O,U=s.workerEnabled,se=U===void 0?!1:U,le=s.enablePicking,ye=s.shape2d,Be=this.getShaders(Z),rt=Be.frag,Je=Be.vert,Ot=Be.type,this.layer.triangulation=L,Lr.next=5,this.layer.buildLayerModel({moduleName:Ot,vertexShader:Je,fragmentShader:rt,triangulation:L,depth:{enable:!1},blend:this.getBlend(),stencil:yu(f,S),workerEnabled:se,workerOptions:{modelType:Ot,enablePicking:le,shape2d:ye}});case 5:return jt=Lr.sent,Lr.abrupt("return",[jt]);case 7:case"end":return Lr.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getShaders",value:function(t){if(t.enable)switch(t.type){case"wave":return{frag:EC,vert:_w,type:"pointWave"};default:return{frag:EC,vert:_w,type:"pointWave"}}else return{frag:NO,vert:_w,type:"pointFill"}}},{key:"clearModels",value:function(){var t;(t=this.dataTexture)===null||t===void 0||t.destroy()}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var t=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Da.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(s,l,f,d){var S=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],O=d%4*3;return[S[O],S[O+1],S[O+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.size,f=l===void 0?5:l;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Da.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.shape,f=l===void 0?2:l,d=t.indexOf(f);return[d]}}})}}]),r}(il);function zO(e){var i=ZO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function ZO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var UO=`uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;

void main() {

  float opacity = styleMappingMat[0][0];

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,jO=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;
attribute float a_Rotate;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform mat2 u_RotateMatrix;
uniform int u_Size_Unit;

varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;
uniform float u_opacity : 1;
uniform vec2 u_offsets;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;

  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // empty - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float newSize = a_Size;
  if(u_Size_Unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (rotation_matrix * u_RotateMatrix * extrude.xy * (newSize) + textrueOffsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp *vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,VO=function(e){(0,Ft.Z)(r,e);var i=zO(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"meter2coord",1),(0,V.Z)((0,ct.Z)(n),"isMeter",!1),(0,V.Z)((0,ct.Z)(n),"radian",0),(0,V.Z)((0,ct.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),n.layerService.throttleRenderLayers();return}n.texture=l({data:n.iconService.getCanvas(),mag:Ve.LINEAR,min:Ve.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.offsets,f=l===void 0?[0,0]:l,d=t.rotation,S=t.raisingHeight,O=S===void 0?0:S,Z=t.heightfixed,U=Z===void 0?!1:Z,se=t.unit,le=se===void 0?"pixel":se;this.rendererService.getDirty()&&this.texture.bind();var ye=1;if((this.mapService.version==="GAODE2.x"||this.mapService.version==="GAODE1.x")&&(ye=-1),this.radian=d!==void 0?ye*Math.PI*d/180:ye*Math.PI*(this.mapService.getRotation()%360)/180,this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,offsets:f})){this.judgeStyleAttributes({opacity:s,offsets:f});var Be=this.layer.getEncodedData(),rt=this.calDataFrame(this.cellLength,Be,this.cellProperties),Je=rt.data,Ot=rt.width,jt=rt.height;this.rowCount=jt,this.dataTexture=this.cellLength>0&&Je.length>0?this.createTexture2D({flipY:!0,data:Je,format:Ve.LUMINANCE,type:Ve.FLOAT,width:Ot,height:jt}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(O),u_heightfixed:Number(U),u_Size_Unit:Ng[le],u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:(0,Kn.isNumber)(s)?s:1,u_offsets:this.isOffsetStatic(f)?f:[0,0]}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Tx)}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,U.next=3,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:jO,fragmentShader:UO,triangulation:Tx,depth:{enable:!1},blend:this.getBlend(),stencil:yu(f,S),cull:{enable:!0,face:up(this.mapService.version)}});case 3:return O=U.sent,U.abrupt("return",[O]);case 5:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;this.iconService.off("imageUpdate",this.updateTexture),(t=this.texture)===null||t===void 0||t.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Da.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.rotate,f=l===void 0?0:l;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s){var l=t.iconService.getIconMap(),f=s.shape,d=l[f]||{x:-64,y:-64},S=d.x,O=d.y;return[S,O]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Da.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(s,l,f,d){var S=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],O=d%4*3;return[S[O],S[O+1],S[O+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.size,f=l===void 0?5:l;return Array.isArray(f)?[f[0]]:[f]}}})}}]),r}(il);function HO(e){var i=GO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function GO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $O=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,WO=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec2 u_offsets;

uniform float u_opacity : 1;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(textrueOffsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,SC=function(e){(0,Ft.Z)(r,e);var i=HO(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"updateTexture",function(){var l=n.rendererService.createTexture2D;if(n.texture){n.texture.update({data:n.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){n.layerService.throttleRenderLayers()});return}n.texture=l({data:n.iconService.getCanvas(),mag:Ve.LINEAR,min:Ve.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:n.iconService.canvasHeight||128,mipmap:!0})}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.offsets,f=l===void 0?[0,0]:l,d=t.raisingHeight,S=d===void 0?0:d,O=t.heightfixed,Z=O===void 0?!1:O;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,offsets:f})){this.judgeStyleAttributes({opacity:s,offsets:f});var U=this.layer.getEncodedData(),se=this.calDataFrame(this.cellLength,U,this.cellProperties),le=se.data,ye=se.width,Be=se.height;this.rowCount=Be,this.dataTexture=this.cellLength>0&&le.length>0?this.createTexture2D({flipY:!0,data:le,format:Ve.LUMINANCE,type:Ve.FLOAT,width:ye,height:Be}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(S),u_heightfixed:Number(Z),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:(0,Kn.isNumber)(s)?s:1,u_offsets:this.isOffsetStatic(f)?f:[0,0]}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),l.abrupt("return",this.buildModels());case 3:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;(t=this.texture)===null||t===void 0||t.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,U.next=3,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:WO,fragmentShader:$O,triangulation:G5,depth:{enable:!1},primitive:Ve.POINTS,blend:this.getBlend(),stencil:yu(f,S)});case 3:return O=U.sent,U.abrupt("return",[O]);case 5:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(s){var l=s.size,f=l===void 0?5:l;return Array.isArray(f)?[f[0]]:[f]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(s){var l=t.iconService.getIconMap(),f=s.shape,d=l[f]||{x:-64,y:-64},S=d.x,O=d.y;return[S,O]}}})}}]),r}(il);function XO(e){var i=YO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function YO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var KO=`uniform float u_opacity : 1;
varying vec4 v_color;
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
}
`,qO=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;

varying vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = a_Color;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy, a_Position.z, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
}
`;function CC(e){var i=e.coordinates;return{vertices:(0,oe.Z)(i),indices:[0],size:i.length}}var AC=function(e){(0,Ft.Z)(r,e);var i=XO(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a;return{u_opacity:(0,Kn.isNumber)(s)?s:1}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,this.layer.triangulation=CC,U.next=4,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:qO,fragmentShader:KO,triangulation:CC,depth:{enable:!1},primitive:Ve.POINTS,blend:this.getBlend(),stencil:yu(f,S),pick:!1});case 4:return O=U.sent,U.abrupt("return",[O]);case 6:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0]]:[l]}}})}}]),r}(il);function QO(e){var i=JO();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function JO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var eI=`
uniform float u_additive;
uniform float u_opacity: 1.0;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;
#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  v_exteude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  // full circle
  // float rades = dot(dir, baseDir);
  // float flag = sign(dir.y);
  // float radar_v = (flag - 1.0) * -0.5 + flag * acos(rades)/pi/2.0;
  
  // half circle
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  gl_FragColor.a *= radar_v;
}
`,tI=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
uniform float u_speed: 1.0;
uniform float u_time;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform int u_Size_Unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_exteude = rotateMatrix * a_Extrude.xy;

  // unpack color(vec2)
  v_color = a_Color;



  // anti-alias
  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_Size_Unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = (extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
  offset = project_pixel(offset);
  
  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp *vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,rI=function(e){(0,Ft.Z)(r,e);var i=QO(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.blend,f=t.speed,d=f===void 0?1:f,S=t.unit,O=S===void 0?"pixel":S;return{u_Size_Unit:Ng[O],u_speed:d,u_additive:l==="additive"?1:0,u_opacity:(0,Kn.isNumber)(s)?s:1}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption,s=a===void 0?{enable:!1}:a;return{u_animate:this.animateOption2Array(s),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Tx)}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,U.next=3,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:tI,fragmentShader:eI,triangulation:Tx,depth:{enable:!1},blend:this.getBlend(),stencil:yu(f,S)});case 3:return O=U.sent,U.abrupt("return",[O]);case 5:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.dataTexture)===null||t===void 0||t.destroy()}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Da.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f){var d=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],S=f%4*3;return[d[S],d[S+1],d[S+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?5:s;return Array.isArray(l)?[l[0]]:[l]}}})}}]),r}(il);function nI(e){var i=iI();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function iI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var aI=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_additive;

uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  float opacity = styleMappingMat[0][0];
  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,oI=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143
varying float v_blur;
varying float v_innerRadius;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  vec2 offset = project_pixel(textrueOffsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function TC(e){var i=e.coordinates;return{vertices:(0,oe.Z)(i),indices:[0],size:i.length}}var sI=function(e){(0,Ft.Z)(r,e);var i=nI(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.offsets,f=l===void 0?[0,0]:l,d=t.blend,S=t.strokeOpacity,O=S===void 0?1:S,Z=t.strokeWidth,U=Z===void 0?0:Z,se=t.stroke,le=se===void 0?"#fff":se;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,offsets:f})){this.judgeStyleAttributes({opacity:s,offsets:f});var ye=this.layer.getEncodedData(),Be=this.calDataFrame(this.cellLength,ye,this.cellProperties),rt=Be.data,Je=Be.width,Ot=Be.height;this.rowCount=Ot,this.dataTexture=this.cellLength>0&&rt.length>0?this.createTexture2D({flipY:!0,data:rt,format:Ve.LUMINANCE,type:Ve.FLOAT,width:Je,height:Ot}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_additive:d==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,Kn.isNumber)(s)?s:1,u_offsets:this.isOffsetStatic(f)?f:[0,0],u_stroke_opacity:(0,Kn.isNumber)(O)?O:1,u_stroke_width:(0,Kn.isNumber)(U)?U:1,u_stroke_color:this.getStrokeColor(le)}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,this.layer.triangulation=TC,U.next=4,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:oI,fragmentShader:aI,triangulation:TC,depth:{enable:!1},primitive:Ve.POINTS,blend:this.getBlend(),stencil:yu(f,S)});case 4:return O=U.sent,U.abrupt("return",[O]);case 6:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.dataTexture)===null||t===void 0||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0]]:[l]}}})}}]),r}(il);function uI(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=lI(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function lI(e,i){if(e){if(typeof e=="string")return MC(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MC(e,i)}}function MC(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var cI=function(){function e(i,r,n){(0,re.Z)(this,e),(0,V.Z)(this,"boxCells",[]);var t=this.boxCells;this.xCellCount=Math.ceil(i/n),this.yCellCount=Math.ceil(r/n);for(var a=0;a<this.xCellCount*this.yCellCount;a++)t.push([]);this.boxKeys=[],this.bboxes=[],this.width=i,this.height=r,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/r,this.boxUid=0}return(0,he.Z)(e,[{key:"insert",value:function(r,n,t,a,s){this.forEachCell(n,t,a,s,this.insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(n),this.bboxes.push(t),this.bboxes.push(a),this.bboxes.push(s)}},{key:"query",value:function(r,n,t,a,s){return this.queryHitTest(r,n,t,a,!1,s)}},{key:"hitTest",value:function(r,n,t,a,s){return this.queryHitTest(r,n,t,a,!0,s)}},{key:"insertBoxCell",value:function(r,n,t,a,s,l){this.boxCells[s].push(l)}},{key:"queryHitTest",value:function(r,n,t,a,s,l){if(t<0||r>this.width||a<0||n>this.height)return s?!1:[];var f=[];if(r<=0&&n<=0&&this.width<=t&&this.height<=a){if(s)return!0;for(var d=0;d<this.boxKeys.length;d++)f.push({key:this.boxKeys[d],x1:this.bboxes[d*4],y1:this.bboxes[d*4+1],x2:this.bboxes[d*4+2],y2:this.bboxes[d*4+3]});return l?f.filter(l):f}var S={hitTest:s,seenUids:{box:{},circle:{}}};return this.forEachCell(r,n,t,a,this.queryCell,f,S,l),s?f.length>0:f}},{key:"queryCell",value:function(r,n,t,a,s,l,f,d){var S=f.seenUids,O=this.boxCells[s];if(O!==null){var Z=this.bboxes,U=uI(O),se;try{for(U.s();!(se=U.n()).done;){var le=se.value;if(!S.box[le]){S.box[le]=!0;var ye=le*4;if(r<=Z[ye+2]&&n<=Z[ye+3]&&t>=Z[ye+0]&&a>=Z[ye+1]&&(!d||d(this.boxKeys[le]))){if(f.hitTest)return l.push(!0),!0;l.push({key:this.boxKeys[le],x1:Z[ye],y1:Z[ye+1],x2:Z[ye+2],y2:Z[ye+3]})}}}}catch(Be){U.e(Be)}finally{U.f()}}return!1}},{key:"forEachCell",value:function(r,n,t,a,s,l,f,d){for(var S=this.convertToXCellCoord(r),O=this.convertToYCellCoord(n),Z=this.convertToXCellCoord(t),U=this.convertToYCellCoord(a),se=S;se<=Z;se++)for(var le=O;le<=U;le++){var ye=this.xCellCount*le+se;if(s.call(this,r,n,t,a,ye,l,f,d))return}}},{key:"convertToXCellCoord",value:function(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}},{key:"convertToYCellCoord",value:function(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}}]),e}(),fI=cI,hI=function(){function e(i,r){(0,re.Z)(this,e),(0,V.Z)(this,"viewportPadding",100),this.width=i,this.height=r,this.viewportPadding=Math.max(i,r),this.grid=new fI(i+this.viewportPadding,r+this.viewportPadding,25),this.screenRightBoundary=i+this.viewportPadding,this.screenBottomBoundary=r+this.viewportPadding,this.gridRightBoundary=i+2*this.viewportPadding,this.gridBottomBoundary=r+2*this.viewportPadding}return(0,he.Z)(e,[{key:"placeCollisionBox",value:function(r){var n=r.x1+r.anchorPointX+this.viewportPadding,t=r.y1+r.anchorPointY+this.viewportPadding,a=r.x2+r.anchorPointX+this.viewportPadding,s=r.y2+r.anchorPointY+this.viewportPadding;return!this.isInsideGrid(n,t,a,s)||this.grid.hitTest(n,t,a,s)?{box:[]}:{box:[n,t,a,s]}}},{key:"insertCollisionBox",value:function(r,n){var t={featureIndex:n};this.grid.insert(t,r[0],r[1],r[2],r[3])}},{key:"project",value:function(r,n,t){var a=T0(n,t,0,1),s=zv(),l=Iv.apply(m,(0,oe.Z)(r));return Zv(s,a,l),{x:(s[0]/s[3]+1)/2*this.width+this.viewportPadding,y:(-s[1]/s[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(r,n,t,a){return t>=0&&r<this.gridRightBoundary&&a>=0&&n<this.gridBottomBoundary}}]),e}();function PC(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=pI(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function pI(e,i){if(e){if(typeof e=="string")return OC(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OC(e,i)}}function OC(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}function IC(e){var i=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0;break;default:i=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break;default:r=.5}return{horizontalAlign:i,verticalAlign:r}}function LC(e,i,r,n,t){if(t){var a=e[n],s=a.glyph;if(s)for(var l=i[s].advance*a.scale,f=(e[n].x+l)*t,d=r;d<=n;d++)e[d].x-=f}}function RC(e,i,r,n,t,a,s){var l=(i-r)*t,f=(-n*s+.5)*a,d=PC(e),S;try{for(d.s();!(S=d.n()).done;){var O=S.value;O.x+=l,O.y+=f}}catch(Z){d.e(Z)}finally{d.f()}}function dI(e,i,r,n,t,a,s){var l=-8,f=0,d=l,S=0,O=e.positionedGlyphs,Z=a==="right"?1:a==="left"?0:.5,U=O.length;r.forEach(function(rt){if(rt.split("").forEach(function(Ot){var jt=i[Ot],dr=0;jt&&(O.push({glyph:Ot,x:f,y:d+dr,vertical:!1,scale:1,metrics:jt}),f+=jt.advance+s)}),O.length!==U){var Je=f-s;S=Math.max(Je,S),LC(O,i,U,O.length-1,Z)}f=0,d-=n+5});var se=IC(t),le=se.horizontalAlign,ye=se.verticalAlign;RC(O,Z,le,ye,S,n,r.length);var Be=d-l;e.top+=-ye*Be,e.bottom=e.top-Be,e.left+=-le*S,e.right=e.left+S}function vI(e,i,r,n,t,a,s){var l=-8,f=0,d=l,S=0,O=e.positionedGlyphs,Z=a==="right"?1:a==="left"?0:.5,U=O.length;r.forEach(function(rt){var Je=i[rt],Ot=0;if(Je&&(O.push({glyph:rt,x:Je.advance/2,y:d+Ot,vertical:!1,scale:1,metrics:Je}),f+=Je.advance+s),O.length!==U){var jt=f-s;S=Math.max(jt,S),LC(O,i,U,O.length-1,Z)}f=0,d-=n+5});var se=IC(t),le=se.horizontalAlign,ye=se.verticalAlign;RC(O,Z,le,ye,S,n,r.length);var Be=d-l;e.top+=-ye*Be,e.bottom=e.top-Be,e.left+=-le*S,e.right=e.left+S}function mI(e,i,r,n,t,a){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],l=arguments.length>7?arguments[7]:void 0,f=e.split(`
`),d=[],S={positionedGlyphs:d,top:s[1],bottom:s[1],left:s[0],right:s[0],lineCount:f.length,text:e};return l?vI(S,i,f,r,n,t,a):dI(S,i,f,r,n,t,a),d.length?S:!1}function gI(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],r=arguments.length>2?arguments[2]:void 0,n=e.positionedGlyphs,t=n===void 0?[]:n,a=[],s=PC(t),l;try{for(s.s();!(l=s.n()).done;){var f=l.value,d=f.metrics,S=4,O=d.advance*f.scale/2,Z=r?[f.x+O,f.y]:[0,0],U=r?[0,0]:[f.x+O+i[0],f.y+i[1]],se=(0-S)*f.scale-O+U[0],le=(0-S)*f.scale+U[1],ye=se+d.width*f.scale,Be=le+d.height*f.scale,rt={x:se,y:le},Je={x:ye,y:le},Ot={x:se,y:Be},jt={x:ye,y:Be};a.push({tl:rt,tr:Je,bl:Ot,br:jt,tex:d,glyphOffset:Z})}}catch(dr){s.e(dr)}finally{s.f()}return a}function yI(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_I(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function _I(e,i){if(e){if(typeof e=="string")return kC(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kC(e,i)}}function kC(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}function xI(e){var i=bI();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function bI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var DC=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  // get style data mapping
  float opacity = styleMappingMat[0][0];
  float strokeWidth = styleMappingMat[0][2];
  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,FC=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp *(vec4(a_Position.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function BC(e){var i=this,r=e.id,n=[],t=[];if(!i.glyphInfoMap||!i.glyphInfoMap[r])return{vertices:[],indices:[],size:7};var a=i.glyphInfoMap[r].centroid,s=a.length===2?[a[0],a[1],0]:a;return i.glyphInfoMap[r].glyphQuads.forEach(function(l,f){n.push.apply(n,(0,oe.Z)(s).concat([l.tex.x,l.tex.y+l.tex.height,l.tl.x,l.tl.y],(0,oe.Z)(s),[l.tex.x+l.tex.width,l.tex.y+l.tex.height,l.tr.x,l.tr.y],(0,oe.Z)(s),[l.tex.x+l.tex.width,l.tex.y,l.br.x,l.br.y],(0,oe.Z)(s),[l.tex.x,l.tex.y,l.bl.x,l.bl.y])),t.push(0+f*4,1+f*4,2+f*4,2+f*4,3+f*4,0+f*4)}),{vertices:n,indices:t,size:7}}var NC=function(e){(0,Ft.Z)(r,e);var i=xI(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"glyphInfoMap",{}),(0,V.Z)((0,ct.Z)(n),"currentZoom",-1),(0,V.Z)((0,ct.Z)(n),"textureHeight",0),(0,V.Z)((0,ct.Z)(n),"textCount",0),(0,V.Z)((0,ct.Z)(n),"preTextStyle",{}),(0,V.Z)((0,ct.Z)(n),"mapping",(0,Dt.Z)(Ze().mark(function l(){return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return n.initGlyph(),n.updateTexture(),d.next=4,n.reBuildModel();case 4:case"end":return d.stop()}},l)}))),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.stroke,f=l===void 0?"#fff":l,d=t.strokeWidth,S=d===void 0?0:d,O=t.halo,Z=O===void 0?.5:O,U=t.gamma,se=U===void 0?2:U,le=t.raisingHeight,ye=le===void 0?0:le,Be=this.fontService,rt=Be.canvas,Je=Be.mapping;if(Je&&Object.keys(Je).length!==this.textCount&&rt&&(this.updateTexture(),this.textCount=Object.keys(Je).length),this.preTextStyle=this.getTextStyle(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s,strokeWidth:S,stroke:f})){this.judgeStyleAttributes({opacity:s,strokeWidth:S,stroke:f});var Ot=this.layer.getEncodedData(),jt=this.calDataFrame(this.cellLength,Ot,this.cellProperties),dr=jt.data,Lr=jt.width,jr=jt.height;this.rowCount=jr,this.dataTexture=this.cellLength>0&&dr.length>0?this.createTexture2D({flipY:!0,data:dr,format:Ve.LUMINANCE,type:Ve.FLOAT,width:Lr,height:jr}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(ye),u_opacity:(0,Kn.isNumber)(s)?s:1,u_stroke_width:(0,Kn.isNumber)(S)?S:1,u_stroke_color:this.getStrokeColor(f),u_sdf_map:this.texture,u_halo_blur:Z,u_gamma_scale:se,u_sdf_map_size:[(rt==null?void 0:rt.width)||1,(rt==null?void 0:rt.height)||1]}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),this.preTextStyle=this.getTextStyle(),l.abrupt("return",this.buildModels());case 4:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U;return Ze().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=s.textAllowOverlap,Z=O===void 0?!1:O,this.initGlyph(),this.updateTexture(),Z||this.filterGlyphs(),le.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:FC,fragmentShader:DC,triangulation:BC.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:yu(f,S)});case 6:return U=le.sent,le.abrupt("return",[U]);case 8:case"end":return le.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"needUpdate",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye,Be;return Ze().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(s=this.getTextStyle(),l=s.textAllowOverlap,f=l===void 0?!1:l,d=s.textAnchor,S=d===void 0?"center":d,O=s.textOffset,Z=s.padding,U=s.fontFamily,se=s.fontWeight,!(!(0,Kn.isEqual)(Z,this.preTextStyle.padding)||!(0,Kn.isEqual)(O,this.preTextStyle.textOffset)||!(0,Kn.isEqual)(S,this.preTextStyle.textAnchor)||!(0,Kn.isEqual)(U,this.preTextStyle.fontFamily)||!(0,Kn.isEqual)(se,this.preTextStyle.fontWeight))){Je.next=5;break}return Je.next=4,this.mapping();case 4:return Je.abrupt("return",!0);case 5:if(!f){Je.next=7;break}return Je.abrupt("return",!1);case 7:if(le=this.mapService.getZoom(),ye=this.mapService.getBounds(),Be=Io(this.extent,ye),!(Math.abs(this.currentZoom-le)>.5||!Be||f!==this.preTextStyle.textAllowOverlap)){Je.next=14;break}return Je.next=13,this.reBuildModel();case 13:return Je.abrupt("return",!0);case 14:return Je.abrupt("return",!1);case 15:case"end":return Je.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;(t=this.texture)===null||t===void 0||t.destroy(),(a=this.dataTexture)===null||a===void 0||a.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Da.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.rotate,l=s===void 0?0:s;return Array.isArray(l)?[l[0]]:[l]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Da.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[5],l[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?12:s;return Array.isArray(l)?[l[0]]:[l]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Da.Attribute,descriptor:{name:"a_tex",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var t=this.mapService.getBounds();return ko(t,.5)}},{key:"initTextFont",value:function(){var t=this.getTextStyle(),a=t.fontWeight,s=t.fontFamily,l=this.layer.getEncodedData(),f=[];l.forEach(function(d){var S=d.shape,O=S===void 0?"":S;O=O.toString();var Z=yI(O),U;try{for(Z.s();!(U=Z.n()).done;){var se=U.value;f.indexOf(se)===-1&&f.push(se)}}catch(le){Z.e(le)}finally{Z.f()}}),this.fontService.setFontOptions({characterSet:f,fontWeight:a,fontFamily:s,iconfont:!1})}},{key:"initIconFontTex",value:function(){var t=this.getTextStyle(),a=t.fontWeight,s=t.fontFamily,l=this.layer.getEncodedData(),f=[];l.forEach(function(d){var S=d.shape,O=S===void 0?"":S;O="".concat(O),f.indexOf(O)===-1&&f.push(O)}),this.fontService.setFontOptions({characterSet:f,fontWeight:a,fontFamily:s,iconfont:!0})}},{key:"getTextStyle",value:function(){var t=this.layer.getLayerConfig(),a=t.fontWeight,s=a===void 0?"400":a,l=t.fontFamily,f=l===void 0?"sans-serif":l,d=t.textAllowOverlap,S=d===void 0?!1:d,O=t.padding,Z=O===void 0?[0,0]:O,U=t.textAnchor,se=U===void 0?"center":U,le=t.textOffset,ye=le===void 0?[0,0]:le,Be=t.opacity,rt=Be===void 0?1:Be,Je=t.strokeOpacity,Ot=Je===void 0?1:Je,jt=t.strokeWidth,dr=jt===void 0?0:jt,Lr=t.stroke,jr=Lr===void 0?"#000":Lr;return{fontWeight:s,fontFamily:f,textAllowOverlap:S,padding:Z,textAnchor:se,textOffset:ye,opacity:rt,strokeOpacity:Ot,strokeWidth:dr,stroke:jr}}},{key:"generateGlyphLayout",value:function(t){var a=this,s=this.fontService.mapping,l=this.layer.getLayerConfig(),f=l.spacing,d=f===void 0?2:f,S=l.textAnchor,O=S===void 0?"center":S,Z=l.textOffset,U=this.layer.getEncodedData();this.glyphInfo=U.map(function(se){var le=se.shape,ye=le===void 0?"":le,Be=se.id,rt=se.size,Je=rt===void 0?1:rt,Ot=mI(ye.toString(),s,Je,O,"left",d,Z||se.textOffset||[0,0],t),jt=gI(Ot,Z,!1);return se.shaping=Ot,se.glyphQuads=jt,se.centroid=ml(se.coordinates),se.originCentroid=se.version==="GAODE2.x"?ml(se.originCoordinates):se.originCentroid=se.centroid,a.glyphInfoMap[Be]={shaping:Ot,glyphQuads:jt,centroid:ml(se.coordinates)},se})}},{key:"filterGlyphs",value:function(){var t=this,a=this.layer.getLayerConfig(),s=a.padding,l=s===void 0?[0,0]:s,f=a.textAllowOverlap,d=f===void 0?!1:f;if(!d){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var S=this.rendererService.getViewportSize(),O=S.width,Z=S.height,U=new hI(O,Z),se=this.glyphInfo.filter(function(le){var ye=le.shaping,Be=le.id,rt=Be===void 0?0:Be,Je=le.version==="GAODE2.x"?le.originCentroid:le.centroid,Ot=le.size,jt=Ot/16,dr=t.mapService.lngLatToContainer(Je),Lr=U.placeCollisionBox({x1:ye.left*jt-l[0],x2:ye.right*jt+l[0],y1:ye.top*jt-l[1],y2:ye.bottom*jt+l[1],anchorPointX:dr.x,anchorPointY:dr.y}),jr=Lr.box;return jr&&jr.length?(U.insertCollisionBox(jr,rt),!0):!1});se.forEach(function(le){t.glyphInfoMap[le.id]=le})}}},{key:"initGlyph",value:function(){var t=this.layer.getLayerConfig(),a=t.iconfont,s=a===void 0?!1:a;s?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(s)}},{key:"updateTexture",value:function(){var t=this.rendererService.createTexture2D,a=this.fontService.canvas;this.textureHeight=a.height,this.texture&&this.texture.destroy(),this.texture=t({data:a,mag:Ve.LINEAR,min:Ve.LINEAR,width:a.width,height:a.height})}},{key:"reBuildModel",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,this.filterGlyphs(),U.next=4,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:FC,fragmentShader:DC,triangulation:BC.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:yu(f,S)});case 4:O=U.sent,this.layer.models=[O];case 6:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()}]),r}(il),EI={fillImage:VO,fill:wC,radar:rI,image:SC,normal:AC,simplePoint:sI,extrude:bC,text:NC,earthFill:IO,earthExtrude:AO},wI=EI;function SI(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=CI(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function CI(e,i){if(e){if(typeof e=="string")return zC(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zC(e,i)}}function zC(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}function AI(e){var i=TI();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function TI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ox=function(e){(0,Ft.Z)(r,e);var i=AI(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","PointLayer"),(0,V.Z)((0,ct.Z)(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new wI[s](this),f.next=5,this.initLayerModels();case 5:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"rebuildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.buildModels();case 2:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var t=this.shapeOption,a=t.field,s=t.values,l=this.getLayerConfig(),f=l.shape2d,d=this.iconService.getIconMap();if(a&&(f==null?void 0:f.indexOf(a))!==-1)return"fill";if(s==="text")return"text";if(s&&s instanceof Array){var S=SI(s),O;try{for(S.s();!(O=S.n()).done;){var Z=O.value;if(typeof Z=="string"&&d.hasOwnProperty(Z))return"image"}}catch(U){S.e(U)}finally{S.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),a={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return a[t]}},{key:"getModelType",value:function(){var t=this.getEncodedData(),a=this.getLayerConfig(),s=a.shape2d,l=a.shape3d,f=this.iconService.getIconMap(),d=t.find(function(O){return O.hasOwnProperty("shape")});if(d){var S=d.shape;return S==="dot"?"normal":S==="simple"?"simplePoint":S==="radar"?"radar":this.layerType==="fillImage"?"fillImage":(s==null?void 0:s.indexOf(S))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(l==null?void 0:l.indexOf(S))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":f.hasOwnProperty(S)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),r}(Dd);function MI(e){var i=PI();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function PI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var OI=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];  
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }

  } else {
     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,II=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,LI=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float lightWeight = styleMappingMat[3][1];
  float topU = styleMappingMat[2][2];
  float topV = styleMappingMat[2][3];

  float sidey = styleMappingMat[3][0];
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }
  } else {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,RI=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_Color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - a_Position.z(judge side by a_Position.z)
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - u - v
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[2][2] = a_uvs[0];
  styleMappingMat[2][3] = 1.0 - a_uvs[1];
  styleMappingMat[3][0] = a_uvs[2];


  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,kI=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      // side notuse linear
       gl_FragColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,DI=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,FI=function(e){(0,Ft.Z)(r,e);var i=MI(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.heightfixed,f=l===void 0?!1:l,d=t.raisingHeight,S=d===void 0?0:d,O=t.topsurface,Z=O===void 0?!0:O,U=t.sidesurface,se=U===void 0?!0:U,le=t.sourceColor,ye=t.targetColor;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:s})){this.judgeStyleAttributes({opacity:s});var Be=this.layer.getEncodedData(),rt=this.calDataFrame(this.cellLength,Be,this.cellProperties),Je=rt.data,Ot=rt.width,jt=rt.height;this.rowCount=jt,this.dataTexture=this.cellLength>0&&Je.length>0?this.createTexture2D({flipY:!0,data:Je,format:Ve.LUMINANCE,type:Ve.FLOAT,width:Ot,height:jt}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}var dr=0,Lr=[1,1,1,1],jr=[1,1,1,1];return le&&ye&&(Lr=Qi(le),jr=Qi(ye),dr=1),{u_topsurface:Number(Z),u_sidesurface:Number(se),u_heightfixed:Number(f),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(S),u_opacity:(0,Kn.isNumber)(s)?s:1,u_linearColor:dr,u_sourceColor:Lr,u_targetColor:jr,u_texture:this.texture}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.loadTexture(),l.abrupt("return",this.buildModels());case 2:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le;return Ze().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=this.getShaders(),Z=O.frag,U=O.vert,se=O.type,Be.next=4,this.layer.buildLayerModel({moduleName:se,vertexShader:U,fragmentShader:Z,triangulation:cC,stencil:yu(f,S)});case 4:return le=Be.sent,Be.abrupt("return",[le]);case 6:case"end":return Be.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),a=t.pickLight,s=t.mapTexture;return s?{frag:LI,vert:RI,type:"polygonExtrudeTexture"}:a?{frag:kI,vert:DI,type:"polygonExtrudePickLight"}:{frag:OI,vert:II,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var t,a;(t=this.dataTexture)===null||t===void 0||t.destroy(),(a=this.texture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){var t=this.layer.getSource().extent,a=(0,Ja.Z)(t,4),s=a[0],l=a[1],f=a[2],d=a[3],S=f-s,O=d-l;this.styleAttributeService.registerStyleAttribute({name:"uvs",type:Da.Attribute,descriptor:{name:"a_uvs",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(U,se,le){var ye=le[0],Be=le[1];return[(ye-s)/S,(Be-l)/O,le[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(U,se,le,ye,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(U){var se=U.size,le=se===void 0?10:se;return Array.isArray(le)?[le[0]]:[le]}}})}},{key:"loadTexture",value:function(){var t=this,a=this.layer.getLayerConfig(),s=a.mapTexture,l=this.rendererService.createTexture2D;if(this.texture=l({height:0,width:0}),s){var f=new Image;f.crossOrigin="",f.src=s,f.onload=function(){t.texture=l({data:f,width:f.width,height:f.height,wrapS:Ve.CLAMP_TO_EDGE,wrapT:Ve.CLAMP_TO_EDGE,min:Ve.LINEAR,mag:Ve.LINEAR}),t.layerService.reRender()}}}}]),r}(il);function BI(e){var i=NI();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function NI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var zI=`uniform float u_opacity: 1.0;
varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,ZI=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;


void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,UI=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}`,jI=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,VI=function(e){(0,Ft.Z)(r,e);var i=BI(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.raisingHeight,s=a===void 0?0:a,l=t.opacity,f=l===void 0?1:l,d=t.opacityLinear,S=d===void 0?{enable:!1,dir:"in"}:d;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:f})){this.judgeStyleAttributes({opacity:f});var O=this.layer.getEncodedData(),Z=this.calDataFrame(this.cellLength,O,this.cellProperties),U=Z.data,se=Z.width,le=Z.height;this.rowCount=le,this.dataTexture=this.cellLength>0&&U.length>0?this.createTexture2D({flipY:!0,data:U,format:Ve.LUMINANCE,type:Ve.FLOAT,width:se,height:le}):this.createTexture2D({flipY:!0,data:[1],format:Ve.LUMINANCE,type:Ve.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(s),u_opacity:(0,Kn.isNumber)(f)?f:1,u_opacitylinear:Number(S.enable),u_dir:S.dir==="in"?1:0}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye,Be,rt,Je;return Ze().wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return s=this.getModelParams(),l=s.frag,f=s.vert,d=s.triangulation,S=s.type,O=this.layer.getLayerConfig(),Z=O.mask,U=Z===void 0?!1:Z,se=O.maskInside,le=se===void 0?!0:se,ye=O.workerEnabled,Be=ye===void 0?!1:ye,rt=O.enablePicking,this.layer.triangulation=d,jt.next=5,this.layer.buildLayerModel({moduleName:S,vertexShader:f,fragmentShader:l,triangulation:d,primitive:Ve.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:yu(U,le),workerEnabled:Be,workerOptions:{modelType:S,enablePicking:rt}});case 5:return Je=jt.sent,jt.abrupt("return",[Je]);case 7:case"end":return jt.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.dataTexture)===null||t===void 0||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){var t=this.layer.getLayerConfig(),a=t.opacityLinear,s=a===void 0?{enable:!1,dir:"in"}:a;s.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Da.Attribute,descriptor:{name:"a_linear",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(f,d,S){return[S[3],S[4],S[5]]}}})}},{key:"getModelParams",value:function(){var t=this.layer.getLayerConfig(),a=t.opacityLinear,s=a===void 0?{enable:!1}:a;return s.enable?{frag:ZI,vert:UI,type:"polygonLinear",triangulation:Y5}:{frag:zI,vert:jI,type:"polygonFill",triangulation:P}}}]),r}(il);function HI(e){var i=GI();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function GI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var $I=`
uniform float u_time: 0.0;
uniform float u_opacity: 1.0;

varying vec2 v_uv;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = u_opacity;
  gl_FragColor = vec4(col, opacity);  
}
`,WI=`attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,XI=function(e){(0,Ft.Z)(r,e);var i=HI(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.watercolor,f=l===void 0?"#6D99A8":l,d=t.watercolor2,S=d===void 0?"#0F121C":d;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:Qi(f),u_watercolor2:Qi(S),u_opacity:(0,Kn.isNumber)(s)?s:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.loadTexture(),l.abrupt("return",this.buildModels());case 2:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,U.next=3,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:WI,fragmentShader:$I,triangulation:gw,primitive:Ve.TRIANGLES,depth:{enable:!1},stencil:yu(f,S)});case 3:return O=U.sent,U.abrupt("return",[O]);case 5:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a,s;(t=this.texture1)===null||t===void 0||t.destroy(),(a=this.texture2)===null||a===void 0||a.destroy(),(s=this.texture3)===null||s===void 0||s.destroy()}},{key:"registerBuiltinAttributes",value:function(){var t=this.layer.getSource().extent,a=(0,Ja.Z)(t,4),s=a[0],l=a[1],f=a[2],d=a[3],S=f-s,O=d-l;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:Da.Attribute,descriptor:{name:"a_uv",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(U,se,le,ye){var Be=U.version===ah["GAODE2.x"]?U.originCoordinates[0][ye]:le,rt=(0,Ja.Z)(Be,2),Je=rt[0],Ot=rt[1];return[(Je-s)/S,(Ot-l)/O]}}})}},{key:"loadTexture",value:function(){var t=this,a=this.rendererService.createTexture2D,s={height:0,width:0};this.texture1=a(s),this.texture2=a(s),this.texture3=a(s),l(function(d){t.texture1=f(d[0]),t.texture2=f(d[1]),t.texture3=f(d[2]),t.layerService.reRender()});function l(d){var S=0,O=[],Z=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];Z.map(function(U){var se=new Image;se.crossOrigin="",se.src=U,O.push(se),se.onload=function(){S++,S===3&&d(O)}})}function f(d){return a({data:d,width:d.width,height:d.height,wrapS:Ve.MIRRORED_REPEAT,wrapT:Ve.MIRRORED_REPEAT,min:Ve.LINEAR,mag:Ve.LINEAR})}}}]),r}(il);function YI(e){var i=KI();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function KI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var qI=`uniform sampler2D u_texture;
uniform float u_time: 0.0;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  float opacity = u_opacity;
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,QI=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;


#pragma include "projection"

void main() {
  v_uv = a_uv;

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,JI=function(e){(0,Ft.Z)(r,e);var i=YI(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.speed,f=l===void 0?.5:l;return{u_texture:this.texture,u_speed:f,u_opacity:(0,Kn.isNumber)(s)?s:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.loadTexture(),l.abrupt("return",this.buildModels());case 2:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,U.next=3,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:QI,fragmentShader:qI,triangulation:gw,primitive:Ve.TRIANGLES,depth:{enable:!1},stencil:yu(f,S)});case 3:return O=U.sent,U.abrupt("return",[O]);case 5:case"end":return U.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.texture)===null||t===void 0||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){var t=this.layer.getSource().extent,a=(0,Ja.Z)(t,4),s=a[0],l=a[1],f=a[2],d=a[3],S=f-s,O=d-l;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:Da.Attribute,descriptor:{name:"a_uv",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(U,se,le,ye){var Be=U.version===ah["GAODE2.x"]?U.originCoordinates[0][ye]:le,rt=(0,Ja.Z)(Be,2),Je=rt[0],Ot=rt[1];return[(Je-s)/S,(Ot-l)/O]}}})}},{key:"loadTexture",value:function(){var t=this,a=this.layer.getLayerConfig(),s=a.waterTexture,l=this.rendererService.createTexture2D;this.texture=l({height:0,width:0});var f=new Image;f.crossOrigin="",s?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),f.src=s):f.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",f.onload=function(){t.texture=l({data:f,width:f.width,height:f.height,wrapS:Ve.MIRRORED_REPEAT,wrapT:Ve.MIRRORED_REPEAT,min:Ve.LINEAR,mag:Ve.LINEAR}),t.layerService.reRender()}}}]),r}(il),e6={fill:VI,line:_C,extrude:FI,text:NC,point_fill:wC,point_image:SC,point_normal:AC,point_extrude:bC,water:JI,ocean:XI},t6=e6;function r6(e){var i=n6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function n6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ZC=function(e){(0,Ft.Z)(r,e);var i=r6(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","PolygonLayer"),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel=new t6[s](this),f.next=4,this.initLayerModels();case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getModelType",value:function(){var t,a=this.styleAttributeService.getLayerStyleAttribute("shape"),s=a==null||(t=a.scale)===null||t===void 0?void 0:t.field;return s==="fill"?"fill":s==="extrude"?"extrude":s==="water"?"water":s==="ocean"?"ocean":s==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var t=this.getEncodedData(),a=this.getLayerConfig(),s=a.shape2d,l=a.shape3d,f=this.iconService.getIconMap(),d=t.find(function(O){return O.hasOwnProperty("shape")});if(d){var S=d.shape;return S==="dot"?"point_normal":(s==null?void 0:s.indexOf(S))!==-1?"point_fill":(l==null?void 0:l.indexOf(S))!==-1?"point_extrude":f.hasOwnProperty(S)?"point_image":"text"}else return"fill"}}]),r}(Dd);function i6(e){var i=a6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function a6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var o6=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;
bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }


void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value))
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
   
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,s6=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,UC=function(e){(0,Ft.Z)(r,e);var i=i6(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.clampLow,f=l===void 0?!0:l,d=t.clampHigh,S=d===void 0?!0:d,O=t.noDataValue,Z=O===void 0?-9999999:O,U=t.domain,se=t.rampColors,le=U||fu(se);return this.colorTexture=this.layer.textureService.getColorTexture(se,le),{u_opacity:s||1,u_texture:this.texture,u_domain:le,u_clampLow:f,u_clampHigh:typeof S!="undefined"?S:f,u_noDataValue:Z,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s){var l,f,d,S;return Ze().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(!Array.isArray(s.data)){Z.next=4;break}return Z.abrupt("return",{data:s.data,width:s.width,height:s.height});case 4:return Z.next=6,s.data;case 6:return l=Z.sent,f=l.rasterData,d=l.width,S=l.height,Z.abrupt("return",{data:Array.from(f),width:d,height:S});case 11:case"end":return Z.stop()}},a)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye,Be,rt;return Ze().wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=this.layer.getSource(),Z=this.rendererService.createTexture2D,U=O.data.dataArray[0],Ot.next=6,this.getRasterData(U);case 6:return se=Ot.sent,le=se.data,ye=se.width,Be=se.height,this.texture=Z({data:le,width:ye,height:Be,format:Ve.LUMINANCE,type:Ve.FLOAT}),Ot.next=13,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:s6,fragmentShader:o6,triangulation:r1,primitive:Ve.TRIANGLES,depth:{enable:!1},stencil:yu(f,S)});case 13:return rt=Ot.sent,Ot.abrupt("return",[rt]);case 15:case"end":return Ot.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;(t=this.texture)===null||t===void 0||t.destroy(),(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(il),u6=["data"],l6=["rasterData"];function c6(e){var i=f6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function f6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var h6=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,p6=`precision mediump float;
uniform vec2 u_rminmax: vec2(0,255); 
uniform vec2 u_gminmax: vec2(0,255);
uniform vec2 u_bminmax: vec2(0,255);
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform float u_noDataValue : 0.0;
varying vec2 v_texCoord;

void main() {
  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;
  if(rgb == vec3(u_noDataValue)) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    gl_FragColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }
 
}`,d6=function(e){(0,Ft.Z)(r,e);var i=c6(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"dataOption",{}),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a,l=t.noDataValue,f=l===void 0?0:l,d=this.dataOption,S=d.rMinMax,O=d.gMinMax,Z=d.bMinMax;return{u_opacity:s||1,u_texture:this.texture,u_noDataValue:f,u_rminmax:S,u_gminmax:O,u_bminmax:Z}}},{key:"getRasterData",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s){var l,f,d,S,O;return Ze().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!Array.isArray(s.data)){U.next=4;break}return l=s.data,f=(0,Xo.Z)(s,u6),this.dataOption=f,U.abrupt("return",(0,ue.Z)({data:l},f));case 4:return U.next=6,s.data;case 6:if(d=U.sent,S=d.rasterData,O=(0,Xo.Z)(d,l6),this.dataOption=O,!Array.isArray(S)){U.next=14;break}return U.abrupt("return",(0,ue.Z)({data:S},O));case 14:return U.abrupt("return",(0,ue.Z)({data:Array.from(S)},O));case 15:case"end":return U.stop()}},a,this)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye,Be,rt;return Ze().wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=this.layer.getSource(),Z=this.rendererService.createTexture2D,U=O.data.dataArray[0],Ot.next=6,this.getRasterData(U);case 6:return se=Ot.sent,le=se.data,ye=se.width,Be=se.height,this.texture=Z({data:le,width:ye,height:Be,format:Ve.RGB,type:Ve.FLOAT}),Ot.next=13,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:h6,fragmentShader:p6,triangulation:r1,primitive:Ve.TRIANGLES,depth:{enable:!1},stencil:yu(f,S)});case 13:return rt=Ot.sent,Ot.abrupt("return",[rt]);case 15:case"end":return Ot.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.texture)===null||t===void 0||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(il);function v6(e){var i=m6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function m6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var g6=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;

void main() {
  vec4 baseColor = texture2D(u_texture, vec2(v_texCoord.x, v_texCoord.y)) * 256.0;
  float r = baseColor.r * 256.0 * 256.0;
  float g = baseColor.g * 256.0;
  float b = baseColor.b;
  float value =  (r + g + b) * 0.1 - 10000.0;
  
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
     gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture2D(u_colorTexture, vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,y6=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,_6=function(e){(0,Ft.Z)(r,e);var i=v6(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=t.clampLow,l=s===void 0?!0:s,f=t.clampHigh,d=f===void 0?!0:f,S=t.noDataValue,O=S===void 0?-9999999:S,Z=t.domain,U=t.rampColors,se=t.colorTexture,le=Z||fu(U),ye=se;return se?this.layer.textureService.setColorTexture(se,U,le):ye=this.layer.textureService.getColorTexture(U,le),{u_opacity:a||1,u_texture:this.texture,u_domain:le,u_clampLow:l,u_clampHigh:typeof d!="undefined"?d:l,u_noDataValue:O,u_colorTexture:ye}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se;return Ze().wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return s=this.layer.getLayerConfig(),l=s.mask,f=l===void 0?!1:l,d=s.maskInside,S=d===void 0?!0:d,O=this.layer.getSource(),Z=this.rendererService.createTexture2D,ye.next=5,O.data.images;case 5:return U=ye.sent,this.texture=Z({data:U[0],width:U[0].width,height:U[0].height}),ye.next=9,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:y6,fragmentShader:g6,triangulation:r1,primitive:Ve.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:yu(f,S)});case 9:return se=ye.sent,ye.abrupt("return",[se]);case 11:case"end":return ye.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t;(t=this.texture)===null||t===void 0||t.destroy()}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(il),x6={raster:UC,rasterRgb:d6,raster3d:UC,rasterTerrainRgb:_6},b6=x6;function E6(e){var i=w6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function w6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Ix=function(e){(0,Ft.Z)(r,e);var i=E6(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","RasterLayer"),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel=new b6[s](this),f.next=4,this.initLayerModels();case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),a={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return a[t]}},{key:"getModelType",value:function(){var t=this.layerSource.getParserType();switch(t){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}}]),r}(Dd);function S6(e){var i=C6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function C6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var A6=function(e){(0,Ft.Z)(r,e);var i=S6(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","TileDebugLayer"),(0,V.Z)((0,ct.Z)(n),"zIndex",1e4),(0,V.Z)((0,ct.Z)(n),"defaultSourceConfig",{data:[],options:{parser:{type:"testTile"}}}),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return");case 1:case"end":return l.stop()}},a)}));function t(){return n.apply(this,arguments)}return t}()}]),r}(Dd);function T6(e){var i=M6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function M6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var P6=`
uniform float u_opacity;
uniform vec3 u_CameraPosition;

varying vec3 vVertexNormal;
varying float v_offset;
varying vec4 v_Color;
void main() {
    
    
    // float intensity = pow(0.5 + dot(normalize(vVertexNormal), normalize(u_CameraPosition)), 3.0);
    float intensity = pow(v_offset + dot(normalize(vVertexNormal), normalize(u_CameraPosition)), 3.0);
    // \u53BB\u9664\u80CC\u9762
    if(intensity > 1.0) intensity = 0.0;

    gl_FragColor = vec4(v_Color.rgb, v_Color.a * intensity * u_opacity);
}
`,O6=`
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute vec2 a_Uv;
attribute vec4 a_Color;
uniform vec3 u_CameraPosition;
varying float v_CamreaDistance;

uniform mat4 u_ViewProjectionMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_ViewMatrix;

varying vec3 vVertexNormal;
varying vec4 v_Color;
varying float v_offset;

void main() {
    float EARTH_RADIUS = 100.0;
    
    v_Color = a_Color;

    v_offset = min(((length(u_CameraPosition) - EARTH_RADIUS)/600.0) * 0.5 + 0.4, 1.0);
    vVertexNormal = a_Normal;

    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);
}
`,I6=function(e){(0,Ft.Z)(r,e);var i=T6(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a;return{u_opacity:(0,Kn.isNumber)(s)?s:1}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){return""}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.layer.zIndex=-997,f.next=3,this.layer.buildLayerModel({moduleName:"earthAtmoSphere",vertexShader:O6,fragmentShader:P6,triangulation:pC,depth:{enable:!1},blend:this.getBlend()});case 3:return s=f.sent,f.abrupt("return",[s]);case 5:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0]]:[l]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f,d){return d}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(il);function L6(e){var i=R6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function R6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var k6=`
uniform sampler2D u_texture;

varying vec2 v_texCoord;
varying float v_lightWeight;


void main() {

    vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
    color.xyz = color.xyz * v_lightWeight;
    gl_FragColor = color;
}
`,D6=`// attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute vec2 a_Uv;
varying vec2 v_texCoord;

// attribute vec2 a_Extrude;
// attribute float a_Size;
// attribute float a_Shape;

uniform vec3 u_CameraPosition;
uniform mat4 u_ViewProjectionMatrix;
uniform mat4 u_ModelMatrix;
uniform float u_ambientRatio : 0.5;
uniform float u_diffuseRatio : 0.3;
uniform float u_specularRatio : 0.2;
uniform vec3 u_sunLight: [1.0, -10.5, 12.0];



float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;

    // cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(u_sunLight);

    vec3 halfDir = normalize(viewDir+lightDir);
    // lambert
    float lambert = dot(worldNormal, lightDir);
    // specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
    //sum to light weight
    float lightWeight = u_ambientRatio + u_diffuseRatio * lambert + u_specularRatio * specular;

    return lightWeight;
}

varying float v_lightWeight;
void main() {

    v_texCoord = a_Uv;

    float lightWeight = calc_lighting(vec4(a_Position, 1.0));
    v_lightWeight = lightWeight;

    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);
}
`,F6=function(e){(0,Ft.Z)(r,e);var i=L6(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"earthTime",3.4),(0,V.Z)((0,ct.Z)(n),"sunX",1e3),(0,V.Z)((0,ct.Z)(n),"sunY",1e3),(0,V.Z)((0,ct.Z)(n),"sunZ",1e3),(0,V.Z)((0,ct.Z)(n),"sunRadius",Math.sqrt(n.sunX*n.sunX+n.sunY*n.sunY+n.sunZ*n.sunZ)),n}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.animateOption,s=t.globalOptions;return a!=null&&a.enable&&(this.mapService.rotateY({reg:.002}),this.earthTime+=.02,this.sunY=10,this.sunX=Math.cos(this.earthTime)*(this.sunRadius-this.sunY),this.sunZ=Math.sin(this.earthTime)*(this.sunRadius-this.sunY)),{u_ambientRatio:(s==null?void 0:s.ambientRatio)||.6,u_diffuseRatio:(s==null?void 0:s.diffuseRatio)||.4,u_specularRatio:(s==null?void 0:s.specularRatio)||.1,u_sunLight:[this.sunX,this.sunY,this.sunZ],u_texture:this.texture}}},{key:"setEarthTime",value:function(t){this.earthTime=t,this.sunY=10,this.sunX=Math.cos(this.earthTime)*(this.sunRadius-this.sunY),this.sunZ=Math.sin(this.earthTime)*(this.sunRadius-this.sunY),this.layerService.throttleRenderLayers()}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s=this,l,f,d,S;return Ze().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return l=this.layer.getLayerConfig(),f=l.globalOptions,(f==null?void 0:f.earthTime)!==void 0&&this.setEarthTime(f.earthTime),d=this.layer.getSource(),S=this.rendererService.createTexture2D,this.texture=S({height:0,width:0}),d.data.images.then(function(U){s.texture=S({data:U[0],width:U[0].width,height:U[0].height}),s.layerService.reRender()}),Z.abrupt("return",this.buildModels());case 7:case"end":return Z.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){return""}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.layer.zIndex=-998,f.next=3,this.layer.buildLayerModel({moduleName:"earthBase",vertexShader:D6,fragmentShader:k6,triangulation:pC,depth:{enable:!0},blend:this.getBlend()});case 3:return s=f.sent,f.abrupt("return",[s]);case 5:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0]]:[l]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f,d){return d}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(il);function B6(e){var i=N6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function N6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var z6=`
uniform float u_opacity;
uniform vec3 u_CameraPosition;
varying vec3 vVertexNormal;

varying vec4 v_Color;
void main() {


    float intensity =  - dot(normalize(vVertexNormal), normalize(u_CameraPosition));
    // \u53BB\u9664\u80CC\u9762
    if(intensity > 1.0) intensity = 0.0;

    gl_FragColor = vec4(v_Color.rgb, v_Color.a * intensity * u_opacity);
}
`,Z6=`
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute vec2 a_Uv;
attribute vec4 a_Color;
uniform vec3 u_CameraPosition;
uniform mat4 u_ViewProjectionMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_ViewMatrix;

varying vec3 vVertexNormal;
varying vec4 v_Color;

void main() {
    v_Color = a_Color;

    vVertexNormal = a_Normal;

    gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * vec4(a_Position, 1.0);
}
`,U6=function(e){(0,Ft.Z)(r,e);var i=B6(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?1:a;return{u_opacity:(0,Kn.isNumber)(s)?s:1}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){return""}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.layer.zIndex=-999,f.next=3,this.layer.buildLayerModel({moduleName:"earthBloom",vertexShader:Z6,fragmentShader:z6,triangulation:e4,depth:{enable:!1},blend:this.getBlend()});case 3:return s=f.sent,f.abrupt("return",[s]);case 5:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Da.Attribute,descriptor:{name:"a_Size",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(a){var s=a.size,l=s===void 0?1:s;return Array.isArray(l)?[l[0]]:[l]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Da.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Ve.STATIC_DRAW,data:[],type:Ve.FLOAT},size:3,update:function(a,s,l,f,d){return d}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}}]),r}(il);function j6(e){var i=V6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function V6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var H6={base:F6,atomSphere:I6,bloomSphere:U6},G6=["base","atomSphere","bloomSphere"],$6=function(e){(0,Ft.Z)(r,e);var i=j6(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","EarthLayer"),(0,V.Z)((0,ct.Z)(n),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel=new H6[s](this),f.next=4,this.initLayerModels();case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"setEarthTime",value:function(t){this.layerModel&&this.layerModel.setEarthTime?this.layerModel.setEarthTime(t):console.warn("\u8BF7\u5728 scene loaded \u4E4B\u540E\u6267\u884C\u8BE5\u65B9\u6CD5\uFF01")}},{key:"getModelType",value:function(){var t,a=this.styleAttributeService.getLayerStyleAttribute("shape"),s=(a==null||(t=a.scale)===null||t===void 0?void 0:t.field)||"base";return G6.indexOf(s)<0&&(s="base"),s}}]),r}(Dd);function W6(e){var i=X6();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function X6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Y6=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,K6=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,q6=function(e){(0,Ft.Z)(r,e);var i=W6(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),a=t.opacity,s=a===void 0?0:a,l=t.color,f=l===void 0?"#000":l;return{u_opacity:(0,Kn.isNumber)(s)?s:0,u_color:Qi(f)}}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.buildModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.layer.buildLayerModel({moduleName:"mask",vertexShader:K6,fragmentShader:Y6,triangulation:gw,depth:{enable:!1},blend:this.getBlend(),stencil:{enable:!0,mask:255,func:{cmp:Ve.ALWAYS,ref:1,mask:255},opFront:{fail:Ve.REPLACE,zfail:Ve.REPLACE,zpass:Ve.REPLACE}},pick:!1});case 2:return s=f.sent,f.abrupt("return",[s]);case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;t&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),r}(il),Q6={fill:q6},J6=Q6;function eL(e){var i=tL();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function tL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Lx=function(e){(0,Ft.Z)(r,e);var i=eL(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","MaskLayer"),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel=new J6[s](this),f.next=4,this.initLayerModels();case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getModelType",value:function(){return"fill"}}]),r}(Dd);function xw(e,i,r){var n=jC(e,e.VERTEX_SHADER,i),t=jC(e,e.FRAGMENT_SHADER,r);if(!n||!t)return null;var a=e.createProgram();if(!a)return null;e.attachShader(a,n),e.attachShader(a,t),e.linkProgram(a);var s=e.getProgramParameter(a,e.LINK_STATUS);if(!s){var l=e.getProgramInfoLog(a);return console.warn("Failed to link program: "+l),e.deleteProgram(a),e.deleteShader(t),e.deleteShader(n),null}for(var f=e.getProgramParameter(a,e.ACTIVE_ATTRIBUTES),d=0;d<f;d++){var S=e.getActiveAttrib(a,d);a[S.name]=e.getAttribLocation(a,S.name)}for(var O=e.getProgramParameter(a,e.ACTIVE_UNIFORMS),Z=0;Z<O;Z++){var U=e.getActiveUniform(a,Z);a[U.name]=e.getUniformLocation(a,U.name)}return a.vertexShader=n,a.fragmentShader=t,a}function jC(e,i,r){var n=e.createShader(i);if(n==null)return console.warn("unable to create shader"),null;e.shaderSource(n,r),e.compileShader(n);var t=e.getShaderParameter(n,e.COMPILE_STATUS);if(!t){var a=e.getShaderInfoLog(n);return console.warn("Failed to compile shader: "+a),e.deleteShader(n),null}return n}function $v(e,i,r,n,t){var a=e.createTexture();return e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,t,0,e.RGBA,e.UNSIGNED_BYTE,r),e.bindTexture(e.TEXTURE_2D,null),a}function rL(e,i,r){var n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.bindTexture(e.TEXTURE_2D,null),n}function Rx(e,i,r){e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,i)}function bw(e,i){var r=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW),r}function TB(e,i,r,n,t){var a=e.createBuffer();a||console.warn("failed create vertex buffer"),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW);var s=e.getAttribLocation(t,i);return e.vertexAttribPointer(s,n,e.FLOAT,!1,0,0),e.enableVertexAttribArray(s),e.bindBuffer(e.ARRAY_BUFFER,null),{buffer:a,attr:s,count:n}}function MB(e,i){var r=e.createBuffer();return r?(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,i,e.STATIC_DRAW)):console.warn("failed create vertex buffer"),r}function PB(e,i,r,n,t){var a=e.getUniformLocation(n,i);return a===null||a<0?console.warn("\u65E0\u6CD5\u83B7\u53D6 uniform \u53D8\u91CF\u7684\u5B58\u50A8\u4F4D\u7F6E"):nL(e,a,r,t),a}function nL(e,i,r,n){switch(n){case"float":e.uniform1f(i,r);break;case"vec2":e.uniform2fv(i,r);break;case"vec3":e.uniform3fv(i,r);break;case"vec4":e.uniform4fv(i,r);break;case"bool":e.uniform1i(i,r);break;case"sampler2d":break;case"mat4":e.uniformMatrix4fv(i,!1,r);break}}function OB(e){var i=e.drawingBufferWidth,r=e.drawingBufferHeight,n=i,t=r,a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a);var s=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,s),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n,t),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,s);var l=e.createTexture();return a.texture=l,a.width=n,a.height=t,e.bindTexture(e.TEXTURE_2D,l),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,t,0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,l,0),e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),{FRAMEBUFFER:a,OFFER_SCREEN_WIDTH:n,OFFER_SCREEN_HEIGHT:t}}var iL=`
 precision mediump float;

 attribute float a_index;

 uniform sampler2D u_particles;
 uniform float u_particles_res;

 varying vec2 v_particle_pos;

 void main() {
     vec4 color = texture2D(u_particles, vec2(
         fract(a_index / u_particles_res),
         floor(a_index / u_particles_res) / u_particles_res)
     );

     // decode current particle position from the pixel's RGBA value
     v_particle_pos = vec2( color.r / 255.0 + color.b, color.g / 255.0 + color.a);

     gl_PointSize = 1.0;
     gl_Position = vec4(2.0 * v_particle_pos.x - 1.0, 1.0 - 2.0 * v_particle_pos.y, 0, 1);
 }`,aL=`
 precision mediump float;

 uniform sampler2D u_wind;
 uniform vec2 u_wind_min;
 uniform vec2 u_wind_max;
 uniform sampler2D u_color_ramp;

 varying vec2 v_particle_pos;

 void main() {
     vec2 velocity = mix(u_wind_min, u_wind_max, texture2D(u_wind, v_particle_pos).rg);
     float speed_t = length(velocity) / length(u_wind_max);

     // color ramp is encoded in a 16x16 texture
     vec2 ramp_pos = vec2( fract(16.0 * speed_t), floor(16.0 * speed_t) / 16.0);

     gl_FragColor = texture2D(u_color_ramp, ramp_pos);
 }`,oL=`
 precision mediump float;

 attribute vec2 a_pos;

 varying vec2 v_tex_pos;

 void main() {
     v_tex_pos = a_pos;
     gl_Position = vec4(1.0 - 2.0 * a_pos, 0, 1);
     // framebuffer \u59CB\u7EC8\u7528\u94FA\u6EE1\u5C4F\u5E55\u7684 texture
 }`,sL=`
 precision highp float;

 uniform sampler2D u_particles;
 uniform sampler2D u_wind;
 uniform vec2 u_wind_res;
 uniform vec2 u_wind_min;
 uniform vec2 u_wind_max;
 uniform float u_rand_seed;
 uniform float u_speed_factor;
 uniform float u_drop_rate;
 uniform float u_drop_rate_bump;

 varying vec2 v_tex_pos;

 // pseudo-random generator
 const vec3 rand_constants = vec3(12.9898, 78.233, 4375.85453);
 float rand(const vec2 co) {
 float t = dot(rand_constants.xy, co);
     return fract(sin(t) * (rand_constants.z + t));
 }

 // wind speed lookup; use manual bilinear filtering based on 4 adjacent pixels for smooth interpolation
 vec2 lookup_wind(const vec2 uv) {
     // return texture2D(u_wind, uv).rg; // lower-res hardware filtering
     vec2 px = 1.0 / u_wind_res;
     vec2 vc = (floor(uv * u_wind_res)) * px;
     vec2 f = fract(uv * u_wind_res);
     vec2 tl = texture2D(u_wind, vc).rg;
     vec2 tr = texture2D(u_wind, vc + vec2(px.x, 0)).rg;
     vec2 bl = texture2D(u_wind, vc + vec2(0, px.y)).rg;
     vec2 br = texture2D(u_wind, vc + px).rg;
     return mix(mix(tl, tr, f.x), mix(bl, br, f.x), f.y);
 }

 void main() {
     vec4 color = texture2D(u_particles, v_tex_pos);
     vec2 pos = vec2(
         color.r / 255.0 + color.b,
         color.g / 255.0 + color.a); // decode particle position from pixel RGBA
     vec2 velocity = mix(u_wind_min, u_wind_max, lookup_wind(pos));
     float speed_t = length(velocity) / length(u_wind_max);

     // take EPSG:4236 distortion into account for calculating where the particle moved
     float distortion = cos(radians(pos.y * 180.0 - 90.0));
     vec2 offset = vec2(velocity.x / distortion, -velocity.y) * 0.0001 * u_speed_factor;

     // update particle position, wrapping around the date line
     pos = fract(1.0 + pos + offset);

     // a random seed to use for the particle drop
     vec2 seed = (pos + v_tex_pos) * u_rand_seed;

     // drop rate is a chance a particle will restart at random position, to avoid degeneration
     float drop_rate = u_drop_rate + speed_t * u_drop_rate_bump;
     float drop = step(1.0 - drop_rate, rand(seed));

     vec2 random_pos = vec2(
         rand(seed + 1.3),
         rand(seed + 2.1));
         pos = mix(pos, random_pos, drop);

     // encode the new particle position back into RGBA
     gl_FragColor = vec4(
         fract(pos * 255.0),
         floor(pos * 255.0) / 255.0);
 }`,uL=`
     precision mediump float;

     attribute vec2 a_pos;

     varying vec2 v_tex_pos;

     void main() {
         v_tex_pos = a_pos;
         gl_Position = vec4(1.0 - 2.0 * a_pos, 0.0, 1.0);
         gl_PointSize = 100.0;
 }`,lL=`
 precision mediump float;

 uniform sampler2D u_screen;
 uniform float u_opacity;
 varying vec2 v_tex_pos;

 void main() {
     vec4 color = texture2D(u_screen, 1.0 - v_tex_pos);

     // a hack to guarantee opacity fade out even with a value close to 1.0
     gl_FragColor = vec4(floor(255.0 * color * u_opacity) / 255.0);
 }`;function VC(e){var i=document.createElement("canvas"),r=i.getContext("2d");i.width=256,i.height=1;for(var n=r.createLinearGradient(0,0,256,0),t=0,a=Object.keys(e);t<a.length;t++){var s=a[t];n.addColorStop(+s,e[+s])}return r.fillStyle=n,r.fillRect(0,0,256,1),i=null,new Uint8Array(r.getImageData(0,0,256,1).data)}function HC(e,i,r,n){e.bindBuffer(e.ARRAY_BUFFER,i),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,n,e.FLOAT,!1,0,0)}function kx(e,i,r){e.bindFramebuffer(e.FRAMEBUFFER,i),r&&e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}var cL=function(){function e(i){(0,re.Z)(this,e),(0,V.Z)(this,"width",512),(0,V.Z)(this,"height",512),(0,V.Z)(this,"numParticles",65536),this.gl=i.glContext,this.width=i.imageWidth,this.height=i.imageHeight,this.fadeOpacity=i.fadeOpacity,this.speedFactor=i.speedFactor,this.dropRate=i.dropRate,this.dropRateBump=i.dropRateBump,this.rampColors=i.rampColors,this.init()}return(0,he.Z)(e,[{key:"init",value:function(){var r=this.gl;this.fadeOpacity=.996,this.speedFactor=.25,this.dropRate=.003,this.dropRateBump=.01,this.drawProgram=xw(r,iL,aL),this.fullScreenProgram=xw(r,uL,lL),this.updateProgram=xw(r,oL,sL),this.quadBuffer=bw(r,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])),this.framebuffer=r.createFramebuffer(),this.colorRampTexture=$v(this.gl,this.gl.LINEAR,VC(this.rampColors),16,16);var n=new Uint8Array(this.width*this.height*4);this.backgroundTexture=$v(r,r.NEAREST,n,this.width,this.height),this.screenTexture=$v(r,r.NEAREST,n,this.width,this.height);var t=this.particleStateResolution=Math.ceil(Math.sqrt(this.numParticles));this.numParticlesSize=t*t;for(var a=new Uint8Array(this.numParticlesSize*4),s=0;s<a.length;s++)a[s]=Math.floor(Math.random()*256);this.particleStateTexture0=$v(r,r.NEAREST,a,t,t),this.particleStateTexture1=$v(r,r.NEAREST,a,t,t);for(var l=new Float32Array(this.numParticlesSize),f=0;f<this.numParticlesSize;f++)l[f]=f;this.particleIndexBuffer=bw(r,l)}},{key:"setWind",value:function(r){this.windData=r,this.windTexture=rL(this.gl,this.gl.LINEAR,r.image)}},{key:"updateParticelNum",value:function(r){var n=this.gl;if(r!==this.numParticles){this.numParticles=r;var t=this.particleStateResolution=Math.ceil(Math.sqrt(this.numParticles));this.numParticlesSize=t*t;for(var a=new Uint8Array(this.numParticlesSize*4),s=0;s<a.length;s++)a[s]=Math.floor(Math.random()*256);this.particleStateTexture0=$v(n,n.NEAREST,a,t,t),this.particleStateTexture1=$v(n,n.NEAREST,a,t,t);for(var l=new Float32Array(this.numParticlesSize),f=0;f<this.numParticlesSize;f++)l[f]=f;this.particleIndexBuffer=bw(n,l)}}},{key:"updateWindDir",value:function(r,n,t,a){this.windData.uMin=r,this.windData.uMax=n,this.windData.vMin=t,this.windData.vMax=a}},{key:"updateColorRampTexture",value:function(r){if(this.isColorChanged(r)){this.rampColors=r;var n=this.gl;n.deleteTexture(this.colorRampTexture),this.colorRampTexture=$v(n,n.LINEAR,VC(r),16,16)}}},{key:"isColorChanged",value:function(r){for(var n=Object.keys(r),t=0,a=n;t<a.length;t++){var s=a[t],l=Number(s);if(!this.rampColors[l]||this.rampColors[l]&&this.rampColors[l]!==r[l])return!0}return!1}},{key:"reSize",value:function(r,n){if(r!==this.width||n!==this.height){var t=this.gl;t.deleteTexture(this.backgroundTexture),t.deleteTexture(this.screenTexture),this.width=r,this.height=n;var a=new Uint8Array(r*n*4);this.backgroundTexture=$v(t,t.NEAREST,a,r,n),this.screenTexture=$v(t,t.NEAREST,a,r,n)}}},{key:"draw",value:function(){var r;if((r=this.windData)!==null&&r!==void 0&&r.image){var n=this.gl;return Rx(n,this.windTexture,0),Rx(n,this.particleStateTexture0,1),this.drawScreen(),this.updateParticles(),{d:this.pixels,w:this.width,h:this.height}}else return{d:new Uint8Array([0,0,0,0]),w:1,h:1}}},{key:"drawScreen",value:function(){var r=this.gl;kx(r,this.framebuffer,this.screenTexture),r.viewport(0,0,this.width,this.height),r.disable(r.BLEND),this.drawFullTexture(this.backgroundTexture,this.fadeOpacity),this.drawParticles(),this.pixels=new Uint8Array(4*this.width*this.height),r.readPixels(0,0,this.width,this.height,r.RGBA,r.UNSIGNED_BYTE,this.pixels),kx(r,null,null),r.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);var n=this.backgroundTexture;this.backgroundTexture=this.screenTexture,this.screenTexture=n}},{key:"drawFullTexture",value:function(r,n){var t=this.gl,a=this.fullScreenProgram;t.useProgram(a),t.bindBuffer(t.ARRAY_BUFFER,this.quadBuffer),t.vertexAttribPointer(a.a_pos,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(a.a_pos),t.bindBuffer(t.ARRAY_BUFFER,null),Rx(t,r,2),t.uniform1i(a.u_screen,2),t.uniform1f(a.u_opacity,n),t.drawArrays(t.TRIANGLES,0,6)}},{key:"drawParticles",value:function(){var r=this.gl,n=this.drawProgram;r.useProgram(n),HC(r,this.particleIndexBuffer,n.a_index,1),Rx(r,this.colorRampTexture,2),r.uniform1i(n.u_wind,0),r.uniform1i(n.u_particles,1),r.uniform1i(n.u_color_ramp,2),r.uniform1f(n.u_particles_res,this.particleStateResolution),r.uniform2f(n.u_wind_min,this.windData.uMin,this.windData.vMin),r.uniform2f(n.u_wind_max,this.windData.uMax,this.windData.vMax),r.drawArrays(r.POINTS,0,this.numParticlesSize)}},{key:"updateParticles",value:function(){var r=this.gl;kx(r,this.framebuffer,this.particleStateTexture1),r.viewport(0,0,this.particleStateResolution,this.particleStateResolution);var n=this.updateProgram;r.useProgram(n),HC(r,this.quadBuffer,n.a_pos,2),r.uniform1i(n.u_wind,0),r.uniform1i(n.u_particles,1),r.uniform1f(n.u_rand_seed,Math.random()),r.uniform2f(n.u_wind_res,this.windData.image.width*2,this.windData.image.height*2),r.uniform2f(n.u_wind_min,this.windData.uMin,this.windData.vMin),r.uniform2f(n.u_wind_max,this.windData.uMax,this.windData.vMax),r.uniform1f(n.u_speed_factor,this.speedFactor),r.uniform1f(n.u_drop_rate,this.dropRate),r.uniform1f(n.u_drop_rate_bump,this.dropRateBump),r.drawArrays(r.TRIANGLES,0,6);var t=this.particleStateTexture0;this.particleStateTexture0=this.particleStateTexture1,this.particleStateTexture1=t,kx(r,null,null)}},{key:"destroy",value:function(){this.gl.deleteBuffer(this.quadBuffer),this.gl.deleteBuffer(this.particleIndexBuffer),this.gl.deleteFramebuffer(this.framebuffer),this.gl.deleteShader(this.drawProgram.vertexShader),this.gl.deleteShader(this.drawProgram.fragmentShader),this.gl.deleteProgram(this.drawProgram),this.gl.deleteShader(this.fullScreenProgram.vertexShader),this.gl.deleteShader(this.fullScreenProgram.fragmentShader),this.gl.deleteProgram(this.fullScreenProgram),this.gl.deleteShader(this.updateProgram.vertexShader),this.gl.deleteShader(this.updateProgram.fragmentShader),this.gl.deleteProgram(this.updateProgram),this.gl.deleteTexture(this.colorRampTexture),this.gl.deleteTexture(this.backgroundTexture),this.gl.deleteTexture(this.screenTexture),this.gl.deleteTexture(this.particleStateTexture0),this.gl.deleteTexture(this.particleStateTexture1),this.gl.deleteTexture(this.windTexture)}}]),e}();function fL(e){var i=hL();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function hL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var pL=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,dL=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,GC={0:"#3288bd",.1:"#66c2a5",.2:"#abdda4",.3:"#e6f598",.4:"#fee08b",.5:"#fdae61",.6:"#f46d43",1:"#d53e4f"},vL=function(e){(0,Ft.Z)(r,e);var i=fL(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"sizeScale",.5),(0,V.Z)((0,ct.Z)(n),"frequency",new Nr(7.2)),n}return(0,he.Z)(r,[{key:"render",value:function(){var t=this;this.frequency.run(function(){t.drawWind()}),this.drawColorMode()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d=this,S,O,Z,U,se,le,ye,Be,rt,Je,Ot,jt,dr,Lr,jr,Jr,Pn,In,Si,ra,Va,Ms,vu,Bu,zl,_l,_h,Pv,wd;return Ze().wrap(function(Xd){for(;;)switch(Xd.prev=Xd.next){case 0:return S=this.layer.getLayerConfig(),O=S.uMin,Z=O===void 0?-21.32:O,U=S.uMax,se=U===void 0?26.8:U,le=S.vMin,ye=le===void 0?-21.57:le,Be=S.vMax,rt=Be===void 0?21.42:Be,Je=S.fadeOpacity,Ot=Je===void 0?.996:Je,jt=S.speedFactor,dr=jt===void 0?.25:jt,Lr=S.dropRate,jr=Lr===void 0?.003:Lr,Jr=S.dropRateBump,Pn=Jr===void 0?.01:Jr,In=S.rampColors,Si=In===void 0?GC:In,ra=S.sizeScale,Va=ra===void 0?.5:ra,Ms=S.mask,vu=Ms===void 0?!1:Ms,Bu=S.maskInside,zl=Bu===void 0?!0:Bu,_l=this.rendererService.createTexture2D,_h=this.layer.getSource(),this.texture=_l({height:0,width:0}),this.cacheZoom=Math.floor(this.mapService.getZoom()),Pv=this.rendererService.getGLContext(),this.imageCoords=(s=_h.data)===null||s===void 0?void 0:s.dataArray[0].coordinates,(l=_h.data)===null||l===void 0||(f=l.images)===null||f===void 0||f.then(function(hf){var $h;d.sizeScale=Va*d.getZoomScale();var ng=d.getWindSize(),ig=ng.imageWidth,hs=ng.imageHeight,Cl={glContext:Pv,imageWidth:ig,imageHeight:hs,fadeOpacity:Ot,speedFactor:dr,dropRate:jr,dropRateBump:Pn,rampColors:Si};d.wind=new cL(Cl),d.wind.setWind({uMin:Z,uMax:se,vMin:ye,vMax:rt,image:hf[0]}),($h=d.texture)===null||$h===void 0||$h.destroy(),d.texture=_l({width:ig,height:hs}),d.layerService.reRender()}),Xd.next=10,this.layer.buildLayerModel({moduleName:"wind",vertexShader:dL,fragmentShader:pL,triangulation:r1,primitive:Ve.TRIANGLES,depth:{enable:!1},stencil:yu(vu,zl),blend:this.getBlend()});case 10:return wd=Xd.sent,this.colorModel=wd,Xd.abrupt("return",[wd]);case 13:case"end":return Xd.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getWindSize",value:function(){var t=this.mapService.lngLatToPixel(this.imageCoords[0]),a=this.mapService.lngLatToPixel(this.imageCoords[1]),s=Math.min(Math.floor((a.x-t.x)*this.sizeScale),2048),l=Math.min(Math.floor((t.y-a.y)*this.sizeScale),2048);return{imageWidth:s,imageHeight:l}}},{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.initModels());case 1:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"clearModels",value:function(){var t,a;(t=this.texture)===null||t===void 0||t.destroy(),(a=this.wind)===null||a===void 0||a.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Da.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:2,update:function(a,s,l){return[l[3],l[4]]}}})}},{key:"getZoomScale",value:function(){return Math.min((this.cacheZoom+4)/30*2,2)}},{key:"drawWind",value:function(){if(this.wind){var t=this.layer.getLayerConfig(),a=t.uMin,s=a===void 0?-21.32:a,l=t.uMax,f=l===void 0?26.8:l,d=t.vMin,S=d===void 0?-21.57:d,O=t.vMax,Z=O===void 0?21.42:O,U=t.numParticles,se=U===void 0?65535:U,le=t.fadeOpacity,ye=le===void 0?.996:le,Be=t.speedFactor,rt=Be===void 0?.25:Be,Je=t.dropRate,Ot=Je===void 0?.003:Je,jt=t.dropRateBump,dr=jt===void 0?.01:jt,Lr=t.rampColors,jr=Lr===void 0?GC:Lr,Jr=t.sizeScale,Pn=Jr===void 0?.5:Jr,In=se,Si=Math.floor(this.mapService.getZoom());if(typeof Pn=="number"&&Pn!==this.sizeScale||Si!==this.cacheZoom){var ra=this.getZoomScale();this.sizeScale=Pn,In*=ra;var Va=this.getWindSize(),Ms=Va.imageWidth,vu=Va.imageHeight;this.wind.reSize(Ms,vu),this.cacheZoom=Si}this.wind.updateWindDir(s,f,S,Z),this.wind.updateParticelNum(In),this.wind.updateColorRampTexture(jr),this.wind.fadeOpacity=ye,this.wind.speedFactor=rt,this.wind.dropRate=Ot,this.wind.dropRateBump=dr;var Bu=this.wind.draw(),zl=Bu.d,_l=Bu.w,_h=Bu.h;this.rendererService.setBaseState(),this.texture.update({data:zl,width:_l,height:_h})}}},{key:"drawColorMode",value:function(){var t,a=this.layer.getLayerConfig(),s=a.opacity;this.layerService.beforeRenderData(this.layer),this.layer.hooks.beforeRender.call(),this.layerService.renderMask(this.layer.masks),(t=this.colorModel)===null||t===void 0||t.draw({uniforms:{u_opacity:s||1,u_texture:this.texture}}),this.layer.hooks.afterRender.call()}}]),r}(il),mL={wind:vL},gL=mL;function yL(e){var i=_L();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function _L(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var xL=function(e){(0,Ft.Z)(r,e);var i=yL(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","WindLayer"),n}return(0,he.Z)(r,[{key:"buildModels",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=this.getModelType(),this.layerModel=new gL[s](this),f.next=4,this.initLayerModels();case 4:case"end":return f.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"renderModels",value:function(){return this.layerModel&&this.layerModel.render(),this}},{key:"getDefaultConfig",value:function(){var t=this.getModelType(),a={wind:{}};return a[t]}},{key:"getModelType",value:function(){return"wind"}}]),r}(Dd),$C,WC,XC,YC,Dx,KC,qC,bL=($C=(0,Xr.b2)(),WC=(0,Xr.f3)(Ir.IMapService),XC=(0,Xr.f3)(Ir.IFontService),$C(YC=(Dx=function(){function e(){(0,re.Z)(this,e),Ys(this,"mapService",KC,this),Ys(this,"fontService",qC,this)}return(0,he.Z)(e,[{key:"apply",value:function(r,n){var t=this,a=n.styleAttributeService;r.hooks.init.tapPromise("DataMappingPlugin",(0,Dt.Z)(Ze().mark(function s(){return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:r.log(nh.MappingStart,ih.INIT),t.generateMaping(r,{styleAttributeService:a}),r.log(nh.MappingEnd,ih.INIT);case 3:case"end":return f.stop()}},s)}))),r.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var s=(0,Dt.Z)(Ze().mark(function l(f){var d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(f){O.next=2;break}return O.abrupt("return",f);case 2:return r.dataState.dataMappingNeedUpdate=!1,r.log(nh.MappingStart,ih.UPDATE),d=t.generateMaping(r,{styleAttributeService:a}),r.log(nh.MappingEnd,ih.UPDATE),O.abrupt("return",d);case 7:case"end":return O.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()),r.hooks.beforeRender.tap("DataMappingPlugin",function(){var s=r.getSource();if(!(r.layerModelNeedUpdate||!s||!s.inited)){var l=a.getLayerStyleAttributes()||[],f=a.getLayerStyleAttribute("filter"),d=s.data.dataArray;if(!(Array.isArray(d)&&d.length===0)){var S=l.filter(function(U){return U.needRemapping}),O=d;if(f!=null&&f.needRemapping&&f!==null&&f!==void 0&&f.scale&&(O=d.filter(function(U){return t.applyAttributeMapping(f,U)[0]})),S.length){var Z=t.mapping(r,S,O,r.getEncodedData());r.setEncodedData(Z)}}}})}},{key:"generateMaping",value:function(r,n){var t=this,a=n.styleAttributeService,s=a.getLayerStyleAttributes()||[],l=a.getLayerStyleAttribute("filter"),f=r.getSource().data.dataArray,d=f;l!=null&&l.scale&&(d=f.filter(function(O){return t.applyAttributeMapping(l,O)[0]})),d=r.processData(d);var S=this.mapping(r,s,d,void 0);return r.setEncodedData(S),f.length===0&&r.encodeDataLength===0?!1:(r.emit("dataUpdate",null),!0)}},{key:"mapping",value:function(r,n,t,a){var s=this,l=r.getLayerConfig(),f=l.arrow,d=f===void 0?{enable:!1}:f,S=n.filter(function(Z){return Z.scale!==void 0}).filter(function(Z){return Z.name!=="filter"}),O=t.map(function(Z,U){var se=a?a[U]:{},le=(0,ue.Z)({id:Z._id,coordinates:Z.coordinates},se);if(S.forEach(function(rt){var Je=s.applyAttributeMapping(rt,Z);rt.name==="color"&&(Je=Je.map(function(Ot){return Qi(Ot)})),le[rt.name]=Array.isArray(Je)&&Je.length===1?Je[0]:Je,rt.name==="shape"&&(le.shape=s.fontService.getIconFontKey(le[rt.name]))}),d.enable&&(le.shape==="line"||le.shape==="halfLine")){var ye=le.coordinates;if(r.arrowInsertCount<r.encodeDataLength){var Be=s.getArrowPoints(ye[0],ye[1]);le.coordinates.splice(1,0,Be,Be),r.arrowInsertCount++}}return le});return n.forEach(function(Z){Z.needRemapping=!1}),this.adjustData2Amap2Coordinates(O,r),this.adjustData2SimpleCoordinates(O),O}},{key:"adjustData2Amap2Coordinates",value:function(r,n){var t=this;if(r.length>0&&this.mapService.version===ah["GAODE2.x"]){var a=n.coordCenter||n.getSource().center;typeof r[0].coordinates[0]=="number"?r.filter(function(s){return!s.originCoordinates}).map(function(s){s.version=ah["GAODE2.x"],s.originCoordinates=(0,Kn.cloneDeep)(s.coordinates),s.coordinates=t.mapService.lngLatToCoordByLayer(s.coordinates,a)}):r.filter(function(s){return!s.originCoordinates}).map(function(s){s.version=ah["GAODE2.x"],s.originCoordinates=(0,Kn.cloneDeep)(s.coordinates),s.coordinates=t.mapService.lngLatToCoordsByLayer(s.coordinates,a)})}}},{key:"adjustData2SimpleCoordinates",value:function(r){var n=this;r.length>0&&this.mapService.version===ah.SIMPLE&&r.map(function(t){t.simpleCoordinate||(t.coordinates=n.unProjectCoordinates(t.coordinates),t.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(r){var n=this;if(typeof r[0]=="number")return this.mapService.simpleMapCoord.unproject(r);if(r[0]&&r[0][0]instanceof Array){var t=[];return r.map(function(s){var l=[];s.map(function(f){l.push(n.mapService.simpleMapCoord.unproject(f))}),t.push(l)}),t}else{var a=[];return r.map(function(s){a.push(n.mapService.simpleMapCoord.unproject(s))}),a}}},{key:"applyAttributeMapping",value:function(r,n){var t;if(!r.scale)return[];var a=(r==null||(t=r.scale)===null||t===void 0?void 0:t.scalers)||[],s=[];a.forEach(function(f){var d,S=f.field;(n.hasOwnProperty(S)||((d=r.scale)===null||d===void 0?void 0:d.type)==="variable")&&s.push(n[S])});var l=r.mapping?r.mapping(s):[];return l}},{key:"getArrowPoints",value:function(r,n){var t=[n[0]-r[0],n[1]-r[1]],a=Ou(t),s=[r[0]+a[0]*1e-4,r[1]+a[1]*1e-4];return s}}]),e}(),KC=Hs(Dx.prototype,"mapService",[WC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qC=Hs(Dx.prototype,"fontService",[XC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dx))||YC),QC,JC,EL=(QC=(0,Xr.b2)(),QC(JC=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"apply",value:function(r){var n=this;this.mapService=r.getContainer().get(Ir.IMapService),r.hooks.init.tapPromise("DataSourcePlugin",(0,Dt.Z)(Ze().mark(function t(){var a,s,l,f;return Ze().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(r.log(nh.SourceInitStart,ih.INIT),a=r.getSource(),a||(s=r.sourceOption||r.defaultSourceConfig,l=s.data,f=s.options,a=new Hv(l,f),r.setSource(a)),!a.inited){S.next=8;break}n.updateClusterData(r),r.log(nh.SourceInitEnd,ih.INIT),S.next=10;break;case 8:return S.next=10,new Promise(function(O){a.on("update",function(Z){Z.type==="inited"&&(n.updateClusterData(r),r.log(nh.SourceInitEnd,ih.INIT)),O(null)})});case 10:case"end":return S.stop()}},t)}))),r.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,Dt.Z)(Ze().mark(function t(){var a,s,l;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a=n.updateClusterData(r),s=r.dataState.dataSourceNeedUpdate,r.dataState.dataSourceNeedUpdate=!1,l=a||s,d.abrupt("return",l);case 5:case"end":return d.stop()}},t)})))}},{key:"updateClusterData",value:function(r){if(r.isTileLayer||r.tileLayer||!r.getSource())return!1;var n=r.getSource(),t=n.cluster,a=n.clusterOptions.zoom,s=a===void 0?0:a,l=this.mapService.getZoom()-1,f=r.dataState.dataSourceNeedUpdate;return t&&f&&n.updateClusterData(Math.floor(l)),t&&Math.abs(r.clusterZoom-l)>=1?(s!==Math.floor(l)&&n.updateClusterData(Math.floor(l)),r.clusterZoom=l,!0):!1}}]),e}())||JC);function Ew(e,i){return e<i?-1:e>i?1:e>=i?0:NaN}function eA(e){return e.length===1&&(e=wL(e)),{left:function(i,r,n,t){for(n==null&&(n=0),t==null&&(t=i.length);n<t;){var a=n+t>>>1;e(i[a],r)<0?n=a+1:t=a}return n},right:function(i,r,n,t){for(n==null&&(n=0),t==null&&(t=i.length);n<t;){var a=n+t>>>1;e(i[a],r)>0?t=a:n=a+1}return n}}}function wL(e){return function(i,r){return Ew(e(i),r)}}var tA=eA(Ew),SL=tA.right,IB=tA.left,Fx=SL;function rA(e,i){var r=e.length,n=-1,t,a,s;if(i==null){for(;++n<r;)if((t=e[n])!=null&&t>=t)for(a=s=t;++n<r;)(t=e[n])!=null&&(a>t&&(a=t),s<t&&(s=t))}else for(;++n<r;)if((t=i(e[n],n,e))!=null&&t>=t)for(a=s=t;++n<r;)(t=i(e[n],n,e))!=null&&(a>t&&(a=t),s<t&&(s=t));return[a,s]}var nA=Array.prototype,LB=nA.slice,RB=nA.map,ww=Math.sqrt(50),Sw=Math.sqrt(10),Cw=Math.sqrt(2);function iA(e,i,r){var n,t=-1,a,s,l;if(i=+i,e=+e,r=+r,e===i&&r>0)return[e];if((n=i<e)&&(a=e,e=i,i=a),(l=Bx(e,i,r))===0||!isFinite(l))return[];if(l>0)for(e=Math.ceil(e/l),i=Math.floor(i/l),s=new Array(a=Math.ceil(i-e+1));++t<a;)s[t]=(e+t)*l;else for(e=Math.floor(e*l),i=Math.ceil(i*l),s=new Array(a=Math.ceil(e-i+1));++t<a;)s[t]=(e-t)/l;return n&&s.reverse(),s}function Bx(e,i,r){var n=(i-e)/Math.max(0,r),t=Math.floor(Math.log(n)/Math.LN10),a=n/Math.pow(10,t);return t>=0?(a>=ww?10:a>=Sw?5:a>=Cw?2:1)*Math.pow(10,t):-Math.pow(10,-t)/(a>=ww?10:a>=Sw?5:a>=Cw?2:1)}function Aw(e,i,r){var n=Math.abs(i-e)/Math.max(0,r),t=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),a=n/t;return a>=ww?t*=10:a>=Sw?t*=5:a>=Cw&&(t*=2),i<e?-t:t}function kB(){var e=identity,i=extent,r=sturges;function n(t){var a,s=t.length,l,f=new Array(s);for(a=0;a<s;++a)f[a]=e(t[a],a,t);var d=i(f),S=d[0],O=d[1],Z=r(f,S,O);Array.isArray(Z)||(Z=tickStep(S,O,Z),Z=range(Math.ceil(S/Z)*Z,O,Z));for(var U=Z.length;Z[0]<=S;)Z.shift(),--U;for(;Z[U-1]>O;)Z.pop(),--U;var se=new Array(U+1),le;for(a=0;a<=U;++a)le=se[a]=[],le.x0=a>0?Z[a-1]:S,le.x1=a<U?Z[a]:O;for(a=0;a<s;++a)l=f[a],S<=l&&l<=O&&se[bisect(Z,l,0,U)].push(t[a]);return se}return n.value=function(t){return arguments.length?(e=typeof t=="function"?t:constant(t),n):e},n.domain=function(t){return arguments.length?(i=typeof t=="function"?t:constant([t[0],t[1]]),n):i},n.thresholds=function(t){return arguments.length?(r=typeof t=="function"?t:Array.isArray(t)?constant(slice.call(t)):constant(t),n):r},n}function DB(e,i,r){return e=map.call(e,number).sort(ascending),Math.ceil((r-i)/(2*(quantile(e,.75)-quantile(e,.25))*Math.pow(e.length,-1/3)))}function CL(e){return e===null?NaN:+e}function AL(e,i,r){if(r==null&&(r=CL),!!(n=e.length)){if((i=+i)<=0||n<2)return+r(e[0],0,e);if(i>=1)return+r(e[n-1],n-1,e);var n,t=(n-1)*i,a=Math.floor(t),s=+r(e[a],a,e),l=+r(e[a+1],a+1,e);return s+(l-s)*(t-a)}}function aA(e,i,r,n,t){var a=e*e,s=a*e;return((1-3*e+3*a-s)*i+(4-6*a+3*s)*r+(1+3*e+3*a-3*s)*n+s*t)/6}function TL(e){var i=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,i-1):Math.floor(r*i),t=e[n],a=e[n+1],s=n>0?e[n-1]:2*t-a,l=n<i-1?e[n+2]:2*a-t;return aA((r-n/i)*i,s,t,a,l)}}function ML(e){var i=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*i),t=e[(n+i-1)%i],a=e[n%i],s=e[(n+1)%i],l=e[(n+2)%i];return aA((r-n/i)*i,t,a,s,l)}}function Tw(e){return function(){return e}}function oA(e,i){return function(r){return e+r*i}}function PL(e,i,r){return e=Math.pow(e,r),i=Math.pow(i,r)-e,r=1/r,function(n){return Math.pow(e+n*i,r)}}function FB(e,i){var r=i-e;return r?oA(e,r>180||r<-180?r-360*Math.round(r/360):r):constant(isNaN(e)?i:e)}function OL(e){return(e=+e)==1?sA:function(i,r){return r-i?PL(i,r,e):Tw(isNaN(i)?r:i)}}function sA(e,i){var r=i-e;return r?oA(e,r):Tw(isNaN(e)?i:e)}var uA=function e(i){var r=OL(i);function n(t,a){var s=r((t=tc(t)).r,(a=tc(a)).r),l=r(t.g,a.g),f=r(t.b,a.b),d=sA(t.opacity,a.opacity);return function(S){return t.r=s(S),t.g=l(S),t.b=f(S),t.opacity=d(S),t+""}}return n.gamma=e,n}(1);function lA(e){return function(i){var r=i.length,n=new Array(r),t=new Array(r),a=new Array(r),s,l;for(s=0;s<r;++s)l=tc(i[s]),n[s]=l.r||0,t[s]=l.g||0,a[s]=l.b||0;return n=e(n),t=e(t),a=e(a),l.opacity=1,function(f){return l.r=n(f),l.g=t(f),l.b=a(f),l+""}}}var IL=lA(TL),BB=lA(ML),lv="$";function Nx(){}Nx.prototype=cA.prototype={constructor:Nx,has:function(e){return lv+e in this},get:function(e){return this[lv+e]},set:function(e,i){return this[lv+e]=i,this},remove:function(e){var i=lv+e;return i in this&&delete this[i]},clear:function(){for(var e in this)e[0]===lv&&delete this[e]},keys:function(){var e=[];for(var i in this)i[0]===lv&&e.push(i.slice(1));return e},values:function(){var e=[];for(var i in this)i[0]===lv&&e.push(this[i]);return e},entries:function(){var e=[];for(var i in this)i[0]===lv&&e.push({key:i.slice(1),value:this[i]});return e},size:function(){var e=0;for(var i in this)i[0]===lv&&++e;return e},empty:function(){for(var e in this)if(e[0]===lv)return!1;return!0},each:function(e){for(var i in this)i[0]===lv&&e(this[i],i.slice(1),this)}};function cA(e,i){var r=new Nx;if(e instanceof Nx)e.each(function(l,f){r.set(f,l)});else if(Array.isArray(e)){var n=-1,t=e.length,a;if(i==null)for(;++n<t;)r.set(n,e[n]);else for(;++n<t;)r.set(i(a=e[n],n,e),a)}else if(e)for(var s in e)r.set(s,e[s]);return r}var Mw=cA;function NB(){var e=[],i=[],r,n,t;function a(l,f,d,S){if(f>=e.length)return r!=null&&l.sort(r),n!=null?n(l):l;for(var O=-1,Z=l.length,U=e[f++],se,le,ye=map(),Be,rt=d();++O<Z;)(Be=ye.get(se=U(le=l[O])+""))?Be.push(le):ye.set(se,[le]);return ye.each(function(Je,Ot){S(rt,Ot,a(Je,f,d,S))}),rt}function s(l,f){if(++f>e.length)return l;var d,S=i[f-1];return n!=null&&f>=e.length?d=l.entries():(d=[],l.each(function(O,Z){d.push({key:Z,values:s(O,f)})})),S!=null?d.sort(function(O,Z){return S(O.key,Z.key)}):d}return t={object:function(l){return a(l,0,LL,RL)},map:function(l){return a(l,0,fA,hA)},entries:function(l){return s(a(l,0,fA,hA),0)},key:function(l){return e.push(l),t},sortKeys:function(l){return i[e.length-1]=l,t},sortValues:function(l){return r=l,t},rollup:function(l){return n=l,t}}}function LL(){return{}}function RL(e,i,r){e[i]=r}function fA(){return map()}function hA(e,i,r){e.set(i,r)}function zx(){}var Xm=Mw.prototype;zx.prototype=kL.prototype={constructor:zx,has:Xm.has,add:function(e){return e+="",this[lv+e]=e,this},remove:Xm.remove,clear:Xm.clear,values:Xm.keys,size:Xm.size,empty:Xm.empty,each:Xm.each};function kL(e,i){var r=new zx;if(e instanceof zx)e.each(function(a){r.add(a)});else if(e){var n=-1,t=e.length;if(i==null)for(;++n<t;)r.add(e[n]);else for(;++n<t;)r.add(i(e[n],n,e))}return r}var zB=null,pA=Array.prototype,dA=pA.map,Ym=pA.slice;function $0(e,i){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(i).domain(e);break}return this}function vA(e,i){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(i).domain(e);break}return this}var mA={name:"implicit"};function Zx(){var e=Mw(),i=[],r=[],n=mA;function t(a){var s=a+"",l=e.get(s);if(!l){if(n!==mA)return n;e.set(s,l=i.push(a))}return r[(l-1)%r.length]}return t.domain=function(a){if(!arguments.length)return i.slice();i=[],e=Mw();for(var s=-1,l=a.length,f,d;++s<l;)e.has(d=(f=a[s])+"")||e.set(d,i.push(f));return t},t.range=function(a){return arguments.length?(r=Ym.call(a),t):r.slice()},t.unknown=function(a){return arguments.length?(n=a,t):n},t.copy=function(){return Zx(i,r).unknown(n)},$0.apply(t,arguments),t}function gA(){var e=ordinal().unknown(void 0),i=e.domain,r=e.range,n=[0,1],t,a,s=!1,l=0,f=0,d=.5;delete e.unknown;function S(){var O=i().length,Z=n[1]<n[0],U=n[Z-0],se=n[1-Z];t=(se-U)/Math.max(1,O-l+f*2),s&&(t=Math.floor(t)),U+=(se-U-t*(O-l))*d,a=t*(1-l),s&&(U=Math.round(U),a=Math.round(a));var le=sequence(O).map(function(ye){return U+t*ye});return r(Z?le.reverse():le)}return e.domain=function(O){return arguments.length?(i(O),S()):i()},e.range=function(O){return arguments.length?(n=[+O[0],+O[1]],S()):n.slice()},e.rangeRound=function(O){return n=[+O[0],+O[1]],s=!0,S()},e.bandwidth=function(){return a},e.step=function(){return t},e.round=function(O){return arguments.length?(s=!!O,S()):s},e.padding=function(O){return arguments.length?(l=Math.min(1,f=+O),S()):l},e.paddingInner=function(O){return arguments.length?(l=Math.min(1,O),S()):l},e.paddingOuter=function(O){return arguments.length?(f=+O,S()):f},e.align=function(O){return arguments.length?(d=Math.max(0,Math.min(1,O)),S()):d},e.copy=function(){return gA(i(),n).round(s).paddingInner(l).paddingOuter(f).align(d)},initRange.apply(S(),arguments)}function yA(e){var i=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return yA(i())},e}function ZB(){return yA(gA.apply(null,arguments).paddingInner(1))}function UB(e,i){return(isNumberArray(i)?numberArray:_A)(e,i)}function _A(e,i){var r=i?i.length:0,n=e?Math.min(r,e.length):0,t=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)t[s]=Iw(e[s],i[s]);for(;s<r;++s)a[s]=i[s];return function(l){for(s=0;s<n;++s)a[s]=t[s](l);return a}}function DL(e,i){var r=new Date;return e=+e,i=+i,function(n){return r.setTime(e*(1-n)+i*n),r}}function Ux(e,i){return e=+e,i=+i,function(r){return e*(1-r)+i*r}}function FL(e,i){var r={},n={},t;(e===null||typeof e!="object")&&(e={}),(i===null||typeof i!="object")&&(i={});for(t in i)t in e?r[t]=Iw(e[t],i[t]):n[t]=i[t];return function(a){for(t in r)n[t]=r[t](a);return n}}var Pw=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ow=new RegExp(Pw.source,"g");function BL(e){return function(){return e}}function NL(e){return function(i){return e(i)+""}}function zL(e,i){var r=Pw.lastIndex=Ow.lastIndex=0,n,t,a,s=-1,l=[],f=[];for(e=e+"",i=i+"";(n=Pw.exec(e))&&(t=Ow.exec(i));)(a=t.index)>r&&(a=i.slice(r,a),l[s]?l[s]+=a:l[++s]=a),(n=n[0])===(t=t[0])?l[s]?l[s]+=t:l[++s]=t:(l[++s]=null,f.push({i:s,x:Ux(n,t)})),r=Ow.lastIndex;return r<i.length&&(a=i.slice(r),l[s]?l[s]+=a:l[++s]=a),l.length<2?f[0]?NL(f[0].x):BL(i):(i=f.length,function(d){for(var S=0,O;S<i;++S)l[(O=f[S]).i]=O.x(d);return l.join("")})}function ZL(e,i){i||(i=[]);var r=e?Math.min(i.length,e.length):0,n=i.slice(),t;return function(a){for(t=0;t<r;++t)n[t]=e[t]*(1-a)+i[t]*a;return n}}function UL(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Iw(e,i){var r=typeof i,n;return i==null||r==="boolean"?Tw(i):(r==="number"?Ux:r==="string"?(n=hc(i))?(i=n,uA):zL:i instanceof hc?uA:i instanceof Date?DL:UL(i)?ZL:Array.isArray(i)?_A:typeof i.valueOf!="function"&&typeof i.toString!="function"||isNaN(i)?FL:Ux)(e,i)}function jL(e,i){return e=+e,i=+i,function(r){return Math.round(e*(1-r)+i*r)}}function VL(e){return function(){return e}}function HL(e){return+e}var xA=[0,1];function ld(e){return e}function Lw(e,i){return(i-=e=+e)?function(r){return(r-e)/i}:VL(isNaN(i)?NaN:.5)}function bA(e){var i=e[0],r=e[e.length-1],n;return i>r&&(n=i,i=r,r=n),function(t){return Math.max(i,Math.min(r,t))}}function GL(e,i,r){var n=e[0],t=e[1],a=i[0],s=i[1];return t<n?(n=Lw(t,n),a=r(s,a)):(n=Lw(n,t),a=r(a,s)),function(l){return a(n(l))}}function $L(e,i,r){var n=Math.min(e.length,i.length)-1,t=new Array(n),a=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),i=i.slice().reverse());++s<n;)t[s]=Lw(e[s],e[s+1]),a[s]=r(i[s],i[s+1]);return function(l){var f=Fx(e,l,1,n)-1;return a[f](t[f](l))}}function jx(e,i){return i.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Rw(){var e=xA,i=xA,r=Iw,n,t,a,s=ld,l,f,d;function S(){return l=Math.min(e.length,i.length)>2?$L:GL,f=d=null,O}function O(Z){return isNaN(Z=+Z)?a:(f||(f=l(e.map(n),i,r)))(n(s(Z)))}return O.invert=function(Z){return s(t((d||(d=l(i,e.map(n),Ux)))(Z)))},O.domain=function(Z){return arguments.length?(e=dA.call(Z,HL),s===ld||(s=bA(e)),S()):e.slice()},O.range=function(Z){return arguments.length?(i=Ym.call(Z),S()):i.slice()},O.rangeRound=function(Z){return i=Ym.call(Z),r=jL,S()},O.clamp=function(Z){return arguments.length?(s=Z?bA(e):ld,O):s!==ld},O.interpolate=function(Z){return arguments.length?(r=Z,S()):r},O.unknown=function(Z){return arguments.length?(a=Z,O):a},function(Z,U){return n=Z,t=U,S()}}function EA(e,i){return Rw()(e,i)}var WL=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Vx(e){if(!(i=WL.exec(e)))throw new Error("invalid format: "+e);var i;return new kw({fill:i[1],align:i[2],sign:i[3],symbol:i[4],zero:i[5],width:i[6],comma:i[7],precision:i[8]&&i[8].slice(1),trim:i[9],type:i[10]})}Vx.prototype=kw.prototype;function kw(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}kw.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function XL(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Hx(e,i){if((r=(e=i?e.toExponential(i-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Vg(e){return e=Hx(Math.abs(e)),e?e[1]:NaN}function YL(e,i){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Vg(i)/3)))*3-Vg(Math.abs(e)))}function KL(e,i){return function(r,n){for(var t=r.length,a=[],s=0,l=e[0],f=0;t>0&&l>0&&(f+l+1>n&&(l=Math.max(1,n-f)),a.push(r.substring(t-=l,t+l)),!((f+=l+1)>n));)l=e[s=(s+1)%e.length];return a.reverse().join(i)}}function qL(e){return function(i){return i.replace(/[0-9]/g,function(r){return e[+r]})}}function QL(e){e:for(var i=e.length,r=1,n=-1,t;r<i;++r)switch(e[r]){case".":n=t=r;break;case"0":n===0&&(n=r),t=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(t+1):e}var wA;function JL(e,i){var r=Hx(e,i);if(!r)return e+"";var n=r[0],t=r[1],a=t-(wA=Math.max(-8,Math.min(8,Math.floor(t/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Hx(e,Math.max(0,i+a-1))[0]}function SA(e,i){var r=Hx(e,i);if(!r)return e+"";var n=r[0],t=r[1];return t<0?"0."+new Array(-t).join("0")+n:n.length>t+1?n.slice(0,t+1)+"."+n.slice(t+1):n+new Array(t-n.length+2).join("0")}var CA={"%":function(e,i){return(e*100).toFixed(i)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:XL,e:function(e,i){return e.toExponential(i)},f:function(e,i){return e.toFixed(i)},g:function(e,i){return e.toPrecision(i)},o:function(e){return Math.round(e).toString(8)},p:function(e,i){return SA(e*100,i)},r:SA,s:JL,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function AA(e){return e}var TA=Array.prototype.map,MA=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function eR(e){var i=e.grouping===void 0||e.thousands===void 0?AA:KL(TA.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",t=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?AA:qL(TA.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"-":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function d(O){O=Vx(O);var Z=O.fill,U=O.align,se=O.sign,le=O.symbol,ye=O.zero,Be=O.width,rt=O.comma,Je=O.precision,Ot=O.trim,jt=O.type;jt==="n"?(rt=!0,jt="g"):CA[jt]||(Je===void 0&&(Je=12),Ot=!0,jt="g"),(ye||Z==="0"&&U==="=")&&(ye=!0,Z="0",U="=");var dr=le==="$"?r:le==="#"&&/[boxX]/.test(jt)?"0"+jt.toLowerCase():"",Lr=le==="$"?n:/[%p]/.test(jt)?s:"",jr=CA[jt],Jr=/[defgprs%]/.test(jt);Je=Je===void 0?6:/[gprs]/.test(jt)?Math.max(1,Math.min(21,Je)):Math.max(0,Math.min(20,Je));function Pn(In){var Si=dr,ra=Lr,Va,Ms,vu;if(jt==="c")ra=jr(In)+ra,In="";else{In=+In;var Bu=In<0||1/In<0;if(In=isNaN(In)?f:jr(Math.abs(In),Je),Ot&&(In=QL(In)),Bu&&+In==0&&se!=="+"&&(Bu=!1),Si=(Bu?se==="("?se:l:se==="-"||se==="("?"":se)+Si,ra=(jt==="s"?MA[8+wA/3]:"")+ra+(Bu&&se==="("?")":""),Jr){for(Va=-1,Ms=In.length;++Va<Ms;)if(vu=In.charCodeAt(Va),48>vu||vu>57){ra=(vu===46?t+In.slice(Va+1):In.slice(Va))+ra,In=In.slice(0,Va);break}}}rt&&!ye&&(In=i(In,1/0));var zl=Si.length+In.length+ra.length,_l=zl<Be?new Array(Be-zl+1).join(Z):"";switch(rt&&ye&&(In=i(_l+In,_l.length?Be-ra.length:1/0),_l=""),U){case"<":In=Si+In+ra+_l;break;case"=":In=Si+_l+In+ra;break;case"^":In=_l.slice(0,zl=_l.length>>1)+Si+In+ra+_l.slice(zl);break;default:In=_l+Si+In+ra;break}return a(In)}return Pn.toString=function(){return O+""},Pn}function S(O,Z){var U=d((O=Vx(O),O.type="f",O)),se=Math.max(-8,Math.min(8,Math.floor(Vg(Z)/3)))*3,le=Math.pow(10,-se),ye=MA[8+se/3];return function(Be){return U(le*Be)+ye}}return{format:d,formatPrefix:S}}var Gx,Dw,PA;tR({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function tR(e){return Gx=eR(e),Dw=Gx.format,PA=Gx.formatPrefix,Gx}function rR(e,i){return e=Math.abs(e),i=Math.abs(i)-e,Math.max(0,Vg(i)-Vg(e))+1}function nR(e){return Math.max(0,-Vg(Math.abs(e)))}function iR(e,i,r,n){var t=Aw(e,i,r),a;switch(n=Vx(n==null?",f":n),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(i));return n.precision==null&&!isNaN(a=YL(t,s))&&(n.precision=a),PA(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=rR(t,Math.max(Math.abs(e),Math.abs(i))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=nR(t))&&(n.precision=a-(n.type==="%")*2);break}}return Dw(n)}function n1(e){var i=e.domain;return e.ticks=function(r){var n=i();return iA(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var t=i();return iR(t[0],t[t.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=i(),t=0,a=n.length-1,s=n[t],l=n[a],f;return l<s&&(f=s,s=l,l=f,f=t,t=a,a=f),f=Bx(s,l,r),f>0?(s=Math.floor(s/f)*f,l=Math.ceil(l/f)*f,f=Bx(s,l,r)):f<0&&(s=Math.ceil(s*f)/f,l=Math.floor(l*f)/f,f=Bx(s,l,r)),f>0?(n[t]=Math.floor(s/f)*f,n[a]=Math.ceil(l/f)*f,i(n)):f<0&&(n[t]=Math.ceil(s*f)/f,n[a]=Math.floor(l*f)/f,i(n)),e},e}function OA(){var e=EA(ld,ld);return e.copy=function(){return jx(e,OA())},$0.apply(e,arguments),n1(e)}function aR(e){var i;function r(n){return isNaN(n=+n)?i:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=map.call(n,number),r):e.slice()},r.unknown=function(n){return arguments.length?(i=n,r):i},r.copy=function(){return aR(e).unknown(i)},e=arguments.length?map.call(e,number):[0,1],linearish(r)}function IA(e,i){e=e.slice();var r=0,n=e.length-1,t=e[r],a=e[n],s;return a<t&&(s=r,r=n,n=s,s=t,t=a,a=s),e[r]=i.floor(t),e[n]=i.ceil(a),e}function LA(e){return Math.log(e)}function RA(e){return Math.exp(e)}function oR(e){return-Math.log(-e)}function sR(e){return-Math.exp(-e)}function uR(e){return isFinite(e)?+("1e"+e):e<0?0:e}function lR(e){return e===10?uR:e===Math.E?Math.exp:function(i){return Math.pow(e,i)}}function cR(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(i){return Math.log(i)/e})}function kA(e){return function(i){return-e(-i)}}function fR(e){var i=e(LA,RA),r=i.domain,n=10,t,a;function s(){return t=cR(n),a=lR(n),r()[0]<0?(t=kA(t),a=kA(a),e(oR,sR)):e(LA,RA),i}return i.base=function(l){return arguments.length?(n=+l,s()):n},i.domain=function(l){return arguments.length?(r(l),s()):r()},i.ticks=function(l){var f=r(),d=f[0],S=f[f.length-1],O;(O=S<d)&&(Z=d,d=S,S=Z);var Z=t(d),U=t(S),se,le,ye,Be=l==null?10:+l,rt=[];if(!(n%1)&&U-Z<Be){if(Z=Math.round(Z)-1,U=Math.round(U)+1,d>0){for(;Z<U;++Z)for(le=1,se=a(Z);le<n;++le)if(ye=se*le,!(ye<d)){if(ye>S)break;rt.push(ye)}}else for(;Z<U;++Z)for(le=n-1,se=a(Z);le>=1;--le)if(ye=se*le,!(ye<d)){if(ye>S)break;rt.push(ye)}}else rt=iA(Z,U,Math.min(U-Z,Be)).map(a);return O?rt.reverse():rt},i.tickFormat=function(l,f){if(f==null&&(f=n===10?".0e":","),typeof f!="function"&&(f=Dw(f)),l===1/0)return f;l==null&&(l=10);var d=Math.max(1,n*l/i.ticks().length);return function(S){var O=S/a(Math.round(t(S)));return O*n<n-.5&&(O*=n),O<=d?f(S):""}},i.nice=function(){return r(IA(r(),{floor:function(l){return a(Math.floor(t(l)))},ceil:function(l){return a(Math.ceil(t(l)))}}))},i}function DA(){var e=fR(Rw()).domain([1,10]);return e.copy=function(){return jx(e,DA()).base(e.base())},$0.apply(e,arguments),e}function FA(e){return function(i){return Math.sign(i)*Math.log1p(Math.abs(i/e))}}function BA(e){return function(i){return Math.sign(i)*Math.expm1(Math.abs(i))*e}}function hR(e){var i=1,r=e(FA(i),BA(i));return r.constant=function(n){return arguments.length?e(FA(i=+n),BA(i)):i},linearish(r)}function pR(){var e=hR(transformer());return e.copy=function(){return copy(e,pR()).constant(e.constant())},initRange.apply(e,arguments)}function NA(e){return function(i){return i<0?-Math.pow(-i,e):Math.pow(i,e)}}function dR(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function vR(e){return e<0?-e*e:e*e}function mR(e){var i=e(ld,ld),r=1;function n(){return r===1?e(ld,ld):r===.5?e(dR,vR):e(NA(r),NA(1/r))}return i.exponent=function(t){return arguments.length?(r=+t,n()):r},n1(i)}function Fw(){var e=mR(Rw());return e.copy=function(){return jx(e,Fw()).exponent(e.exponent())},$0.apply(e,arguments),e}function jB(){return Fw.apply(null,arguments).exponent(.5)}function zA(){var e=[],i=[],r=[],n;function t(){var s=0,l=Math.max(1,i.length);for(r=new Array(l-1);++s<l;)r[s-1]=AL(e,s/l);return a}function a(s){return isNaN(s=+s)?n:i[Fx(r,s)]}return a.invertExtent=function(s){var l=i.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},a.domain=function(s){if(!arguments.length)return e.slice();e=[];for(var l=0,f=s.length,d;l<f;++l)d=s[l],d!=null&&!isNaN(d=+d)&&e.push(d);return e.sort(Ew),t()},a.range=function(s){return arguments.length?(i=Ym.call(s),t()):i.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return zA().domain(e).range(i).unknown(n)},$0.apply(a,arguments)}function ZA(){var e=0,i=1,r=1,n=[.5],t=[0,1],a;function s(f){return f<=f?t[Fx(n,f,0,r)]:a}function l(){var f=-1;for(n=new Array(r);++f<r;)n[f]=((f+1)*i-(f-r)*e)/(r+1);return s}return s.domain=function(f){return arguments.length?(e=+f[0],i=+f[1],l()):[e,i]},s.range=function(f){return arguments.length?(r=(t=Ym.call(f)).length-1,l()):t.slice()},s.invertExtent=function(f){var d=t.indexOf(f);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],i]:[n[d-1],n[d]]},s.unknown=function(f){return arguments.length&&(a=f),s},s.thresholds=function(){return n.slice()},s.copy=function(){return ZA().domain([e,i]).range(t).unknown(a)},$0.apply(n1(s),arguments)}function UA(){var e=[.5],i=[0,1],r,n=1;function t(a){return a<=a?i[Fx(e,a,0,n)]:r}return t.domain=function(a){return arguments.length?(e=Ym.call(a),n=Math.min(e.length,i.length-1),t):e.slice()},t.range=function(a){return arguments.length?(i=Ym.call(a),n=Math.min(e.length,i.length-1),t):i.slice()},t.invertExtent=function(a){var s=i.indexOf(a);return[e[s-1],e[s]]},t.unknown=function(a){return arguments.length?(r=a,t):r},t.copy=function(){return UA().domain(e).range(i).unknown(r)},$0.apply(t,arguments)}var Bw=new Date,Nw=new Date;function Ed(e,i,r,n){function t(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return t.floor=function(a){return e(a=new Date(+a)),a},t.ceil=function(a){return e(a=new Date(a-1)),i(a,1),e(a),a},t.round=function(a){var s=t(a),l=t.ceil(a);return a-s<l-a?s:l},t.offset=function(a,s){return i(a=new Date(+a),s==null?1:Math.floor(s)),a},t.range=function(a,s,l){var f=[],d;if(a=t.ceil(a),l=l==null?1:Math.floor(l),!(a<s)||!(l>0))return f;do f.push(d=new Date(+a)),i(a,l),e(a);while(d<a&&a<s);return f},t.filter=function(a){return Ed(function(s){if(s>=s)for(;e(s),!a(s);)s.setTime(s-1)},function(s,l){if(s>=s)if(l<0)for(;++l<=0;)for(;i(s,-1),!a(s););else for(;--l>=0;)for(;i(s,1),!a(s););})},r&&(t.count=function(a,s){return Bw.setTime(+a),Nw.setTime(+s),e(Bw),e(Nw),Math.floor(r(Bw,Nw))},t.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?t.filter(n?function(s){return n(s)%a===0}:function(s){return t.count(0,s)%a===0}):t}),t}var zw=Ed(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,i){e.setFullYear(e.getFullYear()+i)},function(e,i){return i.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});zw.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ed(function(i){i.setFullYear(Math.floor(i.getFullYear()/e)*e),i.setMonth(0,1),i.setHours(0,0,0,0)},function(i,r){i.setFullYear(i.getFullYear()+r*e)})};var Hg=zw,VB=zw.range,jA=Ed(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,i){e.setMonth(e.getMonth()+i)},function(e,i){return i.getMonth()-e.getMonth()+(i.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),gR=jA,HB=jA.range,$x=1e3,i1=6e4,VA=36e5,HA=864e5,GA=6048e5;function Km(e){return Ed(function(i){i.setDate(i.getDate()-(i.getDay()+7-e)%7),i.setHours(0,0,0,0)},function(i,r){i.setDate(i.getDate()+r*7)},function(i,r){return(r-i-(r.getTimezoneOffset()-i.getTimezoneOffset())*i1)/GA})}var Zw=Km(0),Wx=Km(1),yR=Km(2),_R=Km(3),Gg=Km(4),xR=Km(5),bR=Km(6),GB=Zw.range,$B=Wx.range,WB=yR.range,XB=_R.range,YB=Gg.range,KB=xR.range,qB=bR.range,$A=Ed(function(e){e.setHours(0,0,0,0)},function(e,i){e.setDate(e.getDate()+i)},function(e,i){return(i-e-(i.getTimezoneOffset()-e.getTimezoneOffset())*i1)/HA},function(e){return e.getDate()-1}),Uw=$A,QB=$A.range,WA=Ed(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*$x-e.getMinutes()*i1)},function(e,i){e.setTime(+e+i*VA)},function(e,i){return(i-e)/VA},function(e){return e.getHours()}),ER=WA,JB=WA.range,XA=Ed(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*$x)},function(e,i){e.setTime(+e+i*i1)},function(e,i){return(i-e)/i1},function(e){return e.getMinutes()}),wR=XA,eN=XA.range,YA=Ed(function(e){e.setTime(e-e.getMilliseconds())},function(e,i){e.setTime(+e+i*$x)},function(e,i){return(i-e)/$x},function(e){return e.getUTCSeconds()}),SR=YA,tN=YA.range,Xx=Ed(function(){},function(e,i){e.setTime(+e+i)},function(e,i){return i-e});Xx.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ed(function(i){i.setTime(Math.floor(i/e)*e)},function(i,r){i.setTime(+i+r*e)},function(i,r){return(r-i)/e}):Xx};var CR=Xx,rN=Xx.range;function qm(e){return Ed(function(i){i.setUTCDate(i.getUTCDate()-(i.getUTCDay()+7-e)%7),i.setUTCHours(0,0,0,0)},function(i,r){i.setUTCDate(i.getUTCDate()+r*7)},function(i,r){return(r-i)/GA})}var KA=qm(0),Yx=qm(1),AR=qm(2),TR=qm(3),$g=qm(4),MR=qm(5),PR=qm(6),nN=KA.range,iN=Yx.range,aN=AR.range,oN=TR.range,sN=$g.range,uN=MR.range,lN=PR.range,qA=Ed(function(e){e.setUTCHours(0,0,0,0)},function(e,i){e.setUTCDate(e.getUTCDate()+i)},function(e,i){return(i-e)/HA},function(e){return e.getUTCDate()-1}),QA=qA,cN=qA.range,jw=Ed(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,i){e.setUTCFullYear(e.getUTCFullYear()+i)},function(e,i){return i.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});jw.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Ed(function(i){i.setUTCFullYear(Math.floor(i.getUTCFullYear()/e)*e),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)},function(i,r){i.setUTCFullYear(i.getUTCFullYear()+r*e)})};var a1=jw,fN=jw.range;function Vw(e){if(0<=e.y&&e.y<100){var i=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return i.setFullYear(e.y),i}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Hw(e){if(0<=e.y&&e.y<100){var i=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return i.setUTCFullYear(e.y),i}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function o1(e,i,r){return{y:e,m:i,d:r,H:0,M:0,S:0,L:0}}function OR(e){var i=e.dateTime,r=e.date,n=e.time,t=e.periods,a=e.days,s=e.shortDays,l=e.months,f=e.shortMonths,d=s1(t),S=u1(t),O=s1(a),Z=u1(a),U=s1(s),se=u1(s),le=s1(l),ye=u1(l),Be=s1(f),rt=u1(f),Je={a:Bu,A:zl,b:_l,B:_h,c:null,d:iT,e:iT,f:JR,g:lk,G:fk,H:KR,I:qR,j:QR,L:aT,m:ek,M:tk,p:Pv,q:wd,Q:fT,s:hT,S:rk,u:nk,U:ik,V:ak,w:ok,W:sk,x:null,X:null,y:uk,Y:ck,Z:hk,"%":cT},Ot={a:K0,A:Xd,b:hf,B:$h,c:null,d:sT,e:sT,f:mk,g:Ak,G:Mk,H:pk,I:dk,j:vk,L:uT,m:gk,M:yk,p:ng,q:ig,Q:fT,s:hT,S:_k,u:xk,U:bk,V:Ek,w:wk,W:Sk,x:null,X:null,y:Ck,Y:Tk,Z:Pk,"%":cT},jt={a:Pn,A:In,b:Si,B:ra,c:Va,d:rT,e:rT,f:$R,g:tT,G:eT,H:nT,I:nT,j:jR,L:GR,m:UR,M:VR,p:Jr,q:ZR,Q:XR,s:YR,S:HR,u:DR,U:FR,V:BR,w:kR,W:NR,x:Ms,X:vu,y:tT,Y:eT,Z:zR,"%":WR};Je.x=dr(r,Je),Je.X=dr(n,Je),Je.c=dr(i,Je),Ot.x=dr(r,Ot),Ot.X=dr(n,Ot),Ot.c=dr(i,Ot);function dr(hs,Cl){return function(wc){var lo=[],Bd=-1,zf=0,Yd=hs.length,Kd,ag,IM;for(wc instanceof Date||(wc=new Date(+wc));++Bd<Yd;)hs.charCodeAt(Bd)===37&&(lo.push(hs.slice(zf,Bd)),(ag=JA[Kd=hs.charAt(++Bd)])!=null?Kd=hs.charAt(++Bd):ag=Kd==="e"?" ":"0",(IM=Cl[Kd])&&(Kd=IM(wc,ag)),lo.push(Kd),zf=Bd+1);return lo.push(hs.slice(zf,Bd)),lo.join("")}}function Lr(hs,Cl){return function(wc){var lo=o1(1900,void 0,1),Bd=jr(lo,hs,wc+="",0),zf,Yd;if(Bd!=wc.length)return null;if("Q"in lo)return new Date(lo.Q);if("s"in lo)return new Date(lo.s*1e3+("L"in lo?lo.L:0));if(Cl&&!("Z"in lo)&&(lo.Z=0),"p"in lo&&(lo.H=lo.H%12+lo.p*12),lo.m===void 0&&(lo.m="q"in lo?lo.q:0),"V"in lo){if(lo.V<1||lo.V>53)return null;"w"in lo||(lo.w=1),"Z"in lo?(zf=Hw(o1(lo.y,0,1)),Yd=zf.getUTCDay(),zf=Yd>4||Yd===0?Yx.ceil(zf):Yx(zf),zf=QA.offset(zf,(lo.V-1)*7),lo.y=zf.getUTCFullYear(),lo.m=zf.getUTCMonth(),lo.d=zf.getUTCDate()+(lo.w+6)%7):(zf=Vw(o1(lo.y,0,1)),Yd=zf.getDay(),zf=Yd>4||Yd===0?Wx.ceil(zf):Wx(zf),zf=Uw.offset(zf,(lo.V-1)*7),lo.y=zf.getFullYear(),lo.m=zf.getMonth(),lo.d=zf.getDate()+(lo.w+6)%7)}else("W"in lo||"U"in lo)&&("w"in lo||(lo.w="u"in lo?lo.u%7:"W"in lo?1:0),Yd="Z"in lo?Hw(o1(lo.y,0,1)).getUTCDay():Vw(o1(lo.y,0,1)).getDay(),lo.m=0,lo.d="W"in lo?(lo.w+6)%7+lo.W*7-(Yd+5)%7:lo.w+lo.U*7-(Yd+6)%7);return"Z"in lo?(lo.H+=lo.Z/100|0,lo.M+=lo.Z%100,Hw(lo)):Vw(lo)}}function jr(hs,Cl,wc,lo){for(var Bd=0,zf=Cl.length,Yd=wc.length,Kd,ag;Bd<zf;){if(lo>=Yd)return-1;if(Kd=Cl.charCodeAt(Bd++),Kd===37){if(Kd=Cl.charAt(Bd++),ag=jt[Kd in JA?Cl.charAt(Bd++):Kd],!ag||(lo=ag(hs,wc,lo))<0)return-1}else if(Kd!=wc.charCodeAt(lo++))return-1}return lo}function Jr(hs,Cl,wc){var lo=d.exec(Cl.slice(wc));return lo?(hs.p=S[lo[0].toLowerCase()],wc+lo[0].length):-1}function Pn(hs,Cl,wc){var lo=U.exec(Cl.slice(wc));return lo?(hs.w=se[lo[0].toLowerCase()],wc+lo[0].length):-1}function In(hs,Cl,wc){var lo=O.exec(Cl.slice(wc));return lo?(hs.w=Z[lo[0].toLowerCase()],wc+lo[0].length):-1}function Si(hs,Cl,wc){var lo=Be.exec(Cl.slice(wc));return lo?(hs.m=rt[lo[0].toLowerCase()],wc+lo[0].length):-1}function ra(hs,Cl,wc){var lo=le.exec(Cl.slice(wc));return lo?(hs.m=ye[lo[0].toLowerCase()],wc+lo[0].length):-1}function Va(hs,Cl,wc){return jr(hs,i,Cl,wc)}function Ms(hs,Cl,wc){return jr(hs,r,Cl,wc)}function vu(hs,Cl,wc){return jr(hs,n,Cl,wc)}function Bu(hs){return s[hs.getDay()]}function zl(hs){return a[hs.getDay()]}function _l(hs){return f[hs.getMonth()]}function _h(hs){return l[hs.getMonth()]}function Pv(hs){return t[+(hs.getHours()>=12)]}function wd(hs){return 1+~~(hs.getMonth()/3)}function K0(hs){return s[hs.getUTCDay()]}function Xd(hs){return a[hs.getUTCDay()]}function hf(hs){return f[hs.getUTCMonth()]}function $h(hs){return l[hs.getUTCMonth()]}function ng(hs){return t[+(hs.getUTCHours()>=12)]}function ig(hs){return 1+~~(hs.getUTCMonth()/3)}return{format:function(hs){var Cl=dr(hs+="",Je);return Cl.toString=function(){return hs},Cl},parse:function(hs){var Cl=Lr(hs+="",!1);return Cl.toString=function(){return hs},Cl},utcFormat:function(hs){var Cl=dr(hs+="",Ot);return Cl.toString=function(){return hs},Cl},utcParse:function(hs){var Cl=Lr(hs+="",!0);return Cl.toString=function(){return hs},Cl}}}var JA={"-":"",_:" ",0:"0"},Tp=/^\s*\d+/,IR=/^%/,LR=/[\\^$*+?|[\]().{}]/g;function bc(e,i,r){var n=e<0?"-":"",t=(n?-e:e)+"",a=t.length;return n+(a<r?new Array(r-a+1).join(i)+t:t)}function RR(e){return e.replace(LR,"\\$&")}function s1(e){return new RegExp("^(?:"+e.map(RR).join("|")+")","i")}function u1(e){for(var i={},r=-1,n=e.length;++r<n;)i[e[r].toLowerCase()]=r;return i}function kR(e,i,r){var n=Tp.exec(i.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function DR(e,i,r){var n=Tp.exec(i.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function FR(e,i,r){var n=Tp.exec(i.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function BR(e,i,r){var n=Tp.exec(i.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function NR(e,i,r){var n=Tp.exec(i.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function eT(e,i,r){var n=Tp.exec(i.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function tT(e,i,r){var n=Tp.exec(i.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function zR(e,i,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(i.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function ZR(e,i,r){var n=Tp.exec(i.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function UR(e,i,r){var n=Tp.exec(i.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function rT(e,i,r){var n=Tp.exec(i.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function jR(e,i,r){var n=Tp.exec(i.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function nT(e,i,r){var n=Tp.exec(i.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function VR(e,i,r){var n=Tp.exec(i.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function HR(e,i,r){var n=Tp.exec(i.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function GR(e,i,r){var n=Tp.exec(i.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function $R(e,i,r){var n=Tp.exec(i.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function WR(e,i,r){var n=IR.exec(i.slice(r,r+1));return n?r+n[0].length:-1}function XR(e,i,r){var n=Tp.exec(i.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function YR(e,i,r){var n=Tp.exec(i.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function iT(e,i){return bc(e.getDate(),i,2)}function KR(e,i){return bc(e.getHours(),i,2)}function qR(e,i){return bc(e.getHours()%12||12,i,2)}function QR(e,i){return bc(1+Uw.count(Hg(e),e),i,3)}function aT(e,i){return bc(e.getMilliseconds(),i,3)}function JR(e,i){return aT(e,i)+"000"}function ek(e,i){return bc(e.getMonth()+1,i,2)}function tk(e,i){return bc(e.getMinutes(),i,2)}function rk(e,i){return bc(e.getSeconds(),i,2)}function nk(e){var i=e.getDay();return i===0?7:i}function ik(e,i){return bc(Zw.count(Hg(e)-1,e),i,2)}function oT(e){var i=e.getDay();return i>=4||i===0?Gg(e):Gg.ceil(e)}function ak(e,i){return e=oT(e),bc(Gg.count(Hg(e),e)+(Hg(e).getDay()===4),i,2)}function ok(e){return e.getDay()}function sk(e,i){return bc(Wx.count(Hg(e)-1,e),i,2)}function uk(e,i){return bc(e.getFullYear()%100,i,2)}function lk(e,i){return e=oT(e),bc(e.getFullYear()%100,i,2)}function ck(e,i){return bc(e.getFullYear()%1e4,i,4)}function fk(e,i){var r=e.getDay();return e=r>=4||r===0?Gg(e):Gg.ceil(e),bc(e.getFullYear()%1e4,i,4)}function hk(e){var i=e.getTimezoneOffset();return(i>0?"-":(i*=-1,"+"))+bc(i/60|0,"0",2)+bc(i%60,"0",2)}function sT(e,i){return bc(e.getUTCDate(),i,2)}function pk(e,i){return bc(e.getUTCHours(),i,2)}function dk(e,i){return bc(e.getUTCHours()%12||12,i,2)}function vk(e,i){return bc(1+QA.count(a1(e),e),i,3)}function uT(e,i){return bc(e.getUTCMilliseconds(),i,3)}function mk(e,i){return uT(e,i)+"000"}function gk(e,i){return bc(e.getUTCMonth()+1,i,2)}function yk(e,i){return bc(e.getUTCMinutes(),i,2)}function _k(e,i){return bc(e.getUTCSeconds(),i,2)}function xk(e){var i=e.getUTCDay();return i===0?7:i}function bk(e,i){return bc(KA.count(a1(e)-1,e),i,2)}function lT(e){var i=e.getUTCDay();return i>=4||i===0?$g(e):$g.ceil(e)}function Ek(e,i){return e=lT(e),bc($g.count(a1(e),e)+(a1(e).getUTCDay()===4),i,2)}function wk(e){return e.getUTCDay()}function Sk(e,i){return bc(Yx.count(a1(e)-1,e),i,2)}function Ck(e,i){return bc(e.getUTCFullYear()%100,i,2)}function Ak(e,i){return e=lT(e),bc(e.getUTCFullYear()%100,i,2)}function Tk(e,i){return bc(e.getUTCFullYear()%1e4,i,4)}function Mk(e,i){var r=e.getUTCDay();return e=r>=4||r===0?$g(e):$g.ceil(e),bc(e.getUTCFullYear()%1e4,i,4)}function Pk(){return"+0000"}function cT(){return"%"}function fT(e){return+e}function hT(e){return Math.floor(+e/1e3)}var Wg,pT,Ok,Ik,Lk;Rk({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Rk(e){return Wg=OR(e),pT=Wg.format,Ok=Wg.parse,Ik=Wg.utcFormat,Lk=Wg.utcParse,Wg}var l1=1e3,c1=l1*60,f1=c1*60,h1=f1*24,kk=h1*7,dT=h1*30,Gw=h1*365;function Dk(e){return new Date(e)}function Fk(e){return e instanceof Date?+e:+new Date(+e)}function vT(e,i,r,n,t,a,s,l,f){var d=EA(ld,ld),S=d.invert,O=d.domain,Z=f(".%L"),U=f(":%S"),se=f("%I:%M"),le=f("%I %p"),ye=f("%a %d"),Be=f("%b %d"),rt=f("%B"),Je=f("%Y"),Ot=[[s,1,l1],[s,5,5*l1],[s,15,15*l1],[s,30,30*l1],[a,1,c1],[a,5,5*c1],[a,15,15*c1],[a,30,30*c1],[t,1,f1],[t,3,3*f1],[t,6,6*f1],[t,12,12*f1],[n,1,h1],[n,2,2*h1],[r,1,kk],[i,1,dT],[i,3,3*dT],[e,1,Gw]];function jt(Lr){return(s(Lr)<Lr?Z:a(Lr)<Lr?U:t(Lr)<Lr?se:n(Lr)<Lr?le:i(Lr)<Lr?r(Lr)<Lr?ye:Be:e(Lr)<Lr?rt:Je)(Lr)}function dr(Lr,jr,Jr,Pn){if(Lr==null&&(Lr=10),typeof Lr=="number"){var In=Math.abs(Jr-jr)/Lr,Si=eA(function(ra){return ra[2]}).right(Ot,In);Si===Ot.length?(Pn=Aw(jr/Gw,Jr/Gw,Lr),Lr=e):Si?(Si=Ot[In/Ot[Si-1][2]<Ot[Si][2]/In?Si-1:Si],Pn=Si[1],Lr=Si[0]):(Pn=Math.max(Aw(jr,Jr,Lr),1),Lr=l)}return Pn==null?Lr:Lr.every(Pn)}return d.invert=function(Lr){return new Date(S(Lr))},d.domain=function(Lr){return arguments.length?O(dA.call(Lr,Fk)):O().map(Dk)},d.ticks=function(Lr,jr){var Jr=O(),Pn=Jr[0],In=Jr[Jr.length-1],Si=In<Pn,ra;return Si&&(ra=Pn,Pn=In,In=ra),ra=dr(Lr,Pn,In,jr),ra=ra?ra.range(Pn,In+1):[],Si?ra.reverse():ra},d.tickFormat=function(Lr,jr){return jr==null?jt:f(jr)},d.nice=function(Lr,jr){var Jr=O();return(Lr=dr(Lr,Jr[0],Jr[Jr.length-1],jr))?O(IA(Jr,Lr)):d},d.copy=function(){return jx(d,vT(e,i,r,n,t,a,s,l,f))},d}function Bk(){return $0.apply(vT(Hg,gR,Zw,Uw,ER,wR,SR,CR,pT).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function hN(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Kx(){var e=0,i=1,r,n,t,a,s=ld,l=!1,f;function d(S){return isNaN(S=+S)?f:s(t===0?.5:(S=(a(S)-r)*t,l?Math.max(0,Math.min(1,S)):S))}return d.domain=function(S){return arguments.length?(r=a(e=+S[0]),n=a(i=+S[1]),t=r===n?0:1/(n-r),d):[e,i]},d.clamp=function(S){return arguments.length?(l=!!S,d):l},d.interpolator=function(S){return arguments.length?(s=S,d):s},d.unknown=function(S){return arguments.length?(f=S,d):f},function(S){return a=S,r=S(e),n=S(i),t=r===n?0:1/(n-r),d}}function p1(e,i){return i.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function mT(){var e=n1(Kx()(ld));return e.copy=function(){return p1(e,mT())},vA.apply(e,arguments)}function Nk(){var e=loggish(Kx()).domain([1,10]);return e.copy=function(){return p1(e,Nk()).base(e.base())},initInterpolator.apply(e,arguments)}function zk(){var e=symlogish(Kx());return e.copy=function(){return p1(e,zk()).constant(e.constant())},initInterpolator.apply(e,arguments)}function gT(){var e=powish(Kx());return e.copy=function(){return p1(e,gT()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function pN(){return gT.apply(null,arguments).exponent(.5)}function Zk(){var e=[],i=identity;function r(n){if(!isNaN(n=+n))return i((bisect(e,n)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(var t=0,a=n.length,s;t<a;++t)s=n[t],s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(ascending),r},r.interpolator=function(n){return arguments.length?(i=n,r):i},r.copy=function(){return Zk(i).domain(e)},initInterpolator.apply(r,arguments)}function qx(){var e=0,i=.5,r=1,n,t,a,s,l,f=ld,d,S=!1,O;function Z(U){return isNaN(U=+U)?O:(U=.5+((U=+d(U))-t)*(U<t?s:l),f(S?Math.max(0,Math.min(1,U)):U))}return Z.domain=function(U){return arguments.length?(n=d(e=+U[0]),t=d(i=+U[1]),a=d(r=+U[2]),s=n===t?0:.5/(t-n),l=t===a?0:.5/(a-t),Z):[e,i,r]},Z.clamp=function(U){return arguments.length?(S=!!U,Z):S},Z.interpolator=function(U){return arguments.length?(f=U,Z):f},Z.unknown=function(U){return arguments.length?(O=U,Z):O},function(U){return d=U,n=U(e),t=U(i),a=U(r),s=n===t?0:.5/(t-n),l=t===a?0:.5/(a-t),Z}}function yT(){var e=n1(qx()(ld));return e.copy=function(){return p1(e,yT())},vA.apply(e,arguments)}function Uk(){var e=loggish(qx()).domain([.1,1,10]);return e.copy=function(){return copy(e,Uk()).base(e.base())},initInterpolator.apply(e,arguments)}function jk(){var e=symlogish(qx());return e.copy=function(){return copy(e,jk()).constant(e.constant())},initInterpolator.apply(e,arguments)}function _T(){var e=powish(qx());return e.copy=function(){return copy(e,_T()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function dN(){return _T.apply(null,arguments).exponent(.5)}function xT(e){var i,r=[];function n(t){return t==null?i:t}return n.invert=n,n.domain=n.range=function(t){return t?(r=t,t):r},n.unknown=function(t){return t?(i=t,t):i},n.copy=function(){return xT(e).unknown(i)},n}var $d,bT,ET,Vk=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Hk=($d={},(0,V.Z)($d,sc.LINEAR,OA),(0,V.Z)($d,sc.POWER,Fw),(0,V.Z)($d,sc.LOG,DA),(0,V.Z)($d,sc.IDENTITY,xT),(0,V.Z)($d,sc.SEQUENTIAL,mT),(0,V.Z)($d,sc.TIME,Bk),(0,V.Z)($d,sc.QUANTILE,zA),(0,V.Z)($d,sc.QUANTIZE,ZA),(0,V.Z)($d,sc.THRESHOLD,UA),(0,V.Z)($d,sc.CAT,Zx),(0,V.Z)($d,sc.DIVERGING,yT),$d),Gk=(bT=(0,Xr.b2)(),bT(ET=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"scaleOptions",{})}return(0,he.Z)(e,[{key:"apply",value:function(r,n){var t=this,a=n.styleAttributeService;r.hooks.init.tapPromise("FeatureScalePlugin",(0,Dt.Z)(Ze().mark(function s(){var l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(r.log(nh.ScaleInitStart,ih.INIT),t.scaleOptions=r.getScaleOptions(),f=a.getLayerStyleAttributes(),d=(l=r.getSource())===null||l===void 0?void 0:l.data.dataArray,!(Array.isArray(d)&&d.length===0)){O.next=8;break}return O.abrupt("return");case 8:t.caculateScalesForAttributes(f||[],d);case 9:r.log(nh.ScaleInitEnd,ih.INIT);case 10:case"end":return O.stop()}},s)}))),r.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var s=(0,Dt.Z)(Ze().mark(function l(f){var d,S;return Ze().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(f){Z.next=2;break}return Z.abrupt("return",f);case 2:if(r.log(nh.ScaleInitStart,ih.UPDATE),t.scaleOptions=r.getScaleOptions(),d=a.getLayerStyleAttributes(),S=r.getSource().data.dataArray,!(Array.isArray(S)&&S.length===0)){Z.next=8;break}return Z.abrupt("return",!0);case 8:return t.caculateScalesForAttributes(d||[],S),r.log(nh.ScaleInitEnd,ih.UPDATE),r.layerModelNeedUpdate=!0,Z.abrupt("return",!0);case 12:case"end":return Z.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()),r.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!r.layerModelNeedUpdate){t.scaleOptions=r.getScaleOptions();var s=a.getLayerStyleAttributes(),l=r.getSource().data.dataArray;if(!(Array.isArray(l)&&l.length===0)&&s){var f=s.filter(function(d){return d.needRescale});f.length&&t.caculateScalesForAttributes(f,l)}}})}},{key:"isNumber",value:function(r){return!isNaN(parseFloat(r))&&isFinite(r)}},{key:"caculateScalesForAttributes",value:function(r,n){var t=this;r.forEach(function(a){if(a.scale){var s=a.scale;s.names=t.parseFields(a.scale.field||[]);var l=[];s.names.forEach(function(f){var d;l.push(t.createScale(f,a.name,(d=a.scale)===null||d===void 0?void 0:d.values,n))}),l.some(function(f){return f.type===Cv.VARIABLE})?(s.type=Cv.VARIABLE,l.forEach(function(f){var d;if(!s.callback&&s.values!=="text")switch((d=f.option)===null||d===void 0?void 0:d.type){case sc.LOG:case sc.LINEAR:case sc.POWER:if(s.values&&s.values.length>2){var S=f.scale.ticks(s.values.length);f.scale.domain(S)}s.values?f.scale.range(s.values):f.scale.range(f.option.domain);break;case sc.QUANTILE:case sc.QUANTIZE:case sc.THRESHOLD:f.scale.range(s.values);break;case sc.IDENTITY:break;case sc.CAT:s.values?f.scale.range(s.values):f.scale.range(f.option.domain);break;case sc.DIVERGING:case sc.SEQUENTIAL:f.scale.interpolator(IL(s.values));break}if(s.values==="text"){var O;f.scale.range((O=f.option)===null||O===void 0?void 0:O.domain)}})):(s.type=Cv.CONSTANT,s.defaultValues=l.map(function(f,d){return f.scale(s.names[d])})),s.scalers=l.map(function(f){return{field:f.field,func:f.scale,option:f.option}}),a.needRescale=!1}})}},{key:"parseFields",value:function(r){return Array.isArray(r)?r:(0,Kn.isString)(r)?r.split("*"):[r]}},{key:"createScale",value:function(r,n,t,a){var s,l,f=this.scaleOptions[n]&&((s=this.scaleOptions[n])===null||s===void 0?void 0:s.field)===r?this.scaleOptions[n]:this.scaleOptions[r],d={field:r,scale:void 0,type:Cv.VARIABLE,option:f};if(!a||!a.length)return f&&f.type?d.scale=this.createDefaultScale(f):(d.scale=Zx([r]),d.type=Cv.CONSTANT),d;var S=(l=a.find(function(U){return!(0,Kn.isNil)(U[r])}))===null||l===void 0?void 0:l[r];if(this.isNumber(r)||(0,Kn.isNil)(S)&&!f)d.scale=Zx([r]),d.type=Cv.CONSTANT;else{var O=f&&f.type||this.getDefaultType(S);t==="text"&&(O=sc.CAT);var Z=this.createScaleConfig(O,r,f,a);d.scale=this.createDefaultScale(Z),d.option=Z}return d}},{key:"getDefaultType",value:function(r){var n=sc.LINEAR;return typeof r=="string"&&(n=Vk.test(r)?sc.TIME:sc.CAT),n}},{key:"createScaleConfig",value:function(r,n,t,a){var s={type:r},l=(a==null?void 0:a.map(function(S){return S[n]}))||[];if(t!=null&&t.domain)s.domain=t==null?void 0:t.domain;else if(r===sc.CAT||r===sc.IDENTITY)s.domain=(0,Kn.uniq)(l);else if(r===sc.QUANTILE)s.domain=l;else if(r===sc.DIVERGING){var f=rA(l),d=(t==null?void 0:t.neutral)!==void 0?t==null?void 0:t.neutral:(f[0]+f[1])/2;s.domain=[f[0],d,f[1]]}else s.domain=rA(l);return(0,ue.Z)((0,ue.Z)({},s),t)}},{key:"createDefaultScale",value:function(r){var n=r.type,t=r.domain,a=r.unknown,s=r.clamp,l=r.nice,f=Hk[n]();return t&&f.domain&&f.domain(t),a&&f.unknown(a),s!==void 0&&f.clamp&&f.clamp(s),l!==void 0&&f.nice&&f.nice(l),f}}]),e}())||ET),wT,ST,$k=(wT=(0,Xr.b2)(),wT(ST=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"apply",value:function(r){r.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var n=r.animateStatus;n&&r.models.forEach(function(t){t.addUniforms((0,ue.Z)({},r.layerModel.getAnimateUniforms()))})})}}]),e}())||ST),Wk=function(){function e(i){var r=i.rendererService,n=i.layerService,t=i.parent;(0,re.Z)(this,e),(0,V.Z)(this,"tileResource",new Map),(0,V.Z)(this,"layerTiles",[]),this.rendererService=r,this.layerService=n,this.parent=t}return(0,he.Z)(e,[{key:"tiles",get:function(){return this.layerTiles}},{key:"hasTile",value:function(r){return this.layerTiles.some(function(n){return n.key===r})}},{key:"addTile",value:function(r){this.layerTiles.push(r)}},{key:"getTile",value:function(r){return this.layerTiles.find(function(n){return n.key===r})}},{key:"getVisibleTileBylngLat",value:function(r){return this.layerTiles.find(function(n){return n.isLoaded&&n.visible&&n.lnglatInBounds(r)})}},{key:"removeTile",value:function(r){var n=this.layerTiles.findIndex(function(a){return a.key===r}),t=this.layerTiles.splice(n,1);t[0]&&t[0].destroy()}},{key:"updateTileVisible",value:function(r){var n=this.getTile(r.key);n==null||n.updateVisible(r.isVisible)}},{key:"isParentLoaded",value:function(r){var n=r.parent;if(!n)return!0;var t=this.getTile(n==null?void 0:n.key);return!!(t!=null&&t.isLoaded)}},{key:"isChildrenLoaded",value:function(r){var n=this,t=r==null?void 0:r.children;return t.length===0?!0:t.some(function(a){var s=n.getTile(a==null?void 0:a.key);return(s==null?void 0:s.isLoaded)===!1})}},{key:"render",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(){var t=this,a;return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:a=this.getRenderLayers(),a.map(function(){var f=(0,Dt.Z)(Ze().mark(function d(S){return Ze().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,t.layerService.renderLayer(S);case 2:case"end":return Z.stop()}},d)}));return function(d){return f.apply(this,arguments)}}());case 2:case"end":return l.stop()}},n,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"getRenderLayers",value:function(){var r=this.layerTiles.filter(function(t){return t.visible&&t.isLoaded}),n=[];return r.map(function(t){return n.push.apply(n,(0,oe.Z)(t.getLayers()))}),n}},{key:"getLayers",value:function(){var r=this.layerTiles.filter(function(t){return t.isLoaded}),n=[];return r.map(function(t){return n.push.apply(n,(0,oe.Z)(t.getLayers()))}),n}},{key:"getTiles",value:function(){return this.layerTiles}},{key:"destroy",value:function(){this.layerTiles.forEach(function(r){return r.destroy()}),this.tileResource.clear()}}]),e}(),Xk=I(32676);function Yk(e,i,r){r===void 0&&(r={});var n=(0,bt.wA)(e),t=(0,bt.wA)(i),a=Xk.union(n.coordinates,t.coordinates);return a.length===0?null:a.length===1?(0,Ur.yu)(a[0],r.properties):(0,Ur.tw)(a,r.properties)}var Kk=Yk,qk=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"getCombineFeature",value:function(r){var n=null,t=r[0];return r.map(function(a){var s=Ur.yu(a.coordinates);n===null?n=s:n=Kk(n,s)}),t&&(n.properties=(0,ue.Z)({},t)),n}}]),e}(),d1="select",v1="active",Qk=function(){function e(i){var r=i.layerService,n=i.tileLayerService,t=i.parent;(0,re.Z)(this,e),(0,V.Z)(this,"tilePickID",new Map),this.layerService=r,this.tileLayerService=n,this.parent=t,this.tileSourceService=new qk}return(0,he.Z)(e,[{key:"pickRender",value:function(r){var n=this.tileLayerService.getVisibleTileBylngLat(r.lngLat);if(n){var t=n.getMainLayer();t==null||t.layerPickService.pickRender(r)}}},{key:"pick",value:function(r,n){var t=this.parent.getContainer(),a=t.get(Ir.IPickingService);if(r.type==="RasterLayer"){var s=this.tileLayerService.getVisibleTileBylngLat(n.lngLat);if(s&&s.getMainLayer()!==void 0){var l=s.getMainLayer();return l.layerPickService.pickRasterLayer(l,n,this.parent)}return!1}return this.pickRender(n),a.pickFromPickingFBO(r,n)}},{key:"selectFeature",value:function(r){var n=(0,Ja.Z)(r,3),t=n[0],a=n[1],s=n[2],l=this.color2PickId(t,a,s);this.tilePickID.set(d1,l),this.updateHighLight(t,a,s,d1)}},{key:"highlightPickedFeature",value:function(r){var n=(0,Ja.Z)(r,3),t=n[0],a=n[1],s=n[2],l=this.color2PickId(t,a,s);this.tilePickID.set(v1,l),this.updateHighLight(t,a,s,v1)}},{key:"updateHighLight",value:function(r,n,t,a){this.tileLayerService.tiles.map(function(s){var l=s.getMainLayer();switch(a){case d1:l==null||l.hooks.beforeSelect.call([r,n,t]);break;case v1:l==null||l.hooks.beforeHighlight.call([r,n,t]);break}})}},{key:"setPickState",value:function(){var r=this.tilePickID.get(d1),n=this.tilePickID.get(v1);if(r){var t=this.pickId2Color(r),a=(0,Ja.Z)(t,3),s=a[0],l=a[1],f=a[2];this.updateHighLight(s,l,f,d1);return}if(n){var d=this.pickId2Color(n),S=(0,Ja.Z)(d,3),O=S[0],Z=S[1],U=S[2];this.updateHighLight(O,Z,U,v1);return}}},{key:"color2PickId",value:function(r,n,t){return Xa(new Uint8Array([r,n,t]))}},{key:"pickId2Color",value:function(r){return of(r)}},{key:"getFeatureById",value:function(r){var n=this.tileLayerService.getTiles().filter(function(a){return a.visible}),t=[];return n.forEach(function(a){t.push.apply(t,(0,oe.Z)(a.getFeatureById(r)))}),t}},{key:"pickRasterLayer",value:function(r,n,t){return!1}}]),e}(),Jk=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive"];function e7(e){return e==="PolygonLayer"?ZC:e==="LineLayer"?yw:Ox}function t7(e){return["PolygonLayer","LineLayer"].indexOf(e)!==-1}var Qm=function(){function e(i,r){(0,re.Z)(this,e),(0,V.Z)(this,"visible",!0),(0,V.Z)(this,"layers",[]),(0,V.Z)(this,"isLoaded",!1),this.parent=r,this.sourceTile=i,this.x=i.x,this.y=i.y,this.z=i.z,this.key="".concat(this.x,"_").concat(this.y,"_").concat(this.z)}return(0,he.Z)(e,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(r){var n=(0,Ja.Z)(this.sourceTile.bounds,4),t=n[0],a=n[1],s=n[2],l=n[3],f=r.lng,d=r.lat;return f>=t&&f<=s&&d>=a&&d<=l}},{key:"getLayerOptions",value:function(){var r=this.parent.getLayerConfig();return(0,ue.Z)((0,ue.Z)({},r),{},{autoFit:!1,mask:t7(this.parent.type)||r.mask})}},{key:"addMask",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t,a){var s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return s=Fm(this.parent.sceneContainer),a.setContainer(s,this.parent.sceneContainer),f.next=4,a.init();case 4:t.addMaskLayer(a);case 5:case"end":return f.stop()}},n,this)}));function r(n,t){return i.apply(this,arguments)}return r}()},{key:"addLayer",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t){var a;return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t.isTileLayer=!0,a=Fm(this.parent.sceneContainer),t.setContainer(a,this.parent.sceneContainer),this.layers.push(t),l.next=6,t.init();case 6:case"end":return l.stop()}},n,this)}));function r(n){return i.apply(this,arguments)}return r}()},{key:"updateVisible",value:function(r){this.visible=r,this.updateOptions("visible",r)}},{key:"updateOptions",value:function(r,n){this.layers.forEach(function(t){t.updateLayerConfig((0,V.Z)({},r,n))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(r){return[]}},{key:"getFeatureById",value:function(r){return[]}},{key:"destroy",value:function(){this.layers.forEach(function(r){return r.destroy()})}}]),e}();function r7(e){var i=n7();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function n7(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var i7=function(e){(0,Ft.Z)(r,e);var i=r7(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return s=this.getSourceOption(),l=s.data.features[0].properties,f=new yw().source(s.data,s.options).size(1).shape("line").color("red"),d=new Ox({minZoom:this.z-1,maxZoom:this.z+1}).source([l],{parser:{type:"json",x:"textLng",y:"textLat"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),O.next=6,this.addLayer(f);case 6:return O.next=8,this.addLayer(d);case 8:this.isLoaded=!0;case 9:case"end":return O.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getSourceOption",value:function(){var t=this.parent.getSource(),a=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:a},options:{parser:{type:"geojson"},transforms:t.transforms}}}}]),r}(Qm);function a7(e){var i=o7();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function o7(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var s7=function(e){(0,Ft.Z)(r,e);var i=a7(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),f=this.getSourceOption(),d=new gC((0,ue.Z)({},l)).source(f.data,f.options),s&&Object.keys(s).forEach(function(Z){var U,se,le=Z;d[le]((U=s[le])===null||U===void 0?void 0:U.field,(se=s[le])===null||se===void 0?void 0:se.values)}),O.next=7,this.addLayer(d);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getSourceOption",value:function(){var t=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:t.transforms}}}}]),r}(Qm);function u7(e){var i=l7();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function l7(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var c7=function(e){(0,Ft.Z)(r,e);var i=u7(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),f=this.getSourceOption(),d=new Lx((0,ue.Z)({},l)).source(f.data,f.options),s&&Object.keys(s).forEach(function(Z){var U,se,le=Z;d[le]((U=s[le])===null||U===void 0?void 0:U.field,(se=s[le])===null||se===void 0?void 0:se.values)}),O.next=7,this.addLayer(d);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getFeatures",value:function(t){if(!t)return[];var a=this.sourceTile.data;return a.getTileData(t)}},{key:"getSourceOption",value:function(){var t=this.parent.getSource(),a=this.parent.getLayerConfig(),s=a.sourceLayer,l=a.featureId,f=this.getFeatures(s);return{data:{type:"FeatureCollection",features:f},options:{parser:{type:"geojson",featureId:l},transforms:t.transforms}}}}]),r}(Qm),f7=["rasterData"];function h7(e){var i=p7();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function p7(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var d7=function(e){(0,Ft.Z)(r,e);var i=h7(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),f=this.getSourceOption(),d=new Ix((0,ue.Z)({},l)).source(f.data,f.options),s&&Object.keys(s).forEach(function(Z){var U,se,le=Z;d[le]((U=s[le])===null||U===void 0?void 0:U.field,(se=s[le])===null||se===void 0?void 0:se.values)}),O.next=7,this.addLayer(d);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getSourceOption",value:function(){var t=this.parent.getSource(),a=this.sourceTile.data.data,s=a.rasterData,l=(0,Xo.Z)(a,f7);return{data:s,options:{parser:(0,ue.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},l),transforms:t.transforms}}}}]),r}(Qm);function v7(e){var i=m7();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function m7(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var g7=function(e){(0,Ft.Z)(r,e);var i=v7(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d;return Ze().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),f=this.getSourceOption(),d=new Ix((0,ue.Z)({},l)).source(f.data,f.options),s&&Object.keys(s).forEach(function(Z){var U,se,le=Z;d[le]((U=s[le])===null||U===void 0?void 0:U.field,(se=s[le])===null||se===void 0?void 0:se.values)}),O.next=7,this.addLayer(d);case 7:this.isLoaded=!0;case 8:case"end":return O.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getSourceOption",value:function(){var t=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:t.transforms}}}}]),r}(Qm),y7=["rasterData"];function _7(e){var i=x7();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function x7(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var b7={positions:[0,1],colors:["#000","#fff"]},E7=function(e){(0,Ft.Z)(r,e);var i=_7(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z;return Ze().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),f=this.getSourceOption(),d=this.getLayerOptions(),S=d.rampColors,O=d.domain,this.colorTexture=this.parent.textureService.getColorTexture(S,O),Z=new Ix((0,ue.Z)((0,ue.Z)({},l),{},{colorTexture:this.colorTexture})).source(f.data,f.options),s&&Object.keys(s).forEach(function(le){var ye,Be,rt=le;Z[rt]((ye=s[rt])===null||ye===void 0?void 0:ye.field,(Be=s[rt])===null||Be===void 0?void 0:Be.values)}),se.next=9,this.addLayer(Z);case 9:this.isLoaded=!0;case 10:case"end":return se.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getSourceOption",value:function(){var t=this.parent.getSource(),a=this.sourceTile.data.data,s=a.rasterData,l=(0,Xo.Z)(a,y7);return{data:s,options:{parser:(0,ue.Z)({type:"raster",extent:this.sourceTile.bounds},l),transforms:t.transforms}}}},{key:"styleUpdate",value:function(){for(var t=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];var f=s,d=f.rampColors,S=d===void 0?b7:d,O=f.domain;this.colorTexture=this.parent.textureService.getColorTexture(S,O||fu(S)),this.layers.forEach(function(Z){return Z.style({colorTexture:t.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(t){return t.destroy()})}}]),r}(Qm);function w7(e){var i=S7();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function S7(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Qx=function(e){(0,Ft.Z)(r,e);var i=w7(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"initTileLayer",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S;return Ze().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(s=this.parent.getLayerAttributeConfig(),l=this.getLayerOptions(),f=e7(this.parent.type),d=this.getSourceOption(),d){Z.next=7;break}return this.isLoaded=!0,Z.abrupt("return");case 7:if(S=new f((0,ue.Z)({},l)).source(d.data,d.options),Object.keys(s).forEach(function(U){var se,le,ye=U;S[ye]((se=s[ye])===null||se===void 0?void 0:se.field,(le=s[ye])===null||le===void 0?void 0:le.values)}),!l.mask){Z.next=12;break}return Z.next=12,this.addTileMask(S);case 12:return Z.next=14,this.addLayer(S);case 14:this.setLayerMinMaxZoom(S),this.isLoaded=!0;case 16:case"end":return Z.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"addTileMask",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(s){var l;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return l=new Lx({layerType:"MaskLayer"}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}),d.next=3,this.addMask(s,l);case 3:case"end":return d.stop()}},a,this)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"getSourceOption",value:function(){var t=this.parent.getSource(),a=this.parent.getLayerConfig(),s=a.sourceLayer,l=s===void 0?"defaultLayer":s,f=a.featureId,d=f===void 0?"id":f,S=this.getFeatures(l);return{data:{type:"FeatureCollection",features:S},options:{parser:{type:"geojson",featureId:d},transforms:t.transforms}}}},{key:"setLayerMinMaxZoom",value:function(t){t.getModelType()==="text"&&t.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(t){var a=this.sourceTile.data;return a.getTileData(t)}},{key:"getFeatureById",value:function(t){var a=this.getMainLayer();if(!a)return[];var s=a.getSource().data.dataArray.filter(function(l){return l._id===t});return s}}]),r}(Qm);function C7(e){var i=e.type;switch(i){case"PolygonLayer":return Qx;case"LineLayer":return Qx;case"PointLayer":return Qx;case"TileDebugLayer":return i7;case"MaskLayer":return c7;case"RasterLayer":var r=e.getSource().parser.dataType;switch(r){case"rgb":case"customRGB":return d7;case"arraybuffer":case"customArrayBuffer":return E7;case"terrainRGB":return g7;default:return s7}default:return Qx}}var CT=function(){function e(i){(0,re.Z)(this,e),(0,V.Z)(this,"initedTileset",!1),(0,V.Z)(this,"viewchange",(0,Kn.debounce)(this.mapchange,24)),this.parent=i;var r=this.parent.getContainer();this.rendererService=r.get(Ir.IRendererService),this.layerService=r.get(Ir.ILayerService),this.mapService=r.get(Ir.IMapService),this.pickingService=r.get(Ir.IPickingService),this.tileLayerService=new Wk({rendererService:this.rendererService,layerService:this.layerService,parent:i}),this.tilePickService=new Qk({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:i}),this.parent.setLayerPickService(this.tilePickService),this.proxy(i),this.initTileSetManager()}return(0,he.Z)(e,[{key:"initTileSetManager",value:function(){var r,n=this.parent.getSource();this.tilesetManager=n.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0);var t=this.getCurrentView(),a=t.latLonBounds,s=t.zoom;(r=this.tilesetManager)===null||r===void 0||r.update(s,a)}},{key:"mapchange",value:function(){var r,n=this.getCurrentView(),t=n.latLonBounds,a=n.zoom;if(this.mapService.version==="GAODE1.x"){var s=this.parent.getLayerConfig(),l=s.visible;a<2&&l?(this.parent.updateLayerConfig({visible:!1}),this.layerService.reRender()):a>=2&&!l&&(this.parent.updateLayerConfig({visible:!0}),this.layerService.reRender())}this.lastViewStates&&this.lastViewStates.zoom===a&&this.lastViewStates.latLonBounds.toString()===t.toString()||(this.lastViewStates={zoom:a,latLonBounds:t},(r=this.tilesetManager)===null||r===void 0||r.throttleUpdate(a,t))}},{key:"getCurrentView",value:function(){var r=this.mapService.getBounds(),n=[r[0][0],r[0][1],r[1][0],r[1][1]],t=this.mapService.getZoom();return{latLonBounds:n,zoom:t}}},{key:"bindTilesetEvent",value:function(){var r=this;this.tilesetManager.on("tile-loaded",function(n){}),this.tilesetManager.on("tile-unload",function(n){r.tileUnLoad(n)}),this.tilesetManager.on("tile-error",function(n,t){r.tileError(n)}),this.tilesetManager.on("tile-update",function(){r.tileUpdate()}),this.mapService.on("zoomend",function(){return r.mapchange()}),this.mapService.on("moveend",function(){return r.viewchange()})}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"tileLoaded",value:function(r){}},{key:"tileError",value:function(r){console.warn("error:",r)}},{key:"destroy",value:function(){var r;(r=this.tilesetManager)===null||r===void 0||r.destroy(),this.tileLayerService.destroy()}},{key:"tileUnLoad",value:function(r){this.tileLayerService.removeTile(r.key)}},{key:"tileUpdate",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(){var t=this,a,s;return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.tilesetManager){f.next=2;break}return f.abrupt("return");case 2:return a=this.parent.getMinZoom(),s=this.parent.getMaxZoom(),f.next=6,Promise.all(this.tilesetManager.tiles.filter(function(d){return d.isLoaded}).filter(function(d){return d.isVisibleChange}).filter(function(d){return d.data}).filter(function(d){return d.z>=a&&d.z<s}).map(function(){var d=(0,Dt.Z)(Ze().mark(function S(O){var Z,U;return Ze().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(t.tileLayerService.hasTile(O.key)){le.next=9;break}return Z=C7(t.parent),U=new Z(O,t.parent),le.next=5,U.initTileLayer();case 5:t.tilePickService.setPickState(),U.getLayers().length!==0&&(t.tileLayerService.addTile(U),t.tileLayerService.updateTileVisible(O),t.layerService.reRender()),le.next=12;break;case 9:t.tileLayerService.updateTileVisible(O),t.tilePickService.setPickState(),t.layerService.reRender();case 12:case"end":return le.stop()}},S)}));return function(S){return d.apply(this,arguments)}}()));case 6:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 7:case"end":return f.stop()}},n,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"setPickState",value:function(r){}},{key:"pickRender",value:function(r){this.tilePickService.pickRender(r)}},{key:"selectFeature",value:function(r){this.tilePickService.selectFeature(r)}},{key:"highlightPickedFeature",value:function(r){this.tilePickService.highlightPickedFeature(r)}},{key:"proxy",value:function(r){var n=this;Jk.forEach(function(t){var a=r[t].bind(r);r[t]=function(){for(var s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];return a.apply(void 0,l),n.getLayers().map(function(d){d[t].apply(d,l)}),t==="style"&&n.getTiles().forEach(function(d){return d.styleUpdate.apply(d,l)}),r}})}}]),e}(),AT,TT,A7=(AT=(0,Xr.b2)(),AT(TT=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"build",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t){return Ze().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t.prepareBuildModel(),s.next=3,t.buildModels();case 3:case"end":return s.stop()}},n)}));function r(n){return i.apply(this,arguments)}return r}()},{key:"initLayerModel",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t){return Ze().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.build(t);case 2:t.styleNeedUpdate=!1;case 3:case"end":return s.stop()}},n,this)}));function r(n){return i.apply(this,arguments)}return r}()},{key:"prepareLayerModel",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t){return Ze().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.build(t);case 2:case"end":return s.stop()}},n,this)}));function r(n){return i.apply(this,arguments)}return r}()},{key:"apply",value:function(r){var n=this;r.hooks.init.tapPromise("LayerModelPlugin",(0,Dt.Z)(Ze().mark(function t(){return Ze().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!r.getSource().isTile){s.next=4;break}return r.prepareBuildModel(),r.tileLayer=new CT(r),s.abrupt("return");case 4:return r.log(nh.BuildModelStart,ih.INIT),s.next=7,n.initLayerModel(r);case 7:r.log(nh.BuildModelEnd,ih.INIT);case 8:case"end":return s.stop()}},t)}))),r.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var t=(0,Dt.Z)(Ze().mark(function a(s){return Ze().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(s){f.next=2;break}return f.abrupt("return",!1);case 2:if(!r.getSource().isTile){f.next=5;break}return r.tileLayer=new CT(r),f.abrupt("return",!1);case 5:return r.log(nh.BuildModelStart,ih.UPDATE),f.next=8,n.prepareLayerModel(r);case 8:return r.log(nh.BuildModelEnd,ih.UPDATE),f.abrupt("return",!0);case 10:case"end":return f.stop()}},a)}));return function(a){return t.apply(this,arguments)}}())}}]),e}())||TT),MT,PT,T7=(MT=(0,Xr.b2)(),MT(PT=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"apply",value:function(r){r.hooks.afterInit.tap("LayerStylePlugin",function(){var n=r.getLayerConfig(),t=n.autoFit,a=n.fitBoundsOptions;t&&r.fitBounds(a)})}}]),e}())||PT),OT,IT,M7=["type"],LT={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},P7={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},O7={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},I7={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function L7(e){var i={u_DirectionalLights:new Array(3).fill((0,ue.Z)({},O7)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,ue.Z)({},I7)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[P7]),e.forEach(function(r){var n=r.type,t=n===void 0?"directional":n,a=(0,Xo.Z)(r,M7),s=LT[t].lights,l=LT[t].num,f=i[l];i[s][f]=(0,ue.Z)((0,ue.Z)({},i[s][f]),a),i[l]++}),i}var R7=(OT=(0,Xr.b2)(),OT(IT=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"apply",value:function(r){r.hooks.beforeRender.tap("LightingPlugin",function(){var n=r.getLayerConfig(),t=n.enableLighting;t&&r.models.forEach(function(a){return a.addUniforms((0,ue.Z)({},L7()))})})}}]),e}())||IT),RT,kT,k7=(RT=(0,Xr.b2)(),RT(kT=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"apply",value:function(r,n){var t=this,a=n.rendererService,s=n.postProcessingPassFactory,l=n.normalPassFactory;r.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var f=r.getLayerConfig(),d=f.enableMultiPassRenderer,S=f.passes,O=S===void 0?[]:S;t.enabled=!!d&&r.getLayerConfig().enableMultiPassRenderer!==!1,t.enabled&&(r.multiPassRenderer=FS(r,O,s,l),r.multiPassRenderer.setRenderFlag(!0))}),r.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(t.enabled){var f=a.getViewportSize(),d=f.width,S=f.height;r.multiPassRenderer.resize(d,S)}})}}]),e}())||kT),DT,FT,Jx={NONE:0,ENCODE:1,HIGHLIGHT:2},D7=(DT=(0,Xr.b2)(),DT(FT=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"apply",value:function(r,n){var t=n.styleAttributeService;r.hooks.init.tapPromise("PixelPickingPlugin",function(){var a=r.getLayerConfig(),s=a.enablePicking;t.registerStyleAttribute({name:"pickingColor",type:Da.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:Ve.FLOAT},size:3,update:function(f){var d=f.id;return s?of(d):[0,0,0]}}})}),r.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var a=r.getLayerConfig(),s=a.enablePicking;s&&r.isVisible()&&r.models.forEach(function(l){return l.addUniforms({u_PickingStage:Jx.ENCODE})})}),r.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var a=r.getLayerConfig(),s=a.enablePicking;s&&r.isVisible()&&r.models.forEach(function(l){return l.addUniforms({u_PickingStage:Jx.HIGHLIGHT})})}),r.hooks.beforeHighlight.tap("PixelPickingPlugin",function(a){var s=r.getLayerConfig(),l=s.highlightColor,f=s.activeMix,d=f===void 0?0:f,S=typeof l=="string"?Qi(l):l||[1,0,0,1];r.updateLayerConfig({pickedFeatureID:Xa(new Uint8Array(a))}),r.models.forEach(function(O){return O.addUniforms({u_PickingStage:Jx.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:S.map(function(Z){return Z*255}),u_activeMix:d})})}),r.hooks.beforeSelect.tap("PixelPickingPlugin",function(a){var s=r.getLayerConfig(),l=s.selectColor,f=s.selectMix,d=f===void 0?0:f,S=typeof l=="string"?Qi(l):l||[1,0,0,1];r.updateLayerConfig({pickedFeatureID:Xa(new Uint8Array(a))}),r.models.forEach(function(O){return O.addUniforms({u_PickingStage:Jx.HIGHLIGHT,u_PickingColor:a,u_HighlightColor:S.map(function(Z){return Z*255}),u_activeMix:d,u_CurrentSelectedId:a,u_SelectColor:S.map(function(Z){return Z*255}),u_EnableSelect:1})})})}}]),e}())||FT),F7=["mvt","geojsonvt","testTile"];function B7(e){var i=e.getSource();return F7.includes(i.parser.type)}function vN(e){return e.getContext?{width:e.width/DOM.DPR,height:e.height/DOM.DPR}:e.getBoundingClientRect()}var BT,NT,N7=(BT=(0,Xr.b2)(),BT(NT=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"apply",value:function(r,n){var t=this,a=n.styleAttributeService;r.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){B7(r)||t.registerBuiltinAttributes(a,r)})}},{key:"registerBuiltinAttributes",value:function(r,n){if(n.type==="MaskLayer"){this.registerPositionAttribute(r);return}this.registerPositionAttribute(r),this.registerColorAttribute(r),this.registerVertexIdAttribute(r)}},{key:"registerPositionAttribute",value:function(r){r.registerStyleAttribute({name:"position",type:Da.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:Ve.FLOAT},size:3,update:function(t,a,s){return s.length===2?[s[0],s[1],0]:[s[0],s[1],s[2]]}}})}},{key:"registerFilterAttribute",value:function(r){r.registerStyleAttribute({name:"filter",type:Da.Attribute,descriptor:{name:"filter",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(t){var a=t.filter;return a?[1]:[0]}}})}},{key:"registerColorAttribute",value:function(r){r.registerStyleAttribute({name:"color",type:Da.Attribute,descriptor:{name:"a_Color",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:4,update:function(t){var a=t.color;return!a||!a.length?[1,1,1,1]:a}}})}},{key:"registerVertexIdAttribute",value:function(r){r.registerStyleAttribute({name:"vertexId",type:Da.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:Ve.DYNAMIC_DRAW,data:[],type:Ve.FLOAT},size:1,update:function(t,a){return[a]}}})}}]),e}())||NT),zT,ZT,UT,jT,VT,HT,Xg,GT,$T,WT,XT,z7=(zT=(0,Xr.b2)(),ZT=(0,Xr.f3)(Ir.ICameraService),UT=(0,Xr.f3)(Ir.ICoordinateSystemService),jT=(0,Xr.f3)(Ir.IRendererService),VT=(0,Xr.f3)(Ir.IMapService),zT(HT=(Xg=function(){function e(){(0,re.Z)(this,e),Ys(this,"cameraService",GT,this),Ys(this,"coordinateSystemService",$T,this),Ys(this,"rendererService",WT,this),Ys(this,"mapService",XT,this)}return(0,he.Z)(e,[{key:"apply",value:function(r){var n=this,t=this.mapService.version,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s=[0,0];r.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var l=r.getLayerConfig().tileOrigin;n.coordinateSystemService.refresh(l),t==="GAODE2.x"&&(n.setLayerCenter(r),a=n.mapService.map.customCoords.getMVPMatrix(),s=n.mapService.getCustomCoordCenter());var f=n.rendererService.getViewportSize(),d=f.width,S=f.height;r.models.forEach(function(O){var Z;O.addUniforms((Z={},(0,V.Z)(Z,jv.ProjectionMatrix,n.cameraService.getProjectionMatrix()),(0,V.Z)(Z,jv.ViewMatrix,n.cameraService.getViewMatrix()),(0,V.Z)(Z,jv.ViewProjectionMatrix,n.cameraService.getViewProjectionMatrix()),(0,V.Z)(Z,jv.Zoom,n.cameraService.getZoom()),(0,V.Z)(Z,jv.ZoomScale,n.cameraService.getZoomScale()),(0,V.Z)(Z,jv.FocalDistance,n.cameraService.getFocalDistance()),(0,V.Z)(Z,jv.CameraPosition,n.cameraService.getCameraPosition()),(0,V.Z)(Z,Hd.CoordinateSystem,n.coordinateSystemService.getCoordinateSystem()),(0,V.Z)(Z,Hd.ViewportCenter,n.coordinateSystemService.getViewportCenter()),(0,V.Z)(Z,Hd.ViewportCenterProjection,n.coordinateSystemService.getViewportCenterProjection()),(0,V.Z)(Z,Hd.PixelsPerDegree,n.coordinateSystemService.getPixelsPerDegree()),(0,V.Z)(Z,Hd.PixelsPerDegree2,n.coordinateSystemService.getPixelsPerDegree2()),(0,V.Z)(Z,Hd.PixelsPerMeter,n.coordinateSystemService.getPixelsPerMeter()),(0,V.Z)(Z,Hd.Mvp,a),(0,V.Z)(Z,"u_SceneCenterMKT",s),(0,V.Z)(Z,"u_ViewportSize",[d,S]),(0,V.Z)(Z,"u_ModelMatrix",n.cameraService.getModelMatrix()),(0,V.Z)(Z,"u_DevicePixelRatio",ha.devicePixelRatio),(0,V.Z)(Z,"u_PickingBuffer",r.getLayerConfig().pickingBuffer||0),(0,V.Z)(Z,"u_shaderPick",Number(r.getShaderPickStat())),Z))})})}},{key:"setLayerCenter",value:function(r){r.coordCenter===void 0&&(r.coordCenter=r.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(r.coordCenter)}}]),e}(),GT=Hs(Xg.prototype,"cameraService",[ZT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$T=Hs(Xg.prototype,"coordinateSystemService",[UT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WT=Hs(Xg.prototype,"rendererService",[jT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XT=Hs(Xg.prototype,"mapService",[VT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xg))||HT),YT,KT,Z7=(YT=(0,Xr.b2)(),YT(KT=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"apply",value:function(r){r.hooks.beforeRender.tap("UpdateModelPlugin",function(){r.layerModel&&r.layerModel.needUpdate().then(function(n){n&&r.renderLayers()})}),r.hooks.afterRender.tap("UpdateModelPlugin",function(){r.layerModelNeedUpdate=!1})}}]),e}())||KT),qT,QT,U7=(qT=(0,Xr.b2)(),qT(QT=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"apply",value:function(r,n){var t=this,a=n.styleAttributeService;r.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){t.initStyleAttribute(r,{styleAttributeService:a})}),r.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){r.layerModelNeedUpdate||r.inited&&t.updateStyleAttribute(r,{styleAttributeService:a})})}},{key:"updateStyleAttribute",value:function(r,n){var t=n.styleAttributeService,a=t.getLayerStyleAttributes()||[],s=t.getLayerStyleAttribute("filter");if(s&&s.needRegenerateVertices){r.layerModelNeedUpdate=!0,a.forEach(function(l){return l.needRegenerateVertices=!1});return}a.filter(function(l){return l.needRegenerateVertices}).forEach(function(l){t.updateAttributeByFeatureRange(l.name,r.getEncodedData(),l.featureRange.startIndex,l.featureRange.endIndex,r),l.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(r,n){var t=n.styleAttributeService,a=t.getLayerStyleAttributes()||[];a.filter(function(s){return s.needRegenerateVertices}).forEach(function(s){t.updateAttributeByFeatureRange(s.name,r.getEncodedData(),s.featureRange.startIndex,s.featureRange.endIndex),s.needRegenerateVertices=!1})}}]),e}())||QT);bd.bind(Ir.ILayerPlugin).to(EL).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(N7).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(Gk).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(bL).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(T7).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(U7).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(Z7).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(k7).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(z7).inRequestScope(),bd.bind(Ir.ILayerPlugin).to($k).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(R7).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(D7).inRequestScope(),bd.bind(Ir.ILayerPlugin).to(A7).inRequestScope();var JT,$w,e3,Yg=(JT=Rg(Ir.IGlobalConfigService),$w=function(){function e(i){(0,re.Z)(this,e),Ys(this,"configService",e3,this),this.config=i}return(0,he.Z)(e,[{key:"setContainer",value:function(r,n,t,a){r.bind(Ir.MapConfig).toConstantValue((0,ue.Z)((0,ue.Z)({},this.config),{},{id:n,canvas:t,hasBaseMap:a})),r.bind(Ir.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),e3=Hs($w.prototype,"configService",[JT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$w),j7=I(81618),t3=I.n(j7),r3=function(){function e(i){(0,re.Z)(this,e),(0,V.Z)(this,"size",1e4),this.size=i||1e4}return(0,he.Z)(e,[{key:"setSize",value:function(r){this.size=r}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(r){return(180+r)/360*this.size}},{key:"mercatorYfromLat",value:function(r){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(r){return r/this.size*360-180}},{key:"latFromMercatorY",value:function(r){var n=180-(1-r/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90}},{key:"project",value:function(r){var n=this.mercatorXfromLng(r[0]),t=this.mercatorYfromLat(r[1]);return[n,t]}},{key:"unproject",value:function(r){var n=this.lngFromMercatorX(r[0]),t=this.latFromMercatorY(r[1]);return[n,t]}}]),e}();function n3(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return(0,ue.Z)((0,ue.Z)({},i),e)}function m1(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function eb(e,i){var r=Zv([],i,e);return um(r,r,1/r[3]),r}function mN(e,i){var r=e%i;return r<0?i+r:r}function gN(e,i,r){return r*i+(1-r)*e}function Jm(e,i){if(!e)throw new Error(i||"viewport-mercator-project: assertion failed.")}var Mv=Math.PI,i3=Mv/4,c0=Mv/180,a3=180/Mv,Ww=512,Xw=4003e4,V7=1.5;function o3(e){return Math.pow(2,e)}function H7(e){return Math.log2(e)}function tb(e,i){var r=(0,Ja.Z)(e,2),n=r[0],t=r[1];Jm(Number.isFinite(n)&&Number.isFinite(i)),Jm(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude"),i*=Ww;var a=n*c0,s=t*c0,l=i*(a+Mv)/(2*Mv),f=i*(Mv-Math.log(Math.tan(i3+s*.5)))/(2*Mv);return[l,f]}function Yw(e,i){var r=(0,Ja.Z)(e,2),n=r[0],t=r[1];i*=Ww;var a=n/i*(2*Mv)-Mv,s=2*(Math.atan(Math.exp(Mv-t/i*(2*Mv)))-i3);return[a*a3,s*a3]}function yN(e){var i=e.latitude;assert(Number.isFinite(i));var r=Math.cos(i*c0);return H7(Xw*r)-9}function s3(e){var i=e.latitude,r=e.longitude,n=e.zoom,t=e.scale,a=e.highPrecision,s=a===void 0?!1:a;t=t!==void 0?t:o3(n),Jm(Number.isFinite(i)&&Number.isFinite(r)&&Number.isFinite(t));var l={},f=Ww*t,d=Math.cos(i*c0),S=f/360,O=S/d,Z=f/Xw/d;if(l.pixelsPerMeter=[Z,-Z,Z],l.metersPerPixel=[1/Z,-1/Z,1/Z],l.pixelsPerDegree=[S,-O,Z],l.degreesPerPixel=[1/S,-1/O,1/Z],s){var U=c0*Math.tan(i*c0)/d,se=S*U/2,le=f/Xw*U,ye=le/O*Z;l.pixelsPerDegree2=[0,-se,le],l.pixelsPerMeter2=[ye,0,ye]}return l}function _N(e,i){var r=_slicedToArray(e,3),n=r[0],t=r[1],a=r[2],s=_slicedToArray(i,3),l=s[0],f=s[1],d=s[2],S=1,O=s3({longitude:n,latitude:t,scale:S,highPrecision:!0}),Z=O.pixelsPerMeter,U=O.pixelsPerMeter2,se=tb(e,S);se[0]+=l*(Z[0]+U[0]*f),se[1]+=f*(Z[1]+U[1]*f);var le=Yw(se,S),ye=(a||0)+(d||0);return Number.isFinite(a)||Number.isFinite(d)?[le[0],le[1],ye]:le}function G7(e){var i=e.height,r=e.pitch,n=e.bearing,t=e.altitude,a=e.center,s=a===void 0?null:a,l=e.flipY,f=l===void 0?!1:l,d=m1();return Lc(d,d,[0,0,-t]),Ru(d,d,[1,1,1/i]),wp(d,d,-r*c0),vp(d,d,n*c0),f&&Ru(d,d,[1,-1,1]),s&&Lc(d,d,KS([],s)),d}function $7(e){var i=e.width,r=e.height,n=e.altitude,t=n===void 0?V7:n,a=e.pitch,s=a===void 0?0:a,l=e.nearZMultiplier,f=l===void 0?1:l,d=e.farZMultiplier,S=d===void 0?1:d,O=s*c0,Z=Math.atan(.5/t),U=Math.sin(Z)*t/Math.sin(Math.PI/2-O-Z),se=Math.cos(Math.PI/2-O)*U+t;return{fov:2*Math.atan(r/2/t),aspect:i/r,focalDistance:t,near:f,far:se*S}}function W7(e){var i=e.width,r=e.height,n=e.pitch,t=e.altitude,a=e.nearZMultiplier,s=e.farZMultiplier,l=$7({width:i,height:r,altitude:t,pitch:n,nearZMultiplier:a,farZMultiplier:s}),f=l.fov,d=l.aspect,S=l.near,O=l.far,Z=_d([],f,d,S,O);return Z}function X7(e,i){var r=(0,Ja.Z)(e,3),n=r[0],t=r[1],a=r[2],s=a===void 0?0:a;return Jm(Number.isFinite(n)&&Number.isFinite(t)&&Number.isFinite(s)),eb(i,[n,t,s,1])}function u3(e,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=(0,Ja.Z)(e,3),t=n[0],a=n[1],s=n[2];if(Jm(Number.isFinite(t)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(s)){var l=eb(i,[t,a,s,1]);return l}var f=eb(i,[t,a,0,1]),d=eb(i,[t,a,1,1]),S=f[2],O=d[2],Z=S===O?0:((r||0)-S)/(O-S);return Vo([],f,d,Z)}var l3=m1(),Y7=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=i.width,n=i.height,t=i.viewMatrix,a=t===void 0?l3:t,s=i.projectionMatrix,l=s===void 0?l3:s;(0,re.Z)(this,e),this.width=r||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=l;var f=m1();ef(f,f,this.projectionMatrix),ef(f,f,this.viewMatrix),this.viewProjectionMatrix=f;var d=m1();Ru(d,d,[this.width/2,-this.height/2,1]),Lc(d,d,[1,-1,0]),ef(d,d,this.viewProjectionMatrix);var S=td(m1(),d);if(!S)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=d,this.pixelUnprojectionMatrix=S,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,he.Z)(e,[{key:"equals",value:function(r){return r instanceof e?r.width===this.width&&r.height===this.height&&Fv(r.projectionMatrix,this.projectionMatrix)&&Fv(r.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=n.topLeft,a=t===void 0?!0:t,s=this.projectPosition(r),l=X7(s,this.pixelProjectionMatrix),f=(0,Ja.Z)(l,2),d=f[0],S=f[1],O=a?S:this.height-S;return r.length===2?[d,O]:[d,O,l[2]]}},{key:"unproject",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=n.topLeft,a=t===void 0?!0:t,s=n.targetZ,l=(0,Ja.Z)(r,3),f=l[0],d=l[1],S=l[2],O=a?d:this.height-d,Z=s&&s*this.pixelsPerMeter,U=u3([f,O,S],this.pixelUnprojectionMatrix,Z),se=this.unprojectPosition(U),le=(0,Ja.Z)(se,3),ye=le[0],Be=le[1],rt=le[2];return Number.isFinite(S)?[ye,Be,rt]:Number.isFinite(s)?[ye,Be,s]:[ye,Be]}},{key:"projectPosition",value:function(r){var n=this.projectFlat(r),t=(0,Ja.Z)(n,2),a=t[0],s=t[1],l=(r[2]||0)*this.pixelsPerMeter;return[a,s,l]}},{key:"unprojectPosition",value:function(r){var n=this.unprojectFlat(r),t=(0,Ja.Z)(n,2),a=t[0],s=t[1],l=(r[2]||0)/this.pixelsPerMeter;return[a,s,l]}},{key:"projectFlat",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return r}},{key:"unprojectFlat",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return r}}]),e}();function K7(e){var i=e.width,r=e.height,n=e.bounds,t=e.minExtent,a=t===void 0?0:t,s=e.maxZoom,l=s===void 0?24:s,f=e.padding,d=f===void 0?0:f,S=e.offset,O=S===void 0?[0,0]:S,Z=(0,Ja.Z)(n,2),U=(0,Ja.Z)(Z[0],2),se=U[0],le=U[1],ye=(0,Ja.Z)(Z[1],2),Be=ye[0],rt=ye[1];if(Number.isFinite(d)){var Je=d;d={top:Je,bottom:Je,left:Je,right:Je}}else Jm(Number.isFinite(d.top)&&Number.isFinite(d.bottom)&&Number.isFinite(d.left)&&Number.isFinite(d.right));var Ot=new Kw({width:i,height:r,longitude:0,latitude:0,zoom:0}),jt=Ot.project([se,rt]),dr=Ot.project([Be,le]),Lr=[Math.max(Math.abs(dr[0]-jt[0]),a),Math.max(Math.abs(dr[1]-jt[1]),a)],jr=[i-d.left-d.right-Math.abs(O[0])*2,r-d.top-d.bottom-Math.abs(O[1])*2];Jm(jr[0]>0&&jr[1]>0);var Jr=jr[0]/Lr[0],Pn=jr[1]/Lr[1],In=(d.right-d.left)/2/Jr,Si=(d.bottom-d.top)/2/Pn,ra=[(dr[0]+jt[0])/2+In,(dr[1]+jt[1])/2+Si],Va=Ot.unproject(ra),Ms=Ot.zoom+Math.log2(Math.abs(Math.min(Jr,Pn)));return{longitude:Va[0],latitude:Va[1],zoom:Math.min(Ms,l)}}var Kw=function(e){(0,Ft.Z)(i,e);function i(){var r,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=n.width,a=n.height,s=n.latitude,l=s===void 0?0:s,f=n.longitude,d=f===void 0?0:f,S=n.zoom,O=S===void 0?0:S,Z=n.pitch,U=Z===void 0?0:Z,se=n.bearing,le=se===void 0?0:se,ye=n.altitude,Be=ye===void 0?1.5:ye,rt=n.nearZMultiplier,Je=n.farZMultiplier;(0,re.Z)(this,i),t=t||1,a=a||1;var Ot=o3(O);Be=Math.max(.75,Be);var jt=tb([d,l],Ot);jt[2]=0;var dr=W7({width:t,height:a,pitch:U,bearing:le,altitude:Be,nearZMultiplier:rt||1/a,farZMultiplier:Je||1.01}),Lr=G7({height:a,center:jt,pitch:U,bearing:le,altitude:Be,flipY:!0});return r=(0,rr.Z)(this,(0,ot.Z)(i).call(this,{width:t,height:a,viewMatrix:Lr,projectionMatrix:dr})),r.latitude=l,r.longitude=d,r.zoom=O,r.pitch=U,r.bearing=le,r.altitude=Be,r.scale=Ot,r.center=jt,r.pixelsPerMeter=s3((0,ct.Z)((0,ct.Z)(r))).pixelsPerMeter[2],Object.freeze((0,ct.Z)((0,ct.Z)(r))),r}return(0,he.Z)(i,[{key:"projectFlat",value:function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return tb(n,t)}},{key:"unprojectFlat",value:function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Yw(n,t)}},{key:"getMapCenterByLngLatPosition",value:function(n){var t=n.lngLat,a=n.pos,s=u3(a,this.pixelUnprojectionMatrix),l=tb(t,this.scale),f=Hi([],l,Il([],s)),d=Hi([],this.center,f);return Yw(d,this.scale)}},{key:"getLocationAtPoint",value:function(n){var t=n.lngLat,a=n.pos;return this.getMapCenterByLngLatPosition({lngLat:t,pos:a})}},{key:"fitBounds",value:function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,s=this.height,l=K7(Object.assign({width:a,height:s,bounds:n},t)),f=l.longitude,d=l.latitude,S=l.zoom;return new i({width:a,height:s,longitude:f,latitude:d,zoom:S})}}]),i}(Y7),rb=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"syncWithMapCamera",value:function(r){var n=r.center,t=r.zoom,a=r.pitch,s=r.bearing,l=r.viewportHeight,f=r.viewportWidth,d=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new Kw((0,ue.Z)((0,ue.Z)({},d),{},{width:f,height:l,longitude:n&&n[0],latitude:n&&n[1],zoom:t,pitch:a,bearing:s}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(r,n){return this.viewport.projectFlat(r,n)}}]),e}(),q7={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},Q7=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],c3,f3,h3,p3,d3,v3,Kg,m3,g3,y3,_3;function J7(e,i){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||n)&&(i||(i=document),!!i)){var t=i.head||i.getElementsByTagName("head")[0];if(!t){t=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(t,a):i.documentElement.appendChild(t)}var s=i.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(i.createTextNode(e)),t.appendChild(s),s}}J7(`.amap-logo{
 display: none !important;
}
`);var x3={contextmenu:"rightclick"},e8=0;window.forceWebGL=!0;var b3="15cd8a57710d40c9b7c0e3cc120f1200",t8="1.4.15",r8="amap-script",qw=!1,nb=[],n8=12,E3=(c3=(0,Xr.b2)(),f3=(0,Xr.f3)(Ir.IGlobalConfigService),h3=(0,Xr.f3)(Ir.MapConfig),p3=(0,Xr.f3)(Ir.ICoordinateSystemService),d3=(0,Xr.f3)(Ir.IEventEmitter),c3(v3=(Kg=function(){function e(){var i=this;(0,re.Z)(this,e),(0,V.Z)(this,"version",ah["GAODE1.x"]),(0,V.Z)(this,"simpleMapCoord",new r3),(0,V.Z)(this,"bgColor","rgba(0, 0, 0, 0)"),Ys(this,"configService",m3,this),Ys(this,"config",g3,this),Ys(this,"coordinateSystemService",y3,this),Ys(this,"eventEmitter",_3,this),(0,V.Z)(this,"handleCameraChanged",function(r){var n=r.camera,t=n.fov,a=n.near,s=n.far,l=n.height,f=n.pitch,d=n.rotation,S=n.aspect,O=n.position,Z=i.getCenter(),U=Z.lng,se=Z.lat;if(i.emit("mapchange"),i.cameraChangedCallback){i.viewport.syncWithMapCamera({aspect:S,bearing:360-d,far:s,fov:t,cameraHeight:l,near:a,pitch:f,zoom:i.map.getZoom()-1,center:[U,se],offsetOrigin:[O.x,O.y]});var le=i.config.offsetZoom,ye=le===void 0?n8:le;i.viewport.getZoom()>ye?i.coordinateSystemService.setCoordinateSystem(Wf.P20_OFFSET):i.coordinateSystemService.setCoordinateSystem(Wf.P20),i.cameraChangedCallback(i.viewport)}})}return(0,he.Z)(e,[{key:"setBgColor",value:function(r){this.bgColor=r}},{key:"addMarkerContainer",value:function(){var r=this.map.getContainer();if(r!==null){var n=r.getElementsByClassName("amap-maps")[0];this.markerContainer=ss("div","l7-marker-container",n)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(r,n){Nm.indexOf(r)!==-1?this.eventEmitter.on(r,n):this.map.on(x3[r]||r,n)}},{key:"off",value:function(r,n){Nm.indexOf(r)!==-1?this.eventEmitter.off(r,n):this.map.off(x3[r]||r,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var r;return(r=this.map.getContainer())===null||r===void 0?void 0:r.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var r=this.map.getSize();return[r.getWidth(),r.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(r){return this.map.setZoom(r+1)}},{key:"getCenter",value:function(r){if(r!=null&&r.padding){var n=this.getCenter(),t=n3(r.padding),a=this.lngLatToPixel([n.lng,n.lat]),s=[(t.right-t.left)/2,(t.bottom-t.top)/2],l=this.pixelToLngLat([a.x-s[0],a.y-s[1]]);return l}var f=this.map.getCenter();return{lng:f.getLng(),lat:f.getLat()}}},{key:"setCenter",value:function(r,n){if(n!=null&&n.padding){var t=n3(n.padding),a=this.lngLatToPixel(r),s=[(t.right-t.left)/2,(t.bottom-t.top)/2],l=this.pixelToLngLat([a.x+s[0],a.y+s[1]]);this.map.setCenter([l.lng,l.lat])}else this.map.setCenter(r)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var r=this.map.getBounds().toBounds(),n=r.getNorthEast(),t=r.getSouthWest(),a=this.getCenter(),s=a.lng>n.getLng()||a.lng<t.getLng()?180-n.getLng():n.getLng(),l=a.lng<t.getLng()?t.getLng()-180:t.getLng();return[[l,t.getLat()],[s,n.getLat()]]}},{key:"getMinZoom",value:function(){var r=this.map.get("zooms");return r[0]-1}},{key:"getMaxZoom",value:function(){var r=this.map.get("zooms");return r[1]-1}},{key:"setRotation",value:function(r){return this.map.setRotation(r)}},{key:"setPitch",value:function(r){return this.map.setPitch(r)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(r){this.map.panTo(r)}},{key:"panBy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(r,n)}},{key:"fitBounds",value:function(r){this.map.setBounds(new AMap.Bounds([r[0][0],r[0][1],r[1][0],r[1][1]]))}},{key:"setZoomAndCenter",value:function(r,n){this.map.setZoomAndCenter(r+1,n)}},{key:"setMapStyle",value:function(r){this.map.setMapStyle(this.getMapStyleValue(r))}},{key:"setMapStatus",value:function(r){this.map.setStatus(r)}},{key:"getMapStyleConfig",value:function(){return q7}},{key:"getMapStyleValue",value:function(r){return this.getMapStyleConfig()[r]||r}},{key:"getMapStyle",value:function(){return this.map.getMapStyle()}},{key:"pixelToLngLat",value:function(r){var n=this.map.pixelToLngLat(new AMap.Pixel(r[0],r[1]));return{lng:n.getLng(),lat:n.getLat()}}},{key:"lngLatToPixel",value:function(r){var n=this.map.lnglatToPixel(new AMap.LngLat(r[0],r[1]));return{x:n.getX(),y:n.getY()}}},{key:"containerToLngLat",value:function(r){var n=new AMap.Pixel(r[0],r[1]),t=this.map.containerToLngLat(n);return{lng:t==null?void 0:t.getLng(),lat:t==null?void 0:t.getLat()}}},{key:"lngLatToContainer",value:function(r){var n=new AMap.LngLat(r[0],r[1]),t=this.map.lngLatToContainer(n);return{x:t.getX(),y:t.getY()}}},{key:"lngLatToCoord",value:function(r){var n=this.map.lngLatToGeodeticCoord(r),t=n.x,a=n.y;return[t,-a]}},{key:"lngLatToMercator",value:function(r,n){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(r,n,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],s=this.viewport.projectFlat(r),l=rl();return Lc(l,l,Kl(s[0],s[1],n)),Ru(l,l,Kl(a[0],a[1],a[2])),wp(l,l,t[0]),zp(l,l,t[1]),vp(l,l,t[2]),l}},{key:"init",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(){var t=this,a,s,l,f,d,S,O,Z,U,se,le,ye,Be,rt;return Ze().wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:return a=this.config,s=a.id,l=a.style,f=l===void 0?"light":l,d=a.minZoom,S=d===void 0?0:d,O=a.maxZoom,Z=O===void 0?18:O,U=a.token,se=U===void 0?b3:U,le=a.mapInstance,ye=a.plugin,Be=ye===void 0?[]:ye,rt=(0,Xo.Z)(a,Q7),Ot.next=3,new Promise(function(jt){var dr=function(){if(le)t.map=le,t.$mapContainer=t.map.getContainer(),setTimeout(function(){t.map.on("camerachange",t.handleCameraChanged),jt()},30);else{t.$mapContainer=t.creatMapContainer(s);var jr=(0,ue.Z)({mapStyle:t.getMapStyleValue(f),zooms:[S,Z],viewMode:"3D"},rt);jr.zoom&&(jr.zoom+=1);var Jr=new AMap.Map(t.$mapContainer,jr);Jr.on("camerachange",t.handleCameraChanged),Jr.on("camerachange",function(){setTimeout(function(){return t.handleAfterMapChange()})}),t.map=Jr,setTimeout(function(){jt()},10)}};!qw&&!le?(se===b3&&console.warn("%c".concat(t.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),qw=!0,Be.push("Map3D"),t3().load({key:se,version:t8,plugins:Be}).then(function(){dr(),nb.length&&(nb.forEach(function(Lr){return Lr()}),nb=[])}).catch(function(Lr){throw new Error(Lr)})):qw&&window.AMap||le?dr():nb.push(dr)});case 3:this.viewport=new rb;case 4:case"end":return Ot.stop()}},n,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"meterToCoord",value:function(r,n){var t=AMap.GeometryUtil.distance(vi(AMap.LngLat,(0,oe.Z)(r)),vi(AMap.LngLat,(0,oe.Z)(n))),a=this.lngLatToCoord(r),s=(0,Ja.Z)(a,2),l=s[0],f=s[1],d=this.lngLatToCoord(n),S=(0,Ja.Z)(d,2),O=S[0],Z=S[1],U=Math.sqrt(Math.pow(l-O,2)+Math.pow(f-Z,2));return U/t}},{key:"updateView",value:function(r){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(r){var n,t=(n=this.getContainer())===null||n===void 0?void 0:n.getElementsByClassName("amap-layer")[0],a=r==="jpg"?t==null?void 0:t.toDataURL("image/jpeg"):t==null?void 0:t.toDataURL("image/png");return a}},{key:"emit",value:function(r){for(var n,t=arguments.length,a=new Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];(n=this.eventEmitter).emit.apply(n,[r].concat(a))}},{key:"once",value:function(r){for(var n,t=arguments.length,a=new Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];(n=this.eventEmitter).once.apply(n,[r].concat(a))}},{key:"destroy",value:function(){var r,n;(r=this.$mapContainer)===null||r===void 0||(n=r.parentNode)===null||n===void 0||n.removeChild(this.$mapContainer),delete window.initAMap;var t=document.getElementById(r8);t&&document.head.removeChild(t),this.map.destroy()}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(r){this.cameraChangedCallback=r}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"creatMapContainer",value:function(r){var n=r;typeof r=="string"&&(n=document.getElementById(r));var t=document.createElement("div");return t.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,t.id="l7_amap_div"+e8++,n.appendChild(t),t}}]),e}(),m3=Hs(Kg.prototype,"configService",[f3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g3=Hs(Kg.prototype,"config",[h3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y3=Hs(Kg.prototype,"coordinateSystemService",[p3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_3=Hs(Kg.prototype,"eventEmitter",[d3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kg))||v3);if(!window)throw Error("AMap JSAPI can only be used in Browser.");var cv;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(cv||(cv={}));var Fd={key:"",AMap:{version:"2.0",plugins:[]}},f0={AMap:cv.notload},i8={AMap:[]},a8=[],o8=function(i){if(typeof i=="function"){if(f0.AMap===cv.loaded){i(window.AMap);return}a8.push(i)}},s8=function(){var e=(0,Dt.Z)(Ze().mark(function i(r){return Ze().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(a,s){if(f0.AMap===cv.failed)s("");else if(f0.AMap===cv.notload){var l=r.key,f=r.version,d=r.plugins;if(!l){s("\u8BF7\u586B\u5199key");return}window.AMap&&location.host!=="lbs.amap.com"&&s("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),Fd.key=l,Fd.AMap.version=f||Fd.AMap.version,Fd.AMap.plugins=d||Fd.AMap.plugins,f0.AMap=cv.loading;var S=document.body||document.head;window._onAPILoaded=function(se){se?(f0.AMap=cv.failed,s(se)):(f0.AMap=cv.loaded,a(null))};var O=document.createElement("script");O.type="text/javascript",O.async=!1,O.src="https://webapi.amap.com/maps?callback=_onAPILoaded&v="+Fd.AMap.version+"&key="+l+"&plugin="+Fd.AMap.plugins.join(","),O.onerror=function(se){f0.AMap=cv.failed,s(se)},S.appendChild(O)}else if(f0.AMap===cv.loaded){if(r.key&&r.key!==Fd.key){s("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");return}if(r.version&&r.version!==Fd.AMap.version){s("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");return}var Z=[];r.plugins&&r.plugins.forEach(function(se){Fd.AMap.plugins.indexOf(se)===-1&&Z.push(se)}),Z.length&&window.AMap.plugin(Z,function(){a(window.AMap)})}else{if(r.key&&r.key!==Fd.key){s("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");return}if(r.version&&r.version!==Fd.AMap.version){s("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");return}var U=[];r.plugins&&r.plugins.forEach(function(se){Fd.AMap.plugins.indexOf(se)===-1&&U.push(se)}),o8(function(){U.length&&window.AMap.plugin(U,function(){a(window.AMap)})})}}));case 1:case"end":return t.stop()}},i)}));return function(r){return e.apply(this,arguments)}}();function u8(){delete window.AMap,Fd={key:"",AMap:{version:"1.4.15",plugins:[]}},f0={AMap:cv.notload},i8={AMap:[]}}var l8={load:s8,reset:u8},w3=Math.PI/180,c8=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"projectionMatrix",rl()),(0,V.Z)(this,"viewMatrix",rl()),(0,V.Z)(this,"viewProjectionMatrix",rl()),(0,V.Z)(this,"ViewProjectionMatrixUncentered",rl()),(0,V.Z)(this,"viewUncenteredMatrix",rl())}return(0,he.Z)(e,[{key:"syncWithMapCamera",value:function(r){var n=r.zoom,t=n===void 0?1:n,a=r.pitch,s=a===void 0?0:a,l=r.bearing,f=l===void 0?0:l,d=r.center,S=d===void 0?[0,0]:d,O=r.offsetOrigin,Z=O===void 0?[0,0]:O,U=r.cameraHeight,se=U===void 0?1:U,le=r.aspect,ye=le===void 0?1:le,Be=r.near,rt=Be===void 0?.1:Be,Je=r.far,Ot=Je===void 0?1e3:Je,jt=r.fov,dr=jt===void 0?0:jt;this.zoom=t,this.center=S;var Lr=s*w3,jr=(360-f)*w3;_d(this.projectionMatrix,dr,ye,rt,Ot);var Jr=Kl(se*Math.sin(Lr)*Math.sin(jr),-se*Math.sin(Lr)*Math.cos(jr),se*Math.cos(Lr)),Pn=Kl(-Math.cos(Lr)*Math.sin(jr),Math.cos(Lr)*Math.cos(jr),Math.sin(Lr));mp(this.viewMatrix,Jr,Kl(0,0,0),Pn),this.viewUncenteredMatrix=rh(this.viewMatrix),Lc(this.viewMatrix,this.viewMatrix,Kl(-Z[0],Z[1],0)),ef(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),ef(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var r=(0,Ja.Z)(this.center,2),n=r[0],t=r[1];return[n,t]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(r){var n=85.0511287798,t=Math.max(Math.min(n,r[1]),-n),a=256<<20,s=Math.PI/180,l=r[0]*s,f=t*s;f=Math.log(Math.tan(Math.PI/4+f/2));var d=.5/Math.PI,S=.5,O=-.5/Math.PI;return s=.5,l=a*(d*l+S)-215440491,f=-(a*(O*f+s)-106744817),[l,f]}}]),e}(),f8=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],S3,C3;function h8(e){var i=p8();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function p8(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}window.forceWebGL=!0;var A3="15cd8a57710d40c9b7c0e3cc120f1200",d8="1.4.15",Qw=!1,ib=[],v8=12,m8=(S3=(0,Xr.b2)(),S3(C3=function(e){(0,Ft.Z)(r,e);var i=h8(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"version",ah["GAODE1.x"]),(0,V.Z)((0,ct.Z)(n),"handleCameraChanged",function(l){var f=l.camera,d=f.fov,S=f.near,O=f.far,Z=f.height,U=f.pitch,se=f.rotation,le=f.aspect,ye=f.position,Be=n.getCenter(),rt=Be.lng,Je=Be.lat;if(n.emit("mapchange"),n.cameraChangedCallback){n.viewport.syncWithMapCamera({aspect:le,bearing:360-se,far:O,fov:d,cameraHeight:Z,near:S,pitch:U,zoom:n.map.getZoom()-1,center:[rt,Je],offsetOrigin:[ye.x,ye.y]});var Ot=n.config.offsetZoom,jt=Ot===void 0?v8:Ot;n.viewport.getZoom()>jt?n.coordinateSystemService.setCoordinateSystem(Wf.P20_OFFSET):n.coordinateSystemService.setCoordinateSystem(Wf.P20),n.cameraChangedCallback(n.viewport)}}),n}return(0,he.Z)(r,[{key:"getModelMatrix",value:function(t,a,s){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],f=this.viewport.projectFlat(t),d=rl();return Lc(d,d,Kl(f[0],f[1],a)),Ru(d,d,Kl(l[0],l[1],l[2])),wp(d,d,s[0]),zp(d,d,s[1]),vp(d,d,s[2]),d}},{key:"init",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s=this,l,f,d,S,O,Z,U,se,le,ye,Be,rt,Je,Ot;return Ze().wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:return l=this.config,f=l.id,d=l.style,S=d===void 0?"light":d,O=l.minZoom,Z=O===void 0?0:O,U=l.maxZoom,se=U===void 0?18:U,le=l.token,ye=le===void 0?A3:le,Be=l.mapInstance,rt=l.plugin,Je=rt===void 0?[]:rt,Ot=(0,Xo.Z)(l,f8),dr.next=3,new Promise(function(Lr){var jr=function(){if(Be)s.map=Be,s.$mapContainer=s.map.getContainer(),setTimeout(function(){s.map.on("camerachange",s.handleCameraChanged),Lr()},30);else{s.$mapContainer=s.creatMapContainer(f);var Pn=(0,ue.Z)({mapStyle:s.getMapStyleValue(S),zooms:[Z,se],viewMode:"3D"},Ot);Pn.zoom&&(Pn.zoom+=1);var In=new AMap.Map(s.$mapContainer,Pn);In.on("camerachange",s.handleCameraChanged),In.on("camerachange",function(){setTimeout(function(){return s.handleAfterMapChange()})}),s.map=In,setTimeout(function(){Lr()},10)}};!Qw&&!Be?(ye===A3&&console.warn(s.configService.getSceneWarninfo("MapToken")),Qw=!0,Je.push("Map3D"),l8.load({key:ye,version:d8,plugins:Je}).then(function(Jr){jr(),ib.length&&(ib.forEach(function(Pn){return Pn()}),ib=[])}).catch(function(Jr){throw new Error(Jr)})):Qw&&window.AMap||Be?jr():ib.push(jr)});case 3:this.viewport=new c8;case 4:case"end":return dr.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"meterToCoord",value:function(t,a){var s=AMap.GeometryUtil.distance(vi(AMap.LngLat,(0,oe.Z)(t)),vi(AMap.LngLat,(0,oe.Z)(a))),l=this.lngLatToCoord(t),f=(0,Ja.Z)(l,2),d=f[0],S=f[1],O=this.lngLatToCoord(a),Z=(0,Ja.Z)(O,2),U=Z[0],se=Z[1],le=Math.sqrt(Math.pow(d-U,2)+Math.pow(S-se,2));return le/s}},{key:"updateView",value:function(t){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(t){var a,s=(a=this.getContainer())===null||a===void 0?void 0:a.getElementsByClassName("amap-layer")[0],l=t==="jpg"?s==null?void 0:s.toDataURL("image/jpeg"):s==null?void 0:s.toDataURL("image/png");return l}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}}]),r}(E3))||C3);function g8(e){var i=y8();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function y8(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var _8=function(e){(0,Ft.Z)(r,e);var i=g8(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getServiceConstructor",value:function(){return m8}}]),r}(Yg),x8=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"projectionMatrix",rl()),(0,V.Z)(this,"viewMatrix",rl()),(0,V.Z)(this,"viewProjectionMatrix",rl()),(0,V.Z)(this,"ViewProjectionMatrixUncentered",rl()),(0,V.Z)(this,"viewUncenteredMatrix",rl())}return(0,he.Z)(e,[{key:"syncWithMapCamera",value:function(r){var n=r.zoom,t=n===void 0?1:n,a=r.center,s=a===void 0?[0,0]:a,l=r.offsetOrigin,f=l===void 0?[0,0]:l,d=r.cameraPosition,S=d===void 0?[0,0,0]:d,O=r.up,Z=O===void 0?[0,1,0]:O,U=r.lookAt,se=U===void 0?[0,0,0]:U,le=r.aspect,ye=le===void 0?1:le,Be=r.near,rt=Be===void 0?.1:Be,Je=r.far,Ot=Je===void 0?1e3:Je,jt=r.fov,dr=jt===void 0?45:jt;this.zoom=t,this.center=s,_d(this.projectionMatrix,dr/180*Math.PI,ye,rt,Ot);var Lr=Kl.apply(ae,(0,oe.Z)(S)),jr=Kl.apply(ae,(0,oe.Z)(se)),Jr=Kl.apply(ae,(0,oe.Z)(Z));mp(this.viewMatrix,Lr,jr,Jr),this.viewUncenteredMatrix=rh(this.viewMatrix),Lc(this.viewMatrix,this.viewMatrix,Kl(-f[0],f[1],0)),ef(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),ef(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var r=(0,Ja.Z)(this.center,2),n=r[0],t=r[1];return[n,t]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1.2}},{key:"projectFlat",value:function(r){var n=85.0511287798,t=Math.max(Math.min(n,r[1]),-n),a=256<<20,s=Math.PI/180,l=r[0]*s,f=t*s;f=Math.log(Math.tan(Math.PI/4+f/2));var d=.5/Math.PI,S=.5,O=-.5/Math.PI;return s=.5,l=a*(d*l+S)-215440491,f=-(a*(O*f+s)-106744817),[l,f]}}]),e}(),b8=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],T3,M3;function E8(e){var i=w8();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function w8(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function S8(e,i){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||n)&&(i||(i=document),!!i)){var t=i.head||i.getElementsByTagName("head")[0];if(!t){t=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(t,a):i.documentElement.appendChild(t)}var s=i.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(i.createTextNode(e)),t.appendChild(s),s}}S8(`.amap-logo{
 display: none !important;
}
`);var P3=[108.92361,34.54083];window.forceWebGL=!0;var O3="ff533602d57df6f8ab3b0fea226ae52f",I3="2.0",xN=!1,bN=null,C8=(T3=(0,Xr.b2)(),T3(M3=function(e){(0,Ft.Z)(r,e);var i=E8(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"version",ah["GAODE2.x"]),(0,V.Z)((0,ct.Z)(n),"handleViewChanged",function(l){var f=n.map.customCoords.getCameraParams(),d=f.fov,S=f.near,O=f.far,Z=f.aspect,U=f.position,se=f.lookAt,le=f.up;n.emit("mapchange");var ye=n.map.customCoords.getCenter();n.cameraChangedCallback&&(n.viewport.syncWithMapCamera({aspect:Z,far:O,fov:d,cameraPosition:U,lookAt:se,up:le,near:S,zoom:n.map.getZoom()-1,center:ye,offsetOrigin:[U[0],U[1]]}),n.coordinateSystemService.setCoordinateSystem(Wf.P20_2),n.cameraChangedCallback(n.viewport))}),n}return(0,he.Z)(r,[{key:"setCustomCoordCenter",value:function(t){this.sceneCenter=t,this.sceneCenterMKT=Uo.apply(void 0,(0,oe.Z)(t))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoordByLayer",value:function(t,a){var s=a||this.sceneCenter,l=Uo.apply(void 0,(0,oe.Z)(s)),f=this._sub(Uo(t[0],t[1]),l);return t[2]&&f.push(t[2]),f}},{key:"lngLatToCoordsByLayer",value:function(t,a){var s=this;return t.map(function(l){return typeof l[0]=="number"?s.lngLatToCoordByLayer(l,a):l.map(function(f){return s.lngLatToCoordByLayer(f,a)})})}},{key:"setCoordCenter",value:function(t){this.map.customCoords.setCenter(t||P3),this.setCustomCoordCenter(t||P3)}},{key:"lngLatToCoord",value:function(t){return this.sceneCenter||(this.map.customCoords.setCenter(t),this.setCustomCoordCenter(t)),this._sub(Uo(t[0],t[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(t){var a=this;return t.map(function(s){return typeof s[0]=="number"?a.lngLatToCoord(s):s.map(function(l){return a.lngLatToCoord(l)})})}},{key:"addMarkerContainer",value:function(){if(this.map){var t=this.map.getContainer();if(t!==null){var a=t.getElementsByClassName("amap-maps")[0];a.style.zIndex="auto",this.markerContainer=ss("div","l7-marker-container2",a)}}}},{key:"updateView",value:function(t){}},{key:"getOverlayContainer",value:function(){}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var t=this.map.getBounds(),a=t.getNorthEast(),s=t.getSouthWest(),l=this.getCenter(),f=l.lng>a.getLng()||l.lng<s.getLng()?180-a.getLng():a.getLng(),d=l.lng<s.getLng()?s.getLng()-180:s.getLng();return[[d,s.getLat()],[f,a.getLat()]]}},{key:"getMinZoom",value:function(){var t=this.map.getZooms();return t[0]-1}},{key:"getMaxZoom",value:function(){var t=this.map.getZooms();return t[1]-1}},{key:"lngLatToContainer",value:function(t){var a=this.map.lngLatToContainer(t);return{x:a.getX(),y:a.getY()}}},{key:"getModelMatrix",value:function(t,a,s){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],f=this.map.customCoords.lngLatToCoord(t),d=rl();return Lc(d,d,Kl(f[0],f[1],a)),Ru(d,d,Kl(l[0],l[1],l[2])),wp(d,d,s[0]),zp(d,d,s[1]),vp(d,d,s[2]),d}},{key:"init",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U,se,le,ye,Be,rt,Je,Ot,jt,dr,Lr,jr,Jr,Pn,In;return Ze().wrap(function(ra){for(;;)switch(ra.prev=ra.next){case 0:if(s=this.config,l=s.id,f=s.style,d=f===void 0?"light":f,S=s.minZoom,O=S===void 0?0:S,Z=s.maxZoom,U=Z===void 0?18:Z,se=s.token,le=se===void 0?O3:se,ye=s.mapInstance,Be=s.plugin,rt=Be===void 0?[]:Be,Je=s.version,Ot=Je===void 0?I3:Je,jt=(0,Xo.Z)(s,b8),this.viewport=new x8,window.AMap||ye){ra.next=6;break}return rt.push("Map3D"),ra.next=6,t3().load({key:le,version:I3,plugins:rt});case 6:ye?(this.map=ye,this.$mapContainer=this.map.getContainer(),Lr=this.map.getCenter(),(dr=this.map.customCoords)===null||dr===void 0||dr.setCenter([Lr.lng,Lr.lat]),this.setCustomCoordCenter([Lr.lng,Lr.lat]),this.map.on("viewchange",this.handleViewChanged)):(this.$mapContainer=this.creatMapContainer(l),Jr=(0,ue.Z)({mapStyle:this.getMapStyleValue(d),zooms:[O,U],viewMode:"3D"},jt),Jr.zoom&&(Jr.zoom+=1),le===O3&&console.warn("%c".concat(this.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),Pn=new AMap.Map(this.$mapContainer,Jr),this.map=Pn,In=Pn.getCenter(),(jr=this.map.customCoords)===null||jr===void 0||jr.setCenter([In.lng,In.lat]),this.setCustomCoordCenter([In.lng,In.lat]),Pn.on("viewchange",this.handleViewChanged)),this.initViewPort();case 8:case"end":return ra.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"initViewPort",value:function(){var t,a=(t=this.map.customCoords)===null||t===void 0?void 0:t.getCameraParams(),s=a.fov,l=a.near,f=a.far,d=a.aspect,S=a.position,O=a.lookAt,Z=a.up;this.emit("mapchange");var U=this.map.customCoords.getCenter(),se=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:d,far:f,fov:s,cameraPosition:S,lookAt:O,near:l,up:Z,zoom:se-1,center:U,offsetOrigin:[S[0],S[1]]}),this.coordinateSystemService.setCoordinateSystem(Wf.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(t,a){var s=[0,0];return s[0]=t[0]-a[0],s[1]=t[1]-a[1],s}}]),r}(E3))||M3);function A8(e){var i=T8();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function T8(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var L3=function(e){(0,Ft.Z)(r,e);var i=A8(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getServiceConstructor",value:function(){return C8}}]),r}(Yg),M8=I(99874),P8=I.n(M8);function O8(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=I8(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function I8(e,i){if(e){if(typeof e=="string")return R3(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R3(e,i)}}function R3(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var Jw;function eS(e,i,r){var n=r-i,t=((e-i)%n+n)%n+i;return t===i?r:t}function h0(e,i,r){return Math.min(r,Math.max(i,e))}function fv(e,i,r){return e*(1-r)+i*r}function tS(e,i,r,n){var t=new(P8())(e,i,r,n);return function(a){return t.solve(a)}}var rS=tS(.25,.1,.25,1);function k3(){return zs||!ha.matchMedia?!1:(Jw==null&&(Jw=ha.matchMedia("(prefers-reduced-motion: reduce)")),Jw.matches)}function L8(e,i){var r={},n=O8(i),t;try{for(n.s();!(t=n.n()).done;){var a=t.value;a in e&&(r[a]=e[a])}}catch(s){n.e(s)}finally{n.f()}return r}var W0=zs?Date.now.bind(Date):ha.performance&&ha.performance.now?ha.performance.now.bind(ha.performance):Date.now.bind(Date),R8=ha.requestAnimationFrame||ha.mozRequestAnimationFrame||ha.webkitRequestAnimationFrame||ha.msRequestAnimationFrame,k8=ha.cancelAnimationFrame||ha.mozCancelAnimationFrame||ha.webkitCancelAnimationFrame||ha.msCancelAnimationFrame;function ab(e){var i=R8(e);return{cancel:function(){return k8(i)}}}var D3=63710088e-1,wf=function(){function e(i,r){if((0,re.Z)(this,e),isNaN(i)||isNaN(r))throw new Error("Invalid LngLat object: (".concat(i,", ").concat(r,")"));if(this.lng=+i,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return(0,he.Z)(e,[{key:"wrap",value:function(){return new e(eS(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(r){var n=Math.PI/180,t=this.lat*n,a=r.lat*n,s=Math.sin(t)*Math.sin(a)+Math.cos(t)*Math.cos(a)*Math.cos((r.lng-this.lng)*n),l=D3*Math.acos(Math.min(s,1));return l}}],[{key:"convert",value:function(r){if(r instanceof e)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new e(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&(0,on.Z)(r)==="object"&&r!==null){var n="lng"in r?r.lng:r.lon;return new e(Number(n),Number(r.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]),e}(),g1=function(){function e(i,r){(0,re.Z)(this,e),i&&(r?this.setSouthWest(i).setNorthEast(r):i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}return(0,he.Z)(e,[{key:"setNorthEast",value:function(r){return this.ne=r instanceof wf?new wf(r.lng,r.lat):wf.convert(r),this}},{key:"setSouthWest",value:function(r){return this.sw=r instanceof wf?new wf(r.lng,r.lat):wf.convert(r),this}},{key:"extend",value:function(r){var n=this.sw,t=this.ne,a,s;if(r instanceof wf)a=r,s=r;else if(r instanceof e){if(a=r.sw,s=r.ne,!a||!s)return this}else{if(Array.isArray(r))if(r.length===4||r.every(Array.isArray)){var l=r;return this.extend(e.convert(l))}else{var f=r;return this.extend(wf.convert(f))}return this}return!n&&!t?(this.sw=new wf(a.lng,a.lat),this.ne=new wf(s.lng,s.lat)):(n.lng=Math.min(a.lng,n.lng),n.lat=Math.min(a.lat,n.lat),t.lng=Math.max(s.lng,t.lng),t.lat=Math.max(s.lat,t.lat)),this}},{key:"getCenter",value:function(){return new wf((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new wf(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new wf(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(r){var n=wf.convert(r),t=n.lng,a=n.lat,s=this.sw.lat<=a&&a<=this.ne.lat,l=this.sw.lng<=t&&t<=this.ne.lng;return this.sw.lng>this.ne.lng&&(l=this.sw.lng>=t&&t>=this.ne.lng),s&&l}}],[{key:"convert",value:function(r){return r instanceof e?r:new e(r)}}]),e}(),Sl=function(){function e(i,r){(0,re.Z)(this,e),this.x=i,this.y=r}return(0,he.Z)(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"_add",value:function(r){return this.x+=r.x,this.y+=r.y,this}},{key:"add",value:function(r){return this.clone()._add(r)}},{key:"_sub",value:function(r){return this.x-=r.x,this.y-=r.y,this}},{key:"sub",value:function(r){return this.clone()._sub(r)}},{key:"_multByPoint",value:function(r){return this.x*=r.x,this.y*=r.y,this}},{key:"multByPoint",value:function(r){return this.clone()._multByPoint(r)}},{key:"_divByPoint",value:function(r){return this.x/=r.x,this.y/=r.y,this}},{key:"divByPoint",value:function(r){return this.clone()._divByPoint(r)}},{key:"_mult",value:function(r){return this.x*=r,this.y*=r,this}},{key:"mult",value:function(r){return this.clone()._mult(r)}},{key:"_div",value:function(r){return this.x/=r,this.y/=r,this}},{key:"div",value:function(r){return this.clone()._div(r)}},{key:"_rotate",value:function(r){var n=Math.cos(r),t=Math.sin(r),a=n*this.x-t*this.y,s=t*this.x+n*this.y;return this.x=a,this.y=s,this}},{key:"rotate",value:function(r){return this.clone()._rotate(r)}},{key:"_rotateAround",value:function(r,n){var t=Math.cos(r),a=Math.sin(r),s=n.x+t*(this.x-n.x)-a*(this.y-n.y),l=n.y+a*(this.x-n.x)+t*(this.y-n.y);return this.x=s,this.y=l,this}},{key:"roateAround",value:function(r,n){return this.clone()._rotateAround(r,n)}},{key:"_matMult",value:function(r){var n=r[0]*this.x+r[1]*this.y,t=r[2]*this.x+r[3]*this.y;return this.x=n,this.y=t,this}},{key:"matMult",value:function(r){return this.clone()._matMult(r)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var r=this.y;return this.y=this.x,this.x=-r,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(r){return this.x===r.x&&this.y===r.y}},{key:"dist",value:function(r){return Math.sqrt(this.distSqr(r))}},{key:"distSqr",value:function(r){var n=r.x-this.x,t=r.y-this.y;return n*n+t*t}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(r){return Math.atan2(this.y-r.y,this.x-r.x)}},{key:"angleWith",value:function(r){return this.angleWithSep(r.x,r.y)}},{key:"angleWithSep",value:function(r,n){return Math.atan2(this.x*n-this.y*r,this.x*r+this.y*n)}}],[{key:"convert",value:function(r){return r instanceof e?r:Array.isArray(r)?new e(r[0],r[1]):r}}]),e}();function D8(){var e=new ta(4);return ta!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function EN(e){var i=new glMatrix.ARRAY_TYPE(4);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}function wN(e,i){return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}function SN(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function CN(e,i,r,n){var t=new glMatrix.ARRAY_TYPE(4);return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}function AN(e,i,r,n,t){return e[0]=i,e[1]=r,e[2]=n,e[3]=t,e}function TN(e,i){if(e===i){var r=i[1];e[1]=i[2],e[2]=r}else e[0]=i[0],e[1]=i[2],e[2]=i[1],e[3]=i[3];return e}function MN(e,i){var r=i[0],n=i[1],t=i[2],a=i[3],s=r*a-t*n;return s?(s=1/s,e[0]=a*s,e[1]=-n*s,e[2]=-t*s,e[3]=r*s,e):null}function PN(e,i){var r=i[0];return e[0]=i[3],e[1]=-i[1],e[2]=-i[2],e[3]=r,e}function ON(e){return e[0]*e[3]-e[2]*e[1]}function IN(e,i,r){var n=i[0],t=i[1],a=i[2],s=i[3],l=r[0],f=r[1],d=r[2],S=r[3];return e[0]=n*l+a*f,e[1]=t*l+s*f,e[2]=n*d+a*S,e[3]=t*d+s*S,e}function F8(e,i,r){var n=i[0],t=i[1],a=i[2],s=i[3],l=Math.sin(r),f=Math.cos(r);return e[0]=n*f+a*l,e[1]=t*f+s*l,e[2]=n*-l+a*f,e[3]=t*-l+s*f,e}function LN(e,i,r){var n=i[0],t=i[1],a=i[2],s=i[3],l=r[0],f=r[1];return e[0]=n*l,e[1]=t*l,e[2]=a*f,e[3]=s*f,e}function RN(e,i){var r=Math.sin(i),n=Math.cos(i);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e}function kN(e,i){return e[0]=i[0],e[1]=0,e[2]=0,e[3]=i[1],e}function DN(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function FN(e){return Math.hypot(e[0],e[1],e[2],e[3])}function BN(e,i,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,i,r]}function NN(e,i,r){return e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e[3]=i[3]+r[3],e}function zN(e,i,r){return e[0]=i[0]-r[0],e[1]=i[1]-r[1],e[2]=i[2]-r[2],e[3]=i[3]-r[3],e}function ZN(e,i){return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]&&e[3]===i[3]}function UN(e,i){var r=e[0],n=e[1],t=e[2],a=e[3],s=i[0],l=i[1],f=i[2],d=i[3];return Math.abs(r-s)<=glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(t-f)<=glMatrix.EPSILON*Math.max(1,Math.abs(t),Math.abs(f))&&Math.abs(a-d)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))}function jN(e,i,r){return e[0]=i[0]*r,e[1]=i[1]*r,e[2]=i[2]*r,e[3]=i[3]*r,e}function VN(e,i,r,n){return e[0]=i[0]+r[0]*n,e[1]=i[1]+r[1]*n,e[2]=i[2]+r[2]*n,e[3]=i[3]+r[3]*n,e}var HN=null,GN=null,B8=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if((0,re.Z)(this,e),isNaN(i)||i<0||isNaN(r)||r<0||isNaN(n)||n<0||isNaN(t)||t<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=r,this.left=n,this.right=t}return(0,he.Z)(e,[{key:"interpolate",value:function(r,n,t){return n.top!=null&&r.top!=null&&(this.top=fv(r.top,n.top,t)),n.bottom!=null&&r.bottom!=null&&(this.bottom=fv(r.bottom,n.bottom,t)),n.left!=null&&r.left!=null&&(this.left=fv(r.left,n.left,t)),n.right!=null&&r.right!=null&&(this.right=fv(r.right,n.right,t)),this}},{key:"getCenter",value:function(r,n){var t=h0((this.left+r-this.right)/2,0,r),a=h0((this.top+n-this.bottom)/2,0,n);return new Sl(t,a)}},{key:"equals",value:function(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}},{key:"clone",value:function(){return new e(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),e}(),F3=2*Math.PI*D3;function B3(e){return F3*Math.cos(e*Math.PI/180)}function ob(e){return(180+e)/360}function sb(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function N3(e,i){return e/B3(i)}function N8(e){return e*360-180}function nS(e){var i=180-e*360;return 360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90}function z8(e,i){return e*B3(nS(i))}function Z8(e){return 1/Math.cos(e*Math.PI/180)}var qg=function(){function e(i,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;(0,re.Z)(this,e),this.x=+i,this.y=+r,this.z=+n}return(0,he.Z)(e,[{key:"toLngLat",value:function(){return new wf(N8(this.x),nS(this.y))}},{key:"toAltitude",value:function(){return z8(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/F3*Z8(nS(this.y))}}],[{key:"fromLngLat",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=wf.convert(r);return new e(ob(t.lng),sb(t.lat),N3(n,t.lat))}}]),e}();function U8(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=j8(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function j8(e,i){if(e){if(typeof e=="string")return z3(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z3(e,i)}}function z3(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var $N=8192,V8=function(){function e(i,r,n,t,a){(0,re.Z)(this,e),this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=a===void 0?!0:a,this._minZoom=i||0,this._maxZoom=r||22,this._minPitch=n==null?0:n,this._maxPitch=t==null?60:t,this.setMaxBounds(),this.width=0,this.height=0,this._center=new wf(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new B8,this.posMatrixCache={},this.alignedPosMatrixCache={}}return(0,he.Z)(e,[{key:"minZoom",get:function(){return this._minZoom},set:function(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}},{key:"minPitch",get:function(){return this._minPitch},set:function(r){this._minPitch!==r&&(this._minPitch=r,this._pitch=Math.max(this._pitch,r))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(r){this._maxPitch!==r&&(this._maxPitch=r,this._pitch=Math.min(this._pitch,r))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Sl(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(r){var n=-eS(r,-180,180)*Math.PI/180;this.angle!==n&&(this.unmodified=!1,this.angle=n,this.calcMatrices(),this.rotationMatrix=D8(),F8(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(r){var n=h0(r,this._minPitch,this._maxPitch)/180*Math.PI;this._pitch!==n&&(this.unmodified=!1,this._pitch=n,this.calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this.unmodified=!1,this._fov=r/180*Math.PI,this.calcMatrices())}},{key:"zoom",get:function(){return this._zoom},set:function(r){var n=Math.min(Math.max(r,this._minZoom),this._maxZoom);this._zoom!==n&&(this.unmodified=!1,this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom,this.constrain(),this.calcMatrices())}},{key:"center",get:function(){return this._center},set:function(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this.unmodified=!1,this._center=r,this.constrain(),this.calcMatrices())}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(r){this.edgeInsets.equals(r)||(this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,r,1),this.calcMatrices())}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}},{key:"clone",value:function(){var r=new e(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return r.tileSize=this.tileSize,r.latRange=this.latRange,r.width=this.width,r.height=this.height,r.center=this._center,r.zoom=this.zoom,r.angle=this.angle,r.fov=this._fov,r.pitch=this._pitch,r.unmodified=this.unmodified,r.edgeInsets=this.edgeInsets.clone(),r.calcMatrices(),r}},{key:"isPaddingEqual",value:function(r){return this.edgeInsets.equals(r)}},{key:"interpolatePadding",value:function(r,n,t){this.unmodified=!1,this.edgeInsets.interpolate(r,n,t),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(r){var n=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,n)}},{key:"resize",value:function(r,n){this.width=r,this.height=n,this.pixelsToGLUnits=[2/r,-2/n],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(r){return Math.pow(2,r)}},{key:"scaleZoom",value:function(r){return Math.log(r)/Math.LN2}},{key:"project",value:function(r){var n=h0(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Sl(ob(r.lng)*this.worldSize,sb(n)*this.worldSize)}},{key:"unproject",value:function(r){return new qg(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(r,n){var t=this.pointCoordinate(n),a=this.pointCoordinate(this.centerPoint),s=this.locationCoordinate(r),l=new qg(s.x-(t.x-a.x),s.y-(t.y-a.y));this.center=this.coordinateLocation(l),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(r){var n=0,t=new Float64Array([r.x,r.y,0,1]),a=new Float64Array([r.x,r.y,1,1]);Zv(t,t,this.pixelMatrixInverse),Zv(a,a,this.pixelMatrixInverse);var s=t[3],l=a[3],f=t[0]/s,d=a[0]/l,S=t[1]/s,O=a[1]/l,Z=t[2]/s,U=a[2]/l,se=Z===U?0:(n-Z)/(U-Z);return new qg(fv(f,d,se)/this.worldSize,fv(S,O,se)/this.worldSize)}},{key:"getBounds",value:function(){return new g1().extend(this.pointLocation(new Sl(0,0))).extend(this.pointLocation(new Sl(this.width,0))).extend(this.pointLocation(new Sl(this.width,this.height))).extend(this.pointLocation(new Sl(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new g1([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var r=this.pointCoordinate(new Sl(0,0)),n=new Float32Array([r.x*this.worldSize,r.y*this.worldSize,0,1]),t=Zv(n,n,this.pixelMatrix);return t[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var r=this._pitch,n=Math.tan(r)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Sl(0,n))}},{key:"getCameraQueryGeometry",value:function(r){var n=this.getCameraPoint();if(r.length===1)return[r[0],n];var t=n.x,a=n.y,s=n.x,l=n.y,f=U8(r),d;try{for(f.s();!(d=f.n()).done;){var S=d.value;t=Math.min(t,S.x),a=Math.min(a,S.y),s=Math.max(s,S.x),l=Math.max(l,S.y)}}catch(O){f.e(O)}finally{f.f()}return[new Sl(t,a),new Sl(s,a),new Sl(s,l),new Sl(t,l),new Sl(t,a)]}},{key:"coordinatePoint",value:function(r){var n=T0(r.x*this.worldSize,r.y*this.worldSize,0,1);return Zv(n,n,this.pixelMatrix),new Sl(n[0]/n[3],n[1]/n[3])}},{key:"locationPoint",value:function(r){return this.coordinatePoint(this.locationCoordinate(r))}},{key:"pointLocation",value:function(r){return this.coordinateLocation(this.pointCoordinate(r))}},{key:"locationCoordinate",value:function(r){return qg.fromLngLat(r)}},{key:"coordinateLocation",value:function(r){return r.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!(!this.center||!this.width||!this.height||this.constraining)){this.constraining=!0;var r=-90,n=90,t=-180,a=180,s,l,f,d,S=this.size,O=this.unmodified;if(this.latRange){var Z=this.latRange;r=sb(Z[1])*this.worldSize,n=sb(Z[0])*this.worldSize,s=n-r<S.y?S.y/(n-r):0}if(this.lngRange){var U=this.lngRange;t=ob(U[0])*this.worldSize,a=ob(U[1])*this.worldSize,l=a-t<S.x?S.x/(a-t):0}var se=this.point,le=Math.max(l||0,s||0);if(le){this.center=this.unproject(new Sl(l?(a+t)/2:se.x,s?(n+r)/2:se.y)),zs?this.zoom=Math.max(this.zoom,Math.max(-1,this.minZoom)):this.zoom+=this.scaleZoom(le),this.unmodified=O,this.constraining=!1;return}if(this.latRange){var ye=se.y,Be=S.y/2;ye-Be<r&&(d=r+Be),ye+Be>n&&(d=n-Be)}if(this.lngRange){var rt=se.x,Je=S.x/2;rt-Je<t&&(f=t+Je),rt+Je>a&&(f=a-Je)}(f!==void 0||d!==void 0)&&(this.center=this.unproject(new Sl(f!==void 0?f:se.x,d!==void 0?d:se.y))),this.unmodified=O,this.constraining=!1}}},{key:"calcMatrices",value:function(){if(this.height){var r=this._fov/2,n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(r)*this.height;var t=Math.PI/2+this._pitch,a=this._fov*(.5+n.y/this.height),s=Math.sin(a)*this.cameraToCenterDistance/Math.sin(h0(Math.PI-t-a,.01,Math.PI-.01)),l=this.point,f=l.x,d=l.y,S=Math.cos(Math.PI/2-this._pitch)*s+this.cameraToCenterDistance,O=S*1.01,Z=this.height/50,U=new Float64Array(16);_d(U,this._fov,this.width/this.height,Z,O),U[8]=-n.x*2/this.width,U[9]=n.y*2/this.height,Ru(U,U,[1,-1,1]),Lc(U,U,[0,0,-this.cameraToCenterDistance]),wp(U,U,this._pitch),vp(U,U,this.angle),Lc(U,U,[-f,-d,0]),this.mercatorMatrix=Ru([],U,[this.worldSize,this.worldSize,this.worldSize]),Ru(U,U,[1,1,N3(1,this.center.lat)*this.worldSize,1]),this.projMatrix=U,this.invProjMatrix=td([],this.projMatrix);var se=this.width%2/2,le=this.height%2/2,ye=Math.cos(this.angle),Be=Math.sin(this.angle),rt=f-Math.round(f)+ye*se+Be*le,Je=d-Math.round(d)+ye*le+Be*se,Ot=new Float64Array(U);if(Lc(Ot,Ot,[rt>.5?rt-1:rt,Je>.5?Je-1:Je,0]),this.alignedProjMatrix=Ot,U=rl(),Ru(U,U,[this.width/2,-this.height/2,1]),Lc(U,U,[1,-1,0]),this.labelPlaneMatrix=U,U=rl(),Ru(U,U,[1,-1,1]),Lc(U,U,[-1,-1,0]),Ru(U,U,[2/this.width,2/this.height,1]),this.glCoordMatrix=U,this.pixelMatrix=ef(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),U=td(new Float64Array(16),this.pixelMatrix),!U)throw new Error("failed to invert matrix");this.pixelMatrixInverse=U,this.posMatrixCache={},this.alignedPosMatrixCache={}}}}]),e}(),H8=I(82492),X0=I.n(H8),Ec=(0,he.Z)(function e(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,re.Z)(this,e),X0()(this,r),this.type=i});function G8(e){var i=$8();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function $8(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var Z3=function(e){(0,Ft.Z)(r,e);var i=G8(r);function r(n){var t;(0,re.Z)(this,r),t=i.call(this),(0,V.Z)((0,ct.Z)(t),"renderFrameCallback",function(){var S=Math.min((W0()-t.easeStart)/t.easeOptions.duration,1);t.onEaseFrame(t.easeOptions.easing(S)),S<1?t.easeFrameId=t.requestRenderFrame(t.renderFrameCallback):t.stop()}),t.options=n;var a=n.minZoom,s=n.maxZoom,l=n.minPitch,f=n.maxPitch,d=n.renderWorldCopies;return t.moving=!1,t.zooming=!1,t.bearingSnap=n.bearingSnap,t.pitchEnabled=n.pitchEnabled,t.rotateEnabled=n.rotateEnabled,t.transform=new V8(a,s,l,f,d),t}return(0,he.Z)(r,[{key:"requestRenderFrame",value:function(t){return 0}},{key:"cancelRenderFrame",value:function(t){}},{key:"getCenter",value:function(){var t=this.transform.center,a=t.lng,s=t.lat;return new wf(a,s)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(t,a){return this.jumpTo({center:t},a)}},{key:"setPitch",value:function(t,a){return this.jumpTo({pitch:t},a),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(t,a,s){return this.easeTo((0,Kn.merge)({center:t},a),s)}},{key:"zoomOut",value:function(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}},{key:"setBearing",value:function(t,a){return this.jumpTo({bearing:t},a),this}},{key:"setZoom",value:function(t,a){return this.jumpTo({zoom:t},a),this}},{key:"zoomIn",value:function(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}},{key:"zoomTo",value:function(t,a,s){return this.easeTo((0,Kn.merge)({zoom:t},a),s)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(t,a){return this.jumpTo({padding:t},a),this}},{key:"rotateTo",value:function(t,a,s){return this.easeTo((0,Kn.merge)({bearing:t},a),s)}},{key:"resetNorth",value:function(t,a){return this.rotateTo(0,(0,Kn.merge)({duration:1e3},t),a),this}},{key:"resetNorthPitch",value:function(t,a){return this.easeTo((0,Kn.merge)({bearing:0,pitch:0,duration:1e3},t),a),this}},{key:"fitBounds",value:function(t,a,s){return this.fitInternal(this.cameraForBounds(t,a),a,s)}},{key:"cameraForBounds",value:function(t,a){return t=g1.convert(t),this.cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),0,a)}},{key:"snapToNorth",value:function(t,a){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(t,a):this}},{key:"jumpTo",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;this.stop();var s=this.transform,l=!1,f=!1,d=!1;return t.zoom&&s.zoom!==+t.zoom&&(l=!0,s.zoom=+t.zoom),t.center!==void 0&&(s.center=wf.convert(t.center)),t.bearing&&s.bearing!==+t.bearing&&(f=!0,s.bearing=+t.bearing),t.pitch&&s.pitch!==+t.pitch&&(d=!0,s.pitch=+t.pitch),t.padding!=null&&!s.isPaddingEqual(t.padding)&&(s.padding=t.padding),this.emit("movestart",new Ec("movestart",a)),this.emit("move",new Ec("move",a)),l&&(this.emit("zoomstart",new Ec("zoomstart",a)),this.emit("zoom",new Ec("zoom",a)),this.emit("zoomend",new Ec("zoomend",a))),f&&(this.emit("rotatestart",new Ec("rotatestart",a)),this.emit("rotate",new Ec("rotate",a)),this.emit("rotateend",new Ec("rotateend",a))),d&&(this.emit("pitchstart",new Ec("pitchstart",a)),this.emit("pitch",new Ec("pitch",a)),this.emit("pitchend",new Ec("pitchend",a))),this.emit("moveend",new Ec("moveend",a))}},{key:"easeTo",value:function(){var t=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;a=(0,Kn.merge)({offset:[0,0],duration:500,easing:rS},a),(a.animate===!1||!a.essential&&k3())&&(a.duration=0);var l=this.transform,f=this.getZoom(),d=this.getBearing(),S=this.getPitch(),O=this.getPadding(),Z=a.zoom?+a.zoom:f,U=a.bearing?this.normalizeBearing(a.bearing,d):d,se=a.pitch?+a.pitch:S,le=a.padding?a.padding:l.padding,ye=Sl.convert(a.offset),Be=l.centerPoint.add(ye),rt=l.pointLocation(Be),Je=wf.convert(a.center||rt);this.normalizeCenter(Je);var Ot=l.project(rt),jt=l.project(Je).sub(Ot),dr=l.zoomScale(Z-f),Lr,jr;a.around&&(Lr=wf.convert(a.around),jr=l.locationPoint(Lr));var Jr={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||Z!==f,this.rotating=this.rotating||d!==U,this.pitching=this.pitching||se!==S,this.padding=!l.isPaddingEqual(le),this.easeId=a.easeId,this.prepareEase(s,a.noMoveStart,Jr),clearTimeout(this.easeEndTimeoutID),this.ease(function(Pn){if(t.zooming&&(l.zoom=fv(f,Z,Pn)),t.rotating&&t.rotateEnabled&&(l.bearing=fv(d,U,Pn)),t.pitching&&t.pitchEnabled&&(l.pitch=fv(S,se,Pn)),t.padding&&(l.interpolatePadding(O,le,Pn),Be=l.centerPoint.add(ye)),Lr)l.setLocationAtPoint(Lr,jr);else{var In=l.zoomScale(l.zoom-f),Si=Z>f?Math.min(2,dr):Math.max(.5,dr),ra=Math.pow(Si,1-Pn),Va=l.unproject(Ot.add(jt.mult(Pn*ra)).mult(In));l.setLocationAtPoint(l.renderWorldCopies?Va.wrap():Va,Be)}t.fireMoveEvents(s)},function(Pn){t.afterEase(s,Pn)},a),this}},{key:"flyTo",value:function(){var t=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;if(!a.essential&&k3()){var l=L8(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(l,s)}this.stop(),a=(0,Kn.merge)({offset:[0,0],speed:1.2,curve:1.42,easing:rS},a);var f=this.transform,d=this.getZoom(),S=this.getBearing(),O=this.getPitch(),Z=this.getPadding(),U=a.zoom?h0(+a.zoom,f.minZoom,f.maxZoom):d,se=a.bearing?this.normalizeBearing(a.bearing,S):S,le=a.pitch?+a.pitch:O,ye="padding"in a?a.padding:f.padding,Be=f.zoomScale(U-d),rt=Sl.convert(a.offset),Je=f.centerPoint.add(rt),Ot=f.pointLocation(Je),jt=wf.convert(a.center||Ot);this.normalizeCenter(jt);var dr=f.project(Ot),Lr=f.project(jt).sub(dr),jr=a.curve,Jr=Math.max(f.width,f.height),Pn=Jr/Be,In=Lr.mag();if("minZoom"in a){var Si=h0(Math.min(a.minZoom,d,U),f.minZoom,f.maxZoom),ra=Jr/f.zoomScale(Si-d);jr=Math.sqrt(ra/In*2)}var Va=jr*jr;function Ms(hf){var $h=(Pn*Pn-Jr*Jr+(hf?-1:1)*Va*Va*In*In)/(2*(hf?Pn:Jr)*Va*In);return Math.log(Math.sqrt($h*$h+1)-$h)}function vu(hf){return(Math.exp(hf)-Math.exp(-hf))/2}function Bu(hf){return(Math.exp(hf)+Math.exp(-hf))/2}function zl(hf){return vu(hf)/Bu(hf)}var _l=Ms(0),_h=function($h){return Bu(_l)/Bu(_l+jr*$h)},Pv=function($h){return Jr*((Bu(_l)*zl(_l+jr*$h)-vu(_l))/Va)/In},wd=(Ms(1)-_l)/jr;if(Math.abs(In)<1e-6||!isFinite(wd)){if(Math.abs(Jr-Pn)<1e-6)return this.easeTo(a,s);var K0=Pn<Jr?-1:1;wd=Math.abs(Math.log(Pn/Jr))/jr,Pv=function(){return 0},_h=function($h){return Math.exp(K0*jr*$h)}}if("duration"in a)a.duration=+a.duration;else{var Xd="screenSpeed"in a?+a.screenSpeed/jr:+a.speed;a.duration=1e3*wd/Xd}return a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0),this.zooming=!0,this.rotating=S!==se,this.pitching=le!==O,this.padding=!f.isPaddingEqual(ye),this.prepareEase(s,!1),this.ease(function(hf){var $h=hf*wd,ng=1/_h($h);f.zoom=hf===1?U:d+f.scaleZoom(ng),t.rotating&&(f.bearing=fv(S,se,hf)),t.pitching&&(f.pitch=fv(O,le,hf)),t.padding&&(f.interpolatePadding(Z,ye,hf),Je=f.centerPoint.add(rt));var ig=hf===1?jt:f.unproject(dr.add(Lr.mult(Pv($h))).mult(ng));f.setLocationAtPoint(f.renderWorldCopies?ig.wrap():ig,Je),t.fireMoveEvents(s)},function(){return t.afterEase(s)},a),this}},{key:"fitScreenCoordinates",value:function(t,a,s,l,f){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Sl.convert(t)),this.transform.pointLocation(Sl.convert(a)),s,l),l,f)}},{key:"stop",value:function(t,a){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var s=this.onEaseEnd;delete this.onEaseEnd,s.call(this,a)}return this}},{key:"normalizeBearing",value:function(t,a){t=eS(t,-180,180);var s=Math.abs(t-a);return Math.abs(t-360-a)<s&&(t-=360),Math.abs(t+360-a)<s&&(t+=360),t}},{key:"normalizeCenter",value:function(t){var a=this.transform;if(!(!a.renderWorldCopies||a.lngRange)){var s=t.lng-a.center.lng;t.lng+=s>180?-360:s<-180?360:0}}},{key:"fireMoveEvents",value:function(t){this.emit("move",new Ec("move",t)),this.zooming&&this.emit("zoom",new Ec("zoom",t)),this.rotating&&this.emit("rotate",new Ec("rotate",t)),this.pitching&&this.emit("rotate",new Ec("pitch",t))}},{key:"prepareEase",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!a&&!s.moving&&this.emit("movestart",new Ec("movestart",t)),this.zooming&&!s.zooming&&this.emit("zoomstart",new Ec("zoomstart",t)),this.rotating&&!s.rotating&&this.emit("rotatestart",new Ec("rotatestart",t)),this.pitching&&!s.pitching&&this.emit("pitchstart",new Ec("pitchstart",t))}},{key:"afterEase",value:function(t,a){if(!(this.easeId&&a&&this.easeId===a)){delete this.easeId;var s=this.zooming,l=this.rotating,f=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,s&&this.emit("zoomend",new Ec("zoomend",t)),l&&this.emit("rotateend",new Ec("rotateend",t)),f&&this.emit("pitchend",new Ec("pitchend",t)),this.emit("moveend",new Ec("moveend",t))}}},{key:"ease",value:function(t,a,s){s.animate===!1||s.duration===0?(t(1),a()):(this.easeStart=W0(),this.easeOptions=s,this.onEaseFrame=t,this.onEaseEnd=a,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(t,a,s,l){var f={top:0,bottom:0,right:0,left:0};if(l=(0,Kn.merge)({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},l),typeof l.padding=="number"){var d=l.padding;l.padding={top:d,bottom:d,right:d,left:d}}l.padding=(0,Kn.merge)(f,l.padding);var S=this.transform,O=S.padding,Z=S.project(wf.convert(t)),U=S.project(wf.convert(a)),se=Z.rotate(-s*Math.PI/180),le=U.rotate(-s*Math.PI/180),ye=new Sl(Math.max(se.x,le.x),Math.max(se.y,le.y)),Be=new Sl(Math.min(se.x,le.x),Math.min(se.y,le.y)),rt=ye.sub(Be),Je=(S.width-(O.left+O.right+l.padding.left+l.padding.right))/rt.x,Ot=(S.height-(O.top+O.bottom+l.padding.top+l.padding.bottom))/rt.y;if(!(Ot<0||Je<0)){var jt=Math.min(S.scaleZoom(S.scale*Math.min(Je,Ot)),l.maxZoom),dr=Sl.convert(l.offset),Lr=(l.padding.left-l.padding.right)/2,jr=(l.padding.top-l.padding.bottom)/2,Jr=new Sl(dr.x+Lr,dr.y+jr),Pn=Jr.mult(S.scale/S.zoomScale(jt)),In=S.unproject(Z.add(U).div(2).sub(Pn));return{center:In,zoom:jt,bearing:s}}}},{key:"fitInternal",value:function(t,a,s){return t?(a=(0,Kn.merge)(t,a),delete a.padding,a.linear?this.easeTo(a,s):this.flyTo(a,s)):this}}]),r}(Kc.EventEmitter);function iS(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=W8(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function W8(e,i){if(e){if(typeof e=="string")return U3(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U3(e,i)}}function U3(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var Wd={},Hp=Wd;Wd.create=function(e,i,r){var n=ha.document.createElement(e);return i!==void 0&&(n.className=i),r&&r.appendChild(n),n},Wd.createNS=function(e,i){var r=ha.document.createElementNS(e,i);return r};var eg=ha.document&&ha.document.documentElement.style;function j3(e){if(!eg)return e[0];var i=iS(e),r;try{for(i.s();!(r=i.n()).done;){var n=r.value;if(n in eg)return n}}catch(t){i.e(t)}finally{i.f()}return e[0]}var y1=j3(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),V3;Wd.disableDrag=function(){eg&&y1&&(V3=eg[y1],eg[y1]="none")},Wd.enableDrag=function(){eg&&y1&&(eg[y1]=V3)};var X8=j3(["transform","WebkitTransform"]);Wd.setTransform=function(e,i){e.style[X8]=i};var ub=!1;try{var lb=Object.defineProperty({},"passive",{get:function(){ub=!0}});ha.addEventListener("test",lb,lb),ha.removeEventListener("test",lb,lb)}catch(e){ub=!1}Wd.addEventListener=function(e,i,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in n&&ub?e.addEventListener(i,r,n):e.addEventListener(i,r,n.capture)},Wd.removeEventListener=function(e,i,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in n&&ub?e.removeEventListener(i,r,n):e.removeEventListener(i,r,n.capture)};var H3=function e(i){i.preventDefault(),i.stopPropagation(),ha.removeEventListener("click",e,!0)};Wd.suppressClick=function(){zs||(ha.addEventListener("click",H3,!0),setTimeout(function(){ha.removeEventListener("click",H3,!0)},0))},Wd.mousePos=function(e,i){if(zs)return new Sl(i.clientX-e.left-0,i.clientY-e.top-0);var r=e.getBoundingClientRect();return new Sl(i.clientX-r.left-e.clientLeft,i.clientY-r.top-e.clientTop)},Wd.touchPos=function(e,i){if(zs){var l=[],f=iS(i),d;try{for(f.s();!(d=f.n()).done;){var S=d.value;l.push(new Sl(S.clientX-e.left,S.clientY-e.top))}}catch(O){f.e(O)}finally{f.f()}return l}else{var r=e.getBoundingClientRect(),n=[],t=iS(i),a;try{for(t.s();!(a=t.n()).done;){var s=a.value;n.push(new Sl(s.clientX-r.left-e.clientLeft,s.clientY-r.top-e.clientTop))}}catch(O){t.e(O)}finally{t.f()}return n}},Wd.mouseButton=function(e){return zs&&typeof ha.InstallTrigger!="undefined"&&e.button===2&&e.ctrlKey&&ha.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},Wd.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};function Y8(e){var i=K8();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function K8(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var p0=function(e){(0,Ft.Z)(r,e);var i=Y8(r);function r(n,t,a){var s,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};(0,re.Z)(this,r);var f=Hp.mousePos(t.getCanvasContainer(),a),d=t.unproject(f);return s=i.call(this,n,X0()({point:f,lngLat:d,originalEvent:a},l)),s.defaultPrevented=!1,s.target=t,s}return(0,he.Z)(r,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),r}(Ec);function q8(e){var i=Q8();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function Q8(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var cb=function(e){(0,Ft.Z)(r,e);var i=q8(r);function r(n,t,a){var s;(0,re.Z)(this,r);var l=n==="touchend"?a.changedTouches:a.touches,f=Hp.touchPos(t.getCanvasContainer(),l),d=f.map(function(Z){return t.unproject(Z)}),S=f.reduce(function(Z,U,se,le){return Z.add(U.div(le.length))},new Sl(0,0)),O=t.unproject(S);return s=i.call(this,n,{points:f,point:S,lngLats:d,lngLat:O,originalEvent:a}),s.defaultPrevented=!1,s}return(0,he.Z)(r,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),r}(Ec);function J8(e){var i=eD();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function eD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tD=function(e){(0,Ft.Z)(r,e);var i=J8(r);function r(n,t,a){var s;return(0,re.Z)(this,r),s=i.call(this,n,{originalEvent:a}),s.defaultPrevented=!1,s}return(0,he.Z)(r,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),r}(Ec),rD=function(){function e(i){(0,re.Z)(this,e),this.map=i}return(0,he.Z)(e,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(r){this.map.emit(r.type,new p0(r.type,this.map,r))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new p0("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(r){this.delayContextMenu?this.contextMenuEvent=r:this.map.emit(r.type,new p0(r.type,this.map,r)),this.map.listeners("contextmenu")&&r.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),e}(),nD=function(){function e(i,r){(0,re.Z)(this,e),this.map=i,this.el=i.getCanvasContainer(),this.container=i.getContainer(),this.clickTolerance=r.clickTolerance||1}return(0,he.Z)(e,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){this.isEnabled()||(this.enabled=!0)}},{key:"disable",value:function(){this.isEnabled()&&(this.enabled=!1)}},{key:"mousedown",value:function(r,n){this.isEnabled()&&r.shiftKey&&r.button===0&&(Hp.disableDrag(),this.startPos=this.lastPos=n,this.active=!0)}},{key:"mousemoveWindow",value:function(r,n){if(this.active){var t=n;if(!(this.lastPos.equals(t)||!this.box&&t.dist(this.startPos)<this.clickTolerance)){var a=this.startPos;this.lastPos=t,this.box||(this.box=Hp.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",r));var s=Math.min(a.x,t.x),l=Math.max(a.x,t.x),f=Math.min(a.y,t.y),d=Math.max(a.y,t.y);Hp.setTransform(this.box,"translate(".concat(s,"px,").concat(f,"px)")),this.box&&(this.box.style.width="".concat(l-s,"px"),this.box.style.height="".concat(d-f,"px"))}}}},{key:"mouseupWindow",value:function(r,n){var t=this;if(this.active&&r.button===0){var a=this.startPos,s=n;if(this.reset(),Hp.suppressClick(),a.x===s.x&&a.y===s.y)this.fireEvent("boxzoomcancel",r);else return this.map.emit("boxzoomend",new Ec("boxzoomend",{originalEvent:r})),{cameraAnimation:function(f){return f.fitScreenCoordinates(a,s,t.map.getBearing(),{linear:!0})}}}}},{key:"keydown",value:function(r){this.active&&r.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",r))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(Hp.remove(this.box),this.box=null),Hp.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(r,n){return this.map.emit(r,new Ec(r,{originalEvent:n}))}}]),e}(),iD=nD,aD=function(){function e(){(0,re.Z)(this,e),this.reset()}return(0,he.Z)(e,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(r,n){return r.preventDefault(),{cameraAnimation:function(a){a.easeTo({duration:300,zoom:a.getZoom()+(r.shiftKey?-1:1),around:a.unproject(n)},{originalEvent:r})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function oD(e){var i=sD();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function sD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var uD=function(e){(0,Ft.Z)(r,e);var i=oD(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"type","renderFrame"),n}return(0,he.Z)(r)}(Ec);function lD(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=cD(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function cD(e,i){if(e){if(typeof e=="string")return G3(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G3(e,i)}}function G3(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var fb={linearity:.3,easing:tS(0,0,.3,1)},fD=X0()({deceleration:2500,maxSpeed:1400},fb),hD=X0()({deceleration:20,maxSpeed:1400},fb),pD=X0()({deceleration:1e3,maxSpeed:360},fb),dD=X0()({deceleration:1e3,maxSpeed:90},fb),vD=function(){function e(i){(0,re.Z)(this,e),this.map=i,this.clear()}return(0,he.Z)(e,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(r){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:W0(),settings:r})}},{key:"drainInertiaBuffer",value:function(){for(var r=this.inertiaBuffer,n=W0(),t=160;r.length>0&&n-r[0].time>t;)r.shift()}},{key:"onMoveEnd",value:function(r){if(this.drainInertiaBuffer(),!(this.inertiaBuffer.length<2)){var n={zoom:0,bearing:0,pitch:0,pan:new Sl(0,0),pinchAround:void 0,around:void 0},t=lD(this.inertiaBuffer),a;try{for(t.s();!(a=t.n()).done;){var s=a.value.settings;n.zoom+=s.zoomDelta||0,n.bearing+=s.bearingDelta||0,n.pitch+=s.pitchDelta||0,s.panDelta&&n.pan._add(s.panDelta),s.around&&(n.around=s.around),s.pinchAround&&(n.pinchAround=s.pinchAround)}}catch(le){t.e(le)}finally{t.f()}var l=this.inertiaBuffer[this.inertiaBuffer.length-1],f=l.time-this.inertiaBuffer[0].time,d={};if(n.pan.mag()){var S=pb(n.pan.mag(),f,X0()({},fD,r||{}));d.offset=n.pan.mult(S.amount/n.pan.mag()),d.center=this.map.transform.center,hb(d,S)}if(n.zoom){var O=pb(n.zoom,f,hD);d.zoom=this.map.transform.zoom+O.amount,hb(d,O)}if(n.bearing){var Z=pb(n.bearing,f,pD);d.bearing=this.map.transform.bearing+h0(Z.amount,-179,179),hb(d,Z)}if(n.pitch){var U=pb(n.pitch,f,dD);d.pitch=this.map.transform.pitch+U.amount,hb(d,U)}if(d.zoom||d.bearing){var se=n.pinchAround===void 0?n.around:n.pinchAround;d.around=se?this.map.unproject(se):this.map.getCenter()}return this.clear(),X0()(d,{noMoveStart:!0})}}}]),e}();function hb(e,i){(!e.duration||e.duration<i.duration)&&(e.duration=i.duration,e.easing=i.easing)}function pb(e,i,r){var n=r.maxSpeed,t=r.linearity,a=r.deceleration,s=h0(e*t/(i/1e3),-n,n),l=Math.abs(s)/(a*t);return{easing:r.easing,duration:l*1e3,amount:s*(l/2)}}var mD={panStep:100,bearingStep:15,pitchStep:10},gD=function(){function e(){(0,re.Z)(this,e);var i=mD;this.panStep=i.panStep,this.bearingStep=i.bearingStep,this.pitchStep=i.pitchStep}return(0,he.Z)(e,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(r){var n=this;if(!(r.altKey||r.ctrlKey||r.metaKey)){var t=0,a=0,s=0,l=0,f=0;switch(r.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:r.shiftKey?a=-1:(r.preventDefault(),l=-1);break;case 39:r.shiftKey?a=1:(r.preventDefault(),l=1);break;case 38:r.shiftKey?s=1:(r.preventDefault(),f=-1);break;case 40:r.shiftKey?s=-1:(r.preventDefault(),f=1);break;default:return}return{cameraAnimation:function(S){var O=S.getZoom();S.easeTo({duration:300,easeId:"keyboardHandler",easing:yD,zoom:t?Math.round(O)+t*(r.shiftKey?2:1):O,bearing:S.getBearing()+a*n.bearingStep,pitch:S.getPitch()+s*n.pitchStep,offset:[-l*n.panStep,-f*n.panStep],center:S.getCenter()},{originalEvent:r})}}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function yD(e){return e*(2-e)}var _D=gD,xD=function(){function e(i,r){(0,re.Z)(this,e),this.map=i,this.clickTolerance=r.clickTolerance}return(0,he.Z)(e,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(r){return this.firePreventable(new tD(r.type,this.map,r))}},{key:"mousedown",value:function(r,n){return this.mousedownPos=n,this.firePreventable(new p0(r.type,this.map,r))}},{key:"mouseup",value:function(r){this.map.emit(r.type,new p0(r.type,this.map,r))}},{key:"click",value:function(r,n){this.mousedownPos&&this.mousedownPos.dist(n)>=this.clickTolerance||this.map.emit(r.type,new p0(r.type,this.map,r))}},{key:"dblclick",value:function(r){return this.firePreventable(new p0(r.type,this.map,r))}},{key:"mouseover",value:function(r){this.map.emit(r.type,new p0(r.type,this.map,r))}},{key:"mouseout",value:function(r){this.map.emit(r.type,new p0(r.type,this.map,r))}},{key:"touchstart",value:function(r){return this.firePreventable(new cb(r.type,this.map,r))}},{key:"touchmove",value:function(r){this.map.emit(r.type,new cb(r.type,this.map,r))}},{key:"touchend",value:function(r){this.map.emit(r.type,new cb(r.type,this.map,r))}},{key:"touchcancel",value:function(r){this.map.emit(r.type,new cb(r.type,this.map,r))}},{key:"firePreventable",value:function(r){if(this.map.emit(r.type,r),r.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),e}(),db,vb=0,aS=2,bD=(db={},(0,V.Z)(db,vb,1),(0,V.Z)(db,aS,2),db);function ED(e,i){var r=bD[i];return e.buttons===void 0||(e.buttons&r)!==r}var oS=function(){function e(i){(0,re.Z)(this,e),this.reset(),this.clickTolerance=i.clickTolerance||1}return(0,he.Z)(e,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(r,n){if(!this.lastPoint){var t=Hp.mouseButton(r);this.correctButton(r,t)&&(this.lastPoint=n,this.eventButton=t)}}},{key:"mousemoveWindow",value:function(r,n){var t=this.lastPoint;if(t){if(r.preventDefault(),ED(r,this.eventButton)){this.reset();return}if(!(!this.moved&&n.dist(t)<this.clickTolerance))return this.moved=!0,this.lastPoint=n,this.move(t,n)}}},{key:"mouseupWindow",value:function(r){if(this.lastPoint){var n=Hp.mouseButton(r);n===this.eventButton&&(this.moved&&Hp.suppressClick(),this.reset())}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(r,n){return!1}},{key:"move",value:function(r,n){}}]),e}();function wD(e){var i=SD();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function SD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var CD=function(e){(0,Ft.Z)(r,e);var i=wD(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"mousedown",value:function(t,a){$u((0,ot.Z)(r.prototype),"mousedown",this).call(this,t,a),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(t,a){return{around:a,panDelta:a.sub(t)}}},{key:"correctButton",value:function(t,a){return a===vb&&!t.ctrlKey}}]),r}(oS);function AD(e){var i=TD();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function TD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var MD=function(e){(0,Ft.Z)(r,e);var i=AD(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"correctButton",value:function(t,a){return a===vb&&t.ctrlKey||a===aS}},{key:"move",value:function(t,a){var s=-.5,l=(a.y-t.y)*s;if(l)return this.active=!0,{pitchDelta:l}}},{key:"contextmenu",value:function(t){t.preventDefault()}}]),r}(oS);function PD(e){var i=OD();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function OD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var ID=function(e){(0,Ft.Z)(r,e);var i=PD(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"contextmenu",value:function(t){t.preventDefault()}},{key:"correctButton",value:function(t,a){return a===vb&&t.ctrlKey||a===aS}},{key:"move",value:function(t,a){var s=.8,l=(a.x-t.x)*s;if(l)return this.active=!0,{bearingDelta:l}}}]),r}(oS),$3=4.000244140625,LD=1/100,RD=1/450,kD=2,DD=function(){function e(i,r){var n=this;(0,re.Z)(this,e),(0,V.Z)(this,"onScrollFrame",function(){if(n.frameId&&(n.frameId=null,!!n.isActive())){var t=n.map.transform;if(n.delta!==0){var a=n.type==="wheel"&&Math.abs(n.delta)>$3?n.wheelZoomRate:n.defaultZoomRate,s=kD/(1+Math.exp(-Math.abs(n.delta*a)));n.delta<0&&s!==0&&(s=1/s);var l=typeof n.targetZoom=="number"?t.zoomScale(n.targetZoom):t.scale;n.targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(l*s))),n.type==="wheel"&&(n.startZoom=t.zoom,n.easing=n.smoothOutEasing(200)),n.delta=0}var f=typeof n.targetZoom=="number"?n.targetZoom:t.zoom,d=n.startZoom,S=n.easing,O=!1,Z;if(n.type==="wheel"&&d&&S){var U=Math.min((W0()-n.lastWheelEventTime)/200,1),se=S(U);Z=fv(d,f,se),U<1?n.frameId||(n.frameId=!0):O=!0}else Z=f,O=!0;return n.active=!0,O&&(n.active=!1,n.finishTimeout=setTimeout(function(){n.zooming=!1,n.handler.triggerRenderFrame(),delete n.targetZoom,delete n.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:Z-t.zoom,around:n.aroundPoint,originalEvent:n.lastWheelEvent}}}),this.map=i,this.el=i.getCanvasContainer(),this.handler=r,this.delta=0,this.defaultZoomRate=LD,this.wheelZoomRate=RD}return(0,he.Z)(e,[{key:"setZoomRate",value:function(r){this.defaultZoomRate=r}},{key:"setWheelZoomRate",value:function(r){this.wheelZoomRate=r}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(r){this.isEnabled()||(this.enabled=!0,this.aroundCenter=r&&r.around==="center")}},{key:"disable",value:function(){this.isEnabled()&&(this.enabled=!1)}},{key:"wheel",value:function(r){if(this.isEnabled()){var n=r.deltaMode===window.WheelEvent.DOM_DELTA_LINE?r.deltaY*40:r.deltaY,t=W0(),a=t-(this.lastWheelEventTime||0);this.lastWheelEventTime=t,n!==0&&n%$3===0?this.type="wheel":n!==0&&Math.abs(n)<4?this.type="trackpad":a>400?(this.type=null,this.lastValue=n,this.timeout=setTimeout(this.onTimeout,40,r)):this.type||(this.type=Math.abs(a*n)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,n+=this.lastValue)),r.shiftKey&&n&&(n=n/4),this.type&&(this.lastWheelEvent=r,this.delta-=n,this.active||this.start(r)),r.preventDefault()}}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(r){this.type="wheel",this.delta-=this.lastValue,!this.active&&this.start&&this.start(r)}},{key:"start",value:function(r){if(this.delta){this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var n=Hp.mousePos(this.el,r);this.around=wf.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(n)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}}},{key:"smoothOutEasing",value:function(r){var n=rS;if(this.prevEase){var t=this.prevEase,a=(W0()-t.start)/t.duration,s=t.easing(a+.01)-t.easing(a),l=.27/Math.sqrt(s*s+1e-4)*.01,f=Math.sqrt(.27*.27-l*l);n=tS(l,f,.25,1)}return this.prevEase={start:W0(),duration:r,easing:n},n}}]),e}(),FD=DD,BD=function(){function e(i,r){(0,re.Z)(this,e),this.clickZoom=i,this.tapZoom=r}return(0,he.Z)(e,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),e}(),ND=function(){function e(i,r,n){(0,re.Z)(this,e),this.el=i,this.mousePan=r,this.touchPan=n}return(0,he.Z)(e,[{key:"enable",value:function(r){this.inertiaOptions=r||{},this.mousePan.enable(),this.touchPan.enable(),zs||this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),zs||this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),e}(),zD=function(){function e(i,r,n){(0,re.Z)(this,e),this.pitchWithRotate=i.pitchWithRotate,this.mouseRotate=r,this.mousePitch=n}return(0,he.Z)(e,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),e}(),ZD=function(){function e(i,r,n,t){(0,re.Z)(this,e),this.el=i,this.touchZoom=r,this.touchRotate=n,this.tapDragZoom=t,this.rotationDisabled=!1,this.enabled=!0}return(0,he.Z)(e,[{key:"enable",value:function(r){this.touchZoom.enable(r),this.rotationDisabled||this.touchRotate.enable(r),this.tapDragZoom.enable(),zs||this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),zs||this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),e}();function sS(e,i){for(var r={},n=0;n<e.length;n++)r[e[n].identifier]=i[n];return r}function UD(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=jD(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function jD(e,i){if(e){if(typeof e=="string")return W3(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W3(e,i)}}function W3(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}function VD(e){var i=new Sl(0,0),r=UD(e),n;try{for(r.s();!(n=r.n()).done;){var t=n.value;i._add(t)}}catch(a){r.e(a)}finally{r.f()}return i.div(e.length)}var X3=500,HD=500,Y3=30,GD=function(){function e(i){(0,re.Z)(this,e),this.reset(),this.numTouches=i.numTouches}return(0,he.Z)(e,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(r,n,t){(this.centroid||t.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=r.timeStamp),t.length===this.numTouches&&(this.centroid=VD(n),this.touches=sS(t,n)))}},{key:"touchmove",value:function(r,n,t){if(!(this.aborted||!this.centroid)){var a=sS(t,n);for(var s in this.touches)if(this.touches[s]){var l=this.touches[s],f=a[s];(!f||f.dist(l)>Y3)&&(this.aborted=!0)}}}},{key:"touchend",value:function(r,n,t){if((!this.centroid||r.timeStamp-this.startTime>HD)&&(this.aborted=!0),t.length===0){var a=!this.aborted&&this.centroid;if(this.reset(),a)return a}}}]),e}(),uS=function(){function e(i){(0,re.Z)(this,e),this.singleTap=new GD(i),this.numTaps=i.numTaps,this.reset()}return(0,he.Z)(e,[{key:"reset",value:function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(r,n,t){this.singleTap.touchstart(r,n,t)}},{key:"touchmove",value:function(r,n,t){this.singleTap.touchmove(r,n,t)}},{key:"touchend",value:function(r,n,t){var a=this.singleTap.touchend(r,n,t);if(a){var s=r.timeStamp-this.lastTime<X3,l=!this.lastTap||this.lastTap.dist(a)<Y3;if((!s||!l)&&this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=a,this.count===this.numTaps)return this.reset(),a}}}]),e}(),$D=function(){function e(){(0,re.Z)(this,e),this.tap=new uS({numTouches:1,numTaps:1}),this.reset()}return(0,he.Z)(e,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(r,n,t){this.swipePoint||(this.tapTime&&r.timeStamp-this.tapTime>X3&&this.reset(),this.tapTime?t.length>0&&(this.swipePoint=n[0],this.swipeTouch=t[0].identifier):this.tap.touchstart(r,n,t))}},{key:"touchmove",value:function(r,n,t){if(!this.tapTime)this.tap.touchmove(r,n,t);else if(this.swipePoint){if(t[0].identifier!==this.swipeTouch)return;var a=n[0],s=a.y-this.swipePoint.y;return this.swipePoint=a,r.preventDefault(),this.active=!0,{zoomDelta:s/128}}}},{key:"touchend",value:function(r,n,t){if(this.tapTime)this.swipePoint&&t.length===0&&this.reset();else{var a=this.tap.touchend(r,n,t);a&&(this.tapTime=r.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}(),WD=function(){function e(){(0,re.Z)(this,e),this.zoomIn=new uS({numTouches:1,numTaps:2}),this.zoomOut=new uS({numTouches:2,numTaps:1}),this.reset()}return(0,he.Z)(e,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(r,n,t){this.zoomIn.touchstart(r,n,t),this.zoomOut.touchstart(r,n,t)}},{key:"touchmove",value:function(r,n,t){this.zoomIn.touchmove(r,n,t),this.zoomOut.touchmove(r,n,t)}},{key:"touchend",value:function(r,n,t){var a=this,s=this.zoomIn.touchend(r,n,t),l=this.zoomOut.touchend(r,n,t);if(s)return this.active=!0,r.preventDefault(),setTimeout(function(){return a.reset()},0),{cameraAnimation:function(d){return d.easeTo({duration:300,zoom:d.getZoom()+1,around:d.unproject(s)},{originalEvent:r})}};if(l)return this.active=!0,r.preventDefault(),setTimeout(function(){return a.reset()},0),{cameraAnimation:function(d){return d.easeTo({duration:300,zoom:d.getZoom()-1,around:d.unproject(l)},{originalEvent:r})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}(),XD=function(){function e(i){(0,re.Z)(this,e),this.minTouches=1,this.clickTolerance=i.clickTolerance||1,this.reset()}return(0,he.Z)(e,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Sl(0,0)}},{key:"touchstart",value:function(r,n,t){return this.calculateTransform(r,n,t)}},{key:"touchmove",value:function(r,n,t){if(this.active)return r.preventDefault(),this.calculateTransform(r,n,t)}},{key:"touchend",value:function(r,n,t){this.calculateTransform(r,n,t),this.active&&t.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(r,n,t){t.length>0&&(this.active=!0);var a=sS(t,n),s=new Sl(0,0),l=new Sl(0,0),f=0;for(var d in a)if(a[d]){var S=a[d],O=this.touches[d];O&&(s._add(S),l._add(S.sub(O)),f++,a[d]=S)}if(this.touches=a,!(f<this.minTouches||!l.mag())){var Z=l.div(f);if(this.sum._add(Z),!(this.sum.mag()<this.clickTolerance)){var U=s.div(f);return{around:U,panDelta:Z}}}}}]),e}(),lS=function(){function e(){(0,re.Z)(this,e),this.reset()}return(0,he.Z)(e,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(r){}},{key:"move",value:function(r,n,t){}},{key:"touchstart",value:function(r,n,t){this.firstTwoTouches||t.length<2||(this.firstTwoTouches=[t[0].identifier,t[1].identifier],this.start([n[0],n[1]]))}},{key:"touchmove",value:function(r,n,t){if(this.firstTwoTouches){r.preventDefault();var a=(0,Ja.Z)(this.firstTwoTouches,2),s=a[0],l=a[1],f=mb(t,n,s),d=mb(t,n,l);if(!(!f||!d)){var S=this.aroundCenter?null:f.add(d).div(2);return this.move([f,d],S,r)}}}},{key:"touchend",value:function(r,n,t){if(this.firstTwoTouches){var a=(0,Ja.Z)(this.firstTwoTouches,2),s=a[0],l=a[1],f=mb(t,n,s),d=mb(t,n,l);f&&d||(this.active&&Hp.suppressClick(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(r){this.enabled=!0,this.aroundCenter=!!r&&r.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),e}();function mb(e,i,r){for(var n=0;n<e.length;n++)if(e[n].identifier===r)return i[n]}function YD(e){var i=KD();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function KD(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function cS(e){return Math.abs(e.y)>Math.abs(e.x)}var qD=100,QD=function(e){(0,Ft.Z)(r,e);var i=YD(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"reset",value:function(){$u((0,ot.Z)(r.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(t){this.lastPoints=t,cS(t[0].sub(t[1]))&&(this.valid=!1)}},{key:"move",value:function(t,a,s){var l=t[0].sub(this.lastPoints[0]),f=t[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(l,f,s.timeStamp),!!this.valid){this.lastPoints=t,this.active=!0;var d=(l.y+f.y)/2,S=-.5;return{pitchDelta:d*S}}}},{key:"gestureBeginsVertically",value:function(t,a,s){if(this.valid!==void 0)return this.valid;var l=2,f=t.mag()>=l,d=a.mag()>=l;if(!(!f&&!d)){if(!f||!d)return this.firstMove===void 0&&(this.firstMove=s),s-this.firstMove<qD?void 0:!1;var S=t.y>0==a.y>0;return cS(t)&&cS(a)&&S}}}]),r}(lS);function JD(e){var i=eF();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function eF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var tF=25;function K3(e,i){return e.angleWith(i)*180/Math.PI}var rF=function(e){(0,Ft.Z)(r,e);var i=JD(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"reset",value:function(){$u((0,ot.Z)(r.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(t){this.startVector=this.vector=t[0].sub(t[1]),this.minDiameter=t[0].dist(t[1])}},{key:"move",value:function(t,a){var s=this.vector;if(this.vector=t[0].sub(t[1]),!(!this.active&&this.isBelowThreshold(this.vector)))return this.active=!0,{bearingDelta:K3(this.vector,s),pinchAround:a}}},{key:"isBelowThreshold",value:function(t){this.minDiameter=Math.min(this.minDiameter,t.mag());var a=Math.PI*this.minDiameter,s=tF/a*360,l=K3(t,this.startVector);return Math.abs(l)<s}}]),r}(lS);function nF(e){var i=iF();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function iF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var aF=.1;function q3(e,i){return Math.log(e/i)/Math.LN2}var oF=function(e){(0,Ft.Z)(r,e);var i=nF(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"reset",value:function(){$u((0,ot.Z)(r.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(t){this.startDistance=this.distance=t[0].dist(t[1])}},{key:"move",value:function(t,a){var s=this.distance;if(this.distance=t[0].dist(t[1]),!(!this.active&&Math.abs(q3(this.distance,this.startDistance))<aF))return this.active=!0,{zoomDelta:q3(this.distance,s),pinchAround:a}}}]),r}(lS);function tg(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=sF(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function sF(e,i){if(e){if(typeof e=="string")return Q3(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q3(e,i)}}function Q3(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var gb=function(i){return i.zoom||i.drag||i.pitch||i.rotate};function fS(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}var uF=function(){function e(i,r){var n=this;(0,re.Z)(this,e),(0,V.Z)(this,"handleWindowEvent",function(O){n.handleEvent(O,"".concat(O.type,"Window"))}),(0,V.Z)(this,"handleEvent",function(O,Z){if(O.type==="blur"){n.stop();return}n.updatingCamera=!0;var U=O.type==="renderFrame"?void 0:O,se={needsRenderFrame:!1},le={},ye={},Be=O.touches?n.getMapTouches(O.touches):void 0,rt=Be?Hp.touchPos(n.el,Be):Hp.mousePos(n.el,O),Je=tg(n.handlers),Ot;try{for(Je.s();!(Ot=Je.n()).done;){var jt=Ot.value,dr=jt.handlerName,Lr=jt.handler,jr=jt.allowed;if(Lr.isEnabled()){var Jr=void 0;if(n.blockedByActive(ye,jr,dr))Lr.reset();else{var Pn=Z||O.type;Lr&&Lr[Pn]&&(Jr=Lr[Pn](O,rt,Be),n.mergeIHandlerResult(se,le,Jr,dr,U),Jr&&Jr.needsRenderFrame&&n.triggerRenderFrame())}(Jr||Lr.isActive())&&(ye[dr]=Lr)}}}catch(Va){Je.e(Va)}finally{Je.f()}var In={};for(var Si in n.previousActiveHandlers)ye[Si]||(In[Si]=U);n.previousActiveHandlers=ye,(Object.keys(In).length||fS(se))&&(n.changes.push([se,le,In]),n.triggerRenderFrame()),(Object.keys(ye).length||fS(se))&&n.map.stop(!0),n.updatingCamera=!1;var ra=se.cameraAnimation;ra&&(n.inertia.clear(),n.fireEvents({},{}),n.changes=[],ra(n.map))}),this.map=i,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new vD(i),this.bearingSnap=r.bearingSnap,this.rotateEnabled=r.rotateEnabled,this.pitchEnabled=r.pitchEnabled,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(r);var t=this.el;if(this.listeners=[],zs)ha.document.addEventListener("touchstart",function(O){n.handleEvent(O)},{}),ha.document.addEventListener("touchmove",function(O){n.handleEvent(O)},{}),ha.document.addEventListener("touchend",function(O){n.handleEvent(O)},{}),ha.document.addEventListener("touchcancel",function(O){n.handleEvent(O)},{});else{this.listeners=[[t,"touchstart",{passive:!1}],[t,"touchmove",{passive:!1}],[t,"touchend",void 0],[t,"touchcancel",void 0],[t,"mousedown",void 0],[t,"mousemove",void 0],[t,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[t,"mouseover",void 0],[t,"mouseout",void 0],[t,"dblclick",void 0],[t,"click",void 0],[t,"keydown",{capture:!1}],[t,"keyup",void 0],[t,"wheel",{passive:!1}],[t,"contextmenu",void 0],[window,"blur",void 0]];var a=tg(this.listeners),s;try{for(a.s();!(s=a.n()).done;){var l=(0,Ja.Z)(s.value,3),f=l[0],d=l[1],S=l[2];Hp.addEventListener(f,d,f===window.document?this.handleWindowEvent:this.handleEvent,S)}}catch(O){a.e(O)}finally{a.f()}}}return(0,he.Z)(e,[{key:"destroy",value:function(){var r=tg(this.listeners),n;try{for(r.s();!(n=r.n()).done;){var t=(0,Ja.Z)(n.value,3),a=t[0],s=t[1],l=t[2];Hp.removeEventListener(a,s,a===window.document?this.handleWindowEvent:this.handleEvent,l)}}catch(f){r.e(f)}finally{r.f()}}},{key:"stop",value:function(){if(!this.updatingCamera){var r=tg(this.handlers),n;try{for(r.s();!(n=r.n()).done;){var t=n.value.handler;t.reset()}}catch(a){r.e(a)}finally{r.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}}},{key:"isActive",value:function(){var r=tg(this.handlers),n;try{for(r.s();!(n=r.n()).done;){var t=n.value.handler;if(t.isActive())return!0}}catch(a){r.e(a)}finally{r.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(gb(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(r,n,t,a,s){if(t){(0,Kn.merge)(r,t);var l={handlerName:a,originalEvent:t.originalEvent||s};t.zoomDelta!==void 0&&(n.zoom=l),t.panDelta!==void 0&&(n.drag=l),t.pitchDelta!==void 0&&(n.pitch=l),t.bearingDelta!==void 0&&(n.rotate=l)}}},{key:"triggerRenderFrame",value:function(){var r=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(n){delete r.frameId,r.handleEvent(new uD("renderFrame",{timeStamp:n})),r.applyChanges()}))}},{key:"addDefaultHandlers",value:function(r){var n=this.map,t=n.getCanvasContainer();this.add("mapEvent",new xD(n,r));var a=n.boxZoom=new iD(n,r);this.add("boxZoom",a);var s=new WD,l=new aD;n.doubleClickZoom=new BD(l,s),this.add("tapZoom",s),this.add("clickZoom",l);var f=new $D;this.add("tapDragZoom",f);var d=n.touchPitch=new QD;this.add("touchPitch",d);var S=new MD(r),O=new ID(r);n.dragRotate=new zD(r,S,O),this.add("mouseRotate",S,["mousePitch"]),this.add("mousePitch",O,["mouseRotate"]);var Z=new CD(r),U=new XD(r);n.dragPan=new ND(t,Z,U),this.add("mousePan",Z),this.add("touchPan",U,["touchZoom","touchRotate"]);var se=new rF,le=new oF;n.touchZoomRotate=new ZD(t,le,se,f),this.add("touchRotate",se,["touchPan","touchZoom"]),this.add("touchZoom",le,["touchPan","touchRotate"]);var ye=n.scrollZoom=new FD(n,this);this.add("scrollZoom",ye,["mousePan"]);var Be=n.keyboard=new _D;this.add("keyboard",Be),this.add("blockableMapEvent",new rD(n));for(var rt=0,Je=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];rt<Je.length;rt++){var Ot=Je[rt];r.interactive&&r[Ot]&&n[Ot].enable(r[Ot])}}},{key:"add",value:function(r,n,t){this.handlers.push({handlerName:r,handler:n,allowed:t}),this.handlersById[r]=n}},{key:"blockedByActive",value:function(r,n,t){for(var a in r)if(a!==t&&(!n||n.indexOf(a)<0))return!0;return!1}},{key:"getMapTouches",value:function(r){var n=[],t=tg(r),a;try{for(t.s();!(a=t.n()).done;){var s=a.value,l=s.target;(zs||this.el.contains(l))&&n.push(s)}}catch(f){t.e(f)}finally{t.f()}return n}},{key:"applyChanges",value:function(){var r={},n={},t={},a=tg(this.changes),s;try{for(a.s();!(s=a.n()).done;){var l=(0,Ja.Z)(s.value,3),f=l[0],d=l[1],S=l[2];f.panDelta&&(r.panDelta=(r.panDelta||new Sl(0,0))._add(f.panDelta)),f.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(r.around=f.around),f.pinchAround!==void 0&&(r.pinchAround=f.pinchAround),f.noInertia&&(r.noInertia=f.noInertia),(0,Kn.merge)(n,d),(0,Kn.merge)(t,S)}}catch(O){a.e(O)}finally{a.f()}this.updateMapTransform(r,n,t),this.changes=[]}},{key:"updateMapTransform",value:function(r,n,t){var a=this.map,s=a.transform;if(!fS(r))return this.fireEvents(n,t);var l=r.panDelta,f=r.zoomDelta,d=r.bearingDelta,S=r.pitchDelta,O=r.pinchAround,Z=r.around;O!==void 0&&(Z=O),a.stop(!0),Z=Z||a.transform.centerPoint;var U=s.pointLocation(l?Z.sub(l):Z);d&&this.rotateEnabled&&(s.bearing+=d),S&&this.pitchEnabled&&(s.pitch+=S),f&&(s.zoom+=f),s.setLocationAtPoint(U,Z),this.map.update(),r.noInertia||this.inertia.record(r),this.fireEvents(n,t)}},{key:"fireEvents",value:function(r,n){var t=this,a=gb(this.eventsInProgress),s=gb(r),l={};for(var f in r)if(r[f]){var d=r[f].originalEvent;this.eventsInProgress[f]||(l["".concat(f,"start")]=d),this.eventsInProgress[f]=r[f]}!a&&s&&this.fireEvent("movestart",s.originalEvent);for(var S in l)l[S]&&this.fireEvent(S,l[S]);r.rotate&&(this.bearingChanged=!0),s&&this.fireEvent("move",s.originalEvent);for(var O in r)if(r[O]){var Z=r[O].originalEvent;this.fireEvent(O,Z)}var U={},se;for(var le in this.eventsInProgress)if(this.eventsInProgress[le]){var ye=this.eventsInProgress[le],Be=ye.handlerName,rt=ye.originalEvent;this.handlersById[Be].isActive()||(delete this.eventsInProgress[le],se=n[Be]||rt,U["".concat(le,"end")]=se)}for(var Je in U)U[Je]&&this.fireEvent(Je,U[Je]);var Ot=gb(this.eventsInProgress);if((a||s)&&!Ot){this.updatingCamera=!0;var jt=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),dr=function(jr){return jr!==0&&-t.bearingSnap<jr&&jr<t.bearingSnap};jt?(dr(jt.bearing||this.map.getBearing())&&(jt.bearing=0),this.map.easeTo(jt,{originalEvent:se})):(this.map.emit("moveend",new Ec("moveend",{originalEvent:se})),dr(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(r,n){this.map.emit(r,new Ec(r,n?{originalEvent:n}:{}))}}]),e}(),J3=uF,yb=null,_1=[],lF=30,hS=1e3/lF,Qg=ha.performance,Jg={create:"create",load:"load",fullLoad:"fullLoad"},_b={mark:function(i){Qg.mark(i)},frame:function(i){var r=i;if(yb!=null){var n=r-yb;_1.push(n)}yb=r},clearMetrics:function(){yb=null,_1=[],Qg.clearMeasures("loadTime"),Qg.clearMeasures("fullLoadTime");for(var i in Jg)Qg.clearMarks(Jg[i])},getPerformanceMetrics:function(){var i=Qg.measure("loadTime",Jg.create,Jg.load).duration,r=Qg.measure("fullLoadTime",Jg.create,Jg.fullLoad).duration,n=_1.length,t=_1.reduce(function(f,d){return f+d},0)/n/1e3,a=1/t,s=_1.filter(function(f){return f>hS}).reduce(function(f,d){return f+(d-hS)/hS},0),l=s/(n+s)*100;return{loadTime:i,fullLoadTime:r,fps:a,percentDroppedFrames:l}}};function eM(e,i){var r=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=cF(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(d){throw d},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,l;return{s:function(){r=r.call(e)},n:function(){var d=r.next();return a=d.done,d},e:function(d){s=!0,l=d},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}}}function cF(e,i){if(e){if(typeof e=="string")return tM(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tM(e,i)}}function tM(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,n=new Array(i);r<i;r++)n[r]=e[r];return n}var fF=function(){function e(){(0,re.Z)(this,e),this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return(0,he.Z)(e,[{key:"add",value:function(r){var n=++this.id,t=this.queue;return t.push({callback:r,id:n,cancelled:!1}),n}},{key:"remove",value:function(r){var n=this.currentlyRunning,t=n?this.queue.concat(n):this.queue,a=eM(t),s;try{for(a.s();!(s=a.n()).done;){var l=s.value;if(l.id===r){l.cancelled=!0;return}}}catch(f){a.e(f)}finally{a.f()}}},{key:"run",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=this.currentlyRunning=this.queue;this.queue=[];var t=eM(n),a;try{for(t.s();!(a=t.n()).done;){var s=a.value;if(!s.cancelled&&(s.callback(r),this.cleared))break}}catch(l){t.e(l)}finally{t.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),e}(),rM=fF;function hF(e){var i=pF();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function pF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function dF(e,i){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||n)&&(i||(i=document),!!i)){var t=i.head||i.getElementsByTagName("head")[0];if(!t){t=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(t,a):i.documentElement.appendChild(t)}var s=i.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(i.createTextNode(e)),t.appendChild(s),s}}dF(`.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var xb=-2,nM=22,ey=0,bb=60,vF={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:xb,maxZoom:nM,minPitch:ey,maxPitch:bb,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0,pitchEnabled:!0,rotateEnabled:!0},mF=function(e){(0,Ft.Z)(r,e);var i=hF(r);function r(n){var t;return(0,re.Z)(this,r),t=i.call(this,(0,Kn.merge)({},vF,n)),(0,V.Z)((0,ct.Z)(t),"renderTaskQueue",new rM),(0,V.Z)((0,ct.Z)(t),"trackResize",!0),(0,V.Z)((0,ct.Z)(t),"onWindowOnline",function(){t.update()}),(0,V.Z)((0,ct.Z)(t),"onWindowResize",function(a){t.trackResize&&t.resize({originalEvent:a}).update()}),t.initContainer(),t.resize(),t.handlers=new J3((0,ct.Z)(t),t.options),typeof window!="undefined"&&(window.addEventListener("online",t.onWindowOnline,!1),window.addEventListener("resize",t.onWindowResize,!1),window.addEventListener("orientationchange",t.onWindowResize,!1)),t}return(0,he.Z)(r,[{key:"resize",value:function(t){var a=this.containerDimensions(),s=a[0],l=a[1];this.transform.resize(s,l);var f=!this.moving;return f&&(this.stop(),this.emit("movestart",new Event("movestart",t)),this.emit("move",new Event("move",t))),this.emit("resize",new Event("resize",t)),f&&this.emit("moveend",new Event("moveend",t)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(t){return this.transform.locationPoint(wf.convert(t))}},{key:"unproject",value:function(t){return this.transform.pointLocation(Sl.convert(t))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(t){this.transform.setMaxBounds(g1.convert(t))}},{key:"setStyle",value:function(t){}},{key:"setMinZoom",value:function(t){if(t=t==null?xb:t,t>=xb&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between ".concat(xb," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(t){if(t=t==null?nM:t,t>=this.transform.minZoom)return this.transform.maxZoom=t,this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(t){if(t=t==null?ey:t,t<ey)throw new Error("minPitch must be greater than or equal to ".concat(ey));if(t>=ey&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between ".concat(ey," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(t){if(t=t==null?bb:t,t>bb)throw new Error("maxPitch must be less than or equal to ".concat(bb));if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(t){this.transform.renderWorldCopies=!!t}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(t){return this.update(),this.renderTaskQueue.add(t)}},{key:"cancelRenderFrame",value:function(t){return this.renderTaskQueue.remove(t)}},{key:"triggerRepaint",value:function(){var t=this;this.frame||(this.frame=ab(function(a){_b.frame(a),t.frame=null,t.update(a)}))}},{key:"update",value:function(t){var a=this;this.frame||(this.frame=ab(function(s){_b.frame(s),a.frame=null,a.renderTaskQueue.run(t)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var t=this.container;t.classList.add("l7-map");var a=this.canvasContainer=ss("div","l7-canvas-container",t);this.options.interactive&&a.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var t=0,a=0;return this.container&&(t=this.container.clientWidth||400,a=this.container.clientHeight||300),[t,a]}},{key:"resizeCanvas",value:function(t,a){var s=ju||1;this.canvas.width=s*t,this.canvas.height=s*a,this.canvas.style.width="".concat(t,"px"),this.canvas.style.height="".concat(a,"px")}}]),r}(Z3),gF=function(){function e(i){var r=this;(0,re.Z)(this,e),(0,V.Z)(this,"onHashChange",function(){var n=r.getCurrentHash();if(n.length>=3&&!n.some(function(a){return isNaN(+a)})){var t=r.map.dragRotate.isEnabled()&&r.map.touchZoomRotate.isEnabled()?+(n[3]||0):r.map.getBearing();return r.map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:t,pitch:+(n[4]||0)}),!0}return!1}),(0,V.Z)(this,"getCurrentHash",function(){var n=window.location.hash.replace("#","");if(r.hashName){var t;return n.split("&").map(function(a){return a.split("=")}).forEach(function(a){a[0]===r.hashName&&(t=a)}),(t&&t[1]||"").split("/")}return n.split("/")}),(0,V.Z)(this,"updateHashUnthrottled",function(){var n=r.getHashString();try{window.history.replaceState(window.history.state,"",n)}catch(t){}}),this.hashName=i&&encodeURIComponent(i),this.updateHash=(0,Kn.throttle)(this.updateHashUnthrottled,30*1e3/100)}return(0,he.Z)(e,[{key:"addTo",value:function(r){return this.map=r,ha.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return ha.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(r){var n=this.map.getCenter(),t=Math.round(this.map.getZoom()*100)/100,a=Math.ceil((t*Math.LN2+Math.log(512/360/.5))/Math.LN10),s=Math.pow(10,a),l=Math.round(n.lng*s)/s,f=Math.round(n.lat*s)/s,d=this.map.getBearing(),S=this.map.getPitch(),O="";if(r?O+="/".concat(l,"/").concat(f,"/").concat(t):O+="".concat(t,"/").concat(f,"/").concat(l),(d||S)&&(O+="/".concat(Math.round(d*10)/10)),S&&(O+="/".concat(Math.round(S))),this.hashName){var Z=this.hashName,U=!1,se=window.location.hash.slice(1).split("&").map(function(le){var ye=le.split("=")[0];return ye===Z?(U=!0,"".concat(ye,"=").concat(O)):le}).filter(function(le){return le});return U||se.push("".concat(Z,"=").concat(O)),"#".concat(se.join("&"))}return"#".concat(O)}}]),e}(),yF=gF;function _F(e){var i=xF();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function xF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function bF(e,i){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||n)&&(i||(i=document),!!i)){var t=i.head||i.getElementsByTagName("head")[0];if(!t){t=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(t,a):i.documentElement.appendChild(t)}var s=i.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(i.createTextNode(e)),t.appendChild(s),s}}bF(`.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var Eb=-2,iM=22,ty=0,wb=60,EF={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:Eb,maxZoom:iM,minPitch:ty,maxPitch:wb,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0,pitchEnabled:!0,rotateEnabled:!0},aM=function(e){(0,Ft.Z)(r,e);var i=_F(r);function r(n){var t;if((0,re.Z)(this,r),t=i.call(this,(0,Kn.merge)({},EF,n)),(0,V.Z)((0,ct.Z)(t),"renderTaskQueue",new rM),(0,V.Z)((0,ct.Z)(t),"trackResize",!0),(0,V.Z)((0,ct.Z)(t),"onWindowOnline",function(){t.update()}),(0,V.Z)((0,ct.Z)(t),"onWindowResize",function(s){t.trackResize&&t.resize({originalEvent:s}).update()}),zs?t.initMiniContainer():t.initContainer(),t.resize(),t.handlers=new J3((0,ct.Z)(t),t.options),typeof window!="undefined"&&(window.addEventListener("online",t.onWindowOnline,!1),window.addEventListener("resize",t.onWindowResize,!1),window.addEventListener("orientationchange",t.onWindowResize,!1)),!zs){var a=typeof n.hash=="string"&&n.hash||void 0;n.hash&&(t.hash=new yF(a).addTo((0,ct.Z)(t)))}return(!t.hash||!t.hash.onHashChange())&&(t.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(t.resize(),t.fitBounds(n.bounds,(0,Kn.merge)({},n.fitBoundsOptions,{duration:0})))),t}return(0,he.Z)(r,[{key:"resize",value:function(t){var a=this.containerDimensions(),s=(0,Ja.Z)(a,2),l=s[0],f=s[1];if(this.transform.resize(l,f),zs)return this;var d=!this.moving;return d&&(this.stop(),this.emit("movestart",new ha.Event("movestart",t)),this.emit("move",new ha.Event("move",t))),this.emit("resize",new ha.Event("resize",t)),d&&this.emit("moveend",new ha.Event("moveend",t)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(t){return this.transform.locationPoint(wf.convert(t))}},{key:"unproject",value:function(t){return this.transform.pointLocation(Sl.convert(t))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(t){this.transform.setMaxBounds(g1.convert(t))}},{key:"setStyle",value:function(t){}},{key:"setMinZoom",value:function(t){if(t=t==null?Eb:t,t>=Eb&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between ".concat(Eb," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(t){if(t=t==null?iM:t,t>=this.transform.minZoom)return this.transform.maxZoom=t,this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(t){if(t=t==null?ty:t,t<ty)throw new Error("minPitch must be greater than or equal to ".concat(ty));if(t>=ty&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between ".concat(ty," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(t){if(t=t==null?wb:t,t>wb)throw new Error("maxPitch must be less than or equal to ".concat(wb));if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(t){this.transform.renderWorldCopies=!!t}},{key:"remove",value:function(){this.container.removeChild(this.canvasContainer),this.canvasContainer=null,this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(t){return this.update(),this.renderTaskQueue.add(t)}},{key:"cancelRenderFrame",value:function(t){return this.renderTaskQueue.remove(t)}},{key:"triggerRepaint",value:function(){var t=this;this.frame||(this.frame=ab(function(a){_b.frame(a),t.frame=null,t.update(a)}))}},{key:"update",value:function(t){var a=this;this.frame||(this.frame=ab(function(s){_b.frame(s),a.frame=null,a.renderTaskQueue.run(t)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var t=this.container;t.classList.add("l7-map");var a=this.canvasContainer=ss("div","l7-canvas-container",t);this.options.interactive&&a.classList.add("l7-interactive")}},{key:"initMiniContainer",value:function(){this.container=this.options.canvas,this.canvasContainer=this.container}},{key:"containerDimensions",value:function(){var t=0,a=0;return this.container&&(zs?(t=this.container.width/ha.devicePixelRatio,a=this.container.height/ha.devicePixelRatio):(t=this.container.clientWidth,a=this.container.clientHeight,t=t===0?400:t,a=a===0?300:a)),[t,a]}}]),r}(Z3),wF={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},oM,sM,uM,lM,cM,fM,ry,hM,pM,dM,vM,mM={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},SF=12,Sb=(oM=(0,Xr.b2)(),sM=(0,Xr.f3)(Ir.MapConfig),uM=(0,Xr.f3)(Ir.IGlobalConfigService),lM=(0,Xr.f3)(Ir.ICoordinateSystemService),cM=(0,Xr.f3)(Ir.IEventEmitter),oM(fM=(ry=function(){function e(){var i=this;(0,re.Z)(this,e),(0,V.Z)(this,"version",ah.DEFUALT),(0,V.Z)(this,"simpleMapCoord",new r3),(0,V.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),Ys(this,"config",hM,this),Ys(this,"configService",pM,this),Ys(this,"coordinateSystemService",dM,this),Ys(this,"eventEmitter",vM,this),(0,V.Z)(this,"handleCameraChanged",function(r){var n=i.map.getCenter(),t=n.lat,a=n.lng;i.emit("mapchange"),i.viewport.syncWithMapCamera({bearing:i.map.getBearing(),center:[a,t],viewportHeight:i.map.transform.height,pitch:i.map.getPitch(),viewportWidth:i.map.transform.width,zoom:i.map.getZoom(),cameraHeight:0}),i.updateCoordinateSystemService(),i.cameraChangedCallback(i.viewport)})}return(0,he.Z)(e,[{key:"setBgColor",value:function(r){this.bgColor=r}},{key:"addMarkerContainer",value:function(){var r=this.map.getCanvasContainer();this.markerContainer=ss("div","l7-marker-container",r),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"getOverlayContainer",value:function(){}},{key:"on",value:function(r,n){Nm.indexOf(r)!==-1?this.eventEmitter.on(r,n):this.map.on(mM[r]||r,n)}},{key:"off",value:function(r,n){this.map.off(mM[r]||r,n),this.eventEmitter.off(r,n)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){if(this.version===ah.SIMPLE)return this.simpleMapCoord.getSize();var r=this.map.transform;return[r.width,r.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(r){return this.map.setZoom(r)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(r){this.map.setCenter(r)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(r){this.map.setBearing(r)}},{key:"zoomIn",value:function(r,n){this.map.zoomIn(r,n)}},{key:"zoomOut",value:function(r,n){this.map.zoomOut(r,n)}},{key:"setPitch",value:function(r){return this.map.setPitch(r)}},{key:"panTo",value:function(r){this.map.panTo(r)}},{key:"panBy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.panTo([r,n])}},{key:"fitBounds",value:function(r,n){this.map.fitBounds(r,n)}},{key:"setMaxZoom",value:function(r){this.map.setMaxZoom(r)}},{key:"setMinZoom",value:function(r){this.map.setMinZoom(r)}},{key:"setMapStatus",value:function(r){r.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),r.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),r.dragEnable===!1&&this.map.dragPan.disable(),r.dragEnable===!0&&this.map.dragPan.enable(),r.rotateEnable===!1&&this.map.dragRotate.disable(),r.dragEnable===!0&&this.map.dragRotate.enable(),r.keyboardEnable===!1&&this.map.keyboard.disable(),r.keyboardEnable===!0&&this.map.keyboard.enable(),r.zoomEnable===!1&&this.map.scrollZoom.disable(),r.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(r,n){this.map.flyTo({zoom:r,center:n})}},{key:"setMapStyle",value:function(r){this.map.setStyle(this.getMapStyleValue(r))}},{key:"meterToCoord",value:function(r,n){return 1}},{key:"pixelToLngLat",value:function(r){return this.map.unproject(r)}},{key:"lngLatToPixel",value:function(r){return this.map.project(r)}},{key:"containerToLngLat",value:function(r){return this.map.unproject(r)}},{key:"lngLatToContainer",value:function(r){return this.map.project(r)}},{key:"getMapStyle",value:function(){try{var r,n=(r=this.map.getStyle().sprite)!==null&&r!==void 0?r:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(n)?n==null?void 0:n.replace(/\/\w+$/,"").replace(/sprites/,"styles"):n}catch(t){return""}}},{key:"getMapStyleConfig",value:function(){return wF}},{key:"getMapStyleValue",value:function(r){var n;return(n=this.getMapStyleConfig()[r])!==null&&n!==void 0?n:r}},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(r){for(var n,t=arguments.length,a=new Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];(n=this.eventEmitter).emit.apply(n,[r].concat(a))}},{key:"once",value:function(r){for(var n,t=arguments.length,a=new Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];(n=this.eventEmitter).once.apply(n,[r].concat(a))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(r){var n=this.map.getCanvas(),t=r==="jpg"?n==null?void 0:n.toDataURL("image/jpeg"):n==null?void 0:n.toDataURL("image/png");return t}},{key:"onCameraChanged",value:function(r){this.cameraChangedCallback=r}},{key:"creatMapContainer",value:function(r){var n=r;return typeof r=="string"&&(n=document.getElementById(r)),n}},{key:"updateView",value:function(r){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:r.bearing,center:r.center,viewportHeight:r.viewportHeight,pitch:r.pitch,viewportWidth:r.viewportWidth,zoom:r.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}},{key:"updateCoordinateSystemService",value:function(){var r=this.config.offsetCoordinate,n=r===void 0?!0:r;this.viewport.getZoom()>SF&&n?this.coordinateSystemService.setCoordinateSystem(Wf.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(Wf.LNGLAT)}}]),e}(),hM=Hs(ry.prototype,"config",[sM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pM=Hs(ry.prototype,"configService",[uM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dM=Hs(ry.prototype,"coordinateSystemService",[lM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vM=Hs(ry.prototype,"eventEmitter",[cM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ry))||fM),CF=function(){function e(){(0,re.Z)(this,e),(0,V.Z)(this,"xzReg",-Math.PI*.6),(0,V.Z)(this,"yReg",Math.PI*.2),(0,V.Z)(this,"earthCameraRadius",200),(0,V.Z)(this,"earthCameraZoom",1),(0,V.Z)(this,"cameraPosition",j0()),(0,V.Z)(this,"projectionMatrix",rl()),(0,V.Z)(this,"modelMatrix",rl()),(0,V.Z)(this,"viewMatrix",rl()),(0,V.Z)(this,"viewProjectionMatrix",rl()),(0,V.Z)(this,"ViewProjectionMatrixUncentered",rl()),(0,V.Z)(this,"viewUncenteredMatrix",rl())}return(0,he.Z)(e,[{key:"syncWithMapCamera",value:function(r){var n=r.viewportHeight,t=n===void 0?1:n,a=r.viewportWidth,s=a===void 0?1:a,l=s/t,f=.1,d=1e4,S=20;_d(this.projectionMatrix,S,l,f,d);var O=this.earthCameraRadius*Math.cos(this.xzReg),Z=this.earthCameraRadius*Math.sin(this.xzReg),U=this.earthCameraRadius*Math.sin(this.yReg);this.cameraPosition=Kl(O,U,Z),V0(this.cameraPosition,this.cameraPosition),cw(this.cameraPosition,this.cameraPosition,Kl(this.earthCameraRadius,this.earthCameraRadius,this.earthCameraRadius)),fw(this.cameraPosition,this.cameraPosition,this.earthCameraZoom);var se=j0();Sx(se,this.cameraPosition,Kl(0,1,0));var le=Kl(0,1,0);Sx(le,se,this.cameraPosition);var ye=Kl(0,0,0);mp(this.viewMatrix,this.cameraPosition,ye,le),this.viewUncenteredMatrix=rh(this.viewMatrix),ef(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),ef(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"rotateY",value:function(r){this.xzReg+=r*Math.min(this.earthCameraZoom*this.earthCameraZoom,1)}},{key:"rotateX",value:function(r){this.yReg+=r*Math.min(this.earthCameraZoom*this.earthCameraZoom,1)}},{key:"scaleZoom",value:function(r){this.earthCameraZoom+=r,this.earthCameraZoom=Math.max(this.earthCameraZoom,.6)}},{key:"getZoom",value:function(){return 4}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[0,0]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return this.modelMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(r,n){return this.viewport.projectFlat(r,n)}}]),e}(),AF=["id","style","rotation"],gM,yM;function TF(e){var i=MF();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function MF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var _M={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},PF=12,OF=(gM=(0,Xr.b2)(),gM(yM=function(e){(0,Ft.Z)(r,e);var i=TF(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"version",ah.GLOBEL),(0,V.Z)((0,ct.Z)(n),"dragging",!1),(0,V.Z)((0,ct.Z)(n),"handleCameraChanged",function(l){n.emit("mapchange");var f=2e3;n.handleCameraChanging=!0,n.handleCameraTimer&&clearTimeout(n.handleCameraTimer),n.handleCameraTimer=setTimeout(function(){n.handleCameraChanging=!1},f);var d=.02;l.type&&l.originalEvent&&(l.originalEvent.type==="wheel"&&n.viewport.scaleZoom(.01*Math.sign(l.originalEvent.wheelDelta)*-1),Math.abs(l.originalEvent.movementX)>Math.abs(l.originalEvent.movementY)?l.originalEvent.movementX>0?n.viewport.rotateY(d):l.originalEvent.movementX<0&&n.viewport.rotateY(-d):l.originalEvent.movementY>0?n.viewport.rotateX(d):l.originalEvent.movementY<0&&n.viewport.rotateX(-d));var S=n.config.offsetCoordinate,O=S===void 0?!0:S;n.viewport.syncWithMapCamera({viewportHeight:n.map.transform.height,viewportWidth:n.map.transform.width}),n.viewport.getZoom()>PF&&O?n.coordinateSystemService.setCoordinateSystem(Wf.LNGLAT_OFFSET):n.coordinateSystemService.setCoordinateSystem(Wf.LNGLAT),n.cameraChangedCallback(n.viewport)}),n}return(0,he.Z)(r,[{key:"lngLatToMercator",value:function(t,a){throw new Error("Method not implemented.")}},{key:"getModelMatrix",value:function(t,a,s,l,f){throw new Error("Method not implemented.")}},{key:"on",value:function(t,a){Nm.indexOf(t)!==-1?this.eventEmitter.on(t,a):this.map.on(_M[t]||t,a)}},{key:"off",value:function(t,a){this.map.off(_M[t]||t,a),this.eventEmitter.off(t,a)}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var t=this.map.transform;return[t.width,t.height]}},{key:"getType",value:function(){return"earth"}},{key:"init",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s,l,f,d,S,O,Z,U;return Ze().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:s=this.config,l=s.id,f=l===void 0?"map":l,d=s.style,S=d===void 0?"light":d,O=s.rotation,Z=O===void 0?0:O,U=(0,Xo.Z)(s,AF),this.viewport=new CF,this.$mapContainer=this.creatMapContainer(f),this.map=new mF((0,ue.Z)({container:this.$mapContainer,style:this.getMapStyleValue(S),bearing:Z},U)),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged({});case 7:case"end":return le.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var t,a;(t=this.$mapContainer)===null||t===void 0||(a=t.parentNode)===null||a===void 0||a.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(t){for(var a,s=arguments.length,l=new Array(s>1?s-1:0),f=1;f<s;f++)l[f-1]=arguments[f];(a=this.eventEmitter).emit.apply(a,[t].concat(l))}},{key:"once",value:function(t){for(var a,s=arguments.length,l=new Array(s>1?s-1:0),f=1;f<s;f++)l[f-1]=arguments[f];(a=this.eventEmitter).once.apply(a,[t].concat(l))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"rotateY",value:function(t){var a=t||{},s=a.force,l=s===void 0?!1:s,f=a.reg,d=f===void 0?.01:f;this.handleCameraChanging&&!l||this.viewport&&(this.viewport.rotateY(d),this.viewport.syncWithMapCamera({viewportHeight:this.map.transform.height,viewportWidth:this.map.transform.width}),this.cameraChangedCallback(this.viewport))}}]),r}(Sb))||yM);function IF(e){var i=LF();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function LF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var RF=function(e){(0,Ft.Z)(r,e);var i=IF(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getServiceConstructor",value:function(){return OF}}]),r}(Yg),kF=["id","style","rotation","mapInstance","version","mapSize","interactive"],DF=["id","style","rotation","mapInstance","canvas","hasBaseMap"],xM,bM;function FF(e){var i=BF();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function BF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var NF=12,zF=(xM=(0,Xr.b2)(),xM(bM=function(e){(0,Ft.Z)(r,e);var i=FF(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"version",ah.DEFUALT),(0,V.Z)((0,ct.Z)(n),"handleMiniCameraChanged",function(l,f,d,S,O){var Z=n.config.offsetCoordinate,U=Z===void 0?!0:Z;n.viewport.syncWithMapCamera({bearing:S,center:[l,f],viewportHeight:n.map.transform.height,pitch:O,viewportWidth:n.map.transform.width,zoom:d,cameraHeight:0}),n.viewport.getZoom()>NF&&U?n.coordinateSystemService.setCoordinateSystem(Wf.LNGLAT_OFFSET):n.coordinateSystemService.setCoordinateSystem(Wf.LNGLAT),n.cameraChangedCallback(n.viewport)}),n}return(0,he.Z)(r,[{key:"lngLatToCoord",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},s=this.lngLatToMercator(t,0),l=s.x,f=s.y;return[l-a.x,f-a.y]}},{key:"lngLatToMercator",value:function(t,a){var s=qg.fromLngLat(t,a),l=s.x,f=l===void 0?0:l,d=s.y,S=d===void 0?0:d,O=s.z,Z=O===void 0?0:O;return{x:f,y:S,z:Z}}},{key:"getModelMatrix",value:function(t,a,s){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},d=qg.fromLngLat(t,a),S=d.meterInMercatorCoordinateUnits(),O=rl();return Lc(O,O,Kl(d.x-f.x,d.y-f.y,d.z||0-f.z)),Ru(O,O,Kl(S*l[0],-S*l[1],S*l[2])),wp(O,O,s[0]),zp(O,O,s[1]),vp(O,O,s[2]),O}},{key:"init",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s=this,l,f,d,S,O,Z,U,se,le,ye,Be,rt,Je,Ot,jt;return Ze().wrap(function(Lr){for(;;)switch(Lr.prev=Lr.next){case 0:l=this.config,f=l.id,d=f===void 0?"map":f,S=l.style,O=S===void 0?"light":S,Z=l.rotation,U=Z===void 0?0:Z,se=l.mapInstance,le=l.version,ye=le===void 0?"DEFAULTMAP":le,Be=l.mapSize,rt=Be===void 0?1e4:Be,Je=l.interactive,Ot=Je===void 0?!0:Je,jt=(0,Xo.Z)(l,kF),this.viewport=new rb,this.version=ye,this.simpleMapCoord.setSize(rt),ye===ah.SIMPLE&&jt.center&&(jt.center=this.simpleMapCoord.unproject(jt.center)),se?(this.map=se,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatMapContainer(d),this.map=new aM((0,ue.Z)({container:this.$mapContainer,style:this.getMapStyleValue(O),bearing:U},jt))),this.map.on("load",function(){s.handleCameraChanged()}),Ot&&this.map.on("move",this.handleCameraChanged),setTimeout(function(){s.handleCameraChanged()},100),this.handleCameraChanged();case 10:case"end":return Lr.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"initMiniMap",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s=this,l,f,d,S,O,Z,U,se,le,ye,Be,rt,Je,Ot;return Ze().wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:l=this.config,f=l.id,d=f===void 0?"map":f,S=l.style,O=S===void 0?"light":S,Z=l.rotation,U=Z===void 0?0:Z,se=l.mapInstance,le=l.canvas,ye=le===void 0?null:le,Be=l.hasBaseMap,rt=Be===void 0?!1:Be,Je=(0,Xo.Z)(l,DF),this.viewport=new rb,this.$mapContainer=ye,this.map=new aM((0,ue.Z)({container:this.$mapContainer,style:this.getMapStyleValue(O),bearing:U,canvas:ye},Je)),rt?(Ot=this.map.getCenter(),this.handleMiniCameraChanged(Ot.lng,Ot.lat,this.map.getZoom(),this.map.getBearing(),this.map.getPitch()),ha.document.addEventListener("mapCameaParams",function(Lr){var jr=Lr.e,Jr=jr.longitude,Pn=jr.latitude,In=jr.scale,Si=jr.bearing,ra=jr.pitch;s.handleMiniCameraChanged(Jr,Pn,In-1.25,Si,ra)})):(this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged());case 5:case"end":return dr.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"exportMap",value:function(t){var a=this.map.getCanvas(),s=t==="jpg"?a==null?void 0:a.toDataURL("image/jpeg"):a==null?void 0:a.toDataURL("image/png");return s}}]),r}(Sb))||bM);function ZF(e){var i=UF();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function UF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var jF=function(e){(0,Ft.Z)(r,e);var i=ZF(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getServiceConstructor",value:function(){return zF}}]),r}(Yg),VF=I(6158),x1=I.n(VF),HF=function(){function e(){(0,re.Z)(this,e)}return(0,he.Z)(e,[{key:"syncWithMapCamera",value:function(r){var n=r.center,t=r.zoom,a=r.pitch,s=r.bearing,l=r.viewportHeight,f=r.viewportWidth;this.viewport=new Kw({width:f,height:l,longitude:n&&n[0],latitude:n&&n[1],zoom:t,pitch:a,bearing:s})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(r,n){return this.viewport.projectFlat(r,n)}}]),e}(),GF=["id","attributionControl","style","token","rotation","mapInstance"],EM,wM;function $F(e){var i=WF();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function WF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function XF(e,i){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||n)&&(i||(i=document),!!i)){var t=i.head||i.getElementsByTagName("head")[0];if(!t){t=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(t,a):i.documentElement.appendChild(t)}var s=i.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(i.createTextNode(e)),t.appendChild(s),s}}XF(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=x1();var YF=0,SM="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg",KF=(EM=(0,Xr.b2)(),EM(wM=function(e){(0,Ft.Z)(r,e);var i=$F(r);function r(){var n;(0,re.Z)(this,r);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n=i.call.apply(i,[this].concat(a)),(0,V.Z)((0,ct.Z)(n),"version",ah.MAPBOX),n}return(0,he.Z)(r,[{key:"getType",value:function(){return"mapbox"}},{key:"lngLatToCoord",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},s=this.lngLatToMercator(t,0),l=s.x,f=s.y;return[l-a.x,f-a.y]}},{key:"lngLatToMercator",value:function(t,a){var s=window.mapboxgl.MercatorCoordinate.fromLngLat(t,a),l=s.x,f=l===void 0?0:l,d=s.y,S=d===void 0?0:d,O=s.z,Z=O===void 0?0:O;return{x:f,y:S,z:Z}}},{key:"getModelMatrix",value:function(t,a,s){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},d=window.mapboxgl.MercatorCoordinate.fromLngLat(t,a),S=d.meterInMercatorCoordinateUnits(),O=rl();return Lc(O,O,Kl(d.x-f.x,d.y-f.y,d.z||0-f.z)),Ru(O,O,Kl(S*l[0],-S*l[1],S*l[2])),wp(O,O,s[0]),zp(O,O,s[1]),vp(O,O,s[2]),O}},{key:"init",value:function(){var n=(0,Dt.Z)(Ze().mark(function a(){var s=this,l,f,d,S,O,Z,U,se,le,ye,Be,rt,Je;return Ze().wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:l=this.config,f=l.id,d=f===void 0?"map":f,S=l.attributionControl,O=S===void 0?!1:S,Z=l.style,U=Z===void 0?"light":Z,se=l.token,le=se===void 0?SM:se,ye=l.rotation,Be=ye===void 0?0:ye,rt=l.mapInstance,Je=(0,Xo.Z)(l,GF),this.viewport=new HF,!rt&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),le===SM&&U!=="blank"&&!window.mapboxgl.accessToken&&!rt&&console.warn(this.configService.getSceneWarninfo("MapToken")),!rt&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=le),rt?(this.map=rt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatMapContainer(d),this.map=new window.mapboxgl.Map((0,ue.Z)({container:this.$mapContainer,style:this.getMapStyleValue(U),attributionControl:O,bearing:Be},Je))),this.map.on("load",function(){s.handleCameraChanged()}),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return jt.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var t,a;(t=this.$mapContainer)===null||t===void 0||(a=t.parentNode)===null||a===void 0||a.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(t){for(var a,s=arguments.length,l=new Array(s>1?s-1:0),f=1;f<s;f++)l[f-1]=arguments[f];(a=this.eventEmitter).emit.apply(a,[t].concat(l))}},{key:"once",value:function(t){for(var a,s=arguments.length,l=new Array(s>1?s-1:0),f=1;f<s;f++)l[f-1]=arguments[f];(a=this.eventEmitter).once.apply(a,[t].concat(l))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"meterToCoord",value:function(t,a){var s=new(x1()).LngLat(t[0],t[1]),l=new(x1()).LngLat(a[0],a[1]),f=s.distanceTo(l),d=x1().MercatorCoordinate.fromLngLat({lng:t[0],lat:t[1]}),S=x1().MercatorCoordinate.fromLngLat({lng:a[0],lat:a[1]}),O=d.x,Z=d.y,U=S.x,se=S.y,le=Math.sqrt(Math.pow(O-U,2)+Math.pow(Z-se,2))*4194304*2;return le/f}},{key:"exportMap",value:function(t){var a=this.map.getCanvas(),s=t==="jpg"?a==null?void 0:a.toDataURL("image/jpeg"):a==null?void 0:a.toDataURL("image/png");return s}},{key:"creatMapContainer",value:function(t){var a=t;typeof t=="string"&&(a=document.getElementById(t));var s=document.createElement("div");return s.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,s.id="l7_mapbox_div"+YF++,a.appendChild(s),s}}]),r}(Sb))||wM);function qF(e){var i=QF();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function QF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function JF(e,i){var r=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(r||n)&&(i||(i=document),!!i)){var t=i.head||i.getElementsByTagName("head")[0];if(!t){t=i.createElement("head");var a=i.body||i.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(t,a):i.documentElement.appendChild(t)}var s=i.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(i.createTextNode(e)),t.appendChild(s),s}}JF(`.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var eB=function(e){(0,Ft.Z)(r,e);var i=qF(r);function r(){return(0,re.Z)(this,r),i.apply(this,arguments)}return(0,he.Z)(r,[{key:"getServiceConstructor",value:function(){return KF}}]),r}(Yg),tB=I(88307),rB=I.n(tB),nB=function(){function e(i,r){(0,re.Z)(this,e);var n=r.buffer,t=r.offset,a=r.stride,s=r.normalized,l=r.size,f=r.divisor;this.buffer=n,this.attribute={buffer:n.get(),offset:t||0,stride:a||0,normalized:s||!1,divisor:f||0},l&&(this.attribute.size=l)}return(0,he.Z)(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(r){this.buffer.subData(r)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),d0,b1,v0,hv,E1,Y0,w1,Cb,Wv,rg,Gp,Xv,Yv,Ab,iB=(d0={},(0,V.Z)(d0,Ve.POINTS,"points"),(0,V.Z)(d0,Ve.LINES,"lines"),(0,V.Z)(d0,Ve.LINE_LOOP,"line loop"),(0,V.Z)(d0,Ve.LINE_STRIP,"line strip"),(0,V.Z)(d0,Ve.TRIANGLES,"triangles"),(0,V.Z)(d0,Ve.TRIANGLE_FAN,"triangle fan"),(0,V.Z)(d0,Ve.TRIANGLE_STRIP,"triangle strip"),d0),CM=(b1={},(0,V.Z)(b1,Ve.STATIC_DRAW,"static"),(0,V.Z)(b1,Ve.DYNAMIC_DRAW,"dynamic"),(0,V.Z)(b1,Ve.STREAM_DRAW,"stream"),b1),pS=(v0={},(0,V.Z)(v0,Ve.BYTE,"int8"),(0,V.Z)(v0,Ve.UNSIGNED_INT,"int16"),(0,V.Z)(v0,Ve.INT,"int32"),(0,V.Z)(v0,Ve.UNSIGNED_BYTE,"uint8"),(0,V.Z)(v0,Ve.UNSIGNED_SHORT,"uint16"),(0,V.Z)(v0,Ve.UNSIGNED_INT,"uint32"),(0,V.Z)(v0,Ve.FLOAT,"float"),v0),aB=(hv={},(0,V.Z)(hv,Ve.ALPHA,"alpha"),(0,V.Z)(hv,Ve.LUMINANCE,"luminance"),(0,V.Z)(hv,Ve.LUMINANCE_ALPHA,"luminance alpha"),(0,V.Z)(hv,Ve.RGB,"rgb"),(0,V.Z)(hv,Ve.RGBA,"rgba"),(0,V.Z)(hv,Ve.RGBA4,"rgba4"),(0,V.Z)(hv,Ve.RGB5_A1,"rgb5 a1"),(0,V.Z)(hv,Ve.RGB565,"rgb565"),(0,V.Z)(hv,Ve.DEPTH_COMPONENT,"depth"),(0,V.Z)(hv,Ve.DEPTH_STENCIL,"depth stencil"),hv),oB=(E1={},(0,V.Z)(E1,Ve.DONT_CARE,"dont care"),(0,V.Z)(E1,Ve.NICEST,"nice"),(0,V.Z)(E1,Ve.FASTEST,"fast"),E1),AM=(Y0={},(0,V.Z)(Y0,Ve.NEAREST,"nearest"),(0,V.Z)(Y0,Ve.LINEAR,"linear"),(0,V.Z)(Y0,Ve.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,V.Z)(Y0,Ve.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,V.Z)(Y0,Ve.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,V.Z)(Y0,Ve.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Y0),TM=(w1={},(0,V.Z)(w1,Ve.REPEAT,"repeat"),(0,V.Z)(w1,Ve.CLAMP_TO_EDGE,"clamp"),(0,V.Z)(w1,Ve.MIRRORED_REPEAT,"mirror"),w1),sB=(Cb={},(0,V.Z)(Cb,Ve.NONE,"none"),(0,V.Z)(Cb,Ve.BROWSER_DEFAULT_WEBGL,"browser"),Cb),uB=(Wv={},(0,V.Z)(Wv,Ve.NEVER,"never"),(0,V.Z)(Wv,Ve.ALWAYS,"always"),(0,V.Z)(Wv,Ve.LESS,"less"),(0,V.Z)(Wv,Ve.LEQUAL,"lequal"),(0,V.Z)(Wv,Ve.GREATER,"greater"),(0,V.Z)(Wv,Ve.GEQUAL,"gequal"),(0,V.Z)(Wv,Ve.EQUAL,"equal"),(0,V.Z)(Wv,Ve.NOTEQUAL,"notequal"),Wv),MM=(rg={},(0,V.Z)(rg,Ve.FUNC_ADD,"add"),(0,V.Z)(rg,Ve.MIN_EXT,"min"),(0,V.Z)(rg,Ve.MAX_EXT,"max"),(0,V.Z)(rg,Ve.FUNC_SUBTRACT,"subtract"),(0,V.Z)(rg,Ve.FUNC_REVERSE_SUBTRACT,"reverse subtract"),rg),Tb=(Gp={},(0,V.Z)(Gp,Ve.ZERO,"zero"),(0,V.Z)(Gp,Ve.ONE,"one"),(0,V.Z)(Gp,Ve.SRC_COLOR,"src color"),(0,V.Z)(Gp,Ve.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,V.Z)(Gp,Ve.SRC_ALPHA,"src alpha"),(0,V.Z)(Gp,Ve.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,V.Z)(Gp,Ve.DST_COLOR,"dst color"),(0,V.Z)(Gp,Ve.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,V.Z)(Gp,Ve.DST_ALPHA,"dst alpha"),(0,V.Z)(Gp,Ve.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,V.Z)(Gp,Ve.CONSTANT_COLOR,"constant color"),(0,V.Z)(Gp,Ve.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,V.Z)(Gp,Ve.CONSTANT_ALPHA,"constant alpha"),(0,V.Z)(Gp,Ve.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,V.Z)(Gp,Ve.SRC_ALPHA_SATURATE,"src alpha saturate"),Gp),lB=(Xv={},(0,V.Z)(Xv,Ve.NEVER,"never"),(0,V.Z)(Xv,Ve.ALWAYS,"always"),(0,V.Z)(Xv,Ve.LESS,"less"),(0,V.Z)(Xv,Ve.LEQUAL,"lequal"),(0,V.Z)(Xv,Ve.GREATER,"greater"),(0,V.Z)(Xv,Ve.GEQUAL,"gequal"),(0,V.Z)(Xv,Ve.EQUAL,"equal"),(0,V.Z)(Xv,Ve.NOTEQUAL,"notequal"),Xv),ny=(Yv={},(0,V.Z)(Yv,Ve.ZERO,"zero"),(0,V.Z)(Yv,Ve.KEEP,"keep"),(0,V.Z)(Yv,Ve.REPLACE,"replace"),(0,V.Z)(Yv,Ve.INVERT,"invert"),(0,V.Z)(Yv,Ve.INCR,"increment"),(0,V.Z)(Yv,Ve.DECR,"decrement"),(0,V.Z)(Yv,Ve.INCR_WRAP,"increment wrap"),(0,V.Z)(Yv,Ve.DECR_WRAP,"decrement wrap"),Yv),cB=(Ab={},(0,V.Z)(Ab,Ve.FRONT,"front"),(0,V.Z)(Ab,Ve.BACK,"back"),Ab),fB=function(){function e(i,r){(0,re.Z)(this,e);var n=r.data,t=r.usage,a=r.type;this.buffer=i.buffer({data:n,usage:CM[t||Ve.STATIC_DRAW],type:pS[a||Ve.UNSIGNED_BYTE]})}return(0,he.Z)(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(r){var n=r.data,t=r.offset;this.buffer.subdata(n,t)}}]),e}(),hB=function(){function e(i,r){(0,re.Z)(this,e);var n=r.data,t=r.usage,a=r.type,s=r.count;this.elements=i.elements({data:n,usage:CM[t||Ve.STATIC_DRAW],type:pS[a||Ve.UNSIGNED_BYTE],count:s})}return(0,he.Z)(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(r){var n=r.data;this.elements.subdata(n)}},{key:"destroy",value:function(){}}]),e}(),pB=function(){function e(i,r){(0,re.Z)(this,e);var n=r.width,t=r.height,a=r.color,s=r.colors,l={width:n,height:t};Array.isArray(s)&&(l.colors=s.map(function(f){return f.get()})),a&&typeof a!="boolean"&&(l.color=a.get()),this.framebuffer=i.framebuffer(l)}return(0,he.Z)(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(r){var n=r.width,t=r.height;this.framebuffer.resize(n,t)}}]),e}(),dB=function(){function e(i,r){(0,re.Z)(this,e),(0,V.Z)(this,"destroyed",!1),(0,V.Z)(this,"uniforms",{}),this.reGl=i;var n=r.pick,t=n===void 0?!0:n,a=r.vs,s=r.fs,l=r.attributes,f=r.uniforms,d=r.primitive,S=r.count,O=r.elements,Z=r.depth,U=r.blend,se=r.stencil,le=r.cull,ye=r.instances,Be={};this.options=r,f&&(this.uniforms=this.extractUniforms(f),Object.keys(f).forEach(function(jt){Be[jt]=i.prop(jt)}));var rt={};Object.keys(l).forEach(function(jt){rt[jt]=l[jt].get()});var Je={attributes:rt,frag:s,uniforms:Be,vert:a,blend:{},primitive:iB[d===void 0?Ve.TRIANGLES:d]};if(ye&&(Je.instances=ye),S?Je.count=S:O&&(Je.elements=O.get()),this.initDepthDrawParams({depth:Z},Je),this.initBlendDrawParams({blend:U},Je),this.initStencilDrawParams({stencil:se},Je),this.initCullDrawParams({cull:le},Je),this.drawCommand=i(Je),t){var Ot=(0,Kn.cloneDeep)(Je);Ot.blend=(0,ue.Z)((0,ue.Z)({},Ot.blend),{},{enable:!1}),this.drawPickCommand=i(Ot)}this.drawParams=Je}return(0,he.Z)(e,[{key:"updateAttributesAndElements",value:function(r,n){var t={};if(Object.keys(r).forEach(function(s){t[s]=r[s].get()}),this.drawParams.attributes=t,this.drawParams.elements=n.get(),this.drawCommand=this.reGl(this.drawParams),this.options.pick){var a=(0,Kn.cloneDeep)(this.drawParams);a.blend=(0,ue.Z)((0,ue.Z)({},a.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(a)}}},{key:"updateAttributes",value:function(r){var n={};if(Object.keys(r).forEach(function(a){n[a]=r[a].get()}),this.drawParams.attributes=n,this.drawCommand=this.reGl(this.drawParams),this.options.pick){var t=(0,Kn.cloneDeep)(this.drawParams);t.blend=(0,ue.Z)((0,ue.Z)({},t.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(t)}}},{key:"addUniforms",value:function(r){this.uniforms=(0,ue.Z)((0,ue.Z)({},this.uniforms),this.extractUniforms(r))}},{key:"draw",value:function(r,n){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var t=(0,ue.Z)((0,ue.Z)({},this.uniforms),this.extractUniforms(r.uniforms||{})),a={};Object.keys(t).forEach(function(s){var l=(0,on.Z)(t[s]);l==="boolean"||l==="number"||Array.isArray(t[s])||t[s].BYTES_PER_ELEMENT?a[s]=t[s]:a[s]=t[s].get()}),n?this.drawPickCommand&&this.drawPickCommand(a):this.drawCommand(a)}}},{key:"destroy",value:function(){var r,n;(r=this.drawParams)===null||r===void 0||(n=r.elements)===null||n===void 0||n.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(t){t==null||t.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(r,n){var t=r.depth;t&&(n.depth={enable:t.enable===void 0?!0:!!t.enable,mask:t.mask===void 0?!0:!!t.mask,func:uB[t.func||Ve.LESS],range:t.range||[0,1]})}},{key:"initBlendDrawParams",value:function(r,n){var t=r.blend;if(t){var a=t.enable,s=t.func,l=t.equation,f=t.color,d=f===void 0?[0,0,0,0]:f;n.blend={enable:!!a,func:{srcRGB:Tb[s&&s.srcRGB||Ve.SRC_ALPHA],srcAlpha:Tb[s&&s.srcAlpha||Ve.SRC_ALPHA],dstRGB:Tb[s&&s.dstRGB||Ve.ONE_MINUS_SRC_ALPHA],dstAlpha:Tb[s&&s.dstAlpha||Ve.ONE_MINUS_SRC_ALPHA]},equation:{rgb:MM[l&&l.rgb||Ve.FUNC_ADD],alpha:MM[l&&l.alpha||Ve.FUNC_ADD]},color:d}}}},{key:"initStencilDrawParams",value:function(r,n){var t=r.stencil;if(t){var a=t.enable,s=t.mask,l=s===void 0?-1:s,f=t.func,d=f===void 0?{cmp:Ve.ALWAYS,ref:0,mask:-1}:f,S=t.opFront,O=S===void 0?{fail:Ve.KEEP,zfail:Ve.KEEP,zpass:Ve.KEEP}:S,Z=t.opBack,U=Z===void 0?{fail:Ve.KEEP,zfail:Ve.KEEP,zpass:Ve.KEEP}:Z;n.stencil={enable:!!a,mask:l,func:(0,ue.Z)((0,ue.Z)({},d),{},{cmp:lB[d.cmp]}),opFront:{fail:ny[O.fail],zfail:ny[O.zfail],zpass:ny[O.zpass]},opBack:{fail:ny[U.fail],zfail:ny[U.zfail],zpass:ny[U.zpass]}}}}},{key:"initCullDrawParams",value:function(r,n){var t=r.cull;if(t){var a=t.enable,s=t.face,l=s===void 0?Ve.BACK:s;n.cull={enable:!!a,face:cB[l]}}}},{key:"extractUniforms",value:function(r){var n=this,t={};return Object.keys(r).forEach(function(a){n.extractUniformsRecursively(a,r[a],t,"")}),t}},{key:"extractUniformsRecursively",value:function(r,n,t,a){var s=this;if(n===null||typeof n=="number"||typeof n=="boolean"||Array.isArray(n)&&typeof n[0]=="number"||(0,Kn.isTypedArray)(n)||n===""||"resize"in n){t["".concat(a&&a+".").concat(r)]=n;return}(0,Kn.isPlainObject)(n)&&Object.keys(n).forEach(function(l){s.extractUniformsRecursively(l,n[l],t,"".concat(a&&a+".").concat(r))}),Array.isArray(n)&&n.forEach(function(l,f){Object.keys(l).forEach(function(d){s.extractUniformsRecursively(d,l[d],t,"".concat(a&&a+".").concat(r,"[").concat(f,"]"))})})}}]),e}(),vB=function(){function e(i,r){(0,re.Z)(this,e),(0,V.Z)(this,"isDestroy",!1);var n=r.data,t=r.type,a=t===void 0?Ve.UNSIGNED_BYTE:t,s=r.width,l=r.height,f=r.flipY,d=f===void 0?!1:f,S=r.format,O=S===void 0?Ve.RGBA:S,Z=r.mipmap,U=Z===void 0?!1:Z,se=r.wrapS,le=se===void 0?Ve.CLAMP_TO_EDGE:se,ye=r.wrapT,Be=ye===void 0?Ve.CLAMP_TO_EDGE:ye,rt=r.aniso,Je=rt===void 0?0:rt,Ot=r.alignment,jt=Ot===void 0?1:Ot,dr=r.premultiplyAlpha,Lr=dr===void 0?!1:dr,jr=r.mag,Jr=jr===void 0?Ve.NEAREST:jr,Pn=r.min,In=Pn===void 0?Ve.NEAREST:Pn,Si=r.colorSpace,ra=Si===void 0?Ve.BROWSER_DEFAULT_WEBGL:Si,Va=r.x,Ms=Va===void 0?0:Va,vu=r.y,Bu=vu===void 0?0:vu,zl=r.copy,_l=zl===void 0?!1:zl;this.width=s,this.height=l;var _h={width:s,height:l,type:pS[a],format:aB[O],wrapS:TM[le],wrapT:TM[Be],mag:AM[Jr],min:AM[In],alignment:jt,flipY:d,colorSpace:sB[ra],premultiplyAlpha:Lr,aniso:Je,x:Ms,y:Bu,copy:_l};n&&(_h.data=n),typeof U=="number"?_h.mipmap=oB[U]:typeof U=="boolean"&&(_h.mipmap=U),this.texture=i.texture(_h)}return(0,he.Z)(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(r)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(r){var n=r.width,t=r.height;this.texture.resize(n,t),this.width=n,this.height=t}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy){var r;(r=this.texture)===null||r===void 0||r.destroy()}this.isDestroy=!0}}]),e}(),PM,OM,mB=(PM=(0,Xr.b2)(),PM(OM=function(){function e(){var i=this;(0,re.Z)(this,e),(0,V.Z)(this,"createModel",function(r){return new dB(i.gl,r)}),(0,V.Z)(this,"createAttribute",function(r){return new nB(i.gl,r)}),(0,V.Z)(this,"createBuffer",function(r){return new fB(i.gl,r)}),(0,V.Z)(this,"createElements",function(r){return new hB(i.gl,r)}),(0,V.Z)(this,"createTexture2D",function(r){return new vB(i.gl,r)}),(0,V.Z)(this,"createFramebuffer",function(r){return new pB(i.gl,r)}),(0,V.Z)(this,"useFramebuffer",function(r,n){i.gl({framebuffer:r?r.get():null})(n)}),(0,V.Z)(this,"clear",function(r){var n,t=r.color,a=r.depth,s=r.stencil,l=r.framebuffer,f=l===void 0?null:l,d={color:t,depth:a,stencil:s};d.framebuffer=f===null?f:f.get(),(n=i.gl)===null||n===void 0||n.clear(d)}),(0,V.Z)(this,"viewport",function(r){var n=r.x,t=r.y,a=r.width,s=r.height;i.gl._gl.viewport(n,t,a,s),i.width=a,i.height=s,i.gl._refresh()}),(0,V.Z)(this,"readPixels",function(r){var n=r.framebuffer,t=r.x,a=r.y,s=r.width,l=r.height,f={x:t,y:a,width:s,height:l};return n&&(f.framebuffer=n.get()),i.gl.read(f)}),(0,V.Z)(this,"getViewportSize",function(){return{width:i.gl._gl.drawingBufferWidth,height:i.gl._gl.drawingBufferHeight}}),(0,V.Z)(this,"getContainer",function(){if(zs)return i.canvas;var r;return(r=i.canvas)===null||r===void 0?void 0:r.parentElement}),(0,V.Z)(this,"getCanvas",function(){return i.canvas}),(0,V.Z)(this,"getGLContext",function(){return i.gl._gl}),(0,V.Z)(this,"destroy",function(){var r,n,t;i.canvas=null,(r=i.gl)===null||r===void 0||(n=r._gl)===null||n===void 0||(t=n.getExtension("WEBGL_lose_context"))===null||t===void 0||t.loseContext(),i.gl.destroy(),i.gl=null})}return(0,he.Z)(e,[{key:"init",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t,a,s){var l=this;return Ze().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.canvas=t,!s){d.next=5;break}this.gl=s,d.next=8;break;case 5:return d.next=7,new Promise(function(S,O){rB()({canvas:l.canvas,attributes:{alpha:!0,antialias:a.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:a.preserveDrawingBuffer,stencil:a.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:function(U,se){(U||!se)&&O(U),S(se)}})});case 7:this.gl=d.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return d.stop()}},n,this)}));function r(n,t,a){return i.apply(this,arguments)}return r}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(r){return!!this.getGLContext().getExtension(r)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var r=this.getGLContext();r.disable(r.CULL_FACE)}},{key:"setDirty",value:function(r){this.isDirty=r}},{key:"getDirty",value:function(){return this.isDirty}}]),e}())||OM);function gB(e){var i=yB();return function(){var n=(0,ot.Z)(e),t;if(i){var a=(0,ot.Z)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return(0,rr.Z)(this,t)}}function yB(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var dS=["selectstart","selecting","selectend"],_B=function(e){(0,Ft.Z)(r,e);var i=gB(r);function r(n){var t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,re.Z)(this,r),t=i.call(this),(0,V.Z)((0,ct.Z)(t),"isEnable",!1),(0,V.Z)((0,ct.Z)(t),"onDragStart",function(s){t.box.style.display="block",t.startEvent=t.endEvent=s,t.syncBoxBound(),t.emit("selectstart",t.getLngLatBox(),t.startEvent,t.endEvent)}),(0,V.Z)((0,ct.Z)(t),"onDragging",function(s){t.endEvent=s,t.syncBoxBound(),t.emit("selecting",t.getLngLatBox(),t.startEvent,t.endEvent)}),(0,V.Z)((0,ct.Z)(t),"onDragEnd",function(s){t.endEvent=s,t.box.style.display="none",t.emit("selectend",t.getLngLatBox(),t.startEvent,t.endEvent)}),t.scene=n,t.options=a,t}return(0,he.Z)(r,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var t=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var a=ss("div",void 0,this.container);a.classList.add("l7-select-box"),t&&a.classList.add(t),a.style.display="none",this.box=a}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var t=this.startEvent,a=t.x,s=t.y,l=this.endEvent,f=l.x,d=l.y,S=Math.min(a,f),O=Math.min(s,d),Z=Math.abs(a-f),U=Math.abs(s-d);this.box.style.top="".concat(O,"px"),this.box.style.left="".concat(S,"px"),this.box.style.width="".concat(Z,"px"),this.box.style.height="".concat(U,"px")}},{key:"getLngLatBox",value:function(){var t=this.startEvent.lngLat,a=t.lng,s=t.lat,l=this.endEvent.lngLat,f=l.lng,d=l.lat;return hl([[a,s],[f,d]])}}]),r}(Kc.EventEmitter),xB=function(){function e(i){(0,re.Z)(this,e);var r=i.id,n=i.map,t=i.canvas,a=i.hasBaseMap,s=Gy();this.container=s,n.setContainer(s,r,t,a),s.bind(Ir.IRendererService).to(mB).inSingletonScope(),this.sceneService=s.get(Ir.ISceneService),this.mapService=s.get(Ir.IMapService),this.iconService=s.get(Ir.IIconService),this.fontService=s.get(Ir.IFontService),this.controlService=s.get(Ir.IControlService),this.layerService=s.get(Ir.ILayerService),this.debugService=s.get(Ir.IDebugService),this.debugService.setEnable(i.debug),this.markerService=s.get(Ir.IMarkerService),this.interactionService=s.get(Ir.IInteractionService),this.popupService=s.get(Ir.IPopupService),this.boxSelect=new _B(this,{}),Ns((i==null?void 0:i.isMini)||!1),zs?this.sceneService.initMiniScene(i):(this.initComponent(r),this.sceneService.init(i),this.initControl())}return(0,he.Z)(e,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"getDebugService",value:function(){return this.debugService}},{key:"exportPng",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t){return Ze().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",this.sceneService.exportPng(t));case 1:case"end":return s.stop()}},n,this)}));function r(n){return i.apply(this,arguments)}return r}()},{key:"exportMap",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t){return Ze().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",this.sceneService.exportPng(t));case 1:case"end":return s.stop()}},n,this)}));function r(n){return i.apply(this,arguments)}return r}()},{key:"registerRenderService",value:function(r){var n=this;if(this.sceneService.loaded){var t=new r(this);t.init()}else this.on("loaded",function(){var a=new r(n);a.init()})}},{key:"setBgColor",value:function(r){this.mapService.setBgColor(r)}},{key:"addLayer",value:function(r){var n=this,t=Fm(this.container);if(r.setContainer(t,this.container),this.sceneService.addLayer(r),r.inited){var a=this.initMask(r);this.addMask(a,r.id)}else r.on("inited",function(){var s=n.initMask(r);n.addMask(s,r.id)})}},{key:"initMask",value:function(r){var n=r.getLayerConfig(),t=n.mask,a=n.maskfence,s=n.maskColor,l=s===void 0?"#000":s,f=n.maskOpacity,d=f===void 0?0:f;if(!(!t||!a)){var S=new Lx().source(a).shape("fill").style({color:l,opacity:d});return S}}},{key:"addMask",value:function(r,n){if(r){var t=this.getLayer(n);if(t){var a=Fm(this.container);r.setContainer(a,this.container),t.addMaskLayer(r),this.sceneService.addMask(r)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(r){return this.layerService.getLayer(r)}},{key:"getLayerByName",value:function(r){return this.layerService.getLayerByName(r)}},{key:"removeLayer",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t,a){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.layerService.remove(t,a);case 2:case"end":return l.stop()}},n,this)}));function r(n,t){return i.apply(this,arguments)}return r}()},{key:"removeAllLayer",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(){return Ze().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.layerService.removeAllLayers();case 2:case"end":return a.stop()}},n,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(r){this.layerService.setEnableRender(r)}},{key:"addIconFont",value:function(r,n){this.fontService.addIconFont(r,n)}},{key:"addIconFonts",value:function(r){var n=this;r.forEach(function(t){var a=(0,Ja.Z)(t,2),s=a[0],l=a[1];n.fontService.addIconFont(s,l)})}},{key:"addFontFace",value:function(r,n){var t=this;this.fontService.once("fontloaded",function(a){t.emit("fontloaded",a)}),this.fontService.addFontFace(r,n)}},{key:"addImage",value:function(){var i=(0,Dt.Z)(Ze().mark(function n(t,a){return Ze().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(zs){l.next=5;break}return l.next=3,this.iconService.addImage(t,a);case 3:l.next=6;break;case 5:this.iconService.addImageMini(t,a,this.sceneService);case 6:case"end":return l.stop()}},n,this)}));function r(n,t){return i.apply(this,arguments)}return r}()},{key:"hasImage",value:function(r){return this.iconService.hasImage(r)}},{key:"removeImage",value:function(r){this.iconService.removeImage(r)}},{key:"addIconFontGlyphs",value:function(r,n){this.fontService.addIconGlyphs(n)}},{key:"addControl",value:function(r){this.controlService.addControl(r,this.container)}},{key:"removeControl",value:function(r){this.controlService.removeControl(r)}},{key:"getControlByName",value:function(r){return this.controlService.getControlByName(r)}},{key:"addMarker",value:function(r){this.markerService.addMarker(r)}},{key:"addMarkerLayer",value:function(r){this.markerService.addMarkerLayer(r)}},{key:"removeMarkerLayer",value:function(r){this.markerService.removeMarkerLayer(r)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(r){this.popupService.addPopup(r)}},{key:"removePopup",value:function(r){this.popupService.removePopup(r)}},{key:"on",value:function(r,n){if(dS.includes(r)){var t;(t=this.boxSelect)===null||t===void 0||t.on(r,n)}else zm.includes(r)?this.sceneService.on(r,n):this.mapService.on(r,n)}},{key:"once",value:function(r,n){if(dS.includes(r)){var t;(t=this.boxSelect)===null||t===void 0||t.once(r,n)}else zm.includes(r)?this.sceneService.once(r,n):this.mapService.once(r,n)}},{key:"emit",value:function(r,n){zm.indexOf(r)===-1?this.mapService.on(r,n):this.sceneService.emit(r,n)}},{key:"off",value:function(r,n){if(dS.includes(r)){var t;(t=this.boxSelect)===null||t===void 0||t.off(r,n)}else zm.includes(r)?this.sceneService.off(r,n):this.mapService.off(r,n)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(r){return this.mapService.getCenter(r)}},{key:"setCenter",value:function(r,n){return this.mapService.setCenter(r,n)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(r){return this.mapService.setPitch(r)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(r){this.mapService.setRotation(r)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(r){this.mapService.panTo(r)}},{key:"panBy",value:function(r,n){this.mapService.panBy(r,n)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(r){this.mapService.setZoom(r)}},{key:"fitBounds",value:function(r,n){var t=this.sceneService.getSceneConfig(),a=t.fitBoundsOptions,s=t.animate;this.mapService.fitBounds(r,n||(0,ue.Z)((0,ue.Z)({},a),{},{animate:s}))}},{key:"setZoomAndCenter",value:function(r,n){this.mapService.setZoomAndCenter(r,n)}},{key:"setMapStyle",value:function(r){this.mapService.setMapStyle(r)}},{key:"setMapStatus",value:function(r){this.mapService.setMapStatus(r)}},{key:"pixelToLngLat",value:function(r){return this.mapService.pixelToLngLat(r)}},{key:"lngLatToPixel",value:function(r){return this.mapService.lngLatToPixel(r)}},{key:"containerToLngLat",value:function(r){return this.mapService.containerToLngLat(r)}},{key:"lngLatToContainer",value:function(r){return this.mapService.lngLatToContainer(r)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(r,n){this.container.bind(Ir.IPostProcessingPass).to(r).whenTargetNamed(n)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),n&&this.boxSelect.once("selectend",function(){r.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(r){this.controlService.init({container:Wc(r)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var r=this.sceneService.getSceneConfig(),n=r.logoVisible,t=r.logoPosition;n&&this.addControl(new wl({position:t}))}}]),e}(),bB="2.13.9"},25742:function(Ne,fe,I){"use strict";I.d(fe,{Co:function(){return uy},$2:function(){return Nu},Kh:function(){return f2},w3:function(){return K1}});var D=I(34789),k=I(67294),m=I(18446),ae=I.n(m);const F=(v=[],x=[])=>ae()(v,x);var W=(v=>(x,w)=>{const X=(0,k.useRef)(),Ee=(0,k.useRef)(0);(w===void 0||!F(w,X.current))&&(X.current=w,Ee.current+=1),v(x,[Ee.current])})(k.useEffect),Y=I(94184),G=I.n(Y),$=typeof global=="object"&&global&&global.Object===Object&&global,xe=$,Fe=typeof self=="object"&&self&&self.Object===Object&&self,Ce=xe||Fe||Function("return this")(),We=Ce,me=We.Symbol,Ge=me,Ke=Object.prototype,pt=Ke.hasOwnProperty,Xe=Ke.toString,gt=Ge?Ge.toStringTag:void 0;function ie(v){var x=pt.call(v,gt),w=v[gt];try{v[gt]=void 0;var X=!0}catch(je){}var Ee=Xe.call(v);return X&&(x?v[gt]=w:delete v[gt]),Ee}var ft=ie,ve=Object.prototype,Ae=ve.toString;function Re(v){return Ae.call(v)}var Ye=Re,at="[object Null]",ht="[object Undefined]",Se=Ge?Ge.toStringTag:void 0;function Qe(v){return v==null?v===void 0?ht:at:Se&&Se in Object(v)?ft(v):Ye(v)}var oe=Qe;function ue(v){return v!=null&&typeof v=="object"}var be=ue,vt="[object Number]";function bt(v){return typeof v=="number"||be(v)&&oe(v)==vt}var Ht=bt,Er="*",Vt=function(){function v(){this._events={}}return v.prototype.on=function(x,w,X){return this._events[x]||(this._events[x]=[]),this._events[x].push({callback:w,once:!!X}),this},v.prototype.once=function(x,w){return this.on(x,w,!0)},v.prototype.emit=function(x){for(var w=this,X=[],Ee=1;Ee<arguments.length;Ee++)X[Ee-1]=arguments[Ee];var je=this._events[x]||[],dt=this._events[Er]||[],Ct=function(qt){for(var kr=qt.length,Cn=0;Cn<kr;Cn++)if(qt[Cn]){var Di=qt[Cn],Ma=Di.callback,uo=Di.once;uo&&(qt.splice(Cn,1),qt.length===0&&delete w._events[x],kr--,Cn--),Ma.apply(w,X)}};Ct(je),Ct(dt)},v.prototype.off=function(x,w){if(!x)this._events={};else if(!w)delete this._events[x];else{for(var X=this._events[x]||[],Ee=X.length,je=0;je<Ee;je++)X[je].callback===w&&(X.splice(je,1),Ee--,je--);X.length===0&&delete this._events[x]}return this},v.prototype.getEvents=function(){return this._events},v}(),on=Vt;function hn(v){return hn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},hn(v)}function gi(v,x){var w=typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(!w){if(Array.isArray(v)||(w=Hn(v))||x&&v&&typeof v.length=="number"){w&&(v=w);var X=0,Ee=function(){};return{s:Ee,n:function(){return X>=v.length?{done:!0}:{done:!1,value:v[X++]}},e:function(kr){throw kr},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var je=!0,dt=!1,Ct;return{s:function(){w=w.call(v)},n:function(){var kr=w.next();return je=kr.done,kr},e:function(kr){dt=!0,Ct=kr},f:function(){try{!je&&w.return!=null&&w.return()}finally{if(dt)throw Ct}}}}function Hn(v,x){if(v){if(typeof v=="string")return Dt(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return Dt(v,x)}}function Dt(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function Ea(v,x){if(!(v instanceof x))throw new TypeError("Cannot call a class as a function")}function Ze(v,x){for(var w=0;w<x.length;w++){var X=x[w];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(v,Pr(X.key),X)}}function ci(v,x,w){return x&&Ze(v.prototype,x),w&&Ze(v,w),Object.defineProperty(v,"prototype",{writable:!1}),v}function Ci(v,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(x&&x.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),Object.defineProperty(v,"prototype",{writable:!1}),x&&Oi(v,x)}function Oi(v,x){return Oi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(X,Ee){return X.__proto__=Ee,X},Oi(v,x)}function ea(v){var x=da();return function(){var X=Ii(v),Ee;if(x){var je=Ii(this).constructor;Ee=Reflect.construct(X,arguments,je)}else Ee=X.apply(this,arguments);return fn(this,Ee)}}function fn(v,x){if(x&&(hn(x)==="object"||typeof x=="function"))return x;if(x!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tn(v)}function tn(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function da(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(v){return!1}}function Ii(v){return Ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(w){return w.__proto__||Object.getPrototypeOf(w)},Ii(v)}function Ai(v,x,w){return x=Pr(x),x in v?Object.defineProperty(v,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[x]=w,v}function Pr(v){var x=nt(v,"string");return hn(x)==="symbol"?x:String(x)}function nt(v,x){if(hn(v)!=="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var X=w.call(v,x||"default");if(hn(X)!=="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}var it=0,_t=function(v){Ci(w,v);var x=ea(w);function w(X){var Ee;return Ea(this,w),Ee=x.call(this),Ai(tn(Ee),"scene",void 0),Ai(tn(Ee),"options",void 0),Ai(tn(Ee),"layerMap",new Map),Ee.scene=X.scene,Ee.options=X,Ee}return ci(w,[{key:"hasLayer",value:function(Ee){return this.layerMap.has(Ee)}},{key:"addLayer",value:function(Ee){var je=this.getLayerId(Ee);this.layerMap.set(je,Ee),Ee.addTo(this.scene),this.emit("add",Ee)}},{key:"addLayers",value:function(Ee){var je=this;Ee.forEach(function(dt){je.addLayer(dt)})}},{key:"removeLayer",value:function(Ee){var je=typeof Ee=="string"?Ee:this.getLayerId(Ee),dt=this.layerMap.get(je);return dt?(this.layerMap.delete(je),dt.remove(),this.emit("remove",je),!0):!1}},{key:"getLayers",value:function(){return Array.from(this.layerMap.values())}},{key:"getLayerById",value:function(Ee){return this.layerMap.get(Ee)}},{key:"getLayer",value:function(Ee){return this.getLayerById(Ee)}},{key:"removeAllLayer",value:function(){var Ee=gi(this.layerMap.values()),je;try{for(Ee.s();!(je=Ee.n()).done;){var dt=je.value;dt.remove()}}catch(Ct){Ee.e(Ct)}finally{Ee.f()}this.layerMap.clear()}},{key:"isEmpty",value:function(){return this.layerMap.size===0}},{key:"getLayerId",value:function(Ee){return"id"in Ee?Ee.id:"".concat(it++)}},{key:"destroy",value:function(){this.removeAllLayer()}}]),w}(on);function we(v,x,w,X){var Ee=-1,je=v==null?0:v.length;for(X&&je&&(w=v[++Ee]);++Ee<je;)w=x(w,v[Ee],Ee,v);return w}var er=we;function $r(v){return function(x){return v==null?void 0:v[x]}}var Fn=$r,Qt={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Br=Fn(Qt),bn=Br;function gr(v,x){for(var w=-1,X=v==null?0:v.length,Ee=Array(X);++w<X;)Ee[w]=x(v[w],w,v);return Ee}var pn=gr,Sn=Array.isArray,Dn=Sn,ui="[object Symbol]";function di(v){return typeof v=="symbol"||be(v)&&oe(v)==ui}var ca=di,Ni=1/0,Wa=Ge?Ge.prototype:void 0,Ba=Wa?Wa.toString:void 0;function Ia(v){if(typeof v=="string")return v;if(Dn(v))return pn(v,Ia)+"";if(ca(v))return Ba?Ba.call(v):"";var x=v+"";return x=="0"&&1/v==-Ni?"-0":x}var an=Ia;function Ln(v){return v==null?"":an(v)}var re=Ln,he=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,V="\\u0300-\\u036f",Et="\\ufe20-\\ufe2f",Bt="\\u20d0-\\u20ff",Le=V+Et+Bt,St="["+Le+"]",tt=RegExp(St,"g");function At(v){return v=re(v),v&&v.replace(he,bn).replace(tt,"")}var tr=At,en=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Kr(v){return v.match(en)||[]}var Ft=Kr,rr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function ot(v){return rr.test(v)}var Li=ot,Hr="\\ud800-\\udfff",_i="\\u0300-\\u036f",vi="\\ufe20-\\ufe2f",It="\\u20d0-\\u20ff",Yr=_i+vi+It,Dr="\\u2700-\\u27bf",Jn="a-z\\xdf-\\xf6\\xf8-\\xff",Kt="\\xac\\xb1\\xd7\\xf7",hr="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Fr="\\u2000-\\u206f",qr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",An="A-Z\\xc0-\\xd6\\xd8-\\xde",Ui="\\ufe0e\\ufe0f",fa=Kt+hr+Fr+qr,Wi="['\u2019]",ct="["+fa+"]",qi="["+Yr+"]",Na="\\d+",To="["+Dr+"]",ao="["+Jn+"]",Ga="[^"+Hr+fa+Na+Dr+Jn+An+"]",Ko="\\ud83c[\\udffb-\\udfff]",ws="(?:"+qi+"|"+Ko+")",Fo="[^"+Hr+"]",su="(?:\\ud83c[\\udde6-\\uddff]){2}",zo="[\\ud800-\\udbff][\\udc00-\\udfff]",ns="["+An+"]",ls="\\u200d",_o="(?:"+ao+"|"+Ga+")",Po="(?:"+ns+"|"+Ga+")",Ss="(?:"+Wi+"(?:d|ll|m|re|s|t|ve))?",Wu="(?:"+Wi+"(?:D|LL|M|RE|S|T|VE))?",$s=ws+"?",uu="["+Ui+"]?",Jo="(?:"+ls+"(?:"+[Fo,su,zo].join("|")+")"+uu+$s+")*",ms="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",eu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Bs=uu+$s+Jo,fi="(?:"+[To,su,zo].join("|")+")"+Bs,is=RegExp([ns+"?"+ao+"+"+Ss+"(?="+[ct,ns,"$"].join("|")+")",Po+"+"+Wu+"(?="+[ct,ns+_o,"$"].join("|")+")",ns+"?"+_o+"+"+Ss,ns+"+"+Wu,eu,ms,Na,fi].join("|"),"g");function ku(v){return v.match(is)||[]}var mt=ku;function Gt(v,x,w){return v=re(v),x=w?void 0:x,x===void 0?Li(v)?mt(v):Ft(v):v.match(x)||[]}var Cr=Gt,Rr="['\u2019]",ji=RegExp(Rr,"g");function Pa(v){return function(x){return er(Cr(tr(x).replace(ji,"")),v,"")}}var Yt=Pa,De=Yt(function(v,x,w){return v+(w?"-":"")+x.toLowerCase()}),Me=De;function ce(v,x){return $t(v)||Mt(v,x)||Pe(v,x)||He()}function He(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pe(v,x){if(v){if(typeof v=="string")return Tt(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return Tt(v,x)}}function Tt(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function Mt(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function $t(v){if(Array.isArray(v))return v}var fr=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.entries(x!=null?x:{}).map(function(w){var X=ce(w,2),Ee=X[0],je=X[1],dt=Me(Ee),Ct=je;return typeof Ct=="number"?Ct="".concat(Ct,"px"):typeof Ct=="string"&&(Ct=Ct.replace("'","")),"".concat(dt," :").concat(Ct)}).join("; ")};function Tr(v){return Tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},Tr(v)}function Sr(){"use strict";Sr=function(){return v};var v={},x=Object.prototype,w=x.hasOwnProperty,X=Object.defineProperty||function(ni,En,Zn){ni[En]=Zn.value},Ee=typeof Symbol=="function"?Symbol:{},je=Ee.iterator||"@@iterator",dt=Ee.asyncIterator||"@@asyncIterator",Ct=Ee.toStringTag||"@@toStringTag";function qt(ni,En,Zn){return Object.defineProperty(ni,En,{value:Zn,enumerable:!0,configurable:!0,writable:!0}),ni[En]}try{qt({},"")}catch(ni){qt=function(Zn,la,ja){return Zn[la]=ja}}function kr(ni,En,Zn,la){var ja=En&&En.prototype instanceof Ma?En:Ma,Fa=Object.create(ja.prototype),ru=new Is(la||[]);return X(Fa,"_invoke",{value:Su(ni,Zn,ru)}),Fa}function Cn(ni,En,Zn){try{return{type:"normal",arg:ni.call(En,Zn)}}catch(la){return{type:"throw",arg:la}}}v.wrap=kr;var Di={};function Ma(){}function uo(){}function Ka(){}var Oa={};qt(Oa,je,function(){return this});var fo=Object.getPrototypeOf,Ao=fo&&fo(fo(Gs([])));Ao&&Ao!==x&&w.call(Ao,je)&&(Oa=Ao);var mo=Ka.prototype=Ma.prototype=Object.create(Oa);function Os(ni){["next","throw","return"].forEach(function(En){qt(ni,En,function(Zn){return this._invoke(En,Zn)})})}function au(ni,En){function Zn(ja,Fa,ru,dl){var Ll=Cn(ni[ja],ni,Fa);if(Ll.type!=="throw"){var Rh=Ll.arg,ff=Rh.value;return ff&&Tr(ff)=="object"&&w.call(ff,"__await")?En.resolve(ff.__await).then(function(kh){Zn("next",kh,ru,dl)},function(kh){Zn("throw",kh,ru,dl)}):En.resolve(ff).then(function(kh){Rh.value=kh,ru(Rh)},function(kh){return Zn("throw",kh,ru,dl)})}dl(Ll.arg)}var la;X(this,"_invoke",{value:function(Fa,ru){function dl(){return new En(function(Ll,Rh){Zn(Fa,ru,Ll,Rh)})}return la=la?la.then(dl,dl):dl()}})}function Su(ni,En,Zn){var la="suspendedStart";return function(ja,Fa){if(la==="executing")throw new Error("Generator is already running");if(la==="completed"){if(ja==="throw")throw Fa;return fl()}for(Zn.method=ja,Zn.arg=Fa;;){var ru=Zn.delegate;if(ru){var dl=wl(ru,Zn);if(dl){if(dl===Di)continue;return dl}}if(Zn.method==="next")Zn.sent=Zn._sent=Zn.arg;else if(Zn.method==="throw"){if(la==="suspendedStart")throw la="completed",Zn.arg;Zn.dispatchException(Zn.arg)}else Zn.method==="return"&&Zn.abrupt("return",Zn.arg);la="executing";var Ll=Cn(ni,En,Zn);if(Ll.type==="normal"){if(la=Zn.done?"completed":"suspendedYield",Ll.arg===Di)continue;return{value:Ll.arg,done:Zn.done}}Ll.type==="throw"&&(la="completed",Zn.method="throw",Zn.arg=Ll.arg)}}}function wl(ni,En){var Zn=En.method,la=ni.iterator[Zn];if(la===void 0)return En.delegate=null,Zn==="throw"&&ni.iterator.return&&(En.method="return",En.arg=void 0,wl(ni,En),En.method==="throw")||Zn!=="return"&&(En.method="throw",En.arg=new TypeError("The iterator does not provide a '"+Zn+"' method")),Di;var ja=Cn(la,ni.iterator,En.arg);if(ja.type==="throw")return En.method="throw",En.arg=ja.arg,En.delegate=null,Di;var Fa=ja.arg;return Fa?Fa.done?(En[ni.resultName]=Fa.value,En.next=ni.nextLoc,En.method!=="return"&&(En.method="next",En.arg=void 0),En.delegate=null,Di):Fa:(En.method="throw",En.arg=new TypeError("iterator result is not an object"),En.delegate=null,Di)}function Us(ni){var En={tryLoc:ni[0]};1 in ni&&(En.catchLoc=ni[1]),2 in ni&&(En.finallyLoc=ni[2],En.afterLoc=ni[3]),this.tryEntries.push(En)}function du(ni){var En=ni.completion||{};En.type="normal",delete En.arg,ni.completion=En}function Is(ni){this.tryEntries=[{tryLoc:"root"}],ni.forEach(Us,this),this.reset(!0)}function Gs(ni){if(ni){var En=ni[je];if(En)return En.call(ni);if(typeof ni.next=="function")return ni;if(!isNaN(ni.length)){var Zn=-1,la=function ja(){for(;++Zn<ni.length;)if(w.call(ni,Zn))return ja.value=ni[Zn],ja.done=!1,ja;return ja.value=void 0,ja.done=!0,ja};return la.next=la}}return{next:fl}}function fl(){return{value:void 0,done:!0}}return uo.prototype=Ka,X(mo,"constructor",{value:Ka,configurable:!0}),X(Ka,"constructor",{value:uo,configurable:!0}),uo.displayName=qt(Ka,Ct,"GeneratorFunction"),v.isGeneratorFunction=function(ni){var En=typeof ni=="function"&&ni.constructor;return!!En&&(En===uo||(En.displayName||En.name)==="GeneratorFunction")},v.mark=function(ni){return Object.setPrototypeOf?Object.setPrototypeOf(ni,Ka):(ni.__proto__=Ka,qt(ni,Ct,"GeneratorFunction")),ni.prototype=Object.create(mo),ni},v.awrap=function(ni){return{__await:ni}},Os(au.prototype),qt(au.prototype,dt,function(){return this}),v.AsyncIterator=au,v.async=function(ni,En,Zn,la,ja){ja===void 0&&(ja=Promise);var Fa=new au(kr(ni,En,Zn,la),ja);return v.isGeneratorFunction(En)?Fa:Fa.next().then(function(ru){return ru.done?ru.value:Fa.next()})},Os(mo),qt(mo,Ct,"Generator"),qt(mo,je,function(){return this}),qt(mo,"toString",function(){return"[object Generator]"}),v.keys=function(ni){var En=Object(ni),Zn=[];for(var la in En)Zn.push(la);return Zn.reverse(),function ja(){for(;Zn.length;){var Fa=Zn.pop();if(Fa in En)return ja.value=Fa,ja.done=!1,ja}return ja.done=!0,ja}},v.values=Gs,Is.prototype={constructor:Is,reset:function(En){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(du),!En)for(var Zn in this)Zn.charAt(0)==="t"&&w.call(this,Zn)&&!isNaN(+Zn.slice(1))&&(this[Zn]=void 0)},stop:function(){this.done=!0;var En=this.tryEntries[0].completion;if(En.type==="throw")throw En.arg;return this.rval},dispatchException:function(En){if(this.done)throw En;var Zn=this;function la(Rh,ff){return ru.type="throw",ru.arg=En,Zn.next=Rh,ff&&(Zn.method="next",Zn.arg=void 0),!!ff}for(var ja=this.tryEntries.length-1;ja>=0;--ja){var Fa=this.tryEntries[ja],ru=Fa.completion;if(Fa.tryLoc==="root")return la("end");if(Fa.tryLoc<=this.prev){var dl=w.call(Fa,"catchLoc"),Ll=w.call(Fa,"finallyLoc");if(dl&&Ll){if(this.prev<Fa.catchLoc)return la(Fa.catchLoc,!0);if(this.prev<Fa.finallyLoc)return la(Fa.finallyLoc)}else if(dl){if(this.prev<Fa.catchLoc)return la(Fa.catchLoc,!0)}else{if(!Ll)throw new Error("try statement without catch or finally");if(this.prev<Fa.finallyLoc)return la(Fa.finallyLoc)}}}},abrupt:function(En,Zn){for(var la=this.tryEntries.length-1;la>=0;--la){var ja=this.tryEntries[la];if(ja.tryLoc<=this.prev&&w.call(ja,"finallyLoc")&&this.prev<ja.finallyLoc){var Fa=ja;break}}Fa&&(En==="break"||En==="continue")&&Fa.tryLoc<=Zn&&Zn<=Fa.finallyLoc&&(Fa=null);var ru=Fa?Fa.completion:{};return ru.type=En,ru.arg=Zn,Fa?(this.method="next",this.next=Fa.finallyLoc,Di):this.complete(ru)},complete:function(En,Zn){if(En.type==="throw")throw En.arg;return En.type==="break"||En.type==="continue"?this.next=En.arg:En.type==="return"?(this.rval=this.arg=En.arg,this.method="return",this.next="end"):En.type==="normal"&&Zn&&(this.next=Zn),Di},finish:function(En){for(var Zn=this.tryEntries.length-1;Zn>=0;--Zn){var la=this.tryEntries[Zn];if(la.finallyLoc===En)return this.complete(la.completion,la.afterLoc),du(la),Di}},catch:function(En){for(var Zn=this.tryEntries.length-1;Zn>=0;--Zn){var la=this.tryEntries[Zn];if(la.tryLoc===En){var ja=la.completion;if(ja.type==="throw"){var Fa=ja.arg;du(la)}return Fa}}throw new Error("illegal catch attempt")},delegateYield:function(En,Zn,la){return this.delegate={iterator:Gs(En),resultName:Zn,nextLoc:la},this.method==="next"&&(this.arg=void 0),Di}},v}function sn(v,x,w,X,Ee,je,dt){try{var Ct=v[je](dt),qt=Ct.value}catch(kr){w(kr);return}Ct.done?x(qt):Promise.resolve(qt).then(X,Ee)}function lt(v){return function(){var x=this,w=arguments;return new Promise(function(X,Ee){var je=v.apply(x,w);function dt(qt){sn(je,X,Ee,dt,Ct,"next",qt)}function Ct(qt){sn(je,X,Ee,dt,Ct,"throw",qt)}dt(void 0)})}}var Xt=function(){var v=lt(Sr().mark(function x(w,X){return Sr().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:if(w!=="Map"){je.next=2;break}return je.abrupt("return",new D.Map(X));case 2:if(w!=="Gaode"){je.next=6;break}return je.abrupt("return",new D.GaodeMap(X));case 6:if(w!=="GaodeV1"){je.next=10;break}return je.abrupt("return",new D.GaodeMapV1(X));case 10:if(w!=="GaodeV2"){je.next=12;break}return je.abrupt("return",new D.GaodeMapV2(X));case 12:return je.abrupt("return",Promise.resolve(Promise.resolve().then(I.bind(I,34789))).then(function(dt){var Ct=dt.Mapbox;return new Ct(X)}));case 13:case"end":return je.stop()}},x)}));return function(w,X){return v.apply(this,arguments)}}();const nr=(v,x)=>v?v.map((w,X)=>Object.is(v[X],x==null?void 0:x[X])?-1:X).filter(w=>w>=0):x?x.map((w,X)=>X):[];var Vr=(v,x)=>{const w=(0,k.useRef)();(0,k.useEffect)(()=>{const X=nr(w.current,x),Ee=w.current;return w.current=x,v(X,Ee,x)},x)};function ln(v){const x=(0,k.useRef)(v);return x.current=v,x}var Un=ln;const Gn=v=>v!==null&&typeof v=="object",qn=v=>typeof v=="function",oi=v=>typeof v=="string",T=v=>typeof v=="boolean",H=v=>typeof v=="number",_e=v=>typeof v=="undefined";var $e=!1,zt=v=>{$e&&(qn(v)||console.error(`useUnmount expected parameter is a function, got ${typeof v}`));const x=Un(v);(0,k.useEffect)(()=>()=>{x.current()},[])},_r={onLoaded:"loaded",onDestroy:"destroy",onResize:"resize",onMapMove:"mapmove",onMoveStart:"movestart",onMoveEnd:"moveend",onZoomChange:"zoomchange",onZoomStart:"zoomstart",onZoomEnd:"zoomend",onClick:"click",onDblclick:"dblclick",onContextMenu:"contextmenu",onMouseMove:"mousemove",onMouseWheel:"mousewheel",onMouseDown:"mousedown",onMouseOver:"mouseover",onMouseOut:"mouseout",onMouseUp:"mouseup",onDragStart:"dragstart",onDragging:"dragging",onDragEnd:"dragend"},xr=Object.keys(_r);function dn(v){return Ei(v)||Vi(v)||zi(v)||Bn()}function Bn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zi(v,x){if(v){if(typeof v=="string")return qa(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return qa(v,x)}}function Vi(v){if(typeof Symbol!="undefined"&&v[Symbol.iterator]!=null||v["@@iterator"]!=null)return Array.from(v)}function Ei(v){if(Array.isArray(v))return qa(v)}function qa(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}var $a=function(x,w){Vr(function(X){var Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],je=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(x){var dt=X.filter(function(Ct){return!!Ct}).map(function(Ct){return Ct-1});X.includes(0)&&(dt=xr.map(function(Ct,qt){return qt})),dt.forEach(function(Ct){var qt=_r[xr[Ct]],kr=Ee[Ct+1],Cn=je[Ct+1];kr&&x.off(qt,kr),Cn&&x.on(qt,Cn)})}},[x].concat(dn(xr.map(function(X){return w[X]})))),zt(function(){x&&xr.forEach(function(X){var Ee=_r[X],je=w[X];Ee&&je&&x.off(Ee,je)})})};function La(v){return La=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},La(v)}var to=["id","style","className","map","mapType","mapOptions","onLayerManagerCreated","onSceneLoaded","children"];function Ho(v,x){var w=Object.keys(v);if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(v);x&&(X=X.filter(function(Ee){return Object.getOwnPropertyDescriptor(v,Ee).enumerable})),w.push.apply(w,X)}return w}function xo(v){for(var x=1;x<arguments.length;x++){var w=arguments[x]!=null?arguments[x]:{};x%2?Ho(Object(w),!0).forEach(function(X){bo(v,X,w[X])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(w)):Ho(Object(w)).forEach(function(X){Object.defineProperty(v,X,Object.getOwnPropertyDescriptor(w,X))})}return v}function bo(v,x,w){return x=so(x),x in v?Object.defineProperty(v,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[x]=w,v}function so(v){var x=Cs(v,"string");return La(x)==="symbol"?x:String(x)}function Cs(v,x){if(La(v)!=="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var X=w.call(v,x||"default");if(La(X)!=="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}function Ls(v,x){return zu(v)||Go(v,x)||lu(v,x)||Rs()}function Rs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lu(v,x){if(v){if(typeof v=="string")return ps(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return ps(v,x)}}function ps(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function Go(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function zu(v){if(Array.isArray(v))return v}function al(v,x){if(v==null)return{};var w=ou(v,x),X,Ee;if(Object.getOwnPropertySymbols){var je=Object.getOwnPropertySymbols(v);for(Ee=0;Ee<je.length;Ee++)X=je[Ee],!(x.indexOf(X)>=0)&&Object.prototype.propertyIsEnumerable.call(v,X)&&(w[X]=v[X])}return w}function ou(v,x){if(v==null)return{};var w={},X=Object.keys(v),Ee,je;for(je=0;je<X.length;je++)Ee=X[je],!(x.indexOf(Ee)>=0)&&(w[Ee]=v[Ee]);return w}var Xu=k.createContext(null),Nu=(0,k.memo)((0,k.forwardRef)(function(x,w){var X=x.id,Ee=x.style,je=x.className,dt=x.map,Ct=x.mapType,qt=Ct===void 0?"Gaode":Ct,kr=x.mapOptions,Cn=kr===void 0?{}:kr,Di=x.onLayerManagerCreated,Ma=x.onSceneLoaded,uo=x.children,Ka=al(x,to),Oa=(0,k.useRef)(),fo=(0,k.useState)(null),Ao=Ls(fo,2),mo=Ao[0],Os=Ao[1],au=(0,k.useRef)({scene:null,layerManager:null}),Su=au.current;(0,k.useEffect)(function(){var Us,du=!0;return Promise.resolve(dt||Xt(qt,Cn)).then(function(Is){if(du){Us=new D.Scene(xo(xo({},Ka),{},{id:Oa.current,map:Is}));var Gs=new _t({scene:Us});Su.scene=Us,Su.layerManager=Gs,Us.once("loaded",function(){Ma&&Ma(Us),Di&&Di(Gs),Os(Us)})}}).catch(function(Is){console.error(Is)}),function(){du=!1,Us&&(Su.scene=null,Su.layerManager=null,Us.destroy())}},[]),$a(mo,x),(0,k.useImperativeHandle)(w,function(){return{getScene:function(){return mo},getMap:function(){return mo.map}}},[mo]),(0,k.useEffect)(function(){mo&&Cn.style&&mo.setMapStyle(Cn.style)},[Cn.style]),(0,k.useEffect)(function(){mo&&Ht(Cn.zoom)&&mo.setZoom(Cn.zoom)},[Cn.zoom]),W(function(){mo&&Cn.center&&mo.setCenter(Cn.center)},[Cn.center]),(0,k.useEffect)(function(){mo&&Ht(Cn.pitch)&&mo.setPitch(Cn.pitch)},[Cn.pitch]),(0,k.useEffect)(function(){mo&&Ht(Cn.rotation)&&mo.setRotation(Cn.rotation)},[Cn.rotation]);var wl=(0,k.useMemo)(function(){return xo({position:"relative"},Ee)},[Ee]);return k.createElement("div",{id:X,ref:Oa,style:wl,className:G()("larkmap",je)},mo&&k.createElement(Xu.Provider,{value:Su},uo))}));const ks=v=>(x,w)=>{const X=(0,k.useRef)(!1);v(()=>()=>{X.current=!1},[]),v(()=>{if(!X.current)X.current=!0;else return x()},w)};var Sc=null,vl=ks(k.useEffect),es=function(){var x=(0,k.useContext)(Xu);if(!x)throw new Error("The useScene must be used in the LarkMap container");var w=x.scene;return w},Al=function(x,w,X){var Ee=es(),je=(0,k.useRef)();(0,k.useEffect)(function(){var dt=new D.Control(X);return dt.onAdd=function(){return x(Ee)},dt.onRemove=function(){},je.current=dt,Ee.addControl(dt),function(){typeof w=="function"&&w(Ee),je.current=null,Ee.removeControl(dt)}},[]),vl(function(){var dt;(dt=je.current)===null||dt===void 0||dt.setOptions(X)},[X])},tf=function(){var x=(0,k.useContext)(Xu);if(!x)throw new Error("The useLayerManager must be used in the LarkMap container");var w=x.layerManager;return w};function Zl(v,x){return rf(v)||Cu(v,x)||pf(v,x)||uc()}function uc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pf(v,x){if(v){if(typeof v=="string")return ql(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return ql(v,x)}}function ql(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function Cu(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function rf(v){if(Array.isArray(v))return v}var ol=function(x){var w=useLayerManager(),X=useState(w.getLayer(x)),Ee=Zl(X,2),je=Ee[0],dt=Ee[1];return useEffect(function(){var Ct=function(Di){x===Di.id&&dt(Di)},qt=function(Di){x===Di&&dt(void 0)},kr=w.getLayer(x);return kr?dt(kr):(w.on("add",Ct),w.on("remove",qt)),function(){kr===void 0&&(w.off("add",Ct),w.off("remove",qt))}},[x]),je};function as(v,x){return xl(v)||Ml(v,x)||Tl(v,x)||Ds()}function Ds(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tl(v,x){if(v){if(typeof v=="string")return Yu(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return Yu(v,x)}}function Yu(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function Ml(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function xl(v){if(Array.isArray(v))return v}var nf=function(){var x=tf(),w=(0,k.useState)((x==null?void 0:x.getLayers())||[]),X=as(w,2),Ee=X[0],je=X[1];return(0,k.useEffect)(function(){if(x){var dt=function(){je(x.getLayers())};return x.on("add",dt),x.on("remove",dt),function(){x.off("add",dt),x.off("remove",dt)}}},[x]),Ee};function Vc(){this.__data__=[],this.size=0}var Zf=Vc;function Hc(v,x){return v===x||v!==v&&x!==x}var Ql=Hc;function sl(v,x){for(var w=v.length;w--;)if(Ql(v[w][0],x))return w;return-1}var vc=sl,Jl=Array.prototype,ts=Jl.splice;function gs(v){var x=this.__data__,w=vc(x,v);if(w<0)return!1;var X=x.length-1;return w==X?x.pop():ts.call(x,w,1),--this.size,!0}var $o=gs;function ds(v){var x=this.__data__,w=vc(x,v);return w<0?void 0:x[w][1]}var Ns=ds;function Mu(v){return vc(this.__data__,v)>-1}var ec=Mu;function zs(v,x){var w=this.__data__,X=vc(w,v);return X<0?(++this.size,w.push([v,x])):w[X][1]=x,this}var df=zs;function ha(v){var x=-1,w=v==null?0:v.length;for(this.clear();++x<w;){var X=v[x];this.set(X[0],X[1])}}ha.prototype.clear=Zf,ha.prototype.delete=$o,ha.prototype.get=Ns,ha.prototype.has=ec,ha.prototype.set=df;var Gc=ha;function kc(){this.__data__=new Gc,this.size=0}var un=kc;function Mi(v){var x=this.__data__,w=x.delete(v);return this.size=x.size,w}var ei=Mi;function za(v){return this.__data__.get(v)}var Za=za;function Oo(v){return this.__data__.has(v)}var mu=Oo;function Au(v){var x=typeof v;return v!=null&&(x=="object"||x=="function")}var Rl=Au,xh="[object AsyncFunction]",vf="[object Function]",Wh="[object GeneratorFunction]",oh="[object Proxy]";function mc(v){if(!Rl(v))return!1;var x=oe(v);return x==vf||x==Wh||x==xh||x==oh}var lc=mc,Ku=We["__core-js_shared__"],xs=Ku,sh=function(){var v=/[^.]+$/.exec(xs&&xs.keys&&xs.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}();function bl(v){return!!sh&&sh in v}var Ca=bl,Zu=Function.prototype,$c=Zu.toString;function os(v){if(v!=null){try{return $c.call(v)}catch(x){}try{return v+""}catch(x){}}return""}var yo=os,As=/[\\^$.*+?()[\]{}|]/g,Ul=/^\[object .+?Constructor\]$/,Xi=Function.prototype,cc=Object.prototype,Dc=Xi.toString,af=cc.hasOwnProperty,Ws=RegExp("^"+Dc.call(af).replace(As,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function kl(v){if(!Rl(v)||Ca(v))return!1;var x=lc(v)?Ws:Ul;return x.test(yo(v))}var Cc=kl;function fc(v,x){return v==null?void 0:v[x]}var Fc=fc;function Sf(v,x){var w=Fc(v,x);return Cc(w)?w:void 0}var hc=Sf,ap=hc(We,"Map"),jl=ap,op=hc(Object,"create"),tc=op;function Tu(){this.__data__=tc?tc(null):{},this.size=0}var bs=Tu;function Xf(v){var x=this.has(v)&&delete this.__data__[v];return this.size-=x?1:0,x}var Cf=Xf,cu="__lodash_hash_undefined__",Dl=Object.prototype,mf=Dl.hasOwnProperty;function Fl(v){var x=this.__data__;if(tc){var w=x[v];return w===cu?void 0:w}return mf.call(x,v)?x[v]:void 0}var Ac=Fl,Yf=Object.prototype,Qi=Yf.hasOwnProperty;function Xa(v){var x=this.__data__;return tc?x[v]!==void 0:Qi.call(x,v)}var of=Xa,Pl="__lodash_hash_undefined__";function Bc(v,x){var w=this.__data__;return this.size+=this.has(v)?0:1,w[v]=tc&&x===void 0?Pl:x,this}var Qu=Bc;function ul(v){var x=-1,w=v==null?0:v.length;for(this.clear();++x<w;){var X=v[x];this.set(X[0],X[1])}}ul.prototype.clear=bs,ul.prototype.delete=Cf,ul.prototype.get=Ac,ul.prototype.has=of,ul.prototype.set=Qu;var uh=ul;function sp(){this.size=0,this.__data__={hash:new uh,map:new(jl||Gc),string:new uh}}var fu=sp;function Pu(v){var x=typeof v;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?v!=="__proto__":v===null}var up=Pu;function Ja(v,x){var w=v.__data__;return up(x)?w[typeof x=="string"?"string":"hash"]:w.map}var Kn=Ja;function Wc(v){var x=Kn(this,v).delete(v);return this.size-=x?1:0,x}var Ju=Wc;function Nt(v){return Kn(this,v).get(v)}var Xc=Nt;function ss(v){return Kn(this,v).has(v)}var Uu=ss;function cs(v,x){var w=Kn(this,v),X=w.size;return w.set(v,x),this.size+=w.size==X?0:1,this}var Kf=cs;function Uf(v){var x=-1,w=v==null?0:v.length;for(this.clear();++x<w;){var X=v[x];this.set(X[0],X[1])}}Uf.prototype.clear=fu,Uf.prototype.delete=Ju,Uf.prototype.get=Xc,Uf.prototype.has=Uu,Uf.prototype.set=Kf;var Nc=Uf,Tc=200;function gf(v,x){var w=this.__data__;if(w instanceof Gc){var X=w.__data__;if(!jl||X.length<Tc-1)return X.push([v,x]),this.size=++w.size,this;w=this.__data__=new Nc(X)}return w.set(v,x),this.size=w.size,this}var lh=gf;function Af(v){var x=this.__data__=new Gc(v);this.size=x.size}Af.prototype.clear=un,Af.prototype.delete=ei,Af.prototype.get=Za,Af.prototype.has=mu,Af.prototype.set=lh;var Tf=Af,Mf="__lodash_hash_undefined__";function Pf(v){return this.__data__.set(v,Mf),this}var ju=Pf;function gp(v){return this.__data__.has(v)}var qf=gp;function h(v){var x=-1,w=v==null?0:v.length;for(this.__data__=new Nc;++x<w;)this.add(v[x])}h.prototype.add=h.prototype.push=ju,h.prototype.has=qf;var g=h;function p(v,x){for(var w=-1,X=v==null?0:v.length;++w<X;)if(x(v[w],w,v))return!0;return!1}var b=p;function N(v,x){return v.has(x)}var q=N,ee=1,ge=2;function Ue(v,x,w,X,Ee,je){var dt=w&ee,Ct=v.length,qt=x.length;if(Ct!=qt&&!(dt&&qt>Ct))return!1;var kr=je.get(v),Cn=je.get(x);if(kr&&Cn)return kr==x&&Cn==v;var Di=-1,Ma=!0,uo=w&ge?new g:void 0;for(je.set(v,x),je.set(x,v);++Di<Ct;){var Ka=v[Di],Oa=x[Di];if(X)var fo=dt?X(Oa,Ka,Di,x,v,je):X(Ka,Oa,Di,v,x,je);if(fo!==void 0){if(fo)continue;Ma=!1;break}if(uo){if(!b(x,function(Ao,mo){if(!q(uo,mo)&&(Ka===Ao||Ee(Ka,Ao,w,X,je)))return uo.push(mo)})){Ma=!1;break}}else if(!(Ka===Oa||Ee(Ka,Oa,w,X,je))){Ma=!1;break}}return je.delete(v),je.delete(x),Ma}var st=Ue,kt=We.Uint8Array,Lt=kt;function Zt(v){var x=-1,w=Array(v.size);return v.forEach(function(X,Ee){w[++x]=[Ee,X]}),w}var vr=Zt;function pr(v){var x=-1,w=Array(v.size);return v.forEach(function(X){w[++x]=X}),w}var Nr=pr,cr=1,zr=2,Ur="[object Boolean]",Tn="[object Date]",ti="[object Error]",Yn="[object Map]",ai="[object Number]",Pi="[object RegExp]",va="[object Set]",na="[object String]",Ua="[object Symbol]",co="[object ArrayBuffer]",Eo="[object DataView]",ho=Ge?Ge.prototype:void 0,qo=ho?ho.valueOf:void 0;function ga(v,x,w,X,Ee,je,dt){switch(w){case Eo:if(v.byteLength!=x.byteLength||v.byteOffset!=x.byteOffset)return!1;v=v.buffer,x=x.buffer;case co:return!(v.byteLength!=x.byteLength||!je(new Lt(v),new Lt(x)));case Ur:case Tn:case ai:return Ql(+v,+x);case ti:return v.name==x.name&&v.message==x.message;case Pi:case na:return v==x+"";case Yn:var Ct=vr;case va:var qt=X&cr;if(Ct||(Ct=Nr),v.size!=x.size&&!qt)return!1;var kr=dt.get(v);if(kr)return kr==x;X|=zr,dt.set(v,x);var Cn=st(Ct(v),Ct(x),X,Ee,je,dt);return dt.delete(v),Cn;case Ua:if(qo)return qo.call(v)==qo.call(x)}return!1}var Zo=ga;function Uo(v,x){for(var w=-1,X=x.length,Ee=v.length;++w<X;)v[Ee+w]=x[w];return v}var Do=Uo;function po(v,x,w){var X=x(v);return Dn(v)?X:Do(X,w(v))}var us=po;function ko(v,x){for(var w=-1,X=v==null?0:v.length,Ee=0,je=[];++w<X;){var dt=v[w];x(dt,w,v)&&(je[Ee++]=dt)}return je}var Io=ko;function El(){return[]}var Ou=El,nu=Object.prototype,rc=nu.propertyIsEnumerable,Du=Object.getOwnPropertySymbols,gu=Du?function(v){return v==null?[]:(v=Object(v),Io(Du(v),function(x){return rc.call(v,x)}))}:Ou,gc=gu;function Vl(v,x){for(var w=-1,X=Array(v);++w<v;)X[w]=x(w);return X}var ml=Vl,Mc="[object Arguments]";function hl(v){return be(v)&&oe(v)==Mc}var yc=hl,lp=Object.prototype,Dh=lp.hasOwnProperty,jf=lp.propertyIsEnumerable,bh=yc(function(){return arguments}())?yc:function(v){return be(v)&&Dh.call(v,"callee")&&!jf.call(v,"callee")},Qf=bh;function sf(){return!1}var ch=sf,Pc=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Hl=Pc&&typeof module=="object"&&module&&!module.nodeType&&module,zc=Hl&&Hl.exports===Pc,fh=zc?We.Buffer:void 0,Eh=fh?fh.isBuffer:void 0,iu=Eh||ch,Xs=iu,Yc=9007199254740991,hh=/^(?:0|[1-9]\d*)$/;function Jf(v,x){var w=typeof v;return x=x==null?Yc:x,!!x&&(w=="number"||w!="symbol"&&hh.test(v))&&v>-1&&v%1==0&&v<x}var Fh=Jf,Xh=9007199254740991;function Of(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=Xh}var eh=Of,If="[object Arguments]",Vf="[object Array]",Yh="[object Boolean]",yf="[object Date]",Gl="[object Error]",Bh="[object Function]",Kh="[object Map]",yu="[object Number]",$p="[object Object]",Kc="[object RegExp]",Mp="[object Set]",Hf="[object String]",$l="[object WeakMap]",cd="[object ArrayBuffer]",Wp="[object DataView]",Es="[object Float32Array]",Xp="[object Float64Array]",Nd="[object Int8Array]",fd="[object Int16Array]",cp="[object Int32Array]",Pp="[object Uint8Array]",hd="[object Uint8ClampedArray]",wh="[object Uint16Array]",pd="[object Uint32Array]",ll={};ll[Es]=ll[Xp]=ll[Nd]=ll[fd]=ll[cp]=ll[Pp]=ll[hd]=ll[wh]=ll[pd]=!0,ll[If]=ll[Vf]=ll[cd]=ll[Yh]=ll[Wp]=ll[yf]=ll[Gl]=ll[Bh]=ll[Kh]=ll[yu]=ll[$p]=ll[Kc]=ll[Mp]=ll[Hf]=ll[$l]=!1;function zd(v){return be(v)&&eh(v.length)&&!!ll[oe(v)]}var yp=zd;function Sd(v){return function(x){return v(x)}}var hu=Sd,Lf=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Sh=Lf&&typeof module=="object"&&module&&!module.nodeType&&module,_p=Sh&&Sh.exports===Lf,Ch=_p&&xe.process,Op=function(){try{var v=Sh&&Sh.require&&Sh.require("util").types;return v||Ch&&Ch.binding&&Ch.binding("util")}catch(x){}}(),Ah=Op,fp=Ah&&Ah.isTypedArray,Nh=fp?hu(fp):yp,zh=Nh,qc=Object.prototype,Cd=qc.hasOwnProperty;function Rf(v,x){var w=Dn(v),X=!w&&Qf(v),Ee=!w&&!X&&Xs(v),je=!w&&!X&&!Ee&&zh(v),dt=w||X||Ee||je,Ct=dt?ml(v.length,String):[],qt=Ct.length;for(var kr in v)(x||Cd.call(v,kr))&&!(dt&&(kr=="length"||Ee&&(kr=="offset"||kr=="parent")||je&&(kr=="buffer"||kr=="byteLength"||kr=="byteOffset")||Fh(kr,qt)))&&Ct.push(kr);return Ct}var Yp=Rf,Kp=Object.prototype;function ph(v){var x=v&&v.constructor,w=typeof x=="function"&&x.prototype||Kp;return v===w}var th=ph;function Ip(v,x){return function(w){return v(x(w))}}var Oc=Ip,qh=Oc(Object.keys,Object),Th=qh,Zh=Object.prototype,dd=Zh.hasOwnProperty;function Ad(v){if(!th(v))return Th(v);var x=[];for(var w in Object(v))dd.call(v,w)&&w!="constructor"&&x.push(w);return x}var nc=Ad;function kf(v){return v!=null&&eh(v.length)&&!lc(v)}var Td=kf;function vd(v){return Td(v)?Yp(v):nc(v)}var hp=vd;function Lp(v){return us(v,hp,gc)}var qp=Lp,Gf=1,qd=Object.prototype,Rp=qd.hasOwnProperty;function Uh(v,x,w,X,Ee,je){var dt=w&Gf,Ct=qp(v),qt=Ct.length,kr=qp(x),Cn=kr.length;if(qt!=Cn&&!dt)return!1;for(var Di=qt;Di--;){var Ma=Ct[Di];if(!(dt?Ma in x:Rp.call(x,Ma)))return!1}var uo=je.get(v),Ka=je.get(x);if(uo&&Ka)return uo==x&&Ka==v;var Oa=!0;je.set(v,x),je.set(x,v);for(var fo=dt;++Di<qt;){Ma=Ct[Di];var Ao=v[Ma],mo=x[Ma];if(X)var Os=dt?X(mo,Ao,Ma,x,v,je):X(Ao,mo,Ma,v,x,je);if(!(Os===void 0?Ao===mo||Ee(Ao,mo,w,X,je):Os)){Oa=!1;break}fo||(fo=Ma=="constructor")}if(Oa&&!fo){var au=v.constructor,Su=x.constructor;au!=Su&&"constructor"in v&&"constructor"in x&&!(typeof au=="function"&&au instanceof au&&typeof Su=="function"&&Su instanceof Su)&&(Oa=!1)}return je.delete(v),je.delete(x),Oa}var _f=Uh,Md=hc(We,"DataView"),Qp=Md,Mh=hc(We,"Promise"),dh=Mh,Ph=hc(We,"Set"),_u=Ph,md=hc(We,"WeakMap"),_c=md,kp="[object Map]",xp="[object Object]",Ks="[object Promise]",Qh="[object Set]",Bl="[object WeakMap]",Df="[object DataView]",Jp=yo(Qp),jh=yo(jl),Jh=yo(dh),Pd=yo(_u),Qd=yo(_c),ep=oe;(Qp&&ep(new Qp(new ArrayBuffer(1)))!=Df||jl&&ep(new jl)!=kp||dh&&ep(dh.resolve())!=Ks||_u&&ep(new _u)!=Qh||_c&&ep(new _c)!=Bl)&&(ep=function(v){var x=oe(v),w=x==xp?v.constructor:void 0,X=w?yo(w):"";if(X)switch(X){case Jp:return Df;case jh:return kp;case Jh:return Ks;case Pd:return Qh;case Qd:return Bl}return x});var gd=ep,Ov=1,Ff="[object Arguments]",Dp="[object Array]",pp="[object Object]",Fp=Object.prototype,Fu=Fp.hasOwnProperty;function bp(v,x,w,X,Ee,je){var dt=Dn(v),Ct=Dn(x),qt=dt?Dp:gd(v),kr=Ct?Dp:gd(x);qt=qt==Ff?pp:qt,kr=kr==Ff?pp:kr;var Cn=qt==pp,Di=kr==pp,Ma=qt==kr;if(Ma&&Xs(v)){if(!Xs(x))return!1;dt=!0,Cn=!1}if(Ma&&!Cn)return je||(je=new Tf),dt||zh(v)?st(v,x,w,X,Ee,je):Zo(v,x,qt,w,X,Ee,je);if(!(w&Ov)){var uo=Cn&&Fu.call(v,"__wrapped__"),Ka=Di&&Fu.call(x,"__wrapped__");if(uo||Ka){var Oa=uo?v.value():v,fo=Ka?x.value():x;return je||(je=new Tf),Ee(Oa,fo,w,X,je)}}return Ma?(je||(je=new Tf),_f(v,x,w,X,Ee,je)):!1}var jo=bp;function Oh(v,x,w,X,Ee){return v===x?!0:v==null||x==null||!be(v)&&!be(x)?v!==v&&x!==x:jo(v,x,w,X,Oh,Ee)}var Bp=Oh;function Np(v,x){return Bp(v,x)}var ke=Np;function Ut(v,x){for(var w=-1,X=v==null?0:v.length;++w<X&&x(v[w],w,v)!==!1;);return v}var Ar=Ut,On=function(){try{var v=hc(Object,"defineProperty");return v({},"",{}),v}catch(x){}}(),bi=On;function zn(v,x,w){x=="__proto__"&&bi?bi(v,x,{configurable:!0,enumerable:!0,value:w,writable:!0}):v[x]=w}var hi=zn,Fi=Object.prototype,Gi=Fi.hasOwnProperty;function Ki(v,x,w){var X=v[x];(!(Gi.call(v,x)&&Ql(X,w))||w===void 0&&!(x in v))&&hi(v,x,w)}var ia=Ki;function oa(v,x,w,X){var Ee=!w;w||(w={});for(var je=-1,dt=x.length;++je<dt;){var Ct=x[je],qt=X?X(w[Ct],v[Ct],Ct,w,v):void 0;qt===void 0&&(qt=v[Ct]),Ee?hi(w,Ct,qt):ia(w,Ct,qt)}return w}var sa=oa;function Bi(v,x){return v&&sa(x,hp(x),v)}var Ji=Bi;function yn(v){var x=[];if(v!=null)for(var w in Object(v))x.push(w);return x}var Qn=yn,Yi=Object.prototype,wa=Yi.hasOwnProperty;function yi(v){if(!Rl(v))return Qn(v);var x=th(v),w=[];for(var X in v)X=="constructor"&&(x||!wa.call(v,X))||w.push(X);return w}var Ri=yi;function ta(v){return Td(v)?Yp(v,!0):Ri(v)}var wo=ta;function mi(v,x){return v&&sa(x,wo(x),v)}var xi=mi,Qa=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Aa=Qa&&typeof module=="object"&&module&&!module.nodeType&&module,ri=Aa&&Aa.exports===Qa,_a=ri?We.Buffer:void 0,Zi=_a?_a.allocUnsafe:void 0;function vo(v,x){if(x)return v.slice();var w=v.length,X=Zi?Zi(w):new v.constructor(w);return v.copy(X),X}var Bo=vo;function Hi(v,x){var w=-1,X=v.length;for(x||(x=Array(X));++w<X;)x[w]=v[w];return x}var ba=Hi;function go(v,x){return sa(v,gc(v),x)}var Wo=go,Ps=Oc(Object.getPrototypeOf,Object),xu=Ps,el=Object.getOwnPropertySymbols,Fs=el?function(v){for(var x=[];v;)Do(x,gc(v)),v=xu(v);return x}:Ou,pc=Fs;function pl(v,x){return sa(v,pc(v),x)}var Ol=pl;function Vu(v){return us(v,wo,pc)}var Wl=Vu,dc=Object.prototype,Qc=dc.hasOwnProperty;function Il(v){var x=v.length,w=new v.constructor(x);return x&&typeof v[0]=="string"&&Qc.call(v,"index")&&(w.index=v.index,w.input=v.input),w}var ys=Il;function tl(v){var x=new v.constructor(v.byteLength);return new Lt(x).set(new Lt(v)),x}var Ts=tl;function Jc(v,x){var w=x?Ts(v.buffer):v.buffer;return new v.constructor(w,v.byteOffset,v.byteLength)}var Vo=Jc,js=/\w*$/;function Iu(v){var x=new v.constructor(v.source,js.exec(v));return x.lastIndex=v.lastIndex,x}var ic=Iu,Vh=Ge?Ge.prototype:void 0,lr=Vh?Vh.valueOf:void 0;function Wn(v){return lr?Object(lr.call(v)):{}}var Rn=Wn;function ro(v,x){var w=x?Ts(v.buffer):v.buffer;return new v.constructor(w,v.byteOffset,v.length)}var qs=ro,ir="[object Boolean]",Rt="[object Date]",Zr="[object Map]",cn="[object Number]",jn="[object RegExp]",Wr="[object Set]",wr="[object String]",nn="[object Symbol]",Wt="[object ArrayBuffer]",Or="[object DataView]",ar="[object Float32Array]",xn="[object Float64Array]",mn="[object Int8Array]",wi="[object Int16Array]",ya="[object Int32Array]",xa="[object Uint8Array]",Sa="[object Uint8ClampedArray]",aa="[object Uint16Array]",no="[object Uint32Array]";function Ya(v,x,w){var X=v.constructor;switch(x){case Wt:return Ts(v);case ir:case Rt:return new X(+v);case Or:return Vo(v,w);case ar:case xn:case mn:case wi:case ya:case xa:case Sa:case aa:case no:return qs(v,w);case Zr:return new X;case cn:case wr:return new X(v);case jn:return ic(v);case Wr:return new X;case nn:return Rn(v)}}var io=Ya,E=Object.create,A=function(){function v(){}return function(x){if(!Rl(x))return{};if(E)return E(x);v.prototype=x;var w=new v;return v.prototype=void 0,w}}(),L=A;function P(v){return typeof v.constructor=="function"&&!th(v)?L(xu(v)):{}}var B=P,j="[object Map]";function te(v){return be(v)&&gd(v)==j}var de=te,Oe=Ah&&Ah.isMap,et=Oe?hu(Oe):de,Pt=et,Mr="[object Set]";function Qr(v){return be(v)&&gd(v)==Mr}var Xn=Qr,ii=Ah&&Ah.isSet,li=ii?hu(ii):Xn,Mn=li,wn=1,Vn=2,br=4,si="[object Arguments]",Ti="[object Array]",ka="[object Boolean]",So="[object Date]",Mo="[object Error]",rs="[object Function]",pu="[object GeneratorFunction]",Co="[object Map]",Qo="[object Number]",bu="[object Object]",o="[object RegExp]",u="[object Set]",c="[object String]",y="[object Symbol]",C="[object WeakMap]",R="[object ArrayBuffer]",z="[object DataView]",Q="[object Float32Array]",pe="[object Float64Array]",Ie="[object Int8Array]",ze="[object Int16Array]",qe="[object Int32Array]",ut="[object Uint8Array]",wt="[object Uint8ClampedArray]",or="[object Uint16Array]",sr="[object Uint32Array]",mr={};mr[si]=mr[Ti]=mr[R]=mr[z]=mr[ka]=mr[So]=mr[Q]=mr[pe]=mr[Ie]=mr[ze]=mr[qe]=mr[Co]=mr[Qo]=mr[bu]=mr[o]=mr[u]=mr[c]=mr[y]=mr[ut]=mr[wt]=mr[or]=mr[sr]=!0,mr[Mo]=mr[rs]=mr[C]=!1;function yr(v,x,w,X,Ee,je){var dt,Ct=x&wn,qt=x&Vn,kr=x&br;if(w&&(dt=Ee?w(v,X,Ee,je):w(v)),dt!==void 0)return dt;if(!Rl(v))return v;var Cn=Dn(v);if(Cn){if(dt=ys(v),!Ct)return ba(v,dt)}else{var Di=gd(v),Ma=Di==rs||Di==pu;if(Xs(v))return Bo(v,Ct);if(Di==bu||Di==si||Ma&&!Ee){if(dt=qt||Ma?{}:B(v),!Ct)return qt?Ol(v,xi(dt,v)):Wo(v,Ji(dt,v))}else{if(!mr[Di])return Ee?v:{};dt=io(v,Di,Ct)}}je||(je=new Tf);var uo=je.get(v);if(uo)return uo;je.set(v,dt),Mn(v)?v.forEach(function(fo){dt.add(yr(fo,x,w,fo,v,je))}):Pt(v)&&v.forEach(function(fo,Ao){dt.set(Ao,yr(fo,x,w,Ao,v,je))});var Ka=kr?qt?Wl:qp:qt?wo:hp,Oa=Cn?void 0:Ka(v);return Ar(Oa||v,function(fo,Ao){Oa&&(Ao=fo,fo=v[Ao]),ia(dt,Ao,yr(fo,x,w,Ao,v,je))}),dt}var rn=yr,_n=1,kn=4;function Nn(v){return rn(v,_n|kn)}var pi=Nn;function Xr(v){return Xr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},Xr(v)}var ua=["onCreated","source"],Ir=["data"],vn=["data"];function $i(v,x){var w=Object.keys(v);if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(v);x&&(X=X.filter(function(Ee){return Object.getOwnPropertyDescriptor(v,Ee).enumerable})),w.push.apply(w,X)}return w}function ki(v){for(var x=1;x<arguments.length;x++){var w=arguments[x]!=null?arguments[x]:{};x%2?$i(Object(w),!0).forEach(function(X){eo(v,X,w[X])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(w)):$i(Object(w)).forEach(function(X){Object.defineProperty(v,X,Object.getOwnPropertyDescriptor(w,X))})}return v}function eo(v,x,w){return x=Ha(x),x in v?Object.defineProperty(v,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[x]=w,v}function Ha(v){var x=Ta(v,"string");return Xr(x)==="symbol"?x:String(x)}function Ta(v,x){if(Xr(v)!=="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var X=w.call(v,x||"default");if(Xr(X)!=="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}function Ro(v,x){if(v==null)return{};var w=No(v,x),X,Ee;if(Object.getOwnPropertySymbols){var je=Object.getOwnPropertySymbols(v);for(Ee=0;Ee<je.length;Ee++)X=je[Ee],!(x.indexOf(X)>=0)&&Object.prototype.propertyIsEnumerable.call(v,X)&&(w[X]=v[X])}return w}function No(v,x){if(v==null)return{};var w={},X=Object.keys(v),Ee,je;for(je=0;je<X.length;je++)Ee=X[je],!(x.indexOf(Ee)>=0)&&(w[Ee]=v[Ee]);return w}var vs=function(x,w){var X=w.onCreated,Ee=w.source,je=Ro(w,ua),dt=tf(),Ct=(0,k.useRef)(),qt=(0,k.useRef)(je),kr=(0,k.useRef)(Ee);return Ct.current||(Ct.current=new x(w),X&&Ct.current.once("inited",function(){return X(Ct.current)}),dt.addLayer(Ct.current)),vl(function(){if(Ct.current){var Cn=!ke(qt.current,je);Cn&&(Ct.current.update(je),qt.current=pi(je))}},[je]),vl(function(){if(Ct.current){var Cn=Ee.data,Di=Ro(Ee,Ir),Ma=kr.current,uo=Ma.data,Ka=Ro(Ma,vn),Oa=Cn!==uo||!ke(Di,Ka);Oa&&(Ct.current.changeData(Ee),kr.current=ki({},Ee))}},[Ee]),(0,k.useEffect)(function(){return function(){Ct.current&&(dt.removeLayer(Ct.current),Ct.current=null)}},[]),Ct},oo={onRemove:"remove",onShow:"show",onHide:"hide",onDataUpdate:"dataUpdate",onLegend:"legend",onLegendColor:"legend:color",onLegendSize:"legend:size",onClick:"click",onUnClick:"unclick",onDblClick:"dblclick",onUndblclick:"undblclick",onContextMenu:"contextmenu",onUnContextMenu:"uncontextmenu",onMouseEnter:"mouseenter",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseUp:"mouseup",onMouseDown:"mousedown",onUnMousemove:"unmousemove",onUnMouseup:"unmouseup",onUnMousedown:"unmousedown",onUnPick:"unpick"},Qs=function(x,w){var X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:oo,Ee=(0,k.useMemo)(function(){return Object.keys(X)},[X]);Vr(function(je){var dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Ct=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];je.forEach(function(qt){var kr=X[Ee[qt]],Cn=dt[qt],Di=Ct[qt];Cn&&x.off(kr,Cn),Di&&x.on(kr,Di)})},Ee.map(function(je){return w[je]})),zt(function(){Ee.forEach(function(je){var dt=X[je],Ct=w[je];dt&&Ct&&x.off(dt,Ct)})})},Lu=null,cl=null,qu=null,Xl=null,ac=null,Zc=null,xf=null,vh=Object.assign(oo,{onSelect:"select",onUnselect:"unselect"}),uf=null,fs=I(70655),Ic={}.toString,bf=function(v,x){return Ic.call(v)==="[object "+x+"]"},Vs=bf,Eu=function(v){return Vs(v,"Function")},wu=function(v){return Array.isArray?Array.isArray(v):Vs(v,"Array")},tu=function(v){var x=typeof v;return v!==null&&x==="object"||x==="function"};function mh(v,x){if(v){var w;if(wu(v))for(var X=0,Ee=v.length;X<Ee&&(w=x(v[X],X),w!==!1);X++);else if(tu(v)){for(var je in v)if(v.hasOwnProperty(je)&&(w=x(v[je],je),w===!1))break}}}var Bf=mh,Yl=Object.keys?function(v){return Object.keys(v)}:function(v){var x=[];return Bf(v,function(w,X){Eu(v)&&X==="prototype"||x.push(X)}),x},Uc=null;function $f(v,x){var w=keys(x),X=w.length;if(isNil(v))return!X;for(var Ee=0;Ee<X;Ee+=1){var je=w[Ee];if(x[je]!==v[je]||!(je in v))return!1}return!0}var Hu=null,Ef=function(v){return typeof v=="object"&&v!==null},gh=Ef,ed=function(v){if(!gh(v)||!Vs(v,"Object"))return!1;if(Object.getPrototypeOf(v)===null)return!0;for(var x=v;Object.getPrototypeOf(x)!==null;)x=Object.getPrototypeOf(x);return Object.getPrototypeOf(v)===x},gl=ed;function Zs(v,x){if(!isArray(v))return null;var w;if(isFunction(x)&&(w=x),isPlainObject(x)&&(w=function(Ee){return isMatch(Ee,x)}),w){for(var X=0;X<v.length;X+=1)if(w(v[X]))return v[X]}return null}var Ep=null,lf=function(v,x){for(var w=null,X=0;X<v.length;X++){var Ee=v[X],je=Ee[x];if(!isNil(je)){isArray(je)?w=je[0]:w=je;break}}return w},xc=null,rl=function(v){if(!isArray(v))return[];for(var x=[],w=0;w<v.length;w++)x=x.concat(v[w]);return x},rh=null,Jd=function(v,x){if(x===void 0&&(x=[]),!isArray(v))x.push(v);else for(var w=0;w<v.length;w+=1)Jd(v[w],x);return x},Iv=null,pv=function(v){if(isArray(v))return v.reduce(function(x,w){return Math.max(x,w)},v[0])},Zd=function(v){if(isArray(v))return v.reduce(function(x,w){return Math.min(x,w)},v[0])},Kv=function(v){var x=v.filter(function(dt){return!isNaN(dt)});if(!x.length)return{min:0,max:0};if(isArray(v[0])){for(var w=[],X=0;X<v.length;X++)w=w.concat(v[X]);x=w}var Ee=getMax(x),je=getMin(x);return{min:je,max:Ee}},td=null,rd=Array.prototype,dp=rd.splice,ef=rd.indexOf,Lc=function(v){for(var x=[],w=1;w<arguments.length;w++)x[w-1]=arguments[w];for(var X=0;X<x.length;X++)for(var Ee=x[X],je=-1;(je=ef.call(v,Ee))>-1;)dp.call(v,je,1);return v},Ru=null,Rc=Array.prototype.splice,wp=function(x,w){if(!isArrayLike(x))return[];for(var X=x?w.length:0,Ee=X-1;X--;){var je=void 0,dt=w[X];(X===Ee||dt!==je)&&(je=dt,Rc.call(x,dt,1))}return x},zp=null,vp=function(v,x,w){if(!wu(v)&&!gl(v))return v;var X=w;return Bf(v,function(Ee,je){X=x(X,Ee,je)}),X},dv=vp,Lv=function(v,x){var w=[];if(!isArrayLike(v))return w;for(var X=-1,Ee=[],je=v.length;++X<je;){var dt=v[X];x(dt,X,v)&&(w.push(dt),Ee.push(X))}return pullAt(v,Ee),w},Rv=null,tp=function(v){return Vs(v,"String")};function kv(v,x){var w;if(isFunction(x))w=function(Ee,je){return x(Ee)-x(je)};else{var X=[];isString(x)?X.push(x):isArray(x)&&(X=x),w=function(Ee,je){for(var dt=0;dt<X.length;dt+=1){var Ct=X[dt];if(Ee[Ct]>je[Ct])return 1;if(Ee[Ct]<je[Ct])return-1}return 0}}return v.sort(w),v}var yd=null,ev=function(v,x){for(var w=[],X={},Ee=0;Ee<v.length;Ee++){var je=v[Ee],dt=je[x];if(!isNil(dt)){isArray(dt)||(dt=[dt]);for(var Ct=0;Ct<dt.length;Ct++){var qt=dt[Ct];X[qt]||(w.push(qt),X[qt]=!0)}}}return w};function vv(v,x){return isArray(v)||isString(v)?v[0]===x:!1}var mv=null;function nd(v,x){return isArray(v)||isString(v)?v[v.length-1]===x:!1}var Ih=null,Zp=Object.prototype.hasOwnProperty;function m0(v,x){if(!x||!isArray(v))return{};for(var w={},X=isFunction(x)?x:function(Ct){return Ct[x]},Ee,je=0;je<v.length;je++){var dt=v[je];Ee=X(dt),Zp.call(w,Ee)?w[Ee].push(dt):w[Ee]=[dt]}return w}var q0=null;function g0(v,x){if(!x)return{0:v};if(!isFunction(x)){var w=isArray(x)?x:x.replace(/\s+/g,"").split("*");x=function(X){for(var Ee="_",je=0,dt=w.length;je<dt;je++)Ee+=X[w[je]]&&X[w[je]].toString();return Ee}}return groupBy(v,x)}var y0=function(v,x){if(!x)return[v];var w=groupToMap(v,x),X=[];for(var Ee in w)X.push(w[Ee]);return X},_d={};function Q0(v){var x=_d[v];if(!x){for(var w=v.toString(16),X=w.length;X<6;X++)w="0"+w;x="#"+w,_d[v]=x}return x}var Sp=null;function Yo(v){var x=0,w=0,X=0,Ee=0;return isArray(v)?v.length===1?x=w=X=Ee=v[0]:v.length===2?(x=X=v[0],w=Ee=v[1]):v.length===3?(x=v[0],w=Ee=v[1],X=v[2]):(x=v[0],w=v[1],X=v[2],Ee=v[3]):x=w=X=Ee=v,{r1:x,r2:w,r3:X,r4:Ee}}var Up=null,Cp=function(v){return Vs(v,"Number")},mp=Cp,_0=function(v){return isNumber(v)&&v%1!==0},Nl=null,qv=function(v){return isNumber(v)&&v%2===0},id=null,Ud=Number.isInteger?Number.isInteger:function(v){return mp(v)&&v%1===0},Dv=null,Qv=function(v){return isNumber(v)&&v<0},Jv=null,Fv=function(v){return isNumber(v)&&v%2!==0},J0=null,Bv=function(v){return isNumber(v)&&v>0},x0=null,b0=function(v,x){if(isArray(v)){for(var w,X=-1/0,Ee=0;Ee<v.length;Ee++){var je=v[Ee],dt=isFunction(x)?x(je):je[x];dt>X&&(w=je,X=dt)}return w}},em=function(v,x){if(isArray(v)){for(var w,X=1/0,Ee=0;Ee<v.length;Ee++){var je=v[Ee],dt=isFunction(x)?x(je):je[x];dt<X&&(w=je,X=dt)}return w}},jp=180/Math.PI,E0=function(v){return jp*v},rp=null,e0=parseInt,Nv=Math.PI/180,ad=function(v){return Nv*v},w0=null,tm=null,Od=Object.values?function(v){return Object.values(v)}:function(v){var x=[];return Bf(v,function(w,X){Eu(v)&&X==="prototype"||x.push(w)}),x},jd=Od,cf=function(v,x){return contains(values(v),x)},Nf={}.toString,tv=function(v){return Nf.call(v).replace(/^\[object /,"").replace(/]$/,"")},rm=null,nm=function(v){return isType(v,"Arguments")},S0=null,t0=function(v){return Vs(v,"Boolean")},gv=t0,C0=function(v){return isType(v,"Date")},xd=null,im=function(v){return isType(v,"Error")},Ys=null;function Hs(v){return isNumber(v)&&isFinite(v)}var zv=Object.prototype,A0=function(v){var x=v&&v.constructor,w=typeof x=="function"&&x.prototype||zv;return v===w},T0=null,og=function(v){return isType(v,"RegExp")},am=null,om=function(v){return v===void 0},oc=om,sg=function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];for(var w=v[0],X=1;X<v.length;X++){var Ee=v[X];isFunction(Ee)&&(Ee=Ee.prototype),mix(w.prototype,Ee)}},M0=null,P0=function(v){if(typeof v!="object"||v===null)return v;var x;if(wu(v)){x=[];for(var w=0,X=v.length;w<X;w++)typeof v[w]=="object"&&v[w]!=null?x[w]=P0(v[w]):x[w]=v[w]}else{x={};for(var Ee in v)typeof v[Ee]=="object"&&v[Ee]!=null?x[Ee]=P0(v[Ee]):x[Ee]=v[Ee]}return x},r0=P0,ug=function(v,x){if(!Eu(v))throw new TypeError("Expected a function");var w=function(){for(var X=[],Ee=0;Ee<arguments.length;Ee++)X[Ee]=arguments[Ee];var je=x?x.apply(this,X):X[0],dt=w.cache;if(dt.has(je))return dt.get(je);var Ct=v.apply(this,X);return dt.set(je,Ct),Ct};return w.cache=new Map,w},sm=5;function O0(v,x,w,X){w=w||0,X=X||sm;for(var Ee in x)if(x.hasOwnProperty(Ee)){var je=x[Ee];je!==null&&gl(je)?(gl(v[Ee])||(v[Ee]={}),w<X?O0(v[Ee],je,w+1,X):v[Ee]=x[Ee]):wu(je)?(v[Ee]=[],v[Ee]=v[Ee].concat(je)):je!==void 0&&(v[Ee]=je)}}var um=function(v){for(var x=[],w=1;w<arguments.length;w++)x[w-1]=arguments[w];for(var X=0;X<x.length;X+=1)O0(v,x[X]);return v},lg=um,iy=function(v,x,w,X){isFunction(x)||(w=x,x=v,v=function(){});var Ee=Object.create?function(dt,Ct){return Object.create(dt,{constructor:{value:Ct}})}:function(dt,Ct){function qt(){}qt.prototype=dt;var kr=new qt;return kr.constructor=Ct,kr},je=Ee(x.prototype,v);return v.prototype=mix(je,v.prototype),v.superclass=Ee(x.prototype,x),mix(je,w),mix(v,X),v},ay=null,cg=Object.prototype.hasOwnProperty;function Id(v){if(isNil(v))return!0;if(isArrayLike(v))return!v.length;var x=getType(v);if(x==="Map"||x==="Set")return!v.size;if(isPrototype(v))return!Object.keys(v).length;for(var w in v)if(cg.call(v,w))return!1;return!0}var I0=null,lm=function(v){return v!==null&&typeof v!="function"&&isFinite(v.length)},yv=lm,n0=function(v,x){if(v===x)return!0;if(!v||!x||tp(v)||tp(x))return!1;if(yv(v)||yv(x)){if(v.length!==x.length)return!1;for(var w=!0,X=0;X<v.length&&(w=n0(v[X],x[X]),!!w);X++);return w}if(gh(v)||gh(x)){var Ee=Object.keys(v),je=Object.keys(x);if(Ee.length!==je.length)return!1;for(var w=!0,X=0;X<Ee.length&&(w=n0(v[Ee[X]],x[Ee[X]]),!!w);X++);return w}return!1},rv=n0,Mb=function(v,x,w){return isFunction(w)?!!w(v,x):isEqual(v,x)},Pb=function(v,x,w){for(var X=0,Ee=isString(x)?x.split("."):x;v&&X<Ee.length;)v=v[Ee[X++]];return v===void 0||X<Ee.length?w:v},Zv=function(v,x,w){var X=v,Ee=isString(x)?x.split("."):x;return Ee.forEach(function(je,dt){dt<Ee.length-1?(isObject(X[je])||(X[je]=isNumber(Ee[dt+1])?[]:{}),X=X[je]):X[je]=w}),v},S1=Object.prototype.hasOwnProperty,Ob=function(v,x){if(v===null||!isPlainObject(v))return{};var w={};return each(x,function(X){S1.call(v,X)&&(w[X]=v[X])}),w},oy=function(v,x){return dv(v,function(w,X,Ee){return x.includes(Ee)||(w[Ee]=X),w},{})},cm={},fg=function(v){return v=v||"g",cm[v]?cm[v]+=1:cm[v]=1,v+cm[v]},fm,Ib=ug(function(v,x){x===void 0&&(x={});var w=x.fontSize,X=x.fontFamily,Ee=x.fontWeight,je=x.fontStyle,dt=x.fontVariant;return fm||(fm=document.createElement("canvas").getContext("2d")),fm.font=[je,dt,Ee,w+"px",X].join(" "),fm.measureText(tp(v)?v:"").width},function(v,x){return x===void 0&&(x={}),(0,fs.pr)([v],jd(x)).join("")}),Lb=function(v,x,w,X){X===void 0&&(X="...");var Ee=16,je=measureTextWidth(X,w),dt=isString(v)?v:toString(v),Ct=x,qt=[],kr,Cn;if(measureTextWidth(v,w)<=x)return v;for(;kr=dt.substr(0,Ee),Cn=measureTextWidth(kr,w),!(Cn+je>Ct&&Cn>Ct);)if(qt.push(kr),Ct-=Cn,dt=dt.substr(Ee),!dt)return qt.join("");for(;kr=dt.substr(0,1),Cn=measureTextWidth(kr,w),!(Cn+je>Ct);)if(qt.push(kr),Ct-=Cn,dt=dt.substr(1),!dt)return qt.join("");return""+qt.join("")+X},Rb=function(){function v(){this.map={}}return v.prototype.has=function(x){return this.map[x]!==void 0},v.prototype.get=function(x,w){var X=this.map[x];return X===void 0?w:X},v.prototype.set=function(x,w){this.map[x]=w},v.prototype.clear=function(){this.map={}},v.prototype.delete=function(x){delete this.map[x]},v.prototype.size=function(){return Object.keys(this.map).length},v}(),kb=null,hm=function(v,x){var w=v.source,X=(0,fs._T)(v,["source"]),Ee=x.source,je=(0,fs._T)(x,["source"]),dt=(0,fs.pi)({},lg({},X,je));return Ee instanceof D.Source?dt.source=Ee:w instanceof D.Source?dt.source=w:dt.source=(0,fs.pi)((0,fs.pi)({},w),Ee),dt},pm=function(v,x){if(v instanceof D.Source&&x instanceof D.Source)return v!==x;var w=v.data,X=(0,fs._T)(v,["data"]),Ee=x.data,je=(0,fs._T)(x,["data"]),dt=w!==Ee||!rv(X,je);return dt},dm;(function(v){v.BubbleLayer="bubbleLayer",v.ChoroplethLayer="choroplethLayer",v.IconImageLayer="iconImageLayer",v.IconFontLayer="iconFontLayer"})(dm||(dm={}));var Vd=["show","hide","dataUpdate","destroy","legend","legend:color","legend:size","click","dblclick","unclick","undblclick","contextmenu","uncontextmenu","mouseenter","unmouseenter","mousemove","unmousemove","mouseout","mouseup","unmouseup","mousedown","unpick"],nv;(function(v){v.CREATED="created",v.INITED="inited",v.ADD="add",v.REMOVE="remove"})(nv||(nv={}));var _v;(function(v){v.CREATED="created",v.INITED="inited",v.ADD="add",v.REMOVE="remove"})(_v||(_v={}));var xv;(function(v){v.INITED_LAYER="inited-layer",v.INITED_LAYERS="inited-layers"})(xv||(xv={}));var Wf=function(v){(0,fs.ZT)(x,v);function x(w,X){w===void 0&&(w=[]),X===void 0&&(X={});var Ee=v.call(this)||this;Ee.layerMap=new Map,Ee.name=X.name?X.name:fg("layerGroup");for(var je=0;je<w.length;je++){var dt=w[je];Ee.addLayer(dt)}return Ee}return x.prototype.addTo=function(w){var X,Ee,je=this;this.scene=w;var dt=0,Ct=this.layerMap.size;try{for(var qt=(0,fs.XA)(this.layerMap.values()),kr=qt.next();!kr.done;kr=qt.next()){var Cn=kr.value;Cn.once("inited",function(Di){dt++,je.emit(xv.INITED_LAYER,Di),dt===Ct&&je.emit(xv.INITED_LAYERS)}),Cn.addTo(w)}}catch(Di){X={error:Di}}finally{try{kr&&!kr.done&&(Ee=qt.return)&&Ee.call(qt)}finally{if(X)throw X.error}}},x.prototype.remove=function(){this.scene&&this.getLayers().forEach(function(w){return w.remove()})},x.prototype.hasLayer=function(w){var X=typeof w=="string"?w:this.getLayerId(w);return this.layerMap.has(X)},x.prototype.addLayer=function(w){var X=this,Ee=this.getLayerId(w);this.layerMap.set(Ee,w),this.scene&&(w.once("inited",function(je){return X.emit(xv.INITED_LAYER,je)}),w.addTo(this.scene))},x.prototype.addLayers=function(w){var X=this;w.forEach(function(Ee){X.addLayer(Ee)})},x.prototype.removeLayer=function(w){var X=typeof w=="string"?w:this.getLayerId(w),Ee=this.layerMap.get(X);return Ee?(this.layerMap.delete(X),this.scene&&Ee.remove(),!0):!1},x.prototype.getLayers=function(){return Array.from(this.layerMap.values())},x.prototype.getLayer=function(w){return this.layerMap.get(w)},x.prototype.getLayerByName=function(w){return this.getLayers().find(function(X){return X.name===w})},x.prototype.removeAllLayer=function(){var w,X;try{for(var Ee=(0,fs.XA)(this.layerMap.values()),je=Ee.next();!je.done;je=Ee.next()){var dt=je.value;this.scene&&dt.remove()}}catch(Ct){w={error:Ct}}finally{try{je&&!je.done&&(X=Ee.return)&&X.call(Ee)}finally{if(w)throw w.error}}this.layerMap.clear()},x.prototype.isEmpty=function(){return this.layerMap.size===0},x.prototype.setZIndex=function(w){var X,Ee;try{for(var je=(0,fs.XA)(this.layerMap.values()),dt=je.next();!dt.done;dt=je.next()){var Ct=dt.value;Ct.setIndex(w)}}catch(qt){X={error:qt}}finally{try{dt&&!dt.done&&(Ee=je.return)&&Ee.call(je)}finally{if(X)throw X.error}}},x.prototype.getLayerId=function(w){return w.id},x.prototype.destroy=function(){this.remove(),this.off("*")},x}(on),Hd=function(v){(0,fs.ZT)(x,v);function x(w){var X=v.call(this)||this;X.isComposite=!0;var Ee=w.id,je=w.name;X.id=Ee||fg("composite-layer"),X.name=je||X.id,X.options=hm(X.getDefaultOptions(),w),X.lastOptions=X.options,X.source=X.createSource();var dt=X.createSubLayers();return X.subLayers=new Wf(dt),X.emit(_v.CREATED,X),X}return x.prototype.getDefaultOptions=function(){return x.DefaultOptions},x.prototype.createSource=function(){var w=this.options.source,X=w.data,Ee=(0,fs._T)(w,["data"]),je=this.isSourceInstance(w)?w:new D.Source(X,Ee);return je},x.prototype.isSourceInstance=function(w){return w instanceof D.Source},x.prototype.setSubLayersSource=function(w){this.layer.changeData(w)},x.prototype.initSubLayersEvent=function(){},x.prototype.addTo=function(w){var X=this;this.scene=w,this.subLayers.once(xv.INITED_LAYERS,function(){X.emit(_v.INITED,X),X.emit(_v.ADD,X)}),this.subLayers.addTo(w)},x.prototype.remove=function(){this.scene&&(this.subLayers.remove(),this.emit(_v.REMOVE))},x.prototype.update=function(w,X){var Ee,je;X===void 0&&(X=!0),this.updateOption(w),X&&((Ee=this.scene)===null||Ee===void 0||Ee.setEnableRender(!1)),w.source&&pm(w.source,this.lastOptions.source)&&this.changeData(w.source),this.updateSubLayers(w),X&&((je=this.scene)===null||je===void 0||je.setEnableRender(!0),this.render())},x.prototype.updateOption=function(w){this.lastOptions=this.options,this.options=hm(this.options,w)},x.prototype.render=function(){this.scene&&this.scene.render()},x.prototype.changeData=function(w){this.setSubLayersSource(w)},x.prototype.setIndex=function(w){this.subLayers.setZIndex(w)},x.prototype.setBlend=function(w){this.layer.setBlend(w)},x.prototype.setMinZoom=function(w){this.subLayers.getLayers().forEach(function(X){X.setMinZoom(w)})},x.prototype.setMaxZoom=function(w){this.subLayers.getLayers().forEach(function(X){X.setMaxZoom(w)})},x.prototype.show=function(){this.layer.inited&&this.update({visible:!0})},x.prototype.hide=function(){this.layer.inited&&this.update({visible:!1})},x.prototype.toggleVisible=function(){this.isVisible()?this.hide():this.show()},x.prototype.isVisible=function(){return this.layer.inited?this.layer.isVisible():oc(this.options.visible)?!0:this.options.visible},x.prototype.boxSelect=function(w,X){this.layer.boxSelect(w,X)},x.prototype.fitBounds=function(w){this.layer.fitBounds(w)},x.prototype.getLegend=function(w){return this.layer.getLegend(w)},x.prototype.getLegendItems=function(w){return this.layer.getLegendItems(w)},x.prototype.getColorLegendItems=function(){var w=this.layer.getLegendItems("color");if(Array.isArray(w)&&w.length!==0){var X=w;return X}return[]},x.prototype.getInteractionSubLayers=function(){var w=this.subLayers.getLayers().filter(function(X){return X.interaction===!0});return w},x.prototype.destroy=function(){this.subLayers.destroy()},x.prototype.on=function(w,X,Ee){return Vd.indexOf(w)!==-1?this.layer.on(w,X):v.prototype.on.call(this,w,X,Ee),this},x.prototype.once=function(w,X){return Vd.indexOf(w)!==-1?this.layer.once(w,X):v.prototype.once.call(this,w,X),this},x.prototype.off=function(w,X){return Vd.indexOf(w)!==-1?this.layer.off(w,X):v.prototype.off.call(this,w,X),this},x.LayerType=dm,x.DefaultOptions={},x}(on);function iv(v,x){return function(){for(var w=[],X=0;X<arguments.length;X++)w[X]=arguments[X];var Ee={};return v.forEach(function(je,dt){Ee[je]=w[dt]}),delete Ee.undefined,x(Ee)}}var hg=function(){function v(){}return v.shape=function(x,w){if(tp(w))x.shape(w);else if(Eu(w)){var X=[];x.shape(X.join("*"),iv(X,w))}else if(tu(w)){var Ee=w.field?w.field:"";if(Eu(w.value)){var X=wu(Ee)?Ee:Ee.split("*");x.shape(Ee,iv(X,w.value))}else x.shape(Ee,w.value);tp(Ee)&&w.scale&&v.scale(x,Ee,w.scale)}},v.size=function(x,w){if(mp(w))x.size(w);else if(wu(w))x.size(w);else if(Eu(w)){var X=[];x.size(X.join("*"),iv(X,w))}else if(tu(w)){var Ee=w.field?w.field:"";if(Eu(w.value)){var X=wu(Ee)?Ee:Ee.split("*");x.size(Ee,iv(X,w.value))}else x.size(Ee,w.value);tp(Ee)&&w.scale&&v.scale(x,Ee,w.scale)}},v.color=function(x,w){if(tp(w))x.color(w);else if(Eu(w)){var X=[];x.color(X.join("*"),iv(X,w))}else if(tu(w)){var Ee=w.field?w.field:"";if(Eu(w.value)){var X=wu(Ee)?Ee:Ee.split("*");x.color(Ee,iv(X,w.value))}else x.color(Ee,w.value);tp(Ee)&&w.scale&&v.scale(x,Ee,w.scale)}},v.scale=function(x,w,X){x.scale(w,X)},v.rotate=function(x,w){tp(w)||Eu(w)||tu(w)},v.texture=function(x,w){tp(w)&&x.texture(w)},v.animate=function(x,w){(gv(w)||tu(w))&&x.animate(w)},v.filter=function(x,w){var X=w.field?w.field:"",Ee=wu(X)?X:X.split("*");x.filter(Ee.join("*"),iv(Ee,w.value))},v.style=function(x,w){w&&x.style(w)},v.state=function(x,w){var X=w.active,Ee=w.select;X&&x.active(X),Ee&&x.select(Ee)},v}(),Hh=function(v){(0,fs.ZT)(x,v);function x(w){var X=v.call(this)||this;X.isComposite=!1;var Ee=w.id,je=w.name,dt=w.source,Ct=w.interaction,qt=Ct===void 0?!1:Ct;return X.id=Ee||fg("core-layer"),X.name=je||X.id,X.interaction=qt,X.options=hm(X.getDefaultOptions(),w),X.lastOptions=X.options,X.layer=X.createLayer(),X.adaptorLayerAttr(!1),X.setSource(dt),X.emit(nv.CREATED,X),X}return Object.defineProperty(x.prototype,"inited",{get:function(){return this.layer.inited},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"source",{get:function(){return this.layer.getSource()},enumerable:!1,configurable:!0}),x.prototype.getDefaultOptions=function(){return x.DefaultOptions},x.prototype.getLayerConfig=function(){var w=oy(this.options,["source","shape","color","size","scale","texture","style","animate","state"]);return w},x.prototype.adaptorAttrOptions=function(w){return w},x.prototype.adaptorLayerAttr=function(w){w===void 0&&(w=!0);for(var X=["shape","color","size","scale","texture","style","animate","state"],Ee=this.adaptorAttrOptions(this.options),je=this.adaptorAttrOptions(this.lastOptions),dt=0;dt<X.length;dt++){var Ct=X[dt],qt=Ee[Ct],kr=je[Ct];!oc(qt)&&(!w||!rv(qt,kr))&&hg[Ct](this.layer,qt)}},x.prototype.setSource=function(w){if(w instanceof D.Source)this.layer.setSource(w);else{var X=w.data,Ee=(0,fs._T)(w,["data"]),je=this.layer.getSource();je?this.layer.setData(X,Ee):this.layer.source(X,Ee)}},x.prototype.getSource=function(){return this.source},x.prototype.addTo=function(w){var X=this;this.scene=w,this.layer.once(nv.INITED,function(){X.emit(nv.INITED,X)}),this.layer.once(nv.ADD,function(){X.emit(nv.ADD,X)}),w.addLayer(this.layer)},x.prototype.remove=function(){this.scene&&(this.scene.removeLayer(this.layer),this.emit(nv.REMOVE))},x.prototype.update=function(w,X){var Ee,je;X===void 0&&(X=!0),this.updateOption(w),this.updateConfig(w),X&&((Ee=this.scene)===null||Ee===void 0||Ee.setEnableRender(!1)),(oc(this.options.visible)||this.options.visible)&&this.adaptorLayerAttr(),w.source&&pm(w.source,this.lastOptions.source)&&this.changeData(w.source),X&&((je=this.scene)===null||je===void 0||je.setEnableRender(!0),this.render())},x.prototype.updateOption=function(w){this.lastOptions=this.options,this.options=hm(this.options,w)},x.prototype.updateConfig=function(w){!oc(w.zIndex)&&!rv(this.lastOptions.zIndex,this.options.zIndex)&&this.setIndex(w.zIndex),!oc(w.blend)&&!rv(this.lastOptions.blend,this.options.blend)&&this.setBlend(w.blend),!oc(w.minZoom)&&!rv(this.lastOptions.minZoom,this.options.minZoom)&&this.setMinZoom(w.minZoom),!oc(w.maxZoom)&&!rv(this.lastOptions.maxZoom,this.options.maxZoom)&&this.setMaxZoom(w.maxZoom),!oc(w.visible)&&!rv(this.lastOptions.visible,this.options.visible)&&(w.visible?this.show():this.hide())},x.prototype.render=function(){this.scene&&this.scene.render()},x.prototype.changeData=function(w){this.setSource(w)},x.prototype.setIndex=function(w){this.layer.setIndex(w)},x.prototype.setBlend=function(w){this.layer.setBlend(w)},x.prototype.setMinZoom=function(w){this.layer.setMinZoom(w)},x.prototype.setMaxZoom=function(w){this.layer.setMaxZoom(w)},x.prototype.show=function(){this.layer.inited&&this.layer.show()},x.prototype.hide=function(){this.layer.inited&&this.layer.hide()},x.prototype.toggleVisible=function(){this.isVisible()?this.hide():this.show()},x.prototype.isVisible=function(){return this.layer.inited?this.layer.isVisible():oc(this.options.visible)?!0:this.options.visible},x.prototype.boxSelect=function(w,X){this.layer.boxSelect(w,X)},x.prototype.fitBounds=function(w){this.layer.fitBounds(w)},x.prototype.getLegend=function(w){return this.layer.getLegend(w)},x.prototype.getLegendItems=function(w){return this.layer.getLegendItems(w)},x.prototype.on=function(w,X,Ee){return Vd.indexOf(w)!==-1?this.layer.on(w,X):v.prototype.on.call(this,w,X,Ee),this},x.prototype.once=function(w,X){return Vd.indexOf(w)!==-1?this.layer.once(w,X):v.prototype.once.call(this,w,X),this},x.prototype.off=function(w,X){return Vd.indexOf(w)!==-1?this.layer.off(w,X):v.prototype.off.call(this,w,X),this},x.prototype.destroy=function(){this.layer.destroy()},x.DefaultOptions={},x}(on),bv=function(v){(0,fs.ZT)(x,v);function x(){var w=v!==null&&v.apply(this,arguments)||this;return w.type="lineLayer",w}return x.prototype.createLayer=function(){var w=this.getLayerConfig(),X=new D.LineLayer(w);return X},x}(Hh),vm=function(v){(0,fs.ZT)(x,v);function x(){var w=v!==null&&v.apply(this,arguments)||this;return w.type="polygonLayer",w}return x.prototype.createLayer=function(){var w=this.getLayerConfig(),X=new D.PolygonLayer(w);return X},x}(Hh),sy=function(v){(0,fs.ZT)(x,v);function x(){var w=v!==null&&v.apply(this,arguments)||this;return w.type="textLayer",w}return x.prototype.createLayer=function(){var w=this.getLayerConfig(),X=new D.PointLayer(w);return X},x.prototype.adaptorAttrOptions=function(w){var X=this.options,Ee=X.field,je=X.style,dt=je===void 0?{}:je,Ct=dt||{},qt=Ct.fill,kr=Ct.fontSize,Cn={field:Ee,value:"text"};return(0,fs.pi)({shape:Cn,color:qt,size:kr},w)},x}(Hh),C1={data:[],parser:{type:"json",x:"x",y:"y"}},av={data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}},i0="#2f54eb",yh={active:{fillColor:!1,strokeColor:i0,lineWidth:1,lineOpacity:1},select:{fillColor:!1,strokeColor:i0,lineWidth:1,lineOpacity:1}},mm={visible:!0,source:av,lineWidth:1,state:{active:!1,select:!1},enabledMultiSelect:!1,triggerMultiSelectKey:"Shift"},gm=function(v){return oc(v)||(v.active===!1?yh.active=Object.assign(yh.active,{fill:!1,stroke:!1}):typeof v.active=="object"&&(v.active.fillColor===!1?yh.active.fillColor=!1:typeof v.active.fillColor=="string"&&(yh.active.fillColor=v.active.fillColor),v.active.strokeColor===!1?yh.active.strokeColor=!1:typeof v.active.strokeColor=="string"&&(yh.active.strokeColor=v.active.strokeColor),typeof v.active.lineWidth=="number"&&(yh.active.lineWidth=v.active.lineWidth),typeof v.active.lineOpacity=="number"&&(yh.active.lineOpacity=v.active.lineOpacity)),v.select===!1?yh.select=Object.assign(yh.select,{fill:!1,stroke:!1}):typeof v.select=="object"&&(v.select.fillColor===!1?yh.select.fillColor=!1:typeof v.select.fillColor=="string"&&(yh.select.fillColor=v.select.fillColor),v.select.strokeColor===!1?yh.select.strokeColor=!1:typeof v.select.strokeColor=="string"&&(yh.select.strokeColor=v.select.strokeColor),typeof v.select.lineWidth=="number"&&(yh.select.lineWidth=v.select.lineWidth),typeof v.select.lineOpacity=="number"&&(yh.select.lineOpacity=v.select.lineOpacity))),yh},ym={};window.addEventListener("keydown",function(v){v.isComposing||v.keyCode===229||(ym[v.key]=!0)}),window.addEventListener("keyup",function(v){ym[v.key]=!1});var a0=function(v){return!!ym[v]},Lh=function(v,x){var w=v&&(x?a0(x):!0);return w},_m=function(v){var x=v.visible,w=v.minZoom,X=v.maxZoom,Ee=v.zIndex,je=Ee===void 0?0:Ee,dt=v.label,Ct=x&&Boolean(dt)&&(oc(dt==null?void 0:dt.visible)||(dt==null?void 0:dt.visible)),qt=(0,fs.pi)((0,fs.pi)({zIndex:je+.1,minZoom:w,maxZoom:X},dt),{visible:Ct});return qt},xm=function(v){return!(oc(v)||gv(v)||oc(v.coordinates)&&(oc(v.x)||oc(v.y))&&oc(v.geometry))},bm=function(v,x){var w=x==null?void 0:x.position;if(!xm(w))return v;var X=v.parser.type,Ee=v.transforms,je=v.originData,dt={data:je,transforms:Ee};if(w.coordinates){var Ct=w.coordinates;dt.parser={type:X,coordinates:Ct}}else if(w.x&&w.y){var qt=w.x,kr=w.y;dt.parser={type:X,x:qt,y:kr}}else if(w.geometry){var Cn=w.geometry;dt.parser={type:X,geometry:Cn}}return dt},L0=function(v,x){return(0,fs.pi)((0,fs.pi)({},_m(v)),{source:bm(x,v.label)})},R0=function(v){(0,fs.ZT)(x,v);function x(w){var X=v.call(this,w)||this;return X.type=Hd.LayerType.ChoroplethLayer,X.selectData=[],X.layerState=yh,X.onHighlighHandle=function(Ee){var je=Ee.feature,dt=Ee.featureId;X.setHighlightLayerSource(je,dt)},X.onUnhighlighHandle=function(){X.setHighlightLayerSource()},X.onSelectHandle=function(Ee){var je=Ee.feature,dt=Ee.featureId;X.handleSelectData(dt,je)},X.initSubLayersEvent(),X}return Object.defineProperty(x.prototype,"layer",{get:function(){return this.fillLayer},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"fillLayer",{get:function(){return this.subLayers.getLayer("fillLayer")},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"strokeLayer",{get:function(){return this.subLayers.getLayer("strokeLayer")},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"highlightStrokeLayer",{get:function(){return this.subLayers.getLayer("highlightStrokeLayer")},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"selectFillLayer",{get:function(){return this.subLayers.getLayer("selectFillLayer")},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"selectStrokeLayer",{get:function(){return this.subLayers.getLayer("selectStrokeLayer")},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"labelLayer",{get:function(){return this.subLayers.getLayer("labelLayer")},enumerable:!1,configurable:!0}),x.prototype.getDefaultOptions=function(){return x.DefaultOptions},x.prototype.createSubLayers=function(){var w=this.source;this.layerState=gm(this.options.state);var X=new vm((0,fs.pi)((0,fs.pi)({},this.getFillLayerOptions()),{id:"fillLayer",shape:"fill",source:w,interaction:!0})),Ee=new bv((0,fs.pi)((0,fs.pi)({},this.getStrokeLayerOptions()),{id:"strokeLayer",shape:"line",source:w})),je=new bv((0,fs.pi)((0,fs.pi)({},this.getHighlightStrokeLayerOptions()),{id:"highlightStrokeLayer"})),dt=new vm((0,fs.pi)((0,fs.pi)({},this.getSelectFillLayerOptions()),{id:"selectFillLayer"})),Ct=new bv((0,fs.pi)((0,fs.pi)({},this.getSelectStrokeLayerOptions()),{id:"selectStrokeLayer"})),qt=new sy((0,fs.pi)((0,fs.pi)({},L0(this.options,w)),{id:"labelLayer"})),kr=[X,Ee,je,dt,Ct,qt];return kr},x.prototype.getFillLayerOptions=function(){var w=oy(this.options,["source"]),X=w.visible,Ee=w.minZoom,je=w.maxZoom,dt=w.zIndex,Ct=dt===void 0?0:dt,qt=w.fillColor,kr=w.opacity,Cn=(0,fs._T)(w,["visible","minZoom","maxZoom","zIndex","fillColor","opacity"]),Di=this.layerState,Ma={active:Di.active.fillColor===!1?!1:{color:Di.active.fillColor},select:!1},uo={opacity:kr},Ka=(0,fs.pi)((0,fs.pi)({},Cn),{visible:X,minZoom:Ee,maxZoom:je,zIndex:Ct,color:qt,state:Ma,style:uo});return Ka},x.prototype.getStrokeLayerOptions=function(){var w=this.options,X=w.visible,Ee=w.minZoom,je=w.maxZoom,dt=w.zIndex,Ct=dt===void 0?0:dt,qt=w.opacity,kr=w.strokeColor,Cn=w.lineWidth,Di=w.lineOpacity,Ma=w.lineDash,uo=w.lineType,Ka={opacity:oc(Di)?qt:Di,dashArray:Ma,lineType:uo},Oa={visible:X&&Boolean(Cn)&&Boolean(kr),zIndex:Ct,minZoom:Ee,maxZoom:je,size:Cn,color:kr,style:Ka};return Oa},x.prototype.getHighlightStrokeLayerOptions=function(){var w=this.options,X=w.visible,Ee=w.minZoom,je=w.maxZoom,dt=w.zIndex,Ct=dt===void 0?0:dt,qt=w.lineWidth,kr=this.layerState,Cn=kr.active.strokeColor||void 0,Di=kr.active.lineWidth||qt,Ma={visible:X&&Boolean(Cn),zIndex:Ct+.1,minZoom:Ee,maxZoom:je,source:av,size:Di,color:Cn,style:{opacity:kr.active.lineOpacity}};return Ma},x.prototype.getSelectFillLayerOptions=function(){var w=this.options,X=w.visible,Ee=w.minZoom,je=w.maxZoom,dt=w.zIndex,Ct=dt===void 0?0:dt,qt=w.opacity,kr=this.layerState,Cn=kr.select.fillColor||void 0,Di={opacity:qt},Ma={visible:X&&Boolean(Cn),zIndex:Ct+.1,minZoom:Ee,maxZoom:je,source:av,color:Cn,style:Di,state:{select:!1,active:!1}};return Ma},x.prototype.getSelectStrokeLayerOptions=function(){var w=this.options,X=w.visible,Ee=w.minZoom,je=w.maxZoom,dt=w.zIndex,Ct=dt===void 0?0:dt,qt=w.lineWidth,kr=this.layerState,Cn=kr.select.strokeColor||void 0,Di=kr.select.lineWidth||qt,Ma={visible:X&&Boolean(Cn),zIndex:Ct+.1,minZoom:Ee,maxZoom:je,source:av,size:Di,color:Cn,style:{opacity:kr.select.lineOpacity}};return Ma},x.prototype.setSubLayersSource=function(w){var X;if(this.isSourceInstance(w))this.source=w,this.fillLayer.setSource(w),this.strokeLayer.setSource(w),this.labelLayer.setSource(w);else{var Ee=w.data,je=(0,fs._T)(w,["data"]);if(this.source.setData(Ee,je),xm((X=this.options.label)===null||X===void 0?void 0:X.position)){var dt=bm(this.source,this.options.label);this.labelLayer.changeData(dt)}}this.highlightStrokeLayer.changeData(av),this.selectFillLayer.changeData(av),this.selectStrokeLayer.changeData(av)},x.prototype.setHighlightLayerSource=function(w,X){if(X===void 0&&(X=-999),this.highlightData!==X){var Ee=w?[w]:[],je=this.source.parser,dt=je.type==="geojson"?{type:"FeatureCollection",features:Ee}:Ee;this.highlightStrokeLayer.changeData({data:dt,parser:je}),this.highlightData=X}},x.prototype.setSelectLayerSource=function(w){if(w===void 0&&(w=[]),!(this.selectData.length===w.length&&rv(this.selectData.map(function(dt){var Ct=dt.featureId;return Ct}),w.map(function(dt){var Ct=dt.featureId;return Ct})))){var X=w.map(function(dt){var Ct=dt.feature;return Ct}),Ee=this.source.parser,je=Ee.type==="geojson"?{type:"FeatureCollection",features:X}:X;this.selectFillLayer.changeData({data:je,parser:Ee}),this.selectStrokeLayer.changeData({data:je,parser:Ee}),this.selectData=w}},x.prototype.initSubLayersEvent=function(){this.fillLayer.off("mousemove",this.onHighlighHandle),this.fillLayer.off("mouseout",this.onHighlighHandle),this.fillLayer.off("click",this.onSelectHandle),this.selectData=[],this.highlightData=null,this.options.state&&(this.options.state.active&&(this.fillLayer.on("mousemove",this.onHighlighHandle),this.fillLayer.on("mouseout",this.onUnhighlighHandle)),this.options.state.select&&this.fillLayer.on("click",this.onSelectHandle))},x.prototype.handleSelectData=function(w,X,Ee){var je=this.options,dt=je.enabledMultiSelect,Ct=je.triggerMultiSelectKey,qt=Lh(dt,Ct)||Ee,kr=r0(this.selectData),Cn=kr.findIndex(function(Ma){return Ma.featureId===w});if(Cn===-1)qt?kr.push({feature:X,featureId:w}):kr=[{feature:X,featureId:w}],this.emit("select",X,r0(kr));else{var Di=kr[Cn];qt?kr.splice(Cn,1):kr=[],this.emit("unselect",Di,r0(kr))}this.setSelectLayerSource(kr)},x.prototype.update=function(w){v.prototype.update.call(this,w),this.initSubLayersEvent()},x.prototype.updateOption=function(w){v.prototype.updateOption.call(this,w),this.layerState=gm(this.options.state)},x.prototype.updateSubLayers=function(w){this.fillLayer.update(this.getFillLayerOptions(),!1),this.strokeLayer.update(this.getStrokeLayerOptions(),!1),this.highlightStrokeLayer.update(this.getHighlightStrokeLayerOptions(),!1),this.selectFillLayer.update(this.getSelectFillLayerOptions(),!1),this.selectStrokeLayer.update(this.getSelectStrokeLayerOptions(),!1),this.labelLayer.update(L0(this.options,this.source),!1),this.options.visible&&(!oc(w.state)&&!rv(this.lastOptions.state,this.options.state)&&this.updateHighlightSubLayers(),this.layerState.active.strokeColor&&this.setHighlightLayerSource(),(this.layerState.select.fillColor||this.layerState.select.strokeColor)&&this.setSelectLayerSource())},x.prototype.updateHighlightSubLayers=function(){var w=this.layerState,X=gm(this.lastOptions.state);X.active.strokeColor!==w.active.strokeColor&&(w.active.strokeColor?this.highlightStrokeLayer.show():this.highlightStrokeLayer.hide()),X.select.fillColor!==w.select.fillColor&&(w.select.fillColor?this.selectFillLayer.show():this.selectFillLayer.hide()),X.select.strokeColor!==w.select.strokeColor&&(w.select.strokeColor?this.selectStrokeLayer.show():this.selectStrokeLayer.hide())},x.prototype.setIndex=function(w){this.fillLayer.setIndex(w),this.strokeLayer.setIndex(w),this.highlightStrokeLayer.setIndex(w+.1),this.selectFillLayer.setIndex(w+.1),this.selectStrokeLayer.setIndex(w+.1),this.labelLayer.setIndex(w+.1)},x.prototype.setActive=function(w,X){var Ee=this.fillLayer.source,je=Ee.getFeatureId(w,X);if(oc(je)){console.warn("Feature non-existent by field: ".concat(w,",value: ").concat(X));return}if(this.layerState.active.fillColor&&this.fillLayer.layer.setActive(je),this.layerState.active.strokeColor){var dt=Ee.getFeatureById(je);this.setHighlightLayerSource(dt,je)}},x.prototype.setSelect=function(w,X){var Ee=this.fillLayer.source,je=Ee.getFeatureId(w,X);if(oc(je)){console.warn("Feature non-existent by field: ".concat(w,",value: ").concat(X));return}if(!(this.layerState.select.strokeColor===!1&&this.layerState.select.fillColor===!1)){var dt=Ee.getFeatureById(je);this.handleSelectData(je,dt,!0)}},x.prototype.boxSelect=function(w,X){this.fillLayer.boxSelect(w,X)},x.DefaultOptions=mm,x}(Hd),Em=Object.assign(oo,{onSelect:"select",onUnselect:"unselect"}),uy=(0,k.memo)((0,k.forwardRef)(function(x,w){var X=vs(R0,x);return Qs(X.current,x,Em),(0,k.useImperativeHandle)(w,function(){return X.current}),null})),A1=null,T1=null,Ev=I(73935),ly=function(x){var w=x.className,X=x.style,Ee=x.children,je=x.position,dt=x.name,Ct=(0,k.useRef)(document.createElement("div")),qt=fr(X),kr=(0,k.useCallback)(function(){return Ct.current},[]),Cn=(0,k.useMemo)(function(){return{position:je,name:dt,className:w,style:qt}},[je,dt,w,qt]);return Al(kr,void 0,Cn),(0,Ev.createPortal)(Ee,Ct.current)};ly.defaultProps={position:"topleft"};function cy(v){return vg(v)||dg(v)||pg(v)||Ve()}function Ve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pg(v,x){if(v){if(typeof v=="string")return k0(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return k0(v,x)}}function dg(v){if(typeof Symbol!="undefined"&&v[Symbol.iterator]!=null||v["@@iterator"]!=null)return Array.from(v)}function vg(v){if(Array.isArray(v))return k0(v)}function k0(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}var wm=function(x,w){var X=(0,k.useMemo)(function(){return Object.keys(w)},[w]);(0,k.useEffect)(function(){return x&&X.forEach(function(Ee){var je=w[Ee];je&&x.on(Ee,je)}),function(){x&&X.forEach(function(Ee){var je=w[Ee];je&&x.off(Ee,je)})}},[x].concat(cy(Object.values(w)))),zt(function(){x&&X.forEach(function(Ee){var je=w[Ee];je&&x.off(Ee,je)})})},Sm=function(x,w){var X=(0,k.useRef)(!0),Ee=(0,k.useMemo)(function(){return Object.keys(w)},[w]);Vr(function(je){if(X.current){X.current=!1;return}var dt={};je.forEach(function(Ct){var qt=Ee[Ct];dt[qt]=w[qt]}),x==null||x.setOptions(dt)},Object.values(w))},mg=function(x){var w=(0,k.useRef)(document.createElement("span"));return{portal:x?(0,Ev.createPortal)(x,w.current):null,dom:x?w.current:void 0}};function wv(v,x){return xg(v)||_g(v,x)||yg(v,x)||gg()}function gg(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yg(v,x){if(v){if(typeof v=="string")return Cm(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return Cm(v,x)}}function Cm(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function _g(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function xg(v){if(Array.isArray(v))return v}var M1=function(x){var w=x.onExport,X=x.onShow,Ee=x.onHide,je=x.onAdd,dt=x.onRemove,Ct=x.imageType,qt=x.btnIcon,kr=x.btnText,Cn=x.title,Di=x.vertical,Ma=x.position,uo=x.className,Ka=x.style,Oa=useScene(),fo=useState(),Ao=wv(fo,2),mo=Ao[0],Os=Ao[1],au=useMemo(function(){return getStyleText(Ka)},[Ka]),Su=useL7ComponentPortal(qt),wl=Su.portal,Us=Su.dom,du=useMemo(function(){return{btnText:kr,title:Cn,vertical:Di,position:Ma,className:uo,imageType:Ct,style:au,btnIcon:Us,onExport:w}},[kr,Cn,Di,Ma,uo,au,Ct,w,Us]);return useMount(function(){var Is=new L7ExportImage(omitBy(du,function(Gs){return Gs===void 0}));Os(Is),Oa.addControl(Is)}),useUnmount(function(){mo&&(Oa.removeControl(mo),Os(void 0))}),useL7ComponentUpdate(mo,du),useL7ComponentEvent(mo,{add:je,remove:dt,show:X,hide:Ee}),React.createElement(React.Fragment,null,wl)};function _(v,x){return Jt(v)||yt(v,x)||J(v,x)||M()}function M(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J(v,x){if(v){if(typeof v=="string")return Te(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return Te(v,x)}}function Te(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function yt(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function Jt(v){if(Array.isArray(v))return v}var Gr=function(x){var w=x.onShow,X=x.onHide,Ee=x.onAdd,je=x.onRemove,dt=x.onFullscreenChange,Ct=x.btnIcon,qt=x.btnText,kr=x.title,Cn=x.vertical,Di=x.exitBtnIcon,Ma=x.exitBtnText,uo=x.exitTitle,Ka=x.position,Oa=x.className,fo=x.style,Ao=useScene(),mo=useState(),Os=_(mo,2),au=Os[0],Su=Os[1],wl=useMemo(function(){return getStyleText(fo)},[fo]),Us=useL7ComponentPortal(Ct),du=Us.portal,Is=Us.dom,Gs=useL7ComponentPortal(Di),fl=Gs.portal,ni=Gs.dom,En=useMemo(function(){return{btnText:qt,title:kr,vertical:Cn,exitBtnText:Ma,exitTitle:uo,position:Ka,className:Oa,style:wl,btnIcon:Is,exitBtnIcon:ni}},[qt,kr,Cn,Ma,uo,Ka,Oa,wl,Is,ni]);return useMount(function(){var Zn=new L7Fullscreen(omitBy(En,function(la){return la===void 0}));Su(Zn),Ao.addControl(Zn)}),useUnmount(function(){au&&(Ao.removeControl(au),Su(void 0))}),useL7ComponentUpdate(au,En),useL7ComponentEvent(au,{add:Ee,remove:je,show:w,hide:X,fullscreenChange:dt}),React.createElement(React.Fragment,null,du,fl)};function gn(v,x){return Lo(v)||Ra(v,x)||pa(v,x)||$n()}function $n(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pa(v,x){if(v){if(typeof v=="string")return ma(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return ma(v,x)}}function ma(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function Ra(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function Lo(v){if(Array.isArray(v))return v}var _s=function(x){var w=x.transform,X=x.onShow,Ee=x.onHide,je=x.onAdd,dt=x.onRemove,Ct=x.btnIcon,qt=x.btnText,kr=x.title,Cn=x.vertical,Di=x.position,Ma=x.className,uo=x.style,Ka=useScene(),Oa=useState(),fo=gn(Oa,2),Ao=fo[0],mo=fo[1],Os=useMemo(function(){return getStyleText(uo)},[uo]),au=useL7ComponentPortal(Ct),Su=au.portal,wl=au.dom,Us=useMemo(function(){return{btnText:qt,title:kr,vertical:Cn,position:Di,className:Ma,style:Os,transform:w,btnIcon:wl}},[qt,kr,Cn,Di,Ma,Os,w,wl]);return useMount(function(){var du=new L7GeoLocate(omitBy(Us,function(Is){return Is===void 0}));mo(du),Ka.addControl(du)}),useUnmount(function(){Ao&&(Ka.removeControl(Ao),mo(void 0))}),useL7ComponentUpdate(Ao,Us),useL7ComponentEvent(Ao,{add:je,remove:dt,show:X,hide:Ee}),React.createElement(React.Fragment,null,Su)};function Js(v,x){return Vp(v)||yl(v,x)||Xo(v,x)||Gu()}function Gu(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xo(v,x){if(v){if(typeof v=="string")return nl(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return nl(v,x)}}function nl(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function yl(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function Vp(v){if(Array.isArray(v))return v}var Ap=function(x){var w=x.layers,X=x.popperPlacement,Ee=x.popperTrigger,je=x.popperClassName,dt=x.btnIcon,Ct=x.btnText,qt=x.title,kr=x.vertical,Cn=x.position,Di=x.className,Ma=x.style,uo=x.onAdd,Ka=x.onRemove,Oa=x.onShow,fo=x.onHide,Ao=x.onPopperShow,mo=x.onPopperHide,Os=x.onSelectChange,au=useScene(),Su=useLayerList(),wl=useState(),Us=Js(wl,2),du=Us[0],Is=Us[1],Gs=useMemo(function(){return getStyleText(Ma)},[Ma]),fl=useL7ComponentPortal(dt),ni=fl.portal,En=fl.dom,Zn=useMemo(function(){return w!=null&&w.length?w.map(function(ja){return typeof ja=="string"?Su.find(function(Fa){return Fa.id===ja}):ja}).filter(function(ja){return!!ja}):Su},[w,Su]),la=useMemo(function(){return{layers:Zn,popperPlacement:X,popperTrigger:Ee,popperClassName:je,btnText:Ct,title:qt,vertical:kr,position:Cn,className:Di,style:Gs,btnIcon:En}},[Zn,X,Ee,je,Ct,qt,kr,Cn,Di,Gs,En]);return useMount(function(){var ja=new L7LayerSwitch(omitBy(la,function(Fa){return Fa===void 0}));Is(ja),au.addControl(ja)}),useUnmount(function(){du&&(au.removeControl(du),Is(void 0))}),useL7ComponentUpdate(du,la),useL7ComponentEvent(du,{add:uo,remove:Ka,show:Oa,hide:fo,popperShow:Ao,popperHide:mo,selectChange:Os}),React.createElement(React.Fragment,null,ni)},jc=v=>{$e&&(qn(v)||console.error(`useMount: parameter \`fn\` expected to be a function, but got "${typeof v}".`)),(0,k.useEffect)(()=>{v==null||v()},[])},sd=1,Ld=2;function Am(v,x,w,X){var Ee=w.length,je=Ee,dt=!X;if(v==null)return!je;for(v=Object(v);Ee--;){var Ct=w[Ee];if(dt&&Ct[2]?Ct[1]!==v[Ct[0]]:!(Ct[0]in v))return!1}for(;++Ee<je;){Ct=w[Ee];var qt=Ct[0],kr=v[qt],Cn=Ct[1];if(dt&&Ct[2]){if(kr===void 0&&!(qt in v))return!1}else{var Di=new Tf;if(X)var Ma=X(kr,Cn,qt,v,x,Di);if(!(Ma===void 0?Bp(Cn,kr,sd|Ld,X,Di):Ma))return!1}}return!0}var fy=Am;function P1(v){return v===v&&!Rl(v)}var O1=P1;function Db(v){for(var x=hp(v),w=x.length;w--;){var X=x[w],Ee=v[X];x[w]=[X,Ee,O1(Ee)]}return x}var hy=Db;function py(v,x){return function(w){return w==null?!1:w[v]===x&&(x!==void 0||v in Object(w))}}var bg=py;function Eg(v){var x=hy(v);return x.length==1&&x[0][2]?bg(x[0][0],x[0][1]):function(w){return w===v||fy(w,v,x)}}var wg=Eg,dy=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vy=/^\w*$/;function Sg(v,x){if(Dn(v))return!1;var w=typeof v;return w=="number"||w=="symbol"||w=="boolean"||v==null||ca(v)?!0:vy.test(v)||!dy.test(v)||x!=null&&v in Object(x)}var o0=Sg,ud="Expected a function";function Tm(v,x){if(typeof v!="function"||x!=null&&typeof x!="function")throw new TypeError(ud);var w=function(){var X=arguments,Ee=x?x.apply(this,X):X[0],je=w.cache;if(je.has(Ee))return je.get(Ee);var dt=v.apply(this,X);return w.cache=je.set(Ee,dt)||je,dt};return w.cache=new(Tm.Cache||Nc),w}Tm.Cache=Nc;var gy=Tm,Uv=500;function Fb(v){var x=gy(v,function(X){return w.size===Uv&&w.clear(),X}),w=x.cache;return x}var Bb=Fb,Nb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,I1=/\\(\\)?/g,L1=Bb(function(v){var x=[];return v.charCodeAt(0)===46&&x.push(""),v.replace(Nb,function(w,X,Ee,je){x.push(Ee?je.replace(I1,"$1"):X||w)}),x}),Mm=L1;function zb(v,x){return Dn(v)?v:o0(v,x)?[v]:Mm(re(v))}var D0=zb,Zb=1/0;function R1(v){if(typeof v=="string"||ca(v))return v;var x=v+"";return x=="0"&&1/v==-Zb?"-0":x}var F0=R1;function Ub(v,x){x=D0(x,v);for(var w=0,X=x.length;v!=null&&w<X;)v=v[F0(x[w++])];return w&&w==X?v:void 0}var Cg=Ub;function s0(v,x,w){var X=v==null?void 0:Cg(v,x);return X===void 0?w:X}var yy=s0;function Ag(v,x){return v!=null&&x in Object(v)}var _y=Ag;function Pm(v,x,w){x=D0(x,v);for(var X=-1,Ee=x.length,je=!1;++X<Ee;){var dt=F0(x[X]);if(!(je=v!=null&&w(v,dt)))break;v=v[dt]}return je||++X!=Ee?je:(Ee=v==null?0:v.length,!!Ee&&eh(Ee)&&Fh(dt,Ee)&&(Dn(v)||Qf(v)))}var xy=Pm;function by(v,x){return v!=null&&xy(v,x,_y)}var Om=by,Ey=1,Im=2;function Tg(v,x){return o0(v)&&O1(x)?bg(F0(v),x):function(w){var X=yy(w,v);return X===void 0&&X===x?Om(w,v):Bp(x,X,Ey|Im)}}var ov=Tg;function wy(v){return v}var Lm=wy;function jb(v){return function(x){return x==null?void 0:x[v]}}var vS=jb;function Sy(v){return function(x){return Cg(x,v)}}var k1=Sy;function mS(v){return o0(v)?vS(F0(v)):k1(v)}var D1=mS;function Vb(v){return typeof v=="function"?v:v==null?Lm:typeof v=="object"?Dn(v)?ov(v[0],v[1]):wg(v):D1(v)}var F1=Vb,Hb="Expected a function";function B1(v){if(typeof v!="function")throw new TypeError(Hb);return function(){var x=arguments;switch(x.length){case 0:return!v.call(this);case 1:return!v.call(this,x[0]);case 2:return!v.call(this,x[0],x[1]);case 3:return!v.call(this,x[0],x[1],x[2])}return!v.apply(this,x)}}var Gb=B1;function N1(v,x,w,X){if(!Rl(v))return v;x=D0(x,v);for(var Ee=-1,je=x.length,dt=je-1,Ct=v;Ct!=null&&++Ee<je;){var qt=F0(x[Ee]),kr=w;if(qt==="__proto__"||qt==="constructor"||qt==="prototype")return v;if(Ee!=dt){var Cn=Ct[qt];kr=X?X(Cn,qt,Ct):void 0,kr===void 0&&(kr=Rl(Cn)?Cn:Fh(x[Ee+1])?[]:{})}ia(Ct,qt,kr),Ct=Ct[qt]}return v}var z1=N1;function Z1(v,x,w){for(var X=-1,Ee=x.length,je={};++X<Ee;){var dt=x[X],Ct=Cg(v,dt);w(Ct,dt)&&z1(je,D0(dt,v),Ct)}return je}var U1=Z1;function j1(v,x){if(v==null)return{};var w=pn(Wl(v),function(X){return[X]});return x=F1(x),U1(v,w,function(X,Ee){return x(X,Ee[0])})}var V1=j1;function H1(v,x){return V1(v,Gb(F1(x)))}var Cy=H1;function G1(v,x){return Y1(v)||X1(v,x)||W1(v,x)||$1()}function $1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W1(v,x){if(v){if(typeof v=="string")return Ay(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return Ay(v,x)}}function Ay(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function X1(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function Y1(v){if(Array.isArray(v))return v}var K1=function(x){var w=x.popperPlacement,X=x.btnText,Ee=x.title,je=x.vertical,dt=x.position,Ct=x.className,qt=x.options,kr=x.popperTrigger,Cn=x.popperClassName,Di=x.btnIcon,Ma=x.style,uo=x.onAdd,Ka=x.onRemove,Oa=x.onShow,fo=x.onHide,Ao=x.onPopperShow,mo=x.onPopperHide,Os=x.onSelectChange,au=es(),Su=(0,k.useState)(),wl=G1(Su,2),Us=wl[0],du=wl[1],Is=(0,k.useMemo)(function(){return fr(Ma)},[Ma]),Gs=mg(Di),fl=Gs.portal,ni=Gs.dom,En=(0,k.useMemo)(function(){return{popperPlacement:w,popperTrigger:kr,popperClassName:Cn,btnText:X,title:Ee,vertical:je,position:dt,className:Ct,options:qt,style:Is,btnIcon:ni}},[qt,w,kr,Cn,X,Ee,je,dt,Ct,Is,ni]);return jc(function(){var Zn=new D.MapTheme(Cy(En,function(la){return la===void 0}));du(Zn),au.addControl(Zn)}),zt(function(){Us&&(au.removeControl(Us),du(void 0))}),Sm(Us,En),wm(Us,{add:uo,remove:Ka,show:Oa,hide:fo,popperShow:Ao,popperHide:mo,selectChange:Os}),k.createElement(k.Fragment,null,fl)};function q1(v,x){return t_(v)||e_(v,x)||J1(v,x)||Q1()}function Q1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J1(v,x){if(v){if(typeof v=="string")return Gh(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return Gh(v,x)}}function Gh(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function e_(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function t_(v){if(Array.isArray(v))return v}var $b=function(x){var w=x.position,X=x.className,Ee=x.style,je=x.onLocationChange,dt=x.transform,Ct=x.onAdd,qt=x.onRemove,kr=x.onShow,Cn=x.onHide,Di=useScene(),Ma=useState(),uo=q1(Ma,2),Ka=uo[0],Oa=uo[1],fo=useMemo(function(){return getStyleText(Ee)},[Ee]),Ao=useMemo(function(){return{transform:dt,position:w,className:X,style:fo}},[dt,w,X,fo]);return useMount(function(){var mo=new L7MouseLocation(omitBy(Ao,function(Os){return Os===void 0}));Oa(mo),Di.addControl(mo)}),useUnmount(function(){Ka&&(Di.removeControl(Ka),Oa(void 0))}),useL7ComponentUpdate(Ka,Ao),useL7ComponentEvent(Ka,{add:Ct,remove:qt,show:kr,hide:Cn,locationChange:je}),null};function r_(v,x){return o_(v)||a_(v,x)||i_(v,x)||n_()}function n_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i_(v,x){if(v){if(typeof v=="string")return Ty(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return Ty(v,x)}}function Ty(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function a_(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function o_(v){if(Array.isArray(v))return v}var Wb=function(x){var w=x.onShow,X=x.onHide,Ee=x.onAdd,je=x.onRemove,dt=x.position,Ct=x.className,qt=x.style,kr=x.lockWidth,Cn=x.maxWidth,Di=x.metric,Ma=x.imperial,uo=x.updateWhenIdle,Ka=useScene(),Oa=useState(),fo=r_(Oa,2),Ao=fo[0],mo=fo[1],Os=useMemo(function(){return getStyleText(qt)},[qt]),au=useMemo(function(){return{position:dt,className:Ct,style:Os,lockWidth:kr,maxWidth:Cn,metric:Di,imperial:Ma,updateWhenIdle:uo}},[dt,Ct,Os,kr,Cn,Di,Ma,uo]);return useMount(function(){var Su=new L7Scale(omitBy(au,function(wl){return wl===void 0}));mo(Su),Ka.addControl(Su)}),useUnmount(function(){Ao&&(Ka.removeControl(Ao),mo(void 0))}),useL7ComponentUpdate(Ao,au),useL7ComponentEvent(Ao,{add:Ee,remove:je,show:w,hide:X}),null};function s_(v,x){return f_(v)||c_(v,x)||l_(v,x)||u_()}function u_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l_(v,x){if(v){if(typeof v=="string")return My(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return My(v,x)}}function My(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function c_(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function f_(v){if(Array.isArray(v))return v}var gS=function(x){var w=x.onShow,X=x.onHide,Ee=x.onAdd,je=x.onRemove,dt=x.position,Ct=x.name,qt=x.className,kr=x.style,Cn=x.zoomInText,Di=x.zoomOutText,Ma=x.zoomInTitle,uo=x.zoomOutTitle,Ka=useScene(),Oa=useState(),fo=s_(Oa,2),Ao=fo[0],mo=fo[1],Os=useMemo(function(){return getStyleText(kr)},[kr]),au=useL7ComponentPortal(Cn),Su=au.portal,wl=au.dom,Us=useL7ComponentPortal(Di),du=Us.portal,Is=Us.dom,Gs=useMemo(function(){return{position:dt,name:Ct,className:qt,zoomInTitle:Ma,zoomOutTitle:uo,style:Os,zoomInText:wl,zoomOutText:Is}},[dt,Ct,qt,Os,Ma,uo,wl,Is]);return useMount(function(){var fl=new L7Zoom(omitBy(Gs,function(ni){return ni===void 0}));mo(fl),Ka.addControl(fl)}),useUnmount(function(){Ao&&(Ka.removeControl(Ao),mo(void 0))}),useL7ComponentUpdate(Ao,Gs),useL7ComponentEvent(Ao,{add:Ee,remove:je,show:w,hide:X}),React.createElement(React.Fragment,null,Su,du)};function Xb(v,x){return d_(v)||p_(v,x)||Kb(v,x)||Yb()}function Yb(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kb(v,x){if(v){if(typeof v=="string")return h_(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return h_(v,x)}}function h_(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function p_(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function d_(v){if(Array.isArray(v))return v}var qb=function(x){var w=x.img,X=x.href,Ee=x.position,je=x.className,dt=x.style,Ct=x.onShow,qt=x.onHide,kr=x.onAdd,Cn=x.onRemove,Di=useScene(),Ma=useState(),uo=Xb(Ma,2),Ka=uo[0],Oa=uo[1],fo=useMemo(function(){return getStyleText(dt)},[dt]),Ao=useMemo(function(){return{img:w,href:X,position:Ee,className:je,style:fo}},[w,X,Ee,je,fo]);return useMount(function(){var mo=new L7Logo(omitBy(Ao,function(Os){return Os===void 0}));Oa(mo),Di.addControl(mo)}),useUnmount(function(){Ka&&(Di.removeControl(Ka),Oa(void 0))}),useL7ComponentUpdate(Ka,Ao),useL7ComponentEvent(Ka,{add:kr,remove:Cn,show:Ct,hide:qt}),null},Qb=function(x){var w=x.title,X=x.className,Ee=x.style;return React.createElement("h1",{className:classNames("".concat(CLS_PREFIX,"_decoration"),X),style:Ee},w)};function Rm(v){return Rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},Rm(v)}function v_(v,x){var w=Object.keys(v);if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(v);x&&(X=X.filter(function(Ee){return Object.getOwnPropertyDescriptor(v,Ee).enumerable})),w.push.apply(w,X)}return w}function m_(v){for(var x=1;x<arguments.length;x++){var w=arguments[x]!=null?arguments[x]:{};x%2?v_(Object(w),!0).forEach(function(X){Jb(v,X,w[X])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(w)):v_(Object(w)).forEach(function(X){Object.defineProperty(v,X,Object.getOwnPropertyDescriptor(w,X))})}return v}function Jb(v,x,w){return x=e2(x),x in v?Object.defineProperty(v,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[x]=w,v}function e2(v){var x=t2(v,"string");return Rm(x)==="symbol"?x:String(x)}function t2(v,x){if(Rm(v)!=="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var X=w.call(v,x||"default");if(Rm(X)!=="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}var r2=(0,k.memo)(function(x){var w=es(),X=(0,k.useRef)({props:x});X.current.props=x;var Ee=(0,k.useMemo)(function(){var je=!1;k.Children.forEach(x.children,function(qt){qt&&(je=!0)});var dt=m_(m_({},x),{},{element:je?document.createElement("div"):null}),Ct=new D.Marker(dt);return Ct.on("click",function(qt){var kr,Cn;(kr=(Cn=X.current.props).onClick)===null||kr===void 0||kr.call(Cn,qt)}),Ct},[]);return W(function(){Ee.setLnglat(x.lngLat)},[x.lngLat]),(0,k.useEffect)(function(){return w.addMarker(Ee),function(){Ee.remove()}},[]),(0,Ev.createPortal)(x.children,Ee.getElement())});function n2(v,x){return s2(v)||o2(v,x)||a2(v,x)||i2()}function i2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a2(v,x){if(v){if(typeof v=="string")return g_(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return g_(v,x)}}function g_(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function o2(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function s2(v){if(Array.isArray(v))return v}var yS=function(x){var w=x.style,X=x.closeButton,Ee=x.closeButtonOffsets,je=x.closeOnClick,dt=x.closeOnEsc,Ct=x.maxWidth,qt=x.anchor,kr=x.offsets,Cn=x.stopPropagation,Di=x.autoPan,Ma=x.autoClose,uo=x.followCursor,Ka=x.className,Oa=x.lngLat,fo=x.children,Ao=x.title,mo=x.onOpen,Os=x.onClose,au=x.onShow,Su=x.onHide,wl=useScene(),Us=useState(),du=n2(Us,2),Is=du[0],Gs=du[1],fl=useMemo(function(){return getStyleText(w)},[w]),ni=useL7ComponentPortal(fo),En=ni.portal,Zn=ni.dom,la=useL7ComponentPortal(Ao),ja=la.portal,Fa=la.dom,ru=useMemo(function(){return{style:fl,closeButton:X,closeButtonOffsets:Ee,closeOnClick:je,closeOnEsc:dt,maxWidth:Ct,anchor:qt,offsets:kr,stopPropagation:Cn,autoPan:Di,autoClose:Ma,followCursor:uo,className:Ka,lngLat:Oa,html:Zn,title:Fa}},[fl,X,JSON.stringify(Ee),je,dt,Ct,qt,JSON.stringify(kr),Cn,Di,Ma,uo,Ka,Zn,Fa,JSON.stringify(Oa)]);return useMount(function(){var dl=new L7Popup(omitBy(ru,function(Ll){return Ll===void 0}));Gs(dl),wl.addPopup(dl)}),useUnmount(function(){Is&&(wl.removePopup(Is),Gs(void 0))}),useL7ComponentUpdate(Is,ru),useL7ComponentEvent(Is,{open:mo,close:Os,show:au,hide:Su}),React.createElement(React.Fragment,null,En,ja)},Mg=function(x,w){if(x instanceof Function){var X=document.createElement(w);return function(){var dt=x.apply(void 0,arguments),Ct=Ev.createPortal(dt,X);return Ev.render(Ct,X),X}}else{var Ee=document.createElement(w),je=Ev.createPortal(x,Ee);return Ev.render(je,Ee),Ee}};function u2(v){return $u(v)||c2(v)||Py(v)||l2()}function l2(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c2(v){if(typeof Symbol!="undefined"&&v[Symbol.iterator]!=null||v["@@iterator"]!=null)return Array.from(v)}function $u(v){if(Array.isArray(v))return B0(v)}function Sv(v,x){return x_(v)||__(v,x)||Py(v,x)||y_()}function y_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Py(v,x){if(v){if(typeof v=="string")return B0(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return B0(v,x)}}function B0(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function __(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function x_(v){if(Array.isArray(v))return v}var f2=function(x){var w=x.style,X=x.closeButton,Ee=x.closeButtonOffsets,je=x.closeOnClick,dt=x.closeOnEsc,Ct=x.maxWidth,qt=x.anchor,kr=x.offsets,Cn=x.stopPropagation,Di=x.autoPan,Ma=x.autoClose,uo=x.className,Ka=x.lngLat,Oa=x.items,fo=x.trigger,Ao=x.onOpen,mo=x.onClose,Os=x.onShow,au=x.onHide,Su=es(),wl=(0,k.useState)(),Us=Sv(wl,2),du=Us[0],Is=Us[1],Gs=(0,k.useMemo)(function(){return fr(w)},[w]),fl=nf(),ni=(0,k.useMemo)(function(){var Zn=[];return Oa.forEach(function(la){var ja;if(typeof la.layer=="string"){var Fa=fl.find(function(dl){return dl.id===la.layer});if(Fa)ja=Fa;else return}else ja=la.layer;var ru=[];ja.isComposite?ru.push.apply(ru,u2(ja.getInteractionSubLayers())):ru.push(ja),ru.forEach(function(dl){var Ll,Rh={layer:dl};la.title&&(Rh.title=Mg(la.title,"div")),la.customContent&&(Rh.customContent=Mg(la.customContent,"div")),(Ll=la.fields)!==null&&Ll!==void 0&&Ll.length&&(Rh.fields=la.fields.map(function(ff){if(typeof ff=="string")return ff;var kh={field:ff.field,getValue:ff.getValue};return ff.formatField&&(kh.formatField=Mg(ff.formatField,"span")),ff.formatValue&&(kh.formatValue=Mg(ff.formatValue,"span")),kh})),Zn.push(Rh)})}),Zn},[fl,Oa]),En=(0,k.useMemo)(function(){return{style:Gs,closeButton:X,closeButtonOffsets:Ee,closeOnClick:je,closeOnEsc:dt,maxWidth:Ct,anchor:qt,offsets:kr,stopPropagation:Cn,autoPan:Di,autoClose:Ma,followCursor:fo==="hover",className:uo,lngLat:Ka,items:ni,trigger:fo}},[Gs,X,JSON.stringify(Ee),je,dt,Ct,qt,JSON.stringify(kr),Cn,Di,Ma,uo,fo,JSON.stringify(Ka),ni]);return jc(function(){var Zn=new D.LayerPopup(Cy(En,function(la){return la===void 0}));Is(Zn),Su.addPopup(Zn)}),zt(function(){du&&(Su.removePopup(du),Is(void 0))}),Sm(du,En),wm(du,{open:Ao,close:mo,show:Os,hide:au}),k.createElement(k.Fragment,null)},b_="larkmap-context-menu",h2="[object Map]",E_="[object Set]",w_=Object.prototype,S_=w_.hasOwnProperty;function Oy(v){if(v==null)return!0;if(Td(v)&&(Dn(v)||typeof v=="string"||typeof v.splice=="function"||Xs(v)||zh(v)||Qf(v)))return!v.length;var x=gd(v);if(x==h2||x==E_)return!v.size;if(th(v))return!nc(v).length;for(var w in v)if(S_.call(v,w))return!1;return!0}var C_=Oy,p2=(0,k.memo)(function(x){var w=x.text,X=w===void 0?"":w,Ee=x.onClick;return C_(X)?null:k.createElement("li",{className:G()("".concat(b_,"__menu-item"),x==null?void 0:x.className),style:x==null?void 0:x.style,onClick:Ee},X)});function d2(v,x){return m2(v)||T_(v,x)||v2(v,x)||A_()}function A_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v2(v,x){if(v){if(typeof v=="string")return Iy(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return Iy(v,x)}}function Iy(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function T_(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function m2(v){if(Array.isArray(v))return v}var g2=function(x){var w=es(),X=(0,k.useState)({visible:!1,position:void 0}),Ee=d2(X,2),je=Ee[0],dt=Ee[1],Ct=(0,k.useMemo)(function(){return k.createElement("div",{className:G()("".concat(b_),x==null?void 0:x.className),style:x==null?void 0:x.style},x==null?void 0:x.children)},[x]),qt=function(Di){var Ma=Di.lnglat,uo=Ma.lng,Ka=Ma.lat;dt({visible:!0,position:{lng:uo,lat:Ka}})},kr=function(){var Di=setTimeout(function(){Di&&(clearTimeout(Di),dt({visible:!1,position:void 0}))},0)};return(0,k.useEffect)(function(){return w&&(w.on("contextmenu",qt),w.on("click",kr)),function(){w.off("contextmenu",qt),w.off("click",kr)}},[w]),je.visible?k.createElement(r2,{lngLat:je.position,anchor:"top-left"},Ct):null};g2.Item=p2;var y2=I(38018),Ly=I(1413),M_=I(45191),P_=I(89099),Pg=function(x,w){return k.createElement(P_.Z,(0,Ly.Z)((0,Ly.Z)({},x),{},{ref:w,icon:M_.Z}))};Pg.displayName="SearchOutlined";var O_=k.forwardRef(Pg),_2=I(23279),sv=I.n(_2);function I_(v,x){var w;$e&&(qn(v)||console.error(`useDebounceFn expected parameter is a function, got ${typeof v}`));const X=Un(v),Ee=(w=x==null?void 0:x.wait)!==null&&w!==void 0?w:1e3,je=(0,k.useMemo)(()=>sv()((...dt)=>X.current(...dt),Ee,x),[]);return zt(()=>{je.cancel()}),{run:je,cancel:je.cancel,flush:je.flush}}var L_=I_,Ry=I(87787);function x2(v){var x=v==null?0:v.length;return x?v[x-1]:void 0}var b2=x2;function E2(v,x,w){var X=-1,Ee=v.length;x<0&&(x=-x>Ee?0:Ee+x),w=w>Ee?Ee:w,w<0&&(w+=Ee),Ee=x>w?0:w-x>>>0,x>>>=0;for(var je=Array(Ee);++X<Ee;)je[X]=v[X+x];return je}var w2=E2;function R_(v,x){return x.length<2?v:Cg(v,w2(x,0,-1))}var k_=R_;function S2(v,x){return x=D0(x,v),v=k_(v,x),v==null||delete v[F0(b2(x))]}var C2=S2,A2="[object Object]",T2=Function.prototype,M2=Object.prototype,ky=T2.toString,D_=M2.hasOwnProperty,P2=ky.call(Object);function O2(v){if(!be(v)||oe(v)!=A2)return!1;var x=xu(v);if(x===null)return!0;var w=D_.call(x,"constructor")&&x.constructor;return typeof w=="function"&&w instanceof w&&ky.call(w)==P2}var I2=O2;function L2(v){return I2(v)?void 0:v}var R2=L2,Dy=Ge?Ge.isConcatSpreadable:void 0;function F_(v){return Dn(v)||Qf(v)||!!(Dy&&v&&v[Dy])}var k2=F_;function B_(v,x,w,X,Ee){var je=-1,dt=v.length;for(w||(w=k2),Ee||(Ee=[]);++je<dt;){var Ct=v[je];x>0&&w(Ct)?x>1?B_(Ct,x-1,w,X,Ee):Do(Ee,Ct):X||(Ee[Ee.length]=Ct)}return Ee}var D2=B_;function F2(v){var x=v==null?0:v.length;return x?D2(v,1):[]}var B2=F2;function N_(v,x,w){switch(w.length){case 0:return v.call(x);case 1:return v.call(x,w[0]);case 2:return v.call(x,w[0],w[1]);case 3:return v.call(x,w[0],w[1],w[2])}return v.apply(x,w)}var z_=N_,Z_=Math.max;function N2(v,x,w){return x=Z_(x===void 0?v.length-1:x,0),function(){for(var X=arguments,Ee=-1,je=Z_(X.length-x,0),dt=Array(je);++Ee<je;)dt[Ee]=X[x+Ee];Ee=-1;for(var Ct=Array(x+1);++Ee<x;)Ct[Ee]=X[Ee];return Ct[x]=w(dt),z_(v,this,Ct)}}var z2=N2;function Z2(v){return function(){return v}}var U2=Z2,U_=bi?function(v,x){return bi(v,"toString",{configurable:!0,enumerable:!1,value:U2(x),writable:!0})}:Lm,j_=U_,j2=800,V2=16,H2=Date.now;function G2(v){var x=0,w=0;return function(){var X=H2(),Ee=V2-(X-w);if(w=X,Ee>0){if(++x>=j2)return arguments[0]}else x=0;return v.apply(void 0,arguments)}}var $2=G2,V_=$2(j_),H_=V_;function W2(v){return H_(z2(v,void 0,B2),v+"")}var X2=W2,Y2=1,K2=2,q2=4,G_=X2(function(v,x){var w={};if(v==null)return w;var X=!1;x=pn(x,function(je){return je=D0(je,v),X||(X=je.length>1),je}),sa(v,Wl(v),w),X&&(w=rn(w,Y2|K2|q2,R2));for(var Ee=x.length;Ee--;)C2(w,x[Ee]);return w}),$_=G_;function km(v){return km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},km(v)}var Q2=["prefixCls","bordered","className","getPopupContainer","dropdownClassName","popupClassName","listHeight","placement","listItemHeight","disabled","notFoundContent","showArrow"];function Fy(){return Fy=Object.assign?Object.assign.bind():function(v){for(var x=1;x<arguments.length;x++){var w=arguments[x];for(var X in w)Object.prototype.hasOwnProperty.call(w,X)&&(v[X]=w[X])}return v},Fy.apply(this,arguments)}function J2(v,x,w){return x=eE(x),x in v?Object.defineProperty(v,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[x]=w,v}function eE(v){var x=W_(v,"string");return km(x)==="symbol"?x:String(x)}function W_(v,x){if(km(v)!=="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var X=w.call(v,x||"default");if(km(X)!=="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}function X_(v,x){if(v==null)return{};var w=tE(v,x),X,Ee;if(Object.getOwnPropertySymbols){var je=Object.getOwnPropertySymbols(v);for(Ee=0;Ee<je.length;Ee++)X=je[Ee],!(x.indexOf(X)>=0)&&Object.prototype.propertyIsEnumerable.call(v,X)&&(w[X]=v[X])}return w}function tE(v,x){if(v==null)return{};var w={},X=Object.keys(v),Ee,je;for(je=0;je<X.length;je++)Ee=X[je],!(x.indexOf(Ee)>=0)&&(w[Ee]=v[Ee]);return w}var Y_="SECRET_COMBOBOX_MODE_DO_NOT_USE",K_="larkmap-select",rE=function(x,w){var X=x.prefixCls,Ee=x.bordered,je=Ee===void 0?!0:Ee,dt=x.className,Ct=x.getPopupContainer,qt=x.dropdownClassName,kr=x.popupClassName,Cn=x.listHeight,Di=Cn===void 0?256:Cn,Ma=x.placement,uo=x.listItemHeight,Ka=uo===void 0?24:uo,Oa=x.disabled,fo=x.notFoundContent,Ao=x.showArrow,mo=X_(x,Q2),Os=k.useMemo(function(){var wl=mo,Us=wl.mode;if(Us!=="combobox")return Us===Y_?"combobox":Us},[mo]),au=$_(mo,"suffixIcon","itemIcon"),Su=G()(J2({},"".concat(K_,"-borderless"),!je),dt);return k.createElement(Ry.ZP,Fy({ref:w},au,{listHeight:Di,listItemHeight:Ka,mode:Os,prefixCls:K_,placement:Ma,notFoundContent:fo!=null?fo:"\u5F53\u524D\u65E0\u6570\u636E",className:Su,getPopupContainer:Ct,dropdownClassName:kr,showArrow:Ao,disabled:Oa}))},Og=k.forwardRef(rE);Og.SECRET_COMBOBOX_MODE_DO_NOT_USE=Y_,Og.Option=Ry.Wx,Og.OptGroup=Ry.Xo;var By=Og,Ig="larkmap-location-search",q_="https://restapi.amap.com/v3/assistant/inputtips";function u0(v){return u0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},u0(v)}var N0=["searchParams","showDistrict","showAddress","onSearchFinish","onChange"];function Lg(){return Lg=Object.assign?Object.assign.bind():function(v){for(var x=1;x<arguments.length;x++){var w=arguments[x];for(var X in w)Object.prototype.hasOwnProperty.call(w,X)&&(v[X]=w[X])}return v},Lg.apply(this,arguments)}function Ny(){"use strict";Ny=function(){return v};var v={},x=Object.prototype,w=x.hasOwnProperty,X=Object.defineProperty||function(ni,En,Zn){ni[En]=Zn.value},Ee=typeof Symbol=="function"?Symbol:{},je=Ee.iterator||"@@iterator",dt=Ee.asyncIterator||"@@asyncIterator",Ct=Ee.toStringTag||"@@toStringTag";function qt(ni,En,Zn){return Object.defineProperty(ni,En,{value:Zn,enumerable:!0,configurable:!0,writable:!0}),ni[En]}try{qt({},"")}catch(ni){qt=function(Zn,la,ja){return Zn[la]=ja}}function kr(ni,En,Zn,la){var ja=En&&En.prototype instanceof Ma?En:Ma,Fa=Object.create(ja.prototype),ru=new Is(la||[]);return X(Fa,"_invoke",{value:Su(ni,Zn,ru)}),Fa}function Cn(ni,En,Zn){try{return{type:"normal",arg:ni.call(En,Zn)}}catch(la){return{type:"throw",arg:la}}}v.wrap=kr;var Di={};function Ma(){}function uo(){}function Ka(){}var Oa={};qt(Oa,je,function(){return this});var fo=Object.getPrototypeOf,Ao=fo&&fo(fo(Gs([])));Ao&&Ao!==x&&w.call(Ao,je)&&(Oa=Ao);var mo=Ka.prototype=Ma.prototype=Object.create(Oa);function Os(ni){["next","throw","return"].forEach(function(En){qt(ni,En,function(Zn){return this._invoke(En,Zn)})})}function au(ni,En){function Zn(ja,Fa,ru,dl){var Ll=Cn(ni[ja],ni,Fa);if(Ll.type!=="throw"){var Rh=Ll.arg,ff=Rh.value;return ff&&u0(ff)=="object"&&w.call(ff,"__await")?En.resolve(ff.__await).then(function(kh){Zn("next",kh,ru,dl)},function(kh){Zn("throw",kh,ru,dl)}):En.resolve(ff).then(function(kh){Rh.value=kh,ru(Rh)},function(kh){return Zn("throw",kh,ru,dl)})}dl(Ll.arg)}var la;X(this,"_invoke",{value:function(Fa,ru){function dl(){return new En(function(Ll,Rh){Zn(Fa,ru,Ll,Rh)})}return la=la?la.then(dl,dl):dl()}})}function Su(ni,En,Zn){var la="suspendedStart";return function(ja,Fa){if(la==="executing")throw new Error("Generator is already running");if(la==="completed"){if(ja==="throw")throw Fa;return fl()}for(Zn.method=ja,Zn.arg=Fa;;){var ru=Zn.delegate;if(ru){var dl=wl(ru,Zn);if(dl){if(dl===Di)continue;return dl}}if(Zn.method==="next")Zn.sent=Zn._sent=Zn.arg;else if(Zn.method==="throw"){if(la==="suspendedStart")throw la="completed",Zn.arg;Zn.dispatchException(Zn.arg)}else Zn.method==="return"&&Zn.abrupt("return",Zn.arg);la="executing";var Ll=Cn(ni,En,Zn);if(Ll.type==="normal"){if(la=Zn.done?"completed":"suspendedYield",Ll.arg===Di)continue;return{value:Ll.arg,done:Zn.done}}Ll.type==="throw"&&(la="completed",Zn.method="throw",Zn.arg=Ll.arg)}}}function wl(ni,En){var Zn=En.method,la=ni.iterator[Zn];if(la===void 0)return En.delegate=null,Zn==="throw"&&ni.iterator.return&&(En.method="return",En.arg=void 0,wl(ni,En),En.method==="throw")||Zn!=="return"&&(En.method="throw",En.arg=new TypeError("The iterator does not provide a '"+Zn+"' method")),Di;var ja=Cn(la,ni.iterator,En.arg);if(ja.type==="throw")return En.method="throw",En.arg=ja.arg,En.delegate=null,Di;var Fa=ja.arg;return Fa?Fa.done?(En[ni.resultName]=Fa.value,En.next=ni.nextLoc,En.method!=="return"&&(En.method="next",En.arg=void 0),En.delegate=null,Di):Fa:(En.method="throw",En.arg=new TypeError("iterator result is not an object"),En.delegate=null,Di)}function Us(ni){var En={tryLoc:ni[0]};1 in ni&&(En.catchLoc=ni[1]),2 in ni&&(En.finallyLoc=ni[2],En.afterLoc=ni[3]),this.tryEntries.push(En)}function du(ni){var En=ni.completion||{};En.type="normal",delete En.arg,ni.completion=En}function Is(ni){this.tryEntries=[{tryLoc:"root"}],ni.forEach(Us,this),this.reset(!0)}function Gs(ni){if(ni){var En=ni[je];if(En)return En.call(ni);if(typeof ni.next=="function")return ni;if(!isNaN(ni.length)){var Zn=-1,la=function ja(){for(;++Zn<ni.length;)if(w.call(ni,Zn))return ja.value=ni[Zn],ja.done=!1,ja;return ja.value=void 0,ja.done=!0,ja};return la.next=la}}return{next:fl}}function fl(){return{value:void 0,done:!0}}return uo.prototype=Ka,X(mo,"constructor",{value:Ka,configurable:!0}),X(Ka,"constructor",{value:uo,configurable:!0}),uo.displayName=qt(Ka,Ct,"GeneratorFunction"),v.isGeneratorFunction=function(ni){var En=typeof ni=="function"&&ni.constructor;return!!En&&(En===uo||(En.displayName||En.name)==="GeneratorFunction")},v.mark=function(ni){return Object.setPrototypeOf?Object.setPrototypeOf(ni,Ka):(ni.__proto__=Ka,qt(ni,Ct,"GeneratorFunction")),ni.prototype=Object.create(mo),ni},v.awrap=function(ni){return{__await:ni}},Os(au.prototype),qt(au.prototype,dt,function(){return this}),v.AsyncIterator=au,v.async=function(ni,En,Zn,la,ja){ja===void 0&&(ja=Promise);var Fa=new au(kr(ni,En,Zn,la),ja);return v.isGeneratorFunction(En)?Fa:Fa.next().then(function(ru){return ru.done?ru.value:Fa.next()})},Os(mo),qt(mo,Ct,"Generator"),qt(mo,je,function(){return this}),qt(mo,"toString",function(){return"[object Generator]"}),v.keys=function(ni){var En=Object(ni),Zn=[];for(var la in En)Zn.push(la);return Zn.reverse(),function ja(){for(;Zn.length;){var Fa=Zn.pop();if(Fa in En)return ja.value=Fa,ja.done=!1,ja}return ja.done=!0,ja}},v.values=Gs,Is.prototype={constructor:Is,reset:function(En){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(du),!En)for(var Zn in this)Zn.charAt(0)==="t"&&w.call(this,Zn)&&!isNaN(+Zn.slice(1))&&(this[Zn]=void 0)},stop:function(){this.done=!0;var En=this.tryEntries[0].completion;if(En.type==="throw")throw En.arg;return this.rval},dispatchException:function(En){if(this.done)throw En;var Zn=this;function la(Rh,ff){return ru.type="throw",ru.arg=En,Zn.next=Rh,ff&&(Zn.method="next",Zn.arg=void 0),!!ff}for(var ja=this.tryEntries.length-1;ja>=0;--ja){var Fa=this.tryEntries[ja],ru=Fa.completion;if(Fa.tryLoc==="root")return la("end");if(Fa.tryLoc<=this.prev){var dl=w.call(Fa,"catchLoc"),Ll=w.call(Fa,"finallyLoc");if(dl&&Ll){if(this.prev<Fa.catchLoc)return la(Fa.catchLoc,!0);if(this.prev<Fa.finallyLoc)return la(Fa.finallyLoc)}else if(dl){if(this.prev<Fa.catchLoc)return la(Fa.catchLoc,!0)}else{if(!Ll)throw new Error("try statement without catch or finally");if(this.prev<Fa.finallyLoc)return la(Fa.finallyLoc)}}}},abrupt:function(En,Zn){for(var la=this.tryEntries.length-1;la>=0;--la){var ja=this.tryEntries[la];if(ja.tryLoc<=this.prev&&w.call(ja,"finallyLoc")&&this.prev<ja.finallyLoc){var Fa=ja;break}}Fa&&(En==="break"||En==="continue")&&Fa.tryLoc<=Zn&&Zn<=Fa.finallyLoc&&(Fa=null);var ru=Fa?Fa.completion:{};return ru.type=En,ru.arg=Zn,Fa?(this.method="next",this.next=Fa.finallyLoc,Di):this.complete(ru)},complete:function(En,Zn){if(En.type==="throw")throw En.arg;return En.type==="break"||En.type==="continue"?this.next=En.arg:En.type==="return"?(this.rval=this.arg=En.arg,this.method="return",this.next="end"):En.type==="normal"&&Zn&&(this.next=Zn),Di},finish:function(En){for(var Zn=this.tryEntries.length-1;Zn>=0;--Zn){var la=this.tryEntries[Zn];if(la.finallyLoc===En)return this.complete(la.completion,la.afterLoc),du(la),Di}},catch:function(En){for(var Zn=this.tryEntries.length-1;Zn>=0;--Zn){var la=this.tryEntries[Zn];if(la.tryLoc===En){var ja=la.completion;if(ja.type==="throw"){var Fa=ja.arg;du(la)}return Fa}}throw new Error("illegal catch attempt")},delegateYield:function(En,Zn,la){return this.delegate={iterator:Gs(En),resultName:Zn,nextLoc:la},this.method==="next"&&(this.arg=void 0),Di}},v}function Q_(v){return iE(v)||nE(v)||jy(v)||J_()}function J_(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nE(v){if(typeof Symbol!="undefined"&&v[Symbol.iterator]!=null||v["@@iterator"]!=null)return Array.from(v)}function iE(v){if(Array.isArray(v))return Vy(v)}function ex(v,x){var w=Object.keys(v);if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(v);x&&(X=X.filter(function(Ee){return Object.getOwnPropertyDescriptor(v,Ee).enumerable})),w.push.apply(w,X)}return w}function zy(v){for(var x=1;x<arguments.length;x++){var w=arguments[x]!=null?arguments[x]:{};x%2?ex(Object(w),!0).forEach(function(X){tx(v,X,w[X])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(w)):ex(Object(w)).forEach(function(X){Object.defineProperty(v,X,Object.getOwnPropertyDescriptor(w,X))})}return v}function tx(v,x,w){return x=rx(x),x in v?Object.defineProperty(v,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[x]=w,v}function rx(v){var x=Zy(v,"string");return u0(x)==="symbol"?x:String(x)}function Zy(v,x){if(u0(v)!=="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var X=w.call(v,x||"default");if(u0(X)!=="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}function Uy(v,x,w,X,Ee,je,dt){try{var Ct=v[je](dt),qt=Ct.value}catch(kr){w(kr);return}Ct.done?x(qt):Promise.resolve(qt).then(X,Ee)}function aE(v){return function(){var x=this,w=arguments;return new Promise(function(X,Ee){var je=v.apply(x,w);function dt(qt){Uy(je,X,Ee,dt,Ct,"next",qt)}function Ct(qt){Uy(je,X,Ee,dt,Ct,"throw",qt)}dt(void 0)})}}function nx(v,x){return sE(v)||ix(v,x)||jy(v,x)||oE()}function oE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jy(v,x){if(v){if(typeof v=="string")return Vy(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return Vy(v,x)}}function Vy(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function ix(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function sE(v){if(Array.isArray(v))return v}function uE(v,x){if(v==null)return{};var w=Dm(v,x),X,Ee;if(Object.getOwnPropertySymbols){var je=Object.getOwnPropertySymbols(v);for(Ee=0;Ee<je.length;Ee++)X=je[Ee],!(x.indexOf(X)>=0)&&Object.prototype.propertyIsEnumerable.call(v,X)&&(w[X]=v[X])}return w}function Dm(v,x){if(v==null)return{};var w={},X=Object.keys(v),Ee,je;for(je=0;je<X.length;je++)Ee=X[je],!(x.indexOf(Ee)>=0)&&(w[Ee]=v[Ee]);return w}var ax=By.Option,Rg=function(x){var w=x.searchParams,X=x.showDistrict,Ee=x.showAddress,je=x.onSearchFinish,dt=x.onChange,Ct=uE(x,N0),qt=(0,k.useState)([]),kr=nx(qt,2),Cn=kr[0],Di=kr[1];(0,k.useEffect)(function(){je==null||je(Cn)},[je,Cn]);var Ma=L_(function(){var Oa=aE(Ny().mark(function fo(Ao){var mo,Os,au,Su;return Ny().wrap(function(Us){for(;;)switch(Us.prev=Us.next){case 0:if(Ao){Us.next=3;break}return Di([]),Us.abrupt("return");case 3:return au=y2.stringifyUrl({url:q_,query:zy(zy({},w),{},{keywords:[].concat(Q_(((mo=w.keywords)!==null&&mo!==void 0?mo:"").split("|")),[Ao]).filter(function(du){return!!du}).join("|")})}),Us.next=6,fetch(au);case 6:return Us.next=8,Us.sent.json();case 8:Su=Us.sent,Di(((Os=Su==null?void 0:Su.tips)!==null&&Os!==void 0?Os:[]).filter(function(du){return du.location&&du.location.length}).map(function(du){var Is=du.location.split(","),Gs=nx(Is,2),fl=Gs[0],ni=Gs[1];return du.longitude=+fl,du.latitude=+ni,du}));case 10:case"end":return Us.stop()}},fo)}));return function(fo){return Oa.apply(this,arguments)}}(),{wait:1e3}),uo=Ma.run,Ka=(0,k.useCallback)(function(Oa){var fo=Oa&&Cn.find(function(Ao){return Ao.name===Oa});dt==null||dt(Oa||void 0,fo||void 0)},[dt,Cn]);return k.createElement(By,Lg({className:"".concat(Ig),onSearch:uo,onChange:Ka,clearIcon:function(){return null}},Ct),Cn.map(function(Oa){var fo="".concat(X?Oa.district:"").concat(Ee?Oa.address:"");return k.createElement(ax,{key:Oa.id,value:Oa.name},k.createElement("div",{title:Oa.name,className:"".concat(Ig,"__option-name")},Oa.name),fo&&k.createElement("div",{title:fo,className:"".concat(Ig,"__option-tip")},fo))}))};Rg.defaultProps={placeholder:"\u8BF7\u8F93\u5165\u8981\u641C\u7D22\u5730\u540D",showSearch:!0,allowClear:!0,suffixIcon:k.createElement(O_,null),filterOption:!1,defaultActiveFirstOption:!1,showAddress:!0,showDistrict:!0};var Hy="larkmap-legend-icon",bd=function(x){var w=x.labels,X=x.icons,Ee=x.className,je=x.style;return React.createElement("div",{className:classnames("".concat(Hy),Ee),style:je},w.map(function(dt,Ct){return React.createElement("div",{key:dt,className:"".concat(Hy,"__content")},React.createElement("img",{src:X[Ct],className:"".concat(Hy,"__content__icon")}),React.createElement("div",null,dt))}))};function lE(v){return Ht(v)&&v!=+v}var Gy=lE,Fm=0;function cE(v){var x=++Fm;return re(v)+x}var fE=cE;function hE(v){return xS(v)||pE(v)||mE(v)||_S()}function _S(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pE(v){if(typeof Symbol!="undefined"&&v[Symbol.iterator]!=null||v["@@iterator"]!=null)return Array.from(v)}function xS(v){if(Array.isArray(v))return ox(v)}function dE(v,x){return gE(v)||bS(v,x)||mE(v,x)||vE()}function vE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mE(v,x){if(v){if(typeof v=="string")return ox(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return ox(v,x)}}function ox(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function bS(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function gE(v){if(Array.isArray(v))return v}var Bm="larkmap-legend-proportion",ES=function(x){var w=x.labels,X=x.fillColor,Ee=X===void 0?"#f9f9f9":X,je=x.className,dt=x.style,Ct=dE(w,2),qt=Ct[0],kr=Ct[1],Cn=[86,62,38,24];function Di(Oa,fo){var Ao=(fo-Oa)/4,mo=Math.floor(Oa+Ao),Os=Math.floor(fo-Ao);return[mo,Os]}function Ma(){var Oa=qt,fo=kr;(!Ht(Oa)||!Ht(Oa))&&(Oa=fo=0),Gy(Oa)&&(Oa=0),Gy(fo)&&(fo=0);var Ao=Di(Oa,fo),mo=[{prefix:"MIN:",val:Oa}].concat(hE(Ao),[{prefix:"MAX:",val:fo}]);return mo}function uo(){return k.createElement("div",{className:"".concat(Bm,"__circlebox"),style:{width:Cn[0]}},Cn.map(function(Oa){return k.createElement("div",{key:Oa,style:{width:Oa,height:Oa,background:Ee},className:"".concat(Bm,"__circlebox__item")})}))}function Ka(){return k.createElement("div",{style:{height:Cn[0]}},Ma().reverse().map(function(Oa){return k.createElement("div",{key:fE(),className:"".concat(Bm,"__labelitem")},Oa==null?void 0:Oa.prefix,typeof Oa=="number"?Oa:Oa.val)}))}return k.createElement("div",{className:G()("".concat(Bm),je),style:dt},k.createElement(uo,null),k.createElement(Ka,null))};ES.defaultProps={fillColor:"#f9f9f9"};var yE=I(6767),sx=I.n(yE);function _E(v){return function(x,w,X){for(var Ee=-1,je=Object(x),dt=X(x),Ct=dt.length;Ct--;){var qt=dt[v?Ct:++Ee];if(w(je[qt],qt,je)===!1)break}return x}}var wS=_E,xE=wS(),bE=xE;function EE(v,x){return v&&bE(v,x,hp)}var kg=EE;function wE(v,x){return function(w,X){if(w==null)return w;if(!Td(w))return v(w,X);for(var Ee=w.length,je=x?Ee:-1,dt=Object(w);(x?je--:++je<Ee)&&X(dt[je],je,dt)!==!1;);return w}}var SS=wE,jv=SS(kg),nh=jv;function Rd(v){return typeof v=="function"?v:Lm}var ih=Rd;function sc(v,x){var w=Dn(v)?Ar:nh;return w(v,ih(x))}var Cv=sc,Da=/\s/;function Nm(v){for(var x=v.length;x--&&Da.test(v.charAt(x)););return x}var zm=Nm,kd=/^\s+/;function SE(v){return v&&v.slice(0,zm(v)+1).replace(kd,"")}var CE=SE,ux=0/0,lx=/^[-+]0x[0-9a-f]+$/i,AE=/^0b[01]+$/i,TE=/^0o[0-7]+$/i,$y=parseInt;function ME(v){if(typeof v=="number")return v;if(ca(v))return ux;if(Rl(v)){var x=typeof v.valueOf=="function"?v.valueOf():v;v=Rl(x)?x+"":x}if(typeof v!="string")return v===0?v:+v;v=CE(v);var w=AE.test(v);return w||TE.test(v)?$y(v.slice(2),w?2:8):lx.test(v)?ux:+v}var Wy=ME,Xy=1/0,PE=17976931348623157e292;function CS(v){if(!v)return v===0?v:0;if(v=Wy(v),v===Xy||v===-Xy){var x=v<0?-1:1;return x*PE}return v===v?v:0}var OE=CS;function IE(v){var x=OE(v),w=x%1;return x===x?w?x-w:x:0}var LE=IE,RE=We.isFinite,kE=Math.min;function DE(v){var x=Math[v];return function(w,X){if(w=Wy(w),X=X==null?0:kE(LE(X),292),X&&RE(w)){var Ee=(re(w)+"e").split("e"),je=x(Ee[0]+"e"+(+Ee[1]+X));return Ee=(re(je)+"e").split("e"),+(Ee[0]+"e"+(+Ee[1]-X))}return x(w)}}var FE=DE,BE=FE("round"),Dg=BE,cx=function(x,w){var X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5,Ee=[x],je=sx()(x).object(),dt=sx()(w).object();if(X<2)return X<1?[]:Ee;var Ct={r:(je.r-dt.r)/(X-1),g:(je.g-dt.g)/(X-1),b:(je.b-dt.b)/(X-1)};return Cv(new Array(X-2),function(qt,kr){return Ee.push(sx()({r:Dg(je.r-Ct.r*(kr+1),0),g:Dg(je.g-Ct.g*(kr+1),0),b:Dg(je.b-Ct.b*(kr+1),0)}).hex())}),Ee.push(w),Ee};function Zm(v){return Zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},Zm(v)}function NE(v,x,w){return x=zE(x),x in v?Object.defineProperty(v,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[x]=w,v}function zE(v){var x=fx(v,"string");return Zm(x)==="symbol"?x:String(x)}function fx(v,x){if(Zm(v)!=="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var X=w.call(v,x||"default");if(Zm(X)!=="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}var Um="larkmap-legend-category";function ZE(v){var x=v.labels,w=v.colors,X=v.geometryType,Ee=X===void 0?"circle":X,je=v.isStrokeColor,dt=v.style,Ct=v.className;function qt(Di){return je?{border:"2px solid ".concat(Di)}:{background:Di}}function kr(Di){return k.createElement("div",{className:G()(Um,Ct),style:dt},x.map(function(Ma,uo){return k.createElement("div",{className:"".concat(Um,"__content"),key:Ma},k.createElement("div",{className:G()("".concat(Um,"__content__shape"),NE({},"".concat(Um,"__content__").concat(Ee),Ee)),style:qt(Di[uo])}),k.createElement("div",{className:"".concat(Um,"labels")},Ma))}))}function Cn(){if(Array.isArray(w))return kr(w);var Di=cx(w.startColor,w.endColor,x.length);return kr(Di)}return k.createElement(Cn,null)}ZE.defaultProps={geometryType:"circle",isStrokeColor:!1};var UE=I(91033);function jE(v){const x=(0,k.useRef)(0),[w,X]=(0,k.useState)(v),Ee=(0,k.useCallback)(je=>{cancelAnimationFrame(x.current),x.current=requestAnimationFrame(()=>{X(je)})},[]);return zt(()=>{cancelAnimationFrame(x.current)}),[w,Ee]}var VE=jE,hx=!!(typeof window!="undefined"&&window.document&&window.document.createElement);function Yy(v,x){if(!hx)return;if(!v)return x;let w;return qn(v)?w=v():"current"in v?w=v.current:w=v,w}function px(v,x){if(v===x)return!0;for(let w=0;w<v.length;w++)if(!Object.is(v[w],x[w]))return!1;return!0}var Fg=v=>(w,X,Ee)=>{const je=(0,k.useRef)(!1),dt=(0,k.useRef)([]),Ct=(0,k.useRef)([]),qt=(0,k.useRef)();v(()=>{var kr;const Di=(Array.isArray(Ee)?Ee:[Ee]).map(Ma=>Yy(Ma));if(!je.current){je.current=!0,dt.current=Di,Ct.current=X,qt.current=w();return}(Di.length!==dt.current.length||!px(Di,dt.current)||!px(X,Ct.current))&&((kr=qt.current)===null||kr===void 0||kr.call(qt),dt.current=Di,Ct.current=X,qt.current=w())}),zt(()=>{var kr;(kr=qt.current)===null||kr===void 0||kr.call(qt),je.current=!1})},GE=Fg(k.useEffect),$E=Fg(k.useLayoutEffect),WE=hx?$E:GE;function z0(v){const[x,w]=VE();return WE(()=>{const X=Yy(v);if(!X)return;const Ee=new UE.Z(je=>{je.forEach(dt=>{const{clientWidth:Ct,clientHeight:qt}=dt.target;w({width:Ct,height:qt})})});return Ee.observe(X),()=>{Ee.disconnect()}},[],v),x}var XE=z0,Vv="larkmap-legend-ramp",OS=function(x){var w=x[x.length-1],X=x[0];return Number.isFinite(X)||(X=parseInt(X,10)),Number.isFinite(w)||(w=parseInt(w,10)),[X,w]};function YE(v){var x=v.labels,w=v.labelUnit,X=w===void 0?"":w,Ee=v.colors,je=x[0]+X,dt=x[x.length-1]+X;return k.createElement(k.Fragment,null,k.createElement("div",{className:"".concat(Vv,"__continuous"),style:{background:"linear-gradient(to right,".concat(Ee,")")}}),k.createElement("div",{className:"".concat(Vv,"__continuous-labelbar")},k.createElement("span",null,je),k.createElement("span",null,dt)))}function KE(v){var x=v.labels,w=v.labelUnit,X=w===void 0?"":w,Ee=v.colors,je=(0,k.useRef)(null),dt=XE(je),Ct=(dt==null?void 0:dt.width)/(Ee.length+1),qt=x;if(x.length+1===Ee.length){var kr="< "+x[0],Cn="\u2265 "+x[x.length-1];qt.unshift(kr),qt.push(Cn)}var Di=function(uo){var Ka="".concat(x[uo]).concat(X," - ").concat(x[uo+1]).concat(X);return Ka};return k.createElement("div",{className:"".concat(Vv,"__dis-continuous"),ref:je},Number.isNaN(Ct)?null:k.createElement(k.Fragment,null,k.createElement("div",{className:"".concat(Vv,"__dis-continuous__colors"),style:{paddingLeft:Ct/2}},Ee==null?void 0:Ee.map(function(Ma,uo){return k.createElement("div",{key:Ma,title:Di(uo),className:"".concat(Vv,"__dis-continuous__color"),style:{background:Ma,width:Ct}})})),k.createElement("div",{className:"".concat(Vv,"__dis-continuous__labels")},x==null?void 0:x.map(function(Ma){var uo=Ma+X;return k.createElement("span",{key:Ma,className:"".concat(Vv,"__dis-continuous__label")},uo)}))))}function qE(v){var x=v.isContinuous,w=v.labels,X=v.colors,Ee=v.labelUnit,je=v.className,dt=v.style;return k.createElement("div",{className:G()("".concat(Vv),je),style:dt},x?k.createElement(YE,{labels:w,labelUnit:Ee,colors:X}):k.createElement(KE,{labels:w,labelUnit:Ee,colors:X}))}qE.defaultProps={isContinuous:!1,labelUnit:""};var jm=I(67135),IS={point:jm.DrawPoint,line:jm.DrawLine,polygon:jm.DrawPolygon,rect:jm.DrawRect,circle:jm.DrawCircle};function Hv(v){return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},Hv(v)}function dx(v,x){var w=Object.keys(v);if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(v);x&&(X=X.filter(function(Ee){return Object.getOwnPropertyDescriptor(v,Ee).enumerable})),w.push.apply(w,X)}return w}function Ky(v){for(var x=1;x<arguments.length;x++){var w=arguments[x]!=null?arguments[x]:{};x%2?dx(Object(w),!0).forEach(function(X){vx(v,X,w[X])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(w)):dx(Object(w)).forEach(function(X){Object.defineProperty(v,X,Object.getOwnPropertyDescriptor(w,X))})}return v}function vx(v,x,w){return x=QE(x),x in v?Object.defineProperty(v,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[x]=w,v}function QE(v){var x=JE(v,"string");return Hv(x)==="symbol"?x:String(x)}function JE(v,x){if(Hv(v)!=="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var X=w.call(v,x||"default");if(Hv(X)!=="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}function mx(v,x){return tw(v)||l0(v,x)||ew(v,x)||LS()}function LS(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ew(v,x){if(v){if(typeof v=="string")return gx(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return gx(v,x)}}function gx(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function l0(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function tw(v){if(Array.isArray(v))return v}var RS=function(x){var w=useScene(),X=useState(function(){var Ka,Oa;return(Ka=x==null||(Oa=x.options)===null||Oa===void 0?void 0:Oa.initialData)!==null&&Ka!==void 0?Ka:[]}),Ee=mx(X,2),je=Ee[0],dt=Ee[1],Ct=useMemo(function(){if(!w)return console.error("useDraw \u53EA\u80FD\u4F7F\u7528\u5728 LarkMap \u5BB9\u5668\u4E2D"),null;var Ka=DRAW_TYPE_MAP[x.type],Oa=new Ka(w,Ky(Ky({},x.options),{},{initialData:je}));return Oa},[w,JSON.stringify(x.options),x.type]),qt=useState(Ct.isEnable()),kr=mx(qt,2),Cn=kr[0],Di=kr[1];useEffect(function(){var Ka=function(){return Di(!0)},Oa=function(){return Di(!1)},fo=function(mo){dt(mo)};return Ct==null||Ct.setData(je),Ct==null||Ct.on(DrawEvent.Enable,Ka),Ct==null||Ct.on(DrawEvent.Disable,Oa),Ct==null||Ct.on(DrawEvent.Change,fo),function(){dt(Ct.getData()),Ct==null||Ct.off(DrawEvent.Enable,Ka),Ct==null||Ct.off(DrawEvent.Disable,Oa),Ct==null||Ct.off(DrawEvent.Change,fo),Ct==null||Ct.destroy()}},[Ct]);var Ma=useCallback(function(Ka){Ct==null||Ct.setData(Ka),dt(Ka)},[Ct]),uo=useMemo(function(){return{enable:Ct==null?void 0:Ct.enable.bind(Ct),disable:Ct==null?void 0:Ct.disable.bind(Ct),getDrawData:Ct==null?void 0:Ct.getData.bind(Ct)}},[Ct]);return Ky({draw:Ct,drawData:je,setDrawData:Ma,isEnable:Cn},uo)};function Av(v){return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},Av(v)}function Bg(v,x){return iw(v)||nw(v,x)||yx(v,x)||rw()}function rw(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yx(v,x){if(v){if(typeof v=="string")return _x(v,x);var w=Object.prototype.toString.call(v).slice(8,-1);if(w==="Object"&&v.constructor&&(w=v.constructor.name),w==="Map"||w==="Set")return Array.from(v);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return _x(v,x)}}function _x(v,x){(x==null||x>v.length)&&(x=v.length);for(var w=0,X=new Array(x);w<x;w++)X[w]=v[w];return X}function nw(v,x){var w=v==null?null:typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(w!=null){var X,Ee,je,dt,Ct=[],qt=!0,kr=!1;try{if(je=(w=w.call(v)).next,x===0){if(Object(w)!==w)return;qt=!1}else for(;!(qt=(X=je.call(w)).done)&&(Ct.push(X.value),Ct.length!==x);qt=!0);}catch(Cn){kr=!0,Ee=Cn}finally{try{if(!qt&&w.return!=null&&(dt=w.return(),Object(dt)!==dt))return}finally{if(kr)throw Ee}}return Ct}}function iw(v){if(Array.isArray(v))return v}function qy(v,x){var w=Object.keys(v);if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(v);x&&(X=X.filter(function(Ee){return Object.getOwnPropertyDescriptor(v,Ee).enumerable})),w.push.apply(w,X)}return w}function xx(v){for(var x=1;x<arguments.length;x++){var w=arguments[x]!=null?arguments[x]:{};x%2?qy(Object(w),!0).forEach(function(X){aw(v,X,w[X])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(w)):qy(Object(w)).forEach(function(X){Object.defineProperty(v,X,Object.getOwnPropertyDescriptor(w,X))})}return v}function aw(v,x,w){return x=Tv(x),x in v?Object.defineProperty(v,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[x]=w,v}function Tv(v){var x=Qy(v,"string");return Av(x)==="symbol"?x:String(x)}function Qy(v,x){if(Av(v)!=="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var X=w.call(v,x||"default");if(Av(X)!=="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}var Gv=function(x,w){var X=x.point,Ee=x.line,je=x.polygon,dt=x.rect,Ct=x.circle,qt=!!X,kr=!!Ee,Cn=!!je,Di=!!dt,Ma=!!Ct,uo=useCallback(function(Is){return xx(xx({},w),Is instanceof Object?Is:{})},[w]),Ka=useDraw({type:"point",options:uo(X)}),Oa=useDraw({type:"line",options:uo(Ee)}),fo=useDraw({type:"polygon",options:uo(je)}),Ao=useDraw({type:"rect",options:uo(dt)}),mo=useDraw({type:"circle",options:uo(Ct)}),Os=useMemo(function(){return fromPairs(toPairs({point:qt?Ka:void 0,line:kr?Oa:void 0,polygon:Cn?fo:void 0,rect:Di?Ao:void 0,circle:Ma?mo:void 0}).filter(function(Is){var Gs=Bg(Is,2),fl=Gs[1];return!!fl}))},[Ka,Oa,fo,Ao,mo,qt,kr,Cn,Di,Ma]),au=useMemo(function(){return fromPairs(toPairs(Os).map(function(Is){var Gs=Bg(Is,2),fl=Gs[0],ni=Gs[1];return[fl,ni.draw]}))},[Os]),Su=useMemo(function(){return fromPairs(toPairs(Os).map(function(Is){var Gs=Bg(Is,2),fl=Gs[0],ni=Gs[1];return[fl,ni.drawData]}))},[Os]),wl=useCallback(function(Is){Object.entries(Is).forEach(function(Gs){var fl,ni=Bg(Gs,2),En=ni[0],Zn=ni[1];(fl=Os[En])===null||fl===void 0||fl.setDrawData(Zn)})},[Os]),Us=useMemo(function(){var Is,Gs;return(Is=(Gs=Object.values(Os).find(function(fl){return fl.isEnable}))===null||Gs===void 0?void 0:Gs.draw)!==null&&Is!==void 0?Is:null},[Os]),du=useCallback(function(Is){Object.values(Os).forEach(function(Gs){var fl,ni;if(Gs){var En=typeof Is=="string"?(fl=(ni=Os[Is])===null||ni===void 0?void 0:ni.draw)!==null&&fl!==void 0?fl:null:Is;if(!En){Gs.disable();return}var Zn=Gs.isEnable;En===Gs.draw?Zn||Gs.enable():Zn&&Gs.disable()}})},[Os]);return{drawMap:au,drawGroupData:Su,setDrawGroupData:wl,activeDraw:Us,setActiveDraw:du}}},86500:function(Ne,fe,I){"use strict";I.d(fe,{T6:function(){return Fe},VD:function(){return Ce},WE:function(){return W},Yt:function(){return We},lC:function(){return m},py:function(){return K},rW:function(){return k},s:function(){return G},ve:function(){return F},vq:function(){return Y}});var D=I(90279);function k(me,Ge,Ke){return{r:(0,D.sh)(me,255)*255,g:(0,D.sh)(Ge,255)*255,b:(0,D.sh)(Ke,255)*255}}function m(me,Ge,Ke){me=(0,D.sh)(me,255),Ge=(0,D.sh)(Ge,255),Ke=(0,D.sh)(Ke,255);var pt=Math.max(me,Ge,Ke),Xe=Math.min(me,Ge,Ke),gt=0,ie=0,ft=(pt+Xe)/2;if(pt===Xe)ie=0,gt=0;else{var ve=pt-Xe;switch(ie=ft>.5?ve/(2-pt-Xe):ve/(pt+Xe),pt){case me:gt=(Ge-Ke)/ve+(Ge<Ke?6:0);break;case Ge:gt=(Ke-me)/ve+2;break;case Ke:gt=(me-Ge)/ve+4;break;default:break}gt/=6}return{h:gt,s:ie,l:ft}}function ae(me,Ge,Ke){return Ke<0&&(Ke+=1),Ke>1&&(Ke-=1),Ke<1/6?me+(Ge-me)*(6*Ke):Ke<1/2?Ge:Ke<2/3?me+(Ge-me)*(2/3-Ke)*6:me}function F(me,Ge,Ke){var pt,Xe,gt;if(me=(0,D.sh)(me,360),Ge=(0,D.sh)(Ge,100),Ke=(0,D.sh)(Ke,100),Ge===0)Xe=Ke,gt=Ke,pt=Ke;else{var ie=Ke<.5?Ke*(1+Ge):Ke+Ge-Ke*Ge,ft=2*Ke-ie;pt=ae(ft,ie,me+1/3),Xe=ae(ft,ie,me),gt=ae(ft,ie,me-1/3)}return{r:pt*255,g:Xe*255,b:gt*255}}function K(me,Ge,Ke){me=(0,D.sh)(me,255),Ge=(0,D.sh)(Ge,255),Ke=(0,D.sh)(Ke,255);var pt=Math.max(me,Ge,Ke),Xe=Math.min(me,Ge,Ke),gt=0,ie=pt,ft=pt-Xe,ve=pt===0?0:ft/pt;if(pt===Xe)gt=0;else{switch(pt){case me:gt=(Ge-Ke)/ft+(Ge<Ke?6:0);break;case Ge:gt=(Ke-me)/ft+2;break;case Ke:gt=(me-Ge)/ft+4;break;default:break}gt/=6}return{h:gt,s:ve,v:ie}}function W(me,Ge,Ke){me=(0,D.sh)(me,360)*6,Ge=(0,D.sh)(Ge,100),Ke=(0,D.sh)(Ke,100);var pt=Math.floor(me),Xe=me-pt,gt=Ke*(1-Ge),ie=Ke*(1-Xe*Ge),ft=Ke*(1-(1-Xe)*Ge),ve=pt%6,Ae=[Ke,ie,gt,gt,ft,Ke][ve],Re=[ft,Ke,Ke,ie,gt,gt][ve],Ye=[gt,gt,ft,Ke,Ke,ie][ve];return{r:Ae*255,g:Re*255,b:Ye*255}}function Y(me,Ge,Ke,pt){var Xe=[(0,D.FZ)(Math.round(me).toString(16)),(0,D.FZ)(Math.round(Ge).toString(16)),(0,D.FZ)(Math.round(Ke).toString(16))];return pt&&Xe[0].startsWith(Xe[0].charAt(1))&&Xe[1].startsWith(Xe[1].charAt(1))&&Xe[2].startsWith(Xe[2].charAt(1))?Xe[0].charAt(0)+Xe[1].charAt(0)+Xe[2].charAt(0):Xe.join("")}function G(me,Ge,Ke,pt,Xe){var gt=[(0,D.FZ)(Math.round(me).toString(16)),(0,D.FZ)(Math.round(Ge).toString(16)),(0,D.FZ)(Math.round(Ke).toString(16)),(0,D.FZ)(xe(pt))];return Xe&&gt[0].startsWith(gt[0].charAt(1))&&gt[1].startsWith(gt[1].charAt(1))&&gt[2].startsWith(gt[2].charAt(1))&&gt[3].startsWith(gt[3].charAt(1))?gt[0].charAt(0)+gt[1].charAt(0)+gt[2].charAt(0)+gt[3].charAt(0):gt.join("")}function $(me,Ge,Ke,pt){var Xe=[pad2(xe(pt)),pad2(Math.round(me).toString(16)),pad2(Math.round(Ge).toString(16)),pad2(Math.round(Ke).toString(16))];return Xe.join("")}function xe(me){return Math.round(parseFloat(me)*255).toString(16)}function Fe(me){return Ce(me)/255}function Ce(me){return parseInt(me,16)}function We(me){return{r:me>>16,g:(me&65280)>>8,b:me&255}}},48701:function(Ne,fe,I){"use strict";I.d(fe,{R:function(){return D}});var D={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},1350:function(Ne,fe,I){"use strict";I.d(fe,{uA:function(){return ae}});var D=I(86500),k=I(48701),m=I(90279);function ae(Ce){var We={r:0,g:0,b:0},me=1,Ge=null,Ke=null,pt=null,Xe=!1,gt=!1;return typeof Ce=="string"&&(Ce=xe(Ce)),typeof Ce=="object"&&(Fe(Ce.r)&&Fe(Ce.g)&&Fe(Ce.b)?(We=(0,D.rW)(Ce.r,Ce.g,Ce.b),Xe=!0,gt=String(Ce.r).substr(-1)==="%"?"prgb":"rgb"):Fe(Ce.h)&&Fe(Ce.s)&&Fe(Ce.v)?(Ge=(0,m.JX)(Ce.s),Ke=(0,m.JX)(Ce.v),We=(0,D.WE)(Ce.h,Ge,Ke),Xe=!0,gt="hsv"):Fe(Ce.h)&&Fe(Ce.s)&&Fe(Ce.l)&&(Ge=(0,m.JX)(Ce.s),pt=(0,m.JX)(Ce.l),We=(0,D.ve)(Ce.h,Ge,pt),Xe=!0,gt="hsl"),Object.prototype.hasOwnProperty.call(Ce,"a")&&(me=Ce.a)),me=(0,m.Yq)(me),{ok:Xe,format:Ce.format||gt,r:Math.min(255,Math.max(We.r,0)),g:Math.min(255,Math.max(We.g,0)),b:Math.min(255,Math.max(We.b,0)),a:me}}var F="[-\\+]?\\d+%?",K="[-\\+]?\\d*\\.\\d+%?",W="(?:".concat(K,")|(?:").concat(F,")"),Y="[\\s|\\(]+(".concat(W,")[,|\\s]+(").concat(W,")[,|\\s]+(").concat(W,")\\s*\\)?"),G="[\\s|\\(]+(".concat(W,")[,|\\s]+(").concat(W,")[,|\\s]+(").concat(W,")[,|\\s]+(").concat(W,")\\s*\\)?"),$={CSS_UNIT:new RegExp(W),rgb:new RegExp("rgb"+Y),rgba:new RegExp("rgba"+G),hsl:new RegExp("hsl"+Y),hsla:new RegExp("hsla"+G),hsv:new RegExp("hsv"+Y),hsva:new RegExp("hsva"+G),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function xe(Ce){if(Ce=Ce.trim().toLowerCase(),Ce.length===0)return!1;var We=!1;if(k.R[Ce])Ce=k.R[Ce],We=!0;else if(Ce==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var me=$.rgb.exec(Ce);return me?{r:me[1],g:me[2],b:me[3]}:(me=$.rgba.exec(Ce),me?{r:me[1],g:me[2],b:me[3],a:me[4]}:(me=$.hsl.exec(Ce),me?{h:me[1],s:me[2],l:me[3]}:(me=$.hsla.exec(Ce),me?{h:me[1],s:me[2],l:me[3],a:me[4]}:(me=$.hsv.exec(Ce),me?{h:me[1],s:me[2],v:me[3]}:(me=$.hsva.exec(Ce),me?{h:me[1],s:me[2],v:me[3],a:me[4]}:(me=$.hex8.exec(Ce),me?{r:(0,D.VD)(me[1]),g:(0,D.VD)(me[2]),b:(0,D.VD)(me[3]),a:(0,D.T6)(me[4]),format:We?"name":"hex8"}:(me=$.hex6.exec(Ce),me?{r:(0,D.VD)(me[1]),g:(0,D.VD)(me[2]),b:(0,D.VD)(me[3]),format:We?"name":"hex"}:(me=$.hex4.exec(Ce),me?{r:(0,D.VD)(me[1]+me[1]),g:(0,D.VD)(me[2]+me[2]),b:(0,D.VD)(me[3]+me[3]),a:(0,D.T6)(me[4]+me[4]),format:We?"name":"hex8"}:(me=$.hex3.exec(Ce),me?{r:(0,D.VD)(me[1]+me[1]),g:(0,D.VD)(me[2]+me[2]),b:(0,D.VD)(me[3]+me[3]),format:We?"name":"hex"}:!1)))))))))}function Fe(Ce){return Boolean($.CSS_UNIT.exec(String(Ce)))}},10274:function(Ne,fe,I){"use strict";I.d(fe,{C:function(){return F}});var D=I(86500),k=I(48701),m=I(1350),ae=I(90279),F=function(){function W(Y,G){Y===void 0&&(Y=""),G===void 0&&(G={});var $;if(Y instanceof W)return Y;typeof Y=="number"&&(Y=(0,D.Yt)(Y)),this.originalInput=Y;var xe=(0,m.uA)(Y);this.originalInput=Y,this.r=xe.r,this.g=xe.g,this.b=xe.b,this.a=xe.a,this.roundA=Math.round(100*this.a)/100,this.format=($=G.format)!==null&&$!==void 0?$:xe.format,this.gradientType=G.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=xe.ok}return W.prototype.isDark=function(){return this.getBrightness()<128},W.prototype.isLight=function(){return!this.isDark()},W.prototype.getBrightness=function(){var Y=this.toRgb();return(Y.r*299+Y.g*587+Y.b*114)/1e3},W.prototype.getLuminance=function(){var Y=this.toRgb(),G,$,xe,Fe=Y.r/255,Ce=Y.g/255,We=Y.b/255;return Fe<=.03928?G=Fe/12.92:G=Math.pow((Fe+.055)/1.055,2.4),Ce<=.03928?$=Ce/12.92:$=Math.pow((Ce+.055)/1.055,2.4),We<=.03928?xe=We/12.92:xe=Math.pow((We+.055)/1.055,2.4),.2126*G+.7152*$+.0722*xe},W.prototype.getAlpha=function(){return this.a},W.prototype.setAlpha=function(Y){return this.a=(0,ae.Yq)(Y),this.roundA=Math.round(100*this.a)/100,this},W.prototype.isMonochrome=function(){var Y=this.toHsl().s;return Y===0},W.prototype.toHsv=function(){var Y=(0,D.py)(this.r,this.g,this.b);return{h:Y.h*360,s:Y.s,v:Y.v,a:this.a}},W.prototype.toHsvString=function(){var Y=(0,D.py)(this.r,this.g,this.b),G=Math.round(Y.h*360),$=Math.round(Y.s*100),xe=Math.round(Y.v*100);return this.a===1?"hsv(".concat(G,", ").concat($,"%, ").concat(xe,"%)"):"hsva(".concat(G,", ").concat($,"%, ").concat(xe,"%, ").concat(this.roundA,")")},W.prototype.toHsl=function(){var Y=(0,D.lC)(this.r,this.g,this.b);return{h:Y.h*360,s:Y.s,l:Y.l,a:this.a}},W.prototype.toHslString=function(){var Y=(0,D.lC)(this.r,this.g,this.b),G=Math.round(Y.h*360),$=Math.round(Y.s*100),xe=Math.round(Y.l*100);return this.a===1?"hsl(".concat(G,", ").concat($,"%, ").concat(xe,"%)"):"hsla(".concat(G,", ").concat($,"%, ").concat(xe,"%, ").concat(this.roundA,")")},W.prototype.toHex=function(Y){return Y===void 0&&(Y=!1),(0,D.vq)(this.r,this.g,this.b,Y)},W.prototype.toHexString=function(Y){return Y===void 0&&(Y=!1),"#"+this.toHex(Y)},W.prototype.toHex8=function(Y){return Y===void 0&&(Y=!1),(0,D.s)(this.r,this.g,this.b,this.a,Y)},W.prototype.toHex8String=function(Y){return Y===void 0&&(Y=!1),"#"+this.toHex8(Y)},W.prototype.toHexShortString=function(Y){return Y===void 0&&(Y=!1),this.a===1?this.toHexString(Y):this.toHex8String(Y)},W.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},W.prototype.toRgbString=function(){var Y=Math.round(this.r),G=Math.round(this.g),$=Math.round(this.b);return this.a===1?"rgb(".concat(Y,", ").concat(G,", ").concat($,")"):"rgba(".concat(Y,", ").concat(G,", ").concat($,", ").concat(this.roundA,")")},W.prototype.toPercentageRgb=function(){var Y=function(G){return"".concat(Math.round((0,ae.sh)(G,255)*100),"%")};return{r:Y(this.r),g:Y(this.g),b:Y(this.b),a:this.a}},W.prototype.toPercentageRgbString=function(){var Y=function(G){return Math.round((0,ae.sh)(G,255)*100)};return this.a===1?"rgb(".concat(Y(this.r),"%, ").concat(Y(this.g),"%, ").concat(Y(this.b),"%)"):"rgba(".concat(Y(this.r),"%, ").concat(Y(this.g),"%, ").concat(Y(this.b),"%, ").concat(this.roundA,")")},W.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var Y="#"+(0,D.vq)(this.r,this.g,this.b,!1),G=0,$=Object.entries(k.R);G<$.length;G++){var xe=$[G],Fe=xe[0],Ce=xe[1];if(Y===Ce)return Fe}return!1},W.prototype.toString=function(Y){var G=Boolean(Y);Y=Y!=null?Y:this.format;var $=!1,xe=this.a<1&&this.a>=0,Fe=!G&&xe&&(Y.startsWith("hex")||Y==="name");return Fe?Y==="name"&&this.a===0?this.toName():this.toRgbString():(Y==="rgb"&&($=this.toRgbString()),Y==="prgb"&&($=this.toPercentageRgbString()),(Y==="hex"||Y==="hex6")&&($=this.toHexString()),Y==="hex3"&&($=this.toHexString(!0)),Y==="hex4"&&($=this.toHex8String(!0)),Y==="hex8"&&($=this.toHex8String()),Y==="name"&&($=this.toName()),Y==="hsl"&&($=this.toHslString()),Y==="hsv"&&($=this.toHsvString()),$||this.toHexString())},W.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},W.prototype.clone=function(){return new W(this.toString())},W.prototype.lighten=function(Y){Y===void 0&&(Y=10);var G=this.toHsl();return G.l+=Y/100,G.l=(0,ae.V2)(G.l),new W(G)},W.prototype.brighten=function(Y){Y===void 0&&(Y=10);var G=this.toRgb();return G.r=Math.max(0,Math.min(255,G.r-Math.round(255*-(Y/100)))),G.g=Math.max(0,Math.min(255,G.g-Math.round(255*-(Y/100)))),G.b=Math.max(0,Math.min(255,G.b-Math.round(255*-(Y/100)))),new W(G)},W.prototype.darken=function(Y){Y===void 0&&(Y=10);var G=this.toHsl();return G.l-=Y/100,G.l=(0,ae.V2)(G.l),new W(G)},W.prototype.tint=function(Y){return Y===void 0&&(Y=10),this.mix("white",Y)},W.prototype.shade=function(Y){return Y===void 0&&(Y=10),this.mix("black",Y)},W.prototype.desaturate=function(Y){Y===void 0&&(Y=10);var G=this.toHsl();return G.s-=Y/100,G.s=(0,ae.V2)(G.s),new W(G)},W.prototype.saturate=function(Y){Y===void 0&&(Y=10);var G=this.toHsl();return G.s+=Y/100,G.s=(0,ae.V2)(G.s),new W(G)},W.prototype.greyscale=function(){return this.desaturate(100)},W.prototype.spin=function(Y){var G=this.toHsl(),$=(G.h+Y)%360;return G.h=$<0?360+$:$,new W(G)},W.prototype.mix=function(Y,G){G===void 0&&(G=50);var $=this.toRgb(),xe=new W(Y).toRgb(),Fe=G/100,Ce={r:(xe.r-$.r)*Fe+$.r,g:(xe.g-$.g)*Fe+$.g,b:(xe.b-$.b)*Fe+$.b,a:(xe.a-$.a)*Fe+$.a};return new W(Ce)},W.prototype.analogous=function(Y,G){Y===void 0&&(Y=6),G===void 0&&(G=30);var $=this.toHsl(),xe=360/G,Fe=[this];for($.h=($.h-(xe*Y>>1)+720)%360;--Y;)$.h=($.h+xe)%360,Fe.push(new W($));return Fe},W.prototype.complement=function(){var Y=this.toHsl();return Y.h=(Y.h+180)%360,new W(Y)},W.prototype.monochromatic=function(Y){Y===void 0&&(Y=6);for(var G=this.toHsv(),$=G.h,xe=G.s,Fe=G.v,Ce=[],We=1/Y;Y--;)Ce.push(new W({h:$,s:xe,v:Fe})),Fe=(Fe+We)%1;return Ce},W.prototype.splitcomplement=function(){var Y=this.toHsl(),G=Y.h;return[this,new W({h:(G+72)%360,s:Y.s,l:Y.l}),new W({h:(G+216)%360,s:Y.s,l:Y.l})]},W.prototype.onBackground=function(Y){var G=this.toRgb(),$=new W(Y).toRgb(),xe=G.a+$.a*(1-G.a);return new W({r:(G.r*G.a+$.r*$.a*(1-G.a))/xe,g:(G.g*G.a+$.g*$.a*(1-G.a))/xe,b:(G.b*G.a+$.b*$.a*(1-G.a))/xe,a:xe})},W.prototype.triad=function(){return this.polyad(3)},W.prototype.tetrad=function(){return this.polyad(4)},W.prototype.polyad=function(Y){for(var G=this.toHsl(),$=G.h,xe=[this],Fe=360/Y,Ce=1;Ce<Y;Ce++)xe.push(new W({h:($+Ce*Fe)%360,s:G.s,l:G.l}));return xe},W.prototype.equals=function(Y){return this.toRgbString()===new W(Y).toRgbString()},W}();function K(W,Y){return W===void 0&&(W=""),Y===void 0&&(Y={}),new F(W,Y)}},90279:function(Ne,fe,I){"use strict";I.d(fe,{FZ:function(){return W},JX:function(){return K},V2:function(){return k},Yq:function(){return F},sh:function(){return D}});function D(Y,G){m(Y)&&(Y="100%");var $=ae(Y);return Y=G===360?Y:Math.min(G,Math.max(0,parseFloat(Y))),$&&(Y=parseInt(String(Y*G),10)/100),Math.abs(Y-G)<1e-6?1:(G===360?Y=(Y<0?Y%G+G:Y%G)/parseFloat(String(G)):Y=Y%G/parseFloat(String(G)),Y)}function k(Y){return Math.min(1,Math.max(0,Y))}function m(Y){return typeof Y=="string"&&Y.indexOf(".")!==-1&&parseFloat(Y)===1}function ae(Y){return typeof Y=="string"&&Y.indexOf("%")!==-1}function F(Y){return Y=parseFloat(Y),(isNaN(Y)||Y<0||Y>1)&&(Y=1),Y}function K(Y){return Y<=1?"".concat(Number(Y)*100,"%"):Y}function W(Y){return Y.length===1?"0"+Y:String(Y)}},38163:function(Ne){Ne.exports=fe;function fe(k,m){var ae=k&&k.type,F;if(ae==="FeatureCollection")for(F=0;F<k.features.length;F++)fe(k.features[F],m);else if(ae==="GeometryCollection")for(F=0;F<k.geometries.length;F++)fe(k.geometries[F],m);else if(ae==="Feature")fe(k.geometry,m);else if(ae==="Polygon")I(k.coordinates,m);else if(ae==="MultiPolygon")for(F=0;F<k.coordinates.length;F++)I(k.coordinates[F],m);return k}function I(k,m){if(k.length!==0){D(k[0],m);for(var ae=1;ae<k.length;ae++)D(k[ae],!m)}}function D(k,m){for(var ae=0,F=0,K=0,W=k.length,Y=W-1;K<W;Y=K++){var G=(k[K][0]-k[Y][0])*(k[Y][1]+k[K][1]),$=ae+G;F+=Math.abs(ae)>=Math.abs(G)?ae-$+G:G-$+ae,ae=$}ae+F>=0!=!!m&&k.reverse()}},75550:function(Ne){"use strict";Ne.exports=fe;function fe(I,D){this.x=I,this.y=D}fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(I){return this.clone()._add(I)},sub:function(I){return this.clone()._sub(I)},multByPoint:function(I){return this.clone()._multByPoint(I)},divByPoint:function(I){return this.clone()._divByPoint(I)},mult:function(I){return this.clone()._mult(I)},div:function(I){return this.clone()._div(I)},rotate:function(I){return this.clone()._rotate(I)},rotateAround:function(I,D){return this.clone()._rotateAround(I,D)},matMult:function(I){return this.clone()._matMult(I)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(I){return this.x===I.x&&this.y===I.y},dist:function(I){return Math.sqrt(this.distSqr(I))},distSqr:function(I){var D=I.x-this.x,k=I.y-this.y;return D*D+k*k},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(I){return Math.atan2(this.y-I.y,this.x-I.x)},angleWith:function(I){return this.angleWithSep(I.x,I.y)},angleWithSep:function(I,D){return Math.atan2(this.x*D-this.y*I,this.x*I+this.y*D)},_matMult:function(I){var D=I[0]*this.x+I[1]*this.y,k=I[2]*this.x+I[3]*this.y;return this.x=D,this.y=k,this},_add:function(I){return this.x+=I.x,this.y+=I.y,this},_sub:function(I){return this.x-=I.x,this.y-=I.y,this},_mult:function(I){return this.x*=I,this.y*=I,this},_div:function(I){return this.x/=I,this.y/=I,this},_multByPoint:function(I){return this.x*=I.x,this.y*=I.y,this},_divByPoint:function(I){return this.x/=I.x,this.y/=I.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var I=this.y;return this.y=this.x,this.x=-I,this},_rotate:function(I){var D=Math.cos(I),k=Math.sin(I),m=D*this.x-k*this.y,ae=k*this.x+D*this.y;return this.x=m,this.y=ae,this},_rotateAround:function(I,D){var k=Math.cos(I),m=Math.sin(I),ae=D.x+k*(this.x-D.x)-m*(this.y-D.y),F=D.y+m*(this.x-D.x)+k*(this.y-D.y);return this.x=ae,this.y=F,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},fe.convert=function(I){return I instanceof fe?I:Array.isArray(I)?new fe(I[0],I[1]):I}},99874:function(Ne){Ne.exports=fe;function fe(I,D,k,m){this.cx=3*I,this.bx=3*(k-I)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*D,this.by=3*(m-D)-this.cy,this.ay=1-this.cy-this.by,this.p1x=I,this.p1y=m,this.p2x=k,this.p2y=m}fe.prototype.sampleCurveX=function(I){return((this.ax*I+this.bx)*I+this.cx)*I},fe.prototype.sampleCurveY=function(I){return((this.ay*I+this.by)*I+this.cy)*I},fe.prototype.sampleCurveDerivativeX=function(I){return(3*this.ax*I+2*this.bx)*I+this.cx},fe.prototype.solveCurveX=function(I,D){typeof D=="undefined"&&(D=1e-6);var k,m,ae,F,K;for(ae=I,K=0;K<8;K++){if(F=this.sampleCurveX(ae)-I,Math.abs(F)<D)return ae;var W=this.sampleCurveDerivativeX(ae);if(Math.abs(W)<1e-6)break;ae=ae-F/W}if(k=0,m=1,ae=I,ae<k)return k;if(ae>m)return m;for(;k<m;){if(F=this.sampleCurveX(ae),Math.abs(F-I)<D)return ae;I>F?k=ae:m=ae,ae=(m-k)*.5+k}return ae},fe.prototype.solve=function(I,D){return this.sampleCurveY(this.solveCurveX(I,D))}},38929:function(Ne,fe,I){Ne.exports.VectorTile=I(22779),I(66024),I(59701)},22779:function(Ne,fe,I){"use strict";var D=I(59701);Ne.exports=k;function k(ae,F){this.layers=ae.readFields(m,{},F)}function m(ae,F,K){if(ae===3){var W=new D(K,K.readVarint()+K.pos);W.length&&(F[W.name]=W)}}},66024:function(Ne,fe,I){"use strict";var D=I(75550);Ne.exports=k;function k(W,Y,G,$,xe){this.properties={},this.extent=G,this.type=0,this._pbf=W,this._geometry=-1,this._keys=$,this._values=xe,W.readFields(m,this,Y)}function m(W,Y,G){W==1?Y.id=G.readVarint():W==2?ae(G,Y):W==3?Y.type=G.readVarint():W==4&&(Y._geometry=G.pos)}function ae(W,Y){for(var G=W.readVarint()+W.pos;W.pos<G;){var $=Y._keys[W.readVarint()],xe=Y._values[W.readVarint()];Y.properties[$]=xe}}k.types=["Unknown","Point","LineString","Polygon"],k.prototype.loadGeometry=function(){var W=this._pbf;W.pos=this._geometry;for(var Y=W.readVarint()+W.pos,G=1,$=0,xe=0,Fe=0,Ce=[],We;W.pos<Y;){if($<=0){var me=W.readVarint();G=me&7,$=me>>3}if($--,G===1||G===2)xe+=W.readSVarint(),Fe+=W.readSVarint(),G===1&&(We&&Ce.push(We),We=[]),We.push(new D(xe,Fe));else if(G===7)We&&We.push(We[0].clone());else throw new Error("unknown command "+G)}return We&&Ce.push(We),Ce},k.prototype.bbox=function(){var W=this._pbf;W.pos=this._geometry;for(var Y=W.readVarint()+W.pos,G=1,$=0,xe=0,Fe=0,Ce=1/0,We=-1/0,me=1/0,Ge=-1/0;W.pos<Y;){if($<=0){var Ke=W.readVarint();G=Ke&7,$=Ke>>3}if($--,G===1||G===2)xe+=W.readSVarint(),Fe+=W.readSVarint(),xe<Ce&&(Ce=xe),xe>We&&(We=xe),Fe<me&&(me=Fe),Fe>Ge&&(Ge=Fe);else if(G!==7)throw new Error("unknown command "+G)}return[Ce,me,We,Ge]},k.prototype.toGeoJSON=function(W,Y,G){var $=this.extent*Math.pow(2,G),xe=this.extent*W,Fe=this.extent*Y,Ce=this.loadGeometry(),We=k.types[this.type],me,Ge;function Ke(gt){for(var ie=0;ie<gt.length;ie++){var ft=gt[ie],ve=180-(ft.y+Fe)*360/$;gt[ie]=[(ft.x+xe)*360/$-180,360/Math.PI*Math.atan(Math.exp(ve*Math.PI/180))-90]}}switch(this.type){case 1:var pt=[];for(me=0;me<Ce.length;me++)pt[me]=Ce[me][0];Ce=pt,Ke(Ce);break;case 2:for(me=0;me<Ce.length;me++)Ke(Ce[me]);break;case 3:for(Ce=F(Ce),me=0;me<Ce.length;me++)for(Ge=0;Ge<Ce[me].length;Ge++)Ke(Ce[me][Ge]);break}Ce.length===1?Ce=Ce[0]:We="Multi"+We;var Xe={type:"Feature",geometry:{type:We,coordinates:Ce},properties:this.properties};return"id"in this&&(Xe.id=this.id),Xe};function F(W){var Y=W.length;if(Y<=1)return[W];for(var G=[],$,xe,Fe=0;Fe<Y;Fe++){var Ce=K(W[Fe]);Ce!==0&&(xe===void 0&&(xe=Ce<0),xe===Ce<0?($&&G.push($),$=[W[Fe]]):$.push(W[Fe]))}return $&&G.push($),G}function K(W){for(var Y=0,G=0,$=W.length,xe=$-1,Fe,Ce;G<$;xe=G++)Fe=W[G],Ce=W[xe],Y+=(Ce.x-Fe.x)*(Fe.y+Ce.y);return Y}},59701:function(Ne,fe,I){"use strict";var D=I(66024);Ne.exports=k;function k(F,K){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=F,this._keys=[],this._values=[],this._features=[],F.readFields(m,this,K),this.length=this._features.length}function m(F,K,W){F===15?K.version=W.readVarint():F===1?K.name=W.readString():F===5?K.extent=W.readVarint():F===2?K._features.push(W.pos):F===3?K._keys.push(W.readString()):F===4&&K._values.push(ae(W))}function ae(F){for(var K=null,W=F.readVarint()+F.pos;F.pos<W;){var Y=F.readVarint()>>3;K=Y===1?F.readString():Y===2?F.readFloat():Y===3?F.readDouble():Y===4?F.readVarint64():Y===5?F.readVarint():Y===6?F.readSVarint():Y===7?F.readBoolean():null}return K}k.prototype.feature=function(F){if(F<0||F>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[F];var K=this._pbf.readVarint()+this._pbf.pos;return new D(this._pbf,K,this.extent,this._keys,this._values)}},45191:function(Ne,fe){"use strict";var I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"};fe.Z=I},38018:function(Ne,fe,I){"use strict";var D=I(9783).default,k=I(5574).default,m=I(96695).default,ae=I(52677).default,F=I(19632).default,K=I(62072),W=I(44020),Y=I(13615),G=I(92806),$=function(Ae){return Ae==null},xe=Symbol("encodeFragmentIdentifier");function Fe(ve){switch(ve.arrayFormat){case"index":return function(Re){return function(Ye,at){var ht=Ye.length;return at===void 0||ve.skipNull&&at===null||ve.skipEmptyString&&at===""?Ye:at===null?[].concat(F(Ye),[[me(Re,ve),"[",ht,"]"].join("")]):[].concat(F(Ye),[[me(Re,ve),"[",me(ht,ve),"]=",me(at,ve)].join("")])}};case"bracket":return function(Re){return function(Ye,at){return at===void 0||ve.skipNull&&at===null||ve.skipEmptyString&&at===""?Ye:at===null?[].concat(F(Ye),[[me(Re,ve),"[]"].join("")]):[].concat(F(Ye),[[me(Re,ve),"[]=",me(at,ve)].join("")])}};case"colon-list-separator":return function(Re){return function(Ye,at){return at===void 0||ve.skipNull&&at===null||ve.skipEmptyString&&at===""?Ye:at===null?[].concat(F(Ye),[[me(Re,ve),":list="].join("")]):[].concat(F(Ye),[[me(Re,ve),":list=",me(at,ve)].join("")])}};case"comma":case"separator":case"bracket-separator":{var Ae=ve.arrayFormat==="bracket-separator"?"[]=":"=";return function(Re){return function(Ye,at){return at===void 0||ve.skipNull&&at===null||ve.skipEmptyString&&at===""?Ye:(at=at===null?"":at,Ye.length===0?[[me(Re,ve),Ae,me(at,ve)].join("")]:[[Ye,me(at,ve)].join(ve.arrayFormatSeparator)])}}}default:return function(Re){return function(Ye,at){return at===void 0||ve.skipNull&&at===null||ve.skipEmptyString&&at===""?Ye:at===null?[].concat(F(Ye),[me(Re,ve)]):[].concat(F(Ye),[[me(Re,ve),"=",me(at,ve)].join("")])}}}}function Ce(ve){var Ae;switch(ve.arrayFormat){case"index":return function(Re,Ye,at){if(Ae=/\[(\d*)\]$/.exec(Re),Re=Re.replace(/\[\d*\]$/,""),!Ae){at[Re]=Ye;return}at[Re]===void 0&&(at[Re]={}),at[Re][Ae[1]]=Ye};case"bracket":return function(Re,Ye,at){if(Ae=/(\[\])$/.exec(Re),Re=Re.replace(/\[\]$/,""),!Ae){at[Re]=Ye;return}if(at[Re]===void 0){at[Re]=[Ye];return}at[Re]=[].concat(at[Re],Ye)};case"colon-list-separator":return function(Re,Ye,at){if(Ae=/(:list)$/.exec(Re),Re=Re.replace(/:list$/,""),!Ae){at[Re]=Ye;return}if(at[Re]===void 0){at[Re]=[Ye];return}at[Re]=[].concat(at[Re],Ye)};case"comma":case"separator":return function(Re,Ye,at){var ht=typeof Ye=="string"&&Ye.includes(ve.arrayFormatSeparator),Se=typeof Ye=="string"&&!ht&&Ge(Ye,ve).includes(ve.arrayFormatSeparator);Ye=Se?Ge(Ye,ve):Ye;var Qe=ht||Se?Ye.split(ve.arrayFormatSeparator).map(function(oe){return Ge(oe,ve)}):Ye===null?Ye:Ge(Ye,ve);at[Re]=Qe};case"bracket-separator":return function(Re,Ye,at){var ht=/(\[\])$/.test(Re);if(Re=Re.replace(/\[\]$/,""),!ht){at[Re]=Ye&&Ge(Ye,ve);return}var Se=Ye===null?[]:Ye.split(ve.arrayFormatSeparator).map(function(Qe){return Ge(Qe,ve)});if(at[Re]===void 0){at[Re]=Se;return}at[Re]=[].concat(at[Re],Se)};default:return function(Re,Ye,at){if(at[Re]===void 0){at[Re]=Ye;return}at[Re]=[].concat(at[Re],Ye)}}}function We(ve){if(typeof ve!="string"||ve.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function me(ve,Ae){return Ae.encode?Ae.strict?K(ve):encodeURIComponent(ve):ve}function Ge(ve,Ae){return Ae.decode?W(ve):ve}function Ke(ve){return Array.isArray(ve)?ve.sort():ae(ve)==="object"?Ke(Object.keys(ve)).sort(function(Ae,Re){return Number(Ae)-Number(Re)}).map(function(Ae){return ve[Ae]}):ve}function pt(ve){var Ae=ve.indexOf("#");return Ae!==-1&&(ve=ve.slice(0,Ae)),ve}function Xe(ve){var Ae="",Re=ve.indexOf("#");return Re!==-1&&(Ae=ve.slice(Re)),Ae}function gt(ve){ve=pt(ve);var Ae=ve.indexOf("?");return Ae===-1?"":ve.slice(Ae+1)}function ie(ve,Ae){return Ae.parseNumbers&&!Number.isNaN(Number(ve))&&typeof ve=="string"&&ve.trim()!==""?ve=Number(ve):Ae.parseBooleans&&ve!==null&&(ve.toLowerCase()==="true"||ve.toLowerCase()==="false")&&(ve=ve.toLowerCase()==="true"),ve}function ft(ve,Ae){Ae=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},Ae),We(Ae.arrayFormatSeparator);var Re=Ce(Ae),Ye=Object.create(null);if(typeof ve!="string"||(ve=ve.trim().replace(/^[?#&]/,""),!ve))return Ye;var at=m(ve.split("&")),ht;try{for(at.s();!(ht=at.n()).done;){var Se=ht.value;if(Se!==""){var Qe=Y(Ae.decode?Se.replace(/\+/g," "):Se,"="),oe=k(Qe,2),ue=oe[0],be=oe[1];be=be===void 0?null:["comma","separator","bracket-separator"].includes(Ae.arrayFormat)?be:Ge(be,Ae),Re(Ge(ue,Ae),be,Ye)}}}catch(gi){at.e(gi)}finally{at.f()}for(var vt=0,bt=Object.keys(Ye);vt<bt.length;vt++){var Ht=bt[vt],Er=Ye[Ht];if(ae(Er)==="object"&&Er!==null)for(var Vt=0,on=Object.keys(Er);Vt<on.length;Vt++){var hn=on[Vt];Er[hn]=ie(Er[hn],Ae)}else Ye[Ht]=ie(Er,Ae)}return Ae.sort===!1?Ye:(Ae.sort===!0?Object.keys(Ye).sort():Object.keys(Ye).sort(Ae.sort)).reduce(function(gi,Hn){var Dt=Ye[Hn];return Boolean(Dt)&&ae(Dt)==="object"&&!Array.isArray(Dt)?gi[Hn]=Ke(Dt):gi[Hn]=Dt,gi},Object.create(null))}fe.extract=gt,fe.parse=ft,fe.stringify=function(ve,Ae){if(!ve)return"";Ae=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},Ae),We(Ae.arrayFormatSeparator);for(var Re=function(be){return Ae.skipNull&&$(ve[be])||Ae.skipEmptyString&&ve[be]===""},Ye=Fe(Ae),at={},ht=0,Se=Object.keys(ve);ht<Se.length;ht++){var Qe=Se[ht];Re(Qe)||(at[Qe]=ve[Qe])}var oe=Object.keys(at);return Ae.sort!==!1&&oe.sort(Ae.sort),oe.map(function(ue){var be=ve[ue];return be===void 0?"":be===null?me(ue,Ae):Array.isArray(be)?be.length===0&&Ae.arrayFormat==="bracket-separator"?me(ue,Ae)+"[]":be.reduce(Ye(ue),[]).join("&"):me(ue,Ae)+"="+me(be,Ae)}).filter(function(ue){return ue.length>0}).join("&")},fe.parseUrl=function(ve,Ae){Ae=Object.assign({decode:!0},Ae);var Re=Y(ve,"#"),Ye=k(Re,2),at=Ye[0],ht=Ye[1];return Object.assign({url:at.split("?")[0]||"",query:ft(gt(ve),Ae)},Ae&&Ae.parseFragmentIdentifier&&ht?{fragmentIdentifier:Ge(ht,Ae)}:{})},fe.stringifyUrl=function(ve,Ae){Ae=Object.assign(D({encode:!0,strict:!0},xe,!0),Ae);var Re=pt(ve.url).split("?")[0]||"",Ye=fe.extract(ve.url),at=fe.parse(Ye,{sort:!1}),ht=Object.assign(at,ve.query),Se=fe.stringify(ht,Ae);Se&&(Se="?".concat(Se));var Qe=Xe(ve.url);return ve.fragmentIdentifier&&(Qe="#".concat(Ae[xe]?me(ve.fragmentIdentifier,Ae):ve.fragmentIdentifier)),"".concat(Re).concat(Se).concat(Qe)},fe.pick=function(ve,Ae,Re){Re=Object.assign(D({parseFragmentIdentifier:!0},xe,!1),Re);var Ye=fe.parseUrl(ve,Re),at=Ye.url,ht=Ye.query,Se=Ye.fragmentIdentifier;return fe.stringifyUrl({url:at,query:G(ht,Ae),fragmentIdentifier:Se},Re)},fe.exclude=function(ve,Ae,Re){var Ye=Array.isArray(Ae)?function(at){return!Ae.includes(at)}:function(at,ht){return!Ae(at,ht)};return fe.pick(ve,Ye,Re)}},13615:function(Ne){"use strict";Ne.exports=function(fe,I){if(!(typeof fe=="string"&&typeof I=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(I==="")return[fe];var D=fe.indexOf(I);return D===-1?[fe]:[fe.slice(0,D),fe.slice(D+I.length)]}},62072:function(Ne){"use strict";Ne.exports=function(fe){return encodeURIComponent(fe).replace(/[!'()*]/g,function(I){return"%".concat(I.charCodeAt(0).toString(16).toUpperCase())})}},33603:function(Ne,fe,I){"use strict";I.d(fe,{mL:function(){return Y},q0:function(){return W}});const D=()=>({height:0,opacity:0}),k=G=>{const{scrollHeight:$}=G;return{height:$,opacity:1}},m=G=>({height:G?G.offsetHeight:0}),ae=(G,$)=>($==null?void 0:$.deadline)===!0||$.propertyName==="height",F=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ant"}-motion-collapse`,onAppearStart:D,onEnterStart:D,onAppearActive:k,onEnterActive:k,onLeaveStart:m,onLeaveActive:D,onAppearEnd:ae,onEnterEnd:ae,onLeaveEnd:ae,motionDeadline:500}},K=null,W=G=>G!==void 0&&(G==="topLeft"||G==="topRight")?"slide-down":"slide-up",Y=(G,$,xe)=>xe!==void 0?xe:`${G}-${$}`;fe.ZP=F},96159:function(Ne,fe,I){"use strict";var D;I.d(fe,{M2:function(){return ae},Tm:function(){return K},l$:function(){return m}});var k=I(67294);const{isValidElement:m}=D||(D=I.t(k,2));function ae(W){return W&&m(W)&&W.type===k.Fragment}function F(W,Y,G){return m(W)?k.cloneElement(W,typeof G=="function"?G(W.props||{}):G):Y}function K(W,Y){return F(W,W,Y)}},34749:function(Ne,fe,I){"use strict";I.d(fe,{ZP:function(){return Bt}});var D=I(94184),k=I.n(D),m=I(98423),ae=I(67294),F=I(53124),K=I(98866),W=I(97647),Y=I(4173),G=I(42550),$=I(5110),xe=I(96159),Fe=I(67968);const Ce=Le=>{const{componentCls:St,colorPrimary:tt}=Le;return{[St]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${tt})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${Le.motionEaseOutCirc}`,`opacity 2s ${Le.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0}}}}};var We=(0,Fe.Z)("Wave",Le=>[Ce(Le)]),me=I(62874),Ge=I(75164),Ke=I(38135);function pt(Le){const St=(Le||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return St&&St[1]&&St[2]&&St[3]?!(St[1]===St[2]&&St[2]===St[3]):!0}function Xe(Le){return Le&&Le!=="#fff"&&Le!=="#ffffff"&&Le!=="rgb(255, 255, 255)"&&Le!=="rgba(255, 255, 255, 1)"&&pt(Le)&&!/rgba\((?:\d*, ){3}0\)/.test(Le)&&Le!=="transparent"}function gt(Le){const{borderTopColor:St,borderColor:tt,backgroundColor:At}=getComputedStyle(Le);return Xe(St)?St:Xe(tt)?tt:Xe(At)?At:null}function ie(Le){return Number.isNaN(Le)?0:Le}const ft=Le=>{const{className:St,target:tt}=Le,At=ae.useRef(null),[tr,en]=ae.useState(null),[Kr,Ft]=ae.useState([]),[rr,ot]=ae.useState(0),[Li,Hr]=ae.useState(0),[_i,vi]=ae.useState(0),[It,Yr]=ae.useState(0),[Dr,Jn]=ae.useState(!1),Kt={left:rr,top:Li,width:_i,height:It,borderRadius:Kr.map(Fr=>`${Fr}px`).join(" ")};tr&&(Kt["--wave-color"]=tr);function hr(){const Fr=getComputedStyle(tt);en(gt(tt));const qr=Fr.position==="static",{borderLeftWidth:An,borderTopWidth:Ui}=Fr;ot(qr?tt.offsetLeft:ie(-parseFloat(An))),Hr(qr?tt.offsetTop:ie(-parseFloat(Ui))),vi(tt.offsetWidth),Yr(tt.offsetHeight);const{borderTopLeftRadius:fa,borderTopRightRadius:Wi,borderBottomLeftRadius:ct,borderBottomRightRadius:qi}=Fr;Ft([fa,Wi,qi,ct].map(Na=>ie(parseFloat(Na))))}return ae.useEffect(()=>{if(tt){const Fr=(0,Ge.Z)(()=>{hr(),Jn(!0)});let qr;return typeof ResizeObserver!="undefined"&&(qr=new ResizeObserver(hr),qr.observe(tt)),()=>{Ge.Z.cancel(Fr),qr==null||qr.disconnect()}}},[]),Dr?ae.createElement(me.Z,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(Fr,qr)=>{var An;if(qr.deadline||qr.propertyName==="opacity"){const Ui=(An=At.current)===null||An===void 0?void 0:An.parentElement;(0,Ke.v)(Ui).then(()=>{var fa;(fa=Ui.parentElement)===null||fa===void 0||fa.removeChild(Ui)})}return!1}},Fr=>{let{className:qr}=Fr;return ae.createElement("div",{ref:At,className:k()(St,qr),style:Kt})}):null};function ve(Le,St){const tt=document.createElement("div");tt.style.position="absolute",tt.style.left="0px",tt.style.top="0px",Le==null||Le.insertBefore(tt,Le==null?void 0:Le.firstChild),(0,Ke.s)(ae.createElement(ft,{target:Le,className:St}),tt)}function Ae(Le,St){function tt(){const At=Le.current;ve(At,St)}return tt}var Ye=Le=>{const{children:St,disabled:tt}=Le,{getPrefixCls:At}=(0,ae.useContext)(F.E_),tr=(0,ae.useRef)(null),en=At("wave"),[,Kr]=We(en),Ft=Ae(tr,k()(en,Kr));if(ae.useEffect(()=>{const ot=tr.current;if(!ot||ot.nodeType!==1||tt)return;const Li=Hr=>{Hr.target.tagName==="INPUT"||!(0,$.Z)(Hr.target)||!ot.getAttribute||ot.getAttribute("disabled")||ot.disabled||ot.className.includes("disabled")||ot.className.includes("-leave")||Ft()};return ot.addEventListener("click",Li,!0),()=>{ot.removeEventListener("click",Li,!0)}},[tt]),!ae.isValidElement(St))return St!=null?St:null;const rr=(0,G.Yr)(St)?(0,G.sQ)(St.ref,tr):tr;return(0,xe.Tm)(St,{ref:rr})},at=I(48012),ht=function(Le,St){var tt={};for(var At in Le)Object.prototype.hasOwnProperty.call(Le,At)&&St.indexOf(At)<0&&(tt[At]=Le[At]);if(Le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var tr=0,At=Object.getOwnPropertySymbols(Le);tr<At.length;tr++)St.indexOf(At[tr])<0&&Object.prototype.propertyIsEnumerable.call(Le,At[tr])&&(tt[At[tr]]=Le[At[tr]]);return tt};const Se=ae.createContext(void 0);var oe=Le=>{const{getPrefixCls:St,direction:tt}=ae.useContext(F.E_),{prefixCls:At,size:tr,className:en}=Le,Kr=ht(Le,["prefixCls","size","className"]),Ft=St("btn-group",At),[,,rr]=(0,at.dQ)();let ot="";switch(tr){case"large":ot="lg";break;case"small":ot="sm";break;case"middle":case void 0:break;default:}const Li=k()(Ft,{[`${Ft}-${ot}`]:ot,[`${Ft}-rtl`]:tt==="rtl"},en,rr);return ae.createElement(Se.Provider,{value:tr},ae.createElement("div",Object.assign({},Kr,{className:Li})))};const ue=/^[\u4e00-\u9fa5]{2}$/,be=ue.test.bind(ue);function vt(Le){return typeof Le=="string"}function bt(Le){return Le==="text"||Le==="link"}function Ht(Le,St){if(Le==null)return;const tt=St?" ":"";return typeof Le!="string"&&typeof Le!="number"&&vt(Le.type)&&be(Le.props.children)?(0,xe.Tm)(Le,{children:Le.props.children.split("").join(tt)}):typeof Le=="string"?be(Le)?ae.createElement("span",null,Le.split("").join(tt)):ae.createElement("span",null,Le):(0,xe.M2)(Le)?ae.createElement("span",null,Le):Le}function Er(Le,St){let tt=!1;const At=[];return ae.Children.forEach(Le,tr=>{const en=typeof tr,Kr=en==="string"||en==="number";if(tt&&Kr){const Ft=At.length-1,rr=At[Ft];At[Ft]=`${rr}${tr}`}else At.push(tr);tt=Kr}),ae.Children.map(At,tr=>Ht(tr,St))}const Vt=null,on=null,hn=null;var gi=I(55780);const Hn=()=>({width:0,opacity:0,transform:"scale(0)"}),Dt=Le=>({width:Le.scrollWidth,opacity:1,transform:"scale(1)"});var Ze=Le=>{let{prefixCls:St,loading:tt,existIcon:At}=Le;const tr=!!tt;return At?ae.createElement("span",{className:`${St}-loading-icon`},ae.createElement(gi.Z,null)):ae.createElement(me.Z,{visible:tr,motionName:`${St}-loading-icon-motion`,removeOnLeave:!0,onAppearStart:Hn,onAppearActive:Dt,onEnterStart:Hn,onEnterActive:Dt,onLeaveStart:Dt,onLeaveActive:Hn},(en,Kr)=>{let{className:Ft,style:rr}=en;return ae.createElement("span",{className:`${St}-loading-icon`,style:rr,ref:Kr},ae.createElement(gi.Z,{className:Ft}))})},ci=I(45503);const Ci=(Le,St)=>({[`> span, > ${Le}`]:{"&:not(:last-child)":{[`&, & > ${Le}`]:{"&:not(:disabled)":{borderInlineEndColor:St}}},"&:not(:first-child)":{[`&, & > ${Le}`]:{"&:not(:disabled)":{borderInlineStartColor:St}}}}});var ea=Le=>{const{componentCls:St,fontSize:tt,lineWidth:At,colorPrimaryHover:tr,colorErrorHover:en}=Le;return{[`${St}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${St}`]:{"&:not(:last-child)":{[`&, & > ${St}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:-At,[`&, & > ${St}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[St]:{position:"relative",zIndex:1,[`&:hover,
          &:focus,
          &:active`]:{zIndex:2},"&[disabled]":{zIndex:0}},[`${St}-icon-only`]:{fontSize:tt}},Ci(`${St}-primary`,tr),Ci(`${St}-danger`,en)]}},fn=I(14747),tn=I(80110);function da(Le,St){return{[`&-item:not(${St}-last-item)`]:{marginBottom:-Le.lineWidth},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function Ii(Le,St){return{[`&-item:not(${St}-first-item):not(${St}-last-item)`]:{borderRadius:0},[`&-item${St}-first-item:not(${St}-last-item)`]:{[`&, &${Le}-sm, &${Le}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${St}-last-item:not(${St}-first-item)`]:{[`&, &${Le}-sm, &${Le}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function Ai(Le){const St=`${Le.componentCls}-compact-vertical`;return{[St]:Object.assign(Object.assign({},da(Le,St)),Ii(Le.componentCls,St))}}const Pr=Le=>{const{componentCls:St,iconCls:tt}=Le;return{[St]:{outline:"none",position:"relative",display:"inline-block",fontWeight:400,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",backgroundColor:"transparent",border:`${Le.lineWidth}px ${Le.lineType} transparent`,cursor:"pointer",transition:`all ${Le.motionDurationMid} ${Le.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",lineHeight:Le.lineHeight,color:Le.colorText,"> span":{display:"inline-block"},[`> ${tt} + span, > span + ${tt}`]:{marginInlineStart:Le.marginXS},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},(0,fn.Qy)(Le)),[`&-icon-only${St}-compact-item`]:{flex:"none"},[`&-compact-item${St}-primary`]:{[`&:not([disabled]) + ${St}-compact-item${St}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-Le.lineWidth,insetInlineStart:-Le.lineWidth,display:"inline-block",width:Le.lineWidth,height:`calc(100% + ${Le.lineWidth*2}px)`,backgroundColor:Le.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${St}-primary`]:{[`&:not([disabled]) + ${St}-compact-vertical-item${St}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-Le.lineWidth,insetInlineStart:-Le.lineWidth,display:"inline-block",width:`calc(100% + ${Le.lineWidth*2}px)`,height:Le.lineWidth,backgroundColor:Le.colorPrimaryHover,content:'""'}}}}}}},nt=(Le,St)=>({"&:not(:disabled)":{"&:hover":Le,"&:active":St}}),it=Le=>({minWidth:Le.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),_t=Le=>({borderRadius:Le.controlHeight,paddingInlineStart:Le.controlHeight/2,paddingInlineEnd:Le.controlHeight/2}),we=Le=>({cursor:"not-allowed",borderColor:Le.colorBorder,color:Le.colorTextDisabled,backgroundColor:Le.colorBgContainerDisabled,boxShadow:"none"}),er=(Le,St,tt,At,tr,en,Kr)=>({[`&${Le}-background-ghost`]:Object.assign(Object.assign({color:St||void 0,backgroundColor:"transparent",borderColor:tt||void 0,boxShadow:"none"},nt(Object.assign({backgroundColor:"transparent"},en),Object.assign({backgroundColor:"transparent"},Kr))),{"&:disabled":{cursor:"not-allowed",color:At||void 0,borderColor:tr||void 0}})}),$r=Le=>({"&:disabled":Object.assign({},we(Le))}),Fn=Le=>Object.assign({},$r(Le)),Qt=Le=>({"&:disabled":{cursor:"not-allowed",color:Le.colorTextDisabled}}),Br=Le=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Fn(Le)),{backgroundColor:Le.colorBgContainer,borderColor:Le.colorBorder,boxShadow:`0 ${Le.controlOutlineWidth}px 0 ${Le.controlTmpOutline}`}),nt({color:Le.colorPrimaryHover,borderColor:Le.colorPrimaryHover},{color:Le.colorPrimaryActive,borderColor:Le.colorPrimaryActive})),er(Le.componentCls,Le.colorBgContainer,Le.colorBgContainer,Le.colorTextDisabled,Le.colorBorder)),{[`&${Le.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({color:Le.colorError,borderColor:Le.colorError},nt({color:Le.colorErrorHover,borderColor:Le.colorErrorBorderHover},{color:Le.colorErrorActive,borderColor:Le.colorErrorActive})),er(Le.componentCls,Le.colorError,Le.colorError,Le.colorTextDisabled,Le.colorBorder)),$r(Le))}),bn=Le=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Fn(Le)),{color:Le.colorTextLightSolid,backgroundColor:Le.colorPrimary,boxShadow:`0 ${Le.controlOutlineWidth}px 0 ${Le.controlOutline}`}),nt({color:Le.colorTextLightSolid,backgroundColor:Le.colorPrimaryHover},{color:Le.colorTextLightSolid,backgroundColor:Le.colorPrimaryActive})),er(Le.componentCls,Le.colorPrimary,Le.colorPrimary,Le.colorTextDisabled,Le.colorBorder,{color:Le.colorPrimaryHover,borderColor:Le.colorPrimaryHover},{color:Le.colorPrimaryActive,borderColor:Le.colorPrimaryActive})),{[`&${Le.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({backgroundColor:Le.colorError,boxShadow:`0 ${Le.controlOutlineWidth}px 0 ${Le.colorErrorOutline}`},nt({backgroundColor:Le.colorErrorHover},{backgroundColor:Le.colorErrorActive})),er(Le.componentCls,Le.colorError,Le.colorError,Le.colorTextDisabled,Le.colorBorder,{color:Le.colorErrorHover,borderColor:Le.colorErrorHover},{color:Le.colorErrorActive,borderColor:Le.colorErrorActive})),$r(Le))}),gr=Le=>Object.assign(Object.assign({},Br(Le)),{borderStyle:"dashed"}),pn=Le=>Object.assign(Object.assign(Object.assign({color:Le.colorLink},nt({color:Le.colorLinkHover},{color:Le.colorLinkActive})),Qt(Le)),{[`&${Le.componentCls}-dangerous`]:Object.assign(Object.assign({color:Le.colorError},nt({color:Le.colorErrorHover},{color:Le.colorErrorActive})),Qt(Le))}),Sn=Le=>Object.assign(Object.assign(Object.assign({},nt({color:Le.colorText,backgroundColor:Le.colorBgTextHover},{color:Le.colorText,backgroundColor:Le.colorBgTextActive})),Qt(Le)),{[`&${Le.componentCls}-dangerous`]:Object.assign(Object.assign({color:Le.colorError},Qt(Le)),nt({color:Le.colorErrorHover,backgroundColor:Le.colorErrorBg},{color:Le.colorErrorHover,backgroundColor:Le.colorErrorBg}))}),Dn=Le=>Object.assign(Object.assign({},we(Le)),{[`&${Le.componentCls}:hover`]:Object.assign({},we(Le))}),ui=Le=>{const{componentCls:St}=Le;return{[`${St}-default`]:Br(Le),[`${St}-primary`]:bn(Le),[`${St}-dashed`]:gr(Le),[`${St}-link`]:pn(Le),[`${St}-text`]:Sn(Le),[`${St}-disabled`]:Dn(Le)}},di=function(Le){let St=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:tt,iconCls:At,controlHeight:tr,fontSize:en,lineHeight:Kr,lineWidth:Ft,borderRadius:rr,buttonPaddingHorizontal:ot}=Le,Li=Math.max(0,(tr-en*Kr)/2-Ft),Hr=ot-Ft,_i=`${tt}-icon-only`;return[{[`${tt}${St}`]:{fontSize:en,height:tr,padding:`${Li}px ${Hr}px`,borderRadius:rr,[`&${_i}`]:{width:tr,paddingInlineStart:0,paddingInlineEnd:0,[`&${tt}-round`]:{width:"auto"},"> span":{transform:"scale(1.143)"}},[`&${tt}-loading`]:{opacity:Le.opacityLoading,cursor:"default"},[`${tt}-loading-icon`]:{transition:`width ${Le.motionDurationSlow} ${Le.motionEaseInOut}, opacity ${Le.motionDurationSlow} ${Le.motionEaseInOut}`},[`&:not(${_i}) ${tt}-loading-icon > ${At}`]:{marginInlineEnd:Le.marginXS}}},{[`${tt}${tt}-circle${St}`]:it(Le)},{[`${tt}${tt}-round${St}`]:_t(Le)}]},ca=Le=>di(Le),Ni=Le=>{const St=(0,ci.TS)(Le,{controlHeight:Le.controlHeightSM,padding:Le.paddingXS,buttonPaddingHorizontal:8,borderRadius:Le.borderRadiusSM});return di(St,`${Le.componentCls}-sm`)},Wa=Le=>{const St=(0,ci.TS)(Le,{controlHeight:Le.controlHeightLG,fontSize:Le.fontSizeLG,borderRadius:Le.borderRadiusLG});return di(St,`${Le.componentCls}-lg`)},Ba=Le=>{const{componentCls:St}=Le;return{[St]:{[`&${St}-block`]:{width:"100%"}}}};var Ia=(0,Fe.Z)("Button",Le=>{const{controlTmpOutline:St,paddingContentHorizontal:tt}=Le,At=(0,ci.TS)(Le,{colorOutlineDefault:St,buttonPaddingHorizontal:tt});return[Pr(At),Ni(At),ca(At),Wa(At),Ba(At),ui(At),ea(At),(0,tn.c)(Le,{focus:!1}),Ai(Le)]}),an=function(Le,St){var tt={};for(var At in Le)Object.prototype.hasOwnProperty.call(Le,At)&&St.indexOf(At)<0&&(tt[At]=Le[At]);if(Le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var tr=0,At=Object.getOwnPropertySymbols(Le);tr<At.length;tr++)St.indexOf(At[tr])<0&&Object.prototype.propertyIsEnumerable.call(Le,At[tr])&&(tt[At[tr]]=Le[At[tr]]);return tt};function Ln(Le){return Le==="danger"?{danger:!0}:{type:Le}}function re(Le){if(typeof Le=="object"&&Le){const St=Le==null?void 0:Le.delay;return{loading:!1,delay:!Number.isNaN(St)&&typeof St=="number"?St:0}}return{loading:!!Le,delay:0}}const he=(Le,St)=>{const{loading:tt=!1,prefixCls:At,type:tr="default",danger:en,shape:Kr="default",size:Ft,disabled:rr,className:ot,rootClassName:Li,children:Hr,icon:_i,ghost:vi=!1,block:It=!1,htmlType:Yr="button"}=Le,Dr=an(Le,["loading","prefixCls","type","danger","shape","size","disabled","className","rootClassName","children","icon","ghost","block","htmlType"]),{getPrefixCls:Jn,autoInsertSpaceInButton:Kt,direction:hr}=ae.useContext(F.E_),Fr=Jn("btn",At),[qr,An]=Ia(Fr),Ui=ae.useContext(W.Z),fa=ae.useContext(K.Z),Wi=rr!=null?rr:fa,ct=ae.useContext(Se),qi=ae.useMemo(()=>re(tt),[tt]),[Na,To]=ae.useState(qi.loading),[ao,Ga]=ae.useState(!1),Ko=St||ae.createRef(),ws=()=>ae.Children.count(Hr)===1&&!_i&&!bt(tr),Fo=()=>{if(!Ko||!Ko.current||Kt===!1)return;const fi=Ko.current.textContent;ws()&&be(fi)?ao||Ga(!0):ao&&Ga(!1)};ae.useEffect(()=>{let fi=null;qi.delay>0?fi=window.setTimeout(()=>{fi=null,To(!0)},qi.delay):To(qi.loading);function is(){fi&&(window.clearTimeout(fi),fi=null)}return is},[qi]),ae.useEffect(Fo,[Ko]);const su=fi=>{const{onClick:is}=Le;if(Na||Wi){fi.preventDefault();return}is==null||is(fi)},zo=Kt!==!1,{compactSize:ns,compactItemClassnames:ls}=(0,Y.ri)(Fr,hr),_o={large:"lg",small:"sm",middle:void 0},Po=ns||ct||Ft||Ui,Ss=Po&&_o[Po]||"",Wu=Na?"loading":_i,$s=(0,m.Z)(Dr,["navigate"]),uu=$s.href!==void 0&&Wi,Jo=k()(Fr,An,{[`${Fr}-${Kr}`]:Kr!=="default"&&Kr,[`${Fr}-${tr}`]:tr,[`${Fr}-${Ss}`]:Ss,[`${Fr}-icon-only`]:!Hr&&Hr!==0&&!!Wu,[`${Fr}-background-ghost`]:vi&&!bt(tr),[`${Fr}-loading`]:Na,[`${Fr}-two-chinese-chars`]:ao&&zo&&!Na,[`${Fr}-block`]:It,[`${Fr}-dangerous`]:!!en,[`${Fr}-rtl`]:hr==="rtl",[`${Fr}-disabled`]:uu},ls,ot,Li),ms=_i&&!Na?_i:ae.createElement(Ze,{existIcon:!!_i,prefixCls:Fr,loading:!!Na}),eu=Hr||Hr===0?Er(Hr,ws()&&zo):null;if($s.href!==void 0)return qr(ae.createElement("a",Object.assign({},$s,{className:Jo,onClick:su,ref:Ko}),ms,eu));let Bs=ae.createElement("button",Object.assign({},Dr,{type:Yr,className:Jo,onClick:su,disabled:Wi,ref:Ko}),ms,eu);return bt(tr)||(Bs=ae.createElement(Ye,{disabled:!!Na},Bs)),qr(Bs)},V=ae.forwardRef(he);V.Group=oe,V.__ANT_BUTTON=!0;var Et=V,Bt=Et},79840:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return Er}});var D=I(94184),k=I.n(D),m=I(87462),ae=I(4942),F=I(91),K=I(1413),W=I(15671),Y=I(43144),G=I(60136),$=I(29388),xe=I(67294),Fe=function(Vt){(0,G.Z)(hn,Vt);var on=(0,$.Z)(hn);function hn(gi){var Hn;(0,W.Z)(this,hn),Hn=on.call(this,gi),Hn.handleChange=function(Ea){var Ze=Hn.props,ci=Ze.disabled,Ci=Ze.onChange;ci||("checked"in Hn.props||Hn.setState({checked:Ea.target.checked}),Ci&&Ci({target:(0,K.Z)((0,K.Z)({},Hn.props),{},{checked:Ea.target.checked}),stopPropagation:function(){Ea.stopPropagation()},preventDefault:function(){Ea.preventDefault()},nativeEvent:Ea.nativeEvent}))},Hn.saveInput=function(Ea){Hn.input=Ea};var Dt="checked"in gi?gi.checked:gi.defaultChecked;return Hn.state={checked:Dt},Hn}return(0,Y.Z)(hn,[{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var Hn,Dt=this.props,Ea=Dt.prefixCls,Ze=Dt.className,ci=Dt.style,Ci=Dt.name,Oi=Dt.id,ea=Dt.type,fn=Dt.disabled,tn=Dt.readOnly,da=Dt.tabIndex,Ii=Dt.onClick,Ai=Dt.onFocus,Pr=Dt.onBlur,nt=Dt.onKeyDown,it=Dt.onKeyPress,_t=Dt.onKeyUp,we=Dt.autoFocus,er=Dt.value,$r=Dt.required,Fn=(0,F.Z)(Dt,["prefixCls","className","style","name","id","type","disabled","readOnly","tabIndex","onClick","onFocus","onBlur","onKeyDown","onKeyPress","onKeyUp","autoFocus","value","required"]),Qt=Object.keys(Fn).reduce(function(gr,pn){return(pn.substr(0,5)==="aria-"||pn.substr(0,5)==="data-"||pn==="role")&&(gr[pn]=Fn[pn]),gr},{}),Br=this.state.checked,bn=k()(Ea,Ze,(Hn={},(0,ae.Z)(Hn,"".concat(Ea,"-checked"),Br),(0,ae.Z)(Hn,"".concat(Ea,"-disabled"),fn),Hn));return xe.createElement("span",{className:bn,style:ci},xe.createElement("input",(0,m.Z)({name:Ci,id:Oi,type:ea,required:$r,readOnly:tn,disabled:fn,tabIndex:da,className:"".concat(Ea,"-input"),checked:!!Br,onClick:Ii,onFocus:Ai,onBlur:Pr,onKeyUp:_t,onKeyDown:nt,onKeyPress:it,onChange:this.handleChange,autoFocus:we,ref:this.saveInput,value:er},Qt)),xe.createElement("span",{className:"".concat(Ea,"-inner")}))}}],[{key:"getDerivedStateFromProps",value:function(Hn,Dt){return"checked"in Hn?(0,K.Z)((0,K.Z)({},Dt),{},{checked:Hn.checked}):null}}]),hn}(xe.Component);Fe.defaultProps={prefixCls:"rc-checkbox",className:"",style:{},type:"checkbox",defaultChecked:!1,onFocus:function(){},onBlur:function(){},onChange:function(){},onKeyDown:function(){},onKeyPress:function(){},onKeyUp:function(){}};var Ce=Fe,We=I(53124),me=I(65223),Ge=I(74902),Ke=I(98423),pt=I(51222),Xe=I(45503),gt=I(67968),ie=I(14747);const ft=new pt.E4("antCheckboxEffect",{"0%":{transform:"scale(1)",opacity:.5},"100%":{transform:"scale(1.6)",opacity:0}}),ve=Vt=>{const{checkboxCls:on}=Vt,hn=`${on}-wrapper`;return[{[`${on}-group`]:Object.assign(Object.assign({},(0,ie.Wf)(Vt)),{display:"inline-flex"}),[hn]:Object.assign(Object.assign({},(0,ie.Wf)(Vt)),{display:"inline-flex",alignItems:"baseline",cursor:"pointer","&:after":{display:"inline-block",width:0,overflow:"hidden",content:"'\\a0'"},[`& + ${hn}`]:{marginInlineStart:Vt.marginXS},[`&${hn}-in-form-item`]:{'input[type="checkbox"]':{width:14,height:14}}}),[on]:Object.assign(Object.assign({},(0,ie.Wf)(Vt)),{top:"0.2em",position:"relative",whiteSpace:"nowrap",lineHeight:1,cursor:"pointer",[`${on}-input`]:{position:"absolute",inset:0,zIndex:1,width:"100%",height:"100%",cursor:"pointer",opacity:0,[`&:focus-visible + ${on}-inner`]:Object.assign({},(0,ie.oN)(Vt))},[`${on}-inner`]:{boxSizing:"border-box",position:"relative",top:0,insetInlineStart:0,display:"block",width:Vt.checkboxSize,height:Vt.checkboxSize,direction:"ltr",backgroundColor:Vt.colorBgContainer,border:`${Vt.lineWidth}px ${Vt.lineType} ${Vt.colorBorder}`,borderRadius:Vt.borderRadiusSM,borderCollapse:"separate",transition:`all ${Vt.motionDurationSlow}`,"&:after":{boxSizing:"border-box",position:"absolute",top:"50%",insetInlineStart:"21.5%",display:"table",width:Vt.checkboxSize/14*5,height:Vt.checkboxSize/14*8,border:`${Vt.lineWidthBold}px solid ${Vt.colorWhite}`,borderTop:0,borderInlineStart:0,transform:"rotate(45deg) scale(0) translate(-50%,-50%)",opacity:0,content:'""',transition:`all ${Vt.motionDurationFast} ${Vt.motionEaseInBack}, opacity ${Vt.motionDurationFast}`}},"& + span":{paddingInlineStart:Vt.paddingXS,paddingInlineEnd:Vt.paddingXS}})},{[on]:{"&-indeterminate":{[`${on}-inner`]:{"&:after":{top:"50%",insetInlineStart:"50%",width:Vt.fontSizeLG/2,height:Vt.fontSizeLG/2,backgroundColor:Vt.colorPrimary,border:0,transform:"translate(-50%, -50%) scale(1)",opacity:1,content:'""'}}}}},{[`${hn}:hover ${on}:after`]:{visibility:"visible"},[`
        ${hn}:not(${hn}-disabled),
        ${on}:not(${on}-disabled)
      `]:{[`&:hover ${on}-inner`]:{borderColor:Vt.colorPrimary}},[`${hn}:not(${hn}-disabled)`]:{[`&:hover ${on}-checked:not(${on}-disabled) ${on}-inner`]:{backgroundColor:Vt.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${on}-checked:not(${on}-disabled):after`]:{borderColor:Vt.colorPrimaryHover}}},{[`${on}-checked`]:{[`${on}-inner`]:{backgroundColor:Vt.colorPrimary,borderColor:Vt.colorPrimary,"&:after":{opacity:1,transform:"rotate(45deg) scale(1) translate(-50%,-50%)",transition:`all ${Vt.motionDurationMid} ${Vt.motionEaseOutBack} ${Vt.motionDurationFast}`}},"&:after":{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",borderRadius:Vt.borderRadiusSM,visibility:"hidden",border:`${Vt.lineWidthBold}px solid ${Vt.colorPrimary}`,animationName:ft,animationDuration:Vt.motionDurationSlow,animationTimingFunction:"ease-in-out",animationFillMode:"backwards",content:'""',transition:`all ${Vt.motionDurationSlow}`}},[`
        ${hn}-checked:not(${hn}-disabled),
        ${on}-checked:not(${on}-disabled)
      `]:{[`&:hover ${on}-inner`]:{backgroundColor:Vt.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${on}:after`]:{borderColor:Vt.colorPrimaryHover}}},{[`${hn}-disabled`]:{cursor:"not-allowed"},[`${on}-disabled`]:{[`&, ${on}-input`]:{cursor:"not-allowed",pointerEvents:"none"},[`${on}-inner`]:{background:Vt.colorBgContainerDisabled,borderColor:Vt.colorBorder,"&:after":{borderColor:Vt.colorTextDisabled}},"&:after":{display:"none"},"& + span":{color:Vt.colorTextDisabled},[`&${on}-indeterminate ${on}-inner::after`]:{background:Vt.colorTextDisabled}}}]};function Ae(Vt,on){const hn=(0,Xe.TS)(on,{checkboxCls:`.${Vt}`,checkboxSize:on.controlInteractiveSize});return[ve(hn)]}var Re=(0,gt.Z)("Checkbox",(Vt,on)=>{let{prefixCls:hn}=on;return[Ae(hn,Vt)]}),Ye=function(Vt,on){var hn={};for(var gi in Vt)Object.prototype.hasOwnProperty.call(Vt,gi)&&on.indexOf(gi)<0&&(hn[gi]=Vt[gi]);if(Vt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Hn=0,gi=Object.getOwnPropertySymbols(Vt);Hn<gi.length;Hn++)on.indexOf(gi[Hn])<0&&Object.prototype.propertyIsEnumerable.call(Vt,gi[Hn])&&(hn[gi[Hn]]=Vt[gi[Hn]]);return hn};const at=xe.createContext(null),ht=(Vt,on)=>{var{defaultValue:hn,children:gi,options:Hn=[],prefixCls:Dt,className:Ea,rootClassName:Ze,style:ci,onChange:Ci}=Vt,Oi=Ye(Vt,["defaultValue","children","options","prefixCls","className","rootClassName","style","onChange"]);const{getPrefixCls:ea,direction:fn}=xe.useContext(We.E_),[tn,da]=xe.useState(Oi.value||hn||[]),[Ii,Ai]=xe.useState([]);xe.useEffect(()=>{"value"in Oi&&da(Oi.value||[])},[Oi.value]);const Pr=()=>Hn.map(gr=>typeof gr=="string"||typeof gr=="number"?{label:gr,value:gr}:gr),nt=gr=>{Ai(pn=>pn.filter(Sn=>Sn!==gr))},it=gr=>{Ai(pn=>[].concat((0,Ge.Z)(pn),[gr]))},_t=gr=>{const pn=tn.indexOf(gr.value),Sn=(0,Ge.Z)(tn);pn===-1?Sn.push(gr.value):Sn.splice(pn,1),"value"in Oi||da(Sn);const Dn=Pr();Ci==null||Ci(Sn.filter(ui=>Ii.includes(ui)).sort((ui,di)=>{const ca=Dn.findIndex(Wa=>Wa.value===ui),Ni=Dn.findIndex(Wa=>Wa.value===di);return ca-Ni}))},we=ea("checkbox",Dt),er=`${we}-group`,[$r,Fn]=Re(we),Qt=(0,Ke.Z)(Oi,["value","disabled"]);Hn&&Hn.length>0&&(gi=Pr().map(gr=>xe.createElement(bt,{prefixCls:we,key:gr.value.toString(),disabled:"disabled"in gr?gr.disabled:Oi.disabled,value:gr.value,checked:tn.includes(gr.value),onChange:gr.onChange,className:`${er}-item`,style:gr.style},gr.label)));const Br={toggleOption:_t,value:tn,disabled:Oi.disabled,name:Oi.name,registerValue:it,cancelValue:nt},bn=k()(er,{[`${er}-rtl`]:fn==="rtl"},Ea,Ze,Fn);return $r(xe.createElement("div",Object.assign({className:bn,style:ci},Qt,{ref:on}),xe.createElement(at.Provider,{value:Br},gi)))},Se=xe.forwardRef(ht);var Qe=xe.memo(Se),oe=I(98866),ue=function(Vt,on){var hn={};for(var gi in Vt)Object.prototype.hasOwnProperty.call(Vt,gi)&&on.indexOf(gi)<0&&(hn[gi]=Vt[gi]);if(Vt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Hn=0,gi=Object.getOwnPropertySymbols(Vt);Hn<gi.length;Hn++)on.indexOf(gi[Hn])<0&&Object.prototype.propertyIsEnumerable.call(Vt,gi[Hn])&&(hn[gi[Hn]]=Vt[gi[Hn]]);return hn};const be=(Vt,on)=>{var hn,{prefixCls:gi,className:Hn,rootClassName:Dt,children:Ea,indeterminate:Ze=!1,style:ci,onMouseEnter:Ci,onMouseLeave:Oi,skipGroup:ea=!1,disabled:fn}=Vt,tn=ue(Vt,["prefixCls","className","rootClassName","children","indeterminate","style","onMouseEnter","onMouseLeave","skipGroup","disabled"]);const{getPrefixCls:da,direction:Ii}=xe.useContext(We.E_),Ai=xe.useContext(at),{isFormItemInput:Pr}=xe.useContext(me.aM),nt=xe.useContext(oe.Z),it=(hn=(Ai==null?void 0:Ai.disabled)||fn)!==null&&hn!==void 0?hn:nt,_t=xe.useRef(tn.value);xe.useEffect(()=>{Ai==null||Ai.registerValue(tn.value)},[]),xe.useEffect(()=>{if(!ea)return tn.value!==_t.current&&(Ai==null||Ai.cancelValue(_t.current),Ai==null||Ai.registerValue(tn.value),_t.current=tn.value),()=>Ai==null?void 0:Ai.cancelValue(tn.value)},[tn.value]);const we=da("checkbox",gi),[er,$r]=Re(we),Fn=Object.assign({},tn);Ai&&!ea&&(Fn.onChange=function(){tn.onChange&&tn.onChange.apply(tn,arguments),Ai.toggleOption&&Ai.toggleOption({label:Ea,value:tn.value})},Fn.name=Ai.name,Fn.checked=Ai.value.includes(tn.value));const Qt=k()({[`${we}-wrapper`]:!0,[`${we}-rtl`]:Ii==="rtl",[`${we}-wrapper-checked`]:Fn.checked,[`${we}-wrapper-disabled`]:it,[`${we}-wrapper-in-form-item`]:Pr},Hn,Dt,$r),Br=k()({[`${we}-indeterminate`]:Ze},$r),bn=Ze?"mixed":void 0;return er(xe.createElement("label",{className:Qt,style:ci,onMouseEnter:Ci,onMouseLeave:Oi},xe.createElement(Ce,Object.assign({"aria-checked":bn},Fn,{prefixCls:we,className:Br,disabled:it,ref:on})),Ea!==void 0&&xe.createElement("span",null,Ea)))};var bt=xe.forwardRef(be);const Ht=bt;Ht.Group=Qe,Ht.__ANT_CHECKBOX=!0;var Er=Ht},49474:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return ea}});var D=I(1413),k=I(67294),m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},ae=m,F=I(93771),K=function(tn,da){return k.createElement(F.Z,(0,D.Z)((0,D.Z)({},tn),{},{ref:da,icon:ae}))};K.displayName="RightOutlined";var W=k.forwardRef(K),Y=I(94184),G=I.n(Y),$=I(97685),xe=I(74902),Fe=I(71002),Ce=I(50344),We=I(21770),me=I(4942),Ge=I(87462),Ke=I(91),pt=I(62874),Xe=I(15105),gt=k.forwardRef(function(fn,tn){var da,Ii=fn.prefixCls,Ai=fn.forceRender,Pr=fn.className,nt=fn.style,it=fn.children,_t=fn.isActive,we=fn.role,er=k.useState(_t||Ai),$r=(0,$.Z)(er,2),Fn=$r[0],Qt=$r[1];return k.useEffect(function(){(Ai||_t)&&Qt(!0)},[Ai,_t]),Fn?k.createElement("div",{ref:tn,className:G()("".concat(Ii,"-content"),(da={},(0,me.Z)(da,"".concat(Ii,"-content-active"),_t),(0,me.Z)(da,"".concat(Ii,"-content-inactive"),!_t),da),Pr),style:nt,role:we},k.createElement("div",{className:"".concat(Ii,"-content-box")},it)):null});gt.displayName="PanelContent";var ie=gt,ft=["showArrow","headerClass","isActive","onItemClick","forceRender","className","prefixCls","collapsible","accordion","panelKey","extra","header","expandIcon","openMotion","destroyInactivePanel","children"],ve=k.forwardRef(function(fn,tn){var da,Ii,Ai=fn.showArrow,Pr=Ai===void 0?!0:Ai,nt=fn.headerClass,it=fn.isActive,_t=fn.onItemClick,we=fn.forceRender,er=fn.className,$r=fn.prefixCls,Fn=fn.collapsible,Qt=fn.accordion,Br=fn.panelKey,bn=fn.extra,gr=fn.header,pn=fn.expandIcon,Sn=fn.openMotion,Dn=fn.destroyInactivePanel,ui=fn.children,di=(0,Ke.Z)(fn,ft),ca=Fn==="disabled",Ni=Fn==="header",Wa=Fn==="icon",Ba=bn!=null&&typeof bn!="boolean",Ia=function(){_t==null||_t(Br)},an=function(Bt){(Bt.key==="Enter"||Bt.keyCode===Xe.Z.ENTER||Bt.which===Xe.Z.ENTER)&&Ia()},Ln=typeof pn=="function"?pn(fn):k.createElement("i",{className:"arrow"});Ln&&(Ln=k.createElement("div",{className:"".concat($r,"-expand-icon"),onClick:["header","icon"].includes(Fn)?Ia:void 0},Ln));var re=G()((da={},(0,me.Z)(da,"".concat($r,"-item"),!0),(0,me.Z)(da,"".concat($r,"-item-active"),it),(0,me.Z)(da,"".concat($r,"-item-disabled"),ca),da),er),he=G()((Ii={},(0,me.Z)(Ii,"".concat($r,"-header"),!0),(0,me.Z)(Ii,"headerClass",nt),(0,me.Z)(Ii,"".concat($r,"-header-collapsible-only"),Ni),(0,me.Z)(Ii,"".concat($r,"-icon-collapsible-only"),Wa),Ii)),V={className:he,"aria-expanded":it,"aria-disabled":ca,onKeyPress:an};return!Ni&&!Wa&&(V.onClick=Ia,V.role=Qt?"tab":"button",V.tabIndex=ca?-1:0),k.createElement("div",(0,Ge.Z)({},di,{ref:tn,className:re}),k.createElement("div",V,Pr&&Ln,k.createElement("span",{className:"".concat($r,"-header-text"),onClick:Fn==="header"?Ia:void 0},gr),Ba&&k.createElement("div",{className:"".concat($r,"-extra")},bn)),k.createElement(pt.Z,(0,Ge.Z)({visible:it,leavedClassName:"".concat($r,"-content-hidden")},Sn,{forceRender:we,removeOnLeave:Dn}),function(Et,Bt){var Le=Et.className,St=Et.style;return k.createElement(ie,{ref:Bt,prefixCls:$r,className:Le,style:St,isActive:it,forceRender:we,role:Qt?"tabpanel":void 0},ui)}))}),Ae=ve;function Re(fn){var tn=fn;if(!Array.isArray(tn)){var da=(0,Fe.Z)(tn);tn=da==="number"||da==="string"?[tn]:[]}return tn.map(function(Ii){return String(Ii)})}var Ye=k.forwardRef(function(fn,tn){var da=fn.prefixCls,Ii=da===void 0?"rc-collapse":da,Ai=fn.destroyInactivePanel,Pr=Ai===void 0?!1:Ai,nt=fn.style,it=fn.accordion,_t=fn.className,we=fn.children,er=fn.collapsible,$r=fn.openMotion,Fn=fn.expandIcon,Qt=fn.activeKey,Br=fn.defaultActiveKey,bn=fn.onChange,gr=G()(Ii,_t),pn=(0,We.Z)([],{value:Qt,onChange:function(Ba){return bn==null?void 0:bn(Ba)},defaultValue:Br,postState:Re}),Sn=(0,$.Z)(pn,2),Dn=Sn[0],ui=Sn[1],di=function(Ba){return ui(function(){if(it)return Dn[0]===Ba?[]:[Ba];var Ia=Dn.indexOf(Ba),an=Ia>-1;return an?Dn.filter(function(Ln){return Ln!==Ba}):[].concat((0,xe.Z)(Dn),[Ba])})},ca=function(Ba,Ia){if(!Ba)return null;var an=Ba.key||String(Ia),Ln=Ba.props,re=Ln.header,he=Ln.headerClass,V=Ln.destroyInactivePanel,Et=Ln.collapsible,Bt=Ln.onItemClick,Le=!1;it?Le=Dn[0]===an:Le=Dn.indexOf(an)>-1;var St=Et!=null?Et:er,tt=function(en){St!=="disabled"&&(di(en),Bt==null||Bt(en))},At={key:an,panelKey:an,header:re,headerClass:he,isActive:Le,prefixCls:Ii,destroyInactivePanel:V!=null?V:Pr,openMotion:$r,accordion:it,children:Ba.props.children,onItemClick:tt,expandIcon:Fn,collapsible:St};return typeof Ba.type=="string"?Ba:(Object.keys(At).forEach(function(tr){typeof At[tr]=="undefined"&&delete At[tr]}),k.cloneElement(Ba,At))},Ni=(0,Ce.Z)(we).map(ca);return k.createElement("div",{ref:tn,className:gr,style:nt,role:it?"tablist":void 0},Ni)}),at=Object.assign(Ye,{Panel:Ae}),ht=at,Se=at.Panel,Qe=I(98423),oe=I(53124),ue=I(33603),be=I(96159),vt=I(97647),Ht=k.forwardRef((fn,tn)=>{const{getPrefixCls:da}=k.useContext(oe.E_),{prefixCls:Ii,className:Ai="",showArrow:Pr=!0}=fn,nt=da("collapse",Ii),it=G()({[`${nt}-no-arrow`]:!Pr},Ai);return k.createElement(ht.Panel,Object.assign({ref:tn},fn,{prefixCls:nt,className:it}))}),Vt=fn=>({[fn.componentCls]:{[`${fn.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${fn.motionDurationMid} ${fn.motionEaseInOut},
        opacity ${fn.motionDurationMid} ${fn.motionEaseInOut} !important`}},[`${fn.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${fn.motionDurationMid} ${fn.motionEaseInOut},
        opacity ${fn.motionDurationMid} ${fn.motionEaseInOut} !important`}}}),on=I(67968),hn=I(45503),gi=I(14747);const Hn=fn=>{const{componentCls:tn,collapseContentBg:da,padding:Ii,collapseContentPaddingHorizontal:Ai,collapseHeaderBg:Pr,collapseHeaderPadding:nt,collapseHeaderPaddingSM:it,collapseHeaderPaddingLG:_t,collapsePanelBorderRadius:we,lineWidth:er,lineType:$r,colorBorder:Fn,colorText:Qt,colorTextHeading:Br,colorTextDisabled:bn,fontSize:gr,fontSizeLG:pn,lineHeight:Sn,marginSM:Dn,paddingSM:ui,paddingLG:di,motionDurationSlow:ca,fontSizeIcon:Ni}=fn,Wa=`${er}px ${$r} ${Fn}`;return{[tn]:Object.assign(Object.assign({},(0,gi.Wf)(fn)),{backgroundColor:Pr,border:Wa,borderBottom:0,borderRadius:`${we}px`,["&-rtl"]:{direction:"rtl"},[`& > ${tn}-item`]:{borderBottom:Wa,["&:last-child"]:{[`
            &,
            & > ${tn}-header`]:{borderRadius:`0 0 ${we}px ${we}px`}},[`> ${tn}-header`]:{position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:nt,color:Br,lineHeight:Sn,cursor:"pointer",transition:`all ${ca}, visibility 0s`,[`> ${tn}-header-text`]:{flex:"auto"},"&:focus":{outline:"none"},[`${tn}-expand-icon`]:{height:gr*Sn,display:"flex",alignItems:"center",paddingInlineEnd:Dn},[`${tn}-arrow`]:Object.assign(Object.assign({},(0,gi.Ro)()),{fontSize:Ni,svg:{transition:`transform ${ca}`}}),[`${tn}-header-text`]:{marginInlineEnd:"auto"}},[`${tn}-header-collapsible-only`]:{cursor:"default",[`${tn}-header-text`]:{flex:"none",cursor:"pointer"}},[`${tn}-icon-collapsible-only`]:{cursor:"default",[`${tn}-expand-icon`]:{cursor:"pointer"}},[`&${tn}-no-arrow`]:{[`> ${tn}-header`]:{paddingInlineStart:ui}}},[`${tn}-content`]:{color:Qt,backgroundColor:da,borderTop:Wa,[`& > ${tn}-content-box`]:{padding:`${Ii}px ${Ai}px`},["&-hidden"]:{display:"none"}},["&-small"]:{[`> ${tn}-item`]:{[`> ${tn}-header`]:{padding:it},[`> ${tn}-content > ${tn}-content-box`]:{padding:ui}}},["&-large"]:{[`> ${tn}-item`]:{fontSize:pn,[`> ${tn}-header`]:{padding:_t,[`> ${tn}-expand-icon`]:{height:pn*Sn}},[`> ${tn}-content > ${tn}-content-box`]:{padding:di}}},[`${tn}-item:last-child`]:{[`> ${tn}-content`]:{borderRadius:`0 0 ${we}px ${we}px`}},[`& ${tn}-item-disabled > ${tn}-header`]:{[`
          &,
          & > .arrow
        `]:{color:bn,cursor:"not-allowed"}},[`&${tn}-icon-position-end`]:{[`& > ${tn}-item`]:{[`> ${tn}-header`]:{[`${tn}-expand-icon`]:{order:1,paddingInlineEnd:0,paddingInlineStart:Dn}}}}})}},Dt=fn=>{const{componentCls:tn}=fn,da=`> ${tn}-item > ${tn}-header ${tn}-arrow svg`;return{[`${tn}-rtl`]:{[da]:{transform:"rotate(180deg)"}}}},Ea=fn=>{const{componentCls:tn,collapseHeaderBg:da,paddingXXS:Ii,colorBorder:Ai}=fn;return{[`${tn}-borderless`]:{backgroundColor:da,border:0,[`> ${tn}-item`]:{borderBottom:`1px solid ${Ai}`},[`
        > ${tn}-item:last-child,
        > ${tn}-item:last-child ${tn}-header
      `]:{borderRadius:0},[`> ${tn}-item:last-child`]:{borderBottom:0},[`> ${tn}-item > ${tn}-content`]:{backgroundColor:"transparent",borderTop:0},[`> ${tn}-item > ${tn}-content > ${tn}-content-box`]:{paddingTop:Ii}}}},Ze=fn=>{const{componentCls:tn,paddingSM:da}=fn;return{[`${tn}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${tn}-item`]:{borderBottom:0,[`> ${tn}-content`]:{backgroundColor:"transparent",border:0,[`> ${tn}-content-box`]:{paddingBlock:da}}}}}};var ci=(0,on.Z)("Collapse",fn=>{const tn=(0,hn.TS)(fn,{collapseContentBg:fn.colorBgContainer,collapseHeaderBg:fn.colorFillAlter,collapseHeaderPadding:`${fn.paddingSM}px ${fn.padding}px`,collapseHeaderPaddingSM:`${fn.paddingXS}px ${fn.paddingSM}px`,collapseHeaderPaddingLG:`${fn.padding}px ${fn.paddingLG}px`,collapsePanelBorderRadius:fn.borderRadiusLG,collapseContentPaddingHorizontal:16});return[Hn(tn),Ea(tn),Ze(tn),Dt(tn),Vt(tn)]}),Oi=Object.assign(k.forwardRef((fn,tn)=>{const{getPrefixCls:da,direction:Ii}=k.useContext(oe.E_),Ai=k.useContext(vt.Z),{prefixCls:Pr,className:nt,rootClassName:it,bordered:_t=!0,ghost:we,size:er,expandIconPosition:$r="start"}=fn,Fn=er||Ai||"middle",Qt=da("collapse",Pr),Br=da(),[bn,gr]=ci(Qt),pn=k.useMemo(()=>$r==="left"?"start":$r==="right"?"end":$r,[$r]),Sn=function(){let ca=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{expandIcon:Ni}=fn,Wa=Ni?Ni(ca):k.createElement(W,{rotate:ca.isActive?90:void 0});return(0,be.Tm)(Wa,()=>({className:G()(Wa.props.className,`${Qt}-arrow`)}))},Dn=G()(`${Qt}-icon-position-${pn}`,{[`${Qt}-borderless`]:!_t,[`${Qt}-rtl`]:Ii==="rtl",[`${Qt}-ghost`]:!!we,[`${Qt}-${Fn}`]:Fn!=="middle"},nt,it,gr),ui=Object.assign(Object.assign({},(0,ue.ZP)(Br)),{motionAppear:!1,leavedClassName:`${Qt}-content-hidden`}),di=()=>{const{children:ca}=fn;return(0,Ce.Z)(ca).map((Ni,Wa)=>{var Ba;if(!((Ba=Ni.props)===null||Ba===void 0)&&Ba.disabled){const Ia=Ni.key||String(Wa),{disabled:an,collapsible:Ln}=Ni.props,re=Object.assign(Object.assign({},(0,Qe.Z)(Ni.props,["disabled"])),{key:Ia,collapsible:Ln!=null?Ln:an?"disabled":void 0});return(0,be.Tm)(Ni,re)}return Ni})};return bn(k.createElement(ht,Object.assign({ref:tn,openMotion:ui},(0,Qe.Z)(fn,["rootClassName"]),{expandIcon:Sn,prefixCls:Qt,className:Dn}),di()))}),{Panel:Ht}),ea=Oi},98866:function(Ne,fe,I){"use strict";I.d(fe,{n:function(){return m}});var D=I(67294);const k=D.createContext(!1),m=ae=>{let{children:F,disabled:K}=ae;const W=D.useContext(k);return D.createElement(k.Provider,{value:K!=null?K:W},F)};fe.Z=k},97647:function(Ne,fe,I){"use strict";I.d(fe,{q:function(){return m}});var D=I(67294);const k=D.createContext(void 0),m=ae=>{let{children:F,size:K}=ae;const W=D.useContext(k);return D.createElement(k.Provider,{value:K||W},F)};fe.Z=k},53124:function(Ne,fe,I){"use strict";I.d(fe,{C:function(){return F},E_:function(){return ae},oR:function(){return k}});var D=I(67294);const k="anticon",m=(K,W)=>W||(K?`ant-${K}`:"ant"),ae=D.createContext({getPrefixCls:m,iconPrefixCls:k}),{Consumer:F}=ae},32170:function(Ne,fe,I){"use strict";I.d(fe,{ZP:function(){return Ea},w6:function(){return gi}});var D=I(51222),k=I(54775),m=I(71990),ae=I(56982),F=I(67294),K=I(81570);let W=Object.assign({},K.Z.Modal);function Y(Ze){Ze?W=Object.assign(Object.assign({},W),Ze):W=Object.assign({},K.Z.Modal)}function G(){return W}var $=I(76745);const xe="internalMark";var Ce=Ze=>{const{locale:ci={},children:Ci,_ANT_MARK__:Oi}=Ze;F.useEffect(()=>(Y(ci&&ci.Modal),()=>{Y()}),[ci]);const ea=F.useMemo(()=>Object.assign(Object.assign({},ci),{exist:!0}),[ci]);return F.createElement($.Z.Provider,{value:ea},Ci)},We=I(74342),me=I(48012),Ge=I(2790),Ke=I(53124),pt=I(16397),Xe=I(10274),gt=I(98924),ie=I(44958);const ft=`-ant-${Date.now()}-${Math.random()}`;function ve(Ze,ci){const Ci={},Oi=(tn,da)=>{let Ii=tn.clone();return Ii=(da==null?void 0:da(Ii))||Ii,Ii.toRgbString()},ea=(tn,da)=>{const Ii=new Xe.C(tn),Ai=(0,pt.R_)(Ii.toRgbString());Ci[`${da}-color`]=Oi(Ii),Ci[`${da}-color-disabled`]=Ai[1],Ci[`${da}-color-hover`]=Ai[4],Ci[`${da}-color-active`]=Ai[6],Ci[`${da}-color-outline`]=Ii.clone().setAlpha(.2).toRgbString(),Ci[`${da}-color-deprecated-bg`]=Ai[0],Ci[`${da}-color-deprecated-border`]=Ai[2]};if(ci.primaryColor){ea(ci.primaryColor,"primary");const tn=new Xe.C(ci.primaryColor),da=(0,pt.R_)(tn.toRgbString());da.forEach((Ai,Pr)=>{Ci[`primary-${Pr+1}`]=Ai}),Ci["primary-color-deprecated-l-35"]=Oi(tn,Ai=>Ai.lighten(35)),Ci["primary-color-deprecated-l-20"]=Oi(tn,Ai=>Ai.lighten(20)),Ci["primary-color-deprecated-t-20"]=Oi(tn,Ai=>Ai.tint(20)),Ci["primary-color-deprecated-t-50"]=Oi(tn,Ai=>Ai.tint(50)),Ci["primary-color-deprecated-f-12"]=Oi(tn,Ai=>Ai.setAlpha(Ai.getAlpha()*.12));const Ii=new Xe.C(da[0]);Ci["primary-color-active-deprecated-f-30"]=Oi(Ii,Ai=>Ai.setAlpha(Ai.getAlpha()*.3)),Ci["primary-color-active-deprecated-d-02"]=Oi(Ii,Ai=>Ai.darken(2))}return ci.successColor&&ea(ci.successColor,"success"),ci.warningColor&&ea(ci.warningColor,"warning"),ci.errorColor&&ea(ci.errorColor,"error"),ci.infoColor&&ea(ci.infoColor,"info"),`
  :root {
    ${Object.keys(Ci).map(tn=>`--${Ze}-${tn}: ${Ci[tn]};`).join(`
`)}
  }
  `.trim()}function Ae(Ze,ci){const Ci=ve(Ze,ci);(0,gt.Z)()&&(0,ie.hq)(Ci,`${ft}-dynamic-theme`)}var Re=I(98866),Ye=I(91881);function at(Ze,ci){const Ci=Ze||{},Oi=Ci.inherit===!1||!ci?me.u_:ci;return(0,ae.Z)(()=>{if(!Ze)return ci;const fn=Object.assign({},Oi.components);return Object.keys(Ze.components||{}).forEach(tn=>{fn[tn]=Object.assign(Object.assign({},fn[tn]),Ze.components[tn])}),Object.assign(Object.assign(Object.assign({},Oi),Ci),{token:Object.assign(Object.assign({},Oi.token),Ci.token),components:fn})},[Ci,Oi],(fn,tn)=>fn.some((da,Ii)=>{const Ai=tn[Ii];return!(0,Ye.Z)(da,Ai,!0)}))}var ht=I(97647),Se=I(14747),oe=Ze=>{const[ci,Ci]=(0,me.dQ)();return(0,D.xy)({theme:ci,token:Ci,hashId:"",path:["ant-design-icons",Ze]},()=>[{[`.${Ze}`]:Object.assign(Object.assign({},(0,Se.Ro)()),{[`.${Ze} .${Ze}-icon`]:{display:"block"}})}])},ue=function(Ze,ci){var Ci={};for(var Oi in Ze)Object.prototype.hasOwnProperty.call(Ze,Oi)&&ci.indexOf(Oi)<0&&(Ci[Oi]=Ze[Oi]);if(Ze!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ea=0,Oi=Object.getOwnPropertySymbols(Ze);ea<Oi.length;ea++)ci.indexOf(Oi[ea])<0&&Object.prototype.propertyIsEnumerable.call(Ze,Oi[ea])&&(Ci[Oi[ea]]=Ze[Oi[ea]]);return Ci};const be=null,vt=["getTargetContainer","getPopupContainer","renderEmpty","pageHeader","input","pagination","form","select"],bt="ant";let Ht,Er;function Vt(){return Ht||bt}function on(){return Er||Ke.oR}const hn=Ze=>{let{prefixCls:ci,iconPrefixCls:Ci,theme:Oi}=Ze;ci!==void 0&&(Ht=ci),Ci!==void 0&&(Er=Ci),Oi&&Ae(Vt(),Oi)},gi=()=>({getPrefixCls:(Ze,ci)=>ci||(Ze?`${Vt()}-${Ze}`:Vt()),getIconPrefixCls:on,getRootPrefixCls:()=>Ht||Vt()}),Hn=Ze=>{var ci,Ci;const{children:Oi,csp:ea,autoInsertSpaceInButton:fn,form:tn,locale:da,componentSize:Ii,direction:Ai,space:Pr,virtual:nt,dropdownMatchSelectWidth:it,legacyLocale:_t,parentContext:we,iconPrefixCls:er,theme:$r,componentDisabled:Fn}=Ze,Qt=F.useCallback((Ia,an)=>{const{prefixCls:Ln}=Ze;if(an)return an;const re=Ln||we.getPrefixCls("");return Ia?`${re}-${Ia}`:re},[we.getPrefixCls,Ze.prefixCls]),Br=er||we.iconPrefixCls||Ke.oR,bn=Br!==we.iconPrefixCls,gr=ea||we.csp,pn=oe(Br),Sn=at($r,we.theme),Dn={csp:gr,autoInsertSpaceInButton:fn,locale:da||_t,direction:Ai,space:Pr,virtual:nt,dropdownMatchSelectWidth:it,getPrefixCls:Qt,iconPrefixCls:Br,theme:Sn},ui=Object.assign({},we);Object.keys(Dn).forEach(Ia=>{Dn[Ia]!==void 0&&(ui[Ia]=Dn[Ia])}),vt.forEach(Ia=>{const an=Ze[Ia];an&&(ui[Ia]=an)});const di=(0,ae.Z)(()=>ui,ui,(Ia,an)=>{const Ln=Object.keys(Ia),re=Object.keys(an);return Ln.length!==re.length||Ln.some(he=>Ia[he]!==an[he])}),ca=F.useMemo(()=>({prefixCls:Br,csp:gr}),[Br,gr]);let Ni=bn?pn(Oi):Oi,Wa={};da&&(Wa=((ci=da.Form)===null||ci===void 0?void 0:ci.defaultValidateMessages)||((Ci=K.Z.Form)===null||Ci===void 0?void 0:Ci.defaultValidateMessages)||{}),tn&&tn.validateMessages&&(Wa=Object.assign(Object.assign({},Wa),tn.validateMessages)),Object.keys(Wa).length>0&&(Ni=F.createElement(m.RV,{validateMessages:Wa},Oi)),da&&(Ni=F.createElement(Ce,{locale:da,_ANT_MARK__:xe},Ni)),(Br||gr)&&(Ni=F.createElement(k.Z.Provider,{value:ca},Ni)),Ii&&(Ni=F.createElement(ht.q,{size:Ii},Ni));const Ba=F.useMemo(()=>{const Ia=Sn||{},{algorithm:an,token:Ln}=Ia,re=ue(Ia,["algorithm","token"]),he=an&&(!Array.isArray(an)||an.length>0)?(0,D.jG)(an):void 0;return Object.assign(Object.assign({},re),{theme:he,token:Object.assign(Object.assign({},Ge.Z),Ln)})},[Sn]);return $r&&(Ni=F.createElement(me.Mj.Provider,{value:Ba},Ni)),Fn!==void 0&&(Ni=F.createElement(Re.n,{disabled:Fn},Ni)),F.createElement(Ke.E_.Provider,{value:di},Ni)},Dt=Ze=>F.createElement(We.Z,null,(ci,Ci,Oi)=>F.createElement(Ke.C,null,ea=>F.createElement(Hn,Object.assign({parentContext:ea,legacyLocale:Oi},Ze))));Dt.ConfigContext=Ke.E_,Dt.SizeContext=ht.Z,Dt.config=hn;var Ea=Dt},65223:function(Ne,fe,I){"use strict";I.d(fe,{aM:function(){return W}});var D=I(71990),k=I(67294);const m=k.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),ae=null,F=G=>{const $=omit(G,["prefixCls"]);return React.createElement(RcFormProvider,Object.assign({},$))},K=k.createContext({prefixCls:""}),W=k.createContext({}),Y=G=>{let{children:$,status:xe,override:Fe}=G;const Ce=useContext(W),We=useMemo(()=>{const me=Object.assign({},Ce);return Fe&&delete me.isFormItemInput,xe&&(delete me.status,delete me.hasFeedback,delete me.feedbackIcon),me},[xe,Fe,Ce]);return React.createElement(W.Provider,{value:We},$)}},74342:function(Ne,fe,I){"use strict";var D=I(67294),k=I(76745),m=I(81570);const ae=K=>{const{componentName:W="global",defaultLocale:Y,children:G}=K,$=D.useContext(k.Z),xe=D.useMemo(()=>{var Ce;const We=Y||m.Z[W],me=(Ce=$==null?void 0:$[W])!==null&&Ce!==void 0?Ce:{};return Object.assign(Object.assign({},We instanceof Function?We():We),me||{})},[W,Y,$]),Fe=D.useMemo(()=>{const Ce=$&&$.locale;return $&&$.exist&&!Ce?m.Z.locale:Ce},[$]);return G(xe,Fe,$)};fe.Z=ae;const F=(K,W)=>{const Y=React.useContext(LocaleContext);return[React.useMemo(()=>{var $;const xe=W||defaultLocaleData[K],Fe=($=Y==null?void 0:Y[K])!==null&&$!==void 0?$:{};return Object.assign(Object.assign({},typeof xe=="function"?xe():xe),Fe||{})},[K,W,Y])]}},76745:function(Ne,fe,I){"use strict";var D=I(67294);const k=(0,D.createContext)(void 0);fe.Z=k},81570:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return xe}});var D={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},k={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},m=k,F={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},W={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},m),timePickerLocale:Object.assign({},F)},Y=W;const G="${label} is not a valid ${type}";var xe={locale:"en",Pagination:D,DatePicker:W,TimePicker:F,Calendar:Y,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:G,method:G,array:G,object:G,number:G,date:G,boolean:G,integer:G,float:G,regexp:G,email:G,url:G,hex:G},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh"}}},83370:function(Ne,fe,I){"use strict";I.d(fe,{ZP:function(){return Ia}});var D=I(74902),k=I(38135),m=I(67294),ae=I(32170),F=I(55780),K=I(1413),W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},Y=W,G=I(93771),$=function(Ln,re){return m.createElement(G.Z,(0,K.Z)((0,K.Z)({},Ln),{},{ref:re,icon:Y}))};$.displayName="ExclamationCircleFilled";var xe=m.forwardRef($),Fe=I(54990),Ce={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},We=Ce,me=function(Ln,re){return m.createElement(G.Z,(0,K.Z)((0,K.Z)({},Ln),{},{ref:re,icon:We}))};me.displayName="CheckCircleFilled";var Ge=m.forwardRef(me),Ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},pt=Ke,Xe=function(Ln,re){return m.createElement(G.Z,(0,K.Z)((0,K.Z)({},Ln),{},{ref:re,icon:pt}))};Xe.displayName="InfoCircleFilled";var gt=m.forwardRef(Xe),ie=I(97685),ft=I(91),ve=I(87462),Ae=I(73935),Re=I(62874),Ye=I(94184),at=I.n(Ye),ht=I(4942),Se=m.forwardRef(function(an,Ln){var re=an.prefixCls,he=an.style,V=an.className,Et=an.duration,Bt=Et===void 0?4.5:Et,Le=an.eventKey,St=an.content,tt=an.closable,At=an.closeIcon,tr=At===void 0?"x":At,en=an.props,Kr=an.onClick,Ft=an.onNoticeClose,rr=an.times,ot=m.useState(!1),Li=(0,ie.Z)(ot,2),Hr=Li[0],_i=Li[1],vi=function(){Ft(Le)};m.useEffect(function(){if(!Hr&&Bt>0){var Yr=setTimeout(function(){vi()},Bt*1e3);return function(){clearTimeout(Yr)}}},[Bt,Hr,rr]);var It="".concat(re,"-notice");return m.createElement("div",(0,ve.Z)({},en,{ref:Ln,className:at()(It,V,(0,ht.Z)({},"".concat(It,"-closable"),tt)),style:he,onMouseEnter:function(){_i(!0)},onMouseLeave:function(){_i(!1)},onClick:Kr}),m.createElement("div",{className:"".concat(It,"-content")},St),tt&&m.createElement("a",{tabIndex:0,className:"".concat(It,"-close"),onClick:function(Dr){Dr.preventDefault(),Dr.stopPropagation(),vi()}},tr))}),Qe=Se,oe=m.forwardRef(function(an,Ln){var re=an.prefixCls,he=re===void 0?"rc-notification":re,V=an.container,Et=an.motion,Bt=an.maxCount,Le=an.className,St=an.style,tt=an.onAllRemoved,At=m.useState([]),tr=(0,ie.Z)(At,2),en=tr[0],Kr=tr[1],Ft=function(Dr){var Jn,Kt=en.find(function(hr){return hr.key===Dr});Kt==null||(Jn=Kt.onClose)===null||Jn===void 0||Jn.call(Kt),Kr(function(hr){return hr.filter(function(Fr){return Fr.key!==Dr})})};m.useImperativeHandle(Ln,function(){return{open:function(Dr){Kr(function(Jn){var Kt=(0,D.Z)(Jn),hr=Kt.findIndex(function(An){return An.key===Dr.key}),Fr=(0,K.Z)({},Dr);if(hr>=0){var qr;Fr.times=(((qr=Jn[hr])===null||qr===void 0?void 0:qr.times)||0)+1,Kt[hr]=Fr}else Fr.times=0,Kt.push(Fr);return Bt>0&&Kt.length>Bt&&(Kt=Kt.slice(-Bt)),Kt})},close:function(Dr){Ft(Dr)},destroy:function(){Kr([])}}});var rr=m.useState({}),ot=(0,ie.Z)(rr,2),Li=ot[0],Hr=ot[1];m.useEffect(function(){var Yr={};en.forEach(function(Dr){var Jn=Dr.placement,Kt=Jn===void 0?"topRight":Jn;Kt&&(Yr[Kt]=Yr[Kt]||[],Yr[Kt].push(Dr))}),Object.keys(Li).forEach(function(Dr){Yr[Dr]=Yr[Dr]||[]}),Hr(Yr)},[en]);var _i=function(Dr){Hr(function(Jn){var Kt=(0,K.Z)({},Jn),hr=Kt[Dr]||[];return hr.length||delete Kt[Dr],Kt})},vi=m.useRef(!1);if(m.useEffect(function(){Object.keys(Li).length>0?vi.current=!0:vi.current&&(tt==null||tt(),vi.current=!1)},[Li]),!V)return null;var It=Object.keys(Li);return(0,Ae.createPortal)(m.createElement(m.Fragment,null,It.map(function(Yr){var Dr=Li[Yr],Jn=Dr.map(function(hr){return{config:hr,key:hr.key}}),Kt=typeof Et=="function"?Et(Yr):Et;return m.createElement(Re.V,(0,ve.Z)({key:Yr,className:at()(he,"".concat(he,"-").concat(Yr),Le==null?void 0:Le(Yr)),style:St==null?void 0:St(Yr),keys:Jn,motionAppear:!0},Kt,{onAllRemoved:function(){_i(Yr)}}),function(hr,Fr){var qr=hr.config,An=hr.className,Ui=hr.style,fa=qr.key,Wi=qr.times,ct=qr.className,qi=qr.style;return m.createElement(Qe,(0,ve.Z)({},qr,{ref:Fr,prefixCls:he,className:at()(An,ct),style:(0,K.Z)((0,K.Z)({},Ui),qi),times:Wi,key:fa,eventKey:fa,onNoticeClose:Ft}))})})),V)}),ue=oe,be=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved"],vt=function(){return document.body},bt=0;function Ht(){for(var an={},Ln=arguments.length,re=new Array(Ln),he=0;he<Ln;he++)re[he]=arguments[he];return re.forEach(function(V){V&&Object.keys(V).forEach(function(Et){var Bt=V[Et];Bt!==void 0&&(an[Et]=Bt)})}),an}function Er(){var an=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ln=an.getContainer,re=Ln===void 0?vt:Ln,he=an.motion,V=an.prefixCls,Et=an.maxCount,Bt=an.className,Le=an.style,St=an.onAllRemoved,tt=(0,ft.Z)(an,be),At=m.useState(),tr=(0,ie.Z)(At,2),en=tr[0],Kr=tr[1],Ft=m.useRef(),rr=m.createElement(ue,{container:en,ref:Ft,prefixCls:V,motion:he,maxCount:Et,className:Bt,style:Le,onAllRemoved:St}),ot=m.useState([]),Li=(0,ie.Z)(ot,2),Hr=Li[0],_i=Li[1],vi=m.useMemo(function(){return{open:function(Yr){var Dr=Ht(tt,Yr);(Dr.key===null||Dr.key===void 0)&&(Dr.key="rc-notification-".concat(bt),bt+=1),_i(function(Jn){return[].concat((0,D.Z)(Jn),[{type:"open",config:Dr}])})},close:function(Yr){_i(function(Dr){return[].concat((0,D.Z)(Dr),[{type:"close",key:Yr}])})},destroy:function(){_i(function(Yr){return[].concat((0,D.Z)(Yr),[{type:"destroy"}])})}}},[]);return m.useEffect(function(){Kr(re())}),m.useEffect(function(){Ft.current&&Hr.length&&(Hr.forEach(function(It){switch(It.type){case"open":Ft.current.open(It.config);break;case"close":Ft.current.close(It.key);break;case"destroy":Ft.current.destroy();break}}),_i([]))},[Hr]),[vi,rr]}var Vt=I(51222),on=I(67968),hn=I(45503),gi=I(14747);const Hn=an=>{const{componentCls:Ln,iconCls:re,boxShadow:he,colorBgElevated:V,colorSuccess:Et,colorError:Bt,colorWarning:Le,colorInfo:St,fontSizeLG:tt,motionEaseInOutCirc:At,motionDurationSlow:tr,marginXS:en,paddingXS:Kr,borderRadiusLG:Ft,zIndexPopup:rr,messageNoticeContentPadding:ot}=an,Li=new Vt.E4("MessageMoveIn",{"0%":{padding:0,transform:"translateY(-100%)",opacity:0},"100%":{padding:Kr,transform:"translateY(0)",opacity:1}}),Hr=new Vt.E4("MessageMoveOut",{"0%":{maxHeight:an.height,padding:Kr,opacity:1},"100%":{maxHeight:0,padding:0,opacity:0}});return[{[Ln]:Object.assign(Object.assign({},(0,gi.Wf)(an)),{position:"fixed",top:en,width:"100%",pointerEvents:"none",zIndex:rr,[`${Ln}-move-up`]:{animationFillMode:"forwards"},[`
        ${Ln}-move-up-appear,
        ${Ln}-move-up-enter
      `]:{animationName:Li,animationDuration:tr,animationPlayState:"paused",animationTimingFunction:At},[`
        ${Ln}-move-up-appear${Ln}-move-up-appear-active,
        ${Ln}-move-up-enter${Ln}-move-up-enter-active
      `]:{animationPlayState:"running"},[`${Ln}-move-up-leave`]:{animationName:Hr,animationDuration:tr,animationPlayState:"paused",animationTimingFunction:At},[`${Ln}-move-up-leave${Ln}-move-up-leave-active`]:{animationPlayState:"running"},"&-rtl":{direction:"rtl",span:{direction:"rtl"}}})},{[`${Ln}-notice`]:{padding:Kr,textAlign:"center",[`${Ln}-custom-content > ${re}`]:{verticalAlign:"text-bottom",marginInlineEnd:en,fontSize:tt},[`${Ln}-notice-content`]:{display:"inline-block",padding:ot,background:V,borderRadius:Ft,boxShadow:he,pointerEvents:"all"},[`${Ln}-success > ${re}`]:{color:Et},[`${Ln}-error > ${re}`]:{color:Bt},[`${Ln}-warning > ${re}`]:{color:Le},[`
        ${Ln}-info > ${re},
        ${Ln}-loading > ${re}`]:{color:St}}},{[`${Ln}-notice-pure-panel`]:{padding:0,textAlign:"start"}}]};var Dt=(0,on.Z)("Message",an=>{const Ln=(0,hn.TS)(an,{messageNoticeContentPadding:`${(an.controlHeightLG-an.fontSize*an.lineHeight)/2}px ${an.paddingSM}px`});return[Hn(Ln)]},an=>({height:150,zIndexPopup:an.zIndexPopupBase+10})),Ea=I(53124),Ze=function(an,Ln){var re={};for(var he in an)Object.prototype.hasOwnProperty.call(an,he)&&Ln.indexOf(he)<0&&(re[he]=an[he]);if(an!=null&&typeof Object.getOwnPropertySymbols=="function")for(var V=0,he=Object.getOwnPropertySymbols(an);V<he.length;V++)Ln.indexOf(he[V])<0&&Object.prototype.propertyIsEnumerable.call(an,he[V])&&(re[he[V]]=an[he[V]]);return re};const ci={info:m.createElement(gt,null),success:m.createElement(Ge,null),error:m.createElement(Fe.Z,null),warning:m.createElement(xe,null),loading:m.createElement(F.Z,null)};function Ci(an){let{prefixCls:Ln,type:re,icon:he,children:V}=an;return m.createElement("div",{className:at()(`${Ln}-custom-content`,`${Ln}-${re}`)},he||ci[re],m.createElement("span",null,V))}function Oi(an){const{prefixCls:Ln,className:re,type:he,icon:V,content:Et}=an,Bt=Ze(an,["prefixCls","className","type","icon","content"]),{getPrefixCls:Le}=m.useContext(Ea.E_),St=Ln||Le("message"),[,tt]=Dt(St);return m.createElement(Qe,Object.assign({},Bt,{prefixCls:St,className:at()(re,tt,`${St}-notice-pure-panel`),eventKey:"pure",duration:null,content:m.createElement(Ci,{prefixCls:St,type:he,icon:V},Et)}))}var ea=I(61976);function fn(an,Ln){return{motionName:Ln!=null?Ln:`${an}-move-up`}}function tn(an){let Ln;const re=new Promise(V=>{Ln=an(()=>{V(!0)})}),he=()=>{Ln==null||Ln()};return he.then=(V,Et)=>re.then(V,Et),he.promise=re,he}var da=function(an,Ln){var re={};for(var he in an)Object.prototype.hasOwnProperty.call(an,he)&&Ln.indexOf(he)<0&&(re[he]=an[he]);if(an!=null&&typeof Object.getOwnPropertySymbols=="function")for(var V=0,he=Object.getOwnPropertySymbols(an);V<he.length;V++)Ln.indexOf(he[V])<0&&Object.prototype.propertyIsEnumerable.call(an,he[V])&&(re[he[V]]=an[he[V]]);return re};const Ii=8,Ai=3,Pr=m.forwardRef((an,Ln)=>{const{top:re,prefixCls:he,getContainer:V,maxCount:Et,duration:Bt=Ai,rtl:Le,transitionName:St,onAllRemoved:tt}=an,{getPrefixCls:At,getPopupContainer:tr}=m.useContext(Ea.E_),en=he||At("message"),[,Kr]=Dt(en),Ft=()=>({left:"50%",transform:"translateX(-50%)",top:re!=null?re:Ii}),rr=()=>at()(Kr,Le?`${en}-rtl`:""),ot=()=>fn(en,St),Li=m.createElement("span",{className:`${en}-close-x`},m.createElement(ea.Z,{className:`${en}-close-icon`})),[Hr,_i]=Er({prefixCls:en,style:Ft,className:rr,motion:ot,closable:!1,closeIcon:Li,duration:Bt,getContainer:()=>(V==null?void 0:V())||(tr==null?void 0:tr())||document.body,maxCount:Et,onAllRemoved:tt});return m.useImperativeHandle(Ln,()=>Object.assign(Object.assign({},Hr),{prefixCls:en,hashId:Kr})),_i});let nt=0;function it(an){const Ln=m.useRef(null);return[m.useMemo(()=>{const he=St=>{var tt;(tt=Ln.current)===null||tt===void 0||tt.close(St)},V=St=>{if(!Ln.current){const It=()=>{};return It.then=()=>{},It}const{open:tt,prefixCls:At,hashId:tr}=Ln.current,en=`${At}-notice`,{content:Kr,icon:Ft,type:rr,key:ot,className:Li,onClose:Hr}=St,_i=da(St,["content","icon","type","key","className","onClose"]);let vi=ot;return vi==null&&(nt+=1,vi=`antd-message-${nt}`),tn(It=>(tt(Object.assign(Object.assign({},_i),{key:vi,content:m.createElement(Ci,{prefixCls:At,type:rr,icon:Ft},Kr),placement:"top",className:at()(rr&&`${en}-${rr}`,tr,Li),onClose:()=>{Hr==null||Hr(),It()}})),()=>{he(vi)}))},Bt={open:V,destroy:St=>{var tt;St!==void 0?he(St):(tt=Ln.current)===null||tt===void 0||tt.destroy()}};return["info","success","warning","error","loading"].forEach(St=>{const tt=(At,tr,en)=>{let Kr;At&&typeof At=="object"&&"content"in At?Kr=At:Kr={content:At};let Ft,rr;typeof tr=="function"?rr=tr:(Ft=tr,rr=en);const ot=Object.assign(Object.assign({onClose:rr,duration:Ft},Kr),{type:St});return V(ot)};Bt[St]=tt}),Bt},[]),m.createElement(Pr,Object.assign({key:"message-holder"},an,{ref:Ln}))]}function _t(an){return it(an)}const we=["success","info","warning","error","loading"];let er=null,$r=an=>an(),Fn=[],Qt={};function Br(){const{prefixCls:an,getContainer:Ln,duration:re,rtl:he,maxCount:V,top:Et}=Qt,Bt=an!=null?an:(0,ae.w6)().getPrefixCls("message"),Le=(Ln==null?void 0:Ln())||document.body;return{prefixCls:Bt,container:Le,duration:re,rtl:he,maxCount:V,top:Et}}const bn=m.forwardRef((an,Ln)=>{const re=()=>{const{prefixCls:tr,container:en,maxCount:Kr,duration:Ft,rtl:rr,top:ot}=Br();return{prefixCls:tr,getContainer:()=>en,maxCount:Kr,duration:Ft,rtl:rr,top:ot}},[he,V]=m.useState(re),[Et,Bt]=it(he),Le=(0,ae.w6)(),St=Le.getRootPrefixCls(),tt=Le.getIconPrefixCls(),At=()=>{V(re)};return m.useEffect(At,[]),m.useImperativeHandle(Ln,()=>{const tr=Object.assign({},Et);return Object.keys(tr).forEach(en=>{tr[en]=function(){return At(),Et[en].apply(Et,arguments)}}),{instance:tr,sync:At}}),m.createElement(ae.ZP,{prefixCls:St,iconPrefixCls:tt},Bt)});function gr(){if(!er){const an=document.createDocumentFragment(),Ln={fragment:an};er=Ln,$r(()=>{(0,k.s)(m.createElement(bn,{ref:re=>{const{instance:he,sync:V}=re||{};Promise.resolve().then(()=>{!Ln.instance&&he&&(Ln.instance=he,Ln.sync=V,gr())})}}),an)});return}er.instance&&(Fn.forEach(an=>{const{type:Ln,skipped:re}=an;if(!re)switch(Ln){case"open":{$r(()=>{const he=er.instance.open(Object.assign(Object.assign({},Qt),an.config));he==null||he.then(an.resolve),an.setCloseFn(he)});break}case"destroy":$r(()=>{er==null||er.instance.destroy(an.key)});break;default:$r(()=>{var he;const V=(he=er.instance)[Ln].apply(he,(0,D.Z)(an.args));V==null||V.then(an.resolve),an.setCloseFn(V)})}}),Fn=[])}function pn(an){Qt=Object.assign(Object.assign({},Qt),an),$r(()=>{var Ln;(Ln=er==null?void 0:er.sync)===null||Ln===void 0||Ln.call(er)})}function Sn(an){const Ln=tn(re=>{let he;const V={type:"open",config:an,resolve:re,setCloseFn:Et=>{he=Et}};return Fn.push(V),()=>{he?$r(()=>{he()}):V.skipped=!0}});return gr(),Ln}function Dn(an,Ln){const re=tn(he=>{let V;const Et={type:an,args:Ln,resolve:he,setCloseFn:Bt=>{V=Bt}};return Fn.push(Et),()=>{V?$r(()=>{V()}):Et.skipped=!0}});return gr(),re}function ui(an){Fn.push({type:"destroy",key:an}),gr()}const ca={open:Sn,destroy:ui,config:pn,useMessage:_t,_InternalPanelDoNotUseOrYouWillBeFired:Oi};we.forEach(an=>{ca[an]=function(){for(var Ln=arguments.length,re=new Array(Ln),he=0;he<Ln;he++)re[he]=arguments[he];return Dn(an,re)}});const Ni=()=>{};let Wa=null,Ba=null;var Ia=ca},84301:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return Jn}});var D=I(94184),k=I.n(D),m=I(67294),ae=I(53124),F=I(87462),K=I(71002),W=I(1413),Y=I(91),G=I(11276),$={adjustX:1,adjustY:1},xe=[0,0],Fe={left:{points:["cr","cl"],overflow:$,offset:[-4,0],targetOffset:xe},right:{points:["cl","cr"],overflow:$,offset:[4,0],targetOffset:xe},top:{points:["bc","tc"],overflow:$,offset:[0,-4],targetOffset:xe},bottom:{points:["tc","bc"],overflow:$,offset:[0,4],targetOffset:xe},topLeft:{points:["bl","tl"],overflow:$,offset:[0,-4],targetOffset:xe},leftTop:{points:["tr","tl"],overflow:$,offset:[-4,0],targetOffset:xe},topRight:{points:["br","tr"],overflow:$,offset:[0,-4],targetOffset:xe},rightTop:{points:["tl","tr"],overflow:$,offset:[4,0],targetOffset:xe},bottomRight:{points:["tr","br"],overflow:$,offset:[0,4],targetOffset:xe},rightBottom:{points:["bl","br"],overflow:$,offset:[4,0],targetOffset:xe},bottomLeft:{points:["tl","bl"],overflow:$,offset:[0,4],targetOffset:xe},leftBottom:{points:["br","bl"],overflow:$,offset:[-4,0],targetOffset:xe}},Ce=null;function We(Kt){var hr=Kt.showArrow,Fr=Kt.arrowContent,qr=Kt.children,An=Kt.prefixCls,Ui=Kt.id,fa=Kt.overlayInnerStyle,Wi=Kt.className,ct=Kt.style;return m.createElement("div",{className:k()("".concat(An,"-content"),Wi),style:ct},hr!==!1&&m.createElement("div",{className:"".concat(An,"-arrow"),key:"arrow"},Fr),m.createElement("div",{className:"".concat(An,"-inner"),id:Ui,role:"tooltip",style:fa},typeof qr=="function"?qr():qr))}var me=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],Ge=function(hr,Fr){var qr=hr.overlayClassName,An=hr.trigger,Ui=An===void 0?["hover"]:An,fa=hr.mouseEnterDelay,Wi=fa===void 0?0:fa,ct=hr.mouseLeaveDelay,qi=ct===void 0?.1:ct,Na=hr.overlayStyle,To=hr.prefixCls,ao=To===void 0?"rc-tooltip":To,Ga=hr.children,Ko=hr.onVisibleChange,ws=hr.afterVisibleChange,Fo=hr.transitionName,su=hr.animation,zo=hr.motion,ns=hr.placement,ls=ns===void 0?"right":ns,_o=hr.align,Po=_o===void 0?{}:_o,Ss=hr.destroyTooltipOnHide,Wu=Ss===void 0?!1:Ss,$s=hr.defaultVisible,uu=hr.getTooltipContainer,Jo=hr.overlayInnerStyle,ms=hr.arrowContent,eu=hr.overlay,Bs=hr.id,fi=hr.showArrow,is=fi===void 0?!0:fi,ku=(0,Y.Z)(hr,me),mt=(0,m.useRef)(null);(0,m.useImperativeHandle)(Fr,function(){return mt.current});var Gt=(0,W.Z)({},ku);"visible"in hr&&(Gt.popupVisible=hr.visible);var Cr=function(){return m.createElement(We,{showArrow:is,arrowContent:ms,key:"content",prefixCls:ao,id:Bs,overlayInnerStyle:Jo},eu)},Rr=!1,ji=!1;if(typeof Wu=="boolean")Rr=Wu;else if(Wu&&(0,K.Z)(Wu)==="object"){var Pa=Wu.keepParent;Rr=Pa===!0,ji=Pa===!1}return m.createElement(G.Z,(0,F.Z)({popupClassName:qr,prefixCls:ao,popup:Cr,action:Ui,builtinPlacements:Fe,popupPlacement:ls,ref:mt,popupAlign:Po,getPopupContainer:uu,onPopupVisibleChange:Ko,afterPopupVisibleChange:ws,popupTransitionName:Fo,popupAnimation:su,popupMotion:zo,defaultPopupVisible:$s,destroyPopupOnHide:Rr,autoDestroy:ji,mouseLeaveDelay:qi,popupStyle:Na,mouseEnterDelay:Wi},Gt),Ga)},Ke=(0,m.forwardRef)(Ge),pt=Ke,Xe=I(21770),gt=I(33603);const ie={adjustX:1,adjustY:1},ft={adjustX:0,adjustY:0},ve=[0,0];function Ae(Kt){return typeof Kt=="boolean"?Kt?ie:ft:Object.assign(Object.assign({},ft),Kt)}function Re(Kt,hr,Fr){switch(Kt){case"top":case"topLeft":case"topRight":return[0,-(hr/2+Fr)];case"bottom":case"bottomLeft":case"bottomRight":return[0,hr/2+Fr];case"left":case"leftTop":case"leftBottom":return[-(hr/2+Fr),0];case"right":case"rightTop":case"rightBottom":return[hr/2+Fr,0];default:return[0,0]}}function Ye(Kt,hr){return[Kt[0]+hr[0],Kt[1]+hr[1]]}function at(Kt){const{arrowWidth:hr,horizontalArrowShift:Fr=16,verticalArrowShift:qr=8,autoAdjustOverflow:An,arrowPointAtCenter:Ui,offset:fa}=Kt,Wi=hr/2,ct={left:{points:["cr","cl"],offset:[-fa,0]},right:{points:["cl","cr"],offset:[fa,0]},top:{points:["bc","tc"],offset:[0,-fa]},bottom:{points:["tc","bc"],offset:[0,fa]},topLeft:{points:["bl","tc"],offset:[-(Fr+Wi),-fa]},leftTop:{points:["tr","cl"],offset:[-fa,-(qr+Wi)]},topRight:{points:["br","tc"],offset:[Fr+Wi,-fa]},rightTop:{points:["tl","cr"],offset:[fa,-(qr+Wi)]},bottomRight:{points:["tr","bc"],offset:[Fr+Wi,fa]},rightBottom:{points:["bl","cr"],offset:[fa,qr+Wi]},bottomLeft:{points:["tl","bc"],offset:[-(Fr+Wi),fa]},leftBottom:{points:["br","cl"],offset:[-fa,qr+Wi]}};return Object.keys(ct).forEach(qi=>{ct[qi]=Ui?Object.assign(Object.assign({},ct[qi]),{offset:Ye(ct[qi].offset,Re(qi,hr,fa)),overflow:Ae(An),targetOffset:ve}):Object.assign(Object.assign({},Fe[qi]),{offset:Ye(Fe[qi].offset,Re(qi,hr,fa)),overflow:Ae(An)}),ct[qi].ignoreShake=!0}),ct}var ht=I(96159),Se=I(51222),Qe=I(93590);const oe=new Se.E4("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),ue=new Se.E4("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),be=new Se.E4("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),vt=new Se.E4("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),bt=new Se.E4("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),Ht=new Se.E4("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),Er=new Se.E4("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),Vt=new Se.E4("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),on=new Se.E4("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),hn=new Se.E4("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),gi=new Se.E4("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),Hn=new Se.E4("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),Dt={zoom:{inKeyframes:oe,outKeyframes:ue},"zoom-big":{inKeyframes:be,outKeyframes:vt},"zoom-big-fast":{inKeyframes:be,outKeyframes:vt},"zoom-left":{inKeyframes:Er,outKeyframes:Vt},"zoom-right":{inKeyframes:on,outKeyframes:hn},"zoom-up":{inKeyframes:bt,outKeyframes:Ht},"zoom-down":{inKeyframes:gi,outKeyframes:Hn}},Ea=(Kt,hr)=>{const{antCls:Fr}=Kt,qr=`${Fr}-${hr}`,{inKeyframes:An,outKeyframes:Ui}=Dt[hr];return[(0,Qe.R)(qr,An,Ui,hr==="zoom-big-fast"?Kt.motionDurationFast:Kt.motionDurationMid),{[`
        ${qr}-enter,
        ${qr}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:Kt.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${qr}-leave`]:{animationTimingFunction:Kt.motionEaseInOutCirc}}]};var Ze=I(45503),ci=I(67968),Ci=I(14747);const Oi=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"];function ea(Kt,hr){return Oi.reduce((Fr,qr)=>{const An=Kt[`${qr}-1`],Ui=Kt[`${qr}-3`],fa=Kt[`${qr}-6`],Wi=Kt[`${qr}-7`];return Object.assign(Object.assign({},Fr),hr(qr,{lightColor:An,lightBorderColor:Ui,darkColor:fa,textColor:Wi}))},{})}const fn=(Kt,hr,Fr,qr,An)=>{const Ui=Kt/2,fa=0,Wi=Ui,ct=Fr*1/Math.sqrt(2),qi=Ui-Fr*(1-1/Math.sqrt(2)),Na=Ui-hr*(1/Math.sqrt(2)),To=Fr*(Math.sqrt(2)-1)+hr*(1/Math.sqrt(2)),ao=2*Ui-Na,Ga=To,Ko=2*Ui-ct,ws=qi,Fo=2*Ui-fa,su=Wi,zo=Ui*Math.sqrt(2)+Fr*(Math.sqrt(2)-2);return{borderRadius:{_skip_check_:!0,value:`0 0 ${hr}px`},pointerEvents:"none",width:Kt,height:Kt,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:Kt,height:Kt/2,background:qr,clipPath:`path('M ${fa} ${Wi} A ${Fr} ${Fr} 0 0 0 ${ct} ${qi} L ${Na} ${To} A ${hr} ${hr} 0 0 1 ${ao} ${Ga} L ${Ko} ${ws} A ${Fr} ${Fr} 0 0 0 ${Fo} ${su} Z')`,content:'""'},"&::after":{content:'""',position:"absolute",width:zo,height:zo,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${hr}px 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:An,zIndex:0,background:"transparent"}}},tn=8;function da(Kt){const hr=tn,{contentRadius:Fr,limitVerticalRadius:qr}=Kt,An=Fr>12?Fr+2:12;return{dropdownArrowOffset:An,dropdownArrowOffsetVertical:qr?hr:An}}function Ii(Kt,hr){return Kt?hr:{}}function Ai(Kt,hr){const{componentCls:Fr,sizePopupArrow:qr,borderRadiusXS:An,borderRadiusOuter:Ui,boxShadowPopoverArrow:fa}=Kt,{colorBg:Wi,contentRadius:ct=Kt.borderRadiusLG,limitVerticalRadius:qi,arrowDistance:Na=0,arrowPlacement:To={left:!0,right:!0,top:!0,bottom:!0}}=hr,{dropdownArrowOffsetVertical:ao,dropdownArrowOffset:Ga}=da({contentRadius:ct,limitVerticalRadius:qi});return{[Fr]:Object.assign(Object.assign(Object.assign(Object.assign({[`${Fr}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},fn(qr,An,Ui,Wi,fa)),{"&:before":{background:Wi}})]},Ii(!!To.top,{[[`&-placement-top ${Fr}-arrow`,`&-placement-topLeft ${Fr}-arrow`,`&-placement-topRight ${Fr}-arrow`].join(",")]:{bottom:Na,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top ${Fr}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},[`&-placement-topLeft ${Fr}-arrow`]:{left:{_skip_check_:!0,value:Ga}},[`&-placement-topRight ${Fr}-arrow`]:{right:{_skip_check_:!0,value:Ga}}})),Ii(!!To.bottom,{[[`&-placement-bottom ${Fr}-arrow`,`&-placement-bottomLeft ${Fr}-arrow`,`&-placement-bottomRight ${Fr}-arrow`].join(",")]:{top:Na,transform:"translateY(-100%)"},[`&-placement-bottom ${Fr}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},[`&-placement-bottomLeft ${Fr}-arrow`]:{left:{_skip_check_:!0,value:Ga}},[`&-placement-bottomRight ${Fr}-arrow`]:{right:{_skip_check_:!0,value:Ga}}})),Ii(!!To.left,{[[`&-placement-left ${Fr}-arrow`,`&-placement-leftTop ${Fr}-arrow`,`&-placement-leftBottom ${Fr}-arrow`].join(",")]:{right:{_skip_check_:!0,value:Na},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left ${Fr}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop ${Fr}-arrow`]:{top:ao},[`&-placement-leftBottom ${Fr}-arrow`]:{bottom:ao}})),Ii(!!To.right,{[[`&-placement-right ${Fr}-arrow`,`&-placement-rightTop ${Fr}-arrow`,`&-placement-rightBottom ${Fr}-arrow`].join(",")]:{left:{_skip_check_:!0,value:Na},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right ${Fr}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop ${Fr}-arrow`]:{top:ao},[`&-placement-rightBottom ${Fr}-arrow`]:{bottom:ao}}))}}const Pr=Kt=>{const{componentCls:hr,tooltipMaxWidth:Fr,tooltipColor:qr,tooltipBg:An,tooltipBorderRadius:Ui,zIndexPopup:fa,controlHeight:Wi,boxShadowSecondary:ct,paddingSM:qi,paddingXS:Na,tooltipRadiusOuter:To}=Kt;return[{[hr]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,Ci.Wf)(Kt)),{position:"absolute",zIndex:fa,display:"block","&":[{width:"max-content"},{width:"intrinsic"}],maxWidth:Fr,visibility:"visible","&-hidden":{display:"none"},"--antd-arrow-background-color":An,[`${hr}-inner`]:{minWidth:Wi,minHeight:Wi,padding:`${qi/2}px ${Na}px`,color:qr,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:An,borderRadius:Ui,boxShadow:ct},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${hr}-inner`]:{borderRadius:Math.min(Ui,tn)}},[`${hr}-content`]:{position:"relative"}}),ea(Kt,(ao,Ga)=>{let{darkColor:Ko}=Ga;return{[`&${hr}-${ao}`]:{[`${hr}-inner`]:{backgroundColor:Ko},[`${hr}-arrow`]:{"--antd-arrow-background-color":Ko}}}})),{"&-rtl":{direction:"rtl"}})},Ai((0,Ze.TS)(Kt,{borderRadiusOuter:To}),{colorBg:"var(--antd-arrow-background-color)",contentRadius:Ui,limitVerticalRadius:!0}),{[`${hr}-pure`]:{position:"relative",maxWidth:"none"}}]};var nt=(Kt,hr)=>(0,ci.Z)("Tooltip",qr=>{if(hr===!1)return[];const{borderRadius:An,colorTextLightSolid:Ui,colorBgDefault:fa,borderRadiusOuter:Wi}=qr,ct=(0,Ze.TS)(qr,{tooltipMaxWidth:250,tooltipColor:Ui,tooltipBorderRadius:An,tooltipBg:fa,tooltipRadiusOuter:Wi>4?4:Wi});return[Pr(ct),Ea(qr,"zoom-big-fast")]},qr=>{let{zIndexPopupBase:An,colorBgSpotlight:Ui}=qr;return{zIndexPopup:An+70,colorBgDefault:Ui}})(Kt),it=I(74902);const _t=Oi.map(Kt=>`${Kt}-inverse`),we=null;function er(Kt){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat((0,it.Z)(_t),(0,it.Z)(Oi)).includes(Kt):Oi.includes(Kt)}function $r(Kt){return we.includes(Kt)}function Fn(Kt,hr){const Fr=er(hr),qr=k()({[`${Kt}-${hr}`]:hr&&Fr}),An={},Ui={};return hr&&!Fr&&(An.background=hr,Ui["--antd-arrow-background-color"]=hr),{className:qr,overlayStyle:An,arrowStyle:Ui}}function Qt(Kt){const{prefixCls:hr,className:Fr,placement:qr="top",title:An,color:Ui,overlayInnerStyle:fa}=Kt,{getPrefixCls:Wi}=m.useContext(ae.E_),ct=Wi("tooltip",hr),[qi,Na]=nt(ct,!0),To=Fn(ct,Ui),ao=Object.assign(Object.assign({},fa),To.overlayStyle),Ga=To.arrowStyle;return qi(m.createElement("div",{className:k()(Na,ct,`${ct}-pure`,`${ct}-placement-${qr}`,Fr,To.className),style:Ga},m.createElement(We,Object.assign({},Kt,{className:Na,prefixCls:ct,overlayInnerStyle:ao}),An)))}var Br=I(48012),bn=I(67164),gr=I(16397),pn=I(2790),Sn=I(57),Dn=I(10274);const ui=(Kt,hr)=>new Dn.C(Kt).setAlpha(hr).toRgbString(),di=(Kt,hr)=>new Dn.C(Kt).lighten(hr).toHexString(),ca=Kt=>{const hr=(0,gr.R_)(Kt,{theme:"dark"});return{1:hr[0],2:hr[1],3:hr[2],4:hr[3],5:hr[6],6:hr[5],7:hr[4],8:hr[6],9:hr[5],10:hr[4]}},Ni=(Kt,hr)=>{const Fr=Kt||"#000",qr=hr||"#fff";return{colorBgBase:Fr,colorTextBase:qr,colorText:ui(qr,.85),colorTextSecondary:ui(qr,.65),colorTextTertiary:ui(qr,.45),colorTextQuaternary:ui(qr,.25),colorFill:ui(qr,.18),colorFillSecondary:ui(qr,.12),colorFillTertiary:ui(qr,.08),colorFillQuaternary:ui(qr,.04),colorBgElevated:di(Fr,12),colorBgContainer:di(Fr,8),colorBgLayout:di(Fr,0),colorBgSpotlight:di(Fr,26),colorBorder:di(Fr,26),colorBorderSecondary:di(Fr,19)}};var Ba=(Kt,hr)=>{const Fr=Object.keys(pn.M).map(An=>{const Ui=(0,gr.R_)(Kt[An],{theme:"dark"});return new Array(10).fill(1).reduce((fa,Wi,ct)=>(fa[`${An}-${ct+1}`]=Ui[ct],fa),{})}).reduce((An,Ui)=>(An=Object.assign(Object.assign({},An),Ui),An),{}),qr=hr!=null?hr:(0,bn.Z)(Kt);return Object.assign(Object.assign(Object.assign({},qr),Fr),(0,Sn.Z)(Kt,{generateColorPalettes:ca,generateNeutralColorPalettes:Ni}))},Ia=I(372);function an(Kt){const{sizeUnit:hr,sizeStep:Fr}=Kt,qr=Fr-2;return{sizeXXL:hr*(qr+10),sizeXL:hr*(qr+6),sizeLG:hr*(qr+2),sizeMD:hr*(qr+2),sizeMS:hr*(qr+1),size:hr*qr,sizeSM:hr*qr,sizeXS:hr*(qr-1),sizeXXS:hr*(qr-1)}}var Ln=I(98378),he=(Kt,hr)=>{const Fr=hr!=null?hr:(0,bn.Z)(Kt),qr=Fr.fontSizeSM,An=Fr.controlHeight-4;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Fr),an(hr!=null?hr:Kt)),(0,Ln.Z)(qr)),{controlHeight:An}),(0,Ia.Z)(Object.assign(Object.assign({},Fr),{controlHeight:An})))};function V(){const[Kt,hr,Fr]=(0,Br.dQ)();return{theme:Kt,token:hr,hashId:Fr}}var Et={defaultConfig:Br.u_,defaultSeed:Br.u_.token,useToken:V,defaultAlgorithm:bn.Z,darkAlgorithm:Ba,compactAlgorithm:he},Bt=function(Kt,hr){var Fr={};for(var qr in Kt)Object.prototype.hasOwnProperty.call(Kt,qr)&&hr.indexOf(qr)<0&&(Fr[qr]=Kt[qr]);if(Kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var An=0,qr=Object.getOwnPropertySymbols(Kt);An<qr.length;An++)hr.indexOf(qr[An])<0&&Object.prototype.propertyIsEnumerable.call(Kt,qr[An])&&(Fr[qr[An]]=Kt[qr[An]]);return Fr};const{useToken:Le}=Et,St=(Kt,hr)=>{const Fr={},qr=Object.assign({},Kt);return hr.forEach(An=>{Kt&&An in Kt&&(Fr[An]=Kt[An],delete qr[An])}),{picked:Fr,omitted:qr}};function tt(Kt,hr){const Fr=Kt.type;if((Fr.__ANT_BUTTON===!0||Kt.type==="button")&&Kt.props.disabled||Fr.__ANT_SWITCH===!0&&(Kt.props.disabled||Kt.props.loading)||Fr.__ANT_RADIO===!0&&Kt.props.disabled){const{picked:qr,omitted:An}=St(Kt.props.style,["position","left","right","top","bottom","float","display","zIndex"]),Ui=Object.assign(Object.assign({display:"inline-block"},qr),{cursor:"not-allowed",width:Kt.props.block?"100%":void 0}),fa=Object.assign(Object.assign({},An),{pointerEvents:"none"}),Wi=(0,ht.Tm)(Kt,{style:fa,className:null});return m.createElement("span",{style:Ui,className:k()(Kt.props.className,`${hr}-disabled-compatible-wrapper`)},Wi)}return Kt}const At=m.forwardRef((Kt,hr)=>{var Fr,qr;const{prefixCls:An,openClassName:Ui,getTooltipContainer:fa,overlayClassName:Wi,color:ct,overlayInnerStyle:qi,children:Na,afterOpenChange:To,afterVisibleChange:ao,arrow:Ga=!0}=Kt,Ko=!!Ga,{token:ws}=Le(),{getPopupContainer:Fo,getPrefixCls:su,direction:zo}=m.useContext(ae.E_),[ns,ls]=(0,Xe.Z)(!1,{value:(Fr=Kt.open)!==null&&Fr!==void 0?Fr:Kt.visible,defaultValue:(qr=Kt.defaultOpen)!==null&&qr!==void 0?qr:Kt.defaultVisible}),_o=()=>{const{title:Tt,overlay:Mt}=Kt;return!Tt&&!Mt&&Tt!==0},Po=Tt=>{var Mt,$t;ls(_o()?!1:Tt),_o()||((Mt=Kt.onOpenChange)===null||Mt===void 0||Mt.call(Kt,Tt),($t=Kt.onVisibleChange)===null||$t===void 0||$t.call(Kt,Tt))},Ss=()=>{var Tt;const{builtinPlacements:Mt,arrowPointAtCenter:$t=!1,autoAdjustOverflow:fr=!0}=Kt,Tr=(Tt=typeof Ga!="boolean"&&(Ga==null?void 0:Ga.arrowPointAtCenter))!==null&&Tt!==void 0?Tt:$t;return Mt||at({arrowPointAtCenter:Tr,autoAdjustOverflow:fr,arrowWidth:Ko?ws.sizePopupArrow:0,offset:ws.marginXXS})},Wu=(Tt,Mt)=>{const $t=Ss(),fr=Object.keys($t).find(Tr=>{var Sr,sn;return $t[Tr].points[0]===((Sr=Mt.points)===null||Sr===void 0?void 0:Sr[0])&&$t[Tr].points[1]===((sn=Mt.points)===null||sn===void 0?void 0:sn[1])});if(fr){const Tr=Tt.getBoundingClientRect(),Sr={top:"50%",left:"50%"};/top|Bottom/.test(fr)?Sr.top=`${Tr.height-Mt.offset[1]}px`:/Top|bottom/.test(fr)&&(Sr.top=`${-Mt.offset[1]}px`),/left|Right/.test(fr)?Sr.left=`${Tr.width-Mt.offset[0]}px`:/right|Left/.test(fr)&&(Sr.left=`${-Mt.offset[0]}px`),Tt.style.transformOrigin=`${Sr.left} ${Sr.top}`}},$s=()=>{const{title:Tt,overlay:Mt}=Kt;return Tt===0?Tt:Mt||Tt||""},{getPopupContainer:uu,placement:Jo="top",mouseEnterDelay:ms=.1,mouseLeaveDelay:eu=.1,overlayStyle:Bs,rootClassName:fi}=Kt,is=Bt(Kt,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),ku=su("tooltip",An),mt=su(),Gt=Kt["data-popover-inject"];let Cr=ns;!("open"in Kt)&&!("visible"in Kt)&&_o()&&(Cr=!1);const Rr=tt((0,ht.l$)(Na)&&!(0,ht.M2)(Na)?Na:m.createElement("span",null,Na),ku),ji=Rr.props,Pa=!ji.className||typeof ji.className=="string"?k()(ji.className,{[Ui||`${ku}-open`]:!0}):ji.className,[Yt,De]=nt(ku,!Gt),Me=Fn(ku,ct),ce=Object.assign(Object.assign({},qi),Me.overlayStyle),He=Me.arrowStyle,Pe=k()(Wi,{[`${ku}-rtl`]:zo==="rtl"},Me.className,fi,De);return Yt(m.createElement(pt,Object.assign({},is,{showArrow:Ko,placement:Jo,mouseEnterDelay:ms,mouseLeaveDelay:eu,prefixCls:ku,overlayClassName:Pe,overlayStyle:Object.assign(Object.assign({},He),Bs),getTooltipContainer:uu||fa||Fo,ref:hr,builtinPlacements:Ss(),overlay:$s(),visible:Cr,onVisibleChange:Po,afterVisibleChange:To!=null?To:ao,onPopupAlign:Wu,overlayInnerStyle:ce,arrowContent:m.createElement("span",{className:`${ku}-arrow-content`}),motion:{motionName:(0,gt.mL)(mt,"zoom-big-fast",Kt.transitionName),motionDeadline:1e3}}),Cr?(0,ht.Tm)(Rr,{className:Pa}):Rr))});At._InternalPanelDoNotUseOrYouWillBeFired=Qt;var tr=At;const en=Kt=>Kt?typeof Kt=="function"?Kt():Kt:null,Kr=Kt=>{const{componentCls:hr,popoverBg:Fr,popoverColor:qr,width:An,fontWeightStrong:Ui,popoverPadding:fa,boxShadowSecondary:Wi,colorTextHeading:ct,borderRadiusLG:qi,zIndexPopup:Na,marginXS:To,colorBgElevated:ao}=Kt;return[{[hr]:Object.assign(Object.assign({},(0,Ci.Wf)(Kt)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:Na,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text","--antd-arrow-background-color":ao,"&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},[`${hr}-content`]:{position:"relative"},[`${hr}-inner`]:{backgroundColor:Fr,backgroundClip:"padding-box",borderRadius:qi,boxShadow:Wi,padding:fa},[`${hr}-title`]:{minWidth:An,marginBottom:To,color:ct,fontWeight:Ui},[`${hr}-inner-content`]:{color:qr}})},Ai(Kt,{colorBg:"var(--antd-arrow-background-color)"}),{[`${hr}-pure`]:{position:"relative",maxWidth:"none",[`${hr}-content`]:{display:"inline-block"}}}]},Ft=Kt=>{const{componentCls:hr}=Kt;return{[hr]:Oi.map(Fr=>{const qr=Kt[`${Fr}-6`];return{[`&${hr}-${Fr}`]:{"--antd-arrow-background-color":qr,[`${hr}-inner`]:{backgroundColor:qr},[`${hr}-arrow`]:{background:"transparent"}}}})}},rr=Kt=>{const{componentCls:hr,lineWidth:Fr,lineType:qr,colorSplit:An,paddingSM:Ui,controlHeight:fa,fontSize:Wi,lineHeight:ct,padding:qi}=Kt,Na=fa-Math.round(Wi*ct),To=Na/2,ao=Na/2-Fr,Ga=qi;return{[hr]:{[`${hr}-inner`]:{padding:0},[`${hr}-title`]:{margin:0,padding:`${To}px ${Ga}px ${ao}px`,borderBottom:`${Fr}px ${qr} ${An}`},[`${hr}-inner-content`]:{padding:`${Ui}px ${Ga}px`}}}};var ot=(0,ci.Z)("Popover",Kt=>{const{colorBgElevated:hr,colorText:Fr,wireframe:qr}=Kt,An=(0,Ze.TS)(Kt,{popoverBg:hr,popoverColor:Fr,popoverPadding:12});return[Kr(An),Ft(An),qr&&rr(An),Ea(An,"zoom-big")]},Kt=>{let{zIndexPopupBase:hr}=Kt;return{zIndexPopup:hr+30,width:177}}),Li=function(Kt,hr){var Fr={};for(var qr in Kt)Object.prototype.hasOwnProperty.call(Kt,qr)&&hr.indexOf(qr)<0&&(Fr[qr]=Kt[qr]);if(Kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var An=0,qr=Object.getOwnPropertySymbols(Kt);An<qr.length;An++)hr.indexOf(qr[An])<0&&Object.prototype.propertyIsEnumerable.call(Kt,qr[An])&&(Fr[qr[An]]=Kt[qr[An]]);return Fr};const Hr=(Kt,hr,Fr)=>{if(!(!hr&&!Fr))return m.createElement(m.Fragment,null,hr&&m.createElement("div",{className:`${Kt}-title`},en(hr)),m.createElement("div",{className:`${Kt}-inner-content`},en(Fr)))};function _i(Kt){const{hashId:hr,prefixCls:Fr,className:qr,style:An,placement:Ui="top",title:fa,content:Wi,children:ct}=Kt;return m.createElement("div",{className:k()(hr,Fr,`${Fr}-pure`,`${Fr}-placement-${Ui}`,qr),style:An},m.createElement(We,Object.assign({},Kt,{className:hr,prefixCls:Fr}),ct||Hr(Fr,fa,Wi)))}function vi(Kt){const{prefixCls:hr}=Kt,Fr=Li(Kt,["prefixCls"]),{getPrefixCls:qr}=m.useContext(ae.E_),An=qr("popover",hr),[Ui,fa]=ot(An);return Ui(m.createElement(_i,Object.assign({},Fr,{prefixCls:An,hashId:fa})))}var It=function(Kt,hr){var Fr={};for(var qr in Kt)Object.prototype.hasOwnProperty.call(Kt,qr)&&hr.indexOf(qr)<0&&(Fr[qr]=Kt[qr]);if(Kt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var An=0,qr=Object.getOwnPropertySymbols(Kt);An<qr.length;An++)hr.indexOf(qr[An])<0&&Object.prototype.propertyIsEnumerable.call(Kt,qr[An])&&(Fr[qr[An]]=Kt[qr[An]]);return Fr};const Yr=Kt=>{let{title:hr,content:Fr,prefixCls:qr}=Kt;return!hr&&!Fr?null:m.createElement(m.Fragment,null,hr&&m.createElement("div",{className:`${qr}-title`},en(hr)),m.createElement("div",{className:`${qr}-inner-content`},en(Fr)))},Dr=m.forwardRef((Kt,hr)=>{var Fr,qr;const{prefixCls:An,title:Ui,content:fa,overlayClassName:Wi,placement:ct="top",trigger:qi="hover",mouseEnterDelay:Na=.1,mouseLeaveDelay:To=.1,overlayStyle:ao={},arrowPointAtCenter:Ga,arrow:Ko}=Kt,ws=It(Kt,["prefixCls","title","content","overlayClassName","placement","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","arrowPointAtCenter","arrow"]),{getPrefixCls:Fo}=m.useContext(ae.E_),su=Fo("popover",An),[zo,ns]=ot(su),ls=Fo(),_o=k()(Wi,ns),Po=(qr=(Fr=typeof Ko!="boolean"&&(Ko==null?void 0:Ko.arrowPointAtCenter))!==null&&Fr!==void 0?Fr:Ga)!==null&&qr!==void 0?qr:!1,Ss=Ko!=null?Ko:{arrowPointAtCenter:Po};return zo(m.createElement(tr,Object.assign({placement:ct,arrow:Ss,trigger:qi,mouseEnterDelay:Na,mouseLeaveDelay:To,overlayStyle:ao},ws,{prefixCls:su,overlayClassName:_o,ref:hr,overlay:m.createElement(Yr,{prefixCls:su,title:Ui,content:fa}),transitionName:(0,gt.mL)(ls,"zoom-big",ws.transitionName),"data-popover-inject":!0})))});Dr._InternalPanelDoNotUseOrYouWillBeFired=vi;var Jn=Dr},59577:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return vi}});var D=I(94184),k=I.n(D),m=I(87787),ae=I(98423),F=I(67294),K=I(53124),W=I(74342),Y=I(10274),G=I(48012),xe=()=>{const[,It]=(0,G.dQ)(),Yr=new Y.C(It.colorBgBase);let Dr={};return Yr.toHsl().l<.5&&(Dr={opacity:.65}),F.createElement("svg",{style:Dr,width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},F.createElement("g",{fill:"none",fillRule:"evenodd"},F.createElement("g",{transform:"translate(24 31.67)"},F.createElement("ellipse",{fillOpacity:".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),F.createElement("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"}),F.createElement("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"}),F.createElement("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"}),F.createElement("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"})),F.createElement("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"}),F.createElement("g",{transform:"translate(149.65 15.383)",fill:"#FFF"},F.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),F.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))},Ce=()=>{const[,It]=(0,G.dQ)(),{colorFill:Yr,colorFillTertiary:Dr,colorFillQuaternary:Jn,colorBgContainer:Kt}=It,{borderColor:hr,shadowColor:Fr,contentColor:qr}=(0,F.useMemo)(()=>({borderColor:new Y.C(Yr).onBackground(Kt).toHexShortString(),shadowColor:new Y.C(Dr).onBackground(Kt).toHexShortString(),contentColor:new Y.C(Jn).onBackground(Kt).toHexShortString()}),[Yr,Dr,Jn,Kt]);return F.createElement("svg",{width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},F.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},F.createElement("ellipse",{fill:Fr,cx:"32",cy:"33",rx:"32",ry:"7"}),F.createElement("g",{fillRule:"nonzero",stroke:hr},F.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),F.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:qr}))))},We=I(67968),me=I(45503);const Ge=It=>{const{componentCls:Yr,margin:Dr,marginXS:Jn,marginXL:Kt,fontSize:hr,lineHeight:Fr}=It;return{[Yr]:{marginInline:Jn,fontSize:hr,lineHeight:Fr,textAlign:"center",[`${Yr}-image`]:{height:It.emptyImgHeight,marginBottom:Jn,opacity:It.opacityImage,img:{height:"100%"},svg:{height:"100%",margin:"auto"}},[`${Yr}-description`]:{color:It.colorText},[`${Yr}-footer`]:{marginTop:Dr},"&-normal":{marginBlock:Kt,color:It.colorTextDisabled,[`${Yr}-description`]:{color:It.colorTextDisabled},[`${Yr}-image`]:{height:It.emptyImgHeightMD}},"&-small":{marginBlock:Jn,color:It.colorTextDisabled,[`${Yr}-image`]:{height:It.emptyImgHeightSM}}}}};var Ke=(0,We.Z)("Empty",It=>{const{componentCls:Yr,controlHeightLG:Dr}=It,Jn=(0,me.TS)(It,{emptyImgCls:`${Yr}-img`,emptyImgHeight:Dr*2.5,emptyImgHeightMD:Dr,emptyImgHeightSM:Dr*.875});return[Ge(Jn)]}),pt=function(It,Yr){var Dr={};for(var Jn in It)Object.prototype.hasOwnProperty.call(It,Jn)&&Yr.indexOf(Jn)<0&&(Dr[Jn]=It[Jn]);if(It!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Kt=0,Jn=Object.getOwnPropertySymbols(It);Kt<Jn.length;Kt++)Yr.indexOf(Jn[Kt])<0&&Object.prototype.propertyIsEnumerable.call(It,Jn[Kt])&&(Dr[Jn[Kt]]=It[Jn[Kt]]);return Dr};const Xe=F.createElement(xe,null),gt=F.createElement(Ce,null),ie=It=>{var{className:Yr,rootClassName:Dr,prefixCls:Jn,image:Kt=Xe,description:hr,children:Fr,imageStyle:qr}=It,An=pt(It,["className","rootClassName","prefixCls","image","description","children","imageStyle"]);const{getPrefixCls:Ui,direction:fa}=F.useContext(K.E_),Wi=Ui("empty",Jn),[ct,qi]=Ke(Wi);return ct(F.createElement(W.Z,{componentName:"Empty"},Na=>{const To=typeof hr!="undefined"?hr:Na.description,ao=typeof To=="string"?To:"empty";let Ga=null;return typeof Kt=="string"?Ga=F.createElement("img",{alt:ao,src:Kt}):Ga=Kt,F.createElement("div",Object.assign({className:k()(qi,Wi,{[`${Wi}-normal`]:Kt===gt,[`${Wi}-rtl`]:fa==="rtl"},Yr,Dr)},An),F.createElement("div",{className:`${Wi}-image`,style:qr},Ga),To&&F.createElement("div",{className:`${Wi}-description`},To),Fr&&F.createElement("div",{className:`${Wi}-footer`},Fr))}))};ie.PRESENTED_IMAGE_DEFAULT=Xe,ie.PRESENTED_IMAGE_SIMPLE=gt;var ft=ie,Ae=It=>{const{componentName:Yr}=It,{getPrefixCls:Dr}=(0,F.useContext)(K.E_),Jn=Dr("empty");switch(Yr){case"Table":case"List":return F.createElement(ft,{image:ft.PRESENTED_IMAGE_SIMPLE});case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return F.createElement(ft,{image:ft.PRESENTED_IMAGE_SIMPLE,className:`${Jn}-small`});default:return F.createElement(ft,null)}},Re=I(98866),Ye=I(97647),at=I(65223),ht=I(33603);const Se=null;function Qe(It,Yr,Dr){return k()({[`${It}-status-success`]:Yr==="success",[`${It}-status-warning`]:Yr==="warning",[`${It}-status-error`]:Yr==="error",[`${It}-status-validating`]:Yr==="validating",[`${It}-has-feedback`]:Dr})}const oe=(It,Yr)=>Yr||It;var ue=I(1413),be={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"},vt=be,bt=I(93771),Ht=function(Yr,Dr){return F.createElement(bt.Z,(0,ue.Z)((0,ue.Z)({},Yr),{},{ref:Dr,icon:vt}))};Ht.displayName="CheckOutlined";var Er=F.forwardRef(Ht),Vt=I(54990),on=I(61976),hn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},gi=hn,Hn=function(Yr,Dr){return F.createElement(bt.Z,(0,ue.Z)((0,ue.Z)({},Yr),{},{ref:Dr,icon:gi}))};Hn.displayName="DownOutlined";var Dt=F.forwardRef(Hn),Ea=I(55780),Ze=I(45191),ci=function(Yr,Dr){return F.createElement(bt.Z,(0,ue.Z)((0,ue.Z)({},Yr),{},{ref:Dr,icon:Ze.Z}))};ci.displayName="SearchOutlined";var Ci=F.forwardRef(ci);function Oi(It){let{suffixIcon:Yr,clearIcon:Dr,menuItemSelectedIcon:Jn,removeIcon:Kt,loading:hr,multiple:Fr,hasFeedback:qr,prefixCls:An,showArrow:Ui,feedbackIcon:fa}=It;const Wi=Dr!=null?Dr:F.createElement(Vt.Z,null),ct=ao=>F.createElement(F.Fragment,null,Ui!==!1&&ao,qr&&fa);let qi=null;if(Yr!==void 0)qi=ct(Yr);else if(hr)qi=ct(F.createElement(Ea.Z,{spin:!0}));else{const ao=`${An}-suffix`;qi=Ga=>{let{open:Ko,showSearch:ws}=Ga;return ct(Ko&&ws?F.createElement(Ci,{className:ao}):F.createElement(Dt,{className:ao}))}}let Na=null;Jn!==void 0?Na=Jn:Fr?Na=F.createElement(Er,null):Na=null;let To=null;return Kt!==void 0?To=Kt:To=F.createElement(on.Z,null),{clearIcon:Wi,suffixIcon:qi,itemIcon:Na,removeIcon:To}}var ea=I(4173),fn=I(21770),tn=I(32170);function da(It,Yr,Dr){return function(Kt){const{prefixCls:hr,style:Fr}=Kt,qr=F.useRef(null),[An,Ui]=F.useState(0),[fa,Wi]=F.useState(0),[ct,qi]=(0,fn.Z)(!1,{value:Kt.open}),{getPrefixCls:Na}=F.useContext(K.E_),To=Na(Yr||"select",hr);return F.useEffect(()=>{if(qi(!0),typeof ResizeObserver!="undefined"){const ao=new ResizeObserver(Ko=>{const ws=Ko[0].target;Ui(ws.offsetHeight+8),Wi(ws.offsetWidth)}),Ga=setInterval(()=>{var Ko;const ws=Dr?`.${Dr(To)}`:`.${To}-dropdown`,Fo=(Ko=qr.current)===null||Ko===void 0?void 0:Ko.querySelector(ws);Fo&&(clearInterval(Ga),ao.observe(Fo))},10);return()=>{clearInterval(Ga),ao.disconnect()}}},[]),F.createElement(tn.ZP,{theme:{token:{motionDurationFast:"0.01s",motionDurationMid:"0.01s",motionDurationSlow:"0.01s"}}},F.createElement("div",{ref:qr,style:{paddingBottom:An,position:"relative",width:"fit-content",minWidth:fa}},F.createElement(It,Object.assign({},Kt,{style:Object.assign(Object.assign({},Fr),{margin:0}),open:ct,visible:ct,getPopupContainer:()=>qr.current}))))}}var Ii=I(51222),Ai=I(93590);const Pr=new Ii.E4("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),nt=new Ii.E4("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),it=new Ii.E4("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),_t=new Ii.E4("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),we=new Ii.E4("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),er=new Ii.E4("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),$r=new Ii.E4("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),Fn=new Ii.E4("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),Qt={"slide-up":{inKeyframes:Pr,outKeyframes:nt},"slide-down":{inKeyframes:it,outKeyframes:_t},"slide-left":{inKeyframes:we,outKeyframes:er},"slide-right":{inKeyframes:$r,outKeyframes:Fn}},Br=(It,Yr)=>{const{antCls:Dr}=It,Jn=`${Dr}-${Yr}`,{inKeyframes:Kt,outKeyframes:hr}=Qt[Yr];return[(0,Ai.R)(Jn,Kt,hr,It.motionDurationMid),{[`
      ${Jn}-enter,
      ${Jn}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:It.motionEaseOutQuint},[`${Jn}-leave`]:{animationTimingFunction:It.motionEaseInQuint}}]},bn=new Ii.E4("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),gr=new Ii.E4("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),pn=new Ii.E4("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Sn=new Ii.E4("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),Dn=new Ii.E4("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),ui=new Ii.E4("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),di=new Ii.E4("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),ca=new Ii.E4("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),Ni={"move-up":{inKeyframes:di,outKeyframes:ca},"move-down":{inKeyframes:bn,outKeyframes:gr},"move-left":{inKeyframes:pn,outKeyframes:Sn},"move-right":{inKeyframes:Dn,outKeyframes:ui}},Wa=(It,Yr)=>{const{antCls:Dr}=It,Jn=`${Dr}-${Yr}`,{inKeyframes:Kt,outKeyframes:hr}=Ni[Yr];return[(0,Ai.R)(Jn,Kt,hr,It.motionDurationMid),{[`
        ${Jn}-enter,
        ${Jn}-appear
      `]:{opacity:0,animationTimingFunction:It.motionEaseOutCirc},[`${Jn}-leave`]:{animationTimingFunction:It.motionEaseInOutCirc}}]};var Ba=I(14747);const Ia=It=>{const{controlPaddingHorizontal:Yr}=It;return{position:"relative",display:"block",minHeight:It.controlHeight,padding:`${(It.controlHeight-It.fontSize*It.lineHeight)/2}px ${Yr}px`,color:It.colorText,fontWeight:"normal",fontSize:It.fontSize,lineHeight:It.lineHeight,boxSizing:"border-box"}};var Ln=It=>{const{antCls:Yr,componentCls:Dr}=It,Jn=`${Dr}-item`;return[{[`${Dr}-dropdown`]:Object.assign(Object.assign({},(0,Ba.Wf)(It)),{position:"absolute",top:-9999,zIndex:It.zIndexPopup,boxSizing:"border-box",padding:It.paddingXXS,overflow:"hidden",fontSize:It.fontSize,fontVariant:"initial",backgroundColor:It.colorBgElevated,borderRadius:It.borderRadiusLG,outline:"none",boxShadow:It.boxShadowSecondary,[`
            &${Yr}-slide-up-enter${Yr}-slide-up-enter-active${Dr}-dropdown-placement-bottomLeft,
            &${Yr}-slide-up-appear${Yr}-slide-up-appear-active${Dr}-dropdown-placement-bottomLeft
          `]:{animationName:Pr},[`
            &${Yr}-slide-up-enter${Yr}-slide-up-enter-active${Dr}-dropdown-placement-topLeft,
            &${Yr}-slide-up-appear${Yr}-slide-up-appear-active${Dr}-dropdown-placement-topLeft
          `]:{animationName:it},[`&${Yr}-slide-up-leave${Yr}-slide-up-leave-active${Dr}-dropdown-placement-bottomLeft`]:{animationName:nt},[`&${Yr}-slide-up-leave${Yr}-slide-up-leave-active${Dr}-dropdown-placement-topLeft`]:{animationName:_t},"&-hidden":{display:"none"},"&-empty":{color:It.colorTextDisabled},[`${Jn}-empty`]:Object.assign(Object.assign({},Ia(It)),{color:It.colorTextDisabled}),[`${Jn}`]:Object.assign(Object.assign({},Ia(It)),{cursor:"pointer",transition:`background ${It.motionDurationSlow} ease`,borderRadius:It.borderRadiusSM,"&-group":{color:It.colorTextDescription,fontSize:It.fontSizeSM,cursor:"default"},"&-option":{display:"flex","&-content":Object.assign({flex:"auto"},Ba.vS),"&-state":{flex:"none"},[`&-active:not(${Jn}-option-disabled)`]:{backgroundColor:It.controlItemBgHover},[`&-selected:not(${Jn}-option-disabled)`]:{color:It.colorText,fontWeight:It.fontWeightStrong,backgroundColor:It.controlItemBgActive,[`${Jn}-option-state`]:{color:It.colorPrimary}},"&-disabled":{[`&${Jn}-option-selected`]:{backgroundColor:It.colorBgContainerDisabled},color:It.colorTextDisabled,cursor:"not-allowed"},"&-grouped":{paddingInlineStart:It.controlPaddingHorizontal*2}}}),"&-rtl":{direction:"rtl"}})},Br(It,"slide-up"),Br(It,"slide-down"),Wa(It,"move-up"),Wa(It,"move-down")]};const re=2;function he(It){let{controlHeightSM:Yr,controlHeight:Dr,lineWidth:Jn}=It;const Kt=(Dr-Yr)/2-Jn,hr=Math.ceil(Kt/2);return[Kt,hr]}function V(It,Yr){const{componentCls:Dr,iconCls:Jn}=It,Kt=`${Dr}-selection-overflow`,hr=It.controlHeightSM,[Fr]=he(It),qr=Yr?`${Dr}-${Yr}`:"";return{[`${Dr}-multiple${qr}`]:{fontSize:It.fontSize,[Kt]:{position:"relative",display:"flex",flex:"auto",flexWrap:"wrap",maxWidth:"100%","&-item":{flex:"none",alignSelf:"center",maxWidth:"100%",display:"inline-flex"}},[`${Dr}-selector`]:{display:"flex",flexWrap:"wrap",alignItems:"center",padding:`${Fr-re}px ${re*2}px`,borderRadius:It.borderRadius,[`${Dr}-show-search&`]:{cursor:"text"},[`${Dr}-disabled&`]:{background:It.colorBgContainerDisabled,cursor:"not-allowed"},"&:after":{display:"inline-block",width:0,margin:`${re}px 0`,lineHeight:`${hr}px`,content:'"\\a0"'}},[`
        &${Dr}-show-arrow ${Dr}-selector,
        &${Dr}-allow-clear ${Dr}-selector
      `]:{paddingInlineEnd:It.fontSizeIcon+It.controlPaddingHorizontal},[`${Dr}-selection-item`]:{position:"relative",display:"flex",flex:"none",boxSizing:"border-box",maxWidth:"100%",height:hr,marginTop:re,marginBottom:re,lineHeight:`${hr-It.lineWidth*2}px`,background:It.colorFillSecondary,border:`${It.lineWidth}px solid ${It.colorSplit}`,borderRadius:It.borderRadiusSM,cursor:"default",transition:`font-size ${It.motionDurationSlow}, line-height ${It.motionDurationSlow}, height ${It.motionDurationSlow}`,userSelect:"none",marginInlineEnd:re*2,paddingInlineStart:It.paddingXS,paddingInlineEnd:It.paddingXS/2,[`${Dr}-disabled&`]:{color:It.colorTextDisabled,borderColor:It.colorBorder,cursor:"not-allowed"},"&-content":{display:"inline-block",marginInlineEnd:It.paddingXS/2,overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis"},"&-remove":Object.assign(Object.assign({},(0,Ba.Ro)()),{display:"inline-block",color:It.colorIcon,fontWeight:"bold",fontSize:10,lineHeight:"inherit",cursor:"pointer",[`> ${Jn}`]:{verticalAlign:"-0.2em"},"&:hover":{color:It.colorIconHover}})},[`${Kt}-item + ${Kt}-item`]:{[`${Dr}-selection-search`]:{marginInlineStart:0}},[`${Dr}-selection-search`]:{display:"inline-flex",position:"relative",maxWidth:"100%",marginInlineStart:It.inputPaddingHorizontalBase-Fr,[`
          &-input,
          &-mirror
        `]:{height:hr,fontFamily:It.fontFamily,lineHeight:`${hr}px`,transition:`all ${It.motionDurationSlow}`},"&-input":{width:"100%",minWidth:4.1},"&-mirror":{position:"absolute",top:0,insetInlineStart:0,insetInlineEnd:"auto",zIndex:999,whiteSpace:"pre",visibility:"hidden"}},[`${Dr}-selection-placeholder `]:{position:"absolute",top:"50%",insetInlineStart:It.inputPaddingHorizontalBase,insetInlineEnd:It.inputPaddingHorizontalBase,transform:"translateY(-50%)",transition:`all ${It.motionDurationSlow}`}}}}function Et(It){const{componentCls:Yr}=It,Dr=(0,me.TS)(It,{controlHeight:It.controlHeightSM,controlHeightSM:It.controlHeightXS,borderRadius:It.borderRadiusSM,borderRadiusSM:It.borderRadiusXS}),[,Jn]=he(It);return[V(It),V(Dr,"sm"),{[`${Yr}-multiple${Yr}-sm`]:{[`${Yr}-selection-placeholder`]:{insetInline:It.controlPaddingHorizontalSM-It.lineWidth},[`${Yr}-selection-search`]:{marginInlineStart:Jn}}},V((0,me.TS)(It,{fontSize:It.fontSizeLG,controlHeight:It.controlHeightLG,controlHeightSM:It.controlHeight,borderRadius:It.borderRadiusLG,borderRadiusSM:It.borderRadius}),"lg")]}function Bt(It,Yr){const{componentCls:Dr,inputPaddingHorizontalBase:Jn,borderRadius:Kt}=It,hr=It.controlHeight-It.lineWidth*2,Fr=Math.ceil(It.fontSize*1.25),qr=Yr?`${Dr}-${Yr}`:"";return{[`${Dr}-single${qr}`]:{fontSize:It.fontSize,[`${Dr}-selector`]:Object.assign(Object.assign({},(0,Ba.Wf)(It)),{display:"flex",borderRadius:Kt,[`${Dr}-selection-search`]:{position:"absolute",top:0,insetInlineStart:Jn,insetInlineEnd:Jn,bottom:0,"&-input":{width:"100%"}},[`
          ${Dr}-selection-item,
          ${Dr}-selection-placeholder
        `]:{padding:0,lineHeight:`${hr}px`,transition:`all ${It.motionDurationSlow}`,"@supports (-moz-appearance: meterbar)":{lineHeight:`${hr}px`}},[`${Dr}-selection-item`]:{position:"relative",userSelect:"none"},[`${Dr}-selection-placeholder`]:{transition:"none",pointerEvents:"none"},[["&:after",`${Dr}-selection-item:after`,`${Dr}-selection-placeholder:after`].join(",")]:{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'}}),[`
        &${Dr}-show-arrow ${Dr}-selection-item,
        &${Dr}-show-arrow ${Dr}-selection-placeholder
      `]:{paddingInlineEnd:Fr},[`&${Dr}-open ${Dr}-selection-item`]:{color:It.colorTextPlaceholder},[`&:not(${Dr}-customize-input)`]:{[`${Dr}-selector`]:{width:"100%",height:It.controlHeight,padding:`0 ${Jn}px`,[`${Dr}-selection-search-input`]:{height:hr},"&:after":{lineHeight:`${hr}px`}}},[`&${Dr}-customize-input`]:{[`${Dr}-selector`]:{"&:after":{display:"none"},[`${Dr}-selection-search`]:{position:"static",width:"100%"},[`${Dr}-selection-placeholder`]:{position:"absolute",insetInlineStart:0,insetInlineEnd:0,padding:`0 ${Jn}px`,"&:after":{display:"none"}}}}}}}function Le(It){const{componentCls:Yr}=It,Dr=It.controlPaddingHorizontalSM-It.lineWidth;return[Bt(It),Bt((0,me.TS)(It,{controlHeight:It.controlHeightSM,borderRadius:It.borderRadiusSM}),"sm"),{[`${Yr}-single${Yr}-sm`]:{[`&:not(${Yr}-customize-input)`]:{[`${Yr}-selection-search`]:{insetInlineStart:Dr,insetInlineEnd:Dr},[`${Yr}-selector`]:{padding:`0 ${Dr}px`},[`&${Yr}-show-arrow ${Yr}-selection-search`]:{insetInlineEnd:Dr+It.fontSize*1.5},[`
            &${Yr}-show-arrow ${Yr}-selection-item,
            &${Yr}-show-arrow ${Yr}-selection-placeholder
          `]:{paddingInlineEnd:It.fontSize*1.5}}}},Bt((0,me.TS)(It,{controlHeight:It.controlHeightLG,fontSize:It.fontSizeLG,borderRadius:It.borderRadiusLG}),"lg")]}var St=I(80110);const tt=It=>{const{componentCls:Yr}=It;return{position:"relative",backgroundColor:It.colorBgContainer,border:`${It.lineWidth}px ${It.lineType} ${It.colorBorder}`,transition:`all ${It.motionDurationMid} ${It.motionEaseInOut}`,input:{cursor:"pointer"},[`${Yr}-show-search&`]:{cursor:"text",input:{cursor:"auto",color:"inherit"}},[`${Yr}-disabled&`]:{color:It.colorTextDisabled,background:It.colorBgContainerDisabled,cursor:"not-allowed",[`${Yr}-multiple&`]:{background:It.colorBgContainerDisabled},input:{cursor:"not-allowed"}}}},At=function(It,Yr){let Dr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{componentCls:Jn,borderHoverColor:Kt,outlineColor:hr,antCls:Fr}=Yr,qr=Dr?{[`${Jn}-selector`]:{borderColor:Kt}}:{};return{[It]:{[`&:not(${Jn}-disabled):not(${Jn}-customize-input):not(${Fr}-pagination-size-changer)`]:Object.assign(Object.assign({},qr),{[`${Jn}-focused& ${Jn}-selector`]:{borderColor:Kt,boxShadow:`0 0 0 ${Yr.controlOutlineWidth}px ${hr}`,outline:0},[`&:hover ${Jn}-selector`]:{borderColor:Kt}})}}},tr=It=>{const{componentCls:Yr}=It;return{[`${Yr}-selection-search-input`]:{margin:0,padding:0,background:"transparent",border:"none",outline:"none",appearance:"none","&::-webkit-search-cancel-button":{display:"none","-webkit-appearance":"none"}}}},en=It=>{const{componentCls:Yr,inputPaddingHorizontalBase:Dr,iconCls:Jn}=It;return{[Yr]:Object.assign(Object.assign({},(0,Ba.Wf)(It)),{position:"relative",display:"inline-block",cursor:"pointer",[`&:not(${Yr}-customize-input) ${Yr}-selector`]:Object.assign(Object.assign({},tt(It)),tr(It)),[`${Yr}-selection-item`]:Object.assign({flex:1,fontWeight:"normal"},Ba.vS),[`${Yr}-selection-placeholder`]:Object.assign(Object.assign({},Ba.vS),{flex:1,color:It.colorTextPlaceholder,pointerEvents:"none"}),[`${Yr}-arrow`]:Object.assign(Object.assign({},(0,Ba.Ro)()),{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:Dr,height:It.fontSizeIcon,marginTop:-It.fontSizeIcon/2,color:It.colorTextQuaternary,fontSize:It.fontSizeIcon,lineHeight:1,textAlign:"center",pointerEvents:"none",display:"flex",alignItems:"center",[Jn]:{verticalAlign:"top",transition:`transform ${It.motionDurationSlow}`,"> svg":{verticalAlign:"top"},[`&:not(${Yr}-suffix)`]:{pointerEvents:"auto"}},[`${Yr}-disabled &`]:{cursor:"not-allowed"},"> *:not(:last-child)":{marginInlineEnd:8}}),[`${Yr}-clear`]:{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:Dr,zIndex:1,display:"inline-block",width:It.fontSizeIcon,height:It.fontSizeIcon,marginTop:-It.fontSizeIcon/2,color:It.colorTextQuaternary,fontSize:It.fontSizeIcon,fontStyle:"normal",lineHeight:1,textAlign:"center",textTransform:"none",background:It.colorBgContainer,cursor:"pointer",opacity:0,transition:`color ${It.motionDurationMid} ease, opacity ${It.motionDurationSlow} ease`,textRendering:"auto","&:before":{display:"block"},"&:hover":{color:It.colorTextTertiary}},"&:hover":{[`${Yr}-clear`]:{opacity:1}}}),[`${Yr}-has-feedback`]:{[`${Yr}-clear`]:{insetInlineEnd:Dr+It.fontSize+It.paddingXXS}}}},Kr=It=>{const{componentCls:Yr}=It;return[{[Yr]:{[`&-borderless ${Yr}-selector`]:{backgroundColor:"transparent !important",borderColor:"transparent !important",boxShadow:"none !important"},[`&${Yr}-in-form-item`]:{width:"100%"}}},en(It),Le(It),Et(It),Ln(It),{[`${Yr}-rtl`]:{direction:"rtl"}},At(Yr,(0,me.TS)(It,{borderHoverColor:It.colorPrimaryHover,outlineColor:It.controlOutline})),At(`${Yr}-status-error`,(0,me.TS)(It,{borderHoverColor:It.colorErrorHover,outlineColor:It.colorErrorOutline}),!0),At(`${Yr}-status-warning`,(0,me.TS)(It,{borderHoverColor:It.colorWarningHover,outlineColor:It.colorWarningOutline}),!0),(0,St.c)(It,{borderElCls:`${Yr}-selector`,focusElCls:`${Yr}-focused`})]};var Ft=(0,We.Z)("Select",(It,Yr)=>{let{rootPrefixCls:Dr}=Yr;const Jn=(0,me.TS)(It,{rootPrefixCls:Dr,inputPaddingHorizontalBase:It.paddingSM-1});return[Kr(Jn)]},It=>({zIndexPopup:It.zIndexPopupBase+50})),rr=function(It,Yr){var Dr={};for(var Jn in It)Object.prototype.hasOwnProperty.call(It,Jn)&&Yr.indexOf(Jn)<0&&(Dr[Jn]=It[Jn]);if(It!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Kt=0,Jn=Object.getOwnPropertySymbols(It);Kt<Jn.length;Kt++)Yr.indexOf(Jn[Kt])<0&&Object.prototype.propertyIsEnumerable.call(It,Jn[Kt])&&(Dr[Jn[Kt]]=It[Jn[Kt]]);return Dr};const ot="SECRET_COMBOBOX_MODE_DO_NOT_USE",Li=(It,Yr)=>{var{prefixCls:Dr,bordered:Jn=!0,className:Kt,rootClassName:hr,getPopupContainer:Fr,popupClassName:qr,dropdownClassName:An,listHeight:Ui=256,placement:fa,listItemHeight:Wi=24,size:ct,disabled:qi,notFoundContent:Na,status:To,showArrow:ao}=It,Ga=rr(It,["prefixCls","bordered","className","rootClassName","getPopupContainer","popupClassName","dropdownClassName","listHeight","placement","listItemHeight","size","disabled","notFoundContent","status","showArrow"]);const{getPopupContainer:Ko,getPrefixCls:ws,renderEmpty:Fo,direction:su,virtual:zo,dropdownMatchSelectWidth:ns,select:ls}=F.useContext(K.E_),_o=F.useContext(Ye.Z),Po=ws("select",Dr),Ss=ws(),{compactSize:Wu,compactItemClassnames:$s}=(0,ea.ri)(Po,su),[uu,Jo]=Ft(Po),ms=F.useMemo(()=>{const{mode:$t}=Ga;if($t!=="combobox")return $t===ot?"combobox":$t},[Ga.mode]),eu=ms==="multiple"||ms==="tags",Bs=ao!==void 0?ao:Ga.loading||!(eu||ms==="combobox"),{status:fi,hasFeedback:is,isFormItemInput:ku,feedbackIcon:mt}=F.useContext(at.aM),Gt=oe(fi,To);let Cr;Na!==void 0?Cr=Na:ms==="combobox"?Cr=null:Cr=(Fo==null?void 0:Fo("Select"))||F.createElement(Ae,{componentName:"Select"});const{suffixIcon:Rr,itemIcon:ji,removeIcon:Pa,clearIcon:Yt}=Oi(Object.assign(Object.assign({},Ga),{multiple:eu,hasFeedback:is,feedbackIcon:mt,showArrow:Bs,prefixCls:Po})),De=(0,ae.Z)(Ga,["suffixIcon","itemIcon"]),Me=k()(qr||An,{[`${Po}-dropdown-${su}`]:su==="rtl"},hr,Jo),ce=Wu||ct||_o,He=F.useContext(Re.Z),Pe=qi!=null?qi:He,Tt=k()({[`${Po}-lg`]:ce==="large",[`${Po}-sm`]:ce==="small",[`${Po}-rtl`]:su==="rtl",[`${Po}-borderless`]:!Jn,[`${Po}-in-form-item`]:ku},Qe(Po,Gt,is),$s,Kt,hr,Jo),Mt=()=>fa!==void 0?fa:su==="rtl"?"bottomRight":"bottomLeft";return uu(F.createElement(m.ZP,Object.assign({ref:Yr,virtual:zo,dropdownMatchSelectWidth:ns,showSearch:ls==null?void 0:ls.showSearch},De,{transitionName:(0,ht.mL)(Ss,(0,ht.q0)(fa),Ga.transitionName),listHeight:Ui,listItemHeight:Wi,mode:ms,prefixCls:Po,placement:Mt(),direction:su,inputIcon:Rr,menuItemSelectedIcon:ji,removeIcon:Pa,clearIcon:Yt,notFoundContent:Cr,className:Tt,getPopupContainer:Fr||Ko,dropdownClassName:Me,showArrow:is||ao,disabled:Pe})))},Hr=F.forwardRef(Li),_i=da(Hr);Hr.SECRET_COMBOBOX_MODE_DO_NOT_USE=ot,Hr.Option=m.Wx,Hr.OptGroup=m.Xo,Hr._InternalPanelDoNotUseOrYouWillBeFired=_i;var vi=Hr},4173:function(Ne,fe,I){"use strict";I.d(fe,{ri:function(){return W}});var D=I(94184),k=I.n(D),m=I(50344),ae=I(67294),F=function(Fe,Ce){var We={};for(var me in Fe)Object.prototype.hasOwnProperty.call(Fe,me)&&Ce.indexOf(me)<0&&(We[me]=Fe[me]);if(Fe!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ge=0,me=Object.getOwnPropertySymbols(Fe);Ge<me.length;Ge++)Ce.indexOf(me[Ge])<0&&Object.prototype.propertyIsEnumerable.call(Fe,me[Ge])&&(We[me[Ge]]=Fe[me[Ge]]);return We};const K=ae.createContext(null),W=(Fe,Ce)=>{const We=ae.useContext(K),me=ae.useMemo(()=>{if(!We)return"";const{compactDirection:Ge,isFirstItem:Ke,isLastItem:pt}=We,Xe=Ge==="vertical"?"-vertical-":"-";return k()({[`${Fe}-compact${Xe}item`]:!0,[`${Fe}-compact${Xe}first-item`]:Ke,[`${Fe}-compact${Xe}last-item`]:pt,[`${Fe}-compact${Xe}item-rtl`]:Ce==="rtl"})},[Fe,Ce,We]);return{compactSize:We==null?void 0:We.compactSize,compactDirection:We==null?void 0:We.compactDirection,compactItemClassnames:me}},Y=Fe=>{let{children:Ce}=Fe;return React.createElement(K.Provider,{value:null},Ce)},G=Fe=>{var{children:Ce}=Fe,We=F(Fe,["children"]);return React.createElement(K.Provider,{value:We},Ce)},$=Fe=>{const{getPrefixCls:Ce,direction:We}=React.useContext(ConfigContext),{size:me="middle",direction:Ge,block:Ke,prefixCls:pt,className:Xe,rootClassName:gt,children:ie}=Fe,ft=F(Fe,["size","direction","block","prefixCls","className","rootClassName","children"]),ve=Ce("space-compact",pt),[Ae,Re]=useStyle(ve),Ye=classNames(ve,Re,{[`${ve}-rtl`]:We==="rtl",[`${ve}-block`]:Ke,[`${ve}-vertical`]:Ge==="vertical"},Xe,gt),at=React.useContext(K),ht=toArray(ie),Se=React.useMemo(()=>ht.map((Qe,oe)=>{const ue=Qe&&Qe.key||`${ve}-item-${oe}`;return React.createElement(G,{key:ue,compactSize:me,compactDirection:Ge,isFirstItem:oe===0&&(!at||(at==null?void 0:at.isFirstItem)),isLastItem:oe===ht.length-1&&(!at||(at==null?void 0:at.isLastItem))},Qe)}),[me,ht,at]);return ht.length===0?null:Ae(React.createElement("div",Object.assign({className:Ye},ft),Se))};var xe=null},75081:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return Ae}});var D=I(94184),k=I.n(D);function m(Re,Ye,at){var ht=at||{},Se=ht.noTrailing,Qe=Se===void 0?!1:Se,oe=ht.noLeading,ue=oe===void 0?!1:oe,be=ht.debounceMode,vt=be===void 0?void 0:be,bt,Ht=!1,Er=0;function Vt(){bt&&clearTimeout(bt)}function on(gi){var Hn=gi||{},Dt=Hn.upcomingOnly,Ea=Dt===void 0?!1:Dt;Vt(),Ht=!Ea}function hn(){for(var gi=arguments.length,Hn=new Array(gi),Dt=0;Dt<gi;Dt++)Hn[Dt]=arguments[Dt];var Ea=this,Ze=Date.now()-Er;if(Ht)return;function ci(){Er=Date.now(),Ye.apply(Ea,Hn)}function Ci(){bt=void 0}!ue&&vt&&!bt&&ci(),Vt(),vt===void 0&&Ze>Re?ue?(Er=Date.now(),Qe||(bt=setTimeout(vt?Ci:ci,Re))):ci():Qe!==!0&&(bt=setTimeout(vt?Ci:ci,vt===void 0?Re-Ze:Re))}return hn.cancel=on,hn}function ae(Re,Ye,at){var ht=at||{},Se=ht.atBegin,Qe=Se===void 0?!1:Se;return m(Re,Ye,{debounceMode:Qe!==!1})}var F=I(98423),K=I(67294),W=I(53124),Y=I(96159),G=I(51222),$=I(67968),xe=I(45503),Fe=I(14747);const Ce=new G.E4("antSpinMove",{to:{opacity:1}}),We=new G.E4("antRotate",{to:{transform:"rotate(405deg)"}}),me=Re=>({[`${Re.componentCls}`]:Object.assign(Object.assign({},(0,Fe.Wf)(Re)),{position:"absolute",display:"none",color:Re.colorPrimary,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${Re.motionDurationSlow} ${Re.motionEaseInOutCirc}`,"&-spinning":{position:"static",display:"inline-block",opacity:1},"&-nested-loading":{position:"relative",[`> div > ${Re.componentCls}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:Re.contentHeight,[`${Re.componentCls}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:-Re.spinDotSize/2},[`${Re.componentCls}-text`]:{position:"absolute",top:"50%",width:"100%",paddingTop:(Re.spinDotSize-Re.fontSize)/2+2,textShadow:`0 1px 2px ${Re.colorBgContainer}`},[`&${Re.componentCls}-show-text ${Re.componentCls}-dot`]:{marginTop:-(Re.spinDotSize/2)-10},"&-sm":{[`${Re.componentCls}-dot`]:{margin:-Re.spinDotSizeSM/2},[`${Re.componentCls}-text`]:{paddingTop:(Re.spinDotSizeSM-Re.fontSize)/2+2},[`&${Re.componentCls}-show-text ${Re.componentCls}-dot`]:{marginTop:-(Re.spinDotSizeSM/2)-10}},"&-lg":{[`${Re.componentCls}-dot`]:{margin:-(Re.spinDotSizeLG/2)},[`${Re.componentCls}-text`]:{paddingTop:(Re.spinDotSizeLG-Re.fontSize)/2+2},[`&${Re.componentCls}-show-text ${Re.componentCls}-dot`]:{marginTop:-(Re.spinDotSizeLG/2)-10}}},[`${Re.componentCls}-container`]:{position:"relative",transition:`opacity ${Re.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:Re.colorBgContainer,opacity:0,transition:`all ${Re.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${Re.componentCls}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none",["&::after"]:{opacity:.4,pointerEvents:"auto"}}},["&-tip"]:{color:Re.spinDotDefault},[`${Re.componentCls}-dot`]:{position:"relative",display:"inline-block",fontSize:Re.spinDotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:(Re.spinDotSize-Re.marginXXS/2)/2,height:(Re.spinDotSize-Re.marginXXS/2)/2,backgroundColor:Re.colorPrimary,borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:Ce,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:We,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"}},[`&-sm ${Re.componentCls}-dot`]:{fontSize:Re.spinDotSizeSM,i:{width:(Re.spinDotSizeSM-Re.marginXXS/2)/2,height:(Re.spinDotSizeSM-Re.marginXXS/2)/2}},[`&-lg ${Re.componentCls}-dot`]:{fontSize:Re.spinDotSizeLG,i:{width:(Re.spinDotSizeLG-Re.marginXXS)/2,height:(Re.spinDotSizeLG-Re.marginXXS)/2}},[`&${Re.componentCls}-show-text ${Re.componentCls}-text`]:{display:"block"}})});var Ge=(0,$.Z)("Spin",Re=>{const Ye=(0,xe.TS)(Re,{spinDotDefault:Re.colorTextDescription,spinDotSize:Re.controlHeightLG/2,spinDotSizeSM:Re.controlHeightLG*.35,spinDotSizeLG:Re.controlHeight});return[me(Ye)]},{contentHeight:400}),Ke=function(Re,Ye){var at={};for(var ht in Re)Object.prototype.hasOwnProperty.call(Re,ht)&&Ye.indexOf(ht)<0&&(at[ht]=Re[ht]);if(Re!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Se=0,ht=Object.getOwnPropertySymbols(Re);Se<ht.length;Se++)Ye.indexOf(ht[Se])<0&&Object.prototype.propertyIsEnumerable.call(Re,ht[Se])&&(at[ht[Se]]=Re[ht[Se]]);return at};const pt=null;let Xe=null;function gt(Re,Ye){const{indicator:at}=Ye,ht=`${Re}-dot`;return at===null?null:(0,Y.l$)(at)?(0,Y.Tm)(at,{className:k()(at.props.className,ht)}):(0,Y.l$)(Xe)?(0,Y.Tm)(Xe,{className:k()(Xe.props.className,ht)}):K.createElement("span",{className:k()(ht,`${Re}-dot-spin`)},K.createElement("i",{className:`${Re}-dot-item`}),K.createElement("i",{className:`${Re}-dot-item`}),K.createElement("i",{className:`${Re}-dot-item`}),K.createElement("i",{className:`${Re}-dot-item`}))}function ie(Re,Ye){return!!Re&&!!Ye&&!isNaN(Number(Ye))}const ft=Re=>{const{spinPrefixCls:Ye,spinning:at=!0,delay:ht=0,className:Se,rootClassName:Qe,size:oe="default",tip:ue,wrapperClassName:be,style:vt,children:bt,hashId:Ht}=Re,Er=Ke(Re,["spinPrefixCls","spinning","delay","className","rootClassName","size","tip","wrapperClassName","style","children","hashId"]),[Vt,on]=K.useState(()=>at&&!ie(at,ht));K.useEffect(()=>{if(at){const ci=ae(ht,()=>{on(!0)});return ci(),()=>{var Ci;(Ci=ci==null?void 0:ci.cancel)===null||Ci===void 0||Ci.call(ci)}}on(!1)},[ht,at]);const hn=K.useMemo(()=>typeof bt!="undefined",[bt]),{direction:gi}=K.useContext(W.E_),Hn=k()(Ye,{[`${Ye}-sm`]:oe==="small",[`${Ye}-lg`]:oe==="large",[`${Ye}-spinning`]:Vt,[`${Ye}-show-text`]:!!ue,[`${Ye}-rtl`]:gi==="rtl"},Se,Qe,Ht),Dt=k()(`${Ye}-container`,{[`${Ye}-blur`]:Vt}),Ea=(0,F.Z)(Er,["indicator","prefixCls"]),Ze=K.createElement("div",Object.assign({},Ea,{style:vt,className:Hn,"aria-live":"polite","aria-busy":Vt}),gt(Ye,Re),ue?K.createElement("div",{className:`${Ye}-text`},ue):null);return hn?K.createElement("div",Object.assign({},Ea,{className:k()(`${Ye}-nested-loading`,be,Ht)}),Vt&&K.createElement("div",{key:"loading"},Ze),K.createElement("div",{className:Dt,key:"container"},bt)):Ze},ve=Re=>{const{prefixCls:Ye}=Re,{getPrefixCls:at}=K.useContext(W.E_),ht=at("spin",Ye),[Se,Qe]=Ge(ht),oe=Object.assign(Object.assign({},Re),{spinPrefixCls:ht,hashId:Qe});return Se(K.createElement(ft,Object.assign({},oe)))};ve.setDefaultIndicator=Re=>{Xe=Re};var Ae=ve},80110:function(Ne,fe,I){"use strict";I.d(fe,{c:function(){return m}});function D(ae,F,K){const{focusElCls:W,focus:Y,borderElCls:G}=K,$=G?"> *":"",xe=["hover",Y?"focus":null,"active"].filter(Boolean).map(Fe=>`&:${Fe} ${$}`).join(",");return{[`&-item:not(${F}-last-item)`]:{marginInlineEnd:-ae.lineWidth},"&-item":Object.assign(Object.assign({[xe]:{zIndex:2}},W?{[`&${W}`]:{zIndex:2}}:{}),{[`&[disabled] ${$}`]:{zIndex:0}})}}function k(ae,F,K){const{borderElCls:W}=K,Y=W?`> ${W}`:"";return{[`&-item:not(${F}-first-item):not(${F}-last-item) ${Y}`]:{borderRadius:0},[`&-item:not(${F}-last-item)${F}-first-item`]:{[`& ${Y}, &${ae}-sm ${Y}, &${ae}-lg ${Y}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${F}-first-item)${F}-last-item`]:{[`& ${Y}, &${ae}-sm ${Y}, &${ae}-lg ${Y}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function m(ae){let F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:K}=ae,W=`${K}-compact`;return{[W]:Object.assign(Object.assign({},D(ae,W,F)),k(K,W,F))}}},14747:function(Ne,fe,I){"use strict";I.d(fe,{Lx:function(){return F},Qy:function(){return Y},Ro:function(){return m},Wf:function(){return k},du:function(){return K},oN:function(){return W},vS:function(){return D}});const D={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},k=G=>({boxSizing:"border-box",margin:0,padding:0,color:G.colorText,fontSize:G.fontSize,lineHeight:G.lineHeight,listStyle:"none",fontFamily:G.fontFamily}),m=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),ae=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),F=G=>({a:{color:G.colorLink,textDecoration:G.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${G.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:G.colorLinkHover},"&:active":{color:G.colorLinkActive},[`&:active,
  &:hover`]:{textDecoration:G.linkHoverDecoration,outline:0},"&:focus":{textDecoration:G.linkFocusDecoration,outline:0},"&[disabled]":{color:G.colorTextDisabled,cursor:"not-allowed"}}}),K=(G,$)=>{const{fontFamily:xe,fontSize:Fe}=G,Ce=`[class^="${$}"], [class*=" ${$}"]`;return{[Ce]:{fontFamily:xe,fontSize:Fe,boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"},[Ce]:{boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}}}}},W=G=>({outline:`${G.lineWidthBold}px solid ${G.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),Y=G=>({"&:focus-visible":Object.assign({},W(G))})},93590:function(Ne,fe,I){"use strict";I.d(fe,{R:function(){return m}});const D=ae=>({animationDuration:ae,animationFillMode:"both"}),k=ae=>({animationDuration:ae,animationFillMode:"both"}),m=function(ae,F,K,W){const G=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${G}${ae}-enter,
      ${G}${ae}-appear
    `]:Object.assign(Object.assign({},D(W)),{animationPlayState:"paused"}),[`${G}${ae}-leave`]:Object.assign(Object.assign({},k(W)),{animationPlayState:"paused"}),[`
      ${G}${ae}-enter${ae}-enter-active,
      ${G}${ae}-appear${ae}-appear-active
    `]:{animationName:F,animationPlayState:"running"},[`${G}${ae}-leave${ae}-leave-active`]:{animationName:K,animationPlayState:"running",pointerEvents:"none"}}}},48012:function(Ne,fe,I){"use strict";I.d(fe,{Mj:function(){return me},u_:function(){return We},dQ:function(){return Ge}});var D=I(51222),k=I(67294),m="5.2.2",ae=m,F=I(67164),K=I(2790),W=I(10274);function Y(Ke){return Ke>=0&&Ke<=255}function G(Ke,pt){const{r:Xe,g:gt,b:ie,a:ft}=new W.C(Ke).toRgb();if(ft<1)return Ke;const{r:ve,g:Ae,b:Re}=new W.C(pt).toRgb();for(let Ye=.01;Ye<=1;Ye+=.01){const at=Math.round((Xe-ve*(1-Ye))/Ye),ht=Math.round((gt-Ae*(1-Ye))/Ye),Se=Math.round((ie-Re*(1-Ye))/Ye);if(Y(at)&&Y(ht)&&Y(Se))return new W.C({r:at,g:ht,b:Se,a:Math.round(Ye*100)/100}).toRgbString()}return new W.C({r:Xe,g:gt,b:ie,a:1}).toRgbString()}var $=G,xe=function(Ke,pt){var Xe={};for(var gt in Ke)Object.prototype.hasOwnProperty.call(Ke,gt)&&pt.indexOf(gt)<0&&(Xe[gt]=Ke[gt]);if(Ke!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ie=0,gt=Object.getOwnPropertySymbols(Ke);ie<gt.length;ie++)pt.indexOf(gt[ie])<0&&Object.prototype.propertyIsEnumerable.call(Ke,gt[ie])&&(Xe[gt[ie]]=Ke[gt[ie]]);return Xe};function Fe(Ke){const{override:pt}=Ke,Xe=xe(Ke,["override"]),gt=Object.assign({},pt);Object.keys(K.Z).forEach(Se=>{delete gt[Se]});const ie=Object.assign(Object.assign({},Xe),gt),ft=480,ve=576,Ae=768,Re=992,Ye=1200,at=1600;return Object.assign(Object.assign(Object.assign({},ie),{colorLink:ie.colorInfoText,colorLinkHover:ie.colorInfoHover,colorLinkActive:ie.colorInfoActive,colorFillContent:ie.colorFillSecondary,colorFillContentHover:ie.colorFill,colorFillAlter:ie.colorFillQuaternary,colorBgContainerDisabled:ie.colorFillTertiary,colorBorderBg:ie.colorBgContainer,colorSplit:$(ie.colorBorderSecondary,ie.colorBgContainer),colorTextPlaceholder:ie.colorTextQuaternary,colorTextDisabled:ie.colorTextQuaternary,colorTextHeading:ie.colorText,colorTextLabel:ie.colorTextSecondary,colorTextDescription:ie.colorTextTertiary,colorTextLightSolid:ie.colorWhite,colorHighlight:ie.colorError,colorBgTextHover:ie.colorFillSecondary,colorBgTextActive:ie.colorFill,colorIcon:ie.colorTextTertiary,colorIconHover:ie.colorText,colorErrorOutline:$(ie.colorErrorBg,ie.colorBgContainer),colorWarningOutline:$(ie.colorWarningBg,ie.colorBgContainer),fontSizeIcon:ie.fontSizeSM,lineWidth:ie.lineWidth,controlOutlineWidth:ie.lineWidth*2,controlInteractiveSize:ie.controlHeight/2,controlItemBgHover:ie.colorFillTertiary,controlItemBgActive:ie.colorPrimaryBg,controlItemBgActiveHover:ie.colorPrimaryBgHover,controlItemBgActiveDisabled:ie.colorFill,controlTmpOutline:ie.colorFillQuaternary,controlOutline:$(ie.colorPrimaryBg,ie.colorBgContainer),lineType:ie.lineType,borderRadius:ie.borderRadius,borderRadiusXS:ie.borderRadiusXS,borderRadiusSM:ie.borderRadiusSM,borderRadiusLG:ie.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:ie.sizeXXS,paddingXS:ie.sizeXS,paddingSM:ie.sizeSM,padding:ie.size,paddingMD:ie.sizeMD,paddingLG:ie.sizeLG,paddingXL:ie.sizeXL,paddingContentHorizontalLG:ie.sizeLG,paddingContentVerticalLG:ie.sizeMS,paddingContentHorizontal:ie.sizeMS,paddingContentVertical:ie.sizeSM,paddingContentHorizontalSM:ie.size,paddingContentVerticalSM:ie.sizeXS,marginXXS:ie.sizeXXS,marginXS:ie.sizeXS,marginSM:ie.sizeSM,margin:ie.size,marginMD:ie.sizeMD,marginLG:ie.sizeLG,marginXL:ie.sizeXL,marginXXL:ie.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:ft,screenXSMin:ft,screenXSMax:ve-1,screenSM:ve,screenSMMin:ve,screenSMMax:Ae-1,screenMD:Ae,screenMDMin:Ae,screenMDMax:Re-1,screenLG:Re,screenLGMin:Re,screenLGMax:Ye-1,screenXL:Ye,screenXLMin:Ye,screenXLMax:at-1,screenXXL:at,screenXXLMin:at,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new W.C("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new W.C("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new W.C("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),gt)}const Ce=(0,D.jG)(F.Z),We={token:K.Z,hashed:!0},me=k.createContext(We);function Ge(){const{token:Ke,hashed:pt,theme:Xe,components:gt}=k.useContext(me),ie=`${ae}-${pt||""}`,ft=Xe||Ce,[ve,Ae]=(0,D.fp)(ft,[K.Z,Ke],{salt:ie,override:Object.assign({override:Ke},gt),formatToken:Fe});return[ft,ve,pt?Ae:""]}},67164:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return me}});var D=I(16397),k=I(372);function m(Ge){const{sizeUnit:Ke,sizeStep:pt}=Ge;return{sizeXXL:Ke*(pt+8),sizeXL:Ke*(pt+4),sizeLG:Ke*(pt+2),sizeMD:Ke*(pt+1),sizeMS:Ke*pt,size:Ke*pt,sizeSM:Ke*(pt-1),sizeXS:Ke*(pt-2),sizeXXS:Ke*(pt-3)}}var ae=I(2790),F=I(57),W=Ge=>{let Ke=Ge,pt=Ge,Xe=Ge,gt=Ge;return Ge<6&&Ge>=5?Ke=Ge+1:Ge<16&&Ge>=6?Ke=Ge+2:Ge>=16&&(Ke=16),Ge<7&&Ge>=5?pt=4:Ge<8&&Ge>=7?pt=5:Ge<14&&Ge>=8?pt=6:Ge<16&&Ge>=14?pt=7:Ge>=16&&(pt=8),Ge<6&&Ge>=2?Xe=1:Ge>=6&&(Xe=2),Ge>4&&Ge<8?gt=4:Ge>=8&&(gt=6),{borderRadius:Ge>16?16:Ge,borderRadiusXS:Xe,borderRadiusSM:pt,borderRadiusLG:Ke,borderRadiusOuter:gt}};function Y(Ge){const{motionUnit:Ke,motionBase:pt,borderRadius:Xe,lineWidth:gt}=Ge;return Object.assign({motionDurationFast:`${(pt+Ke).toFixed(1)}s`,motionDurationMid:`${(pt+Ke*2).toFixed(1)}s`,motionDurationSlow:`${(pt+Ke*3).toFixed(1)}s`,lineWidthBold:gt+1},W(Xe))}var G=I(10274);const $=(Ge,Ke)=>new G.C(Ge).setAlpha(Ke).toRgbString(),xe=(Ge,Ke)=>new G.C(Ge).darken(Ke).toHexString(),Fe=Ge=>{const Ke=(0,D.R_)(Ge);return{1:Ke[0],2:Ke[1],3:Ke[2],4:Ke[3],5:Ke[4],6:Ke[5],7:Ke[6],8:Ke[4],9:Ke[5],10:Ke[6]}},Ce=(Ge,Ke)=>{const pt=Ge||"#fff",Xe=Ke||"#000";return{colorBgBase:pt,colorTextBase:Xe,colorText:$(Xe,.88),colorTextSecondary:$(Xe,.65),colorTextTertiary:$(Xe,.45),colorTextQuaternary:$(Xe,.25),colorFill:$(Xe,.15),colorFillSecondary:$(Xe,.06),colorFillTertiary:$(Xe,.04),colorFillQuaternary:$(Xe,.02),colorBgLayout:xe(pt,4),colorBgContainer:xe(pt,0),colorBgElevated:xe(pt,0),colorBgSpotlight:$(Xe,.85),colorBorder:xe(pt,15),colorBorderSecondary:xe(pt,6)}};var We=I(98378);function me(Ge){const Ke=Object.keys(ae.M).map(pt=>{const Xe=(0,D.R_)(Ge[pt]);return new Array(10).fill(1).reduce((gt,ie,ft)=>(gt[`${pt}-${ft+1}`]=Xe[ft],gt),{})}).reduce((pt,Xe)=>(pt=Object.assign(Object.assign({},pt),Xe),pt),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ge),Ke),(0,F.Z)(Ge,{generateColorPalettes:Fe,generateNeutralColorPalettes:Ce})),(0,We.Z)(Ge.fontSize)),m(Ge)),(0,k.Z)(Ge)),Y(Ge))}},2790:function(Ne,fe,I){"use strict";I.d(fe,{M:function(){return D}});const D={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},k=Object.assign(Object.assign({},D),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1});fe.Z=k},57:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return k}});var D=I(10274);function k(m,ae){let{generateColorPalettes:F,generateNeutralColorPalettes:K}=ae;const{colorSuccess:W,colorWarning:Y,colorError:G,colorInfo:$,colorPrimary:xe,colorBgBase:Fe,colorTextBase:Ce}=m,We=F(xe),me=F(W),Ge=F(Y),Ke=F(G),pt=F($),Xe=K(Fe,Ce);return Object.assign(Object.assign({},Xe),{colorPrimaryBg:We[1],colorPrimaryBgHover:We[2],colorPrimaryBorder:We[3],colorPrimaryBorderHover:We[4],colorPrimaryHover:We[5],colorPrimary:We[6],colorPrimaryActive:We[7],colorPrimaryTextHover:We[8],colorPrimaryText:We[9],colorPrimaryTextActive:We[10],colorSuccessBg:me[1],colorSuccessBgHover:me[2],colorSuccessBorder:me[3],colorSuccessBorderHover:me[4],colorSuccessHover:me[4],colorSuccess:me[6],colorSuccessActive:me[7],colorSuccessTextHover:me[8],colorSuccessText:me[9],colorSuccessTextActive:me[10],colorErrorBg:Ke[1],colorErrorBgHover:Ke[2],colorErrorBorder:Ke[3],colorErrorBorderHover:Ke[4],colorErrorHover:Ke[5],colorError:Ke[6],colorErrorActive:Ke[7],colorErrorTextHover:Ke[8],colorErrorText:Ke[9],colorErrorTextActive:Ke[10],colorWarningBg:Ge[1],colorWarningBgHover:Ge[2],colorWarningBorder:Ge[3],colorWarningBorderHover:Ge[4],colorWarningHover:Ge[4],colorWarning:Ge[6],colorWarningActive:Ge[7],colorWarningTextHover:Ge[8],colorWarningText:Ge[9],colorWarningTextActive:Ge[10],colorInfoBg:pt[1],colorInfoBgHover:pt[2],colorInfoBorder:pt[3],colorInfoBorderHover:pt[4],colorInfoHover:pt[4],colorInfo:pt[6],colorInfoActive:pt[7],colorInfoTextHover:pt[8],colorInfoText:pt[9],colorInfoTextActive:pt[10],colorBgMask:new D.C("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}},372:function(Ne,fe){"use strict";const I=D=>{const{controlHeight:k}=D;return{controlHeightSM:k*.75,controlHeightXS:k*.5,controlHeightLG:k*1.25}};fe.Z=I},98378:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return m}});function D(ae){const F=new Array(10).fill(null).map((K,W)=>{const Y=W-1,G=ae*Math.pow(2.71828,Y/5),$=W>1?Math.floor(G):Math.ceil(G);return Math.floor($/2)*2});return F[1]=ae,F.map(K=>{const W=K+8;return{size:K,lineHeight:W/K}})}var m=ae=>{const F=D(ae),K=F.map(Y=>Y.size),W=F.map(Y=>Y.lineHeight);return{fontSizeSM:K[0],fontSize:K[1],fontSizeLG:K[2],fontSizeXL:K[3],fontSizeHeading1:K[6],fontSizeHeading2:K[5],fontSizeHeading3:K[4],fontSizeHeading4:K[3],fontSizeHeading5:K[2],lineHeight:W[1],lineHeightLG:W[2],lineHeightSM:W[0],lineHeightHeading1:W[6],lineHeightHeading2:W[5],lineHeightHeading3:W[4],lineHeightHeading4:W[3],lineHeightHeading5:W[2]}}},67968:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return W}});var D=I(51222),k=I(67294),m=I(14747),ae=I(53124),F=I(48012),K=I(45503);function W(Y,G,$){return xe=>{const[Fe,Ce,We]=(0,F.dQ)(),{getPrefixCls:me,iconPrefixCls:Ge}=(0,k.useContext)(ae.E_),Ke=me();return(0,D.xy)({theme:Fe,token:Ce,hashId:We,path:["Shared",Ke]},()=>[{"&":(0,m.Lx)(Ce)}]),[(0,D.xy)({theme:Fe,token:Ce,hashId:We,path:[Y,xe,Ge]},()=>{const{token:pt,flush:Xe}=(0,K.ZP)(Ce),gt=typeof $=="function"?$(pt):$,ie=Object.assign(Object.assign({},gt),Ce[Y]),ft=`.${xe}`,ve=(0,K.TS)(pt,{componentCls:ft,prefixCls:xe,iconCls:`.${Ge}`,antCls:`.${Ke}`},ie),Ae=G(ve,{hashId:We,prefixCls:xe,rootPrefixCls:Ke,iconPrefixCls:Ge,overrideComponentToken:Ce[Y]});return Xe(Y,ie),[(0,m.du)(Ce,xe),Ae]}),We]}}},45503:function(Ne,fe,I){"use strict";I.d(fe,{TS:function(){return m},ZP:function(){return W}});const D=typeof CSSINJS_STATISTIC!="undefined";let k=!0;function m(){for(var Y=arguments.length,G=new Array(Y),$=0;$<Y;$++)G[$]=arguments[$];if(!D)return Object.assign.apply(Object,[{}].concat(G));k=!1;const xe={};return G.forEach(Fe=>{Object.keys(Fe).forEach(We=>{Object.defineProperty(xe,We,{configurable:!0,enumerable:!0,get:()=>Fe[We]})})}),k=!0,xe}const ae={},F={};function K(){}function W(Y){let G,$=Y,xe=K;return D&&(G=new Set,$=new Proxy(Y,{get(Fe,Ce){return k&&G.add(Ce),Fe[Ce]}}),xe=(Fe,Ce)=>{ae[Fe]={global:Array.from(G),component:Ce}}),{token:$,keys:G,flush:xe}}},93771:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return ue}});var D=I(1413),k=I(97685),m=I(4942),ae=I(91),F=I(67294),K=I(94184),W=I.n(K),Y=I(54775),G=I(71002),$=I(16397),xe=I(80334),Fe=I(44958);function Ce(be,vt){(0,xe.ZP)(be,"[@ant-design/icons] ".concat(vt))}function We(be){return(0,G.Z)(be)==="object"&&typeof be.name=="string"&&typeof be.theme=="string"&&((0,G.Z)(be.icon)==="object"||typeof be.icon=="function")}function me(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(be).reduce(function(vt,bt){var Ht=be[bt];switch(bt){case"class":vt.className=Ht,delete vt.class;break;default:vt[bt]=Ht}return vt},{})}function Ge(be,vt,bt){return bt?F.createElement(be.tag,(0,D.Z)((0,D.Z)({key:vt},me(be.attrs)),bt),(be.children||[]).map(function(Ht,Er){return Ge(Ht,"".concat(vt,"-").concat(be.tag,"-").concat(Er))})):F.createElement(be.tag,(0,D.Z)({key:vt},me(be.attrs)),(be.children||[]).map(function(Ht,Er){return Ge(Ht,"".concat(vt,"-").concat(be.tag,"-").concat(Er))}))}function Ke(be){return(0,$.R_)(be)[0]}function pt(be){return be?Array.isArray(be)?be:[be]:[]}var Xe={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"},gt=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,ie=function(){var vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gt,bt=(0,F.useContext)(Y.Z),Ht=bt.csp,Er=bt.prefixCls,Vt=vt;Er&&(Vt=Vt.replace(/anticon/g,Er)),(0,F.useEffect)(function(){(0,Fe.hq)(Vt,"@ant-design-icons",{prepend:!0,csp:Ht})},[])},ft=["icon","className","onClick","style","primaryColor","secondaryColor"],ve={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function Ae(be){var vt=be.primaryColor,bt=be.secondaryColor;ve.primaryColor=vt,ve.secondaryColor=bt||Ke(vt),ve.calculated=!!bt}function Re(){return(0,D.Z)({},ve)}var Ye=function(vt){var bt=vt.icon,Ht=vt.className,Er=vt.onClick,Vt=vt.style,on=vt.primaryColor,hn=vt.secondaryColor,gi=(0,ae.Z)(vt,ft),Hn=ve;if(on&&(Hn={primaryColor:on,secondaryColor:hn||Ke(on)}),ie(),Ce(We(bt),"icon should be icon definiton, but got ".concat(bt)),!We(bt))return null;var Dt=bt;return Dt&&typeof Dt.icon=="function"&&(Dt=(0,D.Z)((0,D.Z)({},Dt),{},{icon:Dt.icon(Hn.primaryColor,Hn.secondaryColor)})),Ge(Dt.icon,"svg-".concat(Dt.name),(0,D.Z)({className:Ht,onClick:Er,style:Vt,"data-icon":Dt.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},gi))};Ye.displayName="IconReact",Ye.getTwoToneColors=Re,Ye.setTwoToneColors=Ae;var at=Ye;function ht(be){var vt=pt(be),bt=(0,k.Z)(vt,2),Ht=bt[0],Er=bt[1];return at.setTwoToneColors({primaryColor:Ht,secondaryColor:Er})}function Se(){var be=at.getTwoToneColors();return be.calculated?[be.primaryColor,be.secondaryColor]:be.primaryColor}var Qe=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];ht("#1890ff");var oe=F.forwardRef(function(be,vt){var bt,Ht=be.className,Er=be.icon,Vt=be.spin,on=be.rotate,hn=be.tabIndex,gi=be.onClick,Hn=be.twoToneColor,Dt=(0,ae.Z)(be,Qe),Ea=F.useContext(Y.Z),Ze=Ea.prefixCls,ci=Ze===void 0?"anticon":Ze,Ci=Ea.rootClassName,Oi=W()(Ci,ci,(bt={},(0,m.Z)(bt,"".concat(ci,"-").concat(Er.name),!!Er.name),(0,m.Z)(bt,"".concat(ci,"-spin"),!!Vt||Er.name==="loading"),bt),Ht),ea=hn;ea===void 0&&gi&&(ea=-1);var fn=on?{msTransform:"rotate(".concat(on,"deg)"),transform:"rotate(".concat(on,"deg)")}:void 0,tn=pt(Hn),da=(0,k.Z)(tn,2),Ii=da[0],Ai=da[1];return F.createElement("span",(0,D.Z)((0,D.Z)({role:"img","aria-label":Er.name},Dt),{},{ref:vt,tabIndex:ea,onClick:gi,className:Oi}),F.createElement(at,{icon:Er,primaryColor:Ii,secondaryColor:Ai,style:fn}))});oe.displayName="AntdIcon",oe.getTwoToneColor=Se,oe.setTwoToneColor=ht;var ue=oe},54775:function(Ne,fe,I){"use strict";var D=I(67294),k=(0,D.createContext)({});fe.Z=k},54990:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return W}});var D=I(1413),k=I(67294),m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 01-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"}}]},name:"close-circle",theme:"filled"},ae=m,F=I(93771),K=function(G,$){return k.createElement(F.Z,(0,D.Z)((0,D.Z)({},G),{},{ref:$,icon:ae}))};K.displayName="CloseCircleFilled";var W=k.forwardRef(K)},61976:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return W}});var D=I(1413),k=I(67294),m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"}}]},name:"close",theme:"outlined"},ae=m,F=I(93771),K=function(G,$){return k.createElement(F.Z,(0,D.Z)((0,D.Z)({},G),{},{ref:$,icon:ae}))};K.displayName="CloseOutlined";var W=k.forwardRef(K)},55780:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return W}});var D=I(1413),k=I(67294),m={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},ae=m,F=I(93771),K=function(G,$){return k.createElement(F.Z,(0,D.Z)((0,D.Z)({},G),{},{ref:$,icon:ae}))};K.displayName="LoadingOutlined";var W=k.forwardRef(K)},48168:function(Ne,fe,I){const D=I(8874),k={};for(const F of Object.keys(D))k[D[F]]=F;const m={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};Ne.exports=m;for(const F of Object.keys(m)){if(!("channels"in m[F]))throw new Error("missing channels property: "+F);if(!("labels"in m[F]))throw new Error("missing channel labels property: "+F);if(m[F].labels.length!==m[F].channels)throw new Error("channel and label counts mismatch: "+F);const{channels:K,labels:W}=m[F];delete m[F].channels,delete m[F].labels,Object.defineProperty(m[F],"channels",{value:K}),Object.defineProperty(m[F],"labels",{value:W})}m.rgb.hsl=function(F){const K=F[0]/255,W=F[1]/255,Y=F[2]/255,G=Math.min(K,W,Y),$=Math.max(K,W,Y),xe=$-G;let Fe,Ce;$===G?Fe=0:K===$?Fe=(W-Y)/xe:W===$?Fe=2+(Y-K)/xe:Y===$&&(Fe=4+(K-W)/xe),Fe=Math.min(Fe*60,360),Fe<0&&(Fe+=360);const We=(G+$)/2;return $===G?Ce=0:We<=.5?Ce=xe/($+G):Ce=xe/(2-$-G),[Fe,Ce*100,We*100]},m.rgb.hsv=function(F){let K,W,Y,G,$;const xe=F[0]/255,Fe=F[1]/255,Ce=F[2]/255,We=Math.max(xe,Fe,Ce),me=We-Math.min(xe,Fe,Ce),Ge=function(Ke){return(We-Ke)/6/me+1/2};return me===0?(G=0,$=0):($=me/We,K=Ge(xe),W=Ge(Fe),Y=Ge(Ce),xe===We?G=Y-W:Fe===We?G=1/3+K-Y:Ce===We&&(G=2/3+W-K),G<0?G+=1:G>1&&(G-=1)),[G*360,$*100,We*100]},m.rgb.hwb=function(F){const K=F[0],W=F[1];let Y=F[2];const G=m.rgb.hsl(F)[0],$=1/255*Math.min(K,Math.min(W,Y));return Y=1-1/255*Math.max(K,Math.max(W,Y)),[G,$*100,Y*100]},m.rgb.cmyk=function(F){const K=F[0]/255,W=F[1]/255,Y=F[2]/255,G=Math.min(1-K,1-W,1-Y),$=(1-K-G)/(1-G)||0,xe=(1-W-G)/(1-G)||0,Fe=(1-Y-G)/(1-G)||0;return[$*100,xe*100,Fe*100,G*100]};function ae(F,K){return ip(F[0]-K[0],2)+ip(F[1]-K[1],2)+ip(F[2]-K[2],2)}m.rgb.keyword=function(F){const K=k[F];if(K)return K;let W=1/0,Y;for(const G of Object.keys(D)){const $=D[G],xe=ae(F,$);xe<W&&(W=xe,Y=G)}return Y},m.keyword.rgb=function(F){return D[F]},m.rgb.xyz=function(F){let K=F[0]/255,W=F[1]/255,Y=F[2]/255;K=K>.04045?ip((K+.055)/1.055,2.4):K/12.92,W=W>.04045?ip((W+.055)/1.055,2.4):W/12.92,Y=Y>.04045?ip((Y+.055)/1.055,2.4):Y/12.92;const G=K*.4124+W*.3576+Y*.1805,$=K*.2126+W*.7152+Y*.0722,xe=K*.0193+W*.1192+Y*.9505;return[G*100,$*100,xe*100]},m.rgb.lab=function(F){const K=m.rgb.xyz(F);let W=K[0],Y=K[1],G=K[2];W/=95.047,Y/=100,G/=108.883,W=W>.008856?ip(W,1/3):7.787*W+16/116,Y=Y>.008856?ip(Y,1/3):7.787*Y+16/116,G=G>.008856?ip(G,1/3):7.787*G+16/116;const $=116*Y-16,xe=500*(W-Y),Fe=200*(Y-G);return[$,xe,Fe]},m.hsl.rgb=function(F){const K=F[0]/360,W=F[1]/100,Y=F[2]/100;let G,$,xe;if(W===0)return xe=Y*255,[xe,xe,xe];Y<.5?G=Y*(1+W):G=Y+W-Y*W;const Fe=2*Y-G,Ce=[0,0,0];for(let We=0;We<3;We++)$=K+1/3*-(We-1),$<0&&$++,$>1&&$--,6*$<1?xe=Fe+(G-Fe)*6*$:2*$<1?xe=G:3*$<2?xe=Fe+(G-Fe)*(2/3-$)*6:xe=Fe,Ce[We]=xe*255;return Ce},m.hsl.hsv=function(F){const K=F[0];let W=F[1]/100,Y=F[2]/100,G=W;const $=Math.max(Y,.01);Y*=2,W*=Y<=1?Y:2-Y,G*=$<=1?$:2-$;const xe=(Y+W)/2,Fe=Y===0?2*G/($+G):2*W/(Y+W);return[K,Fe*100,xe*100]},m.hsv.rgb=function(F){const K=F[0]/60,W=F[1]/100;let Y=F[2]/100;const G=Math.floor(K)%6,$=K-Math.floor(K),xe=255*Y*(1-W),Fe=255*Y*(1-W*$),Ce=255*Y*(1-W*(1-$));switch(Y*=255,G){case 0:return[Y,Ce,xe];case 1:return[Fe,Y,xe];case 2:return[xe,Y,Ce];case 3:return[xe,Fe,Y];case 4:return[Ce,xe,Y];case 5:return[Y,xe,Fe]}},m.hsv.hsl=function(F){const K=F[0],W=F[1]/100,Y=F[2]/100,G=Math.max(Y,.01);let $,xe;xe=(2-W)*Y;const Fe=(2-W)*G;return $=W*G,$/=Fe<=1?Fe:2-Fe,$=$||0,xe/=2,[K,$*100,xe*100]},m.hwb.rgb=function(F){const K=F[0]/360;let W=F[1]/100,Y=F[2]/100;const G=W+Y;let $;G>1&&(W/=G,Y/=G);const xe=Math.floor(6*K),Fe=1-Y;$=6*K-xe,xe&1&&($=1-$);const Ce=W+$*(Fe-W);let We,me,Ge;switch(xe){default:case 6:case 0:We=Fe,me=Ce,Ge=W;break;case 1:We=Ce,me=Fe,Ge=W;break;case 2:We=W,me=Fe,Ge=Ce;break;case 3:We=W,me=Ce,Ge=Fe;break;case 4:We=Ce,me=W,Ge=Fe;break;case 5:We=Fe,me=W,Ge=Ce;break}return[We*255,me*255,Ge*255]},m.cmyk.rgb=function(F){const K=F[0]/100,W=F[1]/100,Y=F[2]/100,G=F[3]/100,$=1-Math.min(1,K*(1-G)+G),xe=1-Math.min(1,W*(1-G)+G),Fe=1-Math.min(1,Y*(1-G)+G);return[$*255,xe*255,Fe*255]},m.xyz.rgb=function(F){const K=F[0]/100,W=F[1]/100,Y=F[2]/100;let G,$,xe;return G=K*3.2406+W*-1.5372+Y*-.4986,$=K*-.9689+W*1.8758+Y*.0415,xe=K*.0557+W*-.204+Y*1.057,G=G>.0031308?1.055*ip(G,1/2.4)-.055:G*12.92,$=$>.0031308?1.055*ip($,1/2.4)-.055:$*12.92,xe=xe>.0031308?1.055*ip(xe,1/2.4)-.055:xe*12.92,G=Math.min(Math.max(0,G),1),$=Math.min(Math.max(0,$),1),xe=Math.min(Math.max(0,xe),1),[G*255,$*255,xe*255]},m.xyz.lab=function(F){let K=F[0],W=F[1],Y=F[2];K/=95.047,W/=100,Y/=108.883,K=K>.008856?ip(K,1/3):7.787*K+16/116,W=W>.008856?ip(W,1/3):7.787*W+16/116,Y=Y>.008856?ip(Y,1/3):7.787*Y+16/116;const G=116*W-16,$=500*(K-W),xe=200*(W-Y);return[G,$,xe]},m.lab.xyz=function(F){const K=F[0],W=F[1],Y=F[2];let G,$,xe;$=(K+16)/116,G=W/500+$,xe=$-Y/200;const Fe=ip($,3),Ce=ip(G,3),We=ip(xe,3);return $=Fe>.008856?Fe:($-16/116)/7.787,G=Ce>.008856?Ce:(G-16/116)/7.787,xe=We>.008856?We:(xe-16/116)/7.787,G*=95.047,$*=100,xe*=108.883,[G,$,xe]},m.lab.lch=function(F){const K=F[0],W=F[1],Y=F[2];let G;G=Math.atan2(Y,W)*360/2/Math.PI,G<0&&(G+=360);const xe=Math.sqrt(W*W+Y*Y);return[K,xe,G]},m.lch.lab=function(F){const K=F[0],W=F[1],G=F[2]/360*2*Math.PI,$=W*Math.cos(G),xe=W*Math.sin(G);return[K,$,xe]},m.rgb.ansi16=function(F,K=null){const[W,Y,G]=F;let $=K===null?m.rgb.hsv(F)[2]:K;if($=Math.round($/50),$===0)return 30;let xe=30+(Math.round(G/255)<<2|Math.round(Y/255)<<1|Math.round(W/255));return $===2&&(xe+=60),xe},m.hsv.ansi16=function(F){return m.rgb.ansi16(m.hsv.rgb(F),F[2])},m.rgb.ansi256=function(F){const K=F[0],W=F[1],Y=F[2];return K===W&&W===Y?K<8?16:K>248?231:Math.round((K-8)/247*24)+232:16+36*Math.round(K/255*5)+6*Math.round(W/255*5)+Math.round(Y/255*5)},m.ansi16.rgb=function(F){let K=F%10;if(K===0||K===7)return F>50&&(K+=3.5),K=K/10.5*255,[K,K,K];const W=(~~(F>50)+1)*.5,Y=(K&1)*W*255,G=(K>>1&1)*W*255,$=(K>>2&1)*W*255;return[Y,G,$]},m.ansi256.rgb=function(F){if(F>=232){const $=(F-232)*10+8;return[$,$,$]}F-=16;let K;const W=Math.floor(F/36)/5*255,Y=Math.floor((K=F%36)/6)/5*255,G=K%6/5*255;return[W,Y,G]},m.rgb.hex=function(F){const W=(((Math.round(F[0])&255)<<16)+((Math.round(F[1])&255)<<8)+(Math.round(F[2])&255)).toString(16).toUpperCase();return"000000".substring(W.length)+W},m.hex.rgb=function(F){const K=F.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!K)return[0,0,0];let W=K[0];K[0].length===3&&(W=W.split("").map(Fe=>Fe+Fe).join(""));const Y=parseInt(W,16),G=Y>>16&255,$=Y>>8&255,xe=Y&255;return[G,$,xe]},m.rgb.hcg=function(F){const K=F[0]/255,W=F[1]/255,Y=F[2]/255,G=Math.max(Math.max(K,W),Y),$=Math.min(Math.min(K,W),Y),xe=G-$;let Fe,Ce;return xe<1?Fe=$/(1-xe):Fe=0,xe<=0?Ce=0:G===K?Ce=(W-Y)/xe%6:G===W?Ce=2+(Y-K)/xe:Ce=4+(K-W)/xe,Ce/=6,Ce%=1,[Ce*360,xe*100,Fe*100]},m.hsl.hcg=function(F){const K=F[1]/100,W=F[2]/100,Y=W<.5?2*K*W:2*K*(1-W);let G=0;return Y<1&&(G=(W-.5*Y)/(1-Y)),[F[0],Y*100,G*100]},m.hsv.hcg=function(F){const K=F[1]/100,W=F[2]/100,Y=K*W;let G=0;return Y<1&&(G=(W-Y)/(1-Y)),[F[0],Y*100,G*100]},m.hcg.rgb=function(F){const K=F[0]/360,W=F[1]/100,Y=F[2]/100;if(W===0)return[Y*255,Y*255,Y*255];const G=[0,0,0],$=K%1*6,xe=$%1,Fe=1-xe;let Ce=0;switch(Math.floor($)){case 0:G[0]=1,G[1]=xe,G[2]=0;break;case 1:G[0]=Fe,G[1]=1,G[2]=0;break;case 2:G[0]=0,G[1]=1,G[2]=xe;break;case 3:G[0]=0,G[1]=Fe,G[2]=1;break;case 4:G[0]=xe,G[1]=0,G[2]=1;break;default:G[0]=1,G[1]=0,G[2]=Fe}return Ce=(1-W)*Y,[(W*G[0]+Ce)*255,(W*G[1]+Ce)*255,(W*G[2]+Ce)*255]},m.hcg.hsv=function(F){const K=F[1]/100,W=F[2]/100,Y=K+W*(1-K);let G=0;return Y>0&&(G=K/Y),[F[0],G*100,Y*100]},m.hcg.hsl=function(F){const K=F[1]/100,Y=F[2]/100*(1-K)+.5*K;let G=0;return Y>0&&Y<.5?G=K/(2*Y):Y>=.5&&Y<1&&(G=K/(2*(1-Y))),[F[0],G*100,Y*100]},m.hcg.hwb=function(F){const K=F[1]/100,W=F[2]/100,Y=K+W*(1-K);return[F[0],(Y-K)*100,(1-Y)*100]},m.hwb.hcg=function(F){const K=F[1]/100,Y=1-F[2]/100,G=Y-K;let $=0;return G<1&&($=(Y-G)/(1-G)),[F[0],G*100,$*100]},m.apple.rgb=function(F){return[F[0]/65535*255,F[1]/65535*255,F[2]/65535*255]},m.rgb.apple=function(F){return[F[0]/255*65535,F[1]/255*65535,F[2]/255*65535]},m.gray.rgb=function(F){return[F[0]/100*255,F[0]/100*255,F[0]/100*255]},m.gray.hsl=function(F){return[0,0,F[0]]},m.gray.hsv=m.gray.hsl,m.gray.hwb=function(F){return[0,100,F[0]]},m.gray.cmyk=function(F){return[0,0,0,F[0]]},m.gray.lab=function(F){return[F[0],0,0]},m.gray.hex=function(F){const K=Math.round(F[0]/100*255)&255,Y=((K<<16)+(K<<8)+K).toString(16).toUpperCase();return"000000".substring(Y.length)+Y},m.rgb.gray=function(F){return[(F[0]+F[1]+F[2])/3/255*100]}},12085:function(Ne,fe,I){const D=I(48168),k=I(4111),m={},ae=Object.keys(D);function F(W){const Y=function(...G){const $=G[0];return $==null?$:($.length>1&&(G=$),W(G))};return"conversion"in W&&(Y.conversion=W.conversion),Y}function K(W){const Y=function(...G){const $=G[0];if($==null)return $;$.length>1&&(G=$);const xe=W(G);if(typeof xe=="object")for(let Fe=xe.length,Ce=0;Ce<Fe;Ce++)xe[Ce]=Math.round(xe[Ce]);return xe};return"conversion"in W&&(Y.conversion=W.conversion),Y}ae.forEach(W=>{m[W]={},Object.defineProperty(m[W],"channels",{value:D[W].channels}),Object.defineProperty(m[W],"labels",{value:D[W].labels});const Y=k(W);Object.keys(Y).forEach($=>{const xe=Y[$];m[W][$]=K(xe),m[W][$].raw=F(xe)})}),Ne.exports=m},4111:function(Ne,fe,I){const D=I(48168);function k(){const K={},W=Object.keys(D);for(let Y=W.length,G=0;G<Y;G++)K[W[G]]={distance:-1,parent:null};return K}function m(K){const W=k(),Y=[K];for(W[K].distance=0;Y.length;){const G=Y.pop(),$=Object.keys(D[G]);for(let xe=$.length,Fe=0;Fe<xe;Fe++){const Ce=$[Fe],We=W[Ce];We.distance===-1&&(We.distance=W[G].distance+1,We.parent=G,Y.unshift(Ce))}}return W}function ae(K,W){return function(Y){return W(K(Y))}}function F(K,W){const Y=[W[K].parent,K];let G=D[W[K].parent][K],$=W[K].parent;for(;W[$].parent;)Y.unshift(W[$].parent),G=ae(D[W[$].parent][$],G),$=W[$].parent;return G.conversion=Y,G}Ne.exports=function(K){const W=m(K),Y={},G=Object.keys(W);for(let $=G.length,xe=0;xe<$;xe++){const Fe=G[xe];W[Fe].parent!==null&&(Y[Fe]=F(Fe,W))}return Y}},8874:function(Ne){"use strict";Ne.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function(Ne,fe,I){var D=I(8874),k=I(86851),m=Object.hasOwnProperty,ae=Object.create(null);for(var F in D)m.call(D,F)&&(ae[D[F]]=F);var K=Ne.exports={to:{},get:{}};K.get=function(G){var $=G.substring(0,3).toLowerCase(),xe,Fe;switch($){case"hsl":xe=K.get.hsl(G),Fe="hsl";break;case"hwb":xe=K.get.hwb(G),Fe="hwb";break;default:xe=K.get.rgb(G),Fe="rgb";break}return xe?{model:Fe,value:xe}:null},K.get.rgb=function(G){if(!G)return null;var $=/^#([a-f0-9]{3,4})$/i,xe=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,Fe=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,Ce=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,We=/^(\w+)$/,me=[0,0,0,1],Ge,Ke,pt;if(Ge=G.match(xe)){for(pt=Ge[2],Ge=Ge[1],Ke=0;Ke<3;Ke++){var Xe=Ke*2;me[Ke]=parseInt(Ge.slice(Xe,Xe+2),16)}pt&&(me[3]=parseInt(pt,16)/255)}else if(Ge=G.match($)){for(Ge=Ge[1],pt=Ge[3],Ke=0;Ke<3;Ke++)me[Ke]=parseInt(Ge[Ke]+Ge[Ke],16);pt&&(me[3]=parseInt(pt+pt,16)/255)}else if(Ge=G.match(Fe)){for(Ke=0;Ke<3;Ke++)me[Ke]=parseInt(Ge[Ke+1],0);Ge[4]&&(Ge[5]?me[3]=parseFloat(Ge[4])*.01:me[3]=parseFloat(Ge[4]))}else if(Ge=G.match(Ce)){for(Ke=0;Ke<3;Ke++)me[Ke]=Math.round(parseFloat(Ge[Ke+1])*2.55);Ge[4]&&(Ge[5]?me[3]=parseFloat(Ge[4])*.01:me[3]=parseFloat(Ge[4]))}else return(Ge=G.match(We))?Ge[1]==="transparent"?[0,0,0,0]:m.call(D,Ge[1])?(me=D[Ge[1]],me[3]=1,me):null:null;for(Ke=0;Ke<3;Ke++)me[Ke]=W(me[Ke],0,255);return me[3]=W(me[3],0,1),me},K.get.hsl=function(G){if(!G)return null;var $=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,xe=G.match($);if(xe){var Fe=parseFloat(xe[4]),Ce=(parseFloat(xe[1])%360+360)%360,We=W(parseFloat(xe[2]),0,100),me=W(parseFloat(xe[3]),0,100),Ge=W(isNaN(Fe)?1:Fe,0,1);return[Ce,We,me,Ge]}return null},K.get.hwb=function(G){if(!G)return null;var $=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,xe=G.match($);if(xe){var Fe=parseFloat(xe[4]),Ce=(parseFloat(xe[1])%360+360)%360,We=W(parseFloat(xe[2]),0,100),me=W(parseFloat(xe[3]),0,100),Ge=W(isNaN(Fe)?1:Fe,0,1);return[Ce,We,me,Ge]}return null},K.to.hex=function(){var G=k(arguments);return"#"+Y(G[0])+Y(G[1])+Y(G[2])+(G[3]<1?Y(Math.round(G[3]*255)):"")},K.to.rgb=function(){var G=k(arguments);return G.length<4||G[3]===1?"rgb("+Math.round(G[0])+", "+Math.round(G[1])+", "+Math.round(G[2])+")":"rgba("+Math.round(G[0])+", "+Math.round(G[1])+", "+Math.round(G[2])+", "+G[3]+")"},K.to.rgb.percent=function(){var G=k(arguments),$=Math.round(G[0]/255*100),xe=Math.round(G[1]/255*100),Fe=Math.round(G[2]/255*100);return G.length<4||G[3]===1?"rgb("+$+"%, "+xe+"%, "+Fe+"%)":"rgba("+$+"%, "+xe+"%, "+Fe+"%, "+G[3]+")"},K.to.hsl=function(){var G=k(arguments);return G.length<4||G[3]===1?"hsl("+G[0]+", "+G[1]+"%, "+G[2]+"%)":"hsla("+G[0]+", "+G[1]+"%, "+G[2]+"%, "+G[3]+")"},K.to.hwb=function(){var G=k(arguments),$="";return G.length>=4&&G[3]!==1&&($=", "+G[3]),"hwb("+G[0]+", "+G[1]+"%, "+G[2]+"%"+$+")"},K.to.keyword=function(G){return ae[G.slice(0,3)]};function W(G,$,xe){return Math.min(Math.max($,G),xe)}function Y(G){var $=Math.round(G).toString(16).toUpperCase();return $.length<2?"0"+$:$}},6767:function(Ne,fe,I){const D=I(19818),k=I(12085),m=["keyword","gray","hex"],ae={};for(const Ce of Object.keys(k))ae[[...k[Ce].labels].sort().join("")]=Ce;const F={};function K(Ce,We){if(!(this instanceof K))return new K(Ce,We);if(We&&We in m&&(We=null),We&&!(We in k))throw new Error("Unknown model: "+We);let me,Ge;if(Ce==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(Ce instanceof K)this.model=Ce.model,this.color=[...Ce.color],this.valpha=Ce.valpha;else if(typeof Ce=="string"){const Ke=D.get(Ce);if(Ke===null)throw new Error("Unable to parse color from string: "+Ce);this.model=Ke.model,Ge=k[this.model].channels,this.color=Ke.value.slice(0,Ge),this.valpha=typeof Ke.value[Ge]=="number"?Ke.value[Ge]:1}else if(Ce.length>0){this.model=We||"rgb",Ge=k[this.model].channels;const Ke=Array.prototype.slice.call(Ce,0,Ge);this.color=Fe(Ke,Ge),this.valpha=typeof Ce[Ge]=="number"?Ce[Ge]:1}else if(typeof Ce=="number")this.model="rgb",this.color=[Ce>>16&255,Ce>>8&255,Ce&255],this.valpha=1;else{this.valpha=1;const Ke=Object.keys(Ce);"alpha"in Ce&&(Ke.splice(Ke.indexOf("alpha"),1),this.valpha=typeof Ce.alpha=="number"?Ce.alpha:0);const pt=Ke.sort().join("");if(!(pt in ae))throw new Error("Unable to parse color from object: "+JSON.stringify(Ce));this.model=ae[pt];const{labels:Xe}=k[this.model],gt=[];for(me=0;me<Xe.length;me++)gt.push(Ce[Xe[me]]);this.color=Fe(gt)}if(F[this.model])for(Ge=k[this.model].channels,me=0;me<Ge;me++){const Ke=F[this.model][me];Ke&&(this.color[me]=Ke(this.color[me]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}K.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(Ce){let We=this.model in D.to?this:this.rgb();We=We.round(typeof Ce=="number"?Ce:1);const me=We.valpha===1?We.color:[...We.color,this.valpha];return D.to[We.model](me)},percentString(Ce){const We=this.rgb().round(typeof Ce=="number"?Ce:1),me=We.valpha===1?We.color:[...We.color,this.valpha];return D.to.rgb.percent(me)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const Ce={},{channels:We}=k[this.model],{labels:me}=k[this.model];for(let Ge=0;Ge<We;Ge++)Ce[me[Ge]]=this.color[Ge];return this.valpha!==1&&(Ce.alpha=this.valpha),Ce},unitArray(){const Ce=this.rgb().color;return Ce[0]/=255,Ce[1]/=255,Ce[2]/=255,this.valpha!==1&&Ce.push(this.valpha),Ce},unitObject(){const Ce=this.rgb().object();return Ce.r/=255,Ce.g/=255,Ce.b/=255,this.valpha!==1&&(Ce.alpha=this.valpha),Ce},round(Ce){return Ce=Math.max(Ce||0,0),new K([...this.color.map(Y(Ce)),this.valpha],this.model)},alpha(Ce){return Ce!==void 0?new K([...this.color,Math.max(0,Math.min(1,Ce))],this.model):this.valpha},red:G("rgb",0,$(255)),green:G("rgb",1,$(255)),blue:G("rgb",2,$(255)),hue:G(["hsl","hsv","hsl","hwb","hcg"],0,Ce=>(Ce%360+360)%360),saturationl:G("hsl",1,$(100)),lightness:G("hsl",2,$(100)),saturationv:G("hsv",1,$(100)),value:G("hsv",2,$(100)),chroma:G("hcg",1,$(100)),gray:G("hcg",2,$(100)),white:G("hwb",1,$(100)),wblack:G("hwb",2,$(100)),cyan:G("cmyk",0,$(100)),magenta:G("cmyk",1,$(100)),yellow:G("cmyk",2,$(100)),black:G("cmyk",3,$(100)),x:G("xyz",0,$(95.047)),y:G("xyz",1,$(100)),z:G("xyz",2,$(108.833)),l:G("lab",0,$(100)),a:G("lab",1),b:G("lab",2),keyword(Ce){return Ce!==void 0?new K(Ce):k[this.model].keyword(this.color)},hex(Ce){return Ce!==void 0?new K(Ce):D.to.hex(this.rgb().round().color)},hexa(Ce){if(Ce!==void 0)return new K(Ce);const We=this.rgb().round().color;let me=Math.round(this.valpha*255).toString(16).toUpperCase();return me.length===1&&(me="0"+me),D.to.hex(We)+me},rgbNumber(){const Ce=this.rgb().color;return(Ce[0]&255)<<16|(Ce[1]&255)<<8|Ce[2]&255},luminosity(){const Ce=this.rgb().color,We=[];for(const[me,Ge]of Ce.entries()){const Ke=Ge/255;We[me]=Ke<=.04045?Ke/12.92:ip((Ke+.055)/1.055,2.4)}return .2126*We[0]+.7152*We[1]+.0722*We[2]},contrast(Ce){const We=this.luminosity(),me=Ce.luminosity();return We>me?(We+.05)/(me+.05):(me+.05)/(We+.05)},level(Ce){const We=this.contrast(Ce);return We>=7?"AAA":We>=4.5?"AA":""},isDark(){const Ce=this.rgb().color;return(Ce[0]*2126+Ce[1]*7152+Ce[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const Ce=this.rgb();for(let We=0;We<3;We++)Ce.color[We]=255-Ce.color[We];return Ce},lighten(Ce){const We=this.hsl();return We.color[2]+=We.color[2]*Ce,We},darken(Ce){const We=this.hsl();return We.color[2]-=We.color[2]*Ce,We},saturate(Ce){const We=this.hsl();return We.color[1]+=We.color[1]*Ce,We},desaturate(Ce){const We=this.hsl();return We.color[1]-=We.color[1]*Ce,We},whiten(Ce){const We=this.hwb();return We.color[1]+=We.color[1]*Ce,We},blacken(Ce){const We=this.hwb();return We.color[2]+=We.color[2]*Ce,We},grayscale(){const Ce=this.rgb().color,We=Ce[0]*.3+Ce[1]*.59+Ce[2]*.11;return K.rgb(We,We,We)},fade(Ce){return this.alpha(this.valpha-this.valpha*Ce)},opaquer(Ce){return this.alpha(this.valpha+this.valpha*Ce)},rotate(Ce){const We=this.hsl();let me=We.color[0];return me=(me+Ce)%360,me=me<0?360+me:me,We.color[0]=me,We},mix(Ce,We){if(!Ce||!Ce.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof Ce);const me=Ce.rgb(),Ge=this.rgb(),Ke=We===void 0?.5:We,pt=2*Ke-1,Xe=me.alpha()-Ge.alpha(),gt=((pt*Xe===-1?pt:(pt+Xe)/(1+pt*Xe))+1)/2,ie=1-gt;return K.rgb(gt*me.red()+ie*Ge.red(),gt*me.green()+ie*Ge.green(),gt*me.blue()+ie*Ge.blue(),me.alpha()*Ke+Ge.alpha()*(1-Ke))}};for(const Ce of Object.keys(k)){if(m.includes(Ce))continue;const{channels:We}=k[Ce];K.prototype[Ce]=function(...me){return this.model===Ce?new K(this):me.length>0?new K(me,Ce):new K([...xe(k[this.model][Ce].raw(this.color)),this.valpha],Ce)},K[Ce]=function(...me){let Ge=me[0];return typeof Ge=="number"&&(Ge=Fe(me,We)),new K(Ge,Ce)}}function W(Ce,We){return Number(Ce.toFixed(We))}function Y(Ce){return function(We){return W(We,Ce)}}function G(Ce,We,me){Ce=Array.isArray(Ce)?Ce:[Ce];for(const Ge of Ce)(F[Ge]||(F[Ge]=[]))[We]=me;return Ce=Ce[0],function(Ge){let Ke;return Ge!==void 0?(me&&(Ge=me(Ge)),Ke=this[Ce](),Ke.color[We]=Ge,Ke):(Ke=this[Ce]().color[We],me&&(Ke=me(Ke)),Ke)}}function $(Ce){return function(We){return Math.max(0,Math.min(Ce,We))}}function xe(Ce){return Array.isArray(Ce)?Ce:[Ce]}function Fe(Ce,We){for(let me=0;me<We;me++)typeof Ce[me]!="number"&&(Ce[me]=0);return Ce}Ne.exports=K},44020:function(Ne){"use strict";var fe="%[a-f0-9]{2}",I=new RegExp("("+fe+")|([^%]+?)","gi"),D=new RegExp("("+fe+")+","gi");function k(F,K){try{return[decodeURIComponent(F.join(""))]}catch(G){}if(F.length===1)return F;K=K||1;var W=F.slice(0,K),Y=F.slice(K);return Array.prototype.concat.call([],k(W),k(Y))}function m(F){try{return decodeURIComponent(F)}catch(Y){for(var K=F.match(I)||[],W=1;W<K.length;W++)F=k(K,W).join(""),K=F.match(I)||[];return F}}function ae(F){for(var K={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},W=D.exec(F);W;){try{K[W[0]]=decodeURIComponent(W[0])}catch(Fe){var Y=m(W[0]);Y!==W[0]&&(K[W[0]]=Y)}W=D.exec(F)}K["%C2"]="\uFFFD";for(var G=Object.keys(K),$=0;$<G.length;$++){var xe=G[$];F=F.replace(new RegExp(xe,"g"),K[xe])}return F}Ne.exports=function(F){if(typeof F!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof F+"`");try{return F=F.replace(/\+/g," "),decodeURIComponent(F)}catch(K){return ae(F)}}},9187:function(Ne){"use strict";Ne.exports=fe,Ne.exports.default=fe;function fe(oe,ue,be){be=be||2;var vt=ue&&ue.length,bt=vt?ue[0]*be:oe.length,Ht=I(oe,0,bt,be,!0),Er=[];if(!Ht||Ht.next===Ht.prev)return Er;var Vt,on,hn,gi,Hn,Dt,Ea;if(vt&&(Ht=W(oe,ue,Ht,be)),oe.length>80*be){Vt=hn=oe[0],on=gi=oe[1];for(var Ze=be;Ze<bt;Ze+=be)Hn=oe[Ze],Dt=oe[Ze+1],Hn<Vt&&(Vt=Hn),Dt<on&&(on=Dt),Hn>hn&&(hn=Hn),Dt>gi&&(gi=Dt);Ea=Math.max(hn-Vt,gi-on),Ea=Ea!==0?32767/Ea:0}return k(Ht,Er,be,Vt,on,Ea,0),Er}function I(oe,ue,be,vt,bt){var Ht,Er;if(bt===Qe(oe,ue,be,vt)>0)for(Ht=ue;Ht<be;Ht+=vt)Er=at(Ht,oe[Ht],oe[Ht+1],Er);else for(Ht=be-vt;Ht>=ue;Ht-=vt)Er=at(Ht,oe[Ht],oe[Ht+1],Er);return Er&&Xe(Er,Er.next)&&(ht(Er),Er=Er.next),Er}function D(oe,ue){if(!oe)return oe;ue||(ue=oe);var be=oe,vt;do if(vt=!1,!be.steiner&&(Xe(be,be.next)||pt(be.prev,be,be.next)===0)){if(ht(be),be=ue=be.prev,be===be.next)break;vt=!0}else be=be.next;while(vt||be!==ue);return ue}function k(oe,ue,be,vt,bt,Ht,Er){if(oe){!Er&&Ht&&Fe(oe,vt,bt,Ht);for(var Vt=oe,on,hn;oe.prev!==oe.next;){if(on=oe.prev,hn=oe.next,Ht?ae(oe,vt,bt,Ht):m(oe)){ue.push(on.i/be|0),ue.push(oe.i/be|0),ue.push(hn.i/be|0),ht(oe),oe=hn.next,Vt=hn.next;continue}if(oe=hn,oe===Vt){Er?Er===1?(oe=F(D(oe),ue,be),k(oe,ue,be,vt,bt,Ht,2)):Er===2&&K(oe,ue,be,vt,bt,Ht):k(D(oe),ue,be,vt,bt,Ht,1);break}}}}function m(oe){var ue=oe.prev,be=oe,vt=oe.next;if(pt(ue,be,vt)>=0)return!1;for(var bt=ue.x,Ht=be.x,Er=vt.x,Vt=ue.y,on=be.y,hn=vt.y,gi=bt<Ht?bt<Er?bt:Er:Ht<Er?Ht:Er,Hn=Vt<on?Vt<hn?Vt:hn:on<hn?on:hn,Dt=bt>Ht?bt>Er?bt:Er:Ht>Er?Ht:Er,Ea=Vt>on?Vt>hn?Vt:hn:on>hn?on:hn,Ze=vt.next;Ze!==ue;){if(Ze.x>=gi&&Ze.x<=Dt&&Ze.y>=Hn&&Ze.y<=Ea&&Ge(bt,Vt,Ht,on,Er,hn,Ze.x,Ze.y)&&pt(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.next}return!0}function ae(oe,ue,be,vt){var bt=oe.prev,Ht=oe,Er=oe.next;if(pt(bt,Ht,Er)>=0)return!1;for(var Vt=bt.x,on=Ht.x,hn=Er.x,gi=bt.y,Hn=Ht.y,Dt=Er.y,Ea=Vt<on?Vt<hn?Vt:hn:on<hn?on:hn,Ze=gi<Hn?gi<Dt?gi:Dt:Hn<Dt?Hn:Dt,ci=Vt>on?Vt>hn?Vt:hn:on>hn?on:hn,Ci=gi>Hn?gi>Dt?gi:Dt:Hn>Dt?Hn:Dt,Oi=We(Ea,Ze,ue,be,vt),ea=We(ci,Ci,ue,be,vt),fn=oe.prevZ,tn=oe.nextZ;fn&&fn.z>=Oi&&tn&&tn.z<=ea;){if(fn.x>=Ea&&fn.x<=ci&&fn.y>=Ze&&fn.y<=Ci&&fn!==bt&&fn!==Er&&Ge(Vt,gi,on,Hn,hn,Dt,fn.x,fn.y)&&pt(fn.prev,fn,fn.next)>=0||(fn=fn.prevZ,tn.x>=Ea&&tn.x<=ci&&tn.y>=Ze&&tn.y<=Ci&&tn!==bt&&tn!==Er&&Ge(Vt,gi,on,Hn,hn,Dt,tn.x,tn.y)&&pt(tn.prev,tn,tn.next)>=0))return!1;tn=tn.nextZ}for(;fn&&fn.z>=Oi;){if(fn.x>=Ea&&fn.x<=ci&&fn.y>=Ze&&fn.y<=Ci&&fn!==bt&&fn!==Er&&Ge(Vt,gi,on,Hn,hn,Dt,fn.x,fn.y)&&pt(fn.prev,fn,fn.next)>=0)return!1;fn=fn.prevZ}for(;tn&&tn.z<=ea;){if(tn.x>=Ea&&tn.x<=ci&&tn.y>=Ze&&tn.y<=Ci&&tn!==bt&&tn!==Er&&Ge(Vt,gi,on,Hn,hn,Dt,tn.x,tn.y)&&pt(tn.prev,tn,tn.next)>=0)return!1;tn=tn.nextZ}return!0}function F(oe,ue,be){var vt=oe;do{var bt=vt.prev,Ht=vt.next.next;!Xe(bt,Ht)&&gt(bt,vt,vt.next,Ht)&&Ae(bt,Ht)&&Ae(Ht,bt)&&(ue.push(bt.i/be|0),ue.push(vt.i/be|0),ue.push(Ht.i/be|0),ht(vt),ht(vt.next),vt=oe=Ht),vt=vt.next}while(vt!==oe);return D(vt)}function K(oe,ue,be,vt,bt,Ht){var Er=oe;do{for(var Vt=Er.next.next;Vt!==Er.prev;){if(Er.i!==Vt.i&&Ke(Er,Vt)){var on=Ye(Er,Vt);Er=D(Er,Er.next),on=D(on,on.next),k(Er,ue,be,vt,bt,Ht,0),k(on,ue,be,vt,bt,Ht,0);return}Vt=Vt.next}Er=Er.next}while(Er!==oe)}function W(oe,ue,be,vt){var bt=[],Ht,Er,Vt,on,hn;for(Ht=0,Er=ue.length;Ht<Er;Ht++)Vt=ue[Ht]*vt,on=Ht<Er-1?ue[Ht+1]*vt:oe.length,hn=I(oe,Vt,on,vt,!1),hn===hn.next&&(hn.steiner=!0),bt.push(me(hn));for(bt.sort(Y),Ht=0;Ht<bt.length;Ht++)be=G(bt[Ht],be);return be}function Y(oe,ue){return oe.x-ue.x}function G(oe,ue){var be=$(oe,ue);if(!be)return ue;var vt=Ye(be,oe);return D(vt,vt.next),D(be,be.next)}function $(oe,ue){var be=ue,vt=oe.x,bt=oe.y,Ht=-1/0,Er;do{if(bt<=be.y&&bt>=be.next.y&&be.next.y!==be.y){var Vt=be.x+(bt-be.y)*(be.next.x-be.x)/(be.next.y-be.y);if(Vt<=vt&&Vt>Ht&&(Ht=Vt,Er=be.x<be.next.x?be:be.next,Vt===vt))return Er}be=be.next}while(be!==ue);if(!Er)return null;var on=Er,hn=Er.x,gi=Er.y,Hn=1/0,Dt;be=Er;do vt>=be.x&&be.x>=hn&&vt!==be.x&&Ge(bt<gi?vt:Ht,bt,hn,gi,bt<gi?Ht:vt,bt,be.x,be.y)&&(Dt=Math.abs(bt-be.y)/(vt-be.x),Ae(be,oe)&&(Dt<Hn||Dt===Hn&&(be.x>Er.x||be.x===Er.x&&xe(Er,be)))&&(Er=be,Hn=Dt)),be=be.next;while(be!==on);return Er}function xe(oe,ue){return pt(oe.prev,oe,ue.prev)<0&&pt(ue.next,oe,oe.next)<0}function Fe(oe,ue,be,vt){var bt=oe;do bt.z===0&&(bt.z=We(bt.x,bt.y,ue,be,vt)),bt.prevZ=bt.prev,bt.nextZ=bt.next,bt=bt.next;while(bt!==oe);bt.prevZ.nextZ=null,bt.prevZ=null,Ce(bt)}function Ce(oe){var ue,be,vt,bt,Ht,Er,Vt,on,hn=1;do{for(be=oe,oe=null,Ht=null,Er=0;be;){for(Er++,vt=be,Vt=0,ue=0;ue<hn&&(Vt++,vt=vt.nextZ,!!vt);ue++);for(on=hn;Vt>0||on>0&&vt;)Vt!==0&&(on===0||!vt||be.z<=vt.z)?(bt=be,be=be.nextZ,Vt--):(bt=vt,vt=vt.nextZ,on--),Ht?Ht.nextZ=bt:oe=bt,bt.prevZ=Ht,Ht=bt;be=vt}Ht.nextZ=null,hn*=2}while(Er>1);return oe}function We(oe,ue,be,vt,bt){return oe=(oe-be)*bt|0,ue=(ue-vt)*bt|0,oe=(oe|oe<<8)&16711935,oe=(oe|oe<<4)&252645135,oe=(oe|oe<<2)&858993459,oe=(oe|oe<<1)&1431655765,ue=(ue|ue<<8)&16711935,ue=(ue|ue<<4)&252645135,ue=(ue|ue<<2)&858993459,ue=(ue|ue<<1)&1431655765,oe|ue<<1}function me(oe){var ue=oe,be=oe;do(ue.x<be.x||ue.x===be.x&&ue.y<be.y)&&(be=ue),ue=ue.next;while(ue!==oe);return be}function Ge(oe,ue,be,vt,bt,Ht,Er,Vt){return(bt-Er)*(ue-Vt)>=(oe-Er)*(Ht-Vt)&&(oe-Er)*(vt-Vt)>=(be-Er)*(ue-Vt)&&(be-Er)*(Ht-Vt)>=(bt-Er)*(vt-Vt)}function Ke(oe,ue){return oe.next.i!==ue.i&&oe.prev.i!==ue.i&&!ve(oe,ue)&&(Ae(oe,ue)&&Ae(ue,oe)&&Re(oe,ue)&&(pt(oe.prev,oe,ue.prev)||pt(oe,ue.prev,ue))||Xe(oe,ue)&&pt(oe.prev,oe,oe.next)>0&&pt(ue.prev,ue,ue.next)>0)}function pt(oe,ue,be){return(ue.y-oe.y)*(be.x-ue.x)-(ue.x-oe.x)*(be.y-ue.y)}function Xe(oe,ue){return oe.x===ue.x&&oe.y===ue.y}function gt(oe,ue,be,vt){var bt=ft(pt(oe,ue,be)),Ht=ft(pt(oe,ue,vt)),Er=ft(pt(be,vt,oe)),Vt=ft(pt(be,vt,ue));return!!(bt!==Ht&&Er!==Vt||bt===0&&ie(oe,be,ue)||Ht===0&&ie(oe,vt,ue)||Er===0&&ie(be,oe,vt)||Vt===0&&ie(be,ue,vt))}function ie(oe,ue,be){return ue.x<=Math.max(oe.x,be.x)&&ue.x>=Math.min(oe.x,be.x)&&ue.y<=Math.max(oe.y,be.y)&&ue.y>=Math.min(oe.y,be.y)}function ft(oe){return oe>0?1:oe<0?-1:0}function ve(oe,ue){var be=oe;do{if(be.i!==oe.i&&be.next.i!==oe.i&&be.i!==ue.i&&be.next.i!==ue.i&&gt(be,be.next,oe,ue))return!0;be=be.next}while(be!==oe);return!1}function Ae(oe,ue){return pt(oe.prev,oe,oe.next)<0?pt(oe,ue,oe.next)>=0&&pt(oe,oe.prev,ue)>=0:pt(oe,ue,oe.prev)<0||pt(oe,oe.next,ue)<0}function Re(oe,ue){var be=oe,vt=!1,bt=(oe.x+ue.x)/2,Ht=(oe.y+ue.y)/2;do be.y>Ht!=be.next.y>Ht&&be.next.y!==be.y&&bt<(be.next.x-be.x)*(Ht-be.y)/(be.next.y-be.y)+be.x&&(vt=!vt),be=be.next;while(be!==oe);return vt}function Ye(oe,ue){var be=new Se(oe.i,oe.x,oe.y),vt=new Se(ue.i,ue.x,ue.y),bt=oe.next,Ht=ue.prev;return oe.next=ue,ue.prev=oe,be.next=bt,bt.prev=be,vt.next=be,be.prev=vt,Ht.next=vt,vt.prev=Ht,vt}function at(oe,ue,be,vt){var bt=new Se(oe,ue,be);return vt?(bt.next=vt.next,bt.prev=vt,vt.next.prev=bt,vt.next=bt):(bt.prev=bt,bt.next=bt),bt}function ht(oe){oe.next.prev=oe.prev,oe.prev.next=oe.next,oe.prevZ&&(oe.prevZ.nextZ=oe.nextZ),oe.nextZ&&(oe.nextZ.prevZ=oe.prevZ)}function Se(oe,ue,be){this.i=oe,this.x=ue,this.y=be,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}fe.deviation=function(oe,ue,be,vt){var bt=ue&&ue.length,Ht=bt?ue[0]*be:oe.length,Er=Math.abs(Qe(oe,0,Ht,be));if(bt)for(var Vt=0,on=ue.length;Vt<on;Vt++){var hn=ue[Vt]*be,gi=Vt<on-1?ue[Vt+1]*be:oe.length;Er-=Math.abs(Qe(oe,hn,gi,be))}var Hn=0;for(Vt=0;Vt<vt.length;Vt+=3){var Dt=vt[Vt]*be,Ea=vt[Vt+1]*be,Ze=vt[Vt+2]*be;Hn+=Math.abs((oe[Dt]-oe[Ze])*(oe[Ea+1]-oe[Dt+1])-(oe[Dt]-oe[Ea])*(oe[Ze+1]-oe[Dt+1]))}return Er===0&&Hn===0?0:Math.abs((Hn-Er)/Er)};function Qe(oe,ue,be,vt){for(var bt=0,Ht=ue,Er=be-vt;Ht<be;Ht+=vt)bt+=(oe[Er]-oe[Ht])*(oe[Ht+1]+oe[Er+1]),Er=Ht;return bt}fe.flatten=function(oe){for(var ue=oe[0][0].length,be={vertices:[],holes:[],dimensions:ue},vt=0,bt=0;bt<oe.length;bt++){for(var Ht=0;Ht<oe[bt].length;Ht++)for(var Er=0;Er<ue;Er++)be.vertices.push(oe[bt][Ht][Er]);bt>0&&(vt+=oe[bt-1].length,be.holes.push(vt))}return be}},67709:function(Ne){function fe(D){var k=D.target||D.srcElement;k.__resizeRAF__&&cancelAnimationFrame(k.__resizeRAF__),k.__resizeRAF__=requestAnimationFrame(function(){var m=k.__resizeTrigger__,ae=m&&m.__resizeListeners__;ae&&ae.forEach(function(F){F.call(m,D)})})}var I=function(k,m){var ae=this,F=ae.document,K,W=F.attachEvent;typeof navigator!="undefined"&&(K=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function Y(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",fe)}if(!k.__resizeListeners__)if(k.__resizeListeners__=[],W)k.__resizeTrigger__=k,k.attachEvent("onresize",fe);else{getComputedStyle(k).position==="static"&&(k.style.position="relative");var G=k.__resizeTrigger__=F.createElement("object");G.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),G.setAttribute("class","resize-sensor"),G.setAttribute("tabindex","-1"),G.setAttribute("title",""),G.__resizeElement__=k,G.onload=Y,G.type="text/html",K&&k.appendChild(G),G.data="about:blank",K||k.appendChild(G)}k.__resizeListeners__.push(m)};Ne.exports=typeof window=="undefined"?I:I.bind(window),Ne.exports.unbind=function(D,k){var m=document.attachEvent,ae=D.__resizeListeners__||[];if(k){var F=ae.indexOf(k);F!==-1&&ae.splice(F,1)}else ae=D.__resizeListeners__=[];if(!ae.length){if(m)D.detachEvent("onresize",fe);else if(D.__resizeTrigger__){var K=D.__resizeTrigger__.contentDocument,W=K&&K.defaultView;W&&(W.removeEventListener("resize",fe),delete W.__resizeTrigger__),D.__resizeTrigger__=!D.removeChild(D.__resizeTrigger__)}delete D.__resizeListeners__}}},26729:function(Ne){"use strict";var fe=Object.prototype.hasOwnProperty,I="~";function D(){}Object.create&&(D.prototype=Object.create(null),new D().__proto__||(I=!1));function k(K,W,Y){this.fn=K,this.context=W,this.once=Y||!1}function m(K,W,Y,G,$){if(typeof Y!="function")throw new TypeError("The listener must be a function");var xe=new k(Y,G||K,$),Fe=I?I+W:W;return K._events[Fe]?K._events[Fe].fn?K._events[Fe]=[K._events[Fe],xe]:K._events[Fe].push(xe):(K._events[Fe]=xe,K._eventsCount++),K}function ae(K,W){--K._eventsCount===0?K._events=new D:delete K._events[W]}function F(){this._events=new D,this._eventsCount=0}F.prototype.eventNames=function(){var W=[],Y,G;if(this._eventsCount===0)return W;for(G in Y=this._events)fe.call(Y,G)&&W.push(I?G.slice(1):G);return Object.getOwnPropertySymbols?W.concat(Object.getOwnPropertySymbols(Y)):W},F.prototype.listeners=function(W){var Y=I?I+W:W,G=this._events[Y];if(!G)return[];if(G.fn)return[G.fn];for(var $=0,xe=G.length,Fe=new Array(xe);$<xe;$++)Fe[$]=G[$].fn;return Fe},F.prototype.listenerCount=function(W){var Y=I?I+W:W,G=this._events[Y];return G?G.fn?1:G.length:0},F.prototype.emit=function(W,Y,G,$,xe,Fe){var Ce=I?I+W:W;if(!this._events[Ce])return!1;var We=this._events[Ce],me=arguments.length,Ge,Ke;if(We.fn){switch(We.once&&this.removeListener(W,We.fn,void 0,!0),me){case 1:return We.fn.call(We.context),!0;case 2:return We.fn.call(We.context,Y),!0;case 3:return We.fn.call(We.context,Y,G),!0;case 4:return We.fn.call(We.context,Y,G,$),!0;case 5:return We.fn.call(We.context,Y,G,$,xe),!0;case 6:return We.fn.call(We.context,Y,G,$,xe,Fe),!0}for(Ke=1,Ge=new Array(me-1);Ke<me;Ke++)Ge[Ke-1]=arguments[Ke];We.fn.apply(We.context,Ge)}else{var pt=We.length,Xe;for(Ke=0;Ke<pt;Ke++)switch(We[Ke].once&&this.removeListener(W,We[Ke].fn,void 0,!0),me){case 1:We[Ke].fn.call(We[Ke].context);break;case 2:We[Ke].fn.call(We[Ke].context,Y);break;case 3:We[Ke].fn.call(We[Ke].context,Y,G);break;case 4:We[Ke].fn.call(We[Ke].context,Y,G,$);break;default:if(!Ge)for(Xe=1,Ge=new Array(me-1);Xe<me;Xe++)Ge[Xe-1]=arguments[Xe];We[Ke].fn.apply(We[Ke].context,Ge)}}return!0},F.prototype.on=function(W,Y,G){return m(this,W,Y,G,!1)},F.prototype.once=function(W,Y,G){return m(this,W,Y,G,!0)},F.prototype.removeListener=function(W,Y,G,$){var xe=I?I+W:W;if(!this._events[xe])return this;if(!Y)return ae(this,xe),this;var Fe=this._events[xe];if(Fe.fn)Fe.fn===Y&&(!$||Fe.once)&&(!G||Fe.context===G)&&ae(this,xe);else{for(var Ce=0,We=[],me=Fe.length;Ce<me;Ce++)(Fe[Ce].fn!==Y||$&&!Fe[Ce].once||G&&Fe[Ce].context!==G)&&We.push(Fe[Ce]);We.length?this._events[xe]=We.length===1?We[0]:We:ae(this,xe)}return this},F.prototype.removeAllListeners=function(W){var Y;return W?(Y=I?I+W:W,this._events[Y]&&ae(this,Y)):(this._events=new D,this._eventsCount=0),this},F.prototype.off=F.prototype.removeListener,F.prototype.addListener=F.prototype.on,F.prefixed=I,F.EventEmitter=F,Ne.exports=F},92806:function(Ne){"use strict";Ne.exports=function(fe,I){for(var D={},k=Object.keys(fe),m=Array.isArray(I),ae=0;ae<k.length;ae++){var F=k[ae],K=fe[F];(m?I.indexOf(F)!==-1:I(F,K,fe))&&(D[F]=K)}return D}},81490:function(Ne){"use strict";Ne.exports=F;var fe,I,D,k,m,ae=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection"];function F(ie){k=2,m=Math.pow(10,6),D=null,fe=[],I=[];var ft=ie.readFields(K,{});return fe=null,ft}function K(ie,ft,ve){ie===1?fe.push(ve.readString()):ie===2?k=ve.readVarint():ie===3?m=Math.pow(10,ve.readVarint()):ie===4?W(ve,ft):ie===5?Y(ve,ft):ie===6&&G(ve,ft)}function W(ie,ft){return ft.type="FeatureCollection",ft.features=[],ie.readMessage($,ft)}function Y(ie,ft){ft.type="Feature";var ve=ie.readMessage(xe,ft);return"geometry"in ve||(ve.geometry=null),ve}function G(ie,ft){return ft.type="Point",ie.readMessage(Fe,ft)}function $(ie,ft,ve){ie===1?ft.features.push(Y(ve,{})):ie===13?I.push(We(ve)):ie===15&&me(ve,ft)}function xe(ie,ft,ve){ie===1?ft.geometry=G(ve,{}):ie===11?ft.id=ve.readString():ie===12?ft.id=ve.readSVarint():ie===13?I.push(We(ve)):ie===14?ft.properties=me(ve,{}):ie===15&&me(ve,ft)}function Fe(ie,ft,ve){ie===1?ft.type=ae[ve.readVarint()]:ie===2?D=ve.readPackedVarint():ie===3?Ce(ft,ve,ft.type):ie===4?(ft.geometries=ft.geometries||[],ft.geometries.push(G(ve,{}))):ie===13?I.push(We(ve)):ie===15&&me(ve,ft)}function Ce(ie,ft,ve){ve==="Point"?ie.coordinates=Ge(ft):ve==="MultiPoint"?ie.coordinates=pt(ft,!0):ve==="LineString"?ie.coordinates=pt(ft):ve==="MultiLineString"?ie.coordinates=Xe(ft):ve==="Polygon"?ie.coordinates=Xe(ft,!0):ve==="MultiPolygon"&&(ie.coordinates=gt(ft))}function We(ie){for(var ft=ie.readVarint()+ie.pos,ve=null;ie.pos<ft;){var Ae=ie.readVarint(),Re=Ae>>3;Re===1?ve=ie.readString():Re===2?ve=ie.readDouble():Re===3?ve=ie.readVarint():Re===4?ve=-ie.readVarint():Re===5?ve=ie.readBoolean():Re===6&&(ve=JSON.parse(ie.readString()))}return ve}function me(ie,ft){for(var ve=ie.readVarint()+ie.pos;ie.pos<ve;)ft[fe[ie.readVarint()]]=I[ie.readVarint()];return I=[],ft}function Ge(ie){for(var ft=ie.readVarint()+ie.pos,ve=[];ie.pos<ft;)ve.push(ie.readSVarint()/m);return ve}function Ke(ie,ft,ve,Ae){var Re=0,Ye=[],at,ht,Se=[];for(ht=0;ht<k;ht++)Se[ht]=0;for(;ve?Re<ve:ie.pos<ft;){for(at=[],ht=0;ht<k;ht++)Se[ht]+=ie.readSVarint(),at[ht]=Se[ht]/m;Ye.push(at),Re++}return Ae&&Ye.push(Ye[0]),Ye}function pt(ie){return Ke(ie,ie.readVarint()+ie.pos)}function Xe(ie,ft){var ve=ie.readVarint()+ie.pos;if(!D)return[Ke(ie,ve,null,ft)];for(var Ae=[],Re=0;Re<D.length;Re++)Ae.push(Ke(ie,ve,D[Re],ft));return D=null,Ae}function gt(ie){var ft=ie.readVarint()+ie.pos;if(!D)return[[Ke(ie,ft,null,!0)]];for(var ve=[],Ae=1,Re=0;Re<D[0];Re++){for(var Ye=[],at=0;at<D[Ae];at++)Ye.push(Ke(ie,ft,D[Ae+1+at],!0));Ae+=D[Ae]+1,ve.push(Ye)}return D=null,ve}},62020:function(Ne){"use strict";Ne.exports=K;var fe,I,D,k,m,ae=1e6,F={Point:0,MultiPoint:1,LineString:2,MultiLineString:3,Polygon:4,MultiPolygon:5,GeometryCollection:6};function K(ve,Ae){fe={},D=[],I=0,k=0,m=1,W(ve),m=Math.min(m,ae);for(var Re=Math.ceil(Math.log(m)/Math.LN10),Ye=0;Ye<D.length;Ye++)Ae.writeStringField(1,D[Ye]);return k!==2&&Ae.writeVarintField(2,k),Re!==6&&Ae.writeVarintField(3,Re),ve.type==="FeatureCollection"?Ae.writeMessage(4,Fe,ve):ve.type==="Feature"?Ae.writeMessage(5,Ce,ve):Ae.writeMessage(6,We,ve),fe=null,Ae.finish()}function W(ve){var Ae,Re;if(ve.type==="FeatureCollection")for(Ae=0;Ae<ve.features.length;Ae++)W(ve.features[Ae]);else if(ve.type==="Feature"){ve.geometry!==null&&W(ve.geometry);for(Re in ve.properties)xe(Re)}else if(ve.type==="Point")$(ve.coordinates);else if(ve.type==="MultiPoint")G(ve.coordinates);else if(ve.type==="GeometryCollection")for(Ae=0;Ae<ve.geometries.length;Ae++)W(ve.geometries[Ae]);else if(ve.type==="LineString")G(ve.coordinates);else if(ve.type==="Polygon"||ve.type==="MultiLineString")Y(ve.coordinates);else if(ve.type==="MultiPolygon")for(Ae=0;Ae<ve.coordinates.length;Ae++)Y(ve.coordinates[Ae]);for(Re in ve)ft(Re,ve.type)||xe(Re)}function Y(ve){for(var Ae=0;Ae<ve.length;Ae++)G(ve[Ae])}function G(ve){for(var Ae=0;Ae<ve.length;Ae++)$(ve[Ae])}function $(ve){k=Math.max(k,ve.length);for(var Ae=0;Ae<ve.length;Ae++)for(;Math.round(ve[Ae]*m)/m!==ve[Ae]&&m<ae;)m*=10}function xe(ve){fe[ve]===void 0&&(D.push(ve),fe[ve]=I++)}function Fe(ve,Ae){for(var Re=0;Re<ve.features.length;Re++)Ae.writeMessage(1,Ce,ve.features[Re]);me(ve,Ae,!0)}function Ce(ve,Ae){ve.geometry!==null&&Ae.writeMessage(1,We,ve.geometry),ve.id!==void 0&&(typeof ve.id=="number"&&ve.id%1===0?Ae.writeSVarintField(12,ve.id):Ae.writeStringField(11,ve.id)),ve.properties&&me(ve.properties,Ae),me(ve,Ae,!0)}function We(ve,Ae){Ae.writeVarintField(1,F[ve.type]);var Re=ve.coordinates;if(ve.type==="Point")Ke(Re,Ae);else if(ve.type==="MultiPoint")pt(Re,Ae,!0);else if(ve.type==="LineString")pt(Re,Ae);else if(ve.type==="MultiLineString")Xe(Re,Ae);else if(ve.type==="Polygon")Xe(Re,Ae,!0);else if(ve.type==="MultiPolygon")gt(Re,Ae);else if(ve.type==="GeometryCollection")for(var Ye=0;Ye<ve.geometries.length;Ye++)Ae.writeMessage(4,We,ve.geometries[Ye]);me(ve,Ae,!0)}function me(ve,Ae,Re){var Ye=[],at=0;for(var ht in ve)Re&&ft(ht,ve.type)||(Ae.writeMessage(13,Ge,ve[ht]),Ye.push(fe[ht]),Ye.push(at++));Ae.writePackedVarint(Re?15:14,Ye)}function Ge(ve,Ae){if(ve!==null){var Re=typeof ve;Re==="string"?Ae.writeStringField(1,ve):Re==="boolean"?Ae.writeBooleanField(5,ve):Re==="object"?Ae.writeStringField(6,JSON.stringify(ve)):Re==="number"&&(ve%1!==0?Ae.writeDoubleField(2,ve):ve>=0?Ae.writeVarintField(3,ve):Ae.writeVarintField(4,-ve))}}function Ke(ve,Ae){for(var Re=[],Ye=0;Ye<k;Ye++)Re.push(Math.round(ve[Ye]*m));Ae.writePackedSVarint(3,Re)}function pt(ve,Ae){var Re=[];ie(Re,ve),Ae.writePackedSVarint(3,Re)}function Xe(ve,Ae,Re){var Ye=ve.length,at;if(Ye!==1){var ht=[];for(at=0;at<Ye;at++)ht.push(ve[at].length-(Re?1:0));Ae.writePackedVarint(2,ht)}var Se=[];for(at=0;at<Ye;at++)ie(Se,ve[at],Re);Ae.writePackedSVarint(3,Se)}function gt(ve,Ae){var Re=ve.length,Ye,at;if(Re!==1||ve[0].length!==1){var ht=[Re];for(Ye=0;Ye<Re;Ye++)for(ht.push(ve[Ye].length),at=0;at<ve[Ye].length;at++)ht.push(ve[Ye][at].length-1);Ae.writePackedVarint(2,ht)}var Se=[];for(Ye=0;Ye<Re;Ye++)for(at=0;at<ve[Ye].length;at++)ie(Se,ve[Ye][at],!0);Ae.writePackedSVarint(3,Se)}function ie(ve,Ae,Re){var Ye,at,ht=Ae.length-(Re?1:0),Se=new Array(k);for(at=0;at<k;at++)Se[at]=0;for(Ye=0;Ye<ht;Ye++)for(at=0;at<k;at++){var Qe=Math.round(Ae[Ye][at]*m)-Se[at];ve.push(Qe),Se[at]+=Qe}}function ft(ve,Ae){if(ve==="type")return!0;if(Ae==="FeatureCollection"){if(ve==="features")return!0}else if(Ae==="Feature"){if(ve==="id"||ve==="properties"||ve==="geometry")return!0}else if(Ae==="GeometryCollection"){if(ve==="geometries")return!0}else if(ve==="coordinates")return!0;return!1}},74951:function(Ne,fe,I){"use strict";fe.encode=I(62020),fe.decode=I(81490)},80645:function(Ne,fe){fe.read=function(I,D,k,m,ae){var F,K,W=ae*8-m-1,Y=(1<<W)-1,G=Y>>1,$=-7,xe=k?ae-1:0,Fe=k?-1:1,Ce=I[D+xe];for(xe+=Fe,F=Ce&(1<<-$)-1,Ce>>=-$,$+=W;$>0;F=F*256+I[D+xe],xe+=Fe,$-=8);for(K=F&(1<<-$)-1,F>>=-$,$+=m;$>0;K=K*256+I[D+xe],xe+=Fe,$-=8);if(F===0)F=1-G;else{if(F===Y)return K?NaN:(Ce?-1:1)*(1/0);K=K+Math.pow(2,m),F=F-G}return(Ce?-1:1)*K*Math.pow(2,F-m)},fe.write=function(I,D,k,m,ae,F){var K,W,Y,G=F*8-ae-1,$=(1<<G)-1,xe=$>>1,Fe=ae===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ce=m?0:F-1,We=m?1:-1,me=D<0||D===0&&1/D<0?1:0;for(D=Math.abs(D),isNaN(D)||D===1/0?(W=isNaN(D)?1:0,K=$):(K=Math.floor(Math.log(D)/Math.LN2),D*(Y=Math.pow(2,-K))<1&&(K--,Y*=2),K+xe>=1?D+=Fe/Y:D+=Fe*Math.pow(2,1-xe),D*Y>=2&&(K++,Y/=2),K+xe>=$?(W=0,K=$):K+xe>=1?(W=(D*Y-1)*Math.pow(2,ae),K=K+xe):(W=D*Math.pow(2,xe-1)*Math.pow(2,ae),K=0));ae>=8;I[k+Ce]=W&255,Ce+=We,W/=256,ae-=8);for(K=K<<ae|W,G+=ae;G>0;I[k+Ce]=K&255,Ce+=We,K/=256,G-=8);I[k+Ce-We]|=me*128}},7375:function(Ne,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0});var I=Symbol.for("INJECTION");function D(K,W,Y,G){function $(){return G&&!Reflect.hasMetadata(I,this,W)&&Reflect.defineMetadata(I,Y(),this,W),Reflect.hasMetadata(I,this,W)?Reflect.getMetadata(I,this,W):Y()}function xe(Fe){Reflect.defineMetadata(I,Fe,this,W)}Object.defineProperty(K,W,{configurable:!0,enumerable:!0,get:$,set:xe})}function k(K,W){return function(Y){return function(G,$){var xe=function(){return K.get(Y)};D(G,$,xe,W)}}}fe.makePropertyInjectDecorator=k;function m(K,W){return function(Y,G){return function($,xe){var Fe=function(){return K.getNamed(Y,G)};D($,xe,Fe,W)}}}fe.makePropertyInjectNamedDecorator=m;function ae(K,W){return function(Y,G,$){return function(xe,Fe){var Ce=function(){return K.getTagged(Y,G,$)};D(xe,Fe,Ce,W)}}}fe.makePropertyInjectTaggedDecorator=ae;function F(K,W){return function(Y){return function(G,$){var xe=function(){return K.getAll(Y)};D(G,$,xe,W)}}}fe.makePropertyMultiInjectDecorator=F},84879:function(Ne,fe,I){"use strict";var D;D={value:!0};var k=I(7375);function m(ae,F){F===void 0&&(F=!0);var K=k.makePropertyInjectDecorator(ae,F),W=k.makePropertyInjectNamedDecorator(ae,F),Y=k.makePropertyInjectTaggedDecorator(ae,F),G=k.makePropertyMultiInjectDecorator(ae,F);return{lazyInject:K,lazyInjectNamed:W,lazyInjectTagged:Y,lazyMultiInject:G}}fe.Z=m},99934:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.tagProperty=fe.tagParameter=fe.decorate=void 0;var D=I(16674),k=I(6867);function m(G,$,xe,Fe){var Ce=k.TAGGED;F(Ce,G,$,Fe,xe)}fe.tagParameter=m;function ae(G,$,xe){var Fe=k.TAGGED_PROP;F(Fe,G.constructor,$,xe)}fe.tagProperty=ae;function F(G,$,xe,Fe,Ce){var We={},me=typeof Ce=="number",Ge=Ce!==void 0&&me?Ce.toString():xe;if(me&&xe!==void 0)throw new Error(D.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(G,$)&&(We=Reflect.getMetadata(G,$));var Ke=We[Ge];if(!Array.isArray(Ke))Ke=[];else for(var pt=0,Xe=Ke;pt<Xe.length;pt++){var gt=Xe[pt];if(gt.key===Fe.key)throw new Error(D.DUPLICATED_METADATA+" "+gt.key.toString())}Ke.push(Fe),We[Ge]=Ke,Reflect.defineMetadata(G,We,$)}function K(G,$){Reflect.decorate(G,$)}function W(G,$){return function(xe,Fe){$(xe,Fe,G)}}function Y(G,$,xe){typeof xe=="number"?K([W(xe,G)],$):typeof xe=="string"?Reflect.decorate([G],$,xe):K([G],$)}fe.decorate=Y},5744:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.inject=fe.LazyServiceIdentifer=void 0;var D=I(16674),k=I(6867),m=I(47738),ae=I(99934),F=function(){function W(Y){this._cb=Y}return W.prototype.unwrap=function(){return this._cb()},W}();fe.LazyServiceIdentifer=F;function K(W){return function(Y,G,$){if(W===void 0)throw new Error(D.UNDEFINED_INJECT_ANNOTATION(Y.name));var xe=new m.Metadata(k.INJECT_TAG,W);typeof $=="number"?ae.tagParameter(Y,G,$,xe):ae.tagProperty(Y,G,xe)}}fe.inject=K},64315:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.injectable=void 0;var D=I(16674),k=I(6867);function m(){return function(ae){if(Reflect.hasOwnMetadata(k.PARAM_TYPES,ae))throw new Error(D.DUPLICATED_INJECTABLE_DECORATOR);var F=Reflect.getMetadata(k.DESIGN_PARAM_TYPES,ae)||[];return Reflect.defineMetadata(k.PARAM_TYPES,F,ae),ae}}fe.injectable=m},71693:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.multiInject=void 0;var D=I(6867),k=I(47738),m=I(99934);function ae(F){return function(K,W,Y){var G=new k.Metadata(D.MULTI_INJECT_TAG,F);typeof Y=="number"?m.tagParameter(K,W,Y,G):m.tagProperty(K,W,G)}}fe.multiInject=ae},38085:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.named=void 0;var D=I(6867),k=I(47738),m=I(99934);function ae(F){return function(K,W,Y){var G=new k.Metadata(D.NAMED_TAG,F);typeof Y=="number"?m.tagParameter(K,W,Y,G):m.tagProperty(K,W,G)}}fe.named=ae},6515:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.optional=void 0;var D=I(6867),k=I(47738),m=I(99934);function ae(){return function(F,K,W){var Y=new k.Metadata(D.OPTIONAL_TAG,!0);typeof W=="number"?m.tagParameter(F,K,W,Y):m.tagProperty(F,K,Y)}}fe.optional=ae},7014:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.postConstruct=void 0;var D=I(16674),k=I(6867),m=I(47738);function ae(){return function(F,K,W){var Y=new m.Metadata(k.POST_CONSTRUCT,K);if(Reflect.hasOwnMetadata(k.POST_CONSTRUCT,F.constructor))throw new Error(D.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(k.POST_CONSTRUCT,Y,F.constructor)}}fe.postConstruct=ae},32052:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.tagged=void 0;var D=I(47738),k=I(99934);function m(ae,F){return function(K,W,Y){var G=new D.Metadata(ae,F);typeof Y=="number"?k.tagParameter(K,W,Y,G):k.tagProperty(K,W,G)}}fe.tagged=m},55638:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.targetName=void 0;var D=I(6867),k=I(47738),m=I(99934);function ae(F){return function(K,W,Y){var G=new k.Metadata(D.NAME_TAG,F);m.tagParameter(K,W,Y,G)}}fe.targetName=ae},86757:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.unmanaged=void 0;var D=I(6867),k=I(47738),m=I(99934);function ae(){return function(F,K,W){var Y=new k.Metadata(D.UNMANAGED_TAG,!0);m.tagParameter(F,K,W,Y)}}fe.unmanaged=ae},44290:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.Binding=void 0;var D=I(28421),k=I(37791),m=function(){function ae(F,K){this.id=k.id(),this.activated=!1,this.serviceIdentifier=F,this.scope=K,this.type=D.BindingTypeEnum.Invalid,this.constraint=function(W){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return ae.prototype.clone=function(){var F=new ae(this.serviceIdentifier,this.scope);return F.activated=F.scope===D.BindingScopeEnum.Singleton?this.activated:!1,F.implementationType=this.implementationType,F.dynamicValue=this.dynamicValue,F.scope=this.scope,F.type=this.type,F.factory=this.factory,F.provider=this.provider,F.constraint=this.constraint,F.onActivation=this.onActivation,F.cache=this.cache,F},ae}();fe.Binding=m},23184:function(Ne,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.BindingCount=void 0;var I={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};fe.BindingCount=I},16674:function(Ne,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.STACK_OVERFLOW=fe.CIRCULAR_DEPENDENCY_IN_FACTORY=fe.POST_CONSTRUCT_ERROR=fe.MULTIPLE_POST_CONSTRUCT_METHODS=fe.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=fe.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=fe.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=fe.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=fe.ARGUMENTS_LENGTH_MISMATCH=fe.INVALID_DECORATOR_OPERATION=fe.INVALID_TO_SELF_VALUE=fe.INVALID_FUNCTION_BINDING=fe.INVALID_MIDDLEWARE_RETURN=fe.NO_MORE_SNAPSHOTS_AVAILABLE=fe.INVALID_BINDING_TYPE=fe.NOT_IMPLEMENTED=fe.CIRCULAR_DEPENDENCY=fe.UNDEFINED_INJECT_ANNOTATION=fe.MISSING_INJECT_ANNOTATION=fe.MISSING_INJECTABLE_ANNOTATION=fe.NOT_REGISTERED=fe.CANNOT_UNBIND=fe.AMBIGUOUS_MATCH=fe.KEY_NOT_FOUND=fe.NULL_ARGUMENT=fe.DUPLICATED_METADATA=fe.DUPLICATED_INJECTABLE_DECORATOR=void 0,fe.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",fe.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",fe.NULL_ARGUMENT="NULL argument",fe.KEY_NOT_FOUND="Key Not Found",fe.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",fe.CANNOT_UNBIND="Could not unbind serviceIdentifier:",fe.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",fe.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",fe.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var I=function(ae){return"@inject called with undefined this could mean that the class "+ae+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};fe.UNDEFINED_INJECT_ANNOTATION=I,fe.CIRCULAR_DEPENDENCY="Circular dependency found:",fe.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",fe.INVALID_BINDING_TYPE="Invalid binding type:",fe.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",fe.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",fe.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",fe.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",fe.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var D=function(){for(var ae=[],F=0;F<arguments.length;F++)ae[F]=arguments[F];return"The number of constructor arguments in the derived class "+(ae[0]+" must be >= than the number of constructor arguments of its base class.")};fe.ARGUMENTS_LENGTH_MISMATCH=D,fe.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",fe.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",fe.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",fe.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",fe.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var k=function(){for(var ae=[],F=0;F<arguments.length;F++)ae[F]=arguments[F];return"@postConstruct error in class "+ae[0]+": "+ae[1]};fe.POST_CONSTRUCT_ERROR=k;var m=function(){for(var ae=[],F=0;F<arguments.length;F++)ae[F]=arguments[F];return"It looks like there is a circular dependency "+("in one of the '"+ae[0]+"' bindings. Please investigate bindings with")+("service identifier '"+ae[1]+"'.")};fe.CIRCULAR_DEPENDENCY_IN_FACTORY=m,fe.STACK_OVERFLOW="Maximum call stack size exceeded"},28421:function(Ne,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.TargetTypeEnum=fe.BindingTypeEnum=fe.BindingScopeEnum=void 0;var I={Request:"Request",Singleton:"Singleton",Transient:"Transient"};fe.BindingScopeEnum=I;var D={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};fe.BindingTypeEnum=D;var k={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};fe.TargetTypeEnum=k},6867:function(Ne,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.NON_CUSTOM_TAG_KEYS=fe.POST_CONSTRUCT=fe.DESIGN_PARAM_TYPES=fe.PARAM_TYPES=fe.TAGGED_PROP=fe.TAGGED=fe.MULTI_INJECT_TAG=fe.INJECT_TAG=fe.OPTIONAL_TAG=fe.UNMANAGED_TAG=fe.NAME_TAG=fe.NAMED_TAG=void 0,fe.NAMED_TAG="named",fe.NAME_TAG="name",fe.UNMANAGED_TAG="unmanaged",fe.OPTIONAL_TAG="optional",fe.INJECT_TAG="inject",fe.MULTI_INJECT_TAG="multi_inject",fe.TAGGED="inversify:tagged",fe.TAGGED_PROP="inversify:tagged_props",fe.PARAM_TYPES="inversify:paramtypes",fe.DESIGN_PARAM_TYPES="design:paramtypes",fe.POST_CONSTRUCT="post_construct";function I(){return[fe.INJECT_TAG,fe.MULTI_INJECT_TAG,fe.NAME_TAG,fe.UNMANAGED_TAG,fe.NAMED_TAG,fe.OPTIONAL_TAG]}fe.NON_CUSTOM_TAG_KEYS=I()},51389:function(Ne,fe,I){"use strict";var D=this&&this.__awaiter||function(Ke,pt,Xe,gt){function ie(ft){return ft instanceof Xe?ft:new Xe(function(ve){ve(ft)})}return new(Xe||(Xe=Promise))(function(ft,ve){function Ae(at){try{Ye(gt.next(at))}catch(ht){ve(ht)}}function Re(at){try{Ye(gt.throw(at))}catch(ht){ve(ht)}}function Ye(at){at.done?ft(at.value):ie(at.value).then(Ae,Re)}Ye((gt=gt.apply(Ke,pt||[])).next())})},k=this&&this.__generator||function(Ke,pt){var Xe={label:0,sent:function(){if(ft[0]&1)throw ft[1];return ft[1]},trys:[],ops:[]},gt,ie,ft,ve;return ve={next:Ae(0),throw:Ae(1),return:Ae(2)},typeof Symbol=="function"&&(ve[Symbol.iterator]=function(){return this}),ve;function Ae(Ye){return function(at){return Re([Ye,at])}}function Re(Ye){if(gt)throw new TypeError("Generator is already executing.");for(;Xe;)try{if(gt=1,ie&&(ft=Ye[0]&2?ie.return:Ye[0]?ie.throw||((ft=ie.return)&&ft.call(ie),0):ie.next)&&!(ft=ft.call(ie,Ye[1])).done)return ft;switch(ie=0,ft&&(Ye=[Ye[0]&2,ft.value]),Ye[0]){case 0:case 1:ft=Ye;break;case 4:return Xe.label++,{value:Ye[1],done:!1};case 5:Xe.label++,ie=Ye[1],Ye=[0];continue;case 7:Ye=Xe.ops.pop(),Xe.trys.pop();continue;default:if(ft=Xe.trys,!(ft=ft.length>0&&ft[ft.length-1])&&(Ye[0]===6||Ye[0]===2)){Xe=0;continue}if(Ye[0]===3&&(!ft||Ye[1]>ft[0]&&Ye[1]<ft[3])){Xe.label=Ye[1];break}if(Ye[0]===6&&Xe.label<ft[1]){Xe.label=ft[1],ft=Ye;break}if(ft&&Xe.label<ft[2]){Xe.label=ft[2],Xe.ops.push(Ye);break}ft[2]&&Xe.ops.pop(),Xe.trys.pop();continue}Ye=pt.call(Ke,Xe)}catch(at){Ye=[6,at],ie=0}finally{gt=ft=0}if(Ye[0]&5)throw Ye[1];return{value:Ye[0]?Ye[1]:void 0,done:!0}}},m=this&&this.__spreadArray||function(Ke,pt){for(var Xe=0,gt=pt.length,ie=Ke.length;Xe<gt;Xe++,ie++)Ke[ie]=pt[Xe];return Ke};Object.defineProperty(fe,"__esModule",{value:!0}),fe.Container=void 0;var ae=I(44290),F=I(16674),K=I(28421),W=I(6867),Y=I(51377),G=I(86311),$=I(31927),xe=I(51860),Fe=I(37791),Ce=I(55800),We=I(85700),me=I(80175),Ge=function(){function Ke(pt){this._appliedMiddleware=[];var Xe=pt||{};if(typeof Xe!="object")throw new Error(""+F.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(Xe.defaultScope===void 0)Xe.defaultScope=K.BindingScopeEnum.Transient;else if(Xe.defaultScope!==K.BindingScopeEnum.Singleton&&Xe.defaultScope!==K.BindingScopeEnum.Transient&&Xe.defaultScope!==K.BindingScopeEnum.Request)throw new Error(""+F.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(Xe.autoBindInjectable===void 0)Xe.autoBindInjectable=!1;else if(typeof Xe.autoBindInjectable!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(Xe.skipBaseClassChecks===void 0)Xe.skipBaseClassChecks=!1;else if(typeof Xe.skipBaseClassChecks!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:Xe.autoBindInjectable,defaultScope:Xe.defaultScope,skipBaseClassChecks:Xe.skipBaseClassChecks},this.id=Fe.id(),this._bindingDictionary=new me.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new Y.MetadataReader}return Ke.merge=function(pt,Xe){for(var gt=[],ie=2;ie<arguments.length;ie++)gt[ie-2]=arguments[ie];var ft=new Ke,ve=m([pt,Xe],gt).map(function(Ye){return G.getBindingDictionary(Ye)}),Ae=G.getBindingDictionary(ft);function Re(Ye,at){Ye.traverse(function(ht,Se){Se.forEach(function(Qe){at.add(Qe.serviceIdentifier,Qe.clone())})})}return ve.forEach(function(Ye){Re(Ye,Ae)}),ft},Ke.prototype.load=function(){for(var pt=[],Xe=0;Xe<arguments.length;Xe++)pt[Xe]=arguments[Xe];for(var gt=this._getContainerModuleHelpersFactory(),ie=0,ft=pt;ie<ft.length;ie++){var ve=ft[ie],Ae=gt(ve.id);ve.registry(Ae.bindFunction,Ae.unbindFunction,Ae.isboundFunction,Ae.rebindFunction)}},Ke.prototype.loadAsync=function(){for(var pt=[],Xe=0;Xe<arguments.length;Xe++)pt[Xe]=arguments[Xe];return D(this,void 0,void 0,function(){var gt,ie,ft,ve,Ae;return k(this,function(Re){switch(Re.label){case 0:gt=this._getContainerModuleHelpersFactory(),ie=0,ft=pt,Re.label=1;case 1:return ie<ft.length?(ve=ft[ie],Ae=gt(ve.id),[4,ve.registry(Ae.bindFunction,Ae.unbindFunction,Ae.isboundFunction,Ae.rebindFunction)]):[3,4];case 2:Re.sent(),Re.label=3;case 3:return ie++,[3,1];case 4:return[2]}})})},Ke.prototype.unload=function(){for(var pt=this,Xe=[],gt=0;gt<arguments.length;gt++)Xe[gt]=arguments[gt];var ie=function(ft){return function(ve){return ve.moduleId===ft}};Xe.forEach(function(ft){var ve=ie(ft.id);pt._bindingDictionary.removeByCondition(ve)})},Ke.prototype.bind=function(pt){var Xe=this.options.defaultScope||K.BindingScopeEnum.Transient,gt=new ae.Binding(pt,Xe);return this._bindingDictionary.add(pt,gt),new xe.BindingToSyntax(gt)},Ke.prototype.rebind=function(pt){return this.unbind(pt),this.bind(pt)},Ke.prototype.unbind=function(pt){try{this._bindingDictionary.remove(pt)}catch(Xe){throw new Error(F.CANNOT_UNBIND+" "+Ce.getServiceIdentifierAsString(pt))}},Ke.prototype.unbindAll=function(){this._bindingDictionary=new me.Lookup},Ke.prototype.isBound=function(pt){var Xe=this._bindingDictionary.hasKey(pt);return!Xe&&this.parent&&(Xe=this.parent.isBound(pt)),Xe},Ke.prototype.isBoundNamed=function(pt,Xe){return this.isBoundTagged(pt,W.NAMED_TAG,Xe)},Ke.prototype.isBoundTagged=function(pt,Xe,gt){var ie=!1;if(this._bindingDictionary.hasKey(pt)){var ft=this._bindingDictionary.get(pt),ve=G.createMockRequest(this,pt,Xe,gt);ie=ft.some(function(Ae){return Ae.constraint(ve)})}return!ie&&this.parent&&(ie=this.parent.isBoundTagged(pt,Xe,gt)),ie},Ke.prototype.snapshot=function(){this._snapshots.push(We.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},Ke.prototype.restore=function(){var pt=this._snapshots.pop();if(pt===void 0)throw new Error(F.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=pt.bindings,this._middleware=pt.middleware},Ke.prototype.createChild=function(pt){var Xe=new Ke(pt||this.options);return Xe.parent=this,Xe},Ke.prototype.applyMiddleware=function(){for(var pt=[],Xe=0;Xe<arguments.length;Xe++)pt[Xe]=arguments[Xe];this._appliedMiddleware=this._appliedMiddleware.concat(pt);var gt=this._middleware?this._middleware:this._planAndResolve();this._middleware=pt.reduce(function(ie,ft){return ft(ie)},gt)},Ke.prototype.applyCustomMetadataReader=function(pt){this._metadataReader=pt},Ke.prototype.get=function(pt){return this._get(!1,!1,K.TargetTypeEnum.Variable,pt)},Ke.prototype.getTagged=function(pt,Xe,gt){return this._get(!1,!1,K.TargetTypeEnum.Variable,pt,Xe,gt)},Ke.prototype.getNamed=function(pt,Xe){return this.getTagged(pt,W.NAMED_TAG,Xe)},Ke.prototype.getAll=function(pt){return this._get(!0,!0,K.TargetTypeEnum.Variable,pt)},Ke.prototype.getAllTagged=function(pt,Xe,gt){return this._get(!1,!0,K.TargetTypeEnum.Variable,pt,Xe,gt)},Ke.prototype.getAllNamed=function(pt,Xe){return this.getAllTagged(pt,W.NAMED_TAG,Xe)},Ke.prototype.resolve=function(pt){var Xe=this.createChild();return Xe.bind(pt).toSelf(),this._appliedMiddleware.forEach(function(gt){Xe.applyMiddleware(gt)}),Xe.get(pt)},Ke.prototype._getContainerModuleHelpersFactory=function(){var pt=this,Xe=function(Ae,Re){Ae._binding.moduleId=Re},gt=function(Ae){return function(Re){var Ye=pt.bind.bind(pt),at=Ye(Re);return Xe(at,Ae),at}},ie=function(Ae){return function(Re){var Ye=pt.unbind.bind(pt);Ye(Re)}},ft=function(Ae){return function(Re){var Ye=pt.isBound.bind(pt);return Ye(Re)}},ve=function(Ae){return function(Re){var Ye=pt.rebind.bind(pt),at=Ye(Re);return Xe(at,Ae),at}};return function(Ae){return{bindFunction:gt(Ae),isboundFunction:ft(Ae),rebindFunction:ve(Ae),unbindFunction:ie(Ae)}}},Ke.prototype._get=function(pt,Xe,gt,ie,ft,ve){var Ae=null,Re={avoidConstraints:pt,contextInterceptor:function(Ye){return Ye},isMultiInject:Xe,key:ft,serviceIdentifier:ie,targetType:gt,value:ve};if(this._middleware){if(Ae=this._middleware(Re),Ae==null)throw new Error(F.INVALID_MIDDLEWARE_RETURN)}else Ae=this._planAndResolve()(Re);return Ae},Ke.prototype._planAndResolve=function(){var pt=this;return function(Xe){var gt=G.plan(pt._metadataReader,pt,Xe.isMultiInject,Xe.targetType,Xe.serviceIdentifier,Xe.key,Xe.value,Xe.avoidConstraints);gt=Xe.contextInterceptor(gt);var ie=$.resolve(gt);return ie}},Ke}();fe.Container=Ge},33244:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.AsyncContainerModule=fe.ContainerModule=void 0;var D=I(37791),k=function(){function ae(F){this.id=D.id(),this.registry=F}return ae}();fe.ContainerModule=k;var m=function(){function ae(F){this.id=D.id(),this.registry=F}return ae}();fe.AsyncContainerModule=m},85700:function(Ne,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.ContainerSnapshot=void 0;var I=function(){function D(){}return D.of=function(k,m){var ae=new D;return ae.bindings=k,ae.middleware=m,ae},D}();fe.ContainerSnapshot=I},80175:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.Lookup=void 0;var D=I(16674),k=function(){function m(){this._map=new Map}return m.prototype.getMap=function(){return this._map},m.prototype.add=function(ae,F){if(ae==null)throw new Error(D.NULL_ARGUMENT);if(F==null)throw new Error(D.NULL_ARGUMENT);var K=this._map.get(ae);K!==void 0?(K.push(F),this._map.set(ae,K)):this._map.set(ae,[F])},m.prototype.get=function(ae){if(ae==null)throw new Error(D.NULL_ARGUMENT);var F=this._map.get(ae);if(F!==void 0)return F;throw new Error(D.KEY_NOT_FOUND)},m.prototype.remove=function(ae){if(ae==null)throw new Error(D.NULL_ARGUMENT);if(!this._map.delete(ae))throw new Error(D.KEY_NOT_FOUND)},m.prototype.removeByCondition=function(ae){var F=this;this._map.forEach(function(K,W){var Y=K.filter(function(G){return!ae(G)});Y.length>0?F._map.set(W,Y):F._map.delete(W)})},m.prototype.hasKey=function(ae){if(ae==null)throw new Error(D.NULL_ARGUMENT);return this._map.has(ae)},m.prototype.clone=function(){var ae=new m;return this._map.forEach(function(F,K){F.forEach(function(W){return ae.add(K,W.clone())})}),ae},m.prototype.traverse=function(ae){this._map.forEach(function(F,K){ae(K,F)})},m}();fe.Lookup=k},86700:function(Ne,fe,I){"use strict";var D;D={value:!0},D=D=D=D=D=D=fe.GW=D=D=fe.zY=D=D=D=D=D=fe.f3=D=D=fe.b2=D=D=D=D=D=fe.W2=D=void 0;var k=I(6867);D=k;var m=I(51389);Object.defineProperty(fe,"W2",{enumerable:!0,get:function(){return m.Container}});var ae=I(28421);D={enumerable:!0,get:function(){return ae.BindingScopeEnum}},D={enumerable:!0,get:function(){return ae.BindingTypeEnum}},D={enumerable:!0,get:function(){return ae.TargetTypeEnum}};var F=I(33244);D={enumerable:!0,get:function(){return F.AsyncContainerModule}},D={enumerable:!0,get:function(){return F.ContainerModule}};var K=I(64315);Object.defineProperty(fe,"b2",{enumerable:!0,get:function(){return K.injectable}});var W=I(32052);D={enumerable:!0,get:function(){return W.tagged}};var Y=I(38085);D={enumerable:!0,get:function(){return Y.named}};var G=I(5744);Object.defineProperty(fe,"f3",{enumerable:!0,get:function(){return G.inject}}),D={enumerable:!0,get:function(){return G.LazyServiceIdentifer}};var $=I(6515);D={enumerable:!0,get:function(){return $.optional}};var xe=I(86757);D={enumerable:!0,get:function(){return xe.unmanaged}};var Fe=I(71693);D={enumerable:!0,get:function(){return Fe.multiInject}};var Ce=I(55638);D={enumerable:!0,get:function(){return Ce.targetName}};var We=I(7014);Object.defineProperty(fe,"zY",{enumerable:!0,get:function(){return We.postConstruct}});var me=I(51377);D={enumerable:!0,get:function(){return me.MetadataReader}};var Ge=I(37791);D={enumerable:!0,get:function(){return Ge.id}};var Ke=I(99934);Object.defineProperty(fe,"GW",{enumerable:!0,get:function(){return Ke.decorate}});var pt=I(80758);D={enumerable:!0,get:function(){return pt.traverseAncerstors}},D={enumerable:!0,get:function(){return pt.taggedConstraint}},D={enumerable:!0,get:function(){return pt.namedConstraint}},D={enumerable:!0,get:function(){return pt.typeConstraint}};var Xe=I(55800);D={enumerable:!0,get:function(){return Xe.getServiceIdentifierAsString}};var gt=I(70600);D={enumerable:!0,get:function(){return gt.multiBindToService}}},95228:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.Context=void 0;var D=I(37791),k=function(){function m(ae){this.id=D.id(),this.container=ae}return m.prototype.addPlan=function(ae){this.plan=ae},m.prototype.setCurrentRequest=function(ae){this.currentRequest=ae},m}();fe.Context=k},47738:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.Metadata=void 0;var D=I(6867),k=function(){function m(ae,F){this.key=ae,this.value=F}return m.prototype.toString=function(){return this.key===D.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},m}();fe.Metadata=k},51377:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.MetadataReader=void 0;var D=I(6867),k=function(){function m(){}return m.prototype.getConstructorMetadata=function(ae){var F=Reflect.getMetadata(D.PARAM_TYPES,ae),K=Reflect.getMetadata(D.TAGGED,ae);return{compilerGeneratedMetadata:F,userGeneratedMetadata:K||{}}},m.prototype.getPropertiesMetadata=function(ae){var F=Reflect.getMetadata(D.TAGGED_PROP,ae)||[];return F},m}();fe.MetadataReader=k},55314:function(Ne,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.Plan=void 0;var I=function(){function D(k,m){this.parentContext=k,this.rootRequest=m}return D}();fe.Plan=I},86311:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.getBindingDictionary=fe.createMockRequest=fe.plan=void 0;var D=I(23184),k=I(16674),m=I(28421),ae=I(6867),F=I(85265),K=I(55800),W=I(95228),Y=I(47738),G=I(55314),$=I(6e3),xe=I(6748),Fe=I(18924);function Ce(ie){return ie._bindingDictionary}fe.getBindingDictionary=Ce;function We(ie,ft,ve,Ae,Re,Ye){var at=ie?ae.MULTI_INJECT_TAG:ae.INJECT_TAG,ht=new Y.Metadata(at,ve),Se=new Fe.Target(ft,Ae,ve,ht);if(Re!==void 0){var Qe=new Y.Metadata(Re,Ye);Se.metadata.push(Qe)}return Se}function me(ie,ft,ve,Ae,Re){var Ye=pt(ve.container,Re.serviceIdentifier),at=[];return Ye.length===D.BindingCount.NoBindingsAvailable&&ve.container.options.autoBindInjectable&&typeof Re.serviceIdentifier=="function"&&ie.getConstructorMetadata(Re.serviceIdentifier).compilerGeneratedMetadata&&(ve.container.bind(Re.serviceIdentifier).toSelf(),Ye=pt(ve.container,Re.serviceIdentifier)),ft?at=Ye:at=Ye.filter(function(ht){var Se=new xe.Request(ht.serviceIdentifier,ve,Ae,ht,Re);return ht.constraint(Se)}),Ge(Re.serviceIdentifier,at,Re,ve.container),at}function Ge(ie,ft,ve,Ae){switch(ft.length){case D.BindingCount.NoBindingsAvailable:if(ve.isOptional())return ft;var Re=K.getServiceIdentifierAsString(ie),Ye=k.NOT_REGISTERED;throw Ye+=K.listMetadataForTarget(Re,ve),Ye+=K.listRegisteredBindingsForServiceIdentifier(Ae,Re,pt),new Error(Ye);case D.BindingCount.OnlyOneBindingAvailable:if(!ve.isArray())return ft;case D.BindingCount.MultipleBindingsAvailable:default:if(ve.isArray())return ft;var Re=K.getServiceIdentifierAsString(ie),Ye=k.AMBIGUOUS_MATCH+" "+Re;throw Ye+=K.listRegisteredBindingsForServiceIdentifier(Ae,Re,pt),new Error(Ye)}}function Ke(ie,ft,ve,Ae,Re,Ye){var at,ht;if(Re===null){at=me(ie,ft,Ae,null,Ye),ht=new xe.Request(ve,Ae,null,at,Ye);var Se=new G.Plan(Ae,ht);Ae.addPlan(Se)}else at=me(ie,ft,Ae,Re,Ye),ht=Re.addChildRequest(Ye.serviceIdentifier,at,Ye);at.forEach(function(Qe){var oe=null;if(Ye.isArray())oe=ht.addChildRequest(Qe.serviceIdentifier,Qe,Ye);else{if(Qe.cache)return;oe=ht}if(Qe.type===m.BindingTypeEnum.Instance&&Qe.implementationType!==null){var ue=$.getDependencies(ie,Qe.implementationType);if(!Ae.container.options.skipBaseClassChecks){var be=$.getBaseClassDependencyCount(ie,Qe.implementationType);if(ue.length<be){var vt=k.ARGUMENTS_LENGTH_MISMATCH($.getFunctionName(Qe.implementationType));throw new Error(vt)}}ue.forEach(function(bt){Ke(ie,!1,bt.serviceIdentifier,Ae,oe,bt)})}})}function pt(ie,ft){var ve=[],Ae=Ce(ie);return Ae.hasKey(ft)?ve=Ae.get(ft):ie.parent!==null&&(ve=pt(ie.parent,ft)),ve}function Xe(ie,ft,ve,Ae,Re,Ye,at,ht){ht===void 0&&(ht=!1);var Se=new W.Context(ft),Qe=We(ve,Ae,Re,"",Ye,at);try{return Ke(ie,ht,Re,Se,null,Qe),Se}catch(oe){throw F.isStackOverflowExeption(oe)&&Se.plan&&K.circularDependencyToException(Se.plan.rootRequest),oe}}fe.plan=Xe;function gt(ie,ft,ve,Ae){var Re=new Fe.Target(m.TargetTypeEnum.Variable,"",ft,new Y.Metadata(ve,Ae)),Ye=new W.Context(ie),at=new xe.Request(ft,Ye,null,[],Re);return at}fe.createMockRequest=gt},88460:function(Ne,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.QueryableString=void 0;var I=function(){function D(k){this.str=k}return D.prototype.startsWith=function(k){return this.str.indexOf(k)===0},D.prototype.endsWith=function(k){var m="",ae=k.split("").reverse().join("");return m=this.str.split("").reverse().join(""),this.startsWith.call({str:m},ae)},D.prototype.contains=function(k){return this.str.indexOf(k)!==-1},D.prototype.equals=function(k){return this.str===k},D.prototype.value=function(){return this.str},D}();fe.QueryableString=I},6e3:function(Ne,fe,I){"use strict";var D=this&&this.__spreadArray||function(me,Ge){for(var Ke=0,pt=Ge.length,Xe=me.length;Ke<pt;Ke++,Xe++)me[Xe]=Ge[Ke];return me};Object.defineProperty(fe,"__esModule",{value:!0}),fe.getFunctionName=fe.getBaseClassDependencyCount=fe.getDependencies=void 0;var k=I(5744),m=I(16674),ae=I(28421),F=I(6867),K=I(55800);Object.defineProperty(fe,"getFunctionName",{enumerable:!0,get:function(){return K.getFunctionName}});var W=I(18924);function Y(me,Ge){var Ke=K.getFunctionName(Ge),pt=G(me,Ke,Ge,!1);return pt}fe.getDependencies=Y;function G(me,Ge,Ke,pt){var Xe=me.getConstructorMetadata(Ke),gt=Xe.compilerGeneratedMetadata;if(gt===void 0){var ie=m.MISSING_INJECTABLE_ANNOTATION+" "+Ge+".";throw new Error(ie)}var ft=Xe.userGeneratedMetadata,ve=Object.keys(ft),Ae=Ke.length===0&&ve.length>0,Re=ve.length>Ke.length,Ye=Ae||Re?ve.length:Ke.length,at=xe(pt,Ge,gt,ft,Ye),ht=Fe(me,Ke),Se=D(D([],at),ht);return Se}function $(me,Ge,Ke,pt,Xe){var gt=Xe[me.toString()]||[],ie=We(gt),ft=ie.unmanaged!==!0,ve=pt[me],Ae=ie.inject||ie.multiInject;if(ve=Ae||ve,ve instanceof k.LazyServiceIdentifer&&(ve=ve.unwrap()),ft){var Re=ve===Object,Ye=ve===Function,at=ve===void 0,ht=Re||Ye||at;if(!Ge&&ht){var Se=m.MISSING_INJECT_ANNOTATION+" argument "+me+" in class "+Ke+".";throw new Error(Se)}var Qe=new W.Target(ae.TargetTypeEnum.ConstructorArgument,ie.targetName,ve);return Qe.metadata=gt,Qe}return null}function xe(me,Ge,Ke,pt,Xe){for(var gt=[],ie=0;ie<Xe;ie++){var ft=ie,ve=$(ft,me,Ge,Ke,pt);ve!==null&&gt.push(ve)}return gt}function Fe(me,Ge){for(var Ke=me.getPropertiesMetadata(Ge),pt=[],Xe=Object.keys(Ke),gt=0,ie=Xe;gt<ie.length;gt++){var ft=ie[gt],ve=Ke[ft],Ae=We(Ke[ft]),Re=Ae.targetName||ft,Ye=Ae.inject||Ae.multiInject,at=new W.Target(ae.TargetTypeEnum.ClassProperty,Re,Ye);at.metadata=ve,pt.push(at)}var ht=Object.getPrototypeOf(Ge.prototype).constructor;if(ht!==Object){var Se=Fe(me,ht);pt=D(D([],pt),Se)}return pt}function Ce(me,Ge){var Ke=Object.getPrototypeOf(Ge.prototype).constructor;if(Ke!==Object){var pt=K.getFunctionName(Ke),Xe=G(me,pt,Ke,!0),gt=Xe.map(function(ve){return ve.metadata.filter(function(Ae){return Ae.key===F.UNMANAGED_TAG})}),ie=[].concat.apply([],gt).length,ft=Xe.length-ie;return ft>0?ft:Ce(me,Ke)}else return 0}fe.getBaseClassDependencyCount=Ce;function We(me){var Ge={};return me.forEach(function(Ke){Ge[Ke.key.toString()]=Ke.value}),{inject:Ge[F.INJECT_TAG],multiInject:Ge[F.MULTI_INJECT_TAG],targetName:Ge[F.NAME_TAG],unmanaged:Ge[F.UNMANAGED_TAG]}}},6748:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.Request=void 0;var D=I(37791),k=function(){function m(ae,F,K,W,Y){this.id=D.id(),this.serviceIdentifier=ae,this.parentContext=F,this.parentRequest=K,this.target=Y,this.childRequests=[],this.bindings=Array.isArray(W)?W:[W],this.requestScope=K===null?new Map:null}return m.prototype.addChildRequest=function(ae,F,K){var W=new m(ae,this.parentContext,this,F,K);return this.childRequests.push(W),W},m}();fe.Request=k},18924:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.Target=void 0;var D=I(6867),k=I(37791),m=I(47738),ae=I(88460),F=function(){function K(W,Y,G,$){this.id=k.id(),this.type=W,this.serviceIdentifier=G,this.name=new ae.QueryableString(Y||""),this.metadata=new Array;var xe=null;typeof $=="string"?xe=new m.Metadata(D.NAMED_TAG,$):$ instanceof m.Metadata&&(xe=$),xe!==null&&this.metadata.push(xe)}return K.prototype.hasTag=function(W){for(var Y=0,G=this.metadata;Y<G.length;Y++){var $=G[Y];if($.key===W)return!0}return!1},K.prototype.isArray=function(){return this.hasTag(D.MULTI_INJECT_TAG)},K.prototype.matchesArray=function(W){return this.matchesTag(D.MULTI_INJECT_TAG)(W)},K.prototype.isNamed=function(){return this.hasTag(D.NAMED_TAG)},K.prototype.isTagged=function(){return this.metadata.some(function(W){return D.NON_CUSTOM_TAG_KEYS.every(function(Y){return W.key!==Y})})},K.prototype.isOptional=function(){return this.matchesTag(D.OPTIONAL_TAG)(!0)},K.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(W){return W.key===D.NAMED_TAG})[0]:null},K.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(W){return D.NON_CUSTOM_TAG_KEYS.every(function(Y){return W.key!==Y})}):null},K.prototype.matchesNamedTag=function(W){return this.matchesTag(D.NAMED_TAG)(W)},K.prototype.matchesTag=function(W){var Y=this;return function(G){for(var $=0,xe=Y.metadata;$<xe.length;$++){var Fe=xe[$];if(Fe.key===W&&Fe.value===G)return!0}return!1}},K}();fe.Target=F},52279:function(Ne,fe,I){"use strict";var D=this&&this.__spreadArray||function(G,$){for(var xe=0,Fe=$.length,Ce=G.length;xe<Fe;xe++,Ce++)G[Ce]=$[xe];return G};Object.defineProperty(fe,"__esModule",{value:!0}),fe.resolveInstance=void 0;var k=I(16674),m=I(28421),ae=I(6867);function F(G,$,xe){var Fe=$.filter(function(We){return We.target!==null&&We.target.type===m.TargetTypeEnum.ClassProperty}),Ce=Fe.map(xe);return Fe.forEach(function(We,me){var Ge="";Ge=We.target.name.value();var Ke=Ce[me];G[Ge]=Ke}),G}function K(G,$){return new(G.bind.apply(G,D([void 0],$)))}function W(G,$){if(Reflect.hasMetadata(ae.POST_CONSTRUCT,G)){var xe=Reflect.getMetadata(ae.POST_CONSTRUCT,G);try{$[xe.value]()}catch(Fe){throw new Error(k.POST_CONSTRUCT_ERROR(G.name,Fe.message))}}}function Y(G,$,xe){var Fe=null;if($.length>0){var Ce=$.filter(function(me){return me.target!==null&&me.target.type===m.TargetTypeEnum.ConstructorArgument}),We=Ce.map(xe);Fe=K(G,We),Fe=F(Fe,$,xe)}else Fe=new G;return W(G,Fe),Fe}fe.resolveInstance=Y},31927:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.resolve=void 0;var D=I(16674),k=I(28421),m=I(85265),ae=I(55800),F=I(52279),K=function(G,$,xe){try{return xe()}catch(Fe){throw m.isStackOverflowExeption(Fe)?new Error(D.CIRCULAR_DEPENDENCY_IN_FACTORY(G,$.toString())):Fe}},W=function(G){return function($){$.parentContext.setCurrentRequest($);var xe=$.bindings,Fe=$.childRequests,Ce=$.target&&$.target.isArray(),We=!$.parentRequest||!$.parentRequest.target||!$.target||!$.parentRequest.target.matchesArray($.target.serviceIdentifier);if(Ce&&We)return Fe.map(function(gt){var ie=W(G);return ie(gt)});var me=null;if($.target.isOptional()&&xe.length===0)return;var Ge=xe[0],Ke=Ge.scope===k.BindingScopeEnum.Singleton,pt=Ge.scope===k.BindingScopeEnum.Request;if(Ke&&Ge.activated)return Ge.cache;if(pt&&G!==null&&G.has(Ge.id))return G.get(Ge.id);if(Ge.type===k.BindingTypeEnum.ConstantValue)me=Ge.cache,Ge.activated=!0;else if(Ge.type===k.BindingTypeEnum.Function)me=Ge.cache,Ge.activated=!0;else if(Ge.type===k.BindingTypeEnum.Constructor)me=Ge.implementationType;else if(Ge.type===k.BindingTypeEnum.DynamicValue&&Ge.dynamicValue!==null)me=K("toDynamicValue",Ge.serviceIdentifier,function(){return Ge.dynamicValue($.parentContext)});else if(Ge.type===k.BindingTypeEnum.Factory&&Ge.factory!==null)me=K("toFactory",Ge.serviceIdentifier,function(){return Ge.factory($.parentContext)});else if(Ge.type===k.BindingTypeEnum.Provider&&Ge.provider!==null)me=K("toProvider",Ge.serviceIdentifier,function(){return Ge.provider($.parentContext)});else if(Ge.type===k.BindingTypeEnum.Instance&&Ge.implementationType!==null)me=F.resolveInstance(Ge.implementationType,Fe,W(G));else{var Xe=ae.getServiceIdentifierAsString($.serviceIdentifier);throw new Error(D.INVALID_BINDING_TYPE+" "+Xe)}return typeof Ge.onActivation=="function"&&(me=Ge.onActivation($.parentContext,me)),Ke&&(Ge.cache=me,Ge.activated=!0),pt&&G!==null&&!G.has(Ge.id)&&G.set(Ge.id,me),me}};function Y(G){var $=W(G.plan.rootRequest.requestScope);return $(G.plan.rootRequest)}fe.resolve=Y},83366:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.BindingInSyntax=void 0;var D=I(28421),k=I(71325),m=function(){function ae(F){this._binding=F}return ae.prototype.inRequestScope=function(){return this._binding.scope=D.BindingScopeEnum.Request,new k.BindingWhenOnSyntax(this._binding)},ae.prototype.inSingletonScope=function(){return this._binding.scope=D.BindingScopeEnum.Singleton,new k.BindingWhenOnSyntax(this._binding)},ae.prototype.inTransientScope=function(){return this._binding.scope=D.BindingScopeEnum.Transient,new k.BindingWhenOnSyntax(this._binding)},ae}();fe.BindingInSyntax=m},99812:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.BindingInWhenOnSyntax=void 0;var D=I(83366),k=I(51811),m=I(98370),ae=function(){function F(K){this._binding=K,this._bindingWhenSyntax=new m.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new k.BindingOnSyntax(this._binding),this._bindingInSyntax=new D.BindingInSyntax(K)}return F.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},F.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},F.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},F.prototype.when=function(K){return this._bindingWhenSyntax.when(K)},F.prototype.whenTargetNamed=function(K){return this._bindingWhenSyntax.whenTargetNamed(K)},F.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},F.prototype.whenTargetTagged=function(K,W){return this._bindingWhenSyntax.whenTargetTagged(K,W)},F.prototype.whenInjectedInto=function(K){return this._bindingWhenSyntax.whenInjectedInto(K)},F.prototype.whenParentNamed=function(K){return this._bindingWhenSyntax.whenParentNamed(K)},F.prototype.whenParentTagged=function(K,W){return this._bindingWhenSyntax.whenParentTagged(K,W)},F.prototype.whenAnyAncestorIs=function(K){return this._bindingWhenSyntax.whenAnyAncestorIs(K)},F.prototype.whenNoAncestorIs=function(K){return this._bindingWhenSyntax.whenNoAncestorIs(K)},F.prototype.whenAnyAncestorNamed=function(K){return this._bindingWhenSyntax.whenAnyAncestorNamed(K)},F.prototype.whenAnyAncestorTagged=function(K,W){return this._bindingWhenSyntax.whenAnyAncestorTagged(K,W)},F.prototype.whenNoAncestorNamed=function(K){return this._bindingWhenSyntax.whenNoAncestorNamed(K)},F.prototype.whenNoAncestorTagged=function(K,W){return this._bindingWhenSyntax.whenNoAncestorTagged(K,W)},F.prototype.whenAnyAncestorMatches=function(K){return this._bindingWhenSyntax.whenAnyAncestorMatches(K)},F.prototype.whenNoAncestorMatches=function(K){return this._bindingWhenSyntax.whenNoAncestorMatches(K)},F.prototype.onActivation=function(K){return this._bindingOnSyntax.onActivation(K)},F}();fe.BindingInWhenOnSyntax=ae},51811:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.BindingOnSyntax=void 0;var D=I(98370),k=function(){function m(ae){this._binding=ae}return m.prototype.onActivation=function(ae){return this._binding.onActivation=ae,new D.BindingWhenSyntax(this._binding)},m}();fe.BindingOnSyntax=k},51860:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.BindingToSyntax=void 0;var D=I(16674),k=I(28421),m=I(99812),ae=I(71325),F=function(){function K(W){this._binding=W}return K.prototype.to=function(W){return this._binding.type=k.BindingTypeEnum.Instance,this._binding.implementationType=W,new m.BindingInWhenOnSyntax(this._binding)},K.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+D.INVALID_TO_SELF_VALUE);var W=this._binding.serviceIdentifier;return this.to(W)},K.prototype.toConstantValue=function(W){return this._binding.type=k.BindingTypeEnum.ConstantValue,this._binding.cache=W,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=k.BindingScopeEnum.Singleton,new ae.BindingWhenOnSyntax(this._binding)},K.prototype.toDynamicValue=function(W){return this._binding.type=k.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=W,this._binding.implementationType=null,new m.BindingInWhenOnSyntax(this._binding)},K.prototype.toConstructor=function(W){return this._binding.type=k.BindingTypeEnum.Constructor,this._binding.implementationType=W,this._binding.scope=k.BindingScopeEnum.Singleton,new ae.BindingWhenOnSyntax(this._binding)},K.prototype.toFactory=function(W){return this._binding.type=k.BindingTypeEnum.Factory,this._binding.factory=W,this._binding.scope=k.BindingScopeEnum.Singleton,new ae.BindingWhenOnSyntax(this._binding)},K.prototype.toFunction=function(W){if(typeof W!="function")throw new Error(D.INVALID_FUNCTION_BINDING);var Y=this.toConstantValue(W);return this._binding.type=k.BindingTypeEnum.Function,this._binding.scope=k.BindingScopeEnum.Singleton,Y},K.prototype.toAutoFactory=function(W){return this._binding.type=k.BindingTypeEnum.Factory,this._binding.factory=function(Y){var G=function(){return Y.container.get(W)};return G},this._binding.scope=k.BindingScopeEnum.Singleton,new ae.BindingWhenOnSyntax(this._binding)},K.prototype.toProvider=function(W){return this._binding.type=k.BindingTypeEnum.Provider,this._binding.provider=W,this._binding.scope=k.BindingScopeEnum.Singleton,new ae.BindingWhenOnSyntax(this._binding)},K.prototype.toService=function(W){this.toDynamicValue(function(Y){return Y.container.get(W)})},K}();fe.BindingToSyntax=F},71325:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.BindingWhenOnSyntax=void 0;var D=I(51811),k=I(98370),m=function(){function ae(F){this._binding=F,this._bindingWhenSyntax=new k.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new D.BindingOnSyntax(this._binding)}return ae.prototype.when=function(F){return this._bindingWhenSyntax.when(F)},ae.prototype.whenTargetNamed=function(F){return this._bindingWhenSyntax.whenTargetNamed(F)},ae.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},ae.prototype.whenTargetTagged=function(F,K){return this._bindingWhenSyntax.whenTargetTagged(F,K)},ae.prototype.whenInjectedInto=function(F){return this._bindingWhenSyntax.whenInjectedInto(F)},ae.prototype.whenParentNamed=function(F){return this._bindingWhenSyntax.whenParentNamed(F)},ae.prototype.whenParentTagged=function(F,K){return this._bindingWhenSyntax.whenParentTagged(F,K)},ae.prototype.whenAnyAncestorIs=function(F){return this._bindingWhenSyntax.whenAnyAncestorIs(F)},ae.prototype.whenNoAncestorIs=function(F){return this._bindingWhenSyntax.whenNoAncestorIs(F)},ae.prototype.whenAnyAncestorNamed=function(F){return this._bindingWhenSyntax.whenAnyAncestorNamed(F)},ae.prototype.whenAnyAncestorTagged=function(F,K){return this._bindingWhenSyntax.whenAnyAncestorTagged(F,K)},ae.prototype.whenNoAncestorNamed=function(F){return this._bindingWhenSyntax.whenNoAncestorNamed(F)},ae.prototype.whenNoAncestorTagged=function(F,K){return this._bindingWhenSyntax.whenNoAncestorTagged(F,K)},ae.prototype.whenAnyAncestorMatches=function(F){return this._bindingWhenSyntax.whenAnyAncestorMatches(F)},ae.prototype.whenNoAncestorMatches=function(F){return this._bindingWhenSyntax.whenNoAncestorMatches(F)},ae.prototype.onActivation=function(F){return this._bindingOnSyntax.onActivation(F)},ae}();fe.BindingWhenOnSyntax=m},98370:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.BindingWhenSyntax=void 0;var D=I(51811),k=I(80758),m=function(){function ae(F){this._binding=F}return ae.prototype.when=function(F){return this._binding.constraint=F,new D.BindingOnSyntax(this._binding)},ae.prototype.whenTargetNamed=function(F){return this._binding.constraint=k.namedConstraint(F),new D.BindingOnSyntax(this._binding)},ae.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(F){var K=F.target!==null&&!F.target.isNamed()&&!F.target.isTagged();return K},new D.BindingOnSyntax(this._binding)},ae.prototype.whenTargetTagged=function(F,K){return this._binding.constraint=k.taggedConstraint(F)(K),new D.BindingOnSyntax(this._binding)},ae.prototype.whenInjectedInto=function(F){return this._binding.constraint=function(K){return k.typeConstraint(F)(K.parentRequest)},new D.BindingOnSyntax(this._binding)},ae.prototype.whenParentNamed=function(F){return this._binding.constraint=function(K){return k.namedConstraint(F)(K.parentRequest)},new D.BindingOnSyntax(this._binding)},ae.prototype.whenParentTagged=function(F,K){return this._binding.constraint=function(W){return k.taggedConstraint(F)(K)(W.parentRequest)},new D.BindingOnSyntax(this._binding)},ae.prototype.whenAnyAncestorIs=function(F){return this._binding.constraint=function(K){return k.traverseAncerstors(K,k.typeConstraint(F))},new D.BindingOnSyntax(this._binding)},ae.prototype.whenNoAncestorIs=function(F){return this._binding.constraint=function(K){return!k.traverseAncerstors(K,k.typeConstraint(F))},new D.BindingOnSyntax(this._binding)},ae.prototype.whenAnyAncestorNamed=function(F){return this._binding.constraint=function(K){return k.traverseAncerstors(K,k.namedConstraint(F))},new D.BindingOnSyntax(this._binding)},ae.prototype.whenNoAncestorNamed=function(F){return this._binding.constraint=function(K){return!k.traverseAncerstors(K,k.namedConstraint(F))},new D.BindingOnSyntax(this._binding)},ae.prototype.whenAnyAncestorTagged=function(F,K){return this._binding.constraint=function(W){return k.traverseAncerstors(W,k.taggedConstraint(F)(K))},new D.BindingOnSyntax(this._binding)},ae.prototype.whenNoAncestorTagged=function(F,K){return this._binding.constraint=function(W){return!k.traverseAncerstors(W,k.taggedConstraint(F)(K))},new D.BindingOnSyntax(this._binding)},ae.prototype.whenAnyAncestorMatches=function(F){return this._binding.constraint=function(K){return k.traverseAncerstors(K,F)},new D.BindingOnSyntax(this._binding)},ae.prototype.whenNoAncestorMatches=function(F){return this._binding.constraint=function(K){return!k.traverseAncerstors(K,F)},new D.BindingOnSyntax(this._binding)},ae}();fe.BindingWhenSyntax=m},80758:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.typeConstraint=fe.namedConstraint=fe.taggedConstraint=fe.traverseAncerstors=void 0;var D=I(6867),k=I(47738),m=function(W,Y){var G=W.parentRequest;return G!==null?Y(G)?!0:m(G,Y):!1};fe.traverseAncerstors=m;var ae=function(W){return function(Y){var G=function($){return $!==null&&$.target!==null&&$.target.matchesTag(W)(Y)};return G.metaData=new k.Metadata(W,Y),G}};fe.taggedConstraint=ae;var F=ae(D.NAMED_TAG);fe.namedConstraint=F;var K=function(W){return function(Y){var G=null;if(Y!==null)if(G=Y.bindings[0],typeof W=="string"){var $=G.serviceIdentifier;return $===W}else{var xe=Y.bindings[0].implementationType;return W===xe}return!1}};fe.typeConstraint=K},70600:function(Ne,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.multiBindToService=void 0;var I=function(D){return function(k){return function(){for(var m=[],ae=0;ae<arguments.length;ae++)m[ae]=arguments[ae];return m.forEach(function(F){return D.bind(F).toService(k)})}}};fe.multiBindToService=I},85265:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.isStackOverflowExeption=void 0;var D=I(16674);function k(m){return m instanceof RangeError||m.message===D.STACK_OVERFLOW}fe.isStackOverflowExeption=k},37791:function(Ne,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.id=void 0;var I=0;function D(){return I++}fe.id=D},55800:function(Ne,fe,I){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.circularDependencyToException=fe.listMetadataForTarget=fe.listRegisteredBindingsForServiceIdentifier=fe.getServiceIdentifierAsString=fe.getFunctionName=void 0;var D=I(16674);function k(G){if(typeof G=="function"){var $=G;return $.name}else{if(typeof G=="symbol")return G.toString();var $=G;return $}}fe.getServiceIdentifierAsString=k;function m(G,$,xe){var Fe="",Ce=xe(G,$);return Ce.length!==0&&(Fe=`
Registered bindings:`,Ce.forEach(function(We){var me="Object";We.implementationType!==null&&(me=Y(We.implementationType)),Fe=Fe+`
 `+me,We.constraint.metaData&&(Fe=Fe+" - "+We.constraint.metaData)})),Fe}fe.listRegisteredBindingsForServiceIdentifier=m;function ae(G,$){return G.parentRequest===null?!1:G.parentRequest.serviceIdentifier===$?!0:ae(G.parentRequest,$)}function F(G){function $(Fe,Ce){Ce===void 0&&(Ce=[]);var We=k(Fe.serviceIdentifier);return Ce.push(We),Fe.parentRequest!==null?$(Fe.parentRequest,Ce):Ce}var xe=$(G);return xe.reverse().join(" --> ")}function K(G){G.childRequests.forEach(function($){if(ae($,$.serviceIdentifier)){var xe=F($);throw new Error(D.CIRCULAR_DEPENDENCY+" "+xe)}else K($)})}fe.circularDependencyToException=K;function W(G,$){if($.isTagged()||$.isNamed()){var xe="",Fe=$.getNamedTag(),Ce=$.getCustomTags();return Fe!==null&&(xe+=Fe.toString()+`
`),Ce!==null&&Ce.forEach(function(We){xe+=We.toString()+`
`})," "+G+`
 `+G+" - "+xe}else return" "+G}fe.listMetadataForTarget=W;function Y(G){if(G.name)return G.name;var $=G.toString(),xe=$.match(/^function\s*([^\s(]+)/);return xe?xe[1]:"Anonymous function: "+$}fe.getFunctionName=Y},31745:function(Ne){"use strict";Ne.exports=I,Ne.exports.default=I;var fe=1e20;function I(F,K,W,Y,G,$){this.fontSize=F||24,this.buffer=K===void 0?3:K,this.cutoff=Y||.25,this.fontFamily=G||"sans-serif",this.fontWeight=$||"normal",this.radius=W||8;var xe=this.size=this.fontSize+this.buffer*2,Fe=xe+this.buffer*2,Ce=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;Ce?this.canvas=my.createOffscreenCanvas(xe,xe,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=xe),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Fe*Fe),this.gridInner=new Float64Array(Fe*Fe),this.f=new Float64Array(Fe),this.z=new Float64Array(Fe+1),this.v=new Uint16Array(Fe),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,Ce?this.middle=Math.round(xe/2*1):this.middle=Math.round(xe/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function D(F,K,W,Y,G,$,xe){$.fill(fe,0,K*W),xe.fill(0,0,K*W);for(var Fe=(K-Y)/2,Ce=0;Ce<G;Ce++)for(var We=0;We<Y;We++){var me=(Ce+Fe)*K+We+Fe,Ge=F.data[4*(Ce*Y+We)+3]/255;if(Ge===1)$[me]=0,xe[me]=fe;else if(Ge===0)$[me]=fe,xe[me]=0;else{var Ke=Math.max(0,.5-Ge),pt=Math.max(0,Ge-.5);$[me]=Ke*Ke,xe[me]=pt*pt}}}function k(F,K,W,Y,G,$,xe){for(var Fe=0;Fe<K*W;Fe++){var Ce=Math.sqrt(Y[Fe])-Math.sqrt(G[Fe]);F[Fe]=Math.round(255-255*(Ce/$+xe))}}I.prototype._draw=function(F,K){var W=this.ctx.measureText(F),Y=W.width,G=2*this.buffer,$,xe,Fe,Ce,We,me,Ge,Ke;K&&this.useMetrics?(We=Math.floor(W.actualBoundingBoxAscent),Ke=this.buffer+Math.ceil(W.actualBoundingBoxAscent),me=this.buffer,Ge=this.buffer,xe=Math.min(this.size,Math.ceil(W.actualBoundingBoxRight-W.actualBoundingBoxLeft)),Ce=Math.min(this.size-me,Math.ceil(W.actualBoundingBoxAscent+W.actualBoundingBoxDescent)),$=xe+G,Fe=Ce+G,this.ctx.textBaseline="alphabetic"):($=xe=this.size,Fe=Ce=this.size,We=19*this.fontSize/24,me=Ge=0,Ke=this.middle,this.ctx.textBaseline="middle");var pt;xe&&Ce&&(this.ctx.clearRect(Ge,me,xe,Ce),this.ctx.fillText(F,this.buffer,Ke),pt=this.ctx.getImageData(Ge,me,xe,Ce));var Xe=new Uint8ClampedArray($*Fe);return D(pt,$,Fe,xe,Ce,this.gridOuter,this.gridInner),m(this.gridOuter,$,Fe,this.f,this.v,this.z),m(this.gridInner,$,Fe,this.f,this.v,this.z),k(Xe,$,Fe,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Xe,metrics:{width:xe,height:Ce,sdfWidth:$,sdfHeight:Fe,top:We,left:0,advance:Y}}},I.prototype.draw=function(F){return this._draw(F,!1).data},I.prototype.drawWithMetrics=function(F){return this._draw(F,!0)};function m(F,K,W,Y,G,$){for(var xe=0;xe<K;xe++)ae(F,xe,K,W,Y,G,$);for(var Fe=0;Fe<W;Fe++)ae(F,Fe*K,1,K,Y,G,$)}function ae(F,K,W,Y,G,$,xe){var Fe,Ce,We,me;for($[0]=0,xe[0]=-fe,xe[1]=fe,Fe=0;Fe<Y;Fe++)G[Fe]=F[K+Fe*W];for(Fe=1,Ce=0,We=0;Fe<Y;Fe++){do me=$[Ce],We=(G[Fe]-G[me]+Fe*Fe-me*me)/(Fe-me)/2;while(We<=xe[Ce]&&--Ce>-1);Ce++,$[Ce]=Fe,xe[Ce]=We,xe[Ce+1]=fe}for(Fe=0,Ce=0;Fe<Y;Fe++){for(;xe[Ce+1]<Fe;)Ce++;me=$[Ce],F[K+Fe*W]=G[me]+(Fe-me)*(Fe-me)}}},51260:function(Ne,fe,I){"use strict";I.r(fe),I.d(fe,{Function:function(){return qn},Interpreter:function(){return Xt},default:function(){return oi},evaluate:function(){return Gn},vm:function(){return D}});var D={};I.r(D),I.d(D,{Script:function(){return Un},compileFunction:function(){return ur},createContext:function(){return nr},runInContext:function(){return Vr},runInNewContext:function(){return ln}});var k={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},m="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",ae={5:m,"5module":m+" export import",6:m+" const class extends export import super"},F=/^in(stanceof)?$/,K="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",W="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",Y=new RegExp("["+K+"]"),G=new RegExp("["+K+W+"]");K=W=null;var $=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],xe=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function Fe(T,H){for(var _e=65536,ne=0;ne<H.length;ne+=2){if(_e+=H[ne],_e>T)return!1;if(_e+=H[ne+1],_e>=T)return!0}}function Ce(T,H){return T<65?T===36:T<91?!0:T<97?T===95:T<123?!0:T<=65535?T>=170&&Y.test(String.fromCharCode(T)):H===!1?!1:Fe(T,$)}function We(T,H){return T<48?T===36:T<58?!0:T<65?!1:T<91?!0:T<97?T===95:T<123?!0:T<=65535?T>=170&&G.test(String.fromCharCode(T)):H===!1?!1:Fe(T,$)||Fe(T,xe)}var me=function(H,_e){_e===void 0&&(_e={}),this.label=H,this.keyword=_e.keyword,this.beforeExpr=!!_e.beforeExpr,this.startsExpr=!!_e.startsExpr,this.isLoop=!!_e.isLoop,this.isAssign=!!_e.isAssign,this.prefix=!!_e.prefix,this.postfix=!!_e.postfix,this.binop=_e.binop||null,this.updateContext=null};function Ge(T,H){return new me(T,{beforeExpr:!0,binop:H})}var Ke={beforeExpr:!0},pt={startsExpr:!0},Xe={};function gt(T,H){return H===void 0&&(H={}),H.keyword=T,Xe[T]=new me(T,H)}var ie={num:new me("num",pt),regexp:new me("regexp",pt),string:new me("string",pt),name:new me("name",pt),eof:new me("eof"),bracketL:new me("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new me("]"),braceL:new me("{",{beforeExpr:!0,startsExpr:!0}),braceR:new me("}"),parenL:new me("(",{beforeExpr:!0,startsExpr:!0}),parenR:new me(")"),comma:new me(",",Ke),semi:new me(";",Ke),colon:new me(":",Ke),dot:new me("."),question:new me("?",Ke),questionDot:new me("?."),arrow:new me("=>",Ke),template:new me("template"),invalidTemplate:new me("invalidTemplate"),ellipsis:new me("...",Ke),backQuote:new me("`",pt),dollarBraceL:new me("${",{beforeExpr:!0,startsExpr:!0}),eq:new me("=",{beforeExpr:!0,isAssign:!0}),assign:new me("_=",{beforeExpr:!0,isAssign:!0}),incDec:new me("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new me("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Ge("||",1),logicalAND:Ge("&&",2),bitwiseOR:Ge("|",3),bitwiseXOR:Ge("^",4),bitwiseAND:Ge("&",5),equality:Ge("==/!=/===/!==",6),relational:Ge("</>/<=/>=",7),bitShift:Ge("<</>>/>>>",8),plusMin:new me("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Ge("%",10),star:Ge("*",10),slash:Ge("/",10),starstar:new me("**",{beforeExpr:!0}),coalesce:Ge("??",1),_break:gt("break"),_case:gt("case",Ke),_catch:gt("catch"),_continue:gt("continue"),_debugger:gt("debugger"),_default:gt("default",Ke),_do:gt("do",{isLoop:!0,beforeExpr:!0}),_else:gt("else",Ke),_finally:gt("finally"),_for:gt("for",{isLoop:!0}),_function:gt("function",pt),_if:gt("if"),_return:gt("return",Ke),_switch:gt("switch"),_throw:gt("throw",Ke),_try:gt("try"),_var:gt("var"),_const:gt("const"),_while:gt("while",{isLoop:!0}),_with:gt("with"),_new:gt("new",{beforeExpr:!0,startsExpr:!0}),_this:gt("this",pt),_super:gt("super",pt),_class:gt("class",pt),_extends:gt("extends",Ke),_export:gt("export"),_import:gt("import",pt),_null:gt("null",pt),_true:gt("true",pt),_false:gt("false",pt),_in:gt("in",{beforeExpr:!0,binop:7}),_instanceof:gt("instanceof",{beforeExpr:!0,binop:7}),_typeof:gt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:gt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:gt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},ft=/\r\n?|\n|\u2028|\u2029/,ve=new RegExp(ft.source,"g");function Ae(T,H){return T===10||T===13||!H&&(T===8232||T===8233)}var Re=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ye=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,at=Object.prototype,ht=at.hasOwnProperty,Se=at.toString;function Qe(T,H){return ht.call(T,H)}var oe=Array.isArray||function(T){return Se.call(T)==="[object Array]"};function ue(T){return new RegExp("^(?:"+T.replace(/ /g,"|")+")$")}var be=function(H,_e){this.line=H,this.column=_e};be.prototype.offset=function(H){return new be(this.line,this.column+H)};var vt=function(H,_e,ne){this.start=_e,this.end=ne,H.sourceFile!==null&&(this.source=H.sourceFile)};function bt(T,H){for(var _e=1,ne=0;;){ve.lastIndex=ne;var $e=ve.exec(T);if($e&&$e.index<H)++_e,ne=$e.index+$e[0].length;else return new be(_e,H-ne)}}var Ht={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function Er(T){var H={};for(var _e in Ht)H[_e]=T&&Qe(T,_e)?T[_e]:Ht[_e];if(H.ecmaVersion>=2015&&(H.ecmaVersion-=2009),H.allowReserved==null&&(H.allowReserved=H.ecmaVersion<5),oe(H.onToken)){var ne=H.onToken;H.onToken=function($e){return ne.push($e)}}return oe(H.onComment)&&(H.onComment=Vt(H,H.onComment)),H}function Vt(T,H){return function(_e,ne,$e,xt,zt,_r){var xr={type:_e?"Block":"Line",value:ne,start:$e,end:xt};T.locations&&(xr.loc=new vt(this,zt,_r)),T.ranges&&(xr.range=[$e,xt]),H.push(xr)}}var on=1,hn=2,gi=on|hn,Hn=4,Dt=8,Ea=16,Ze=32,ci=64,Ci=128;function Oi(T,H){return hn|(T?Hn:0)|(H?Dt:0)}var ea=0,fn=1,tn=2,da=3,Ii=4,Ai=5,Pr=function(H,_e,ne){this.options=H=Er(H),this.sourceFile=H.sourceFile,this.keywords=ue(ae[H.ecmaVersion>=6?6:H.sourceType==="module"?"5module":5]);var $e="";if(H.allowReserved!==!0){for(var xt=H.ecmaVersion;!($e=k[xt]);xt--);H.sourceType==="module"&&($e+=" await")}this.reservedWords=ue($e);var zt=($e?$e+" ":"")+k.strict;this.reservedWordsStrict=ue(zt),this.reservedWordsStrictBind=ue(zt+" "+k.strictBind),this.input=String(_e),this.containsEsc=!1,ne?(this.pos=ne,this.lineStart=this.input.lastIndexOf(`
`,ne-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(ft).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=ie.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=H.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&H.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(on),this.regexpState=null},nt={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};Pr.prototype.parse=function(){var H=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(H)},nt.inFunction.get=function(){return(this.currentVarScope().flags&hn)>0},nt.inGenerator.get=function(){return(this.currentVarScope().flags&Dt)>0},nt.inAsync.get=function(){return(this.currentVarScope().flags&Hn)>0},nt.allowSuper.get=function(){return(this.currentThisScope().flags&ci)>0},nt.allowDirectSuper.get=function(){return(this.currentThisScope().flags&Ci)>0},nt.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},Pr.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&hn)>0},Pr.extend=function(){for(var H=[],_e=arguments.length;_e--;)H[_e]=arguments[_e];for(var ne=this,$e=0;$e<H.length;$e++)ne=H[$e](ne);return ne},Pr.parse=function(H,_e){return new this(_e,H).parse()},Pr.parseExpressionAt=function(H,_e,ne){var $e=new this(ne,H,_e);return $e.nextToken(),$e.parseExpression()},Pr.tokenizer=function(H,_e){return new this(_e,H)},Object.defineProperties(Pr.prototype,nt);var it=Pr.prototype,_t=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;it.strictDirective=function(T){for(;;){Ye.lastIndex=T,T+=Ye.exec(this.input)[0].length;var H=_t.exec(this.input.slice(T));if(!H)return!1;if((H[1]||H[2])==="use strict"){Ye.lastIndex=T+H[0].length;var _e=Ye.exec(this.input),ne=_e.index+_e[0].length,$e=this.input.charAt(ne);return $e===";"||$e==="}"||ft.test(_e[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test($e)||$e==="!"&&this.input.charAt(ne+1)==="=")}T+=H[0].length,Ye.lastIndex=T,T+=Ye.exec(this.input)[0].length,this.input[T]===";"&&T++}},it.eat=function(T){return this.type===T?(this.next(),!0):!1},it.isContextual=function(T){return this.type===ie.name&&this.value===T&&!this.containsEsc},it.eatContextual=function(T){return this.isContextual(T)?(this.next(),!0):!1},it.expectContextual=function(T){this.eatContextual(T)||this.unexpected()},it.canInsertSemicolon=function(){return this.type===ie.eof||this.type===ie.braceR||ft.test(this.input.slice(this.lastTokEnd,this.start))},it.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},it.semicolon=function(){!this.eat(ie.semi)&&!this.insertSemicolon()&&this.unexpected()},it.afterTrailingComma=function(T,H){if(this.type===T)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),H||this.next(),!0},it.expect=function(T){this.eat(T)||this.unexpected()},it.unexpected=function(T){this.raise(T!=null?T:this.start,"Unexpected token")};function we(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}it.checkPatternErrors=function(T,H){if(T){T.trailingComma>-1&&this.raiseRecoverable(T.trailingComma,"Comma is not permitted after the rest element");var _e=H?T.parenthesizedAssign:T.parenthesizedBind;_e>-1&&this.raiseRecoverable(_e,"Parenthesized pattern")}},it.checkExpressionErrors=function(T,H){if(!T)return!1;var _e=T.shorthandAssign,ne=T.doubleProto;if(!H)return _e>=0||ne>=0;_e>=0&&this.raise(_e,"Shorthand property assignments are valid only in destructuring patterns"),ne>=0&&this.raiseRecoverable(ne,"Redefinition of __proto__ property")},it.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},it.isSimpleAssignTarget=function(T){return T.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(T.expression):T.type==="Identifier"||T.type==="MemberExpression"};var er=Pr.prototype;er.parseTopLevel=function(T){var H={};for(T.body||(T.body=[]);this.type!==ie.eof;){var _e=this.parseStatement(null,!0,H);T.body.push(_e)}if(this.inModule)for(var ne=0,$e=Object.keys(this.undefinedExports);ne<$e.length;ne+=1){var xt=$e[ne];this.raiseRecoverable(this.undefinedExports[xt].start,"Export '"+xt+"' is not defined")}return this.adaptDirectivePrologue(T.body),this.next(),T.sourceType=this.options.sourceType,this.finishNode(T,"Program")};var $r={kind:"loop"},Fn={kind:"switch"};er.isLet=function(T){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Ye.lastIndex=this.pos;var H=Ye.exec(this.input),_e=this.pos+H[0].length,ne=this.input.charCodeAt(_e);if(ne===91)return!0;if(T)return!1;if(ne===123)return!0;if(Ce(ne,!0)){for(var $e=_e+1;We(this.input.charCodeAt($e),!0);)++$e;var xt=this.input.slice(_e,$e);if(!F.test(xt))return!0}return!1},er.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Ye.lastIndex=this.pos;var T=Ye.exec(this.input),H=this.pos+T[0].length;return!ft.test(this.input.slice(this.pos,H))&&this.input.slice(H,H+8)==="function"&&(H+8===this.input.length||!We(this.input.charAt(H+8)))},er.parseStatement=function(T,H,_e){var ne=this.type,$e=this.startNode(),xt;switch(this.isLet(T)&&(ne=ie._var,xt="let"),ne){case ie._break:case ie._continue:return this.parseBreakContinueStatement($e,ne.keyword);case ie._debugger:return this.parseDebuggerStatement($e);case ie._do:return this.parseDoStatement($e);case ie._for:return this.parseForStatement($e);case ie._function:return T&&(this.strict||T!=="if"&&T!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement($e,!1,!T);case ie._class:return T&&this.unexpected(),this.parseClass($e,!0);case ie._if:return this.parseIfStatement($e);case ie._return:return this.parseReturnStatement($e);case ie._switch:return this.parseSwitchStatement($e);case ie._throw:return this.parseThrowStatement($e);case ie._try:return this.parseTryStatement($e);case ie._const:case ie._var:return xt=xt||this.value,T&&xt!=="var"&&this.unexpected(),this.parseVarStatement($e,xt);case ie._while:return this.parseWhileStatement($e);case ie._with:return this.parseWithStatement($e);case ie.braceL:return this.parseBlock(!0,$e);case ie.semi:return this.parseEmptyStatement($e);case ie._export:case ie._import:if(this.options.ecmaVersion>10&&ne===ie._import){Ye.lastIndex=this.pos;var zt=Ye.exec(this.input),_r=this.pos+zt[0].length,xr=this.input.charCodeAt(_r);if(xr===40||xr===46)return this.parseExpressionStatement($e,this.parseExpression())}return this.options.allowImportExportEverywhere||(H||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),ne===ie._import?this.parseImport($e):this.parseExport($e,_e);default:if(this.isAsyncFunction())return T&&this.unexpected(),this.next(),this.parseFunctionStatement($e,!0,!T);var dn=this.value,Bn=this.parseExpression();return ne===ie.name&&Bn.type==="Identifier"&&this.eat(ie.colon)?this.parseLabeledStatement($e,dn,Bn,T):this.parseExpressionStatement($e,Bn)}},er.parseBreakContinueStatement=function(T,H){var _e=H==="break";this.next(),this.eat(ie.semi)||this.insertSemicolon()?T.label=null:this.type!==ie.name?this.unexpected():(T.label=this.parseIdent(),this.semicolon());for(var ne=0;ne<this.labels.length;++ne){var $e=this.labels[ne];if((T.label==null||$e.name===T.label.name)&&($e.kind!=null&&(_e||$e.kind==="loop")||T.label&&_e))break}return ne===this.labels.length&&this.raise(T.start,"Unsyntactic "+H),this.finishNode(T,_e?"BreakStatement":"ContinueStatement")},er.parseDebuggerStatement=function(T){return this.next(),this.semicolon(),this.finishNode(T,"DebuggerStatement")},er.parseDoStatement=function(T){return this.next(),this.labels.push($r),T.body=this.parseStatement("do"),this.labels.pop(),this.expect(ie._while),T.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(ie.semi):this.semicolon(),this.finishNode(T,"DoWhileStatement")},er.parseForStatement=function(T){this.next();var H=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push($r),this.enterScope(0),this.expect(ie.parenL),this.type===ie.semi)return H>-1&&this.unexpected(H),this.parseFor(T,null);var _e=this.isLet();if(this.type===ie._var||this.type===ie._const||_e){var ne=this.startNode(),$e=_e?"let":this.value;return this.next(),this.parseVar(ne,!0,$e),this.finishNode(ne,"VariableDeclaration"),(this.type===ie._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&ne.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===ie._in?H>-1&&this.unexpected(H):T.await=H>-1),this.parseForIn(T,ne)):(H>-1&&this.unexpected(H),this.parseFor(T,ne))}var xt=new we,zt=this.parseExpression(!0,xt);return this.type===ie._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===ie._in?H>-1&&this.unexpected(H):T.await=H>-1),this.toAssignable(zt,!1,xt),this.checkLVal(zt),this.parseForIn(T,zt)):(this.checkExpressionErrors(xt,!0),H>-1&&this.unexpected(H),this.parseFor(T,zt))},er.parseFunctionStatement=function(T,H,_e){return this.next(),this.parseFunction(T,Br|(_e?0:bn),!1,H)},er.parseIfStatement=function(T){return this.next(),T.test=this.parseParenExpression(),T.consequent=this.parseStatement("if"),T.alternate=this.eat(ie._else)?this.parseStatement("if"):null,this.finishNode(T,"IfStatement")},er.parseReturnStatement=function(T){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(ie.semi)||this.insertSemicolon()?T.argument=null:(T.argument=this.parseExpression(),this.semicolon()),this.finishNode(T,"ReturnStatement")},er.parseSwitchStatement=function(T){this.next(),T.discriminant=this.parseParenExpression(),T.cases=[],this.expect(ie.braceL),this.labels.push(Fn),this.enterScope(0);for(var H,_e=!1;this.type!==ie.braceR;)if(this.type===ie._case||this.type===ie._default){var ne=this.type===ie._case;H&&this.finishNode(H,"SwitchCase"),T.cases.push(H=this.startNode()),H.consequent=[],this.next(),ne?H.test=this.parseExpression():(_e&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),_e=!0,H.test=null),this.expect(ie.colon)}else H||this.unexpected(),H.consequent.push(this.parseStatement(null));return this.exitScope(),H&&this.finishNode(H,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(T,"SwitchStatement")},er.parseThrowStatement=function(T){return this.next(),ft.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),T.argument=this.parseExpression(),this.semicolon(),this.finishNode(T,"ThrowStatement")};var Qt=[];er.parseTryStatement=function(T){if(this.next(),T.block=this.parseBlock(),T.handler=null,this.type===ie._catch){var H=this.startNode();if(this.next(),this.eat(ie.parenL)){H.param=this.parseBindingAtom();var _e=H.param.type==="Identifier";this.enterScope(_e?Ze:0),this.checkLVal(H.param,_e?Ii:tn),this.expect(ie.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),H.param=null,this.enterScope(0);H.body=this.parseBlock(!1),this.exitScope(),T.handler=this.finishNode(H,"CatchClause")}return T.finalizer=this.eat(ie._finally)?this.parseBlock():null,!T.handler&&!T.finalizer&&this.raise(T.start,"Missing catch or finally clause"),this.finishNode(T,"TryStatement")},er.parseVarStatement=function(T,H){return this.next(),this.parseVar(T,!1,H),this.semicolon(),this.finishNode(T,"VariableDeclaration")},er.parseWhileStatement=function(T){return this.next(),T.test=this.parseParenExpression(),this.labels.push($r),T.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(T,"WhileStatement")},er.parseWithStatement=function(T){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),T.object=this.parseParenExpression(),T.body=this.parseStatement("with"),this.finishNode(T,"WithStatement")},er.parseEmptyStatement=function(T){return this.next(),this.finishNode(T,"EmptyStatement")},er.parseLabeledStatement=function(T,H,_e,ne){for(var $e=0,xt=this.labels;$e<xt.length;$e+=1){var zt=xt[$e];zt.name===H&&this.raise(_e.start,"Label '"+H+"' is already declared")}for(var _r=this.type.isLoop?"loop":this.type===ie._switch?"switch":null,xr=this.labels.length-1;xr>=0;xr--){var dn=this.labels[xr];if(dn.statementStart===T.start)dn.statementStart=this.start,dn.kind=_r;else break}return this.labels.push({name:H,kind:_r,statementStart:this.start}),T.body=this.parseStatement(ne?ne.indexOf("label")===-1?ne+"label":ne:"label"),this.labels.pop(),T.label=_e,this.finishNode(T,"LabeledStatement")},er.parseExpressionStatement=function(T,H){return T.expression=H,this.semicolon(),this.finishNode(T,"ExpressionStatement")},er.parseBlock=function(T,H,_e){for(T===void 0&&(T=!0),H===void 0&&(H=this.startNode()),H.body=[],this.expect(ie.braceL),T&&this.enterScope(0);this.type!==ie.braceR;){var ne=this.parseStatement(null);H.body.push(ne)}return _e&&(this.strict=!1),this.next(),T&&this.exitScope(),this.finishNode(H,"BlockStatement")},er.parseFor=function(T,H){return T.init=H,this.expect(ie.semi),T.test=this.type===ie.semi?null:this.parseExpression(),this.expect(ie.semi),T.update=this.type===ie.parenR?null:this.parseExpression(),this.expect(ie.parenR),T.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(T,"ForStatement")},er.parseForIn=function(T,H){var _e=this.type===ie._in;return this.next(),H.type==="VariableDeclaration"&&H.declarations[0].init!=null&&(!_e||this.options.ecmaVersion<8||this.strict||H.kind!=="var"||H.declarations[0].id.type!=="Identifier")?this.raise(H.start,(_e?"for-in":"for-of")+" loop variable declaration may not have an initializer"):H.type==="AssignmentPattern"&&this.raise(H.start,"Invalid left-hand side in for-loop"),T.left=H,T.right=_e?this.parseExpression():this.parseMaybeAssign(),this.expect(ie.parenR),T.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(T,_e?"ForInStatement":"ForOfStatement")},er.parseVar=function(T,H,_e){for(T.declarations=[],T.kind=_e;;){var ne=this.startNode();if(this.parseVarId(ne,_e),this.eat(ie.eq)?ne.init=this.parseMaybeAssign(H):_e==="const"&&!(this.type===ie._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():ne.id.type!=="Identifier"&&!(H&&(this.type===ie._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):ne.init=null,T.declarations.push(this.finishNode(ne,"VariableDeclarator")),!this.eat(ie.comma))break}return T},er.parseVarId=function(T,H){T.id=this.parseBindingAtom(),this.checkLVal(T.id,H==="var"?fn:tn,!1)};var Br=1,bn=2,gr=4;er.parseFunction=function(T,H,_e,ne){this.initFunction(T),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!ne)&&(this.type===ie.star&&H&bn&&this.unexpected(),T.generator=this.eat(ie.star)),this.options.ecmaVersion>=8&&(T.async=!!ne),H&Br&&(T.id=H&gr&&this.type!==ie.name?null:this.parseIdent(),T.id&&!(H&bn)&&this.checkLVal(T.id,this.strict||T.generator||T.async?this.treatFunctionsAsVar?fn:tn:da));var $e=this.yieldPos,xt=this.awaitPos,zt=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Oi(T.async,T.generator)),H&Br||(T.id=this.type===ie.name?this.parseIdent():null),this.parseFunctionParams(T),this.parseFunctionBody(T,_e,!1),this.yieldPos=$e,this.awaitPos=xt,this.awaitIdentPos=zt,this.finishNode(T,H&Br?"FunctionDeclaration":"FunctionExpression")},er.parseFunctionParams=function(T){this.expect(ie.parenL),T.params=this.parseBindingList(ie.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},er.parseClass=function(T,H){this.next();var _e=this.strict;this.strict=!0,this.parseClassId(T,H),this.parseClassSuper(T);var ne=this.startNode(),$e=!1;for(ne.body=[],this.expect(ie.braceL);this.type!==ie.braceR;){var xt=this.parseClassElement(T.superClass!==null);xt&&(ne.body.push(xt),xt.type==="MethodDefinition"&&xt.kind==="constructor"&&($e&&this.raise(xt.start,"Duplicate constructor in the same class"),$e=!0))}return this.strict=_e,this.next(),T.body=this.finishNode(ne,"ClassBody"),this.finishNode(T,H?"ClassDeclaration":"ClassExpression")},er.parseClassElement=function(T){var H=this;if(this.eat(ie.semi))return null;var _e=this.startNode(),ne=function(xr,dn){dn===void 0&&(dn=!1);var Bn=H.start,zi=H.startLoc;return H.eatContextual(xr)?H.type!==ie.parenL&&(!dn||!H.canInsertSemicolon())?!0:(_e.key&&H.unexpected(),_e.computed=!1,_e.key=H.startNodeAt(Bn,zi),_e.key.name=xr,H.finishNode(_e.key,"Identifier"),!1):!1};_e.kind="method",_e.static=ne("static");var $e=this.eat(ie.star),xt=!1;$e||(this.options.ecmaVersion>=8&&ne("async",!0)?(xt=!0,$e=this.options.ecmaVersion>=9&&this.eat(ie.star)):ne("get")?_e.kind="get":ne("set")&&(_e.kind="set")),_e.key||this.parsePropertyName(_e);var zt=_e.key,_r=!1;return!_e.computed&&!_e.static&&(zt.type==="Identifier"&&zt.name==="constructor"||zt.type==="Literal"&&zt.value==="constructor")?(_e.kind!=="method"&&this.raise(zt.start,"Constructor can't have get/set modifier"),$e&&this.raise(zt.start,"Constructor can't be a generator"),xt&&this.raise(zt.start,"Constructor can't be an async method"),_e.kind="constructor",_r=T):_e.static&&zt.type==="Identifier"&&zt.name==="prototype"&&this.raise(zt.start,"Classes may not have a static property named prototype"),this.parseClassMethod(_e,$e,xt,_r),_e.kind==="get"&&_e.value.params.length!==0&&this.raiseRecoverable(_e.value.start,"getter should have no params"),_e.kind==="set"&&_e.value.params.length!==1&&this.raiseRecoverable(_e.value.start,"setter should have exactly one param"),_e.kind==="set"&&_e.value.params[0].type==="RestElement"&&this.raiseRecoverable(_e.value.params[0].start,"Setter cannot use rest params"),_e},er.parseClassMethod=function(T,H,_e,ne){return T.value=this.parseMethod(H,_e,ne),this.finishNode(T,"MethodDefinition")},er.parseClassId=function(T,H){this.type===ie.name?(T.id=this.parseIdent(),H&&this.checkLVal(T.id,tn,!1)):(H===!0&&this.unexpected(),T.id=null)},er.parseClassSuper=function(T){T.superClass=this.eat(ie._extends)?this.parseExprSubscripts():null},er.parseExport=function(T,H){if(this.next(),this.eat(ie.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(T.exported=this.parseIdent(!0),this.checkExport(H,T.exported.name,this.lastTokStart)):T.exported=null),this.expectContextual("from"),this.type!==ie.string&&this.unexpected(),T.source=this.parseExprAtom(),this.semicolon(),this.finishNode(T,"ExportAllDeclaration");if(this.eat(ie._default)){this.checkExport(H,"default",this.lastTokStart);var _e;if(this.type===ie._function||(_e=this.isAsyncFunction())){var ne=this.startNode();this.next(),_e&&this.next(),T.declaration=this.parseFunction(ne,Br|gr,!1,_e)}else if(this.type===ie._class){var $e=this.startNode();T.declaration=this.parseClass($e,"nullableID")}else T.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(T,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())T.declaration=this.parseStatement(null),T.declaration.type==="VariableDeclaration"?this.checkVariableExport(H,T.declaration.declarations):this.checkExport(H,T.declaration.id.name,T.declaration.id.start),T.specifiers=[],T.source=null;else{if(T.declaration=null,T.specifiers=this.parseExportSpecifiers(H),this.eatContextual("from"))this.type!==ie.string&&this.unexpected(),T.source=this.parseExprAtom();else{for(var xt=0,zt=T.specifiers;xt<zt.length;xt+=1){var _r=zt[xt];this.checkUnreserved(_r.local),this.checkLocalExport(_r.local)}T.source=null}this.semicolon()}return this.finishNode(T,"ExportNamedDeclaration")},er.checkExport=function(T,H,_e){T&&(Qe(T,H)&&this.raiseRecoverable(_e,"Duplicate export '"+H+"'"),T[H]=!0)},er.checkPatternExport=function(T,H){var _e=H.type;if(_e==="Identifier")this.checkExport(T,H.name,H.start);else if(_e==="ObjectPattern")for(var ne=0,$e=H.properties;ne<$e.length;ne+=1){var xt=$e[ne];this.checkPatternExport(T,xt)}else if(_e==="ArrayPattern")for(var zt=0,_r=H.elements;zt<_r.length;zt+=1){var xr=_r[zt];xr&&this.checkPatternExport(T,xr)}else _e==="Property"?this.checkPatternExport(T,H.value):_e==="AssignmentPattern"?this.checkPatternExport(T,H.left):_e==="RestElement"?this.checkPatternExport(T,H.argument):_e==="ParenthesizedExpression"&&this.checkPatternExport(T,H.expression)},er.checkVariableExport=function(T,H){if(T)for(var _e=0,ne=H;_e<ne.length;_e+=1){var $e=ne[_e];this.checkPatternExport(T,$e.id)}},er.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},er.parseExportSpecifiers=function(T){var H=[],_e=!0;for(this.expect(ie.braceL);!this.eat(ie.braceR);){if(_e)_e=!1;else if(this.expect(ie.comma),this.afterTrailingComma(ie.braceR))break;var ne=this.startNode();ne.local=this.parseIdent(!0),ne.exported=this.eatContextual("as")?this.parseIdent(!0):ne.local,this.checkExport(T,ne.exported.name,ne.exported.start),H.push(this.finishNode(ne,"ExportSpecifier"))}return H},er.parseImport=function(T){return this.next(),this.type===ie.string?(T.specifiers=Qt,T.source=this.parseExprAtom()):(T.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),T.source=this.type===ie.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(T,"ImportDeclaration")},er.parseImportSpecifiers=function(){var T=[],H=!0;if(this.type===ie.name){var _e=this.startNode();if(_e.local=this.parseIdent(),this.checkLVal(_e.local,tn),T.push(this.finishNode(_e,"ImportDefaultSpecifier")),!this.eat(ie.comma))return T}if(this.type===ie.star){var ne=this.startNode();return this.next(),this.expectContextual("as"),ne.local=this.parseIdent(),this.checkLVal(ne.local,tn),T.push(this.finishNode(ne,"ImportNamespaceSpecifier")),T}for(this.expect(ie.braceL);!this.eat(ie.braceR);){if(H)H=!1;else if(this.expect(ie.comma),this.afterTrailingComma(ie.braceR))break;var $e=this.startNode();$e.imported=this.parseIdent(!0),this.eatContextual("as")?$e.local=this.parseIdent():(this.checkUnreserved($e.imported),$e.local=$e.imported),this.checkLVal($e.local,tn),T.push(this.finishNode($e,"ImportSpecifier"))}return T},er.adaptDirectivePrologue=function(T){for(var H=0;H<T.length&&this.isDirectiveCandidate(T[H]);++H)T[H].directive=T[H].expression.raw.slice(1,-1)},er.isDirectiveCandidate=function(T){return T.type==="ExpressionStatement"&&T.expression.type==="Literal"&&typeof T.expression.value=="string"&&(this.input[T.start]==='"'||this.input[T.start]==="'")};var pn=Pr.prototype;pn.toAssignable=function(T,H,_e){if(this.options.ecmaVersion>=6&&T)switch(T.type){case"Identifier":this.inAsync&&T.name==="await"&&this.raise(T.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":T.type="ObjectPattern",_e&&this.checkPatternErrors(_e,!0);for(var ne=0,$e=T.properties;ne<$e.length;ne+=1){var xt=$e[ne];this.toAssignable(xt,H),xt.type==="RestElement"&&(xt.argument.type==="ArrayPattern"||xt.argument.type==="ObjectPattern")&&this.raise(xt.argument.start,"Unexpected token")}break;case"Property":T.kind!=="init"&&this.raise(T.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(T.value,H);break;case"ArrayExpression":T.type="ArrayPattern",_e&&this.checkPatternErrors(_e,!0),this.toAssignableList(T.elements,H);break;case"SpreadElement":T.type="RestElement",this.toAssignable(T.argument,H),T.argument.type==="AssignmentPattern"&&this.raise(T.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":T.operator!=="="&&this.raise(T.left.end,"Only '=' operator can be used for specifying default value."),T.type="AssignmentPattern",delete T.operator,this.toAssignable(T.left,H);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(T.expression,H,_e);break;case"ChainExpression":this.raiseRecoverable(T.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!H)break;default:this.raise(T.start,"Assigning to rvalue")}else _e&&this.checkPatternErrors(_e,!0);return T},pn.toAssignableList=function(T,H){for(var _e=T.length,ne=0;ne<_e;ne++){var $e=T[ne];$e&&this.toAssignable($e,H)}if(_e){var xt=T[_e-1];this.options.ecmaVersion===6&&H&&xt&&xt.type==="RestElement"&&xt.argument.type!=="Identifier"&&this.unexpected(xt.argument.start)}return T},pn.parseSpread=function(T){var H=this.startNode();return this.next(),H.argument=this.parseMaybeAssign(!1,T),this.finishNode(H,"SpreadElement")},pn.parseRestBinding=function(){var T=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==ie.name&&this.unexpected(),T.argument=this.parseBindingAtom(),this.finishNode(T,"RestElement")},pn.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case ie.bracketL:var T=this.startNode();return this.next(),T.elements=this.parseBindingList(ie.bracketR,!0,!0),this.finishNode(T,"ArrayPattern");case ie.braceL:return this.parseObj(!0)}return this.parseIdent()},pn.parseBindingList=function(T,H,_e){for(var ne=[],$e=!0;!this.eat(T);)if($e?$e=!1:this.expect(ie.comma),H&&this.type===ie.comma)ne.push(null);else{if(_e&&this.afterTrailingComma(T))break;if(this.type===ie.ellipsis){var xt=this.parseRestBinding();this.parseBindingListItem(xt),ne.push(xt),this.type===ie.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(T);break}else{var zt=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(zt),ne.push(zt)}}return ne},pn.parseBindingListItem=function(T){return T},pn.parseMaybeDefault=function(T,H,_e){if(_e=_e||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(ie.eq))return _e;var ne=this.startNodeAt(T,H);return ne.left=_e,ne.right=this.parseMaybeAssign(),this.finishNode(ne,"AssignmentPattern")},pn.checkLVal=function(T,H,_e){switch(H===void 0&&(H=ea),T.type){case"Identifier":H===tn&&T.name==="let"&&this.raiseRecoverable(T.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(T.name)&&this.raiseRecoverable(T.start,(H?"Binding ":"Assigning to ")+T.name+" in strict mode"),_e&&(Qe(_e,T.name)&&this.raiseRecoverable(T.start,"Argument name clash"),_e[T.name]=!0),H!==ea&&H!==Ai&&this.declareName(T.name,H,T.start);break;case"ChainExpression":this.raiseRecoverable(T.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":H&&this.raiseRecoverable(T.start,"Binding member expression");break;case"ObjectPattern":for(var ne=0,$e=T.properties;ne<$e.length;ne+=1){var xt=$e[ne];this.checkLVal(xt,H,_e)}break;case"Property":this.checkLVal(T.value,H,_e);break;case"ArrayPattern":for(var zt=0,_r=T.elements;zt<_r.length;zt+=1){var xr=_r[zt];xr&&this.checkLVal(xr,H,_e)}break;case"AssignmentPattern":this.checkLVal(T.left,H,_e);break;case"RestElement":this.checkLVal(T.argument,H,_e);break;case"ParenthesizedExpression":this.checkLVal(T.expression,H,_e);break;default:this.raise(T.start,(H?"Binding":"Assigning to")+" rvalue")}};var Sn=Pr.prototype;Sn.checkPropClash=function(T,H,_e){if(!(this.options.ecmaVersion>=9&&T.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(T.computed||T.method||T.shorthand))){var ne=T.key,$e;switch(ne.type){case"Identifier":$e=ne.name;break;case"Literal":$e=String(ne.value);break;default:return}var xt=T.kind;if(this.options.ecmaVersion>=6){$e==="__proto__"&&xt==="init"&&(H.proto&&(_e?_e.doubleProto<0&&(_e.doubleProto=ne.start):this.raiseRecoverable(ne.start,"Redefinition of __proto__ property")),H.proto=!0);return}$e="$"+$e;var zt=H[$e];if(zt){var _r;xt==="init"?_r=this.strict&&zt.init||zt.get||zt.set:_r=zt.init||zt[xt],_r&&this.raiseRecoverable(ne.start,"Redefinition of property")}else zt=H[$e]={init:!1,get:!1,set:!1};zt[xt]=!0}},Sn.parseExpression=function(T,H){var _e=this.start,ne=this.startLoc,$e=this.parseMaybeAssign(T,H);if(this.type===ie.comma){var xt=this.startNodeAt(_e,ne);for(xt.expressions=[$e];this.eat(ie.comma);)xt.expressions.push(this.parseMaybeAssign(T,H));return this.finishNode(xt,"SequenceExpression")}return $e},Sn.parseMaybeAssign=function(T,H,_e){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(T);this.exprAllowed=!1}var ne=!1,$e=-1,xt=-1;H?($e=H.parenthesizedAssign,xt=H.trailingComma,H.parenthesizedAssign=H.trailingComma=-1):(H=new we,ne=!0);var zt=this.start,_r=this.startLoc;(this.type===ie.parenL||this.type===ie.name)&&(this.potentialArrowAt=this.start);var xr=this.parseMaybeConditional(T,H);if(_e&&(xr=_e.call(this,xr,zt,_r)),this.type.isAssign){var dn=this.startNodeAt(zt,_r);return dn.operator=this.value,dn.left=this.type===ie.eq?this.toAssignable(xr,!1,H):xr,ne||(H.parenthesizedAssign=H.trailingComma=H.doubleProto=-1),H.shorthandAssign>=dn.left.start&&(H.shorthandAssign=-1),this.checkLVal(xr),this.next(),dn.right=this.parseMaybeAssign(T),this.finishNode(dn,"AssignmentExpression")}else ne&&this.checkExpressionErrors(H,!0);return $e>-1&&(H.parenthesizedAssign=$e),xt>-1&&(H.trailingComma=xt),xr},Sn.parseMaybeConditional=function(T,H){var _e=this.start,ne=this.startLoc,$e=this.parseExprOps(T,H);if(this.checkExpressionErrors(H))return $e;if(this.eat(ie.question)){var xt=this.startNodeAt(_e,ne);return xt.test=$e,xt.consequent=this.parseMaybeAssign(),this.expect(ie.colon),xt.alternate=this.parseMaybeAssign(T),this.finishNode(xt,"ConditionalExpression")}return $e},Sn.parseExprOps=function(T,H){var _e=this.start,ne=this.startLoc,$e=this.parseMaybeUnary(H,!1);return this.checkExpressionErrors(H)||$e.start===_e&&$e.type==="ArrowFunctionExpression"?$e:this.parseExprOp($e,_e,ne,-1,T)},Sn.parseExprOp=function(T,H,_e,ne,$e){var xt=this.type.binop;if(xt!=null&&(!$e||this.type!==ie._in)&&xt>ne){var zt=this.type===ie.logicalOR||this.type===ie.logicalAND,_r=this.type===ie.coalesce;_r&&(xt=ie.logicalAND.binop);var xr=this.value;this.next();var dn=this.start,Bn=this.startLoc,zi=this.parseExprOp(this.parseMaybeUnary(null,!1),dn,Bn,xt,$e),Vi=this.buildBinary(H,_e,T,zi,xr,zt||_r);return(zt&&this.type===ie.coalesce||_r&&(this.type===ie.logicalOR||this.type===ie.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(Vi,H,_e,ne,$e)}return T},Sn.buildBinary=function(T,H,_e,ne,$e,xt){var zt=this.startNodeAt(T,H);return zt.left=_e,zt.operator=$e,zt.right=ne,this.finishNode(zt,xt?"LogicalExpression":"BinaryExpression")},Sn.parseMaybeUnary=function(T,H){var _e=this.start,ne=this.startLoc,$e;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))$e=this.parseAwait(),H=!0;else if(this.type.prefix){var xt=this.startNode(),zt=this.type===ie.incDec;xt.operator=this.value,xt.prefix=!0,this.next(),xt.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(T,!0),zt?this.checkLVal(xt.argument):this.strict&&xt.operator==="delete"&&xt.argument.type==="Identifier"?this.raiseRecoverable(xt.start,"Deleting local variable in strict mode"):H=!0,$e=this.finishNode(xt,zt?"UpdateExpression":"UnaryExpression")}else{if($e=this.parseExprSubscripts(T),this.checkExpressionErrors(T))return $e;for(;this.type.postfix&&!this.canInsertSemicolon();){var _r=this.startNodeAt(_e,ne);_r.operator=this.value,_r.prefix=!1,_r.argument=$e,this.checkLVal($e),this.next(),$e=this.finishNode(_r,"UpdateExpression")}}return!H&&this.eat(ie.starstar)?this.buildBinary(_e,ne,$e,this.parseMaybeUnary(null,!1),"**",!1):$e},Sn.parseExprSubscripts=function(T){var H=this.start,_e=this.startLoc,ne=this.parseExprAtom(T);if(ne.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return ne;var $e=this.parseSubscripts(ne,H,_e);return T&&$e.type==="MemberExpression"&&(T.parenthesizedAssign>=$e.start&&(T.parenthesizedAssign=-1),T.parenthesizedBind>=$e.start&&(T.parenthesizedBind=-1)),$e},Sn.parseSubscripts=function(T,H,_e,ne){for(var $e=this.options.ecmaVersion>=8&&T.type==="Identifier"&&T.name==="async"&&this.lastTokEnd===T.end&&!this.canInsertSemicolon()&&T.end-T.start===5&&this.potentialArrowAt===T.start,xt=!1;;){var zt=this.parseSubscript(T,H,_e,ne,$e,xt);if(zt.optional&&(xt=!0),zt===T||zt.type==="ArrowFunctionExpression"){if(xt){var _r=this.startNodeAt(H,_e);_r.expression=zt,zt=this.finishNode(_r,"ChainExpression")}return zt}T=zt}},Sn.parseSubscript=function(T,H,_e,ne,$e,xt){var zt=this.options.ecmaVersion>=11,_r=zt&&this.eat(ie.questionDot);ne&&_r&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var xr=this.eat(ie.bracketL);if(xr||_r&&this.type!==ie.parenL&&this.type!==ie.backQuote||this.eat(ie.dot)){var dn=this.startNodeAt(H,_e);dn.object=T,dn.property=xr?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),dn.computed=!!xr,xr&&this.expect(ie.bracketR),zt&&(dn.optional=_r),T=this.finishNode(dn,"MemberExpression")}else if(!ne&&this.eat(ie.parenL)){var Bn=new we,zi=this.yieldPos,Vi=this.awaitPos,Ei=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var qa=this.parseExprList(ie.parenR,this.options.ecmaVersion>=8,!1,Bn);if($e&&!_r&&!this.canInsertSemicolon()&&this.eat(ie.arrow))return this.checkPatternErrors(Bn,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=zi,this.awaitPos=Vi,this.awaitIdentPos=Ei,this.parseArrowExpression(this.startNodeAt(H,_e),qa,!0);this.checkExpressionErrors(Bn,!0),this.yieldPos=zi||this.yieldPos,this.awaitPos=Vi||this.awaitPos,this.awaitIdentPos=Ei||this.awaitIdentPos;var $a=this.startNodeAt(H,_e);$a.callee=T,$a.arguments=qa,zt&&($a.optional=_r),T=this.finishNode($a,"CallExpression")}else if(this.type===ie.backQuote){(_r||xt)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var La=this.startNodeAt(H,_e);La.tag=T,La.quasi=this.parseTemplate({isTagged:!0}),T=this.finishNode(La,"TaggedTemplateExpression")}return T},Sn.parseExprAtom=function(T){this.type===ie.slash&&this.readRegexp();var H,_e=this.potentialArrowAt===this.start;switch(this.type){case ie._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),H=this.startNode(),this.next(),this.type===ie.parenL&&!this.allowDirectSuper&&this.raise(H.start,"super() call outside constructor of a subclass"),this.type!==ie.dot&&this.type!==ie.bracketL&&this.type!==ie.parenL&&this.unexpected(),this.finishNode(H,"Super");case ie._this:return H=this.startNode(),this.next(),this.finishNode(H,"ThisExpression");case ie.name:var ne=this.start,$e=this.startLoc,xt=this.containsEsc,zt=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!xt&&zt.name==="async"&&!this.canInsertSemicolon()&&this.eat(ie._function))return this.parseFunction(this.startNodeAt(ne,$e),0,!1,!0);if(_e&&!this.canInsertSemicolon()){if(this.eat(ie.arrow))return this.parseArrowExpression(this.startNodeAt(ne,$e),[zt],!1);if(this.options.ecmaVersion>=8&&zt.name==="async"&&this.type===ie.name&&!xt)return zt=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(ie.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(ne,$e),[zt],!0)}return zt;case ie.regexp:var _r=this.value;return H=this.parseLiteral(_r.value),H.regex={pattern:_r.pattern,flags:_r.flags},H;case ie.num:case ie.string:return this.parseLiteral(this.value);case ie._null:case ie._true:case ie._false:return H=this.startNode(),H.value=this.type===ie._null?null:this.type===ie._true,H.raw=this.type.keyword,this.next(),this.finishNode(H,"Literal");case ie.parenL:var xr=this.start,dn=this.parseParenAndDistinguishExpression(_e);return T&&(T.parenthesizedAssign<0&&!this.isSimpleAssignTarget(dn)&&(T.parenthesizedAssign=xr),T.parenthesizedBind<0&&(T.parenthesizedBind=xr)),dn;case ie.bracketL:return H=this.startNode(),this.next(),H.elements=this.parseExprList(ie.bracketR,!0,!0,T),this.finishNode(H,"ArrayExpression");case ie.braceL:return this.parseObj(!1,T);case ie._function:return H=this.startNode(),this.next(),this.parseFunction(H,0);case ie._class:return this.parseClass(this.startNode(),!1);case ie._new:return this.parseNew();case ie.backQuote:return this.parseTemplate();case ie._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},Sn.parseExprImport=function(){var T=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var H=this.parseIdent(!0);switch(this.type){case ie.parenL:return this.parseDynamicImport(T);case ie.dot:return T.meta=H,this.parseImportMeta(T);default:this.unexpected()}},Sn.parseDynamicImport=function(T){if(this.next(),T.source=this.parseMaybeAssign(),!this.eat(ie.parenR)){var H=this.start;this.eat(ie.comma)&&this.eat(ie.parenR)?this.raiseRecoverable(H,"Trailing comma is not allowed in import()"):this.unexpected(H)}return this.finishNode(T,"ImportExpression")},Sn.parseImportMeta=function(T){this.next();var H=this.containsEsc;return T.property=this.parseIdent(!0),T.property.name!=="meta"&&this.raiseRecoverable(T.property.start,"The only valid meta property for import is 'import.meta'"),H&&this.raiseRecoverable(T.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(T.start,"Cannot use 'import.meta' outside a module"),this.finishNode(T,"MetaProperty")},Sn.parseLiteral=function(T){var H=this.startNode();return H.value=T,H.raw=this.input.slice(this.start,this.end),H.raw.charCodeAt(H.raw.length-1)===110&&(H.bigint=H.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(H,"Literal")},Sn.parseParenExpression=function(){this.expect(ie.parenL);var T=this.parseExpression();return this.expect(ie.parenR),T},Sn.parseParenAndDistinguishExpression=function(T){var H=this.start,_e=this.startLoc,ne,$e=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var xt=this.start,zt=this.startLoc,_r=[],xr=!0,dn=!1,Bn=new we,zi=this.yieldPos,Vi=this.awaitPos,Ei;for(this.yieldPos=0,this.awaitPos=0;this.type!==ie.parenR;)if(xr?xr=!1:this.expect(ie.comma),$e&&this.afterTrailingComma(ie.parenR,!0)){dn=!0;break}else if(this.type===ie.ellipsis){Ei=this.start,_r.push(this.parseParenItem(this.parseRestBinding())),this.type===ie.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else _r.push(this.parseMaybeAssign(!1,Bn,this.parseParenItem));var qa=this.start,$a=this.startLoc;if(this.expect(ie.parenR),T&&!this.canInsertSemicolon()&&this.eat(ie.arrow))return this.checkPatternErrors(Bn,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=zi,this.awaitPos=Vi,this.parseParenArrowList(H,_e,_r);(!_r.length||dn)&&this.unexpected(this.lastTokStart),Ei&&this.unexpected(Ei),this.checkExpressionErrors(Bn,!0),this.yieldPos=zi||this.yieldPos,this.awaitPos=Vi||this.awaitPos,_r.length>1?(ne=this.startNodeAt(xt,zt),ne.expressions=_r,this.finishNodeAt(ne,"SequenceExpression",qa,$a)):ne=_r[0]}else ne=this.parseParenExpression();if(this.options.preserveParens){var La=this.startNodeAt(H,_e);return La.expression=ne,this.finishNode(La,"ParenthesizedExpression")}else return ne},Sn.parseParenItem=function(T){return T},Sn.parseParenArrowList=function(T,H,_e){return this.parseArrowExpression(this.startNodeAt(T,H),_e)};var Dn=[];Sn.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var T=this.startNode(),H=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(ie.dot)){T.meta=H;var _e=this.containsEsc;return T.property=this.parseIdent(!0),T.property.name!=="target"&&this.raiseRecoverable(T.property.start,"The only valid meta property for new is 'new.target'"),_e&&this.raiseRecoverable(T.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(T.start,"'new.target' can only be used in functions"),this.finishNode(T,"MetaProperty")}var ne=this.start,$e=this.startLoc,xt=this.type===ie._import;return T.callee=this.parseSubscripts(this.parseExprAtom(),ne,$e,!0),xt&&T.callee.type==="ImportExpression"&&this.raise(ne,"Cannot use new with import()"),this.eat(ie.parenL)?T.arguments=this.parseExprList(ie.parenR,this.options.ecmaVersion>=8,!1):T.arguments=Dn,this.finishNode(T,"NewExpression")},Sn.parseTemplateElement=function(T){var H=T.isTagged,_e=this.startNode();return this.type===ie.invalidTemplate?(H||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),_e.value={raw:this.value,cooked:null}):_e.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),_e.tail=this.type===ie.backQuote,this.finishNode(_e,"TemplateElement")},Sn.parseTemplate=function(T){T===void 0&&(T={});var H=T.isTagged;H===void 0&&(H=!1);var _e=this.startNode();this.next(),_e.expressions=[];var ne=this.parseTemplateElement({isTagged:H});for(_e.quasis=[ne];!ne.tail;)this.type===ie.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(ie.dollarBraceL),_e.expressions.push(this.parseExpression()),this.expect(ie.braceR),_e.quasis.push(ne=this.parseTemplateElement({isTagged:H}));return this.next(),this.finishNode(_e,"TemplateLiteral")},Sn.isAsyncProp=function(T){return!T.computed&&T.key.type==="Identifier"&&T.key.name==="async"&&(this.type===ie.name||this.type===ie.num||this.type===ie.string||this.type===ie.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===ie.star)&&!ft.test(this.input.slice(this.lastTokEnd,this.start))},Sn.parseObj=function(T,H){var _e=this.startNode(),ne=!0,$e={};for(_e.properties=[],this.next();!this.eat(ie.braceR);){if(ne)ne=!1;else if(this.expect(ie.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(ie.braceR))break;var xt=this.parseProperty(T,H);T||this.checkPropClash(xt,$e,H),_e.properties.push(xt)}return this.finishNode(_e,T?"ObjectPattern":"ObjectExpression")},Sn.parseProperty=function(T,H){var _e=this.startNode(),ne,$e,xt,zt;if(this.options.ecmaVersion>=9&&this.eat(ie.ellipsis))return T?(_e.argument=this.parseIdent(!1),this.type===ie.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(_e,"RestElement")):(this.type===ie.parenL&&H&&(H.parenthesizedAssign<0&&(H.parenthesizedAssign=this.start),H.parenthesizedBind<0&&(H.parenthesizedBind=this.start)),_e.argument=this.parseMaybeAssign(!1,H),this.type===ie.comma&&H&&H.trailingComma<0&&(H.trailingComma=this.start),this.finishNode(_e,"SpreadElement"));this.options.ecmaVersion>=6&&(_e.method=!1,_e.shorthand=!1,(T||H)&&(xt=this.start,zt=this.startLoc),T||(ne=this.eat(ie.star)));var _r=this.containsEsc;return this.parsePropertyName(_e),!T&&!_r&&this.options.ecmaVersion>=8&&!ne&&this.isAsyncProp(_e)?($e=!0,ne=this.options.ecmaVersion>=9&&this.eat(ie.star),this.parsePropertyName(_e,H)):$e=!1,this.parsePropertyValue(_e,T,ne,$e,xt,zt,H,_r),this.finishNode(_e,"Property")},Sn.parsePropertyValue=function(T,H,_e,ne,$e,xt,zt,_r){if((_e||ne)&&this.type===ie.colon&&this.unexpected(),this.eat(ie.colon))T.value=H?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,zt),T.kind="init";else if(this.options.ecmaVersion>=6&&this.type===ie.parenL)H&&this.unexpected(),T.kind="init",T.method=!0,T.value=this.parseMethod(_e,ne);else if(!H&&!_r&&this.options.ecmaVersion>=5&&!T.computed&&T.key.type==="Identifier"&&(T.key.name==="get"||T.key.name==="set")&&this.type!==ie.comma&&this.type!==ie.braceR&&this.type!==ie.eq){(_e||ne)&&this.unexpected(),T.kind=T.key.name,this.parsePropertyName(T),T.value=this.parseMethod(!1);var xr=T.kind==="get"?0:1;if(T.value.params.length!==xr){var dn=T.value.start;T.kind==="get"?this.raiseRecoverable(dn,"getter should have no params"):this.raiseRecoverable(dn,"setter should have exactly one param")}else T.kind==="set"&&T.value.params[0].type==="RestElement"&&this.raiseRecoverable(T.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!T.computed&&T.key.type==="Identifier"?((_e||ne)&&this.unexpected(),this.checkUnreserved(T.key),T.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=$e),T.kind="init",H?T.value=this.parseMaybeDefault($e,xt,T.key):this.type===ie.eq&&zt?(zt.shorthandAssign<0&&(zt.shorthandAssign=this.start),T.value=this.parseMaybeDefault($e,xt,T.key)):T.value=T.key,T.shorthand=!0):this.unexpected()},Sn.parsePropertyName=function(T){if(this.options.ecmaVersion>=6){if(this.eat(ie.bracketL))return T.computed=!0,T.key=this.parseMaybeAssign(),this.expect(ie.bracketR),T.key;T.computed=!1}return T.key=this.type===ie.num||this.type===ie.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},Sn.initFunction=function(T){T.id=null,this.options.ecmaVersion>=6&&(T.generator=T.expression=!1),this.options.ecmaVersion>=8&&(T.async=!1)},Sn.parseMethod=function(T,H,_e){var ne=this.startNode(),$e=this.yieldPos,xt=this.awaitPos,zt=this.awaitIdentPos;return this.initFunction(ne),this.options.ecmaVersion>=6&&(ne.generator=T),this.options.ecmaVersion>=8&&(ne.async=!!H),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Oi(H,ne.generator)|ci|(_e?Ci:0)),this.expect(ie.parenL),ne.params=this.parseBindingList(ie.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(ne,!1,!0),this.yieldPos=$e,this.awaitPos=xt,this.awaitIdentPos=zt,this.finishNode(ne,"FunctionExpression")},Sn.parseArrowExpression=function(T,H,_e){var ne=this.yieldPos,$e=this.awaitPos,xt=this.awaitIdentPos;return this.enterScope(Oi(_e,!1)|Ea),this.initFunction(T),this.options.ecmaVersion>=8&&(T.async=!!_e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,T.params=this.toAssignableList(H,!0),this.parseFunctionBody(T,!0,!1),this.yieldPos=ne,this.awaitPos=$e,this.awaitIdentPos=xt,this.finishNode(T,"ArrowFunctionExpression")},Sn.parseFunctionBody=function(T,H,_e){var ne=H&&this.type!==ie.braceL,$e=this.strict,xt=!1;if(ne)T.body=this.parseMaybeAssign(),T.expression=!0,this.checkParams(T,!1);else{var zt=this.options.ecmaVersion>=7&&!this.isSimpleParamList(T.params);(!$e||zt)&&(xt=this.strictDirective(this.end),xt&&zt&&this.raiseRecoverable(T.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var _r=this.labels;this.labels=[],xt&&(this.strict=!0),this.checkParams(T,!$e&&!xt&&!H&&!_e&&this.isSimpleParamList(T.params)),this.strict&&T.id&&this.checkLVal(T.id,Ai),T.body=this.parseBlock(!1,void 0,xt&&!$e),T.expression=!1,this.adaptDirectivePrologue(T.body.body),this.labels=_r}this.exitScope()},Sn.isSimpleParamList=function(T){for(var H=0,_e=T;H<_e.length;H+=1){var ne=_e[H];if(ne.type!=="Identifier")return!1}return!0},Sn.checkParams=function(T,H){for(var _e={},ne=0,$e=T.params;ne<$e.length;ne+=1){var xt=$e[ne];this.checkLVal(xt,fn,H?null:_e)}},Sn.parseExprList=function(T,H,_e,ne){for(var $e=[],xt=!0;!this.eat(T);){if(xt)xt=!1;else if(this.expect(ie.comma),H&&this.afterTrailingComma(T))break;var zt=void 0;_e&&this.type===ie.comma?zt=null:this.type===ie.ellipsis?(zt=this.parseSpread(ne),ne&&this.type===ie.comma&&ne.trailingComma<0&&(ne.trailingComma=this.start)):zt=this.parseMaybeAssign(!1,ne),$e.push(zt)}return $e},Sn.checkUnreserved=function(T){var H=T.start,_e=T.end,ne=T.name;if(this.inGenerator&&ne==="yield"&&this.raiseRecoverable(H,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&ne==="await"&&this.raiseRecoverable(H,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(ne)&&this.raise(H,"Unexpected keyword '"+ne+"'"),!(this.options.ecmaVersion<6&&this.input.slice(H,_e).indexOf("\\")!==-1)){var $e=this.strict?this.reservedWordsStrict:this.reservedWords;$e.test(ne)&&(!this.inAsync&&ne==="await"&&this.raiseRecoverable(H,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(H,"The keyword '"+ne+"' is reserved"))}},Sn.parseIdent=function(T,H){var _e=this.startNode();return this.type===ie.name?_e.name=this.value:this.type.keyword?(_e.name=this.type.keyword,(_e.name==="class"||_e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!T),this.finishNode(_e,"Identifier"),T||(this.checkUnreserved(_e),_e.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=_e.start)),_e},Sn.parseYield=function(T){this.yieldPos||(this.yieldPos=this.start);var H=this.startNode();return this.next(),this.type===ie.semi||this.canInsertSemicolon()||this.type!==ie.star&&!this.type.startsExpr?(H.delegate=!1,H.argument=null):(H.delegate=this.eat(ie.star),H.argument=this.parseMaybeAssign(T)),this.finishNode(H,"YieldExpression")},Sn.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var T=this.startNode();return this.next(),T.argument=this.parseMaybeUnary(null,!1),this.finishNode(T,"AwaitExpression")};var ui=Pr.prototype;ui.raise=function(T,H){var _e=bt(this.input,T);H+=" ("+_e.line+":"+_e.column+")";var ne=new SyntaxError(H);throw ne.pos=T,ne.loc=_e,ne.raisedAt=this.pos,ne},ui.raiseRecoverable=ui.raise,ui.curPosition=function(){if(this.options.locations)return new be(this.curLine,this.pos-this.lineStart)};var di=Pr.prototype,ca=function(H){this.flags=H,this.var=[],this.lexical=[],this.functions=[]};di.enterScope=function(T){this.scopeStack.push(new ca(T))},di.exitScope=function(){this.scopeStack.pop()},di.treatFunctionsAsVarInScope=function(T){return T.flags&hn||!this.inModule&&T.flags&on},di.declareName=function(T,H,_e){var ne=!1;if(H===tn){var $e=this.currentScope();ne=$e.lexical.indexOf(T)>-1||$e.functions.indexOf(T)>-1||$e.var.indexOf(T)>-1,$e.lexical.push(T),this.inModule&&$e.flags&on&&delete this.undefinedExports[T]}else if(H===Ii){var xt=this.currentScope();xt.lexical.push(T)}else if(H===da){var zt=this.currentScope();this.treatFunctionsAsVar?ne=zt.lexical.indexOf(T)>-1:ne=zt.lexical.indexOf(T)>-1||zt.var.indexOf(T)>-1,zt.functions.push(T)}else for(var _r=this.scopeStack.length-1;_r>=0;--_r){var xr=this.scopeStack[_r];if(xr.lexical.indexOf(T)>-1&&!(xr.flags&Ze&&xr.lexical[0]===T)||!this.treatFunctionsAsVarInScope(xr)&&xr.functions.indexOf(T)>-1){ne=!0;break}if(xr.var.push(T),this.inModule&&xr.flags&on&&delete this.undefinedExports[T],xr.flags&gi)break}ne&&this.raiseRecoverable(_e,"Identifier '"+T+"' has already been declared")},di.checkLocalExport=function(T){this.scopeStack[0].lexical.indexOf(T.name)===-1&&this.scopeStack[0].var.indexOf(T.name)===-1&&(this.undefinedExports[T.name]=T)},di.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},di.currentVarScope=function(){for(var T=this.scopeStack.length-1;;T--){var H=this.scopeStack[T];if(H.flags&gi)return H}},di.currentThisScope=function(){for(var T=this.scopeStack.length-1;;T--){var H=this.scopeStack[T];if(H.flags&gi&&!(H.flags&Ea))return H}};var Ni=function(H,_e,ne){this.type="",this.start=_e,this.end=0,H.options.locations&&(this.loc=new vt(H,ne)),H.options.directSourceFile&&(this.sourceFile=H.options.directSourceFile),H.options.ranges&&(this.range=[_e,0])},Wa=Pr.prototype;Wa.startNode=function(){return new Ni(this,this.start,this.startLoc)},Wa.startNodeAt=function(T,H){return new Ni(this,T,H)};function Ba(T,H,_e,ne){return T.type=H,T.end=_e,this.options.locations&&(T.loc.end=ne),this.options.ranges&&(T.range[1]=_e),T}Wa.finishNode=function(T,H){return Ba.call(this,T,H,this.lastTokEnd,this.lastTokEndLoc)},Wa.finishNodeAt=function(T,H,_e,ne){return Ba.call(this,T,H,_e,ne)};var Ia=function(H,_e,ne,$e,xt){this.token=H,this.isExpr=!!_e,this.preserveSpace=!!ne,this.override=$e,this.generator=!!xt},an={b_stat:new Ia("{",!1),b_expr:new Ia("{",!0),b_tmpl:new Ia("${",!1),p_stat:new Ia("(",!1),p_expr:new Ia("(",!0),q_tmpl:new Ia("`",!0,!0,function(T){return T.tryReadTemplateToken()}),f_stat:new Ia("function",!1),f_expr:new Ia("function",!0),f_expr_gen:new Ia("function",!0,!1,null,!0),f_gen:new Ia("function",!1,!1,null,!0)},Ln=Pr.prototype;Ln.initialContext=function(){return[an.b_stat]},Ln.braceIsBlock=function(T){var H=this.curContext();return H===an.f_expr||H===an.f_stat?!0:T===ie.colon&&(H===an.b_stat||H===an.b_expr)?!H.isExpr:T===ie._return||T===ie.name&&this.exprAllowed?ft.test(this.input.slice(this.lastTokEnd,this.start)):T===ie._else||T===ie.semi||T===ie.eof||T===ie.parenR||T===ie.arrow?!0:T===ie.braceL?H===an.b_stat:T===ie._var||T===ie._const||T===ie.name?!1:!this.exprAllowed},Ln.inGeneratorContext=function(){for(var T=this.context.length-1;T>=1;T--){var H=this.context[T];if(H.token==="function")return H.generator}return!1},Ln.updateContext=function(T){var H,_e=this.type;_e.keyword&&T===ie.dot?this.exprAllowed=!1:(H=_e.updateContext)?H.call(this,T):this.exprAllowed=_e.beforeExpr},ie.parenR.updateContext=ie.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var T=this.context.pop();T===an.b_stat&&this.curContext().token==="function"&&(T=this.context.pop()),this.exprAllowed=!T.isExpr},ie.braceL.updateContext=function(T){this.context.push(this.braceIsBlock(T)?an.b_stat:an.b_expr),this.exprAllowed=!0},ie.dollarBraceL.updateContext=function(){this.context.push(an.b_tmpl),this.exprAllowed=!0},ie.parenL.updateContext=function(T){var H=T===ie._if||T===ie._for||T===ie._with||T===ie._while;this.context.push(H?an.p_stat:an.p_expr),this.exprAllowed=!0},ie.incDec.updateContext=function(){},ie._function.updateContext=ie._class.updateContext=function(T){T.beforeExpr&&T!==ie.semi&&T!==ie._else&&!(T===ie._return&&ft.test(this.input.slice(this.lastTokEnd,this.start)))&&!((T===ie.colon||T===ie.braceL)&&this.curContext()===an.b_stat)?this.context.push(an.f_expr):this.context.push(an.f_stat),this.exprAllowed=!1},ie.backQuote.updateContext=function(){this.curContext()===an.q_tmpl?this.context.pop():this.context.push(an.q_tmpl),this.exprAllowed=!1},ie.star.updateContext=function(T){if(T===ie._function){var H=this.context.length-1;this.context[H]===an.f_expr?this.context[H]=an.f_expr_gen:this.context[H]=an.f_gen}this.exprAllowed=!0},ie.name.updateContext=function(T){var H=!1;this.options.ecmaVersion>=6&&T!==ie.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(H=!0),this.exprAllowed=H};var re="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",he=re+" Extended_Pictographic",V=he,Et={9:re,10:he,11:V},Bt="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Le="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",St=Le+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",tt=St+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",At={9:Le,10:St,11:tt},tr={};function en(T){var H=tr[T]={binary:ue(Et[T]+" "+Bt),nonBinary:{General_Category:ue(Bt),Script:ue(At[T])}};H.nonBinary.Script_Extensions=H.nonBinary.Script,H.nonBinary.gc=H.nonBinary.General_Category,H.nonBinary.sc=H.nonBinary.Script,H.nonBinary.scx=H.nonBinary.Script_Extensions}en(9),en(10),en(11);var Kr=Pr.prototype,Ft=function(H){this.parser=H,this.validFlags="gim"+(H.options.ecmaVersion>=6?"uy":"")+(H.options.ecmaVersion>=9?"s":""),this.unicodeProperties=tr[H.options.ecmaVersion>=11?11:H.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};Ft.prototype.reset=function(H,_e,ne){var $e=ne.indexOf("u")!==-1;this.start=H|0,this.source=_e+"",this.flags=ne,this.switchU=$e&&this.parser.options.ecmaVersion>=6,this.switchN=$e&&this.parser.options.ecmaVersion>=9},Ft.prototype.raise=function(H){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+H)},Ft.prototype.at=function(H,_e){_e===void 0&&(_e=!1);var ne=this.source,$e=ne.length;if(H>=$e)return-1;var xt=ne.charCodeAt(H);if(!(_e||this.switchU)||xt<=55295||xt>=57344||H+1>=$e)return xt;var zt=ne.charCodeAt(H+1);return zt>=56320&&zt<=57343?(xt<<10)+zt-56613888:xt},Ft.prototype.nextIndex=function(H,_e){_e===void 0&&(_e=!1);var ne=this.source,$e=ne.length;if(H>=$e)return $e;var xt=ne.charCodeAt(H),zt;return!(_e||this.switchU)||xt<=55295||xt>=57344||H+1>=$e||(zt=ne.charCodeAt(H+1))<56320||zt>57343?H+1:H+2},Ft.prototype.current=function(H){return H===void 0&&(H=!1),this.at(this.pos,H)},Ft.prototype.lookahead=function(H){return H===void 0&&(H=!1),this.at(this.nextIndex(this.pos,H),H)},Ft.prototype.advance=function(H){H===void 0&&(H=!1),this.pos=this.nextIndex(this.pos,H)},Ft.prototype.eat=function(H,_e){return _e===void 0&&(_e=!1),this.current(_e)===H?(this.advance(_e),!0):!1};function rr(T){return T<=65535?String.fromCharCode(T):(T-=65536,String.fromCharCode((T>>10)+55296,(T&1023)+56320))}Kr.validateRegExpFlags=function(T){for(var H=T.validFlags,_e=T.flags,ne=0;ne<_e.length;ne++){var $e=_e.charAt(ne);H.indexOf($e)===-1&&this.raise(T.start,"Invalid regular expression flag"),_e.indexOf($e,ne+1)>-1&&this.raise(T.start,"Duplicate regular expression flag")}},Kr.validateRegExpPattern=function(T){this.regexp_pattern(T),!T.switchN&&this.options.ecmaVersion>=9&&T.groupNames.length>0&&(T.switchN=!0,this.regexp_pattern(T))},Kr.regexp_pattern=function(T){T.pos=0,T.lastIntValue=0,T.lastStringValue="",T.lastAssertionIsQuantifiable=!1,T.numCapturingParens=0,T.maxBackReference=0,T.groupNames.length=0,T.backReferenceNames.length=0,this.regexp_disjunction(T),T.pos!==T.source.length&&(T.eat(41)&&T.raise("Unmatched ')'"),(T.eat(93)||T.eat(125))&&T.raise("Lone quantifier brackets")),T.maxBackReference>T.numCapturingParens&&T.raise("Invalid escape");for(var H=0,_e=T.backReferenceNames;H<_e.length;H+=1){var ne=_e[H];T.groupNames.indexOf(ne)===-1&&T.raise("Invalid named capture referenced")}},Kr.regexp_disjunction=function(T){for(this.regexp_alternative(T);T.eat(124);)this.regexp_alternative(T);this.regexp_eatQuantifier(T,!0)&&T.raise("Nothing to repeat"),T.eat(123)&&T.raise("Lone quantifier brackets")},Kr.regexp_alternative=function(T){for(;T.pos<T.source.length&&this.regexp_eatTerm(T););},Kr.regexp_eatTerm=function(T){return this.regexp_eatAssertion(T)?(T.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(T)&&T.switchU&&T.raise("Invalid quantifier"),!0):(T.switchU?this.regexp_eatAtom(T):this.regexp_eatExtendedAtom(T))?(this.regexp_eatQuantifier(T),!0):!1},Kr.regexp_eatAssertion=function(T){var H=T.pos;if(T.lastAssertionIsQuantifiable=!1,T.eat(94)||T.eat(36))return!0;if(T.eat(92)){if(T.eat(66)||T.eat(98))return!0;T.pos=H}if(T.eat(40)&&T.eat(63)){var _e=!1;if(this.options.ecmaVersion>=9&&(_e=T.eat(60)),T.eat(61)||T.eat(33))return this.regexp_disjunction(T),T.eat(41)||T.raise("Unterminated group"),T.lastAssertionIsQuantifiable=!_e,!0}return T.pos=H,!1},Kr.regexp_eatQuantifier=function(T,H){return H===void 0&&(H=!1),this.regexp_eatQuantifierPrefix(T,H)?(T.eat(63),!0):!1},Kr.regexp_eatQuantifierPrefix=function(T,H){return T.eat(42)||T.eat(43)||T.eat(63)||this.regexp_eatBracedQuantifier(T,H)},Kr.regexp_eatBracedQuantifier=function(T,H){var _e=T.pos;if(T.eat(123)){var ne=0,$e=-1;if(this.regexp_eatDecimalDigits(T)&&(ne=T.lastIntValue,T.eat(44)&&this.regexp_eatDecimalDigits(T)&&($e=T.lastIntValue),T.eat(125)))return $e!==-1&&$e<ne&&!H&&T.raise("numbers out of order in {} quantifier"),!0;T.switchU&&!H&&T.raise("Incomplete quantifier"),T.pos=_e}return!1},Kr.regexp_eatAtom=function(T){return this.regexp_eatPatternCharacters(T)||T.eat(46)||this.regexp_eatReverseSolidusAtomEscape(T)||this.regexp_eatCharacterClass(T)||this.regexp_eatUncapturingGroup(T)||this.regexp_eatCapturingGroup(T)},Kr.regexp_eatReverseSolidusAtomEscape=function(T){var H=T.pos;if(T.eat(92)){if(this.regexp_eatAtomEscape(T))return!0;T.pos=H}return!1},Kr.regexp_eatUncapturingGroup=function(T){var H=T.pos;if(T.eat(40)){if(T.eat(63)&&T.eat(58)){if(this.regexp_disjunction(T),T.eat(41))return!0;T.raise("Unterminated group")}T.pos=H}return!1},Kr.regexp_eatCapturingGroup=function(T){if(T.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(T):T.current()===63&&T.raise("Invalid group"),this.regexp_disjunction(T),T.eat(41))return T.numCapturingParens+=1,!0;T.raise("Unterminated group")}return!1},Kr.regexp_eatExtendedAtom=function(T){return T.eat(46)||this.regexp_eatReverseSolidusAtomEscape(T)||this.regexp_eatCharacterClass(T)||this.regexp_eatUncapturingGroup(T)||this.regexp_eatCapturingGroup(T)||this.regexp_eatInvalidBracedQuantifier(T)||this.regexp_eatExtendedPatternCharacter(T)},Kr.regexp_eatInvalidBracedQuantifier=function(T){return this.regexp_eatBracedQuantifier(T,!0)&&T.raise("Nothing to repeat"),!1},Kr.regexp_eatSyntaxCharacter=function(T){var H=T.current();return ot(H)?(T.lastIntValue=H,T.advance(),!0):!1};function ot(T){return T===36||T>=40&&T<=43||T===46||T===63||T>=91&&T<=94||T>=123&&T<=125}Kr.regexp_eatPatternCharacters=function(T){for(var H=T.pos,_e=0;(_e=T.current())!==-1&&!ot(_e);)T.advance();return T.pos!==H},Kr.regexp_eatExtendedPatternCharacter=function(T){var H=T.current();return H!==-1&&H!==36&&!(H>=40&&H<=43)&&H!==46&&H!==63&&H!==91&&H!==94&&H!==124?(T.advance(),!0):!1},Kr.regexp_groupSpecifier=function(T){if(T.eat(63)){if(this.regexp_eatGroupName(T)){T.groupNames.indexOf(T.lastStringValue)!==-1&&T.raise("Duplicate capture group name"),T.groupNames.push(T.lastStringValue);return}T.raise("Invalid group")}},Kr.regexp_eatGroupName=function(T){if(T.lastStringValue="",T.eat(60)){if(this.regexp_eatRegExpIdentifierName(T)&&T.eat(62))return!0;T.raise("Invalid capture group name")}return!1},Kr.regexp_eatRegExpIdentifierName=function(T){if(T.lastStringValue="",this.regexp_eatRegExpIdentifierStart(T)){for(T.lastStringValue+=rr(T.lastIntValue);this.regexp_eatRegExpIdentifierPart(T);)T.lastStringValue+=rr(T.lastIntValue);return!0}return!1},Kr.regexp_eatRegExpIdentifierStart=function(T){var H=T.pos,_e=this.options.ecmaVersion>=11,ne=T.current(_e);return T.advance(_e),ne===92&&this.regexp_eatRegExpUnicodeEscapeSequence(T,_e)&&(ne=T.lastIntValue),Li(ne)?(T.lastIntValue=ne,!0):(T.pos=H,!1)};function Li(T){return Ce(T,!0)||T===36||T===95}Kr.regexp_eatRegExpIdentifierPart=function(T){var H=T.pos,_e=this.options.ecmaVersion>=11,ne=T.current(_e);return T.advance(_e),ne===92&&this.regexp_eatRegExpUnicodeEscapeSequence(T,_e)&&(ne=T.lastIntValue),Hr(ne)?(T.lastIntValue=ne,!0):(T.pos=H,!1)};function Hr(T){return We(T,!0)||T===36||T===95||T===8204||T===8205}Kr.regexp_eatAtomEscape=function(T){return this.regexp_eatBackReference(T)||this.regexp_eatCharacterClassEscape(T)||this.regexp_eatCharacterEscape(T)||T.switchN&&this.regexp_eatKGroupName(T)?!0:(T.switchU&&(T.current()===99&&T.raise("Invalid unicode escape"),T.raise("Invalid escape")),!1)},Kr.regexp_eatBackReference=function(T){var H=T.pos;if(this.regexp_eatDecimalEscape(T)){var _e=T.lastIntValue;if(T.switchU)return _e>T.maxBackReference&&(T.maxBackReference=_e),!0;if(_e<=T.numCapturingParens)return!0;T.pos=H}return!1},Kr.regexp_eatKGroupName=function(T){if(T.eat(107)){if(this.regexp_eatGroupName(T))return T.backReferenceNames.push(T.lastStringValue),!0;T.raise("Invalid named reference")}return!1},Kr.regexp_eatCharacterEscape=function(T){return this.regexp_eatControlEscape(T)||this.regexp_eatCControlLetter(T)||this.regexp_eatZero(T)||this.regexp_eatHexEscapeSequence(T)||this.regexp_eatRegExpUnicodeEscapeSequence(T,!1)||!T.switchU&&this.regexp_eatLegacyOctalEscapeSequence(T)||this.regexp_eatIdentityEscape(T)},Kr.regexp_eatCControlLetter=function(T){var H=T.pos;if(T.eat(99)){if(this.regexp_eatControlLetter(T))return!0;T.pos=H}return!1},Kr.regexp_eatZero=function(T){return T.current()===48&&!Jn(T.lookahead())?(T.lastIntValue=0,T.advance(),!0):!1},Kr.regexp_eatControlEscape=function(T){var H=T.current();return H===116?(T.lastIntValue=9,T.advance(),!0):H===110?(T.lastIntValue=10,T.advance(),!0):H===118?(T.lastIntValue=11,T.advance(),!0):H===102?(T.lastIntValue=12,T.advance(),!0):H===114?(T.lastIntValue=13,T.advance(),!0):!1},Kr.regexp_eatControlLetter=function(T){var H=T.current();return _i(H)?(T.lastIntValue=H%32,T.advance(),!0):!1};function _i(T){return T>=65&&T<=90||T>=97&&T<=122}Kr.regexp_eatRegExpUnicodeEscapeSequence=function(T,H){H===void 0&&(H=!1);var _e=T.pos,ne=H||T.switchU;if(T.eat(117)){if(this.regexp_eatFixedHexDigits(T,4)){var $e=T.lastIntValue;if(ne&&$e>=55296&&$e<=56319){var xt=T.pos;if(T.eat(92)&&T.eat(117)&&this.regexp_eatFixedHexDigits(T,4)){var zt=T.lastIntValue;if(zt>=56320&&zt<=57343)return T.lastIntValue=($e-55296)*1024+(zt-56320)+65536,!0}T.pos=xt,T.lastIntValue=$e}return!0}if(ne&&T.eat(123)&&this.regexp_eatHexDigits(T)&&T.eat(125)&&vi(T.lastIntValue))return!0;ne&&T.raise("Invalid unicode escape"),T.pos=_e}return!1};function vi(T){return T>=0&&T<=1114111}Kr.regexp_eatIdentityEscape=function(T){if(T.switchU)return this.regexp_eatSyntaxCharacter(T)?!0:T.eat(47)?(T.lastIntValue=47,!0):!1;var H=T.current();return H!==99&&(!T.switchN||H!==107)?(T.lastIntValue=H,T.advance(),!0):!1},Kr.regexp_eatDecimalEscape=function(T){T.lastIntValue=0;var H=T.current();if(H>=49&&H<=57){do T.lastIntValue=10*T.lastIntValue+(H-48),T.advance();while((H=T.current())>=48&&H<=57);return!0}return!1},Kr.regexp_eatCharacterClassEscape=function(T){var H=T.current();if(It(H))return T.lastIntValue=-1,T.advance(),!0;if(T.switchU&&this.options.ecmaVersion>=9&&(H===80||H===112)){if(T.lastIntValue=-1,T.advance(),T.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(T)&&T.eat(125))return!0;T.raise("Invalid property name")}return!1};function It(T){return T===100||T===68||T===115||T===83||T===119||T===87}Kr.regexp_eatUnicodePropertyValueExpression=function(T){var H=T.pos;if(this.regexp_eatUnicodePropertyName(T)&&T.eat(61)){var _e=T.lastStringValue;if(this.regexp_eatUnicodePropertyValue(T)){var ne=T.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(T,_e,ne),!0}}if(T.pos=H,this.regexp_eatLoneUnicodePropertyNameOrValue(T)){var $e=T.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(T,$e),!0}return!1},Kr.regexp_validateUnicodePropertyNameAndValue=function(T,H,_e){Qe(T.unicodeProperties.nonBinary,H)||T.raise("Invalid property name"),T.unicodeProperties.nonBinary[H].test(_e)||T.raise("Invalid property value")},Kr.regexp_validateUnicodePropertyNameOrValue=function(T,H){T.unicodeProperties.binary.test(H)||T.raise("Invalid property name")},Kr.regexp_eatUnicodePropertyName=function(T){var H=0;for(T.lastStringValue="";Yr(H=T.current());)T.lastStringValue+=rr(H),T.advance();return T.lastStringValue!==""};function Yr(T){return _i(T)||T===95}Kr.regexp_eatUnicodePropertyValue=function(T){var H=0;for(T.lastStringValue="";Dr(H=T.current());)T.lastStringValue+=rr(H),T.advance();return T.lastStringValue!==""};function Dr(T){return Yr(T)||Jn(T)}Kr.regexp_eatLoneUnicodePropertyNameOrValue=function(T){return this.regexp_eatUnicodePropertyValue(T)},Kr.regexp_eatCharacterClass=function(T){if(T.eat(91)){if(T.eat(94),this.regexp_classRanges(T),T.eat(93))return!0;T.raise("Unterminated character class")}return!1},Kr.regexp_classRanges=function(T){for(;this.regexp_eatClassAtom(T);){var H=T.lastIntValue;if(T.eat(45)&&this.regexp_eatClassAtom(T)){var _e=T.lastIntValue;T.switchU&&(H===-1||_e===-1)&&T.raise("Invalid character class"),H!==-1&&_e!==-1&&H>_e&&T.raise("Range out of order in character class")}}},Kr.regexp_eatClassAtom=function(T){var H=T.pos;if(T.eat(92)){if(this.regexp_eatClassEscape(T))return!0;if(T.switchU){var _e=T.current();(_e===99||Fr(_e))&&T.raise("Invalid class escape"),T.raise("Invalid escape")}T.pos=H}var ne=T.current();return ne!==93?(T.lastIntValue=ne,T.advance(),!0):!1},Kr.regexp_eatClassEscape=function(T){var H=T.pos;if(T.eat(98))return T.lastIntValue=8,!0;if(T.switchU&&T.eat(45))return T.lastIntValue=45,!0;if(!T.switchU&&T.eat(99)){if(this.regexp_eatClassControlLetter(T))return!0;T.pos=H}return this.regexp_eatCharacterClassEscape(T)||this.regexp_eatCharacterEscape(T)},Kr.regexp_eatClassControlLetter=function(T){var H=T.current();return Jn(H)||H===95?(T.lastIntValue=H%32,T.advance(),!0):!1},Kr.regexp_eatHexEscapeSequence=function(T){var H=T.pos;if(T.eat(120)){if(this.regexp_eatFixedHexDigits(T,2))return!0;T.switchU&&T.raise("Invalid escape"),T.pos=H}return!1},Kr.regexp_eatDecimalDigits=function(T){var H=T.pos,_e=0;for(T.lastIntValue=0;Jn(_e=T.current());)T.lastIntValue=10*T.lastIntValue+(_e-48),T.advance();return T.pos!==H};function Jn(T){return T>=48&&T<=57}Kr.regexp_eatHexDigits=function(T){var H=T.pos,_e=0;for(T.lastIntValue=0;Kt(_e=T.current());)T.lastIntValue=16*T.lastIntValue+hr(_e),T.advance();return T.pos!==H};function Kt(T){return T>=48&&T<=57||T>=65&&T<=70||T>=97&&T<=102}function hr(T){return T>=65&&T<=70?10+(T-65):T>=97&&T<=102?10+(T-97):T-48}Kr.regexp_eatLegacyOctalEscapeSequence=function(T){if(this.regexp_eatOctalDigit(T)){var H=T.lastIntValue;if(this.regexp_eatOctalDigit(T)){var _e=T.lastIntValue;H<=3&&this.regexp_eatOctalDigit(T)?T.lastIntValue=H*64+_e*8+T.lastIntValue:T.lastIntValue=H*8+_e}else T.lastIntValue=H;return!0}return!1},Kr.regexp_eatOctalDigit=function(T){var H=T.current();return Fr(H)?(T.lastIntValue=H-48,T.advance(),!0):(T.lastIntValue=0,!1)};function Fr(T){return T>=48&&T<=55}Kr.regexp_eatFixedHexDigits=function(T,H){var _e=T.pos;T.lastIntValue=0;for(var ne=0;ne<H;++ne){var $e=T.current();if(!Kt($e))return T.pos=_e,!1;T.lastIntValue=16*T.lastIntValue+hr($e),T.advance()}return!0};var qr=function(H){this.type=H.type,this.value=H.value,this.start=H.start,this.end=H.end,H.options.locations&&(this.loc=new vt(H,H.startLoc,H.endLoc)),H.options.ranges&&(this.range=[H.start,H.end])},An=Pr.prototype;An.next=function(T){!T&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new qr(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},An.getToken=function(){return this.next(),new qr(this)},typeof Symbol!="undefined"&&(An[Symbol.iterator]=function(){var T=this;return{next:function(){var H=T.getToken();return{done:H.type===ie.eof,value:H}}}}),An.curContext=function(){return this.context[this.context.length-1]},An.nextToken=function(){var T=this.curContext();if((!T||!T.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(ie.eof);if(T.override)return T.override(this);this.readToken(this.fullCharCodeAtPos())},An.readToken=function(T){return Ce(T,this.options.ecmaVersion>=6)||T===92?this.readWord():this.getTokenFromCode(T)},An.fullCharCodeAtPos=function(){var T=this.input.charCodeAt(this.pos);if(T<=55295||T>=57344)return T;var H=this.input.charCodeAt(this.pos+1);return(T<<10)+H-56613888},An.skipBlockComment=function(){var T=this.options.onComment&&this.curPosition(),H=this.pos,_e=this.input.indexOf("*/",this.pos+=2);if(_e===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=_e+2,this.options.locations){ve.lastIndex=H;for(var ne;(ne=ve.exec(this.input))&&ne.index<this.pos;)++this.curLine,this.lineStart=ne.index+ne[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(H+2,_e),H,this.pos,T,this.curPosition())},An.skipLineComment=function(T){for(var H=this.pos,_e=this.options.onComment&&this.curPosition(),ne=this.input.charCodeAt(this.pos+=T);this.pos<this.input.length&&!Ae(ne);)ne=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(H+T,this.pos),H,this.pos,_e,this.curPosition())},An.skipSpace=function(){e:for(;this.pos<this.input.length;){var T=this.input.charCodeAt(this.pos);switch(T){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(T>8&&T<14||T>=5760&&Re.test(String.fromCharCode(T)))++this.pos;else break e}}},An.finishToken=function(T,H){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var _e=this.type;this.type=T,this.value=H,this.updateContext(_e)},An.readToken_dot=function(){var T=this.input.charCodeAt(this.pos+1);if(T>=48&&T<=57)return this.readNumber(!0);var H=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&T===46&&H===46?(this.pos+=3,this.finishToken(ie.ellipsis)):(++this.pos,this.finishToken(ie.dot))},An.readToken_slash=function(){var T=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):T===61?this.finishOp(ie.assign,2):this.finishOp(ie.slash,1)},An.readToken_mult_modulo_exp=function(T){var H=this.input.charCodeAt(this.pos+1),_e=1,ne=T===42?ie.star:ie.modulo;return this.options.ecmaVersion>=7&&T===42&&H===42&&(++_e,ne=ie.starstar,H=this.input.charCodeAt(this.pos+2)),H===61?this.finishOp(ie.assign,_e+1):this.finishOp(ne,_e)},An.readToken_pipe_amp=function(T){var H=this.input.charCodeAt(this.pos+1);if(H===T){if(this.options.ecmaVersion>=12){var _e=this.input.charCodeAt(this.pos+2);if(_e===61)return this.finishOp(ie.assign,3)}return this.finishOp(T===124?ie.logicalOR:ie.logicalAND,2)}return H===61?this.finishOp(ie.assign,2):this.finishOp(T===124?ie.bitwiseOR:ie.bitwiseAND,1)},An.readToken_caret=function(){var T=this.input.charCodeAt(this.pos+1);return T===61?this.finishOp(ie.assign,2):this.finishOp(ie.bitwiseXOR,1)},An.readToken_plus_min=function(T){var H=this.input.charCodeAt(this.pos+1);return H===T?H===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||ft.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(ie.incDec,2):H===61?this.finishOp(ie.assign,2):this.finishOp(ie.plusMin,1)},An.readToken_lt_gt=function(T){var H=this.input.charCodeAt(this.pos+1),_e=1;return H===T?(_e=T===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+_e)===61?this.finishOp(ie.assign,_e+1):this.finishOp(ie.bitShift,_e)):H===33&&T===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(H===61&&(_e=2),this.finishOp(ie.relational,_e))},An.readToken_eq_excl=function(T){var H=this.input.charCodeAt(this.pos+1);return H===61?this.finishOp(ie.equality,this.input.charCodeAt(this.pos+2)===61?3:2):T===61&&H===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(ie.arrow)):this.finishOp(T===61?ie.eq:ie.prefix,1)},An.readToken_question=function(){var T=this.options.ecmaVersion;if(T>=11){var H=this.input.charCodeAt(this.pos+1);if(H===46){var _e=this.input.charCodeAt(this.pos+2);if(_e<48||_e>57)return this.finishOp(ie.questionDot,2)}if(H===63){if(T>=12){var ne=this.input.charCodeAt(this.pos+2);if(ne===61)return this.finishOp(ie.assign,3)}return this.finishOp(ie.coalesce,2)}}return this.finishOp(ie.question,1)},An.getTokenFromCode=function(T){switch(T){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(ie.parenL);case 41:return++this.pos,this.finishToken(ie.parenR);case 59:return++this.pos,this.finishToken(ie.semi);case 44:return++this.pos,this.finishToken(ie.comma);case 91:return++this.pos,this.finishToken(ie.bracketL);case 93:return++this.pos,this.finishToken(ie.bracketR);case 123:return++this.pos,this.finishToken(ie.braceL);case 125:return++this.pos,this.finishToken(ie.braceR);case 58:return++this.pos,this.finishToken(ie.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(ie.backQuote);case 48:var H=this.input.charCodeAt(this.pos+1);if(H===120||H===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(H===111||H===79)return this.readRadixNumber(8);if(H===98||H===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(T);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(T);case 124:case 38:return this.readToken_pipe_amp(T);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(T);case 60:case 62:return this.readToken_lt_gt(T);case 61:case 33:return this.readToken_eq_excl(T);case 63:return this.readToken_question();case 126:return this.finishOp(ie.prefix,1)}this.raise(this.pos,"Unexpected character '"+Wi(T)+"'")},An.finishOp=function(T,H){var _e=this.input.slice(this.pos,this.pos+H);return this.pos+=H,this.finishToken(T,_e)},An.readRegexp=function(){for(var T,H,_e=this.pos;;){this.pos>=this.input.length&&this.raise(_e,"Unterminated regular expression");var ne=this.input.charAt(this.pos);if(ft.test(ne)&&this.raise(_e,"Unterminated regular expression"),T)T=!1;else{if(ne==="[")H=!0;else if(ne==="]"&&H)H=!1;else if(ne==="/"&&!H)break;T=ne==="\\"}++this.pos}var $e=this.input.slice(_e,this.pos);++this.pos;var xt=this.pos,zt=this.readWord1();this.containsEsc&&this.unexpected(xt);var _r=this.regexpState||(this.regexpState=new Ft(this));_r.reset(_e,$e,zt),this.validateRegExpFlags(_r),this.validateRegExpPattern(_r);var xr=null;try{xr=new RegExp($e,zt)}catch(dn){}return this.finishToken(ie.regexp,{pattern:$e,flags:zt,value:xr})},An.readInt=function(T,H,_e){for(var ne=this.options.ecmaVersion>=12&&H===void 0,$e=_e&&this.input.charCodeAt(this.pos)===48,xt=this.pos,zt=0,_r=0,xr=0,dn=H==null?1/0:H;xr<dn;++xr,++this.pos){var Bn=this.input.charCodeAt(this.pos),zi=void 0;if(ne&&Bn===95){$e&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),_r===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),xr===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),_r=Bn;continue}if(Bn>=97?zi=Bn-97+10:Bn>=65?zi=Bn-65+10:Bn>=48&&Bn<=57?zi=Bn-48:zi=1/0,zi>=T)break;_r=Bn,zt=zt*T+zi}return ne&&_r===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===xt||H!=null&&this.pos-xt!==H?null:zt};function Ui(T,H){return H?parseInt(T,8):parseFloat(T.replace(/_/g,""))}function fa(T){return typeof BigInt!="function"?null:BigInt(T.replace(/_/g,""))}An.readRadixNumber=function(T){var H=this.pos;this.pos+=2;var _e=this.readInt(T);return _e==null&&this.raise(this.start+2,"Expected number in radix "+T),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(_e=fa(this.input.slice(H,this.pos)),++this.pos):Ce(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(ie.num,_e)},An.readNumber=function(T){var H=this.pos;!T&&this.readInt(10,void 0,!0)===null&&this.raise(H,"Invalid number");var _e=this.pos-H>=2&&this.input.charCodeAt(H)===48;_e&&this.strict&&this.raise(H,"Invalid number");var ne=this.input.charCodeAt(this.pos);if(!_e&&!T&&this.options.ecmaVersion>=11&&ne===110){var $e=fa(this.input.slice(H,this.pos));return++this.pos,Ce(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(ie.num,$e)}_e&&/[89]/.test(this.input.slice(H,this.pos))&&(_e=!1),ne===46&&!_e&&(++this.pos,this.readInt(10),ne=this.input.charCodeAt(this.pos)),(ne===69||ne===101)&&!_e&&(ne=this.input.charCodeAt(++this.pos),(ne===43||ne===45)&&++this.pos,this.readInt(10)===null&&this.raise(H,"Invalid number")),Ce(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var xt=Ui(this.input.slice(H,this.pos),_e);return this.finishToken(ie.num,xt)},An.readCodePoint=function(){var T=this.input.charCodeAt(this.pos),H;if(T===123){this.options.ecmaVersion<6&&this.unexpected();var _e=++this.pos;H=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,H>1114111&&this.invalidStringToken(_e,"Code point out of bounds")}else H=this.readHexChar(4);return H};function Wi(T){return T<=65535?String.fromCharCode(T):(T-=65536,String.fromCharCode((T>>10)+55296,(T&1023)+56320))}An.readString=function(T){for(var H="",_e=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var ne=this.input.charCodeAt(this.pos);if(ne===T)break;ne===92?(H+=this.input.slice(_e,this.pos),H+=this.readEscapedChar(!1),_e=this.pos):(Ae(ne,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return H+=this.input.slice(_e,this.pos++),this.finishToken(ie.string,H)};var ct={};An.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(T){if(T===ct)this.readInvalidTemplateToken();else throw T}this.inTemplateElement=!1},An.invalidStringToken=function(T,H){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw ct;this.raise(T,H)},An.readTmplToken=function(){for(var T="",H=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var _e=this.input.charCodeAt(this.pos);if(_e===96||_e===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===ie.template||this.type===ie.invalidTemplate)?_e===36?(this.pos+=2,this.finishToken(ie.dollarBraceL)):(++this.pos,this.finishToken(ie.backQuote)):(T+=this.input.slice(H,this.pos),this.finishToken(ie.template,T));if(_e===92)T+=this.input.slice(H,this.pos),T+=this.readEscapedChar(!0),H=this.pos;else if(Ae(_e)){switch(T+=this.input.slice(H,this.pos),++this.pos,_e){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:T+=`
`;break;default:T+=String.fromCharCode(_e);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),H=this.pos}else++this.pos}},An.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(ie.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},An.readEscapedChar=function(T){var H=this.input.charCodeAt(++this.pos);switch(++this.pos,H){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Wi(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(T){var _e=this.pos-1;return this.invalidStringToken(_e,"Invalid escape sequence in template string"),null}default:if(H>=48&&H<=55){var ne=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],$e=parseInt(ne,8);return $e>255&&(ne=ne.slice(0,-1),$e=parseInt(ne,8)),this.pos+=ne.length-1,H=this.input.charCodeAt(this.pos),(ne!=="0"||H===56||H===57)&&(this.strict||T)&&this.invalidStringToken(this.pos-1-ne.length,T?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode($e)}return Ae(H)?"":String.fromCharCode(H)}},An.readHexChar=function(T){var H=this.pos,_e=this.readInt(16,T);return _e===null&&this.invalidStringToken(H,"Bad character escape sequence"),_e},An.readWord1=function(){this.containsEsc=!1;for(var T="",H=!0,_e=this.pos,ne=this.options.ecmaVersion>=6;this.pos<this.input.length;){var $e=this.fullCharCodeAtPos();if(We($e,ne))this.pos+=$e<=65535?1:2;else if($e===92){this.containsEsc=!0,T+=this.input.slice(_e,this.pos);var xt=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var zt=this.readCodePoint();(H?Ce:We)(zt,ne)||this.invalidStringToken(xt,"Invalid Unicode escape"),T+=Wi(zt),_e=this.pos}else break;H=!1}return T+this.input.slice(_e,this.pos)},An.readWord=function(){var T=this.readWord1(),H=ie.name;return this.keywords.test(T)&&(H=Xe[T]),this.finishToken(H,T)};var qi="7.4.1";Pr.acorn={Parser:Pr,version:qi,defaultOptions:Ht,Position:be,SourceLocation:vt,getLineInfo:bt,Node:Ni,TokenType:me,tokTypes:ie,keywordTypes:Xe,TokContext:Ia,tokContexts:an,isIdentifierChar:We,isIdentifierStart:Ce,Token:qr,isNewLine:Ae,lineBreak:ft,lineBreakG:ve,nonASCIIwhitespace:Re};function Na(T,H){return Pr.parse(T,H)}function To(T,H,_e){return Pr.parseExpressionAt(T,H,_e)}function ao(T,H){return Pr.tokenizer(T,H)}function Ga(T,H){T.prototype=Object.create(H.prototype),T.prototype.constructor=T,T.__proto__=H}function Ko(T){var H=typeof Map=="function"?new Map:void 0;return Ko=function(ne){if(ne===null||!su(ne))return ne;if(typeof ne!="function")throw new TypeError("Super expression must either be null or a function");if(typeof H!="undefined"){if(H.has(ne))return H.get(ne);H.set(ne,$e)}function $e(){return Fo(ne,arguments,ns(this).constructor)}return $e.prototype=Object.create(ne.prototype,{constructor:{value:$e,enumerable:!1,writable:!0,configurable:!0}}),zo($e,ne)},Ko(T)}function ws(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(T){return!1}}function Fo(T,H,_e){return ws()?Fo=Reflect.construct:Fo=function($e,xt,zt){var _r=[null];_r.push.apply(_r,xt);var xr=Function.bind.apply($e,_r),dn=new xr;return zt&&zo(dn,zt.prototype),dn},Fo.apply(null,arguments)}function su(T){return Function.toString.call(T).indexOf("[native code]")!==-1}function zo(T,H){return zo=Object.setPrototypeOf||function(ne,$e){return ne.__proto__=$e,ne},zo(T,H)}function ns(T){return ns=Object.setPrototypeOf?Object.getPrototypeOf:function(_e){return _e.__proto__||Object.getPrototypeOf(_e)},ns(T)}var ls=function(T){Ga(H,T);function H(){return T.apply(this,arguments)||this}return H}(Ko(Error)),_o=function(T){Ga(H,T);function H(){return T.apply(this,arguments)||this}return H}(Ko(SyntaxError)),Po=function(T){Ga(H,T);function H(){return T.apply(this,arguments)||this}return H}(Ko(ReferenceError)),Ss=function(T){Ga(H,T);function H(){return T.apply(this,arguments)||this}return H}(Ko(TypeError)),Wu=function(T){Ga(H,T);function H(){return T.apply(this,arguments)||this}return H}(ls),$s=function(T){Ga(H,T);function H(){return T.apply(this,arguments)||this}return H}(_o),uu=function(T){Ga(H,T);function H(){return T.apply(this,arguments)||this}return H}(Po),Jo={UnknownError:[3001,"%0",Wu],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",Wu],NodeTypeSyntaxError:[1001,"Unknown node type: %0",uu],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",uu],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",uu],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",uu],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",uu],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",uu],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",uu],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",uu],ParamTypeSyntaxError:[1009,"Unknown param type: %0",uu],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",uu],FunctionUndefinedReferenceError:[2001,"%0 is not a function",Po],VariableUndefinedReferenceError:[2002,"%0 is not defined",Po],IsNotConstructor:[2003,"%0 is not a constructor",Ss]};function ms(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(T){return!1}}function eu(T,H,_e){return ms()?eu=Reflect.construct:eu=function($e,xt,zt){var _r=[null];_r.push.apply(_r,xt);var xr=Function.bind.apply($e,_r),dn=new xr;return zt&&Bs(dn,zt.prototype),dn},eu.apply(null,arguments)}function Bs(T,H){return Bs=Object.setPrototypeOf||function(ne,$e){return ne.__proto__=$e,ne},Bs(T,H)}var fi="0.0.3";function is(T,H){Object.defineProperty(T,"name",{value:H,writable:!1,enumerable:!1,configurable:!0})}var ku=Object.prototype.hasOwnProperty,mt=Symbol("Break"),Gt=Symbol("Continue"),Cr=Symbol("DefaultCase"),Rr=Symbol("EmptyStatementReturn"),ji=Symbol("WithScopeName"),Pa=Symbol("SuperScopeName"),Yt=Symbol("RootScopeName"),De=Symbol("GlobalScopeName");function Me(T){return typeof T=="function"}var ce=function(){function T(_e){this.interpreter=_e}var H=T.prototype;return H.generator=function(){var ne=this.interpreter;function $e(){return this.getCurrentScope()}function xt(){return this.getGlobalScope()}function zt(){return this.getCurrentContext()}return{getOptions:ne.getOptions.bind(ne),getCurrentScope:$e.bind(ne),getGlobalScope:xt.bind(ne),getCurrentContext:zt.bind(ne),getExecStartTime:ne.getExecStartTime.bind(ne)}},T}();function He(T,H,_e){if(_e===void 0&&(_e=!0),!(T instanceof ce))throw new Error("Illegal call");if(typeof H!="string")return H;if(H){var ne=T.generator(),$e=ne.getOptions(),xt={timeout:$e.timeout,_initEnv:function(){_e||this.setCurrentContext(ne.getCurrentContext()),this.execStartTime=ne.getExecStartTime(),this.execEndTime=this.execStartTime}},zt=_e?ne.getGlobalScope():ne.getCurrentScope(),_r=new Xt(zt,xt);return _r.evaluate(H)}}Object.defineProperty(He,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function Pe(T){if(!(T instanceof ce))throw new Error("Illegal call");for(var H=T.generator(),_e=arguments.length,ne=new Array(_e>1?_e-1:0),$e=1;$e<_e;$e++)ne[$e-1]=arguments[$e];var xt=ne.pop(),zt=new Xt(H.getGlobalScope(),H.getOptions()),_r=`
		    (function anonymous(`+ne.join(",")+`){
		        `+xt+`
		    });
		    `;return zt.evaluate(_r)}Object.defineProperty(Pe,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var Tt=function(H){this.value=H},Mt=function(H){this.value=H},$t=function(H){this.value=H},fr=function(H,_e,ne){_e===void 0&&(_e=null),this.name=ne,this.parent=_e,this.data=H,this.labelStack=[]};function Tr(){}function Sr(T,H){return T===void 0&&(T=null),new fr(Object.create(null),T,H)}function sn(T){return Object.create(T)}var lt={NaN:NaN,Infinity:1/0,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:He,Function:Pe};typeof JSON!="undefined"&&(lt.JSON=JSON),typeof Promise!="undefined"&&(lt.Promise=Promise),typeof Set!="undefined"&&(lt.Set=Set),typeof Map!="undefined"&&(lt.Map=Map),typeof Symbol!="undefined"&&(lt.Symbol=Symbol),typeof Proxy!="undefined"&&(lt.Proxy=Proxy),typeof WeakMap!="undefined"&&(lt.WeakMap=WeakMap),typeof WeakSet!="undefined"&&(lt.WeakSet=WeakSet),typeof Reflect!="undefined"&&(lt.Reflect=Reflect);var Xt=function(){function T(_e,ne){_e===void 0&&(_e=T.global),ne===void 0&&(ne={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:ne.ecmaVersion||T.ecmaVersion,timeout:ne.timeout||0,rootContext:ne.rootContext,globalContextInFunction:ne.globalContextInFunction===void 0?T.globalContextInFunction:ne.globalContextInFunction,_initEnv:ne._initEnv},this.context=_e||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var H=T.prototype;return H.initEnvironment=function(ne){var $e;if(ne instanceof fr)$e=ne;else{var xt=null,zt=this.createSuperScope(ne);this.options.rootContext&&(xt=new fr(sn(this.options.rootContext),zt,Yt)),$e=new fr(ne,xt||zt,De)}this.globalScope=$e,this.currentScope=this.globalScope,this.globalContext=$e.data,this.currentContext=$e.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var _r=this.options._initEnv;_r&&_r.call(this)},H.getExecStartTime=function(){return this.execStartTime},H.getExecutionTime=function(){return this.execEndTime-this.execStartTime},H.setExecTimeout=function(ne){ne===void 0&&(ne=0),this.options.timeout=ne},H.getOptions=function(){return this.options},H.getGlobalScope=function(){return this.globalScope},H.getCurrentScope=function(){return this.currentScope},H.getCurrentContext=function(){return this.currentContext},H.isInterruptThrow=function(ne){return ne instanceof Wu||ne instanceof uu||ne instanceof $s},H.createSuperScope=function(ne){var $e=Object.assign({},lt),xt=Object.keys($e);return xt.forEach(function(zt){zt in ne&&delete $e[zt]}),new fr($e,null,Pa)},H.setCurrentContext=function(ne){this.currentContext=ne},H.setCurrentScope=function(ne){this.currentScope=ne},H.evaluate=function(ne){ne===void 0&&(ne="");var $e;if(ne)return $e=Na(ne,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||T.ecmaVersion}),this.evaluateNode($e,ne)},H.appendCode=function(ne){return this.evaluate(ne)},H.evaluateNode=function(ne,$e){var xt=this;$e===void 0&&($e=""),this.value=void 0,this.source=$e,this.sourceList.push($e),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var zt=this.getCurrentScope(),_r=this.getCurrentContext(),xr=zt.labelStack.concat([]),dn=this.callStack.concat([]),Bn=function(){xt.setCurrentScope(zt),xt.setCurrentContext(_r),zt.labelStack=xr,xt.callStack=dn};try{var zi=this.createClosure(ne);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),zi()}catch(Vi){throw Vi}finally{Bn(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},H.createErrorMessage=function(ne,$e,xt){var zt=ne[1].replace("%0",String($e));return xt!==null&&(zt+=this.getNodePosition(xt||this.lastExecNode)),zt},H.createError=function(ne,$e){return new $e(ne)},H.createThrowError=function(ne,$e){return this.createError(ne,$e)},H.createInternalThrowError=function(ne,$e,xt){return this.createError(this.createErrorMessage(ne,$e,xt),ne[2])},H.checkTimeout=function(){if(!this.isRunning)return!1;var ne=this.options.timeout||0,$e=Date.now();return $e-this.execStartTime>ne},H.getNodePosition=function(ne){if(ne){var $e="";return ne.loc?" ["+ne.loc.start.line+":"+ne.loc.start.column+"]"+$e:""}return""},H.createClosure=function(ne){var $e=this,xt;switch(ne.type){case"BinaryExpression":xt=this.binaryExpressionHandler(ne);break;case"LogicalExpression":xt=this.logicalExpressionHandler(ne);break;case"UnaryExpression":xt=this.unaryExpressionHandler(ne);break;case"UpdateExpression":xt=this.updateExpressionHandler(ne);break;case"ObjectExpression":xt=this.objectExpressionHandler(ne);break;case"ArrayExpression":xt=this.arrayExpressionHandler(ne);break;case"CallExpression":xt=this.callExpressionHandler(ne);break;case"NewExpression":xt=this.newExpressionHandler(ne);break;case"MemberExpression":xt=this.memberExpressionHandler(ne);break;case"ThisExpression":xt=this.thisExpressionHandler(ne);break;case"SequenceExpression":xt=this.sequenceExpressionHandler(ne);break;case"Literal":xt=this.literalHandler(ne);break;case"Identifier":xt=this.identifierHandler(ne);break;case"AssignmentExpression":xt=this.assignmentExpressionHandler(ne);break;case"FunctionDeclaration":xt=this.functionDeclarationHandler(ne);break;case"VariableDeclaration":xt=this.variableDeclarationHandler(ne);break;case"BlockStatement":case"Program":xt=this.programHandler(ne);break;case"ExpressionStatement":xt=this.expressionStatementHandler(ne);break;case"EmptyStatement":xt=this.emptyStatementHandler(ne);break;case"ReturnStatement":xt=this.returnStatementHandler(ne);break;case"FunctionExpression":xt=this.functionExpressionHandler(ne);break;case"IfStatement":xt=this.ifStatementHandler(ne);break;case"ConditionalExpression":xt=this.conditionalExpressionHandler(ne);break;case"ForStatement":xt=this.forStatementHandler(ne);break;case"WhileStatement":xt=this.whileStatementHandler(ne);break;case"DoWhileStatement":xt=this.doWhileStatementHandler(ne);break;case"ForInStatement":xt=this.forInStatementHandler(ne);break;case"WithStatement":xt=this.withStatementHandler(ne);break;case"ThrowStatement":xt=this.throwStatementHandler(ne);break;case"TryStatement":xt=this.tryStatementHandler(ne);break;case"ContinueStatement":xt=this.continueStatementHandler(ne);break;case"BreakStatement":xt=this.breakStatementHandler(ne);break;case"SwitchStatement":xt=this.switchStatementHandler(ne);break;case"LabeledStatement":xt=this.labeledStatementHandler(ne);break;case"DebuggerStatement":xt=this.debuggerStatementHandler(ne);break;default:throw this.createInternalThrowError(Jo.NodeTypeSyntaxError,ne.type,ne)}return function(){var zt=$e.options.timeout;if(zt&&zt>0&&$e.checkTimeout())throw $e.createInternalThrowError(Jo.ExecutionTimeOutError,zt,null);return $e.lastExecNode=ne,xt.apply(void 0,arguments)}},H.binaryExpressionHandler=function(ne){var $e=this,xt=this.createClosure(ne.left),zt=this.createClosure(ne.right);return function(){var _r=xt(),xr=zt();switch(ne.operator){case"==":return _r==xr;case"!=":return _r!=xr;case"===":return _r===xr;case"!==":return _r!==xr;case"<":return _r<xr;case"<=":return _r<=xr;case">":return _r>xr;case">=":return _r>=xr;case"<<":return _r<<xr;case">>":return _r>>xr;case">>>":return _r>>>xr;case"+":return _r+xr;case"-":return _r-xr;case"*":return _r*xr;case"**":return Math.pow(_r,xr);case"/":return _r/xr;case"%":return _r%xr;case"|":return _r|xr;case"^":return _r^xr;case"&":return _r&xr;case"in":return _r in xr;case"instanceof":return _r instanceof xr;default:throw $e.createInternalThrowError(Jo.BinaryOperatorSyntaxError,ne.operator,ne)}}},H.logicalExpressionHandler=function(ne){var $e=this,xt=this.createClosure(ne.left),zt=this.createClosure(ne.right);return function(){switch(ne.operator){case"||":return xt()||zt();case"&&":return xt()&&zt();default:throw $e.createInternalThrowError(Jo.LogicalOperatorSyntaxError,ne.operator,ne)}}},H.unaryExpressionHandler=function(ne){var $e=this;switch(ne.operator){case"delete":var xt=this.createObjectGetter(ne.argument),zt=this.createNameGetter(ne.argument);return function(){var Bn=xt(),zi=zt();return delete Bn[zi]};default:var _r;if(ne.operator==="typeof"&&ne.argument.type==="Identifier"){var xr=this.createObjectGetter(ne.argument),dn=this.createNameGetter(ne.argument);_r=function(){return xr()[dn()]}}else _r=this.createClosure(ne.argument);return function(){var Bn=_r();switch(ne.operator){case"-":return-Bn;case"+":return+Bn;case"!":return!Bn;case"~":return~Bn;case"void":return;case"typeof":return typeof Bn;default:throw $e.createInternalThrowError(Jo.UnaryOperatorSyntaxError,ne.operator,ne)}}}},H.updateExpressionHandler=function(ne){var $e=this,xt=this.createObjectGetter(ne.argument),zt=this.createNameGetter(ne.argument);return function(){var _r=xt(),xr=zt();switch($e.assertVariable(_r,xr,ne),ne.operator){case"++":return ne.prefix?++_r[xr]:_r[xr]++;case"--":return ne.prefix?--_r[xr]:_r[xr]--;default:throw $e.createInternalThrowError(Jo.UpdateOperatorSyntaxError,ne.operator,ne)}}},H.objectExpressionHandler=function(ne){var $e=this,xt=[];function zt(xr){return xr.type==="Identifier"?xr.name:xr.type==="Literal"?xr.value:this.throwError(Jo.ObjectStructureSyntaxError,xr.type,xr)}var _r=Object.create(null);return ne.properties.forEach(function(xr){var dn=xr.kind,Bn=zt(xr.key);(!_r[Bn]||dn==="init")&&(_r[Bn]={}),_r[Bn][dn]=$e.createClosure(xr.value),xt.push({key:Bn,property:xr})}),function(){for(var xr={},dn=xt.length,Bn=0;Bn<dn;Bn++){var zi=xt[Bn],Vi=zi.key,Ei=_r[Vi],qa=Ei.init?Ei.init():void 0,$a=Ei.get?Ei.get():function(){},La=Ei.set?Ei.set():function(bo){};if("set"in Ei||"get"in Ei){var to={configurable:!0,enumerable:!0,get:$a,set:La};Object.defineProperty(xr,Vi,to)}else{var Ho=zi.property,xo=Ho.kind;Ho.key.type==="Identifier"&&Ho.value.type==="FunctionExpression"&&xo==="init"&&!Ho.value.id&&is(qa,Ho.key.name),xr[Vi]=qa}}return xr}},H.arrayExpressionHandler=function(ne){var $e=this,xt=ne.elements.map(function(zt){return zt&&$e.createClosure(zt)});return function(){for(var zt=xt.length,_r=Array(zt),xr=0;xr<zt;xr++){var dn=xt[xr];dn&&(_r[xr]=dn())}return _r}},H.safeObjectGet=function(ne,$e,xt){return ne[$e]},H.createCallFunctionGetter=function(ne){var $e=this;switch(ne.type){case"MemberExpression":var xt=this.createClosure(ne.object),zt=this.createMemberKeyGetter(ne),_r=this.source;return function(){var dn=xt(),Bn=zt(),zi=$e.safeObjectGet(dn,Bn,ne);if(!zi||!Me(zi)){var Vi=_r.slice(ne.start,ne.end);throw $e.createInternalThrowError(Jo.FunctionUndefinedReferenceError,Vi,ne)}return zi.__IS_EVAL_FUNC?function(Ei){return zi(new ce($e),Ei,!0)}:zi.__IS_FUNCTION_FUNC?function(){for(var Ei=arguments.length,qa=new Array(Ei),$a=0;$a<Ei;$a++)qa[$a]=arguments[$a];return zi.apply(void 0,[new ce($e)].concat(qa))}:zi.bind(dn)};default:var xr=this.createClosure(ne);return function(){var dn="";ne.type==="Identifier"&&(dn=ne.name);var Bn=xr();if(!Bn||!Me(Bn))throw $e.createInternalThrowError(Jo.FunctionUndefinedReferenceError,dn,ne);if(ne.type==="Identifier"&&Bn.__IS_EVAL_FUNC&&dn==="eval")return function(Ei){var qa=$e.getScopeFromName(dn,$e.getCurrentScope()),$a=qa.name===Pa||qa.name===De||qa.name===Yt;return Bn(new ce($e),Ei,!$a)};if(Bn.__IS_EVAL_FUNC)return function(Ei){return Bn(new ce($e),Ei,!0)};if(Bn.__IS_FUNCTION_FUNC)return function(){for(var Ei=arguments.length,qa=new Array(Ei),$a=0;$a<Ei;$a++)qa[$a]=arguments[$a];return Bn.apply(void 0,[new ce($e)].concat(qa))};var zi=$e.options.globalContextInFunction;if(ne.type==="Identifier"){var Vi=$e.getIdentifierScope(ne);Vi.name===ji&&(zi=Vi.data)}return Bn.bind(zi)}}},H.callExpressionHandler=function(ne){var $e=this,xt=this.createCallFunctionGetter(ne.callee),zt=ne.arguments.map(function(_r){return $e.createClosure(_r)});return function(){return xt().apply(void 0,zt.map(function(_r){return _r()}))}},H.functionExpressionHandler=function(ne){var $e=this,xt=this,zt=this.source,_r=this.collectDeclVars,xr=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var dn=ne.id?ne.id.name:"",Bn=ne.params.length,zi=ne.params.map(function($a){return $e.createParamNameGetter($a)}),Vi=this.createClosure(ne.body),Ei=this.collectDeclVars,qa=this.collectDeclFuncs;return this.collectDeclVars=_r,this.collectDeclFuncs=xr,function(){var $a=xt.getCurrentScope(),La=function to(){for(var Ho=arguments.length,xo=new Array(Ho),bo=0;bo<Ho;bo++)xo[bo]=arguments[bo];xt.callStack.push(""+dn);var so=xt.getCurrentScope(),Cs=Sr($a,"FunctionScope("+dn+")");xt.setCurrentScope(Cs),xt.addDeclarationsToScope(Ei,qa,Cs),dn&&(Cs.data[dn]=to),Cs.data.arguments=arguments,zi.forEach(function(lu,ps){Cs.data[lu()]=xo[ps]});var Ls=xt.getCurrentContext();xt.setCurrentContext(this);var Rs=Vi();if(xt.setCurrentContext(Ls),xt.setCurrentScope(so),xt.callStack.pop(),Rs instanceof Tt)return Rs.value};return is(La,dn),Object.defineProperty(La,"length",{value:Bn,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(La,"toString",{value:function(){return zt.slice(ne.start,ne.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(La,"valueOf",{value:function(){return zt.slice(ne.start,ne.end)},writable:!0,configurable:!0,enumerable:!1}),La}},H.newExpressionHandler=function(ne){var $e=this,xt=this.source,zt=this.createClosure(ne.callee),_r=ne.arguments.map(function(xr){return $e.createClosure(xr)});return function(){var xr=zt();if(!Me(xr)||xr.__IS_EVAL_FUNC){var dn=ne.callee,Bn=xt.slice(dn.start,dn.end);throw $e.createInternalThrowError(Jo.IsNotConstructor,Bn,ne)}return xr.__IS_FUNCTION_FUNC?xr.apply(void 0,[new ce($e)].concat(_r.map(function(zi){return zi()}))):eu(xr,_r.map(function(zi){return zi()}))}},H.memberExpressionHandler=function(ne){var $e=this.createClosure(ne.object),xt=this.createMemberKeyGetter(ne);return function(){var zt=$e(),_r=xt();return zt[_r]}},H.thisExpressionHandler=function(ne){var $e=this;return function(){return $e.getCurrentContext()}},H.sequenceExpressionHandler=function(ne){var $e=this,xt=ne.expressions.map(function(zt){return $e.createClosure(zt)});return function(){for(var zt,_r=xt.length,xr=0;xr<_r;xr++){var dn=xt[xr];zt=dn()}return zt}},H.literalHandler=function(ne){return function(){return ne.regex?new RegExp(ne.regex.pattern,ne.regex.flags):ne.value}},H.identifierHandler=function(ne){var $e=this;return function(){var xt=$e.getCurrentScope(),zt=$e.getScopeDataFromName(ne.name,xt);return $e.assertVariable(zt,ne.name,ne),zt[ne.name]}},H.getIdentifierScope=function(ne){var $e=this.getCurrentScope(),xt=this.getScopeFromName(ne.name,$e);return xt},H.assignmentExpressionHandler=function(ne){var $e=this;ne.left.type==="Identifier"&&ne.right.type==="FunctionExpression"&&!ne.right.id&&(ne.right.id={type:"Identifier",name:ne.left.name});var xt=this.createObjectGetter(ne.left),zt=this.createNameGetter(ne.left),_r=this.createClosure(ne.right);return function(){var xr=xt(),dn=zt(),Bn=_r();switch(ne.operator!=="="&&$e.assertVariable(xr,dn,ne),ne.operator){case"=":return xr[dn]=Bn;case"+=":return xr[dn]+=Bn;case"-=":return xr[dn]-=Bn;case"*=":return xr[dn]*=Bn;case"**=":return xr[dn]=Math.pow(xr[dn],Bn);case"/=":return xr[dn]/=Bn;case"%=":return xr[dn]%=Bn;case"<<=":return xr[dn]<<=Bn;case">>=":return xr[dn]>>=Bn;case">>>=":return xr[dn]>>>=Bn;case"&=":return xr[dn]&=Bn;case"^=":return xr[dn]^=Bn;case"|=":return xr[dn]|=Bn;default:throw $e.createInternalThrowError(Jo.AssignmentExpressionSyntaxError,ne.type,ne)}}},H.functionDeclarationHandler=function(ne){if(ne.id){var $e=this.functionExpressionHandler(ne);Object.defineProperty($e,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(ne.id.name,$e)}return function(){return Rr}},H.getVariableName=function(ne){if(ne.type==="Identifier")return ne.name;throw this.createInternalThrowError(Jo.VariableTypeSyntaxError,ne.type,ne)},H.variableDeclarationHandler=function(ne){for(var $e=this,xt,zt=[],_r=0;_r<ne.declarations.length;_r++){var xr=ne.declarations[_r];this.varDeclaration(this.getVariableName(xr.id)),xr.init&&zt.push({type:"AssignmentExpression",operator:"=",left:xr.id,right:xr.init})}return zt.length&&(xt=this.createClosure({type:"BlockStatement",body:zt})),function(){if(xt){var dn=$e.isVarDeclMode;$e.isVarDeclMode=!0,xt(),$e.isVarDeclMode=dn}return Rr}},H.assertVariable=function(ne,$e,xt){if(ne===this.globalScope.data&&!($e in ne))throw this.createInternalThrowError(Jo.VariableUndefinedReferenceError,$e,xt)},H.programHandler=function(ne){var $e=this,xt=ne.body.map(function(zt){return $e.createClosure(zt)});return function(){for(var zt=Rr,_r=0;_r<xt.length;_r++){var xr=xt[_r],dn=$e.setValue(xr());if(dn!==Rr&&(zt=dn,zt instanceof Tt||zt instanceof Mt||zt instanceof $t||zt===mt||zt===Gt))break}return zt}},H.expressionStatementHandler=function(ne){return this.createClosure(ne.expression)},H.emptyStatementHandler=function(ne){return function(){return Rr}},H.returnStatementHandler=function(ne){var $e=ne.argument?this.createClosure(ne.argument):Tr;return function(){return new Tt($e())}},H.ifStatementHandler=function(ne){var $e=this.createClosure(ne.test),xt=this.createClosure(ne.consequent),zt=ne.alternate?this.createClosure(ne.alternate):function(){return Rr};return function(){return $e()?xt():zt()}},H.conditionalExpressionHandler=function(ne){return this.ifStatementHandler(ne)},H.forStatementHandler=function(ne){var $e=this,xt=Tr,zt=ne.test?this.createClosure(ne.test):function(){return!0},_r=Tr,xr=this.createClosure(ne.body);return ne.type==="ForStatement"&&(xt=ne.init?this.createClosure(ne.init):xt,_r=ne.update?this.createClosure(ne.update):Tr),function(dn){var Bn,zi=Rr,Vi=ne.type==="DoWhileStatement";for(dn&&dn.type==="LabeledStatement"&&(Bn=dn.label.name),xt();Vi||zt();_r()){Vi=!1;var Ei=$e.setValue(xr());if(!(Ei===Rr||Ei===Gt)){if(Ei===mt)break;if(zi=Ei,zi instanceof $t&&zi.value===Bn){zi=Rr;continue}if(zi instanceof Tt||zi instanceof Mt||zi instanceof $t)break}}return zi}},H.whileStatementHandler=function(ne){return this.forStatementHandler(ne)},H.doWhileStatementHandler=function(ne){return this.forStatementHandler(ne)},H.forInStatementHandler=function(ne){var $e=this,xt=ne.left,zt=this.createClosure(ne.right),_r=this.createClosure(ne.body);return ne.left.type==="VariableDeclaration"&&(this.createClosure(ne.left)(),xt=ne.left.declarations[0].id),function(xr){var dn,Bn=Rr,zi;xr&&xr.type==="LabeledStatement"&&(dn=xr.label.name);var Vi=zt();for(zi in Vi){$e.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:xt,right:{type:"Literal",value:zi}})();var Ei=$e.setValue(_r());if(!(Ei===Rr||Ei===Gt)){if(Ei===mt)break;if(Bn=Ei,Bn instanceof $t&&Bn.value===dn){Bn=Rr;continue}if(Bn instanceof Tt||Bn instanceof Mt||Bn instanceof $t)break}}return Bn}},H.withStatementHandler=function(ne){var $e=this,xt=this.createClosure(ne.object),zt=this.createClosure(ne.body);return function(){var _r=xt(),xr=$e.getCurrentScope(),dn=new fr(_r,xr,ji);$e.setCurrentScope(dn);var Bn=$e.setValue(zt());return $e.setCurrentScope(xr),Bn}},H.throwStatementHandler=function(ne){var $e=this,xt=this.createClosure(ne.argument);return function(){throw $e.setValue(void 0),xt()}},H.tryStatementHandler=function(ne){var $e=this,xt=this.createClosure(ne.block),zt=ne.handler?this.catchClauseHandler(ne.handler):null,_r=ne.finalizer?this.createClosure(ne.finalizer):null;return function(){var xr=$e.getCurrentScope(),dn=$e.getCurrentContext(),Bn=xr.labelStack.concat([]),zi=$e.callStack.concat([]),Vi=Rr,Ei,qa,$a=function(){$e.setCurrentScope(xr),$e.setCurrentContext(dn),xr.labelStack=Bn,$e.callStack=zi};try{Vi=$e.setValue(xt()),Vi instanceof Tt&&(Ei=Vi)}catch(La){if($a(),$e.isInterruptThrow(La))throw La;if(zt)try{Vi=$e.setValue(zt(La)),Vi instanceof Tt&&(Ei=Vi)}catch(to){if($a(),$e.isInterruptThrow(to))throw to;qa=to}}if(_r)try{Vi=_r(),Vi instanceof Tt&&(Ei=Vi)}catch(La){if($a(),$e.isInterruptThrow(La))throw La;qa=La}if(qa)throw qa;return Ei||Vi}},H.catchClauseHandler=function(ne){var $e=this,xt=this.createParamNameGetter(ne.param),zt=this.createClosure(ne.body);return function(_r){var xr,dn=$e.getCurrentScope(),Bn=dn.data,zi=xt(),Vi=ku.call(Bn,zi),Ei=Bn[zi];return Bn[zi]=_r,xr=zt(),Vi?Bn[zi]=Ei:delete Bn[zi],xr}},H.continueStatementHandler=function(ne){return function(){return ne.label?new $t(ne.label.name):Gt}},H.breakStatementHandler=function(ne){return function(){return ne.label?new Mt(ne.label.name):mt}},H.switchStatementHandler=function(ne){var $e=this,xt=this.createClosure(ne.discriminant),zt=ne.cases.map(function(_r){return $e.switchCaseHandler(_r)});return function(){for(var _r=xt(),xr=!1,dn,Bn,zi,Vi=0;Vi<zt.length;Vi++){var Ei=zt[Vi](),qa=Ei.testClosure();if(qa===Cr){zi=Ei;continue}if(xr||qa===_r){if(xr=!0,Bn=$e.setValue(Ei.bodyClosure()),Bn===Rr)continue;if(Bn===mt||(dn=Bn,dn instanceof Tt||dn instanceof Mt||dn instanceof $t||dn===Gt))break}}if(!xr&&zi){Bn=$e.setValue(zi.bodyClosure());var $a=Bn===Rr||Bn===mt||Bn===Gt;$a||(dn=Bn)}return dn}},H.switchCaseHandler=function(ne){var $e=ne.test?this.createClosure(ne.test):function(){return Cr},xt=this.createClosure({type:"BlockStatement",body:ne.consequent});return function(){return{testClosure:$e,bodyClosure:xt}}},H.labeledStatementHandler=function(ne){var $e=this,xt=ne.label.name,zt=this.createClosure(ne.body);return function(){var _r,xr=$e.getCurrentScope();return xr.labelStack.push(xt),_r=zt(ne),_r instanceof Mt&&_r.value===xt&&(_r=Rr),xr.labelStack.pop(),_r}},H.debuggerStatementHandler=function(ne){return function(){debugger;return Rr}},H.createParamNameGetter=function(ne){if(ne.type==="Identifier")return function(){return ne.name};throw this.createInternalThrowError(Jo.ParamTypeSyntaxError,ne.type,ne)},H.createObjectKeyGetter=function(ne){var $e;return ne.type==="Identifier"?$e=function(){return ne.name}:$e=this.createClosure(ne),function(){return $e()}},H.createMemberKeyGetter=function(ne){return ne.computed?this.createClosure(ne.property):this.createObjectKeyGetter(ne.property)},H.createObjectGetter=function(ne){var $e=this;switch(ne.type){case"Identifier":return function(){return $e.getScopeDataFromName(ne.name,$e.getCurrentScope())};case"MemberExpression":return this.createClosure(ne.object);default:throw this.createInternalThrowError(Jo.AssignmentTypeSyntaxError,ne.type,ne)}},H.createNameGetter=function(ne){switch(ne.type){case"Identifier":return function(){return ne.name};case"MemberExpression":return this.createMemberKeyGetter(ne);default:throw this.createInternalThrowError(Jo.AssignmentTypeSyntaxError,ne.type,ne)}},H.varDeclaration=function(ne){var $e=this.collectDeclVars;$e[ne]=void 0},H.funcDeclaration=function(ne,$e){var xt=this.collectDeclFuncs;xt[ne]=$e},H.addDeclarationsToScope=function(ne,$e,xt){var zt=xt.data;for(var _r in $e){var xr=$e[_r];zt[_r]=xr&&xr()}for(var dn in ne)dn in zt||(zt[dn]=void 0)},H.getScopeValue=function(ne,$e){var xt=this.getScopeFromName(ne,$e);return xt.data[ne]},H.getScopeDataFromName=function(ne,$e){return this.getScopeFromName(ne,$e).data},H.getScopeFromName=function(ne,$e){var xt=$e;do if(ne in xt.data)return xt;while(xt=xt.parent);return this.globalScope},H.setValue=function(ne){var $e=this.callStack.length;return this.isVarDeclMode||$e||ne===Rr||ne===mt||ne===Gt||ne instanceof Mt||ne instanceof $t||(this.value=ne instanceof Tt?ne.value:ne),ne},H.getValue=function(){return this.value},T}();Xt.version=fi,Xt.eval=He,Xt.Function=Pe,Xt.ecmaVersion=5,Xt.globalContextInFunction=void 0,Xt.global=Object.create(null);function nr(T){return T===void 0&&(T=Object.create(null)),T}function ur(T,H,_e){H===void 0&&(H=[]),_e===void 0&&(_e={});var ne=_e.parsingContext,$e=_e.timeout===void 0?0:_e.timeout,xt=`
    (function anonymous(`+H.join(",")+`){
         `+T+`
    });
    `,zt=new Xt(ne,{ecmaVersion:_e.ecmaVersion,timeout:$e,rootContext:_e.rootContext,globalContextInFunction:_e.globalContextInFunction});return zt.evaluate(xt)}function Vr(T,H,_e){var ne=new Xt(H,_e);return ne.evaluate(T)}var ln=Vr,Un=function(){function T(_e){this._code=_e}var H=T.prototype;return H.runInContext=function(ne){return Vr(this._code,ne)},H.runInNewContext=function(ne){return Vr(this._code,ne)},T}(),Gn=function(T,H,_e){return Vr(T,H,_e)};function qn(){for(var T=arguments.length,H=new Array(T),_e=0;_e<T;_e++)H[_e]=arguments[_e];var ne=H.pop();return ur(ne||"",H)}var oi=Gn},20396:function(Ne,fe,I){var D;(function(k,m,ae,F){"use strict";var K=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,W=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),Y=K||W,G=["","webkit","Moz","MS","ms","o"],$=Y?"":m.createElement("div"),xe="function",Fe=Math.round,Ce=Math.abs,We=Date.now;function me(mt,Gt,Cr){return setTimeout(ve(mt,Cr),Gt)}function Ge(mt,Gt,Cr){return Array.isArray(mt)?(Ke(mt,Cr[Gt],Cr),!0):!1}function Ke(mt,Gt,Cr){var Rr;if(mt)if(mt.forEach)mt.forEach(Gt,Cr);else if(mt.length!==F)for(Rr=0;Rr<mt.length;)Gt.call(Cr,mt[Rr],Rr,mt),Rr++;else for(Rr in mt)mt.hasOwnProperty(Rr)&&Gt.call(Cr,mt[Rr],Rr,mt)}function pt(mt,Gt,Cr){var Rr="DEPRECATED METHOD: "+Gt+`
`+Cr+` AT 
`;return function(){var ji=new Error("get-stack-trace"),Pa=ji&&ji.stack?ji.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Yt=k.console&&(k.console.warn||k.console.log);return Yt&&Yt.call(k.console,Rr,Pa),mt.apply(this,arguments)}}var Xe;typeof Object.assign!="function"?Xe=function(Gt){if(Gt===F||Gt===null)throw new TypeError("Cannot convert undefined or null to object");for(var Cr=Object(Gt),Rr=1;Rr<arguments.length;Rr++){var ji=arguments[Rr];if(ji!==F&&ji!==null)for(var Pa in ji)ji.hasOwnProperty(Pa)&&(Cr[Pa]=ji[Pa])}return Cr}:Xe=Object.assign;var gt=pt(function(Gt,Cr,Rr){for(var ji=Object.keys(Cr),Pa=0;Pa<ji.length;)(!Rr||Rr&&Gt[ji[Pa]]===F)&&(Gt[ji[Pa]]=Cr[ji[Pa]]),Pa++;return Gt},"extend","Use `assign`."),ie=pt(function(Gt,Cr){return gt(Gt,Cr,!0)},"merge","Use `assign`.");function ft(mt,Gt,Cr){var Rr=Gt.prototype,ji;ji=mt.prototype=Object.create(Rr),ji.constructor=mt,ji._super=Rr,Cr&&Xe(ji,Cr)}function ve(mt,Gt){return function(){return mt.apply(Gt,arguments)}}function Ae(mt,Gt){return typeof mt==xe?mt.apply(Gt&&Gt[0]||F,Gt):mt}function Re(mt,Gt){return mt===F?Gt:mt}function Ye(mt,Gt,Cr){Ke(Qe(Gt),function(Rr){mt.addEventListener(Rr,Cr,!1)})}function at(mt,Gt,Cr){Ke(Qe(Gt),function(Rr){mt.removeEventListener(Rr,Cr,!1)})}function ht(mt,Gt){for(;mt;){if(mt==Gt)return!0;mt=mt.parentNode}return!1}function Se(mt,Gt){return mt.indexOf(Gt)>-1}function Qe(mt){return mt.trim().split(/\s+/g)}function oe(mt,Gt,Cr){if(mt.indexOf&&!Cr)return mt.indexOf(Gt);for(var Rr=0;Rr<mt.length;){if(Cr&&mt[Rr][Cr]==Gt||!Cr&&mt[Rr]===Gt)return Rr;Rr++}return-1}function ue(mt){return Array.prototype.slice.call(mt,0)}function be(mt,Gt,Cr){for(var Rr=[],ji=[],Pa=0;Pa<mt.length;){var Yt=Gt?mt[Pa][Gt]:mt[Pa];oe(ji,Yt)<0&&Rr.push(mt[Pa]),ji[Pa]=Yt,Pa++}return Cr&&(Gt?Rr=Rr.sort(function(Me,ce){return Me[Gt]>ce[Gt]}):Rr=Rr.sort()),Rr}function vt(mt,Gt){for(var Cr,Rr,ji=Gt[0].toUpperCase()+Gt.slice(1),Pa=0;Pa<G.length;){if(Cr=G[Pa],Rr=Cr?Cr+ji:Gt,Rr in mt)return Rr;Pa++}return F}var bt=1;function Ht(){return bt++}function Er(mt){var Gt=mt.ownerDocument||mt;return Gt.defaultView||Gt.parentWindow||k}var Vt=/mobile|tablet|ip(ad|hone|od)|android/i,on="ontouchstart"in k,hn=vt(k,"PointerEvent")!==F,gi=on&&Vt.test(navigator.userAgent),Hn="touch",Dt="pen",Ea="mouse",Ze="kinect",ci=25,Ci=1,Oi=2,ea=4,fn=8,tn=1,da=2,Ii=4,Ai=8,Pr=16,nt=da|Ii,it=Ai|Pr,_t=nt|it,we=["x","y"],er=["clientX","clientY"];function $r(mt,Gt){var Cr=this;this.manager=mt,this.callback=Gt,this.element=mt.element,this.target=mt.options.inputTarget,this.domHandler=function(Rr){Ae(mt.options.enable,[mt])&&Cr.handler(Rr)},this.init()}$r.prototype={handler:function(){},init:function(){this.evEl&&Ye(this.element,this.evEl,this.domHandler),this.evTarget&&Ye(this.target,this.evTarget,this.domHandler),this.evWin&&Ye(Er(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&at(this.element,this.evEl,this.domHandler),this.evTarget&&at(this.target,this.evTarget,this.domHandler),this.evWin&&at(Er(this.element),this.evWin,this.domHandler)}};function Fn(mt){var Gt,Cr=mt.options.inputClass;return Cr?Gt=Cr:hn?Gt=Bt:gi?Gt=Ft:on?Gt=Hr:Gt=Ln,new Gt(mt,Qt)}function Qt(mt,Gt,Cr){var Rr=Cr.pointers.length,ji=Cr.changedPointers.length,Pa=Gt&Ci&&Rr-ji===0,Yt=Gt&(ea|fn)&&Rr-ji===0;Cr.isFirst=!!Pa,Cr.isFinal=!!Yt,Pa&&(mt.session={}),Cr.eventType=Gt,Br(mt,Cr),mt.emit("hammer.input",Cr),mt.recognize(Cr),mt.session.prevInput=Cr}function Br(mt,Gt){var Cr=mt.session,Rr=Gt.pointers,ji=Rr.length;Cr.firstInput||(Cr.firstInput=pn(Gt)),ji>1&&!Cr.firstMultiple?Cr.firstMultiple=pn(Gt):ji===1&&(Cr.firstMultiple=!1);var Pa=Cr.firstInput,Yt=Cr.firstMultiple,De=Yt?Yt.center:Pa.center,Me=Gt.center=Sn(Rr);Gt.timeStamp=We(),Gt.deltaTime=Gt.timeStamp-Pa.timeStamp,Gt.angle=ca(De,Me),Gt.distance=di(De,Me),bn(Cr,Gt),Gt.offsetDirection=ui(Gt.deltaX,Gt.deltaY);var ce=Dn(Gt.deltaTime,Gt.deltaX,Gt.deltaY);Gt.overallVelocityX=ce.x,Gt.overallVelocityY=ce.y,Gt.overallVelocity=Ce(ce.x)>Ce(ce.y)?ce.x:ce.y,Gt.scale=Yt?Wa(Yt.pointers,Rr):1,Gt.rotation=Yt?Ni(Yt.pointers,Rr):0,Gt.maxPointers=Cr.prevInput?Gt.pointers.length>Cr.prevInput.maxPointers?Gt.pointers.length:Cr.prevInput.maxPointers:Gt.pointers.length,gr(Cr,Gt);var He=mt.element;ht(Gt.srcEvent.target,He)&&(He=Gt.srcEvent.target),Gt.target=He}function bn(mt,Gt){var Cr=Gt.center,Rr=mt.offsetDelta||{},ji=mt.prevDelta||{},Pa=mt.prevInput||{};(Gt.eventType===Ci||Pa.eventType===ea)&&(ji=mt.prevDelta={x:Pa.deltaX||0,y:Pa.deltaY||0},Rr=mt.offsetDelta={x:Cr.x,y:Cr.y}),Gt.deltaX=ji.x+(Cr.x-Rr.x),Gt.deltaY=ji.y+(Cr.y-Rr.y)}function gr(mt,Gt){var Cr=mt.lastInterval||Gt,Rr=Gt.timeStamp-Cr.timeStamp,ji,Pa,Yt,De;if(Gt.eventType!=fn&&(Rr>ci||Cr.velocity===F)){var Me=Gt.deltaX-Cr.deltaX,ce=Gt.deltaY-Cr.deltaY,He=Dn(Rr,Me,ce);Pa=He.x,Yt=He.y,ji=Ce(He.x)>Ce(He.y)?He.x:He.y,De=ui(Me,ce),mt.lastInterval=Gt}else ji=Cr.velocity,Pa=Cr.velocityX,Yt=Cr.velocityY,De=Cr.direction;Gt.velocity=ji,Gt.velocityX=Pa,Gt.velocityY=Yt,Gt.direction=De}function pn(mt){for(var Gt=[],Cr=0;Cr<mt.pointers.length;)Gt[Cr]={clientX:Fe(mt.pointers[Cr].clientX),clientY:Fe(mt.pointers[Cr].clientY)},Cr++;return{timeStamp:We(),pointers:Gt,center:Sn(Gt),deltaX:mt.deltaX,deltaY:mt.deltaY}}function Sn(mt){var Gt=mt.length;if(Gt===1)return{x:Fe(mt[0].clientX),y:Fe(mt[0].clientY)};for(var Cr=0,Rr=0,ji=0;ji<Gt;)Cr+=mt[ji].clientX,Rr+=mt[ji].clientY,ji++;return{x:Fe(Cr/Gt),y:Fe(Rr/Gt)}}function Dn(mt,Gt,Cr){return{x:Gt/mt||0,y:Cr/mt||0}}function ui(mt,Gt){return mt===Gt?tn:Ce(mt)>=Ce(Gt)?mt<0?da:Ii:Gt<0?Ai:Pr}function di(mt,Gt,Cr){Cr||(Cr=we);var Rr=Gt[Cr[0]]-mt[Cr[0]],ji=Gt[Cr[1]]-mt[Cr[1]];return Math.sqrt(Rr*Rr+ji*ji)}function ca(mt,Gt,Cr){Cr||(Cr=we);var Rr=Gt[Cr[0]]-mt[Cr[0]],ji=Gt[Cr[1]]-mt[Cr[1]];return Math.atan2(ji,Rr)*180/Math.PI}function Ni(mt,Gt){return ca(Gt[1],Gt[0],er)+ca(mt[1],mt[0],er)}function Wa(mt,Gt){return di(Gt[0],Gt[1],er)/di(mt[0],mt[1],er)}var Ba={mousedown:Ci,mousemove:Oi,mouseup:ea},Ia="mousedown",an="mousemove mouseup";function Ln(){this.evEl=Ia,this.evWin=an,this.pressed=!1,$r.apply(this,arguments)}ft(Ln,$r,{handler:function(Gt){var Cr=Ba[Gt.type];Cr&Ci&&Gt.button===0&&(this.pressed=!0),Cr&Oi&&Gt.which!==1&&(Cr=ea),this.pressed&&(Cr&ea&&(this.pressed=!1),this.callback(this.manager,Cr,{pointers:[Gt],changedPointers:[Gt],pointerType:Ea,srcEvent:Gt}))}});var re={pointerdown:Ci,pointermove:Oi,pointerup:ea,pointercancel:fn,pointerout:fn},he={2:Hn,3:Dt,4:Ea,5:Ze},V="pointerdown",Et="pointermove pointerup pointercancel";!Y&&k.MSPointerEvent&&!k.PointerEvent&&(V="MSPointerDown",Et="MSPointerMove MSPointerUp MSPointerCancel");function Bt(){this.evEl=V,this.evWin=Et,$r.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ft(Bt,$r,{handler:function(Gt){var Cr=this.store,Rr=!1,ji=Gt.type.toLowerCase().replace("ms",""),Pa=re[ji],Yt=he[Gt.pointerType]||Gt.pointerType,De=Yt==Hn,Me=oe(Cr,Gt.pointerId,"pointerId");Pa&Ci&&(Gt.button===0||De)?Me<0&&(Cr.push(Gt),Me=Cr.length-1):Pa&(ea|fn)&&(Rr=!0),!(Me<0)&&(Cr[Me]=Gt,this.callback(this.manager,Pa,{pointers:Cr,changedPointers:[Gt],pointerType:Yt,srcEvent:Gt}),Rr&&Cr.splice(Me,1))}});var Le={touchstart:Ci,touchmove:Oi,touchend:ea,touchcancel:fn},St="touchstart",tt="touchstart touchmove touchend touchcancel";function At(){this.evTarget=St,this.evWin=tt,this.started=!1,$r.apply(this,arguments)}ft(At,$r,{handler:function(Gt){var Cr=Le[Gt.type];if(Cr===Ci&&(this.started=!0),!!this.started){var Rr=tr.call(this,Gt,Cr);Cr&(ea|fn)&&Rr[0].length-Rr[1].length===0&&(this.started=!1),this.callback(this.manager,Cr,{pointers:Rr[0],changedPointers:Rr[1],pointerType:Hn,srcEvent:Gt})}}});function tr(mt,Gt){var Cr=ue(mt.touches),Rr=ue(mt.changedTouches);return Gt&(ea|fn)&&(Cr=be(Cr.concat(Rr),"identifier",!0)),[Cr,Rr]}var en={touchstart:Ci,touchmove:Oi,touchend:ea,touchcancel:fn},Kr="touchstart touchmove touchend touchcancel";function Ft(){this.evTarget=Kr,this.targetIds={},$r.apply(this,arguments)}ft(Ft,$r,{handler:function(Gt){var Cr=en[Gt.type],Rr=rr.call(this,Gt,Cr);Rr&&this.callback(this.manager,Cr,{pointers:Rr[0],changedPointers:Rr[1],pointerType:Hn,srcEvent:Gt})}});function rr(mt,Gt){var Cr=ue(mt.touches),Rr=this.targetIds;if(Gt&(Ci|Oi)&&Cr.length===1)return Rr[Cr[0].identifier]=!0,[Cr,Cr];var ji,Pa,Yt=ue(mt.changedTouches),De=[],Me=this.target;if(Pa=Cr.filter(function(ce){return ht(ce.target,Me)}),Gt===Ci)for(ji=0;ji<Pa.length;)Rr[Pa[ji].identifier]=!0,ji++;for(ji=0;ji<Yt.length;)Rr[Yt[ji].identifier]&&De.push(Yt[ji]),Gt&(ea|fn)&&delete Rr[Yt[ji].identifier],ji++;if(De.length)return[be(Pa.concat(De),"identifier",!0),De]}var ot=2500,Li=25;function Hr(){$r.apply(this,arguments);var mt=ve(this.handler,this);this.touch=new Ft(this.manager,mt),this.mouse=new Ln(this.manager,mt),this.primaryTouch=null,this.lastTouches=[]}ft(Hr,$r,{handler:function(Gt,Cr,Rr){var ji=Rr.pointerType==Hn,Pa=Rr.pointerType==Ea;if(!(Pa&&Rr.sourceCapabilities&&Rr.sourceCapabilities.firesTouchEvents)){if(ji)_i.call(this,Cr,Rr);else if(Pa&&It.call(this,Rr))return;this.callback(Gt,Cr,Rr)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function _i(mt,Gt){mt&Ci?(this.primaryTouch=Gt.changedPointers[0].identifier,vi.call(this,Gt)):mt&(ea|fn)&&vi.call(this,Gt)}function vi(mt){var Gt=mt.changedPointers[0];if(Gt.identifier===this.primaryTouch){var Cr={x:Gt.clientX,y:Gt.clientY};this.lastTouches.push(Cr);var Rr=this.lastTouches,ji=function(){var Pa=Rr.indexOf(Cr);Pa>-1&&Rr.splice(Pa,1)};setTimeout(ji,ot)}}function It(mt){for(var Gt=mt.srcEvent.clientX,Cr=mt.srcEvent.clientY,Rr=0;Rr<this.lastTouches.length;Rr++){var ji=this.lastTouches[Rr],Pa=Math.abs(Gt-ji.x),Yt=Math.abs(Cr-ji.y);if(Pa<=Li&&Yt<=Li)return!0}return!1}var Yr=Y?F:vt($.style,"touchAction"),Dr=Yr!==F,Jn="compute",Kt="auto",hr="manipulation",Fr="none",qr="pan-x",An="pan-y",Ui=ct();function fa(mt,Gt){this.manager=mt,this.set(Gt)}fa.prototype={set:function(mt){mt==Jn&&(mt=this.compute()),Dr&&this.manager.element.style&&Ui[mt]&&(this.manager.element.style[Yr]=mt),this.actions=mt.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var mt=[];return Ke(this.manager.recognizers,function(Gt){Ae(Gt.options.enable,[Gt])&&(mt=mt.concat(Gt.getTouchAction()))}),Wi(mt.join(" "))},preventDefaults:function(mt){var Gt=mt.srcEvent,Cr=mt.offsetDirection;if(this.manager.session.prevented){Gt.preventDefault();return}var Rr=this.actions,ji=Se(Rr,Fr)&&!Ui[Fr],Pa=Se(Rr,An)&&!Ui[An],Yt=Se(Rr,qr)&&!Ui[qr];if(ji){var De=mt.pointers.length===1,Me=mt.distance<2,ce=mt.deltaTime<250;if(De&&Me&&ce)return}if(!(Yt&&Pa)&&(ji||Pa&&Cr&nt||Yt&&Cr&it))return this.preventSrc(Gt)},preventSrc:function(mt){this.manager.session.prevented=!0,mt.preventDefault()}};function Wi(mt){if(Se(mt,Fr))return Fr;var Gt=Se(mt,qr),Cr=Se(mt,An);return Gt&&Cr?Fr:Gt||Cr?Gt?qr:An:Se(mt,hr)?hr:Kt}function ct(){if(!Dr)return!1;var mt={};if(Y)return mt;var Gt=k.CSS&&k.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Cr){mt[Cr]=Gt?k.CSS.supports("touch-action",Cr):!0}),mt}var qi=1,Na=2,To=4,ao=8,Ga=ao,Ko=16,ws=32;function Fo(mt){this.options=Xe({},this.defaults,mt||{}),this.id=Ht(),this.manager=null,this.options.enable=Re(this.options.enable,!0),this.state=qi,this.simultaneous={},this.requireFail=[]}Fo.prototype={defaults:{},set:function(mt){return Xe(this.options,mt),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(mt){if(Ge(mt,"recognizeWith",this))return this;var Gt=this.simultaneous;return mt=ns(mt,this),Gt[mt.id]||(Gt[mt.id]=mt,mt.recognizeWith(this)),this},dropRecognizeWith:function(mt){return Ge(mt,"dropRecognizeWith",this)?this:(mt=ns(mt,this),delete this.simultaneous[mt.id],this)},requireFailure:function(mt){if(Ge(mt,"requireFailure",this))return this;var Gt=this.requireFail;return mt=ns(mt,this),oe(Gt,mt)===-1&&(Gt.push(mt),mt.requireFailure(this)),this},dropRequireFailure:function(mt){if(Ge(mt,"dropRequireFailure",this))return this;mt=ns(mt,this);var Gt=oe(this.requireFail,mt);return Gt>-1&&this.requireFail.splice(Gt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(mt){return!!this.simultaneous[mt.id]},emit:function(mt){var Gt=this,Cr=this.state;function Rr(ji){Gt.manager.emit(ji,mt)}Cr<ao&&Rr(Gt.options.event+su(Cr)),Rr(Gt.options.event),mt.additionalEvent&&Rr(mt.additionalEvent),Cr>=ao&&Rr(Gt.options.event+su(Cr))},tryEmit:function(mt){if(this.canEmit())return this.emit(mt);this.state=ws},canEmit:function(){for(var mt=0;mt<this.requireFail.length;){if(!(this.requireFail[mt].state&(ws|qi)))return!1;mt++}return!0},recognize:function(mt){var Gt=Xe({},mt);if(!Ae(this.options.enable,[this,Gt])){this.reset(),this.state=ws;return}this.state&(Ga|Ko|ws)&&(this.state=qi),this.state=this.process(Gt),this.state&(Na|To|ao|Ko)&&this.tryEmit(Gt)},process:function(mt){},getTouchAction:function(){},reset:function(){}};function su(mt){return mt&Ko?"cancel":mt&ao?"end":mt&To?"move":mt&Na?"start":""}function zo(mt){return mt==Pr?"down":mt==Ai?"up":mt==da?"left":mt==Ii?"right":""}function ns(mt,Gt){var Cr=Gt.manager;return Cr?Cr.get(mt):mt}function ls(){Fo.apply(this,arguments)}ft(ls,Fo,{defaults:{pointers:1},attrTest:function(mt){var Gt=this.options.pointers;return Gt===0||mt.pointers.length===Gt},process:function(mt){var Gt=this.state,Cr=mt.eventType,Rr=Gt&(Na|To),ji=this.attrTest(mt);return Rr&&(Cr&fn||!ji)?Gt|Ko:Rr||ji?Cr&ea?Gt|ao:Gt&Na?Gt|To:Na:ws}});function _o(){ls.apply(this,arguments),this.pX=null,this.pY=null}ft(_o,ls,{defaults:{event:"pan",threshold:10,pointers:1,direction:_t},getTouchAction:function(){var mt=this.options.direction,Gt=[];return mt&nt&&Gt.push(An),mt&it&&Gt.push(qr),Gt},directionTest:function(mt){var Gt=this.options,Cr=!0,Rr=mt.distance,ji=mt.direction,Pa=mt.deltaX,Yt=mt.deltaY;return ji&Gt.direction||(Gt.direction&nt?(ji=Pa===0?tn:Pa<0?da:Ii,Cr=Pa!=this.pX,Rr=Math.abs(mt.deltaX)):(ji=Yt===0?tn:Yt<0?Ai:Pr,Cr=Yt!=this.pY,Rr=Math.abs(mt.deltaY))),mt.direction=ji,Cr&&Rr>Gt.threshold&&ji&Gt.direction},attrTest:function(mt){return ls.prototype.attrTest.call(this,mt)&&(this.state&Na||!(this.state&Na)&&this.directionTest(mt))},emit:function(mt){this.pX=mt.deltaX,this.pY=mt.deltaY;var Gt=zo(mt.direction);Gt&&(mt.additionalEvent=this.options.event+Gt),this._super.emit.call(this,mt)}});function Po(){ls.apply(this,arguments)}ft(Po,ls,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Fr]},attrTest:function(mt){return this._super.attrTest.call(this,mt)&&(Math.abs(mt.scale-1)>this.options.threshold||this.state&Na)},emit:function(mt){if(mt.scale!==1){var Gt=mt.scale<1?"in":"out";mt.additionalEvent=this.options.event+Gt}this._super.emit.call(this,mt)}});function Ss(){Fo.apply(this,arguments),this._timer=null,this._input=null}ft(Ss,Fo,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Kt]},process:function(mt){var Gt=this.options,Cr=mt.pointers.length===Gt.pointers,Rr=mt.distance<Gt.threshold,ji=mt.deltaTime>Gt.time;if(this._input=mt,!Rr||!Cr||mt.eventType&(ea|fn)&&!ji)this.reset();else if(mt.eventType&Ci)this.reset(),this._timer=me(function(){this.state=Ga,this.tryEmit()},Gt.time,this);else if(mt.eventType&ea)return Ga;return ws},reset:function(){clearTimeout(this._timer)},emit:function(mt){this.state===Ga&&(mt&&mt.eventType&ea?this.manager.emit(this.options.event+"up",mt):(this._input.timeStamp=We(),this.manager.emit(this.options.event,this._input)))}});function Wu(){ls.apply(this,arguments)}ft(Wu,ls,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Fr]},attrTest:function(mt){return this._super.attrTest.call(this,mt)&&(Math.abs(mt.rotation)>this.options.threshold||this.state&Na)}});function $s(){ls.apply(this,arguments)}ft($s,ls,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:nt|it,pointers:1},getTouchAction:function(){return _o.prototype.getTouchAction.call(this)},attrTest:function(mt){var Gt=this.options.direction,Cr;return Gt&(nt|it)?Cr=mt.overallVelocity:Gt&nt?Cr=mt.overallVelocityX:Gt&it&&(Cr=mt.overallVelocityY),this._super.attrTest.call(this,mt)&&Gt&mt.offsetDirection&&mt.distance>this.options.threshold&&mt.maxPointers==this.options.pointers&&Ce(Cr)>this.options.velocity&&mt.eventType&ea},emit:function(mt){var Gt=zo(mt.offsetDirection);Gt&&this.manager.emit(this.options.event+Gt,mt),this.manager.emit(this.options.event,mt)}});function uu(){Fo.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ft(uu,Fo,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[hr]},process:function(mt){var Gt=this.options,Cr=mt.pointers.length===Gt.pointers,Rr=mt.distance<Gt.threshold,ji=mt.deltaTime<Gt.time;if(this.reset(),mt.eventType&Ci&&this.count===0)return this.failTimeout();if(Rr&&ji&&Cr){if(mt.eventType!=ea)return this.failTimeout();var Pa=this.pTime?mt.timeStamp-this.pTime<Gt.interval:!0,Yt=!this.pCenter||di(this.pCenter,mt.center)<Gt.posThreshold;this.pTime=mt.timeStamp,this.pCenter=mt.center,!Yt||!Pa?this.count=1:this.count+=1,this._input=mt;var De=this.count%Gt.taps;if(De===0)return this.hasRequireFailures()?(this._timer=me(function(){this.state=Ga,this.tryEmit()},Gt.interval,this),Na):Ga}return ws},failTimeout:function(){return this._timer=me(function(){this.state=ws},this.options.interval,this),ws},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ga&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Jo(mt,Gt){return Gt=Gt||{},Gt.recognizers=Re(Gt.recognizers,Jo.defaults.preset),new Bs(mt,Gt)}Jo.VERSION="2.0.7",Jo.defaults={domEvents:!1,touchAction:Jn,enable:!0,inputTarget:null,inputClass:null,preset:[[Wu,{enable:!1}],[Po,{enable:!1},["rotate"]],[$s,{direction:nt}],[_o,{direction:nt},["swipe"]],[uu],[uu,{event:"doubletap",taps:2},["tap"]],[Ss]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ms=1,eu=2;function Bs(mt,Gt){this.options=Xe({},Jo.defaults,Gt||{}),this.options.inputTarget=this.options.inputTarget||mt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=mt,this.input=Fn(this),this.touchAction=new fa(this,this.options.touchAction),fi(this,!0),Ke(this.options.recognizers,function(Cr){var Rr=this.add(new Cr[0](Cr[1]));Cr[2]&&Rr.recognizeWith(Cr[2]),Cr[3]&&Rr.requireFailure(Cr[3])},this)}Bs.prototype={set:function(mt){return Xe(this.options,mt),mt.touchAction&&this.touchAction.update(),mt.inputTarget&&(this.input.destroy(),this.input.target=mt.inputTarget,this.input.init()),this},stop:function(mt){this.session.stopped=mt?eu:ms},recognize:function(mt){var Gt=this.session;if(!Gt.stopped){this.touchAction.preventDefaults(mt);var Cr,Rr=this.recognizers,ji=Gt.curRecognizer;(!ji||ji&&ji.state&Ga)&&(ji=Gt.curRecognizer=null);for(var Pa=0;Pa<Rr.length;)Cr=Rr[Pa],Gt.stopped!==eu&&(!ji||Cr==ji||Cr.canRecognizeWith(ji))?Cr.recognize(mt):Cr.reset(),!ji&&Cr.state&(Na|To|ao)&&(ji=Gt.curRecognizer=Cr),Pa++}},get:function(mt){if(mt instanceof Fo)return mt;for(var Gt=this.recognizers,Cr=0;Cr<Gt.length;Cr++)if(Gt[Cr].options.event==mt)return Gt[Cr];return null},add:function(mt){if(Ge(mt,"add",this))return this;var Gt=this.get(mt.options.event);return Gt&&this.remove(Gt),this.recognizers.push(mt),mt.manager=this,this.touchAction.update(),mt},remove:function(mt){if(Ge(mt,"remove",this))return this;if(mt=this.get(mt),mt){var Gt=this.recognizers,Cr=oe(Gt,mt);Cr!==-1&&(Gt.splice(Cr,1),this.touchAction.update())}return this},on:function(mt,Gt){if(mt!==F&&Gt!==F){var Cr=this.handlers;return Ke(Qe(mt),function(Rr){Cr[Rr]=Cr[Rr]||[],Cr[Rr].push(Gt)}),this}},off:function(mt,Gt){if(mt!==F){var Cr=this.handlers;return Ke(Qe(mt),function(Rr){Gt?Cr[Rr]&&Cr[Rr].splice(oe(Cr[Rr],Gt),1):delete Cr[Rr]}),this}},emit:function(mt,Gt){this.options.domEvents&&is(mt,Gt);var Cr=this.handlers[mt]&&this.handlers[mt].slice();if(!(!Cr||!Cr.length)){Gt.type=mt,Gt.preventDefault=function(){Gt.srcEvent.preventDefault()};for(var Rr=0;Rr<Cr.length;)Cr[Rr](Gt),Rr++}},destroy:function(){this.element&&fi(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function fi(mt,Gt){var Cr=mt.element;if(Cr.style){var Rr;Ke(mt.options.cssProps,function(ji,Pa){Rr=vt(Cr.style,Pa),Gt?(mt.oldCssProps[Rr]=Cr.style[Rr],Cr.style[Rr]=ji):Cr.style[Rr]=mt.oldCssProps[Rr]||""}),Gt||(mt.oldCssProps={})}}function is(mt,Gt){if(!Y){var Cr=m.createEvent("Event");Cr.initEvent(mt,!0,!0),Cr.gesture=Gt,Gt.target.dispatchEvent(Cr)}}if(!Y){Xe(Jo,{INPUT_START:Ci,INPUT_MOVE:Oi,INPUT_END:ea,INPUT_CANCEL:fn,STATE_POSSIBLE:qi,STATE_BEGAN:Na,STATE_CHANGED:To,STATE_ENDED:ao,STATE_RECOGNIZED:Ga,STATE_CANCELLED:Ko,STATE_FAILED:ws,DIRECTION_NONE:tn,DIRECTION_LEFT:da,DIRECTION_RIGHT:Ii,DIRECTION_UP:Ai,DIRECTION_DOWN:Pr,DIRECTION_HORIZONTAL:nt,DIRECTION_VERTICAL:it,DIRECTION_ALL:_t,Manager:Bs,Input:$r,TouchAction:fa,TouchInput:Ft,MouseInput:Ln,PointerEventInput:Bt,TouchMouseInput:Hr,SingleTouchInput:At,Recognizer:Fo,AttrRecognizer:ls,Tap:uu,Pan:_o,Swipe:$s,Pinch:Po,Rotate:Wu,Press:Ss,on:Ye,off:at,each:Ke,merge:ie,extend:gt,assign:Xe,inherit:ft,bindFn:ve,prefixed:vt});var ku=typeof window!="undefined"?window:typeof self!="undefined"?self:{};ku.Hammer=Jo,D=function(){return Jo}.call(fe,I,fe,Ne),D!==F&&(Ne.exports=D)}})(typeof window!="undefined"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")},88307:function(Ne,fe,I){(function(D,k){Ne.exports=k(I(51260))})(this,function(D){"use strict";var k=function(ke){return ke instanceof Uint8Array||ke instanceof Uint16Array||ke instanceof Uint32Array||ke instanceof Int8Array||ke instanceof Int16Array||ke instanceof Int32Array||ke instanceof Float32Array||ke instanceof Float64Array||ke instanceof Uint8ClampedArray},m=function(ke,Ut){for(var Ar=Object.keys(Ut),On=0;On<Ar.length;++On)ke[Ar[On]]=Ut[Ar[On]];return ke},ae=`
`;function F(ke){return typeof atob!="undefined"?atob(ke):"base64:"+ke}function K(ke){var Ut=new Error("(regl) "+ke);throw console.error(Ut),Ut}function W(ke,Ut){ke||K(Ut)}function Y(ke){return ke?": "+ke:""}function G(ke,Ut,Ar){ke in Ut||K("unknown parameter ("+ke+")"+Y(Ar)+". possible values: "+Object.keys(Ut).join())}function $(ke,Ut){k(ke)||K("invalid parameter type"+Y(Ut)+". must be a typed array")}function xe(ke,Ut){switch(Ut){case"number":return typeof ke=="number";case"object":return typeof ke=="object";case"string":return typeof ke=="string";case"boolean":return typeof ke=="boolean";case"function":return typeof ke=="function";case"undefined":return typeof ke=="undefined";case"symbol":return typeof ke=="symbol"}}function Fe(ke,Ut,Ar){xe(ke,Ut)||K("invalid parameter type"+Y(Ar)+". expected "+Ut+", got "+typeof ke)}function Ce(ke,Ut){ke>=0&&(ke|0)===ke||K("invalid parameter type, ("+ke+")"+Y(Ut)+". must be a nonnegative integer")}function We(ke,Ut,Ar){Ut.indexOf(ke)<0&&K("invalid value"+Y(Ar)+". must be one of: "+Ut)}var me=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ge(ke){Object.keys(ke).forEach(function(Ut){me.indexOf(Ut)<0&&K('invalid regl constructor argument "'+Ut+'". must be one of '+me)})}function Ke(ke,Ut){for(ke=ke+"";ke.length<Ut;)ke=" "+ke;return ke}function pt(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Xe(ke,Ut){this.number=ke,this.line=Ut,this.errors=[]}function gt(ke,Ut,Ar){this.file=ke,this.line=Ut,this.message=Ar}function ie(){var ke=new Error,Ut=(ke.stack||ke).toString(),Ar=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Ut);if(Ar)return Ar[1];var On=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Ut);return On?On[1]:"unknown"}function ft(){var ke=new Error,Ut=(ke.stack||ke).toString(),Ar=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Ut);if(Ar)return Ar[1];var On=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Ut);return On?On[1]:"unknown"}function ve(ke,Ut){var Ar=ke.split(`
`),On=1,bi=0,zn={unknown:new pt,0:new pt};zn.unknown.name=zn[0].name=Ut||ie(),zn.unknown.lines.push(new Xe(0,""));for(var hi=0;hi<Ar.length;++hi){var Fi=Ar[hi],Gi=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Fi);if(Gi)switch(Gi[1]){case"line":var Ki=/(\d+)(\s+\d+)?/.exec(Gi[2]);Ki&&(On=Ki[1]|0,Ki[2]&&(bi=Ki[2]|0,bi in zn||(zn[bi]=new pt)));break;case"define":var ia=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Gi[2]);ia&&(zn[bi].name=ia[1]?F(ia[2]):ia[2]);break}zn[bi].lines.push(new Xe(On++,Fi))}return Object.keys(zn).forEach(function(oa){var sa=zn[oa];sa.lines.forEach(function(Bi){sa.index[Bi.number]=Bi})}),zn}function Ae(ke){var Ut=[];return ke.split(`
`).forEach(function(Ar){if(!(Ar.length<5)){var On=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Ar);On?Ut.push(new gt(On[1]|0,On[2]|0,On[3].trim())):Ar.length>0&&Ut.push(new gt("unknown",0,Ar))}}),Ut}function Re(ke,Ut){Ut.forEach(function(Ar){var On=ke[Ar.file];if(On){var bi=On.index[Ar.line];if(bi){bi.errors.push(Ar),On.hasErrors=!0;return}}ke.unknown.hasErrors=!0,ke.unknown.lines[0].errors.push(Ar)})}function Ye(ke,Ut,Ar,On,bi){if(!ke.getShaderParameter(Ut,ke.COMPILE_STATUS)){var zn=ke.getShaderInfoLog(Ut),hi=On===ke.FRAGMENT_SHADER?"fragment":"vertex";be(Ar,"string",hi+" shader source must be a string",bi);var Fi=ve(Ar,bi),Gi=Ae(zn);Re(Fi,Gi),Object.keys(Fi).forEach(function(Ki){var ia=Fi[Ki];if(!ia.hasErrors)return;var oa=[""],sa=[""];function Bi(Ji,yn){oa.push(Ji),sa.push(yn||"")}Bi("file number "+Ki+": "+ia.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ia.lines.forEach(function(Ji){if(Ji.errors.length>0){Bi(Ke(Ji.number,4)+"|  ","background-color:yellow; font-weight:bold"),Bi(Ji.line+ae,"color:red; background-color:yellow; font-weight:bold");var yn=0;Ji.errors.forEach(function(Qn){var Yi=Qn.message,wa=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Yi);if(wa){var yi=wa[1];switch(Yi=wa[2],yi){case"assign":yi="=";break}yn=Math.max(Ji.line.indexOf(yi,yn),0)}else yn=0;Bi(Ke("| ",6)),Bi(Ke("^^^",yn+3)+ae,"font-weight:bold"),Bi(Ke("| ",6)),Bi(Yi+ae,"font-weight:bold")}),Bi(Ke("| ",6)+ae)}else Bi(Ke(Ji.number,4)+"|  "),Bi(Ji.line+ae,"color:red")}),typeof document!="undefined"&&!window.chrome?(sa[0]=oa.join("%c"),console.log.apply(console,sa)):console.log(oa.join(""))}),W.raise("Error compiling "+hi+" shader, "+Fi[0].name)}}function at(ke,Ut,Ar,On,bi){if(!ke.getProgramParameter(Ut,ke.LINK_STATUS)){var zn=ke.getProgramInfoLog(Ut),hi=ve(Ar,bi),Fi=ve(On,bi),Gi='Error linking program with vertex shader, "'+Fi[0].name+'", and fragment shader "'+hi[0].name+'"';typeof document!="undefined"?console.log("%c"+Gi+ae+"%c"+zn,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Gi+ae+zn),W.raise(Gi)}}function ht(ke){ke._commandRef=ie()}function Se(ke,Ut,Ar,On){ht(ke);function bi(Gi){return Gi?On.id(Gi):0}ke._fragId=bi(ke.static.frag),ke._vertId=bi(ke.static.vert);function zn(Gi,Ki){Object.keys(Ki).forEach(function(ia){Gi[On.id(ia)]=!0})}var hi=ke._uniformSet={};zn(hi,Ut.static),zn(hi,Ut.dynamic);var Fi=ke._attributeSet={};zn(Fi,Ar.static),zn(Fi,Ar.dynamic),ke._hasCount="count"in ke.static||"count"in ke.dynamic||"elements"in ke.static||"elements"in ke.dynamic}function Qe(ke,Ut){var Ar=ft();K(ke+" in command "+(Ut||ie())+(Ar==="unknown"?"":" called from "+Ar))}function oe(ke,Ut,Ar){ke||Qe(Ut,Ar||ie())}function ue(ke,Ut,Ar,On){ke in Ut||Qe("unknown parameter ("+ke+")"+Y(Ar)+". possible values: "+Object.keys(Ut).join(),On||ie())}function be(ke,Ut,Ar,On){xe(ke,Ut)||Qe("invalid parameter type"+Y(Ar)+". expected "+Ut+", got "+typeof ke,On||ie())}function vt(ke){ke()}function bt(ke,Ut,Ar){ke.texture?We(ke.texture._texture.internalformat,Ut,"unsupported texture format for attachment"):We(ke.renderbuffer._renderbuffer.format,Ar,"unsupported renderbuffer format for attachment")}var Ht=33071,Er=9728,Vt=9984,on=9985,hn=9986,gi=9987,Hn=5120,Dt=5121,Ea=5122,Ze=5123,ci=5124,Ci=5125,Oi=5126,ea=32819,fn=32820,tn=33635,da=34042,Ii=36193,Ai={};Ai[Hn]=Ai[Dt]=1,Ai[Ea]=Ai[Ze]=Ai[Ii]=Ai[tn]=Ai[ea]=Ai[fn]=2,Ai[ci]=Ai[Ci]=Ai[Oi]=Ai[da]=4;function Pr(ke,Ut){return ke===fn||ke===ea||ke===tn?2:ke===da?4:Ai[ke]*Ut}function nt(ke){return!(ke&ke-1)&&!!ke}function it(ke,Ut,Ar){var On,bi=Ut.width,zn=Ut.height,hi=Ut.channels;W(bi>0&&bi<=Ar.maxTextureSize&&zn>0&&zn<=Ar.maxTextureSize,"invalid texture shape"),(ke.wrapS!==Ht||ke.wrapT!==Ht)&&W(nt(bi)&&nt(zn),"incompatible wrap mode for texture, both width and height must be power of 2"),Ut.mipmask===1?bi!==1&&zn!==1&&W(ke.minFilter!==Vt&&ke.minFilter!==hn&&ke.minFilter!==on&&ke.minFilter!==gi,"min filter requires mipmap"):(W(nt(bi)&&nt(zn),"texture must be a square power of 2 to support mipmapping"),W(Ut.mipmask===(bi<<1)-1,"missing or incomplete mipmap data")),Ut.type===Oi&&(Ar.extensions.indexOf("oes_texture_float_linear")<0&&W(ke.minFilter===Er&&ke.magFilter===Er,"filter not supported, must enable oes_texture_float_linear"),W(!ke.genMipmaps,"mipmap generation not supported with float textures"));var Fi=Ut.images;for(On=0;On<16;++On)if(Fi[On]){var Gi=bi>>On,Ki=zn>>On;W(Ut.mipmask&1<<On,"missing mipmap data");var ia=Fi[On];if(W(ia.width===Gi&&ia.height===Ki,"invalid shape for mip images"),W(ia.format===Ut.format&&ia.internalformat===Ut.internalformat&&ia.type===Ut.type,"incompatible type for mip image"),!ia.compressed)if(ia.data){var oa=Math.ceil(Pr(ia.type,hi)*Gi/ia.unpackAlignment)*ia.unpackAlignment;W(ia.data.byteLength===oa*Ki,"invalid data for image, buffer size is inconsistent with image format")}else ia.element||ia.copy}else ke.genMipmaps||W((Ut.mipmask&1<<On)===0,"extra mipmap data");Ut.compressed&&W(!ke.genMipmaps,"mipmap generation for compressed images not supported")}function _t(ke,Ut,Ar,On){var bi=ke.width,zn=ke.height,hi=ke.channels;W(bi>0&&bi<=On.maxTextureSize&&zn>0&&zn<=On.maxTextureSize,"invalid texture shape"),W(bi===zn,"cube map must be square"),W(Ut.wrapS===Ht&&Ut.wrapT===Ht,"wrap mode not supported by cube map");for(var Fi=0;Fi<Ar.length;++Fi){var Gi=Ar[Fi];W(Gi.width===bi&&Gi.height===zn,"inconsistent cube map face shape"),Ut.genMipmaps&&(W(!Gi.compressed,"can not generate mipmap for compressed textures"),W(Gi.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Ki=Gi.images,ia=0;ia<16;++ia){var oa=Ki[ia];if(oa){var sa=bi>>ia,Bi=zn>>ia;W(Gi.mipmask&1<<ia,"missing mipmap data"),W(oa.width===sa&&oa.height===Bi,"invalid shape for mip images"),W(oa.format===ke.format&&oa.internalformat===ke.internalformat&&oa.type===ke.type,"incompatible type for mip image"),oa.compressed||(oa.data?W(oa.data.byteLength===sa*Bi*Math.max(Pr(oa.type,hi),oa.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):oa.element||oa.copy)}}}}var we=m(W,{optional:vt,raise:K,commandRaise:Qe,command:oe,parameter:G,commandParameter:ue,constructor:Ge,type:Fe,commandType:be,isTypedArray:$,nni:Ce,oneOf:We,shaderError:Ye,linkError:at,callSite:ft,saveCommandRef:ht,saveDrawInfo:Se,framebufferFormat:bt,guessCommand:ie,texture2D:it,textureCube:_t}),er=0,$r=0,Fn=5,Qt=6;function Br(ke,Ut){this.id=er++,this.type=ke,this.data=Ut}function bn(ke){return ke.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function gr(ke){if(ke.length===0)return[];var Ut=ke.charAt(0),Ar=ke.charAt(ke.length-1);if(ke.length>1&&Ut===Ar&&(Ut==='"'||Ut==="'"))return['"'+bn(ke.substr(1,ke.length-2))+'"'];var On=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ke);if(On)return gr(ke.substr(0,On.index)).concat(gr(On[1])).concat(gr(ke.substr(On.index+On[0].length)));var bi=ke.split(".");if(bi.length===1)return['"'+bn(ke)+'"'];for(var zn=[],hi=0;hi<bi.length;++hi)zn=zn.concat(gr(bi[hi]));return zn}function pn(ke){return"["+gr(ke).join("][")+"]"}function Sn(ke,Ut){return new Br(ke,pn(Ut+""))}function Dn(ke){return typeof ke=="function"&&!ke._reglType||ke instanceof Br}function ui(ke,Ut){if(typeof ke=="function")return new Br($r,ke);if(typeof ke=="number"||typeof ke=="boolean")return new Br(Fn,ke);if(Array.isArray(ke))return new Br(Qt,ke.map(function(Ar,On){return ui(Ar,Ut+"["+On+"]")}));if(ke instanceof Br)return ke;we(!1,"invalid option type in uniform "+Ut)}var di={DynamicVariable:Br,define:Sn,isDynamic:Dn,unbox:ui,accessor:pn},ca={next:typeof requestAnimationFrame=="function"?function(ke){return requestAnimationFrame(ke)}:function(ke){return setTimeout(ke,16)},cancel:typeof cancelAnimationFrame=="function"?function(ke){return cancelAnimationFrame(ke)}:clearTimeout},Ni=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Wa=Ni?function(){return+new Date}:typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Ba(){var ke={"":0},Ut=[""];return{id:function(Ar){var On=ke[Ar];return On||(On=ke[Ar]=Ut.length,Ut.push(Ar),On)},str:function(Ar){return Ut[Ar]}}}function Ia(ke,Ut,Ar){var On=document.createElement("canvas");m(On.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),ke.appendChild(On),ke===document.body&&(On.style.position="absolute",m(ke.style,{margin:0,padding:0}));function bi(){var Fi=window.innerWidth,Gi=window.innerHeight;if(ke!==document.body){var Ki=On.getBoundingClientRect();Fi=Ki.right-Ki.left,Gi=Ki.bottom-Ki.top}On.width=Ar*Fi,On.height=Ar*Gi}var zn;ke!==document.body&&typeof ResizeObserver=="function"?(zn=new ResizeObserver(function(){setTimeout(bi)}),zn.observe(ke)):window.addEventListener("resize",bi,!1);function hi(){zn?zn.disconnect():window.removeEventListener("resize",bi),ke.removeChild(On)}return bi(),{canvas:On,onDestroy:hi}}function an(ke,Ut){function Ar(On){try{return ke.getContext(On,Ut)}catch(bi){return null}}return Ar("webgl")||Ar("experimental-webgl")||Ar("webgl-experimental")}function Ln(ke){return typeof ke.nodeName=="string"&&typeof ke.appendChild=="function"&&typeof ke.getBoundingClientRect=="function"}function re(ke){return typeof ke.drawArrays=="function"||typeof ke.drawElements=="function"}function he(ke){return typeof ke=="string"?ke.split():(we(Array.isArray(ke),"invalid extension array"),ke)}function V(ke){return typeof ke=="string"?(we(typeof document!="undefined","not supported outside of DOM"),document.querySelector(ke)):ke}function Et(ke){var Ut=ke||{},Ar,On,bi,zn,hi={},Fi=[],Gi=[],Ki=typeof window=="undefined"?1:window.devicePixelRatio,ia=!1,oa=function(Ji){Ji&&we.raise(Ji)},sa=function(){};if(typeof Ut=="string"?(we(typeof document!="undefined","selector queries only supported in DOM environments"),Ar=document.querySelector(Ut),we(Ar,"invalid query string for element")):typeof Ut=="object"?Ln(Ut)?Ar=Ut:re(Ut)?(zn=Ut,bi=zn.canvas):(we.constructor(Ut),"gl"in Ut?zn=Ut.gl:"canvas"in Ut?bi=V(Ut.canvas):"container"in Ut&&(On=V(Ut.container)),"attributes"in Ut&&(hi=Ut.attributes,we.type(hi,"object","invalid context attributes")),"extensions"in Ut&&(Fi=he(Ut.extensions)),"optionalExtensions"in Ut&&(Gi=he(Ut.optionalExtensions)),"onDone"in Ut&&(we.type(Ut.onDone,"function","invalid or missing onDone callback"),oa=Ut.onDone),"profile"in Ut&&(ia=!!Ut.profile),"pixelRatio"in Ut&&(Ki=+Ut.pixelRatio,we(Ki>0,"invalid pixel ratio"))):we.raise("invalid arguments to regl"),Ar&&(Ar.nodeName.toLowerCase()==="canvas"?bi=Ar:On=Ar),!zn){if(!bi){we(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Bi=Ia(On||document.body,oa,Ki);if(!Bi)return null;bi=Bi.canvas,sa=Bi.onDestroy}hi.premultipliedAlpha===void 0&&(hi.premultipliedAlpha=!0),zn=an(bi,hi)}return zn?{gl:zn,canvas:bi,container:On,extensions:Fi,optionalExtensions:Gi,pixelRatio:Ki,profile:ia,onDone:oa,onDestroy:sa}:(sa(),oa("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Bt(ke,Ut){var Ar={};function On(Fi){we.type(Fi,"string","extension name must be string");var Gi=Fi.toLowerCase(),Ki;try{Ki=Ar[Gi]=bi(Fi)}catch(ia){}return!!Ki}function bi(Fi){return ke.getExtension(Fi)?ke.getExtension(Fi):ke.getExtension(Fi.toLowerCase())?ke.getExtension(Fi.toLowerCase()):null}for(var zn=0;zn<Ut.extensions.length;++zn){var hi=Ut.extensions[zn];if(!On(hi))return Ut.onDestroy(),Ut.onDone('"'+hi+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Ut.optionalExtensions.forEach(On),{extensions:Ar,restore:function(){Object.keys(Ar).forEach(function(Fi){if(Ar[Fi]&&!On(Fi))throw new Error("(regl): error restoring extension "+Fi)})}}}function Le(ke,Ut){for(var Ar=Array(ke),On=0;On<ke;++On)Ar[On]=Ut(On);return Ar}var St=5120,tt=5121,At=5122,tr=5123,en=5124,Kr=5125,Ft=5126;function rr(ke){for(var Ut=16;Ut<=1<<28;Ut*=16)if(ke<=Ut)return Ut;return 0}function ot(ke){var Ut,Ar;return Ut=(ke>65535)<<4,ke>>>=Ut,Ar=(ke>255)<<3,ke>>>=Ar,Ut|=Ar,Ar=(ke>15)<<2,ke>>>=Ar,Ut|=Ar,Ar=(ke>3)<<1,ke>>>=Ar,Ut|=Ar,Ut|ke>>1}function Li(){var ke=Le(8,function(){return[]});function Ut(zn){var hi=rr(zn),Fi=ke[ot(hi)>>2];return Fi.length>0?Fi.pop():new ArrayBuffer(hi)}function Ar(zn){ke[ot(zn.byteLength)>>2].push(zn)}function On(zn,hi){var Fi=null;switch(zn){case St:Fi=new Int8Array(Ut(hi),0,hi);break;case tt:Fi=new Uint8Array(Ut(hi),0,hi);break;case At:Fi=new Int16Array(Ut(2*hi),0,hi);break;case tr:Fi=new Uint16Array(Ut(2*hi),0,hi);break;case en:Fi=new Int32Array(Ut(4*hi),0,hi);break;case Kr:Fi=new Uint32Array(Ut(4*hi),0,hi);break;case Ft:Fi=new Float32Array(Ut(4*hi),0,hi);break;default:return null}return Fi.length!==hi?Fi.subarray(0,hi):Fi}function bi(zn){Ar(zn.buffer)}return{alloc:Ut,free:Ar,allocType:On,freeType:bi}}var Hr=Li();Hr.zero=Li();var _i=3408,vi=3410,It=3411,Yr=3412,Dr=3413,Jn=3414,Kt=3415,hr=33901,Fr=33902,qr=3379,An=3386,Ui=34921,fa=36347,Wi=36348,ct=35661,qi=35660,Na=34930,To=36349,ao=34076,Ga=34024,Ko=7936,ws=7937,Fo=7938,su=35724,zo=34047,ns=36063,ls=34852,_o=3553,Po=34067,Ss=34069,Wu=33984,$s=6408,uu=5126,Jo=5121,ms=36160,eu=36053,Bs=36064,fi=16384,is=function(ke,Ut){var Ar=1;Ut.ext_texture_filter_anisotropic&&(Ar=ke.getParameter(zo));var On=1,bi=1;Ut.webgl_draw_buffers&&(On=ke.getParameter(ls),bi=ke.getParameter(ns));var zn=!!Ut.oes_texture_float;if(zn){var hi=ke.createTexture();ke.bindTexture(_o,hi),ke.texImage2D(_o,0,$s,1,1,0,$s,uu,null);var Fi=ke.createFramebuffer();if(ke.bindFramebuffer(ms,Fi),ke.framebufferTexture2D(ms,Bs,_o,hi,0),ke.bindTexture(_o,null),ke.checkFramebufferStatus(ms)!==eu)zn=!1;else{ke.viewport(0,0,1,1),ke.clearColor(1,0,0,1),ke.clear(fi);var Gi=Hr.allocType(uu,4);ke.readPixels(0,0,1,1,$s,uu,Gi),ke.getError()?zn=!1:(ke.deleteFramebuffer(Fi),ke.deleteTexture(hi),zn=Gi[0]===1),Hr.freeType(Gi)}}var Ki=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ia=!0;if(!Ki){var oa=ke.createTexture(),sa=Hr.allocType(Jo,36);ke.activeTexture(Wu),ke.bindTexture(Po,oa),ke.texImage2D(Ss,0,$s,3,3,0,$s,Jo,sa),Hr.freeType(sa),ke.bindTexture(Po,null),ke.deleteTexture(oa),ia=!ke.getError()}return{colorBits:[ke.getParameter(vi),ke.getParameter(It),ke.getParameter(Yr),ke.getParameter(Dr)],depthBits:ke.getParameter(Jn),stencilBits:ke.getParameter(Kt),subpixelBits:ke.getParameter(_i),extensions:Object.keys(Ut).filter(function(Bi){return!!Ut[Bi]}),maxAnisotropic:Ar,maxDrawbuffers:On,maxColorAttachments:bi,pointSizeDims:ke.getParameter(hr),lineWidthDims:ke.getParameter(Fr),maxViewportDims:ke.getParameter(An),maxCombinedTextureUnits:ke.getParameter(ct),maxCubeMapSize:ke.getParameter(ao),maxRenderbufferSize:ke.getParameter(Ga),maxTextureUnits:ke.getParameter(Na),maxTextureSize:ke.getParameter(qr),maxAttributes:ke.getParameter(Ui),maxVertexUniforms:ke.getParameter(fa),maxVertexTextureUnits:ke.getParameter(qi),maxVaryingVectors:ke.getParameter(Wi),maxFragmentUniforms:ke.getParameter(To),glsl:ke.getParameter(su),renderer:ke.getParameter(ws),vendor:ke.getParameter(Ko),version:ke.getParameter(Fo),readFloat:zn,npotTextureCube:ia}};function ku(ke){return!!ke&&typeof ke=="object"&&Array.isArray(ke.shape)&&Array.isArray(ke.stride)&&typeof ke.offset=="number"&&ke.shape.length===ke.stride.length&&(Array.isArray(ke.data)||k(ke.data))}var mt=function(ke){return Object.keys(ke).map(function(Ut){return ke[Ut]})},Gt={shape:De,flatten:Yt};function Cr(ke,Ut,Ar){for(var On=0;On<Ut;++On)Ar[On]=ke[On]}function Rr(ke,Ut,Ar,On){for(var bi=0,zn=0;zn<Ut;++zn)for(var hi=ke[zn],Fi=0;Fi<Ar;++Fi)On[bi++]=hi[Fi]}function ji(ke,Ut,Ar,On,bi,zn){for(var hi=zn,Fi=0;Fi<Ut;++Fi)for(var Gi=ke[Fi],Ki=0;Ki<Ar;++Ki)for(var ia=Gi[Ki],oa=0;oa<On;++oa)bi[hi++]=ia[oa]}function Pa(ke,Ut,Ar,On,bi){for(var zn=1,hi=Ar+1;hi<Ut.length;++hi)zn*=Ut[hi];var Fi=Ut[Ar];if(Ut.length-Ar===4){var Gi=Ut[Ar+1],Ki=Ut[Ar+2],ia=Ut[Ar+3];for(hi=0;hi<Fi;++hi)ji(ke[hi],Gi,Ki,ia,On,bi),bi+=zn}else for(hi=0;hi<Fi;++hi)Pa(ke[hi],Ut,Ar+1,On,bi),bi+=zn}function Yt(ke,Ut,Ar,On){var bi=1;if(Ut.length)for(var zn=0;zn<Ut.length;++zn)bi*=Ut[zn];else bi=0;var hi=On||Hr.allocType(Ar,bi);switch(Ut.length){case 0:break;case 1:Cr(ke,Ut[0],hi);break;case 2:Rr(ke,Ut[0],Ut[1],hi);break;case 3:ji(ke,Ut[0],Ut[1],Ut[2],hi,0);break;default:Pa(ke,Ut,0,hi,0)}return hi}function De(ke){for(var Ut=[],Ar=ke;Ar.length;Ar=Ar[0])Ut.push(Ar.length);return Ut}var Me={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ce=5120,He=5122,Pe=5124,Tt=5121,Mt=5123,$t=5125,fr=5126,Tr=5126,Sr={int8:ce,int16:He,int32:Pe,uint8:Tt,uint16:Mt,uint32:$t,float:fr,float32:Tr},sn=35048,lt=35040,Xt={dynamic:sn,stream:lt,static:35044},nr=Gt.flatten,ur=Gt.shape,Vr=35044,ln=35040,Un=5121,Gn=5126,qn=[];qn[5120]=1,qn[5122]=2,qn[5124]=4,qn[5121]=1,qn[5123]=2,qn[5125]=4,qn[5126]=4;function oi(ke){return Me[Object.prototype.toString.call(ke)]|0}function T(ke,Ut){for(var Ar=0;Ar<Ut.length;++Ar)ke[Ar]=Ut[Ar]}function H(ke,Ut,Ar,On,bi,zn,hi){for(var Fi=0,Gi=0;Gi<Ar;++Gi)for(var Ki=0;Ki<On;++Ki)ke[Fi++]=Ut[bi*Gi+zn*Ki+hi]}function _e(ke,Ut,Ar,On){var bi=0,zn={};function hi(yn){this.id=bi++,this.buffer=ke.createBuffer(),this.type=yn,this.usage=Vr,this.byteLength=0,this.dimension=1,this.dtype=Un,this.persistentData=null,Ar.profile&&(this.stats={size:0})}hi.prototype.bind=function(){ke.bindBuffer(this.type,this.buffer)},hi.prototype.destroy=function(){sa(this)};var Fi=[];function Gi(yn,Qn){var Yi=Fi.pop();return Yi||(Yi=new hi(yn)),Yi.bind(),oa(Yi,Qn,ln,0,1,!1),Yi}function Ki(yn){Fi.push(yn)}function ia(yn,Qn,Yi){yn.byteLength=Qn.byteLength,ke.bufferData(yn.type,Qn,Yi)}function oa(yn,Qn,Yi,wa,yi,Ri){var ta;if(yn.usage=Yi,Array.isArray(Qn)){if(yn.dtype=wa||Gn,Qn.length>0){var wo;if(Array.isArray(Qn[0])){ta=ur(Qn);for(var mi=1,xi=1;xi<ta.length;++xi)mi*=ta[xi];yn.dimension=mi,wo=nr(Qn,ta,yn.dtype),ia(yn,wo,Yi),Ri?yn.persistentData=wo:Hr.freeType(wo)}else if(typeof Qn[0]=="number"){yn.dimension=yi;var Qa=Hr.allocType(yn.dtype,Qn.length);T(Qa,Qn),ia(yn,Qa,Yi),Ri?yn.persistentData=Qa:Hr.freeType(Qa)}else k(Qn[0])?(yn.dimension=Qn[0].length,yn.dtype=wa||oi(Qn[0])||Gn,wo=nr(Qn,[Qn.length,Qn[0].length],yn.dtype),ia(yn,wo,Yi),Ri?yn.persistentData=wo:Hr.freeType(wo)):we.raise("invalid buffer data")}}else if(k(Qn))yn.dtype=wa||oi(Qn),yn.dimension=yi,ia(yn,Qn,Yi),Ri&&(yn.persistentData=new Uint8Array(new Uint8Array(Qn.buffer)));else if(ku(Qn)){ta=Qn.shape;var Aa=Qn.stride,ri=Qn.offset,_a=0,Zi=0,vo=0,Bo=0;ta.length===1?(_a=ta[0],Zi=1,vo=Aa[0],Bo=0):ta.length===2?(_a=ta[0],Zi=ta[1],vo=Aa[0],Bo=Aa[1]):we.raise("invalid shape"),yn.dtype=wa||oi(Qn.data)||Gn,yn.dimension=Zi;var Hi=Hr.allocType(yn.dtype,_a*Zi);H(Hi,Qn.data,_a,Zi,vo,Bo,ri),ia(yn,Hi,Yi),Ri?yn.persistentData=Hi:Hr.freeType(Hi)}else Qn instanceof ArrayBuffer?(yn.dtype=Un,yn.dimension=yi,ia(yn,Qn,Yi),Ri&&(yn.persistentData=new Uint8Array(new Uint8Array(Qn)))):we.raise("invalid buffer data")}function sa(yn){Ut.bufferCount--,On(yn);var Qn=yn.buffer;we(Qn,"buffer must not be deleted already"),ke.deleteBuffer(Qn),yn.buffer=null,delete zn[yn.id]}function Bi(yn,Qn,Yi,wa){Ut.bufferCount++;var yi=new hi(Qn);zn[yi.id]=yi;function Ri(mi){var xi=Vr,Qa=null,Aa=0,ri=0,_a=1;return Array.isArray(mi)||k(mi)||ku(mi)||mi instanceof ArrayBuffer?Qa=mi:typeof mi=="number"?Aa=mi|0:mi&&(we.type(mi,"object","buffer arguments must be an object, a number or an array"),"data"in mi&&(we(Qa===null||Array.isArray(Qa)||k(Qa)||ku(Qa),"invalid data for buffer"),Qa=mi.data),"usage"in mi&&(we.parameter(mi.usage,Xt,"invalid buffer usage"),xi=Xt[mi.usage]),"type"in mi&&(we.parameter(mi.type,Sr,"invalid buffer type"),ri=Sr[mi.type]),"dimension"in mi&&(we.type(mi.dimension,"number","invalid dimension"),_a=mi.dimension|0),"length"in mi&&(we.nni(Aa,"buffer length must be a nonnegative integer"),Aa=mi.length|0)),yi.bind(),Qa?oa(yi,Qa,xi,ri,_a,wa):(Aa&&ke.bufferData(yi.type,Aa,xi),yi.dtype=ri||Un,yi.usage=xi,yi.dimension=_a,yi.byteLength=Aa),Ar.profile&&(yi.stats.size=yi.byteLength*qn[yi.dtype]),Ri}function ta(mi,xi){we(xi+mi.byteLength<=yi.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+mi.byteLength+" starting from offset "+xi+" to a buffer of size "+yi.byteLength),ke.bufferSubData(yi.type,xi,mi)}function wo(mi,xi){var Qa=(xi||0)|0,Aa;if(yi.bind(),k(mi)||mi instanceof ArrayBuffer)ta(mi,Qa);else if(Array.isArray(mi)){if(mi.length>0)if(typeof mi[0]=="number"){var ri=Hr.allocType(yi.dtype,mi.length);T(ri,mi),ta(ri,Qa),Hr.freeType(ri)}else if(Array.isArray(mi[0])||k(mi[0])){Aa=ur(mi);var _a=nr(mi,Aa,yi.dtype);ta(_a,Qa),Hr.freeType(_a)}else we.raise("invalid buffer data")}else if(ku(mi)){Aa=mi.shape;var Zi=mi.stride,vo=0,Bo=0,Hi=0,ba=0;Aa.length===1?(vo=Aa[0],Bo=1,Hi=Zi[0],ba=0):Aa.length===2?(vo=Aa[0],Bo=Aa[1],Hi=Zi[0],ba=Zi[1]):we.raise("invalid shape");var go=Array.isArray(mi.data)?yi.dtype:oi(mi.data),Wo=Hr.allocType(go,vo*Bo);H(Wo,mi.data,vo,Bo,Hi,ba,mi.offset),ta(Wo,Qa),Hr.freeType(Wo)}else we.raise("invalid data for buffer subdata");return Ri}return Yi||Ri(yn),Ri._reglType="buffer",Ri._buffer=yi,Ri.subdata=wo,Ar.profile&&(Ri.stats=yi.stats),Ri.destroy=function(){sa(yi)},Ri}function Ji(){mt(zn).forEach(function(yn){yn.buffer=ke.createBuffer(),ke.bindBuffer(yn.type,yn.buffer),ke.bufferData(yn.type,yn.persistentData||yn.byteLength,yn.usage)})}return Ar.profile&&(Ut.getTotalBufferSize=function(){var yn=0;return Object.keys(zn).forEach(function(Qn){yn+=zn[Qn].stats.size}),yn}),{create:Bi,createStream:Gi,destroyStream:Ki,clear:function(){mt(zn).forEach(sa),Fi.forEach(sa)},getBuffer:function(yn){return yn&&yn._buffer instanceof hi?yn._buffer:null},restore:Ji,_initBuffer:oa}}var ne=0,$e=0,xt=1,zt=1,_r=4,xr=4,dn={points:ne,point:$e,lines:xt,line:zt,triangles:_r,triangle:xr,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Bn=0,zi=1,Vi=4,Ei=5120,qa=5121,$a=5122,La=5123,to=5124,Ho=5125,xo=34963,bo=35040,so=35044;function Cs(ke,Ut,Ar,On){var bi={},zn=0,hi={uint8:qa,uint16:La};Ut.oes_element_index_uint&&(hi.uint32=Ho);function Fi(Ji){this.id=zn++,bi[this.id]=this,this.buffer=Ji,this.primType=Vi,this.vertCount=0,this.type=0}Fi.prototype.bind=function(){this.buffer.bind()};var Gi=[];function Ki(Ji){var yn=Gi.pop();return yn||(yn=new Fi(Ar.create(null,xo,!0,!1)._buffer)),oa(yn,Ji,bo,-1,-1,0,0),yn}function ia(Ji){Gi.push(Ji)}function oa(Ji,yn,Qn,Yi,wa,yi,Ri){Ji.buffer.bind();var ta;if(yn){var wo=Ri;!Ri&&(!k(yn)||ku(yn)&&!k(yn.data))&&(wo=Ut.oes_element_index_uint?Ho:La),Ar._initBuffer(Ji.buffer,yn,Qn,wo,3)}else ke.bufferData(xo,yi,Qn),Ji.buffer.dtype=ta||qa,Ji.buffer.usage=Qn,Ji.buffer.dimension=3,Ji.buffer.byteLength=yi;if(ta=Ri,!Ri){switch(Ji.buffer.dtype){case qa:case Ei:ta=qa;break;case La:case $a:ta=La;break;case Ho:case to:ta=Ho;break;default:we.raise("unsupported type for element array")}Ji.buffer.dtype=ta}Ji.type=ta,we(ta!==Ho||!!Ut.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var mi=wa;mi<0&&(mi=Ji.buffer.byteLength,ta===La?mi>>=1:ta===Ho&&(mi>>=2)),Ji.vertCount=mi;var xi=Yi;if(Yi<0){xi=Vi;var Qa=Ji.buffer.dimension;Qa===1&&(xi=Bn),Qa===2&&(xi=zi),Qa===3&&(xi=Vi)}Ji.primType=xi}function sa(Ji){On.elementsCount--,we(Ji.buffer!==null,"must not double destroy elements"),delete bi[Ji.id],Ji.buffer.destroy(),Ji.buffer=null}function Bi(Ji,yn){var Qn=Ar.create(null,xo,!0),Yi=new Fi(Qn._buffer);On.elementsCount++;function wa(yi){if(!yi)Qn(),Yi.primType=Vi,Yi.vertCount=0,Yi.type=qa;else if(typeof yi=="number")Qn(yi),Yi.primType=Vi,Yi.vertCount=yi|0,Yi.type=qa;else{var Ri=null,ta=so,wo=-1,mi=-1,xi=0,Qa=0;Array.isArray(yi)||k(yi)||ku(yi)?Ri=yi:(we.type(yi,"object","invalid arguments for elements"),"data"in yi&&(Ri=yi.data,we(Array.isArray(Ri)||k(Ri)||ku(Ri),"invalid data for element buffer")),"usage"in yi&&(we.parameter(yi.usage,Xt,"invalid element buffer usage"),ta=Xt[yi.usage]),"primitive"in yi&&(we.parameter(yi.primitive,dn,"invalid element buffer primitive"),wo=dn[yi.primitive]),"count"in yi&&(we(typeof yi.count=="number"&&yi.count>=0,"invalid vertex count for elements"),mi=yi.count|0),"type"in yi&&(we.parameter(yi.type,hi,"invalid buffer type"),Qa=hi[yi.type]),"length"in yi?xi=yi.length|0:(xi=mi,Qa===La||Qa===$a?xi*=2:(Qa===Ho||Qa===to)&&(xi*=4))),oa(Yi,Ri,ta,wo,mi,xi,Qa)}return wa}return wa(Ji),wa._reglType="elements",wa._elements=Yi,wa.subdata=function(yi,Ri){return Qn.subdata(yi,Ri),wa},wa.destroy=function(){sa(Yi)},wa}return{create:Bi,createStream:Ki,destroyStream:ia,getElements:function(Ji){return typeof Ji=="function"&&Ji._elements instanceof Fi?Ji._elements:null},clear:function(){mt(bi).forEach(sa)}}}var Ls=new Float32Array(1),Rs=new Uint32Array(Ls.buffer),lu=5123;function ps(ke){for(var Ut=Hr.allocType(lu,ke.length),Ar=0;Ar<ke.length;++Ar)if(isNaN(ke[Ar]))Ut[Ar]=65535;else if(ke[Ar]===1/0)Ut[Ar]=31744;else if(ke[Ar]===-1/0)Ut[Ar]=64512;else{Ls[0]=ke[Ar];var On=Rs[0],bi=On>>>31<<15,zn=(On<<1>>>24)-127,hi=On>>13&(1<<10)-1;if(zn<-24)Ut[Ar]=bi;else if(zn<-14){var Fi=-14-zn;Ut[Ar]=bi+(hi+(1<<10)>>Fi)}else zn>15?Ut[Ar]=bi+31744:Ut[Ar]=bi+(zn+15<<10)+hi}return Ut}function Go(ke){return Array.isArray(ke)||k(ke)}var zu=function(ke){return!(ke&ke-1)&&!!ke},al=34467,ou=3553,Xu=34067,Nu=34069,ks=6408,Sc=6406,vl=6407,es=6409,Al=6410,tf=32854,Zl=32855,uc=36194,pf=32819,ql=32820,Cu=33635,rf=34042,ol=6402,as=34041,Ds=35904,Tl=35906,Yu=36193,Ml=33776,xl=33777,nf=33778,Vc=33779,Zf=35986,Hc=35987,Ql=34798,sl=35840,vc=35841,Jl=35842,ts=35843,gs=36196,$o=5121,ds=5123,Ns=5125,Mu=5126,ec=10242,zs=10243,df=10497,ha=33071,Gc=33648,kc=10240,un=10241,Mi=9728,ei=9729,za=9984,Za=9985,Oo=9986,mu=9987,Au=33170,Rl=4352,xh=4353,vf=4354,Wh=34046,oh=3317,mc=37440,lc=37441,Ku=37443,xs=37444,sh=33984,bl=[za,Oo,Za,mu],Ca=[0,es,Al,vl,ks],Zu={};Zu[es]=Zu[Sc]=Zu[ol]=1,Zu[as]=Zu[Al]=2,Zu[vl]=Zu[Ds]=3,Zu[ks]=Zu[Tl]=4;function $c(ke){return"[object "+ke+"]"}var os=$c("HTMLCanvasElement"),yo=$c("OffscreenCanvas"),As=$c("CanvasRenderingContext2D"),Ul=$c("ImageBitmap"),Xi=$c("HTMLImageElement"),cc=$c("HTMLVideoElement"),Dc=Object.keys(Me).concat([os,yo,As,Ul,Xi,cc]),af=[];af[$o]=1,af[Mu]=4,af[Yu]=2,af[ds]=2,af[Ns]=4;var Ws=[];Ws[tf]=2,Ws[Zl]=2,Ws[uc]=2,Ws[as]=4,Ws[Ml]=.5,Ws[xl]=.5,Ws[nf]=1,Ws[Vc]=1,Ws[Zf]=.5,Ws[Hc]=1,Ws[Ql]=1,Ws[sl]=.5,Ws[vc]=.25,Ws[Jl]=.5,Ws[ts]=.25,Ws[gs]=.5;function kl(ke){return Array.isArray(ke)&&(ke.length===0||typeof ke[0]=="number")}function Cc(ke){if(!Array.isArray(ke))return!1;var Ut=ke.length;return!(Ut===0||!Go(ke[0]))}function fc(ke){return Object.prototype.toString.call(ke)}function Fc(ke){return fc(ke)===os}function Sf(ke){return fc(ke)===yo}function hc(ke){return fc(ke)===As}function ap(ke){return fc(ke)===Ul}function jl(ke){return fc(ke)===Xi}function op(ke){return fc(ke)===cc}function tc(ke){var Ut=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Ut&&ke&&ke.getContext)}function Tu(ke){var Ut=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Ut&&ke&&"src"in ke&&"crossOrigin"in ke)}function bs(ke){if(!ke)return!1;if(tc(ke)||Tu(ke))return!0;var Ut=fc(ke);return Dc.indexOf(Ut)>=0?!0:kl(ke)||Cc(ke)||ku(ke)}function Xf(ke){return Me[Object.prototype.toString.call(ke)]|0}function Cf(ke,Ut){var Ar=Ut.length;switch(ke.type){case $o:case ds:case Ns:case Mu:var On=Hr.allocType(ke.type,Ar);On.set(Ut),ke.data=On;break;case Yu:ke.data=ps(Ut);break;default:we.raise("unsupported texture type, must specify a typed array")}}function cu(ke,Ut){return Hr.allocType(ke.type===Yu?Mu:ke.type,Ut)}function Dl(ke,Ut){ke.type===Yu?(ke.data=ps(Ut),Hr.freeType(Ut)):ke.data=Ut}function mf(ke,Ut,Ar,On,bi,zn){for(var hi=ke.width,Fi=ke.height,Gi=ke.channels,Ki=hi*Fi*Gi,ia=cu(ke,Ki),oa=0,sa=0;sa<Fi;++sa)for(var Bi=0;Bi<hi;++Bi)for(var Ji=0;Ji<Gi;++Ji)ia[oa++]=Ut[Ar*Bi+On*sa+bi*Ji+zn];Dl(ke,ia)}function Fl(ke,Ut,Ar,On,bi,zn){var hi;if(typeof Ws[ke]!="undefined"?hi=Ws[ke]:hi=Zu[ke]*af[Ut],zn&&(hi*=6),bi){for(var Fi=0,Gi=Ar;Gi>=1;)Fi+=hi*Gi*Gi,Gi/=2;return Fi}else return hi*Ar*On}function Ac(ke,Ut,Ar,On,bi,zn,hi){var Fi={"don't care":Rl,"dont care":Rl,nice:vf,fast:xh},Gi={repeat:df,clamp:ha,mirror:Gc},Ki={nearest:Mi,linear:ei},ia=m({mipmap:mu,"nearest mipmap nearest":za,"linear mipmap nearest":Za,"nearest mipmap linear":Oo,"linear mipmap linear":mu},Ki),oa={none:0,browser:xs},sa={uint8:$o,rgba4:pf,rgb565:Cu,"rgb5 a1":ql},Bi={alpha:Sc,luminance:es,"luminance alpha":Al,rgb:vl,rgba:ks,rgba4:tf,"rgb5 a1":Zl,rgb565:uc},Ji={};Ut.ext_srgb&&(Bi.srgb=Ds,Bi.srgba=Tl),Ut.oes_texture_float&&(sa.float32=sa.float=Mu),Ut.oes_texture_half_float&&(sa.float16=sa["half float"]=Yu),Ut.webgl_depth_texture&&(m(Bi,{depth:ol,"depth stencil":as}),m(sa,{uint16:ds,uint32:Ns,"depth stencil":rf})),Ut.webgl_compressed_texture_s3tc&&m(Ji,{"rgb s3tc dxt1":Ml,"rgba s3tc dxt1":xl,"rgba s3tc dxt3":nf,"rgba s3tc dxt5":Vc}),Ut.webgl_compressed_texture_atc&&m(Ji,{"rgb atc":Zf,"rgba atc explicit alpha":Hc,"rgba atc interpolated alpha":Ql}),Ut.webgl_compressed_texture_pvrtc&&m(Ji,{"rgb pvrtc 4bppv1":sl,"rgb pvrtc 2bppv1":vc,"rgba pvrtc 4bppv1":Jl,"rgba pvrtc 2bppv1":ts}),Ut.webgl_compressed_texture_etc1&&(Ji["rgb etc1"]=gs);var yn=Array.prototype.slice.call(ke.getParameter(al)||new Uint32Array(0));Object.keys(Ji).forEach(function(lr){var Wn=Ji[lr];yn.indexOf(Wn)>=0&&(Bi[lr]=Wn)});var Qn=Object.keys(Bi);Ar.textureFormats=Qn;var Yi=[];Object.keys(Bi).forEach(function(lr){var Wn=Bi[lr];Yi[Wn]=lr});var wa=[];Object.keys(sa).forEach(function(lr){var Wn=sa[lr];wa[Wn]=lr});var yi=[];Object.keys(Ki).forEach(function(lr){var Wn=Ki[lr];yi[Wn]=lr});var Ri=[];Object.keys(ia).forEach(function(lr){var Wn=ia[lr];Ri[Wn]=lr});var ta=[];Object.keys(Gi).forEach(function(lr){var Wn=Gi[lr];ta[Wn]=lr});var wo=Qn.reduce(function(lr,Wn){var Rn=Bi[Wn];return Rn===es||Rn===Sc||Rn===es||Rn===Al||Rn===ol||Rn===as||Ut.ext_srgb&&(Rn===Ds||Rn===Tl)?lr[Rn]=Rn:Rn===Zl||Wn.indexOf("rgba")>=0?lr[Rn]=ks:lr[Rn]=vl,lr},{});function mi(){this.internalformat=ks,this.format=ks,this.type=$o,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=xs,this.width=0,this.height=0,this.channels=0}function xi(lr,Wn){lr.internalformat=Wn.internalformat,lr.format=Wn.format,lr.type=Wn.type,lr.compressed=Wn.compressed,lr.premultiplyAlpha=Wn.premultiplyAlpha,lr.flipY=Wn.flipY,lr.unpackAlignment=Wn.unpackAlignment,lr.colorSpace=Wn.colorSpace,lr.width=Wn.width,lr.height=Wn.height,lr.channels=Wn.channels}function Qa(lr,Wn){if(!(typeof Wn!="object"||!Wn)){if("premultiplyAlpha"in Wn&&(we.type(Wn.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),lr.premultiplyAlpha=Wn.premultiplyAlpha),"flipY"in Wn&&(we.type(Wn.flipY,"boolean","invalid texture flip"),lr.flipY=Wn.flipY),"alignment"in Wn&&(we.oneOf(Wn.alignment,[1,2,4,8],"invalid texture unpack alignment"),lr.unpackAlignment=Wn.alignment),"colorSpace"in Wn&&(we.parameter(Wn.colorSpace,oa,"invalid colorSpace"),lr.colorSpace=oa[Wn.colorSpace]),"type"in Wn){var Rn=Wn.type;we(Ut.oes_texture_float||!(Rn==="float"||Rn==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),we(Ut.oes_texture_half_float||!(Rn==="half float"||Rn==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),we(Ut.webgl_depth_texture||!(Rn==="uint16"||Rn==="uint32"||Rn==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),we.parameter(Rn,sa,"invalid texture type"),lr.type=sa[Rn]}var ro=lr.width,qs=lr.height,ir=lr.channels,Rt=!1;"shape"in Wn?(we(Array.isArray(Wn.shape)&&Wn.shape.length>=2,"shape must be an array"),ro=Wn.shape[0],qs=Wn.shape[1],Wn.shape.length===3&&(ir=Wn.shape[2],we(ir>0&&ir<=4,"invalid number of channels"),Rt=!0),we(ro>=0&&ro<=Ar.maxTextureSize,"invalid width"),we(qs>=0&&qs<=Ar.maxTextureSize,"invalid height")):("radius"in Wn&&(ro=qs=Wn.radius,we(ro>=0&&ro<=Ar.maxTextureSize,"invalid radius")),"width"in Wn&&(ro=Wn.width,we(ro>=0&&ro<=Ar.maxTextureSize,"invalid width")),"height"in Wn&&(qs=Wn.height,we(qs>=0&&qs<=Ar.maxTextureSize,"invalid height")),"channels"in Wn&&(ir=Wn.channels,we(ir>0&&ir<=4,"invalid number of channels"),Rt=!0)),lr.width=ro|0,lr.height=qs|0,lr.channels=ir|0;var Zr=!1;if("format"in Wn){var cn=Wn.format;we(Ut.webgl_depth_texture||!(cn==="depth"||cn==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),we.parameter(cn,Bi,"invalid texture format");var jn=lr.internalformat=Bi[cn];lr.format=wo[jn],cn in sa&&("type"in Wn||(lr.type=sa[cn])),cn in Ji&&(lr.compressed=!0),Zr=!0}!Rt&&Zr?lr.channels=Zu[lr.format]:Rt&&!Zr?lr.channels!==Ca[lr.format]&&(lr.format=lr.internalformat=Ca[lr.channels]):Zr&&Rt&&we(lr.channels===Zu[lr.format],"number of channels inconsistent with specified format")}}function Aa(lr){ke.pixelStorei(mc,lr.flipY),ke.pixelStorei(lc,lr.premultiplyAlpha),ke.pixelStorei(Ku,lr.colorSpace),ke.pixelStorei(oh,lr.unpackAlignment)}function ri(){mi.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function _a(lr,Wn){var Rn=null;if(bs(Wn)?Rn=Wn:Wn&&(we.type(Wn,"object","invalid pixel data type"),Qa(lr,Wn),"x"in Wn&&(lr.xOffset=Wn.x|0),"y"in Wn&&(lr.yOffset=Wn.y|0),bs(Wn.data)&&(Rn=Wn.data)),we(!lr.compressed||Rn instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Wn.copy){we(!Rn,"can not specify copy and data field for the same texture");var ro=bi.viewportWidth,qs=bi.viewportHeight;lr.width=lr.width||ro-lr.xOffset,lr.height=lr.height||qs-lr.yOffset,lr.needsCopy=!0,we(lr.xOffset>=0&&lr.xOffset<ro&&lr.yOffset>=0&&lr.yOffset<qs&&lr.width>0&&lr.width<=ro&&lr.height>0&&lr.height<=qs,"copy texture read out of bounds")}else if(!Rn)lr.width=lr.width||1,lr.height=lr.height||1,lr.channels=lr.channels||4;else if(k(Rn))lr.channels=lr.channels||4,lr.data=Rn,!("type"in Wn)&&lr.type===$o&&(lr.type=Xf(Rn));else if(kl(Rn))lr.channels=lr.channels||4,Cf(lr,Rn),lr.alignment=1,lr.needsFree=!0;else if(ku(Rn)){var ir=Rn.data;!Array.isArray(ir)&&lr.type===$o&&(lr.type=Xf(ir));var Rt=Rn.shape,Zr=Rn.stride,cn,jn,Wr,wr,nn,Wt;Rt.length===3?(Wr=Rt[2],Wt=Zr[2]):(we(Rt.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Wr=1,Wt=1),cn=Rt[0],jn=Rt[1],wr=Zr[0],nn=Zr[1],lr.alignment=1,lr.width=cn,lr.height=jn,lr.channels=Wr,lr.format=lr.internalformat=Ca[Wr],lr.needsFree=!0,mf(lr,ir,wr,nn,Wt,Rn.offset)}else if(tc(Rn)||Fc(Rn)||Sf(Rn)||hc(Rn))tc(Rn)||Fc(Rn)||Sf(Rn)?lr.element=Rn:lr.element=Rn.canvas,lr.width=lr.element.width,lr.height=lr.element.height,lr.channels=4;else if(ap(Rn))lr.element=Rn,lr.width=Rn.width,lr.height=Rn.height,lr.channels=4;else if(jl(Rn))lr.element=Rn,lr.width=Rn.naturalWidth,lr.height=Rn.naturalHeight,lr.channels=4;else if(Tu(Rn))lr.element=Rn,lr.width=Rn.width,lr.height=Rn.height,lr.channels=4;else if(op(Rn))lr.element=Rn,lr.width=Rn.videoWidth,lr.height=Rn.videoHeight,lr.channels=4;else if(Cc(Rn)){var Or=lr.width||Rn[0].length,ar=lr.height||Rn.length,xn=lr.channels;Go(Rn[0][0])?xn=xn||Rn[0][0].length:xn=xn||1;for(var mn=Gt.shape(Rn),wi=1,ya=0;ya<mn.length;++ya)wi*=mn[ya];var xa=cu(lr,wi);Gt.flatten(Rn,mn,"",xa),Dl(lr,xa),lr.alignment=1,lr.width=Or,lr.height=ar,lr.channels=xn,lr.format=lr.internalformat=Ca[xn],lr.needsFree=!0}lr.type===Mu?we(Ar.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):lr.type===Yu&&we(Ar.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Zi(lr,Wn,Rn){var ro=lr.element,qs=lr.data,ir=lr.internalformat,Rt=lr.format,Zr=lr.type,cn=lr.width,jn=lr.height;Aa(lr),ro?ke.texImage2D(Wn,Rn,Rt,Rt,Zr,ro):lr.compressed?ke.compressedTexImage2D(Wn,Rn,ir,cn,jn,0,qs):lr.needsCopy?(On(),ke.copyTexImage2D(Wn,Rn,Rt,lr.xOffset,lr.yOffset,cn,jn,0)):ke.texImage2D(Wn,Rn,Rt,cn,jn,0,Rt,Zr,qs||null)}function vo(lr,Wn,Rn,ro,qs){var ir=lr.element,Rt=lr.data,Zr=lr.internalformat,cn=lr.format,jn=lr.type,Wr=lr.width,wr=lr.height;Aa(lr),ir?ke.texSubImage2D(Wn,qs,Rn,ro,cn,jn,ir):lr.compressed?ke.compressedTexSubImage2D(Wn,qs,Rn,ro,Zr,Wr,wr,Rt):lr.needsCopy?(On(),ke.copyTexSubImage2D(Wn,qs,Rn,ro,lr.xOffset,lr.yOffset,Wr,wr)):ke.texSubImage2D(Wn,qs,Rn,ro,Wr,wr,cn,jn,Rt)}var Bo=[];function Hi(){return Bo.pop()||new ri}function ba(lr){lr.needsFree&&Hr.freeType(lr.data),ri.call(lr),Bo.push(lr)}function go(){mi.call(this),this.genMipmaps=!1,this.mipmapHint=Rl,this.mipmask=0,this.images=Array(16)}function Wo(lr,Wn,Rn){var ro=lr.images[0]=Hi();lr.mipmask=1,ro.width=lr.width=Wn,ro.height=lr.height=Rn,ro.channels=lr.channels=4}function Ps(lr,Wn){var Rn=null;if(bs(Wn))Rn=lr.images[0]=Hi(),xi(Rn,lr),_a(Rn,Wn),lr.mipmask=1;else if(Qa(lr,Wn),Array.isArray(Wn.mipmap))for(var ro=Wn.mipmap,qs=0;qs<ro.length;++qs)Rn=lr.images[qs]=Hi(),xi(Rn,lr),Rn.width>>=qs,Rn.height>>=qs,_a(Rn,ro[qs]),lr.mipmask|=1<<qs;else Rn=lr.images[0]=Hi(),xi(Rn,lr),_a(Rn,Wn),lr.mipmask=1;xi(lr,lr.images[0]),lr.compressed&&(lr.internalformat===Ml||lr.internalformat===xl||lr.internalformat===nf||lr.internalformat===Vc)&&we(lr.width%4===0&&lr.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function xu(lr,Wn){for(var Rn=lr.images,ro=0;ro<Rn.length;++ro){if(!Rn[ro])return;Zi(Rn[ro],Wn,ro)}}var el=[];function Fs(){var lr=el.pop()||new go;mi.call(lr),lr.mipmask=0;for(var Wn=0;Wn<16;++Wn)lr.images[Wn]=null;return lr}function pc(lr){for(var Wn=lr.images,Rn=0;Rn<Wn.length;++Rn)Wn[Rn]&&ba(Wn[Rn]),Wn[Rn]=null;el.push(lr)}function pl(){this.minFilter=Mi,this.magFilter=Mi,this.wrapS=ha,this.wrapT=ha,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Rl}function Ol(lr,Wn){if("min"in Wn){var Rn=Wn.min;we.parameter(Rn,ia),lr.minFilter=ia[Rn],bl.indexOf(lr.minFilter)>=0&&!("faces"in Wn)&&(lr.genMipmaps=!0)}if("mag"in Wn){var ro=Wn.mag;we.parameter(ro,Ki),lr.magFilter=Ki[ro]}var qs=lr.wrapS,ir=lr.wrapT;if("wrap"in Wn){var Rt=Wn.wrap;typeof Rt=="string"?(we.parameter(Rt,Gi),qs=ir=Gi[Rt]):Array.isArray(Rt)&&(we.parameter(Rt[0],Gi),we.parameter(Rt[1],Gi),qs=Gi[Rt[0]],ir=Gi[Rt[1]])}else{if("wrapS"in Wn){var Zr=Wn.wrapS;we.parameter(Zr,Gi),qs=Gi[Zr]}if("wrapT"in Wn){var cn=Wn.wrapT;we.parameter(cn,Gi),ir=Gi[cn]}}if(lr.wrapS=qs,lr.wrapT=ir,"anisotropic"in Wn){var jn=Wn.anisotropic;we(typeof jn=="number"&&jn>=1&&jn<=Ar.maxAnisotropic,"aniso samples must be between 1 and "),lr.anisotropic=Wn.anisotropic}if("mipmap"in Wn){var Wr=!1;switch(typeof Wn.mipmap){case"string":we.parameter(Wn.mipmap,Fi,"invalid mipmap hint"),lr.mipmapHint=Fi[Wn.mipmap],lr.genMipmaps=!0,Wr=!0;break;case"boolean":Wr=lr.genMipmaps=Wn.mipmap;break;case"object":we(Array.isArray(Wn.mipmap),"invalid mipmap type"),lr.genMipmaps=!1,Wr=!0;break;default:we.raise("invalid mipmap type")}Wr&&!("min"in Wn)&&(lr.minFilter=za)}}function Vu(lr,Wn){ke.texParameteri(Wn,un,lr.minFilter),ke.texParameteri(Wn,kc,lr.magFilter),ke.texParameteri(Wn,ec,lr.wrapS),ke.texParameteri(Wn,zs,lr.wrapT),Ut.ext_texture_filter_anisotropic&&ke.texParameteri(Wn,Wh,lr.anisotropic),lr.genMipmaps&&(ke.hint(Au,lr.mipmapHint),ke.generateMipmap(Wn))}var Wl=0,dc={},Qc=Ar.maxTextureUnits,Il=Array(Qc).map(function(){return null});function ys(lr){mi.call(this),this.mipmask=0,this.internalformat=ks,this.id=Wl++,this.refCount=1,this.target=lr,this.texture=ke.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new pl,hi.profile&&(this.stats={size:0})}function tl(lr){ke.activeTexture(sh),ke.bindTexture(lr.target,lr.texture)}function Ts(){var lr=Il[0];lr?ke.bindTexture(lr.target,lr.texture):ke.bindTexture(ou,null)}function Jc(lr){var Wn=lr.texture;we(Wn,"must not double destroy texture");var Rn=lr.unit,ro=lr.target;Rn>=0&&(ke.activeTexture(sh+Rn),ke.bindTexture(ro,null),Il[Rn]=null),ke.deleteTexture(Wn),lr.texture=null,lr.params=null,lr.pixels=null,lr.refCount=0,delete dc[lr.id],zn.textureCount--}m(ys.prototype,{bind:function(){var lr=this;lr.bindCount+=1;var Wn=lr.unit;if(Wn<0){for(var Rn=0;Rn<Qc;++Rn){var ro=Il[Rn];if(ro){if(ro.bindCount>0)continue;ro.unit=-1}Il[Rn]=lr,Wn=Rn;break}Wn>=Qc&&we.raise("insufficient number of texture units"),hi.profile&&zn.maxTextureUnits<Wn+1&&(zn.maxTextureUnits=Wn+1),lr.unit=Wn,ke.activeTexture(sh+Wn),ke.bindTexture(lr.target,lr.texture)}return Wn},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Jc(this)}});function Vo(lr,Wn){var Rn=new ys(ou);dc[Rn.id]=Rn,zn.textureCount++;function ro(Rt,Zr){var cn=Rn.texInfo;pl.call(cn);var jn=Fs();return typeof Rt=="number"?typeof Zr=="number"?Wo(jn,Rt|0,Zr|0):Wo(jn,Rt|0,Rt|0):Rt?(we.type(Rt,"object","invalid arguments to regl.texture"),Ol(cn,Rt),Ps(jn,Rt)):Wo(jn,1,1),cn.genMipmaps&&(jn.mipmask=(jn.width<<1)-1),Rn.mipmask=jn.mipmask,xi(Rn,jn),we.texture2D(cn,jn,Ar),Rn.internalformat=jn.internalformat,ro.width=jn.width,ro.height=jn.height,tl(Rn),xu(jn,ou),Vu(cn,ou),Ts(),pc(jn),hi.profile&&(Rn.stats.size=Fl(Rn.internalformat,Rn.type,jn.width,jn.height,cn.genMipmaps,!1)),ro.format=Yi[Rn.internalformat],ro.type=wa[Rn.type],ro.mag=yi[cn.magFilter],ro.min=Ri[cn.minFilter],ro.wrapS=ta[cn.wrapS],ro.wrapT=ta[cn.wrapT],ro}function qs(Rt,Zr,cn,jn){we(!!Rt,"must specify image data");var Wr=Zr|0,wr=cn|0,nn=jn|0,Wt=Hi();return xi(Wt,Rn),Wt.width=0,Wt.height=0,_a(Wt,Rt),Wt.width=Wt.width||(Rn.width>>nn)-Wr,Wt.height=Wt.height||(Rn.height>>nn)-wr,we(Rn.type===Wt.type&&Rn.format===Wt.format&&Rn.internalformat===Wt.internalformat,"incompatible format for texture.subimage"),we(Wr>=0&&wr>=0&&Wr+Wt.width<=Rn.width&&wr+Wt.height<=Rn.height,"texture.subimage write out of bounds"),we(Rn.mipmask&1<<nn,"missing mipmap data"),we(Wt.data||Wt.element||Wt.needsCopy,"missing image data"),tl(Rn),vo(Wt,ou,Wr,wr,nn),Ts(),ba(Wt),ro}function ir(Rt,Zr){var cn=Rt|0,jn=Zr|0||cn;if(cn===Rn.width&&jn===Rn.height)return ro;ro.width=Rn.width=cn,ro.height=Rn.height=jn,tl(Rn);for(var Wr=0;Rn.mipmask>>Wr;++Wr){var wr=cn>>Wr,nn=jn>>Wr;if(!wr||!nn)break;ke.texImage2D(ou,Wr,Rn.format,wr,nn,0,Rn.format,Rn.type,null)}return Ts(),hi.profile&&(Rn.stats.size=Fl(Rn.internalformat,Rn.type,cn,jn,!1,!1)),ro}return ro(lr,Wn),ro.subimage=qs,ro.resize=ir,ro._reglType="texture2d",ro._texture=Rn,hi.profile&&(ro.stats=Rn.stats),ro.destroy=function(){Rn.decRef()},ro}function js(lr,Wn,Rn,ro,qs,ir){var Rt=new ys(Xu);dc[Rt.id]=Rt,zn.cubeCount++;var Zr=new Array(6);function cn(wr,nn,Wt,Or,ar,xn){var mn,wi=Rt.texInfo;for(pl.call(wi),mn=0;mn<6;++mn)Zr[mn]=Fs();if(typeof wr=="number"||!wr){var ya=wr|0||1;for(mn=0;mn<6;++mn)Wo(Zr[mn],ya,ya)}else if(typeof wr=="object")if(nn)Ps(Zr[0],wr),Ps(Zr[1],nn),Ps(Zr[2],Wt),Ps(Zr[3],Or),Ps(Zr[4],ar),Ps(Zr[5],xn);else if(Ol(wi,wr),Qa(Rt,wr),"faces"in wr){var xa=wr.faces;for(we(Array.isArray(xa)&&xa.length===6,"cube faces must be a length 6 array"),mn=0;mn<6;++mn)we(typeof xa[mn]=="object"&&!!xa[mn],"invalid input for cube map face"),xi(Zr[mn],Rt),Ps(Zr[mn],xa[mn])}else for(mn=0;mn<6;++mn)Ps(Zr[mn],wr);else we.raise("invalid arguments to cube map");for(xi(Rt,Zr[0]),we.optional(function(){Ar.npotTextureCube||we(zu(Rt.width)&&zu(Rt.height),"your browser does not support non power or two texture dimensions")}),wi.genMipmaps?Rt.mipmask=(Zr[0].width<<1)-1:Rt.mipmask=Zr[0].mipmask,we.textureCube(Rt,wi,Zr,Ar),Rt.internalformat=Zr[0].internalformat,cn.width=Zr[0].width,cn.height=Zr[0].height,tl(Rt),mn=0;mn<6;++mn)xu(Zr[mn],Nu+mn);for(Vu(wi,Xu),Ts(),hi.profile&&(Rt.stats.size=Fl(Rt.internalformat,Rt.type,cn.width,cn.height,wi.genMipmaps,!0)),cn.format=Yi[Rt.internalformat],cn.type=wa[Rt.type],cn.mag=yi[wi.magFilter],cn.min=Ri[wi.minFilter],cn.wrapS=ta[wi.wrapS],cn.wrapT=ta[wi.wrapT],mn=0;mn<6;++mn)pc(Zr[mn]);return cn}function jn(wr,nn,Wt,Or,ar){we(!!nn,"must specify image data"),we(typeof wr=="number"&&wr===(wr|0)&&wr>=0&&wr<6,"invalid face");var xn=Wt|0,mn=Or|0,wi=ar|0,ya=Hi();return xi(ya,Rt),ya.width=0,ya.height=0,_a(ya,nn),ya.width=ya.width||(Rt.width>>wi)-xn,ya.height=ya.height||(Rt.height>>wi)-mn,we(Rt.type===ya.type&&Rt.format===ya.format&&Rt.internalformat===ya.internalformat,"incompatible format for texture.subimage"),we(xn>=0&&mn>=0&&xn+ya.width<=Rt.width&&mn+ya.height<=Rt.height,"texture.subimage write out of bounds"),we(Rt.mipmask&1<<wi,"missing mipmap data"),we(ya.data||ya.element||ya.needsCopy,"missing image data"),tl(Rt),vo(ya,Nu+wr,xn,mn,wi),Ts(),ba(ya),cn}function Wr(wr){var nn=wr|0;if(nn!==Rt.width){cn.width=Rt.width=nn,cn.height=Rt.height=nn,tl(Rt);for(var Wt=0;Wt<6;++Wt)for(var Or=0;Rt.mipmask>>Or;++Or)ke.texImage2D(Nu+Wt,Or,Rt.format,nn>>Or,nn>>Or,0,Rt.format,Rt.type,null);return Ts(),hi.profile&&(Rt.stats.size=Fl(Rt.internalformat,Rt.type,cn.width,cn.height,!1,!0)),cn}}return cn(lr,Wn,Rn,ro,qs,ir),cn.subimage=jn,cn.resize=Wr,cn._reglType="textureCube",cn._texture=Rt,hi.profile&&(cn.stats=Rt.stats),cn.destroy=function(){Rt.decRef()},cn}function Iu(){for(var lr=0;lr<Qc;++lr)ke.activeTexture(sh+lr),ke.bindTexture(ou,null),Il[lr]=null;mt(dc).forEach(Jc),zn.cubeCount=0,zn.textureCount=0}hi.profile&&(zn.getTotalTextureSize=function(){var lr=0;return Object.keys(dc).forEach(function(Wn){lr+=dc[Wn].stats.size}),lr});function ic(){for(var lr=0;lr<Qc;++lr){var Wn=Il[lr];Wn&&(Wn.bindCount=0,Wn.unit=-1,Il[lr]=null)}mt(dc).forEach(function(Rn){Rn.texture=ke.createTexture(),ke.bindTexture(Rn.target,Rn.texture);for(var ro=0;ro<32;++ro)if(Rn.mipmask&1<<ro)if(Rn.target===ou)ke.texImage2D(ou,ro,Rn.internalformat,Rn.width>>ro,Rn.height>>ro,0,Rn.internalformat,Rn.type,null);else for(var qs=0;qs<6;++qs)ke.texImage2D(Nu+qs,ro,Rn.internalformat,Rn.width>>ro,Rn.height>>ro,0,Rn.internalformat,Rn.type,null);Vu(Rn.texInfo,Rn.target)})}function Vh(){for(var lr=0;lr<Qc;++lr){var Wn=Il[lr];Wn&&(Wn.bindCount=0,Wn.unit=-1,Il[lr]=null),ke.activeTexture(sh+lr),ke.bindTexture(ou,null),ke.bindTexture(Xu,null)}}return{create2D:Vo,createCube:js,clear:Iu,getTexture:function(lr){return null},restore:ic,refresh:Vh}}var Yf=36161,Qi=32854,Xa=32855,of=36194,Pl=33189,Bc=36168,Qu=34041,ul=35907,uh=34836,sp=34842,fu=34843,Pu=[];Pu[Qi]=2,Pu[Xa]=2,Pu[of]=2,Pu[Pl]=2,Pu[Bc]=1,Pu[Qu]=4,Pu[ul]=4,Pu[uh]=16,Pu[sp]=8,Pu[fu]=6;function up(ke,Ut,Ar){return Pu[ke]*Ut*Ar}var Ja=function(ke,Ut,Ar,On,bi){var zn={rgba4:Qi,rgb565:of,"rgb5 a1":Xa,depth:Pl,stencil:Bc,"depth stencil":Qu};Ut.ext_srgb&&(zn.srgba=ul),Ut.ext_color_buffer_half_float&&(zn.rgba16f=sp,zn.rgb16f=fu),Ut.webgl_color_buffer_float&&(zn.rgba32f=uh);var hi=[];Object.keys(zn).forEach(function(Bi){var Ji=zn[Bi];hi[Ji]=Bi});var Fi=0,Gi={};function Ki(Bi){this.id=Fi++,this.refCount=1,this.renderbuffer=Bi,this.format=Qi,this.width=0,this.height=0,bi.profile&&(this.stats={size:0})}Ki.prototype.decRef=function(){--this.refCount<=0&&ia(this)};function ia(Bi){var Ji=Bi.renderbuffer;we(Ji,"must not double destroy renderbuffer"),ke.bindRenderbuffer(Yf,null),ke.deleteRenderbuffer(Ji),Bi.renderbuffer=null,Bi.refCount=0,delete Gi[Bi.id],On.renderbufferCount--}function oa(Bi,Ji){var yn=new Ki(ke.createRenderbuffer());Gi[yn.id]=yn,On.renderbufferCount++;function Qn(wa,yi){var Ri=0,ta=0,wo=Qi;if(typeof wa=="object"&&wa){var mi=wa;if("shape"in mi){var xi=mi.shape;we(Array.isArray(xi)&&xi.length>=2,"invalid renderbuffer shape"),Ri=xi[0]|0,ta=xi[1]|0}else"radius"in mi&&(Ri=ta=mi.radius|0),"width"in mi&&(Ri=mi.width|0),"height"in mi&&(ta=mi.height|0);"format"in mi&&(we.parameter(mi.format,zn,"invalid renderbuffer format"),wo=zn[mi.format])}else typeof wa=="number"?(Ri=wa|0,typeof yi=="number"?ta=yi|0:ta=Ri):wa?we.raise("invalid arguments to renderbuffer constructor"):Ri=ta=1;if(we(Ri>0&&ta>0&&Ri<=Ar.maxRenderbufferSize&&ta<=Ar.maxRenderbufferSize,"invalid renderbuffer size"),!(Ri===yn.width&&ta===yn.height&&wo===yn.format))return Qn.width=yn.width=Ri,Qn.height=yn.height=ta,yn.format=wo,ke.bindRenderbuffer(Yf,yn.renderbuffer),ke.renderbufferStorage(Yf,wo,Ri,ta),we(ke.getError()===0,"invalid render buffer format"),bi.profile&&(yn.stats.size=up(yn.format,yn.width,yn.height)),Qn.format=hi[yn.format],Qn}function Yi(wa,yi){var Ri=wa|0,ta=yi|0||Ri;return Ri===yn.width&&ta===yn.height||(we(Ri>0&&ta>0&&Ri<=Ar.maxRenderbufferSize&&ta<=Ar.maxRenderbufferSize,"invalid renderbuffer size"),Qn.width=yn.width=Ri,Qn.height=yn.height=ta,ke.bindRenderbuffer(Yf,yn.renderbuffer),ke.renderbufferStorage(Yf,yn.format,Ri,ta),we(ke.getError()===0,"invalid render buffer format"),bi.profile&&(yn.stats.size=up(yn.format,yn.width,yn.height))),Qn}return Qn(Bi,Ji),Qn.resize=Yi,Qn._reglType="renderbuffer",Qn._renderbuffer=yn,bi.profile&&(Qn.stats=yn.stats),Qn.destroy=function(){yn.decRef()},Qn}bi.profile&&(On.getTotalRenderbufferSize=function(){var Bi=0;return Object.keys(Gi).forEach(function(Ji){Bi+=Gi[Ji].stats.size}),Bi});function sa(){mt(Gi).forEach(function(Bi){Bi.renderbuffer=ke.createRenderbuffer(),ke.bindRenderbuffer(Yf,Bi.renderbuffer),ke.renderbufferStorage(Yf,Bi.format,Bi.width,Bi.height)}),ke.bindRenderbuffer(Yf,null)}return{create:oa,clear:function(){mt(Gi).forEach(ia)},restore:sa}},Kn=36160,Wc=36161,Ju=3553,Nt=34069,Xc=36064,ss=36096,Uu=36128,cs=33306,Kf=36053,Uf=36054,Nc=36055,Tc=36057,gf=36061,lh=36193,Af=5121,Tf=5126,Mf=6407,Pf=6408,ju=6402,gp=[Mf,Pf],qf=[];qf[Pf]=4,qf[Mf]=3;var h=[];h[Af]=1,h[Tf]=4,h[lh]=2;var g=32854,p=32855,b=36194,N=33189,q=36168,ee=34041,ge=35907,Ue=34836,st=34842,kt=34843,Lt=[g,p,b,ge,st,kt,Ue],Zt={};Zt[Kf]="complete",Zt[Uf]="incomplete attachment",Zt[Tc]="incomplete dimensions",Zt[Nc]="incomplete, missing attachment",Zt[gf]="unsupported";function vr(ke,Ut,Ar,On,bi,zn){var hi={cur:null,next:null,dirty:!1,setFBO:null},Fi=["rgba"],Gi=["rgba4","rgb565","rgb5 a1"];Ut.ext_srgb&&Gi.push("srgba"),Ut.ext_color_buffer_half_float&&Gi.push("rgba16f","rgb16f"),Ut.webgl_color_buffer_float&&Gi.push("rgba32f");var Ki=["uint8"];Ut.oes_texture_half_float&&Ki.push("half float","float16"),Ut.oes_texture_float&&Ki.push("float","float32");function ia(ri,_a,Zi){this.target=ri,this.texture=_a,this.renderbuffer=Zi;var vo=0,Bo=0;_a?(vo=_a.width,Bo=_a.height):Zi&&(vo=Zi.width,Bo=Zi.height),this.width=vo,this.height=Bo}function oa(ri){ri&&(ri.texture&&ri.texture._texture.decRef(),ri.renderbuffer&&ri.renderbuffer._renderbuffer.decRef())}function sa(ri,_a,Zi){if(ri)if(ri.texture){var vo=ri.texture._texture,Bo=Math.max(1,vo.width),Hi=Math.max(1,vo.height);we(Bo===_a&&Hi===Zi,"inconsistent width/height for supplied texture"),vo.refCount+=1}else{var ba=ri.renderbuffer._renderbuffer;we(ba.width===_a&&ba.height===Zi,"inconsistent width/height for renderbuffer"),ba.refCount+=1}}function Bi(ri,_a){_a&&(_a.texture?ke.framebufferTexture2D(Kn,ri,_a.target,_a.texture._texture.texture,0):ke.framebufferRenderbuffer(Kn,ri,Wc,_a.renderbuffer._renderbuffer.renderbuffer))}function Ji(ri){var _a=Ju,Zi=null,vo=null,Bo=ri;typeof ri=="object"&&(Bo=ri.data,"target"in ri&&(_a=ri.target|0)),we.type(Bo,"function","invalid attachment data");var Hi=Bo._reglType;return Hi==="texture2d"?(Zi=Bo,we(_a===Ju)):Hi==="textureCube"?(Zi=Bo,we(_a>=Nt&&_a<Nt+6,"invalid cube map target")):Hi==="renderbuffer"?(vo=Bo,_a=Wc):we.raise("invalid regl object for attachment"),new ia(_a,Zi,vo)}function yn(ri,_a,Zi,vo,Bo){if(Zi){var Hi=On.create2D({width:ri,height:_a,format:vo,type:Bo});return Hi._texture.refCount=0,new ia(Ju,Hi,null)}else{var ba=bi.create({width:ri,height:_a,format:vo});return ba._renderbuffer.refCount=0,new ia(Wc,null,ba)}}function Qn(ri){return ri&&(ri.texture||ri.renderbuffer)}function Yi(ri,_a,Zi){ri&&(ri.texture?ri.texture.resize(_a,Zi):ri.renderbuffer&&ri.renderbuffer.resize(_a,Zi),ri.width=_a,ri.height=Zi)}var wa=0,yi={};function Ri(){this.id=wa++,yi[this.id]=this,this.framebuffer=ke.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function ta(ri){ri.colorAttachments.forEach(oa),oa(ri.depthAttachment),oa(ri.stencilAttachment),oa(ri.depthStencilAttachment)}function wo(ri){var _a=ri.framebuffer;we(_a,"must not double destroy framebuffer"),ke.deleteFramebuffer(_a),ri.framebuffer=null,zn.framebufferCount--,delete yi[ri.id]}function mi(ri){var _a;ke.bindFramebuffer(Kn,ri.framebuffer);var Zi=ri.colorAttachments;for(_a=0;_a<Zi.length;++_a)Bi(Xc+_a,Zi[_a]);for(_a=Zi.length;_a<Ar.maxColorAttachments;++_a)ke.framebufferTexture2D(Kn,Xc+_a,Ju,null,0);ke.framebufferTexture2D(Kn,cs,Ju,null,0),ke.framebufferTexture2D(Kn,ss,Ju,null,0),ke.framebufferTexture2D(Kn,Uu,Ju,null,0),Bi(ss,ri.depthAttachment),Bi(Uu,ri.stencilAttachment),Bi(cs,ri.depthStencilAttachment);var vo=ke.checkFramebufferStatus(Kn);!ke.isContextLost()&&vo!==Kf&&we.raise("framebuffer configuration not supported, status = "+Zt[vo]),ke.bindFramebuffer(Kn,hi.next?hi.next.framebuffer:null),hi.cur=hi.next,ke.getError()}function xi(ri,_a){var Zi=new Ri;zn.framebufferCount++;function vo(Hi,ba){var go;we(hi.next!==Zi,"can not update framebuffer which is currently in use");var Wo=0,Ps=0,xu=!0,el=!0,Fs=null,pc=!0,pl="rgba",Ol="uint8",Vu=1,Wl=null,dc=null,Qc=null,Il=!1;if(typeof Hi=="number")Wo=Hi|0,Ps=ba|0||Wo;else if(!Hi)Wo=Ps=1;else{we.type(Hi,"object","invalid arguments for framebuffer");var ys=Hi;if("shape"in ys){var tl=ys.shape;we(Array.isArray(tl)&&tl.length>=2,"invalid shape for framebuffer"),Wo=tl[0],Ps=tl[1]}else"radius"in ys&&(Wo=Ps=ys.radius),"width"in ys&&(Wo=ys.width),"height"in ys&&(Ps=ys.height);("color"in ys||"colors"in ys)&&(Fs=ys.color||ys.colors,Array.isArray(Fs)&&we(Fs.length===1||Ut.webgl_draw_buffers,"multiple render targets not supported")),Fs||("colorCount"in ys&&(Vu=ys.colorCount|0,we(Vu>0,"invalid color buffer count")),"colorTexture"in ys&&(pc=!!ys.colorTexture,pl="rgba4"),"colorType"in ys&&(Ol=ys.colorType,pc?(we(Ut.oes_texture_float||!(Ol==="float"||Ol==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),we(Ut.oes_texture_half_float||!(Ol==="half float"||Ol==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Ol==="half float"||Ol==="float16"?(we(Ut.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),pl="rgba16f"):(Ol==="float"||Ol==="float32")&&(we(Ut.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),pl="rgba32f"),we.oneOf(Ol,Ki,"invalid color type")),"colorFormat"in ys&&(pl=ys.colorFormat,Fi.indexOf(pl)>=0?pc=!0:Gi.indexOf(pl)>=0?pc=!1:we.optional(function(){pc?we.oneOf(ys.colorFormat,Fi,"invalid color format for texture"):we.oneOf(ys.colorFormat,Gi,"invalid color format for renderbuffer")}))),("depthTexture"in ys||"depthStencilTexture"in ys)&&(Il=!!(ys.depthTexture||ys.depthStencilTexture),we(!Il||Ut.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ys&&(typeof ys.depth=="boolean"?xu=ys.depth:(Wl=ys.depth,el=!1)),"stencil"in ys&&(typeof ys.stencil=="boolean"?el=ys.stencil:(dc=ys.stencil,xu=!1)),"depthStencil"in ys&&(typeof ys.depthStencil=="boolean"?xu=el=ys.depthStencil:(Qc=ys.depthStencil,xu=!1,el=!1))}var Ts=null,Jc=null,Vo=null,js=null;if(Array.isArray(Fs))Ts=Fs.map(Ji);else if(Fs)Ts=[Ji(Fs)];else for(Ts=new Array(Vu),go=0;go<Vu;++go)Ts[go]=yn(Wo,Ps,pc,pl,Ol);we(Ut.webgl_draw_buffers||Ts.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),we(Ts.length<=Ar.maxColorAttachments,"too many color attachments, not supported"),Wo=Wo||Ts[0].width,Ps=Ps||Ts[0].height,Wl?Jc=Ji(Wl):xu&&!el&&(Jc=yn(Wo,Ps,Il,"depth","uint32")),dc?Vo=Ji(dc):el&&!xu&&(Vo=yn(Wo,Ps,!1,"stencil","uint8")),Qc?js=Ji(Qc):!Wl&&!dc&&el&&xu&&(js=yn(Wo,Ps,Il,"depth stencil","depth stencil")),we(!!Wl+!!dc+!!Qc<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Iu=null;for(go=0;go<Ts.length;++go)if(sa(Ts[go],Wo,Ps),we(!Ts[go]||Ts[go].texture&&gp.indexOf(Ts[go].texture._texture.format)>=0||Ts[go].renderbuffer&&Lt.indexOf(Ts[go].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+go+" is invalid"),Ts[go]&&Ts[go].texture){var ic=qf[Ts[go].texture._texture.format]*h[Ts[go].texture._texture.type];Iu===null?Iu=ic:we(Iu===ic,"all color attachments much have the same number of bits per pixel.")}return sa(Jc,Wo,Ps),we(!Jc||Jc.texture&&Jc.texture._texture.format===ju||Jc.renderbuffer&&Jc.renderbuffer._renderbuffer.format===N,"invalid depth attachment for framebuffer object"),sa(Vo,Wo,Ps),we(!Vo||Vo.renderbuffer&&Vo.renderbuffer._renderbuffer.format===q,"invalid stencil attachment for framebuffer object"),sa(js,Wo,Ps),we(!js||js.texture&&js.texture._texture.format===ee||js.renderbuffer&&js.renderbuffer._renderbuffer.format===ee,"invalid depth-stencil attachment for framebuffer object"),ta(Zi),Zi.width=Wo,Zi.height=Ps,Zi.colorAttachments=Ts,Zi.depthAttachment=Jc,Zi.stencilAttachment=Vo,Zi.depthStencilAttachment=js,vo.color=Ts.map(Qn),vo.depth=Qn(Jc),vo.stencil=Qn(Vo),vo.depthStencil=Qn(js),vo.width=Zi.width,vo.height=Zi.height,mi(Zi),vo}function Bo(Hi,ba){we(hi.next!==Zi,"can not resize a framebuffer which is currently in use");var go=Math.max(Hi|0,1),Wo=Math.max(ba|0||go,1);if(go===Zi.width&&Wo===Zi.height)return vo;for(var Ps=Zi.colorAttachments,xu=0;xu<Ps.length;++xu)Yi(Ps[xu],go,Wo);return Yi(Zi.depthAttachment,go,Wo),Yi(Zi.stencilAttachment,go,Wo),Yi(Zi.depthStencilAttachment,go,Wo),Zi.width=vo.width=go,Zi.height=vo.height=Wo,mi(Zi),vo}return vo(ri,_a),m(vo,{resize:Bo,_reglType:"framebuffer",_framebuffer:Zi,destroy:function(){wo(Zi),ta(Zi)},use:function(Hi){hi.setFBO({framebuffer:vo},Hi)}})}function Qa(ri){var _a=Array(6);function Zi(Bo){var Hi;we(_a.indexOf(hi.next)<0,"can not update framebuffer which is currently in use");var ba={color:null},go=0,Wo=null,Ps="rgba",xu="uint8",el=1;if(typeof Bo=="number")go=Bo|0;else if(!Bo)go=1;else{we.type(Bo,"object","invalid arguments for framebuffer");var Fs=Bo;if("shape"in Fs){var pc=Fs.shape;we(Array.isArray(pc)&&pc.length>=2,"invalid shape for framebuffer"),we(pc[0]===pc[1],"cube framebuffer must be square"),go=pc[0]}else"radius"in Fs&&(go=Fs.radius|0),"width"in Fs?(go=Fs.width|0,"height"in Fs&&we(Fs.height===go,"must be square")):"height"in Fs&&(go=Fs.height|0);("color"in Fs||"colors"in Fs)&&(Wo=Fs.color||Fs.colors,Array.isArray(Wo)&&we(Wo.length===1||Ut.webgl_draw_buffers,"multiple render targets not supported")),Wo||("colorCount"in Fs&&(el=Fs.colorCount|0,we(el>0,"invalid color buffer count")),"colorType"in Fs&&(we.oneOf(Fs.colorType,Ki,"invalid color type"),xu=Fs.colorType),"colorFormat"in Fs&&(Ps=Fs.colorFormat,we.oneOf(Fs.colorFormat,Fi,"invalid color format for texture"))),"depth"in Fs&&(ba.depth=Fs.depth),"stencil"in Fs&&(ba.stencil=Fs.stencil),"depthStencil"in Fs&&(ba.depthStencil=Fs.depthStencil)}var pl;if(Wo)if(Array.isArray(Wo))for(pl=[],Hi=0;Hi<Wo.length;++Hi)pl[Hi]=Wo[Hi];else pl=[Wo];else{pl=Array(el);var Ol={radius:go,format:Ps,type:xu};for(Hi=0;Hi<el;++Hi)pl[Hi]=On.createCube(Ol)}for(ba.color=Array(pl.length),Hi=0;Hi<pl.length;++Hi){var Vu=pl[Hi];we(typeof Vu=="function"&&Vu._reglType==="textureCube","invalid cube map"),go=go||Vu.width,we(Vu.width===go&&Vu.height===go,"invalid cube map shape"),ba.color[Hi]={target:Nt,data:pl[Hi]}}for(Hi=0;Hi<6;++Hi){for(var Wl=0;Wl<pl.length;++Wl)ba.color[Wl].target=Nt+Hi;Hi>0&&(ba.depth=_a[0].depth,ba.stencil=_a[0].stencil,ba.depthStencil=_a[0].depthStencil),_a[Hi]?_a[Hi](ba):_a[Hi]=xi(ba)}return m(Zi,{width:go,height:go,color:pl})}function vo(Bo){var Hi,ba=Bo|0;if(we(ba>0&&ba<=Ar.maxCubeMapSize,"invalid radius for cube fbo"),ba===Zi.width)return Zi;var go=Zi.color;for(Hi=0;Hi<go.length;++Hi)go[Hi].resize(ba);for(Hi=0;Hi<6;++Hi)_a[Hi].resize(ba);return Zi.width=Zi.height=ba,Zi}return Zi(ri),m(Zi,{faces:_a,resize:vo,_reglType:"framebufferCube",destroy:function(){_a.forEach(function(Bo){Bo.destroy()})}})}function Aa(){hi.cur=null,hi.next=null,hi.dirty=!0,mt(yi).forEach(function(ri){ri.framebuffer=ke.createFramebuffer(),mi(ri)})}return m(hi,{getFramebuffer:function(ri){if(typeof ri=="function"&&ri._reglType==="framebuffer"){var _a=ri._framebuffer;if(_a instanceof Ri)return _a}return null},create:xi,createCube:Qa,clear:function(){mt(yi).forEach(wo)},restore:Aa})}var pr=5126,Nr=34962,cr=34963,zr=["attributes","elements","offset","count","primitive","instances"];function Ur(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=pr,this.offset=0,this.stride=0,this.divisor=0}function Tn(ke,Ut,Ar,On,bi,zn,hi){for(var Fi=Ar.maxAttributes,Gi=new Array(Fi),Ki=0;Ki<Fi;++Ki)Gi[Ki]=new Ur;var ia=0,oa={},sa={Record:Ur,scope:{},state:Gi,currentVAO:null,targetVAO:null,restore:Ji()?ta:function(){},createVAO:wo,getVAO:Qn,destroyBuffer:Bi,setVAO:Ji()?Yi:wa,clear:Ji()?yi:function(){}};function Bi(mi){for(var xi=0;xi<Gi.length;++xi){var Qa=Gi[xi];Qa.buffer===mi&&(ke.disableVertexAttribArray(xi),Qa.buffer=null)}}function Ji(){return Ut.oes_vertex_array_object}function yn(){return Ut.angle_instanced_arrays}function Qn(mi){return typeof mi=="function"&&mi._vao?mi._vao:null}function Yi(mi){if(mi!==sa.currentVAO){var xi=Ji();mi?xi.bindVertexArrayOES(mi.vao):xi.bindVertexArrayOES(null),sa.currentVAO=mi}}function wa(mi){if(mi!==sa.currentVAO){if(mi)mi.bindAttrs();else{for(var xi=yn(),Qa=0;Qa<Gi.length;++Qa){var Aa=Gi[Qa];Aa.buffer?(ke.enableVertexAttribArray(Qa),Aa.buffer.bind(),ke.vertexAttribPointer(Qa,Aa.size,Aa.type,Aa.normalized,Aa.stride,Aa.offfset),xi&&Aa.divisor&&xi.vertexAttribDivisorANGLE(Qa,Aa.divisor)):(ke.disableVertexAttribArray(Qa),ke.vertexAttrib4f(Qa,Aa.x,Aa.y,Aa.z,Aa.w))}hi.elements?ke.bindBuffer(cr,hi.elements.buffer.buffer):ke.bindBuffer(cr,null)}sa.currentVAO=mi}}function yi(){mt(oa).forEach(function(mi){mi.destroy()})}function Ri(){this.id=++ia,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var mi=Ji();mi?this.vao=mi.createVertexArrayOES():this.vao=null,oa[this.id]=this,this.buffers=[]}Ri.prototype.bindAttrs=function(){for(var mi=yn(),xi=this.attributes,Qa=0;Qa<xi.length;++Qa){var Aa=xi[Qa];Aa.buffer?(ke.enableVertexAttribArray(Qa),ke.bindBuffer(Nr,Aa.buffer.buffer),ke.vertexAttribPointer(Qa,Aa.size,Aa.type,Aa.normalized,Aa.stride,Aa.offset),mi&&Aa.divisor&&mi.vertexAttribDivisorANGLE(Qa,Aa.divisor)):(ke.disableVertexAttribArray(Qa),ke.vertexAttrib4f(Qa,Aa.x,Aa.y,Aa.z,Aa.w))}for(var ri=xi.length;ri<Fi;++ri)ke.disableVertexAttribArray(ri);var _a=zn.getElements(this.elements);_a?ke.bindBuffer(cr,_a.buffer.buffer):ke.bindBuffer(cr,null)},Ri.prototype.refresh=function(){var mi=Ji();mi&&(mi.bindVertexArrayOES(this.vao),this.bindAttrs(),sa.currentVAO=null,mi.bindVertexArrayOES(null))},Ri.prototype.destroy=function(){if(this.vao){var mi=Ji();this===sa.currentVAO&&(sa.currentVAO=null,mi.bindVertexArrayOES(null)),mi.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),oa[this.id]&&(delete oa[this.id],On.vaoCount-=1)};function ta(){var mi=Ji();mi&&mt(oa).forEach(function(xi){xi.refresh()})}function wo(mi){var xi=new Ri;On.vaoCount+=1;function Qa(Aa){var ri;if(Array.isArray(Aa))ri=Aa,xi.elements&&xi.ownsElements&&xi.elements.destroy(),xi.elements=null,xi.ownsElements=!1,xi.offset=0,xi.count=0,xi.instances=-1,xi.primitive=4;else{if(we(typeof Aa=="object","invalid arguments for create vao"),we("attributes"in Aa,"must specify attributes for vao"),Aa.elements){var _a=Aa.elements;xi.ownsElements?typeof _a=="function"&&_a._reglType==="elements"?(xi.elements.destroy(),xi.ownsElements=!1):(xi.elements(_a),xi.ownsElements=!1):zn.getElements(Aa.elements)?(xi.elements=Aa.elements,xi.ownsElements=!1):(xi.elements=zn.create(Aa.elements),xi.ownsElements=!0)}else xi.elements=null,xi.ownsElements=!1;ri=Aa.attributes,xi.offset=0,xi.count=-1,xi.instances=-1,xi.primitive=4,xi.elements&&(xi.count=xi.elements._elements.vertCount,xi.primitive=xi.elements._elements.primType),"offset"in Aa&&(xi.offset=Aa.offset|0),"count"in Aa&&(xi.count=Aa.count|0),"instances"in Aa&&(xi.instances=Aa.instances|0),"primitive"in Aa&&(we(Aa.primitive in dn,"bad primitive type: "+Aa.primitive),xi.primitive=dn[Aa.primitive]),we.optional(function(){for(var xu=Object.keys(Aa),el=0;el<xu.length;++el)we(zr.indexOf(xu[el])>=0,'invalid option for vao: "'+xu[el]+'" valid options are '+zr)}),we(Array.isArray(ri),"attributes must be an array")}we(ri.length<Fi,"too many attributes"),we(ri.length>0,"must specify at least one attribute");var Zi={},vo=xi.attributes;vo.length=ri.length;for(var Bo=0;Bo<ri.length;++Bo){var Hi=ri[Bo],ba=vo[Bo]=new Ur,go=Hi.data||Hi;if(Array.isArray(go)||k(go)||ku(go)){var Wo;xi.buffers[Bo]&&(Wo=xi.buffers[Bo],k(go)&&Wo._buffer.byteLength>=go.byteLength?Wo.subdata(go):(Wo.destroy(),xi.buffers[Bo]=null)),xi.buffers[Bo]||(Wo=xi.buffers[Bo]=bi.create(Hi,Nr,!1,!0)),ba.buffer=bi.getBuffer(Wo),ba.size=ba.buffer.dimension|0,ba.normalized=!1,ba.type=ba.buffer.dtype,ba.offset=0,ba.stride=0,ba.divisor=0,ba.state=1,Zi[Bo]=1}else bi.getBuffer(Hi)?(ba.buffer=bi.getBuffer(Hi),ba.size=ba.buffer.dimension|0,ba.normalized=!1,ba.type=ba.buffer.dtype,ba.offset=0,ba.stride=0,ba.divisor=0,ba.state=1):bi.getBuffer(Hi.buffer)?(ba.buffer=bi.getBuffer(Hi.buffer),ba.size=(+Hi.size||ba.buffer.dimension)|0,ba.normalized=!!Hi.normalized||!1,"type"in Hi?(we.parameter(Hi.type,Sr,"invalid buffer type"),ba.type=Sr[Hi.type]):ba.type=ba.buffer.dtype,ba.offset=(Hi.offset||0)|0,ba.stride=(Hi.stride||0)|0,ba.divisor=(Hi.divisor||0)|0,ba.state=1,we(ba.size>=1&&ba.size<=4,"size must be between 1 and 4"),we(ba.offset>=0,"invalid offset"),we(ba.stride>=0&&ba.stride<=255,"stride must be between 0 and 255"),we(ba.divisor>=0,"divisor must be positive"),we(!ba.divisor||!!Ut.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Hi?(we(Bo>0,"first attribute must not be a constant"),ba.x=+Hi.x||0,ba.y=+Hi.y||0,ba.z=+Hi.z||0,ba.w=+Hi.w||0,ba.state=2):we(!1,"invalid attribute spec for location "+Bo)}for(var Ps=0;Ps<xi.buffers.length;++Ps)!Zi[Ps]&&xi.buffers[Ps]&&(xi.buffers[Ps].destroy(),xi.buffers[Ps]=null);return xi.refresh(),Qa}return Qa.destroy=function(){for(var Aa=0;Aa<xi.buffers.length;++Aa)xi.buffers[Aa]&&xi.buffers[Aa].destroy();xi.buffers.length=0,xi.ownsElements&&(xi.elements.destroy(),xi.elements=null,xi.ownsElements=!1),xi.destroy()},Qa._vao=xi,Qa._reglType="vao",Qa(mi)}return sa}var ti=35632,Yn=35633,ai=35718,Pi=35721;function va(ke,Ut,Ar,On){var bi={},zn={};function hi(yn,Qn,Yi,wa){this.name=yn,this.id=Qn,this.location=Yi,this.info=wa}function Fi(yn,Qn){for(var Yi=0;Yi<yn.length;++Yi)if(yn[Yi].id===Qn.id){yn[Yi].location=Qn.location;return}yn.push(Qn)}function Gi(yn,Qn,Yi){var wa=yn===ti?bi:zn,yi=wa[Qn];if(!yi){var Ri=Ut.str(Qn);yi=ke.createShader(yn),ke.shaderSource(yi,Ri),ke.compileShader(yi),we.shaderError(ke,yi,Ri,yn,Yi),wa[Qn]=yi}return yi}var Ki={},ia=[],oa=0;function sa(yn,Qn){this.id=oa++,this.fragId=yn,this.vertId=Qn,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,On.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Bi(yn,Qn,Yi){var wa,yi,Ri=Gi(ti,yn.fragId),ta=Gi(Yn,yn.vertId),wo=yn.program=ke.createProgram();if(ke.attachShader(wo,Ri),ke.attachShader(wo,ta),Yi)for(wa=0;wa<Yi.length;++wa){var mi=Yi[wa];ke.bindAttribLocation(wo,mi[0],mi[1])}ke.linkProgram(wo),we.linkError(ke,wo,Ut.str(yn.fragId),Ut.str(yn.vertId),Qn);var xi=ke.getProgramParameter(wo,ai);On.profile&&(yn.stats.uniformsCount=xi);var Qa=yn.uniforms;for(wa=0;wa<xi;++wa)if(yi=ke.getActiveUniform(wo,wa),yi)if(yi.size>1)for(var Aa=0;Aa<yi.size;++Aa){var ri=yi.name.replace("[0]","["+Aa+"]");Fi(Qa,new hi(ri,Ut.id(ri),ke.getUniformLocation(wo,ri),yi))}else Fi(Qa,new hi(yi.name,Ut.id(yi.name),ke.getUniformLocation(wo,yi.name),yi));var _a=ke.getProgramParameter(wo,Pi);On.profile&&(yn.stats.attributesCount=_a);var Zi=yn.attributes;for(wa=0;wa<_a;++wa)yi=ke.getActiveAttrib(wo,wa),yi&&Fi(Zi,new hi(yi.name,Ut.id(yi.name),ke.getAttribLocation(wo,yi.name),yi))}On.profile&&(Ar.getMaxUniformsCount=function(){var yn=0;return ia.forEach(function(Qn){Qn.stats.uniformsCount>yn&&(yn=Qn.stats.uniformsCount)}),yn},Ar.getMaxAttributesCount=function(){var yn=0;return ia.forEach(function(Qn){Qn.stats.attributesCount>yn&&(yn=Qn.stats.attributesCount)}),yn});function Ji(){bi={},zn={};for(var yn=0;yn<ia.length;++yn)Bi(ia[yn],null,ia[yn].attributes.map(function(Qn){return[Qn.location,Qn.name]}))}return{clear:function(){var yn=ke.deleteShader.bind(ke);mt(bi).forEach(yn),bi={},mt(zn).forEach(yn),zn={},ia.forEach(function(Qn){ke.deleteProgram(Qn.program)}),ia.length=0,Ki={},Ar.shaderCount=0},program:function(yn,Qn,Yi,wa){we.command(yn>=0,"missing vertex shader",Yi),we.command(Qn>=0,"missing fragment shader",Yi);var yi=Ki[Qn];yi||(yi=Ki[Qn]={});var Ri=yi[yn];if(Ri&&(Ri.refCount++,!wa))return Ri;var ta=new sa(Qn,yn);return Ar.shaderCount++,Bi(ta,Yi,wa),Ri||(yi[yn]=ta),ia.push(ta),m(ta,{destroy:function(){if(ta.refCount--,ta.refCount<=0){ke.deleteProgram(ta.program);var wo=ia.indexOf(ta);ia.splice(wo,1),Ar.shaderCount--}yi[ta.vertId].refCount<=0&&(ke.deleteShader(zn[ta.vertId]),delete zn[ta.vertId],delete Ki[ta.fragId][ta.vertId]),Object.keys(Ki[ta.fragId]).length||(ke.deleteShader(bi[ta.fragId]),delete bi[ta.fragId],delete Ki[ta.fragId])}})},restore:Ji,shader:Gi,frag:-1,vert:-1}}var na=6408,Ua=5121,co=3333,Eo=5126;function ho(ke,Ut,Ar,On,bi,zn,hi){function Fi(ia){var oa;Ut.next===null?(we(bi.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),oa=Ua):(we(Ut.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),oa=Ut.next.colorAttachments[0].texture._texture.type,we.optional(function(){zn.oes_texture_float?(we(oa===Ua||oa===Eo,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),oa===Eo&&we(hi.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):we(oa===Ua,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var sa=0,Bi=0,Ji=On.framebufferWidth,yn=On.framebufferHeight,Qn=null;k(ia)?Qn=ia:ia&&(we.type(ia,"object","invalid arguments to regl.read()"),sa=ia.x|0,Bi=ia.y|0,we(sa>=0&&sa<On.framebufferWidth,"invalid x offset for regl.read"),we(Bi>=0&&Bi<On.framebufferHeight,"invalid y offset for regl.read"),Ji=(ia.width||On.framebufferWidth-sa)|0,yn=(ia.height||On.framebufferHeight-Bi)|0,Qn=ia.data||null),Qn&&(oa===Ua?we(Qn instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):oa===Eo&&we(Qn instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),we(Ji>0&&Ji+sa<=On.framebufferWidth,"invalid width for read pixels"),we(yn>0&&yn+Bi<=On.framebufferHeight,"invalid height for read pixels"),Ar();var Yi=Ji*yn*4;return Qn||(oa===Ua?Qn=new Uint8Array(Yi):oa===Eo&&(Qn=Qn||new Float32Array(Yi))),we.isTypedArray(Qn,"data buffer for regl.read() must be a typedarray"),we(Qn.byteLength>=Yi,"data buffer for regl.read() too small"),ke.pixelStorei(co,4),ke.readPixels(sa,Bi,Ji,yn,na,oa,Qn),Qn}function Gi(ia){var oa;return Ut.setFBO({framebuffer:ia.framebuffer},function(){oa=Fi(ia)}),oa}function Ki(ia){return!ia||!("framebuffer"in ia)?Fi(ia):Gi(ia)}return Ki}function qo(ke){return Array.prototype.slice.call(ke)}function ga(ke){return qo(ke).join("")}function Zo(){var ke=0,Ut=[],Ar=[];function On(oa){for(var sa=0;sa<Ar.length;++sa)if(Ar[sa]===oa)return Ut[sa];var Bi="g"+ke++;return Ut.push(Bi),Ar.push(oa),Bi}function bi(){var oa=[];function sa(){oa.push.apply(oa,qo(arguments))}var Bi=[];function Ji(){var yn="v"+ke++;return Bi.push(yn),arguments.length>0&&(oa.push(yn,"="),oa.push.apply(oa,qo(arguments)),oa.push(";")),yn}return m(sa,{def:Ji,toString:function(){return ga([Bi.length>0?"var "+Bi.join(",")+";":"",ga(oa)])}})}function zn(){var oa=bi(),sa=bi(),Bi=oa.toString,Ji=sa.toString;function yn(Qn,Yi){sa(Qn,Yi,"=",oa.def(Qn,Yi),";")}return m(function(){oa.apply(oa,qo(arguments))},{def:oa.def,entry:oa,exit:sa,save:yn,set:function(Qn,Yi,wa){yn(Qn,Yi),oa(Qn,Yi,"=",wa,";")},toString:function(){return Bi()+Ji()}})}function hi(){var oa=ga(arguments),sa=zn(),Bi=zn(),Ji=sa.toString,yn=Bi.toString;return m(sa,{then:function(){return sa.apply(sa,qo(arguments)),this},else:function(){return Bi.apply(Bi,qo(arguments)),this},toString:function(){var Qn=yn();return Qn&&(Qn="else{"+Qn+"}"),ga(["if(",oa,"){",Ji(),"}",Qn])}})}var Fi=bi(),Gi={};function Ki(oa,sa){var Bi=[];function Ji(){var yi="a"+Bi.length;return Bi.push(yi),yi}sa=sa||0;for(var yn=0;yn<sa;++yn)Ji();var Qn=zn(),Yi=Qn.toString,wa=Gi[oa]=m(Qn,{arg:Ji,toString:function(){return ga(["function(",Bi.join(),"){",Yi(),"}"])}});return wa}function ia(){var oa=['"use strict";',Fi,"return {"];Object.keys(Gi).forEach(function(yn){oa.push('"',yn,'":',Gi[yn].toString(),",")}),oa.push("}");var sa=ga(oa).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Bi=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Ji=Bi?D.Function.apply(null,Ut.concat(sa)):Function.apply(null,Ut.concat(sa));return Ji.apply(null,Ar)}return{global:Fi,link:On,block:bi,proc:Ki,scope:zn,cond:hi,compile:ia}}var Uo="xyzw".split(""),Do=5121,po=1,us=2,ko=0,Io=1,El=2,Ou=3,nu=4,rc=5,Du=6,gu="dither",gc="blend.enable",Vl="blend.color",ml="blend.equation",Mc="blend.func",hl="depth.enable",yc="depth.func",lp="depth.range",Dh="depth.mask",jf="colorMask",bh="cull.enable",Qf="cull.face",sf="frontFace",ch="lineWidth",Pc="polygonOffset.enable",Hl="polygonOffset.offset",zc="sample.alpha",fh="sample.enable",Eh="sample.coverage",iu="stencil.enable",Xs="stencil.mask",Yc="stencil.func",hh="stencil.opFront",Jf="stencil.opBack",Fh="scissor.enable",Xh="scissor.box",Of="viewport",eh="profile",If="framebuffer",Vf="vert",Yh="frag",yf="elements",Gl="primitive",Bh="count",Kh="offset",yu="instances",$p="vao",Kc="Width",Mp="Height",Hf=If+Kc,$l=If+Mp,cd=Of+Kc,Wp=Of+Mp,Es="drawingBuffer",Xp=Es+Kc,Nd=Es+Mp,fd=[Mc,ml,Yc,hh,Jf,Eh,Of,Xh,Hl],cp=34962,Pp=34963,hd=35632,wh=35633,pd=3553,ll=34067,zd=2884,yp=3042,Sd=3024,hu=2960,Lf=2929,Sh=3089,_p=32823,Ch=32926,Op=32928,Ah=5126,fp=35664,Nh=35665,zh=35666,qc=5124,Cd=35667,Rf=35668,Yp=35669,Kp=35670,ph=35671,th=35672,Ip=35673,Oc=35674,qh=35675,Th=35676,Zh=35678,dd=35680,Ad=4,nc=1028,kf=1029,Td=2304,vd=2305,hp=32775,Lp=32776,qp=519,Gf=7680,qd=0,Rp=1,Uh=32774,_f=513,Md=36160,Qp=36064,Mh={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},dh=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Ph={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},_u={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},md={frag:hd,vert:wh},_c={cw:Td,ccw:vd};function kp(ke){return Array.isArray(ke)||k(ke)||ku(ke)}function xp(ke){return ke.sort(function(Ut,Ar){return Ut===Of?-1:Ar===Of?1:Ut<Ar?-1:1})}function Ks(ke,Ut,Ar,On){this.thisDep=ke,this.contextDep=Ut,this.propDep=Ar,this.append=On}function Qh(ke){return ke&&!(ke.thisDep||ke.contextDep||ke.propDep)}function Bl(ke){return new Ks(!1,!1,!1,ke)}function Df(ke,Ut){var Ar=ke.type;if(Ar===ko){var On=ke.data.length;return new Ks(!0,On>=1,On>=2,Ut)}else if(Ar===nu){var bi=ke.data;return new Ks(bi.thisDep,bi.contextDep,bi.propDep,Ut)}else{if(Ar===rc)return new Ks(!1,!1,!1,Ut);if(Ar===Du){for(var zn=!1,hi=!1,Fi=!1,Gi=0;Gi<ke.data.length;++Gi){var Ki=ke.data[Gi];if(Ki.type===Io)Fi=!0;else if(Ki.type===El)hi=!0;else if(Ki.type===Ou)zn=!0;else if(Ki.type===ko){zn=!0;var ia=Ki.data;ia>=1&&(hi=!0),ia>=2&&(Fi=!0)}else Ki.type===nu&&(zn=zn||Ki.data.thisDep,hi=hi||Ki.data.contextDep,Fi=Fi||Ki.data.propDep)}return new Ks(zn,hi,Fi,Ut)}else return new Ks(Ar===Ou,Ar===El,Ar===Io,Ut)}}var Jp=new Ks(!1,!1,!1,function(){});function jh(ke,Ut,Ar,On,bi,zn,hi,Fi,Gi,Ki,ia,oa,sa,Bi,Ji){var yn=Ki.Record,Qn={add:32774,subtract:32778,"reverse subtract":32779};Ar.ext_blend_minmax&&(Qn.min=hp,Qn.max=Lp);var Yi=Ar.angle_instanced_arrays,wa=Ar.webgl_draw_buffers,yi=Ar.oes_vertex_array_object,Ri={dirty:!0,profile:Ji.profile},ta={},wo=[],mi={},xi={};function Qa(ir){return ir.replace(".","_")}function Aa(ir,Rt,Zr){var cn=Qa(ir);wo.push(ir),ta[cn]=Ri[cn]=!!Zr,mi[cn]=Rt}function ri(ir,Rt,Zr){var cn=Qa(ir);wo.push(ir),Array.isArray(Zr)?(Ri[cn]=Zr.slice(),ta[cn]=Zr.slice()):Ri[cn]=ta[cn]=Zr,xi[cn]=Rt}Aa(gu,Sd),Aa(gc,yp),ri(Vl,"blendColor",[0,0,0,0]),ri(ml,"blendEquationSeparate",[Uh,Uh]),ri(Mc,"blendFuncSeparate",[Rp,qd,Rp,qd]),Aa(hl,Lf,!0),ri(yc,"depthFunc",_f),ri(lp,"depthRange",[0,1]),ri(Dh,"depthMask",!0),ri(jf,jf,[!0,!0,!0,!0]),Aa(bh,zd),ri(Qf,"cullFace",kf),ri(sf,sf,vd),ri(ch,ch,1),Aa(Pc,_p),ri(Hl,"polygonOffset",[0,0]),Aa(zc,Ch),Aa(fh,Op),ri(Eh,"sampleCoverage",[1,!1]),Aa(iu,hu),ri(Xs,"stencilMask",-1),ri(Yc,"stencilFunc",[qp,0,-1]),ri(hh,"stencilOpSeparate",[nc,Gf,Gf,Gf]),ri(Jf,"stencilOpSeparate",[kf,Gf,Gf,Gf]),Aa(Fh,Sh),ri(Xh,"scissor",[0,0,ke.drawingBufferWidth,ke.drawingBufferHeight]),ri(Of,Of,[0,0,ke.drawingBufferWidth,ke.drawingBufferHeight]);var _a={gl:ke,context:sa,strings:Ut,next:ta,current:Ri,draw:oa,elements:zn,buffer:bi,shader:ia,attributes:Ki.state,vao:Ki,uniforms:Gi,framebuffer:Fi,extensions:Ar,timer:Bi,isBufferArgs:kp},Zi={primTypes:dn,compareFuncs:Ph,blendFuncs:Mh,blendEquations:Qn,stencilOps:_u,glTypes:Sr,orientationType:_c};we.optional(function(){_a.isArrayLike=Go}),wa&&(Zi.backBuffer=[kf],Zi.drawBuffer=Le(On.maxDrawbuffers,function(ir){return ir===0?[0]:Le(ir,function(Rt){return Qp+Rt})}));var vo=0;function Bo(){var ir=Zo(),Rt=ir.link,Zr=ir.global;ir.id=vo++,ir.batchId="0";var cn=Rt(_a),jn=ir.shared={props:"a0"};Object.keys(_a).forEach(function(Or){jn[Or]=Zr.def(cn,".",Or)}),we.optional(function(){ir.CHECK=Rt(we),ir.commandStr=we.guessCommand(),ir.command=Rt(ir.commandStr),ir.assert=function(Or,ar,xn){Or("if(!(",ar,"))",this.CHECK,".commandRaise(",Rt(xn),",",this.command,");")},Zi.invalidBlendCombinations=dh});var Wr=ir.next={},wr=ir.current={};Object.keys(xi).forEach(function(Or){Array.isArray(Ri[Or])&&(Wr[Or]=Zr.def(jn.next,".",Or),wr[Or]=Zr.def(jn.current,".",Or))});var nn=ir.constants={};Object.keys(Zi).forEach(function(Or){nn[Or]=Zr.def(JSON.stringify(Zi[Or]))}),ir.invoke=function(Or,ar){switch(ar.type){case ko:var xn=["this",jn.context,jn.props,ir.batchId];return Or.def(Rt(ar.data),".call(",xn.slice(0,Math.max(ar.data.length+1,4)),")");case Io:return Or.def(jn.props,ar.data);case El:return Or.def(jn.context,ar.data);case Ou:return Or.def("this",ar.data);case nu:return ar.data.append(ir,Or),ar.data.ref;case rc:return ar.data.toString();case Du:return ar.data.map(function(mn){return ir.invoke(Or,mn)})}},ir.attribCache={};var Wt={};return ir.scopeAttrib=function(Or){var ar=Ut.id(Or);if(ar in Wt)return Wt[ar];var xn=Ki.scope[ar];xn||(xn=Ki.scope[ar]=new yn);var mn=Wt[ar]=Rt(xn);return mn},ir}function Hi(ir){var Rt=ir.static,Zr=ir.dynamic,cn;if(eh in Rt){var jn=!!Rt[eh];cn=Bl(function(wr,nn){return jn}),cn.enable=jn}else if(eh in Zr){var Wr=Zr[eh];cn=Df(Wr,function(wr,nn){return wr.invoke(nn,Wr)})}return cn}function ba(ir,Rt){var Zr=ir.static,cn=ir.dynamic;if(If in Zr){var jn=Zr[If];return jn?(jn=Fi.getFramebuffer(jn),we.command(jn,"invalid framebuffer object"),Bl(function(wr,nn){var Wt=wr.link(jn),Or=wr.shared;nn.set(Or.framebuffer,".next",Wt);var ar=Or.context;return nn.set(ar,"."+Hf,Wt+".width"),nn.set(ar,"."+$l,Wt+".height"),Wt})):Bl(function(wr,nn){var Wt=wr.shared;nn.set(Wt.framebuffer,".next","null");var Or=Wt.context;return nn.set(Or,"."+Hf,Or+"."+Xp),nn.set(Or,"."+$l,Or+"."+Nd),"null"})}else if(If in cn){var Wr=cn[If];return Df(Wr,function(wr,nn){var Wt=wr.invoke(nn,Wr),Or=wr.shared,ar=Or.framebuffer,xn=nn.def(ar,".getFramebuffer(",Wt,")");we.optional(function(){wr.assert(nn,"!"+Wt+"||"+xn,"invalid framebuffer object")}),nn.set(ar,".next",xn);var mn=Or.context;return nn.set(mn,"."+Hf,xn+"?"+xn+".width:"+mn+"."+Xp),nn.set(mn,"."+$l,xn+"?"+xn+".height:"+mn+"."+Nd),xn})}else return null}function go(ir,Rt,Zr){var cn=ir.static,jn=ir.dynamic;function Wr(Wt){if(Wt in cn){var Or=cn[Wt];we.commandType(Or,"object","invalid "+Wt,Zr.commandStr);var ar=!0,xn=Or.x|0,mn=Or.y|0,wi,ya;return"width"in Or?(wi=Or.width|0,we.command(wi>=0,"invalid "+Wt,Zr.commandStr)):ar=!1,"height"in Or?(ya=Or.height|0,we.command(ya>=0,"invalid "+Wt,Zr.commandStr)):ar=!1,new Ks(!ar&&Rt&&Rt.thisDep,!ar&&Rt&&Rt.contextDep,!ar&&Rt&&Rt.propDep,function(aa,no){var Ya=aa.shared.context,io=wi;"width"in Or||(io=no.def(Ya,".",Hf,"-",xn));var E=ya;return"height"in Or||(E=no.def(Ya,".",$l,"-",mn)),[xn,mn,io,E]})}else if(Wt in jn){var xa=jn[Wt],Sa=Df(xa,function(aa,no){var Ya=aa.invoke(no,xa);we.optional(function(){aa.assert(no,Ya+"&&typeof "+Ya+'==="object"',"invalid "+Wt)});var io=aa.shared.context,E=no.def(Ya,".x|0"),A=no.def(Ya,".y|0"),L=no.def('"width" in ',Ya,"?",Ya,".width|0:","(",io,".",Hf,"-",E,")"),P=no.def('"height" in ',Ya,"?",Ya,".height|0:","(",io,".",$l,"-",A,")");return we.optional(function(){aa.assert(no,L+">=0&&"+P+">=0","invalid "+Wt)}),[E,A,L,P]});return Rt&&(Sa.thisDep=Sa.thisDep||Rt.thisDep,Sa.contextDep=Sa.contextDep||Rt.contextDep,Sa.propDep=Sa.propDep||Rt.propDep),Sa}else return Rt?new Ks(Rt.thisDep,Rt.contextDep,Rt.propDep,function(aa,no){var Ya=aa.shared.context;return[0,0,no.def(Ya,".",Hf),no.def(Ya,".",$l)]}):null}var wr=Wr(Of);if(wr){var nn=wr;wr=new Ks(wr.thisDep,wr.contextDep,wr.propDep,function(Wt,Or){var ar=nn.append(Wt,Or),xn=Wt.shared.context;return Or.set(xn,"."+cd,ar[2]),Or.set(xn,"."+Wp,ar[3]),ar})}return{viewport:wr,scissor_box:Wr(Xh)}}function Wo(ir,Rt){var Zr=ir.static,cn=typeof Zr[Yh]=="string"&&typeof Zr[Vf]=="string";if(cn){if(Object.keys(Rt.dynamic).length>0)return null;var jn=Rt.static,Wr=Object.keys(jn);if(Wr.length>0&&typeof jn[Wr[0]]=="number"){for(var wr=[],nn=0;nn<Wr.length;++nn)we(typeof jn[Wr[nn]]=="number","must specify all vertex attribute locations when using vaos"),wr.push([jn[Wr[nn]]|0,Wr[nn]]);return wr}}return null}function Ps(ir,Rt,Zr){var cn=ir.static,jn=ir.dynamic;function Wr(ar){if(ar in cn){var xn=Ut.id(cn[ar]);we.optional(function(){ia.shader(md[ar],xn,we.guessCommand())});var mn=Bl(function(){return xn});return mn.id=xn,mn}else if(ar in jn){var wi=jn[ar];return Df(wi,function(ya,xa){var Sa=ya.invoke(xa,wi),aa=xa.def(ya.shared.strings,".id(",Sa,")");return we.optional(function(){xa(ya.shared.shader,".shader(",md[ar],",",aa,",",ya.command,");")}),aa})}return null}var wr=Wr(Yh),nn=Wr(Vf),Wt=null,Or;return Qh(wr)&&Qh(nn)?(Wt=ia.program(nn.id,wr.id,null,Zr),Or=Bl(function(ar,xn){return ar.link(Wt)})):Or=new Ks(wr&&wr.thisDep||nn&&nn.thisDep,wr&&wr.contextDep||nn&&nn.contextDep,wr&&wr.propDep||nn&&nn.propDep,function(ar,xn){var mn=ar.shared.shader,wi;wr?wi=wr.append(ar,xn):wi=xn.def(mn,".",Yh);var ya;nn?ya=nn.append(ar,xn):ya=xn.def(mn,".",Vf);var xa=mn+".program("+ya+","+wi;return we.optional(function(){xa+=","+ar.command}),xn.def(xa+")")}),{frag:wr,vert:nn,progVar:Or,program:Wt}}function xu(ir,Rt){var Zr=ir.static,cn=ir.dynamic,jn={},Wr=!1;function wr(){if($p in Zr){var no=Zr[$p];return no!==null&&Ki.getVAO(no)===null&&(no=Ki.createVAO(no)),Wr=!0,jn.vao=no,Bl(function(io){var E=Ki.getVAO(no);return E?io.link(E):"null"})}else if($p in cn){Wr=!0;var Ya=cn[$p];return Df(Ya,function(io,E){var A=io.invoke(E,Ya);return E.def(io.shared.vao+".getVAO("+A+")")})}return null}var nn=wr(),Wt=!1;function Or(){if(yf in Zr){var no=Zr[yf];if(jn.elements=no,kp(no)){var Ya=jn.elements=zn.create(no,!0);no=zn.getElements(Ya),Wt=!0}else no&&(no=zn.getElements(no),Wt=!0,we.command(no,"invalid elements",Rt.commandStr));var io=Bl(function(A,L){if(no){var P=A.link(no);return A.ELEMENTS=P,P}return A.ELEMENTS=null,null});return io.value=no,io}else if(yf in cn){Wt=!0;var E=cn[yf];return Df(E,function(A,L){var P=A.shared,B=P.isBufferArgs,j=P.elements,te=A.invoke(L,E),de=L.def("null"),Oe=L.def(B,"(",te,")"),et=A.cond(Oe).then(de,"=",j,".createStream(",te,");").else(de,"=",j,".getElements(",te,");");return we.optional(function(){A.assert(et.else,"!"+te+"||"+de,"invalid elements")}),L.entry(et),L.exit(A.cond(Oe).then(j,".destroyStream(",de,");")),A.ELEMENTS=de,de})}else if(Wr)return new Ks(nn.thisDep,nn.contextDep,nn.propDep,function(A,L){return L.def(A.shared.vao+".currentVAO?"+A.shared.elements+".getElements("+A.shared.vao+".currentVAO.elements):null")});return null}var ar=Or();function xn(){if(Gl in Zr){var no=Zr[Gl];return jn.primitive=no,we.commandParameter(no,dn,"invalid primitve",Rt.commandStr),Bl(function(io,E){return dn[no]})}else if(Gl in cn){var Ya=cn[Gl];return Df(Ya,function(io,E){var A=io.constants.primTypes,L=io.invoke(E,Ya);return we.optional(function(){io.assert(E,L+" in "+A,"invalid primitive, must be one of "+Object.keys(dn))}),E.def(A,"[",L,"]")})}else{if(Wt)return Qh(ar)?ar.value?Bl(function(io,E){return E.def(io.ELEMENTS,".primType")}):Bl(function(){return Ad}):new Ks(ar.thisDep,ar.contextDep,ar.propDep,function(io,E){var A=io.ELEMENTS;return E.def(A,"?",A,".primType:",Ad)});if(Wr)return new Ks(nn.thisDep,nn.contextDep,nn.propDep,function(io,E){return E.def(io.shared.vao+".currentVAO?"+io.shared.vao+".currentVAO.primitive:"+Ad)})}return null}function mn(no,Ya){if(no in Zr){var io=Zr[no]|0;return Ya?jn.offset=io:jn.instances=io,we.command(!Ya||io>=0,"invalid "+no,Rt.commandStr),Bl(function(A,L){return Ya&&(A.OFFSET=io),io})}else if(no in cn){var E=cn[no];return Df(E,function(A,L){var P=A.invoke(L,E);return Ya&&(A.OFFSET=P,we.optional(function(){A.assert(L,P+">=0","invalid "+no)})),P})}else if(Ya){if(Wt)return Bl(function(A,L){return A.OFFSET=0,0});if(Wr)return new Ks(nn.thisDep,nn.contextDep,nn.propDep,function(A,L){return L.def(A.shared.vao+".currentVAO?"+A.shared.vao+".currentVAO.offset:0")})}else if(Wr)return new Ks(nn.thisDep,nn.contextDep,nn.propDep,function(A,L){return L.def(A.shared.vao+".currentVAO?"+A.shared.vao+".currentVAO.instances:-1")});return null}var wi=mn(Kh,!0);function ya(){if(Bh in Zr){var no=Zr[Bh]|0;return jn.count=no,we.command(typeof no=="number"&&no>=0,"invalid vertex count",Rt.commandStr),Bl(function(){return no})}else if(Bh in cn){var Ya=cn[Bh];return Df(Ya,function(L,P){var B=L.invoke(P,Ya);return we.optional(function(){L.assert(P,"typeof "+B+'==="number"&&'+B+">=0&&"+B+"===("+B+"|0)","invalid vertex count")}),B})}else if(Wt)if(Qh(ar)){if(ar)return wi?new Ks(wi.thisDep,wi.contextDep,wi.propDep,function(L,P){var B=P.def(L.ELEMENTS,".vertCount-",L.OFFSET);return we.optional(function(){L.assert(P,B+">=0","invalid vertex offset/element buffer too small")}),B}):Bl(function(L,P){return P.def(L.ELEMENTS,".vertCount")});var io=Bl(function(){return-1});return we.optional(function(){io.MISSING=!0}),io}else{var E=new Ks(ar.thisDep||wi.thisDep,ar.contextDep||wi.contextDep,ar.propDep||wi.propDep,function(L,P){var B=L.ELEMENTS;return L.OFFSET?P.def(B,"?",B,".vertCount-",L.OFFSET,":-1"):P.def(B,"?",B,".vertCount:-1")});return we.optional(function(){E.DYNAMIC=!0}),E}else if(Wr){var A=new Ks(nn.thisDep,nn.contextDep,nn.propDep,function(L,P){return P.def(L.shared.vao,".currentVAO?",L.shared.vao,".currentVAO.count:-1")});return A}return null}var xa=xn(),Sa=ya(),aa=mn(yu,!1);return{elements:ar,primitive:xa,count:Sa,instances:aa,offset:wi,vao:nn,vaoActive:Wr,elementsActive:Wt,static:jn}}function el(ir,Rt){var Zr=ir.static,cn=ir.dynamic,jn={};return wo.forEach(function(Wr){var wr=Qa(Wr);function nn(Wt,Or){if(Wr in Zr){var ar=Wt(Zr[Wr]);jn[wr]=Bl(function(){return ar})}else if(Wr in cn){var xn=cn[Wr];jn[wr]=Df(xn,function(mn,wi){return Or(mn,wi,mn.invoke(wi,xn))})}}switch(Wr){case bh:case gc:case gu:case iu:case hl:case Fh:case Pc:case zc:case fh:case Dh:return nn(function(Wt){return we.commandType(Wt,"boolean",Wr,Rt.commandStr),Wt},function(Wt,Or,ar){return we.optional(function(){Wt.assert(Or,"typeof "+ar+'==="boolean"',"invalid flag "+Wr,Wt.commandStr)}),ar});case yc:return nn(function(Wt){return we.commandParameter(Wt,Ph,"invalid "+Wr,Rt.commandStr),Ph[Wt]},function(Wt,Or,ar){var xn=Wt.constants.compareFuncs;return we.optional(function(){Wt.assert(Or,ar+" in "+xn,"invalid "+Wr+", must be one of "+Object.keys(Ph))}),Or.def(xn,"[",ar,"]")});case lp:return nn(function(Wt){return we.command(Go(Wt)&&Wt.length===2&&typeof Wt[0]=="number"&&typeof Wt[1]=="number"&&Wt[0]<=Wt[1],"depth range is 2d array",Rt.commandStr),Wt},function(Wt,Or,ar){we.optional(function(){Wt.assert(Or,Wt.shared.isArrayLike+"("+ar+")&&"+ar+".length===2&&typeof "+ar+'[0]==="number"&&typeof '+ar+'[1]==="number"&&'+ar+"[0]<="+ar+"[1]","depth range must be a 2d array")});var xn=Or.def("+",ar,"[0]"),mn=Or.def("+",ar,"[1]");return[xn,mn]});case Mc:return nn(function(Wt){we.commandType(Wt,"object","blend.func",Rt.commandStr);var Or="srcRGB"in Wt?Wt.srcRGB:Wt.src,ar="srcAlpha"in Wt?Wt.srcAlpha:Wt.src,xn="dstRGB"in Wt?Wt.dstRGB:Wt.dst,mn="dstAlpha"in Wt?Wt.dstAlpha:Wt.dst;return we.commandParameter(Or,Mh,wr+".srcRGB",Rt.commandStr),we.commandParameter(ar,Mh,wr+".srcAlpha",Rt.commandStr),we.commandParameter(xn,Mh,wr+".dstRGB",Rt.commandStr),we.commandParameter(mn,Mh,wr+".dstAlpha",Rt.commandStr),we.command(dh.indexOf(Or+", "+xn)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+Or+", "+xn+")",Rt.commandStr),[Mh[Or],Mh[xn],Mh[ar],Mh[mn]]},function(Wt,Or,ar){var xn=Wt.constants.blendFuncs;we.optional(function(){Wt.assert(Or,ar+"&&typeof "+ar+'==="object"',"invalid blend func, must be an object")});function mn(Ya,io){var E=Or.def('"',Ya,io,'" in ',ar,"?",ar,".",Ya,io,":",ar,".",Ya);return we.optional(function(){Wt.assert(Or,E+" in "+xn,"invalid "+Wr+"."+Ya+io+", must be one of "+Object.keys(Mh))}),E}var wi=mn("src","RGB"),ya=mn("dst","RGB");we.optional(function(){var Ya=Wt.constants.invalidBlendCombinations;Wt.assert(Or,Ya+".indexOf("+wi+'+", "+'+ya+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var xa=Or.def(xn,"[",wi,"]"),Sa=Or.def(xn,"[",mn("src","Alpha"),"]"),aa=Or.def(xn,"[",ya,"]"),no=Or.def(xn,"[",mn("dst","Alpha"),"]");return[xa,aa,Sa,no]});case ml:return nn(function(Wt){if(typeof Wt=="string")return we.commandParameter(Wt,Qn,"invalid "+Wr,Rt.commandStr),[Qn[Wt],Qn[Wt]];if(typeof Wt=="object")return we.commandParameter(Wt.rgb,Qn,Wr+".rgb",Rt.commandStr),we.commandParameter(Wt.alpha,Qn,Wr+".alpha",Rt.commandStr),[Qn[Wt.rgb],Qn[Wt.alpha]];we.commandRaise("invalid blend.equation",Rt.commandStr)},function(Wt,Or,ar){var xn=Wt.constants.blendEquations,mn=Or.def(),wi=Or.def(),ya=Wt.cond("typeof ",ar,'==="string"');return we.optional(function(){function xa(Sa,aa,no){Wt.assert(Sa,no+" in "+xn,"invalid "+aa+", must be one of "+Object.keys(Qn))}xa(ya.then,Wr,ar),Wt.assert(ya.else,ar+"&&typeof "+ar+'==="object"',"invalid "+Wr),xa(ya.else,Wr+".rgb",ar+".rgb"),xa(ya.else,Wr+".alpha",ar+".alpha")}),ya.then(mn,"=",wi,"=",xn,"[",ar,"];"),ya.else(mn,"=",xn,"[",ar,".rgb];",wi,"=",xn,"[",ar,".alpha];"),Or(ya),[mn,wi]});case Vl:return nn(function(Wt){return we.command(Go(Wt)&&Wt.length===4,"blend.color must be a 4d array",Rt.commandStr),Le(4,function(Or){return+Wt[Or]})},function(Wt,Or,ar){return we.optional(function(){Wt.assert(Or,Wt.shared.isArrayLike+"("+ar+")&&"+ar+".length===4","blend.color must be a 4d array")}),Le(4,function(xn){return Or.def("+",ar,"[",xn,"]")})});case Xs:return nn(function(Wt){return we.commandType(Wt,"number",wr,Rt.commandStr),Wt|0},function(Wt,Or,ar){return we.optional(function(){Wt.assert(Or,"typeof "+ar+'==="number"',"invalid stencil.mask")}),Or.def(ar,"|0")});case Yc:return nn(function(Wt){we.commandType(Wt,"object",wr,Rt.commandStr);var Or=Wt.cmp||"keep",ar=Wt.ref||0,xn="mask"in Wt?Wt.mask:-1;return we.commandParameter(Or,Ph,Wr+".cmp",Rt.commandStr),we.commandType(ar,"number",Wr+".ref",Rt.commandStr),we.commandType(xn,"number",Wr+".mask",Rt.commandStr),[Ph[Or],ar,xn]},function(Wt,Or,ar){var xn=Wt.constants.compareFuncs;we.optional(function(){function xa(){Wt.assert(Or,Array.prototype.join.call(arguments,""),"invalid stencil.func")}xa(ar+"&&typeof ",ar,'==="object"'),xa('!("cmp" in ',ar,")||(",ar,".cmp in ",xn,")")});var mn=Or.def('"cmp" in ',ar,"?",xn,"[",ar,".cmp]",":",Gf),wi=Or.def(ar,".ref|0"),ya=Or.def('"mask" in ',ar,"?",ar,".mask|0:-1");return[mn,wi,ya]});case hh:case Jf:return nn(function(Wt){we.commandType(Wt,"object",wr,Rt.commandStr);var Or=Wt.fail||"keep",ar=Wt.zfail||"keep",xn=Wt.zpass||"keep";return we.commandParameter(Or,_u,Wr+".fail",Rt.commandStr),we.commandParameter(ar,_u,Wr+".zfail",Rt.commandStr),we.commandParameter(xn,_u,Wr+".zpass",Rt.commandStr),[Wr===Jf?kf:nc,_u[Or],_u[ar],_u[xn]]},function(Wt,Or,ar){var xn=Wt.constants.stencilOps;we.optional(function(){Wt.assert(Or,ar+"&&typeof "+ar+'==="object"',"invalid "+Wr)});function mn(wi){return we.optional(function(){Wt.assert(Or,'!("'+wi+'" in '+ar+")||("+ar+"."+wi+" in "+xn+")","invalid "+Wr+"."+wi+", must be one of "+Object.keys(_u))}),Or.def('"',wi,'" in ',ar,"?",xn,"[",ar,".",wi,"]:",Gf)}return[Wr===Jf?kf:nc,mn("fail"),mn("zfail"),mn("zpass")]});case Hl:return nn(function(Wt){we.commandType(Wt,"object",wr,Rt.commandStr);var Or=Wt.factor|0,ar=Wt.units|0;return we.commandType(Or,"number",wr+".factor",Rt.commandStr),we.commandType(ar,"number",wr+".units",Rt.commandStr),[Or,ar]},function(Wt,Or,ar){we.optional(function(){Wt.assert(Or,ar+"&&typeof "+ar+'==="object"',"invalid "+Wr)});var xn=Or.def(ar,".factor|0"),mn=Or.def(ar,".units|0");return[xn,mn]});case Qf:return nn(function(Wt){var Or=0;return Wt==="front"?Or=nc:Wt==="back"&&(Or=kf),we.command(!!Or,wr,Rt.commandStr),Or},function(Wt,Or,ar){return we.optional(function(){Wt.assert(Or,ar+'==="front"||'+ar+'==="back"',"invalid cull.face")}),Or.def(ar,'==="front"?',nc,":",kf)});case ch:return nn(function(Wt){return we.command(typeof Wt=="number"&&Wt>=On.lineWidthDims[0]&&Wt<=On.lineWidthDims[1],"invalid line width, must be a positive number between "+On.lineWidthDims[0]+" and "+On.lineWidthDims[1],Rt.commandStr),Wt},function(Wt,Or,ar){return we.optional(function(){Wt.assert(Or,"typeof "+ar+'==="number"&&'+ar+">="+On.lineWidthDims[0]+"&&"+ar+"<="+On.lineWidthDims[1],"invalid line width")}),ar});case sf:return nn(function(Wt){return we.commandParameter(Wt,_c,wr,Rt.commandStr),_c[Wt]},function(Wt,Or,ar){return we.optional(function(){Wt.assert(Or,ar+'==="cw"||'+ar+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),Or.def(ar+'==="cw"?'+Td+":"+vd)});case jf:return nn(function(Wt){return we.command(Go(Wt)&&Wt.length===4,"color.mask must be length 4 array",Rt.commandStr),Wt.map(function(Or){return!!Or})},function(Wt,Or,ar){return we.optional(function(){Wt.assert(Or,Wt.shared.isArrayLike+"("+ar+")&&"+ar+".length===4","invalid color.mask")}),Le(4,function(xn){return"!!"+ar+"["+xn+"]"})});case Eh:return nn(function(Wt){we.command(typeof Wt=="object"&&Wt,wr,Rt.commandStr);var Or="value"in Wt?Wt.value:1,ar=!!Wt.invert;return we.command(typeof Or=="number"&&Or>=0&&Or<=1,"sample.coverage.value must be a number between 0 and 1",Rt.commandStr),[Or,ar]},function(Wt,Or,ar){we.optional(function(){Wt.assert(Or,ar+"&&typeof "+ar+'==="object"',"invalid sample.coverage")});var xn=Or.def('"value" in ',ar,"?+",ar,".value:1"),mn=Or.def("!!",ar,".invert");return[xn,mn]})}}),jn}function Fs(ir,Rt){var Zr=ir.static,cn=ir.dynamic,jn={};return Object.keys(Zr).forEach(function(Wr){var wr=Zr[Wr],nn;if(typeof wr=="number"||typeof wr=="boolean")nn=Bl(function(){return wr});else if(typeof wr=="function"){var Wt=wr._reglType;Wt==="texture2d"||Wt==="textureCube"?nn=Bl(function(Or){return Or.link(wr)}):Wt==="framebuffer"||Wt==="framebufferCube"?(we.command(wr.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Wr+'"',Rt.commandStr),nn=Bl(function(Or){return Or.link(wr.color[0])})):we.commandRaise('invalid data for uniform "'+Wr+'"',Rt.commandStr)}else Go(wr)?nn=Bl(function(Or){var ar=Or.global.def("[",Le(wr.length,function(xn){return we.command(typeof wr[xn]=="number"||typeof wr[xn]=="boolean","invalid uniform "+Wr,Or.commandStr),wr[xn]}),"]");return ar}):we.commandRaise('invalid or missing data for uniform "'+Wr+'"',Rt.commandStr);nn.value=wr,jn[Wr]=nn}),Object.keys(cn).forEach(function(Wr){var wr=cn[Wr];jn[Wr]=Df(wr,function(nn,Wt){return nn.invoke(Wt,wr)})}),jn}function pc(ir,Rt){var Zr=ir.static,cn=ir.dynamic,jn={};return Object.keys(Zr).forEach(function(Wr){var wr=Zr[Wr],nn=Ut.id(Wr),Wt=new yn;if(kp(wr))Wt.state=po,Wt.buffer=bi.getBuffer(bi.create(wr,cp,!1,!0)),Wt.type=0;else{var Or=bi.getBuffer(wr);if(Or)Wt.state=po,Wt.buffer=Or,Wt.type=0;else if(we.command(typeof wr=="object"&&wr,"invalid data for attribute "+Wr,Rt.commandStr),"constant"in wr){var ar=wr.constant;Wt.buffer="null",Wt.state=us,typeof ar=="number"?Wt.x=ar:(we.command(Go(ar)&&ar.length>0&&ar.length<=4,"invalid constant for attribute "+Wr,Rt.commandStr),Uo.forEach(function(aa,no){no<ar.length&&(Wt[aa]=ar[no])}))}else{kp(wr.buffer)?Or=bi.getBuffer(bi.create(wr.buffer,cp,!1,!0)):Or=bi.getBuffer(wr.buffer),we.command(!!Or,'missing buffer for attribute "'+Wr+'"',Rt.commandStr);var xn=wr.offset|0;we.command(xn>=0,'invalid offset for attribute "'+Wr+'"',Rt.commandStr);var mn=wr.stride|0;we.command(mn>=0&&mn<256,'invalid stride for attribute "'+Wr+'", must be integer betweeen [0, 255]',Rt.commandStr);var wi=wr.size|0;we.command(!("size"in wr)||wi>0&&wi<=4,'invalid size for attribute "'+Wr+'", must be 1,2,3,4',Rt.commandStr);var ya=!!wr.normalized,xa=0;"type"in wr&&(we.commandParameter(wr.type,Sr,"invalid type for attribute "+Wr,Rt.commandStr),xa=Sr[wr.type]);var Sa=wr.divisor|0;we.optional(function(){"divisor"in wr&&(we.command(Sa===0||Yi,'cannot specify divisor for attribute "'+Wr+'", instancing not supported',Rt.commandStr),we.command(Sa>=0,'invalid divisor for attribute "'+Wr+'"',Rt.commandStr));var aa=Rt.commandStr,no=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(wr).forEach(function(Ya){we.command(no.indexOf(Ya)>=0,'unknown parameter "'+Ya+'" for attribute pointer "'+Wr+'" (valid parameters are '+no+")",aa)})}),Wt.buffer=Or,Wt.state=po,Wt.size=wi,Wt.normalized=ya,Wt.type=xa||Or.dtype,Wt.offset=xn,Wt.stride=mn,Wt.divisor=Sa}}jn[Wr]=Bl(function(aa,no){var Ya=aa.attribCache;if(nn in Ya)return Ya[nn];var io={isStream:!1};return Object.keys(Wt).forEach(function(E){io[E]=Wt[E]}),Wt.buffer&&(io.buffer=aa.link(Wt.buffer),io.type=io.type||io.buffer+".dtype"),Ya[nn]=io,io})}),Object.keys(cn).forEach(function(Wr){var wr=cn[Wr];function nn(Wt,Or){var ar=Wt.invoke(Or,wr),xn=Wt.shared,mn=Wt.constants,wi=xn.isBufferArgs,ya=xn.buffer;we.optional(function(){Wt.assert(Or,ar+"&&(typeof "+ar+'==="object"||typeof '+ar+'==="function")&&('+wi+"("+ar+")||"+ya+".getBuffer("+ar+")||"+ya+".getBuffer("+ar+".buffer)||"+wi+"("+ar+'.buffer)||("constant" in '+ar+"&&(typeof "+ar+'.constant==="number"||'+xn.isArrayLike+"("+ar+".constant))))",'invalid dynamic attribute "'+Wr+'"')});var xa={isStream:Or.def(!1)},Sa=new yn;Sa.state=po,Object.keys(Sa).forEach(function(io){xa[io]=Or.def(""+Sa[io])});var aa=xa.buffer,no=xa.type;Or("if(",wi,"(",ar,")){",xa.isStream,"=true;",aa,"=",ya,".createStream(",cp,",",ar,");",no,"=",aa,".dtype;","}else{",aa,"=",ya,".getBuffer(",ar,");","if(",aa,"){",no,"=",aa,".dtype;",'}else if("constant" in ',ar,"){",xa.state,"=",us,";","if(typeof "+ar+'.constant === "number"){',xa[Uo[0]],"=",ar,".constant;",Uo.slice(1).map(function(io){return xa[io]}).join("="),"=0;","}else{",Uo.map(function(io,E){return xa[io]+"="+ar+".constant.length>"+E+"?"+ar+".constant["+E+"]:0;"}).join(""),"}}else{","if(",wi,"(",ar,".buffer)){",aa,"=",ya,".createStream(",cp,",",ar,".buffer);","}else{",aa,"=",ya,".getBuffer(",ar,".buffer);","}",no,'="type" in ',ar,"?",mn.glTypes,"[",ar,".type]:",aa,".dtype;",xa.normalized,"=!!",ar,".normalized;");function Ya(io){Or(xa[io],"=",ar,".",io,"|0;")}return Ya("size"),Ya("offset"),Ya("stride"),Ya("divisor"),Or("}}"),Or.exit("if(",xa.isStream,"){",ya,".destroyStream(",aa,");","}"),xa}jn[Wr]=Df(wr,nn)}),jn}function pl(ir){var Rt=ir.static,Zr=ir.dynamic,cn={};return Object.keys(Rt).forEach(function(jn){var Wr=Rt[jn];cn[jn]=Bl(function(wr,nn){return typeof Wr=="number"||typeof Wr=="boolean"?""+Wr:wr.link(Wr)})}),Object.keys(Zr).forEach(function(jn){var Wr=Zr[jn];cn[jn]=Df(Wr,function(wr,nn){return wr.invoke(nn,Wr)})}),cn}function Ol(ir,Rt,Zr,cn,jn){var Wr=ir.static,wr=ir.dynamic;we.optional(function(){var Ya=[If,Vf,Yh,yf,Gl,Kh,Bh,yu,eh,$p].concat(wo);function io(E){Object.keys(E).forEach(function(A){we.command(Ya.indexOf(A)>=0,'unknown parameter "'+A+'"',jn.commandStr)})}io(Wr),io(wr)});var nn=Wo(ir,Rt),Wt=ba(ir,jn),Or=go(ir,Wt,jn),ar=xu(ir,jn),xn=el(ir,jn),mn=Ps(ir,jn,nn);function wi(Ya){var io=Or[Ya];io&&(xn[Ya]=io)}wi(Of),wi(Qa(Xh));var ya=Object.keys(xn).length>0,xa={framebuffer:Wt,draw:ar,shader:mn,state:xn,dirty:ya,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(xa.profile=Hi(ir,jn),xa.uniforms=Fs(Zr,jn),xa.drawVAO=xa.scopeVAO=ar.vao,!xa.drawVAO&&mn.program&&!nn&&Ar.angle_instanced_arrays&&ar.static.elements){var Sa=!0,aa=mn.program.attributes.map(function(Ya){var io=Rt.static[Ya];return Sa=Sa&&!!io,io});if(Sa&&aa.length>0){var no=Ki.getVAO(Ki.createVAO({attributes:aa,elements:ar.static.elements}));xa.drawVAO=new Ks(null,null,null,function(Ya,io){return Ya.link(no)}),xa.useVAO=!0}}return nn?xa.useVAO=!0:xa.attributes=pc(Rt,jn),xa.context=pl(cn,jn),xa}function Vu(ir,Rt,Zr){var cn=ir.shared,jn=cn.context,Wr=ir.scope();Object.keys(Zr).forEach(function(wr){Rt.save(jn,"."+wr);var nn=Zr[wr],Wt=nn.append(ir,Rt);Array.isArray(Wt)?Wr(jn,".",wr,"=[",Wt.join(),"];"):Wr(jn,".",wr,"=",Wt,";")}),Rt(Wr)}function Wl(ir,Rt,Zr,cn){var jn=ir.shared,Wr=jn.gl,wr=jn.framebuffer,nn;wa&&(nn=Rt.def(jn.extensions,".webgl_draw_buffers"));var Wt=ir.constants,Or=Wt.drawBuffer,ar=Wt.backBuffer,xn;Zr?xn=Zr.append(ir,Rt):xn=Rt.def(wr,".next"),cn||Rt("if(",xn,"!==",wr,".cur){"),Rt("if(",xn,"){",Wr,".bindFramebuffer(",Md,",",xn,".framebuffer);"),wa&&Rt(nn,".drawBuffersWEBGL(",Or,"[",xn,".colorAttachments.length]);"),Rt("}else{",Wr,".bindFramebuffer(",Md,",null);"),wa&&Rt(nn,".drawBuffersWEBGL(",ar,");"),Rt("}",wr,".cur=",xn,";"),cn||Rt("}")}function dc(ir,Rt,Zr){var cn=ir.shared,jn=cn.gl,Wr=ir.current,wr=ir.next,nn=cn.current,Wt=cn.next,Or=ir.cond(nn,".dirty");wo.forEach(function(ar){var xn=Qa(ar);if(!(xn in Zr.state)){var mn,wi;if(xn in wr){mn=wr[xn],wi=Wr[xn];var ya=Le(Ri[xn].length,function(Sa){return Or.def(mn,"[",Sa,"]")});Or(ir.cond(ya.map(function(Sa,aa){return Sa+"!=="+wi+"["+aa+"]"}).join("||")).then(jn,".",xi[xn],"(",ya,");",ya.map(function(Sa,aa){return wi+"["+aa+"]="+Sa}).join(";"),";"))}else{mn=Or.def(Wt,".",xn);var xa=ir.cond(mn,"!==",nn,".",xn);Or(xa),xn in mi?xa(ir.cond(mn).then(jn,".enable(",mi[xn],");").else(jn,".disable(",mi[xn],");"),nn,".",xn,"=",mn,";"):xa(jn,".",xi[xn],"(",mn,");",nn,".",xn,"=",mn,";")}}}),Object.keys(Zr.state).length===0&&Or(nn,".dirty=false;"),Rt(Or)}function Qc(ir,Rt,Zr,cn){var jn=ir.shared,Wr=ir.current,wr=jn.current,nn=jn.gl;xp(Object.keys(Zr)).forEach(function(Wt){var Or=Zr[Wt];if(!(cn&&!cn(Or))){var ar=Or.append(ir,Rt);if(mi[Wt]){var xn=mi[Wt];Qh(Or)?ar?Rt(nn,".enable(",xn,");"):Rt(nn,".disable(",xn,");"):Rt(ir.cond(ar).then(nn,".enable(",xn,");").else(nn,".disable(",xn,");")),Rt(wr,".",Wt,"=",ar,";")}else if(Go(ar)){var mn=Wr[Wt];Rt(nn,".",xi[Wt],"(",ar,");",ar.map(function(wi,ya){return mn+"["+ya+"]="+wi}).join(";"),";")}else Rt(nn,".",xi[Wt],"(",ar,");",wr,".",Wt,"=",ar,";")}})}function Il(ir,Rt){Yi&&(ir.instancing=Rt.def(ir.shared.extensions,".angle_instanced_arrays"))}function ys(ir,Rt,Zr,cn,jn){var Wr=ir.shared,wr=ir.stats,nn=Wr.current,Wt=Wr.timer,Or=Zr.profile;function ar(){var Ya=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return Ya||typeof performance=="undefined"?"Date.now()":"performance.now()"}var xn,mn;function wi(Ya){xn=Rt.def(),Ya(xn,"=",ar(),";"),typeof jn=="string"?Ya(wr,".count+=",jn,";"):Ya(wr,".count++;"),Bi&&(cn?(mn=Rt.def(),Ya(mn,"=",Wt,".getNumPendingQueries();")):Ya(Wt,".beginQuery(",wr,");"))}function ya(Ya){Ya(wr,".cpuTime+=",ar(),"-",xn,";"),Bi&&(cn?Ya(Wt,".pushScopeStats(",mn,",",Wt,".getNumPendingQueries(),",wr,");"):Ya(Wt,".endQuery();"))}function xa(Ya){var io=Rt.def(nn,".profile");Rt(nn,".profile=",Ya,";"),Rt.exit(nn,".profile=",io,";")}var Sa;if(Or){if(Qh(Or)){Or.enable?(wi(Rt),ya(Rt.exit),xa("true")):xa("false");return}Sa=Or.append(ir,Rt),xa(Sa)}else Sa=Rt.def(nn,".profile");var aa=ir.block();wi(aa),Rt("if(",Sa,"){",aa,"}");var no=ir.block();ya(no),Rt.exit("if(",Sa,"){",no,"}")}function tl(ir,Rt,Zr,cn,jn){var Wr=ir.shared;function wr(Wt){switch(Wt){case fp:case Cd:case ph:return 2;case Nh:case Rf:case th:return 3;case zh:case Yp:case Ip:return 4;default:return 1}}function nn(Wt,Or,ar){var xn=Wr.gl,mn=Rt.def(Wt,".location"),wi=Rt.def(Wr.attributes,"[",mn,"]"),ya=ar.state,xa=ar.buffer,Sa=[ar.x,ar.y,ar.z,ar.w],aa=["buffer","normalized","offset","stride"];function no(){Rt("if(!",wi,".buffer){",xn,".enableVertexAttribArray(",mn,");}");var io=ar.type,E;if(ar.size?E=Rt.def(ar.size,"||",Or):E=Or,Rt("if(",wi,".type!==",io,"||",wi,".size!==",E,"||",aa.map(function(L){return wi+"."+L+"!=="+ar[L]}).join("||"),"){",xn,".bindBuffer(",cp,",",xa,".buffer);",xn,".vertexAttribPointer(",[mn,E,io,ar.normalized,ar.stride,ar.offset],");",wi,".type=",io,";",wi,".size=",E,";",aa.map(function(L){return wi+"."+L+"="+ar[L]+";"}).join(""),"}"),Yi){var A=ar.divisor;Rt("if(",wi,".divisor!==",A,"){",ir.instancing,".vertexAttribDivisorANGLE(",[mn,A],");",wi,".divisor=",A,";}")}}function Ya(){Rt("if(",wi,".buffer){",xn,".disableVertexAttribArray(",mn,");",wi,".buffer=null;","}if(",Uo.map(function(io,E){return wi+"."+io+"!=="+Sa[E]}).join("||"),"){",xn,".vertexAttrib4f(",mn,",",Sa,");",Uo.map(function(io,E){return wi+"."+io+"="+Sa[E]+";"}).join(""),"}")}ya===po?no():ya===us?Ya():(Rt("if(",ya,"===",po,"){"),no(),Rt("}else{"),Ya(),Rt("}"))}cn.forEach(function(Wt){var Or=Wt.name,ar=Zr.attributes[Or],xn;if(ar){if(!jn(ar))return;xn=ar.append(ir,Rt)}else{if(!jn(Jp))return;var mn=ir.scopeAttrib(Or);we.optional(function(){ir.assert(Rt,mn+".state","missing attribute "+Or)}),xn={},Object.keys(new yn).forEach(function(wi){xn[wi]=Rt.def(mn,".",wi)})}nn(ir.link(Wt),wr(Wt.info.type),xn)})}function Ts(ir,Rt,Zr,cn,jn,Wr){for(var wr=ir.shared,nn=wr.gl,Wt,Or=0;Or<cn.length;++Or){var ar=cn[Or],xn=ar.name,mn=ar.info.type,wi=Zr.uniforms[xn],ya=ir.link(ar),xa=ya+".location",Sa;if(wi){if(!jn(wi))continue;if(Qh(wi)){var aa=wi.value;if(we.command(aa!==null&&typeof aa!="undefined",'missing uniform "'+xn+'"',ir.commandStr),mn===Zh||mn===dd){we.command(typeof aa=="function"&&(mn===Zh&&(aa._reglType==="texture2d"||aa._reglType==="framebuffer")||mn===dd&&(aa._reglType==="textureCube"||aa._reglType==="framebufferCube")),"invalid texture for uniform "+xn,ir.commandStr);var no=ir.link(aa._texture||aa.color[0]._texture);Rt(nn,".uniform1i(",xa,",",no+".bind());"),Rt.exit(no,".unbind();")}else if(mn===Oc||mn===qh||mn===Th){we.optional(function(){we.command(Go(aa),"invalid matrix for uniform "+xn,ir.commandStr),we.command(mn===Oc&&aa.length===4||mn===qh&&aa.length===9||mn===Th&&aa.length===16,"invalid length for matrix uniform "+xn,ir.commandStr)});var Ya=ir.global.def("new Float32Array(["+Array.prototype.slice.call(aa)+"])"),io=2;mn===qh?io=3:mn===Th&&(io=4),Rt(nn,".uniformMatrix",io,"fv(",xa,",false,",Ya,");")}else{switch(mn){case Ah:we.commandType(aa,"number","uniform "+xn,ir.commandStr),Wt="1f";break;case fp:we.command(Go(aa)&&aa.length===2,"uniform "+xn,ir.commandStr),Wt="2f";break;case Nh:we.command(Go(aa)&&aa.length===3,"uniform "+xn,ir.commandStr),Wt="3f";break;case zh:we.command(Go(aa)&&aa.length===4,"uniform "+xn,ir.commandStr),Wt="4f";break;case Kp:we.commandType(aa,"boolean","uniform "+xn,ir.commandStr),Wt="1i";break;case qc:we.commandType(aa,"number","uniform "+xn,ir.commandStr),Wt="1i";break;case ph:we.command(Go(aa)&&aa.length===2,"uniform "+xn,ir.commandStr),Wt="2i";break;case Cd:we.command(Go(aa)&&aa.length===2,"uniform "+xn,ir.commandStr),Wt="2i";break;case th:we.command(Go(aa)&&aa.length===3,"uniform "+xn,ir.commandStr),Wt="3i";break;case Rf:we.command(Go(aa)&&aa.length===3,"uniform "+xn,ir.commandStr),Wt="3i";break;case Ip:we.command(Go(aa)&&aa.length===4,"uniform "+xn,ir.commandStr),Wt="4i";break;case Yp:we.command(Go(aa)&&aa.length===4,"uniform "+xn,ir.commandStr),Wt="4i";break}Rt(nn,".uniform",Wt,"(",xa,",",Go(aa)?Array.prototype.slice.call(aa):aa,");")}continue}else Sa=wi.append(ir,Rt)}else{if(!jn(Jp))continue;Sa=Rt.def(wr.uniforms,"[",Ut.id(xn),"]")}mn===Zh?(we(!Array.isArray(Sa),"must specify a scalar prop for textures"),Rt("if(",Sa,"&&",Sa,'._reglType==="framebuffer"){',Sa,"=",Sa,".color[0];","}")):mn===dd&&(we(!Array.isArray(Sa),"must specify a scalar prop for cube maps"),Rt("if(",Sa,"&&",Sa,'._reglType==="framebufferCube"){',Sa,"=",Sa,".color[0];","}")),we.optional(function(){function Oe(Qr,Xn){ir.assert(Rt,Qr,'bad data or missing for uniform "'+xn+'".  '+Xn)}function et(Qr){we(!Array.isArray(Sa),"must not specify an array type for uniform"),Oe("typeof "+Sa+'==="'+Qr+'"',"invalid type, expected "+Qr)}function Pt(Qr,Xn){Array.isArray(Sa)?we(Sa.length===Qr,"must have length "+Qr):Oe(wr.isArrayLike+"("+Sa+")&&"+Sa+".length==="+Qr,"invalid vector, should have length "+Qr,ir.commandStr)}function Mr(Qr){we(!Array.isArray(Sa),"must not specify a value type"),Oe("typeof "+Sa+'==="function"&&'+Sa+'._reglType==="texture'+(Qr===pd?"2d":"Cube")+'"',"invalid texture type",ir.commandStr)}switch(mn){case qc:et("number");break;case Cd:Pt(2,"number");break;case Rf:Pt(3,"number");break;case Yp:Pt(4,"number");break;case Ah:et("number");break;case fp:Pt(2,"number");break;case Nh:Pt(3,"number");break;case zh:Pt(4,"number");break;case Kp:et("boolean");break;case ph:Pt(2,"boolean");break;case th:Pt(3,"boolean");break;case Ip:Pt(4,"boolean");break;case Oc:Pt(4,"number");break;case qh:Pt(9,"number");break;case Th:Pt(16,"number");break;case Zh:Mr(pd);break;case dd:Mr(ll);break}});var E=1;switch(mn){case Zh:case dd:var A=Rt.def(Sa,"._texture");Rt(nn,".uniform1i(",xa,",",A,".bind());"),Rt.exit(A,".unbind();");continue;case qc:case Kp:Wt="1i";break;case Cd:case ph:Wt="2i",E=2;break;case Rf:case th:Wt="3i",E=3;break;case Yp:case Ip:Wt="4i",E=4;break;case Ah:Wt="1f";break;case fp:Wt="2f",E=2;break;case Nh:Wt="3f",E=3;break;case zh:Wt="4f",E=4;break;case Oc:Wt="Matrix2fv";break;case qh:Wt="Matrix3fv";break;case Th:Wt="Matrix4fv";break}if(Wt.charAt(0)==="M"){Rt(nn,".uniform",Wt,"(",xa,",");var L=Math.pow(mn-Oc+2,2),P=ir.global.def("new Float32Array(",L,")");Array.isArray(Sa)?Rt("false,(",Le(L,function(Oe){return P+"["+Oe+"]="+Sa[Oe]}),",",P,")"):Rt("false,(Array.isArray(",Sa,")||",Sa," instanceof Float32Array)?",Sa,":(",Le(L,function(Oe){return P+"["+Oe+"]="+Sa+"["+Oe+"]"}),",",P,")"),Rt(");")}else if(E>1){for(var B=[],j=[],te=0;te<E;++te)Array.isArray(Sa)?j.push(Sa[te]):j.push(Rt.def(Sa+"["+te+"]")),Wr&&B.push(Rt.def());Wr&&Rt("if(!",ir.batchId,"||",B.map(function(Oe,et){return Oe+"!=="+j[et]}).join("||"),"){",B.map(function(Oe,et){return Oe+"="+j[et]+";"}).join("")),Rt(nn,".uniform",Wt,"(",xa,",",j.join(","),");"),Wr&&Rt("}")}else{if(we(!Array.isArray(Sa),"uniform value must not be an array"),Wr){var de=Rt.def();Rt("if(!",ir.batchId,"||",de,"!==",Sa,"){",de,"=",Sa,";")}Rt(nn,".uniform",Wt,"(",xa,",",Sa,");"),Wr&&Rt("}")}}}function Jc(ir,Rt,Zr,cn){var jn=ir.shared,Wr=jn.gl,wr=jn.draw,nn=cn.draw;function Wt(){var E=nn.elements,A,L=Rt;return E?((E.contextDep&&cn.contextDynamic||E.propDep)&&(L=Zr),A=E.append(ir,L),nn.elementsActive&&L("if("+A+")"+Wr+".bindBuffer("+Pp+","+A+".buffer.buffer);")):(A=L.def(),L(A,"=",wr,".",yf,";","if(",A,"){",Wr,".bindBuffer(",Pp,",",A,".buffer.buffer);}","else if(",jn.vao,".currentVAO){",A,"=",ir.shared.elements+".getElements("+jn.vao,".currentVAO.elements);",yi?"":"if("+A+")"+Wr+".bindBuffer("+Pp+","+A+".buffer.buffer);","}")),A}function Or(){var E=nn.count,A,L=Rt;return E?((E.contextDep&&cn.contextDynamic||E.propDep)&&(L=Zr),A=E.append(ir,L),we.optional(function(){E.MISSING&&ir.assert(Rt,"false","missing vertex count"),E.DYNAMIC&&ir.assert(L,A+">=0","missing vertex count")})):(A=L.def(wr,".",Bh),we.optional(function(){ir.assert(L,A+">=0","missing vertex count")})),A}var ar=Wt();function xn(E){var A=nn[E];return A?A.contextDep&&cn.contextDynamic||A.propDep?A.append(ir,Zr):A.append(ir,Rt):Rt.def(wr,".",E)}var mn=xn(Gl),wi=xn(Kh),ya=Or();if(typeof ya=="number"){if(ya===0)return}else Zr("if(",ya,"){"),Zr.exit("}");var xa,Sa;Yi&&(xa=xn(yu),Sa=ir.instancing);var aa=ar+".type",no=nn.elements&&Qh(nn.elements)&&!nn.vaoActive;function Ya(){function E(){Zr(Sa,".drawElementsInstancedANGLE(",[mn,ya,aa,wi+"<<(("+aa+"-"+Do+")>>1)",xa],");")}function A(){Zr(Sa,".drawArraysInstancedANGLE(",[mn,wi,ya,xa],");")}ar&&ar!=="null"?no?E():(Zr("if(",ar,"){"),E(),Zr("}else{"),A(),Zr("}")):A()}function io(){function E(){Zr(Wr+".drawElements("+[mn,ya,aa,wi+"<<(("+aa+"-"+Do+")>>1)"]+");")}function A(){Zr(Wr+".drawArrays("+[mn,wi,ya]+");")}ar&&ar!=="null"?no?E():(Zr("if(",ar,"){"),E(),Zr("}else{"),A(),Zr("}")):A()}Yi&&(typeof xa!="number"||xa>=0)?typeof xa=="string"?(Zr("if(",xa,">0){"),Ya(),Zr("}else if(",xa,"<0){"),io(),Zr("}")):Ya():io()}function Vo(ir,Rt,Zr,cn,jn){var Wr=Bo(),wr=Wr.proc("body",jn);return we.optional(function(){Wr.commandStr=Rt.commandStr,Wr.command=Wr.link(Rt.commandStr)}),Yi&&(Wr.instancing=wr.def(Wr.shared.extensions,".angle_instanced_arrays")),ir(Wr,wr,Zr,cn),Wr.compile().body}function js(ir,Rt,Zr,cn){Il(ir,Rt),Zr.useVAO?Zr.drawVAO?Rt(ir.shared.vao,".setVAO(",Zr.drawVAO.append(ir,Rt),");"):Rt(ir.shared.vao,".setVAO(",ir.shared.vao,".targetVAO);"):(Rt(ir.shared.vao,".setVAO(null);"),tl(ir,Rt,Zr,cn.attributes,function(){return!0})),Ts(ir,Rt,Zr,cn.uniforms,function(){return!0},!1),Jc(ir,Rt,Rt,Zr)}function Iu(ir,Rt){var Zr=ir.proc("draw",1);Il(ir,Zr),Vu(ir,Zr,Rt.context),Wl(ir,Zr,Rt.framebuffer),dc(ir,Zr,Rt),Qc(ir,Zr,Rt.state),ys(ir,Zr,Rt,!1,!0);var cn=Rt.shader.progVar.append(ir,Zr);if(Zr(ir.shared.gl,".useProgram(",cn,".program);"),Rt.shader.program)js(ir,Zr,Rt,Rt.shader.program);else{Zr(ir.shared.vao,".setVAO(null);");var jn=ir.global.def("{}"),Wr=Zr.def(cn,".id"),wr=Zr.def(jn,"[",Wr,"]");Zr(ir.cond(wr).then(wr,".call(this,a0);").else(wr,"=",jn,"[",Wr,"]=",ir.link(function(nn){return Vo(js,ir,Rt,nn,1)}),"(",cn,");",wr,".call(this,a0);"))}Object.keys(Rt.state).length>0&&Zr(ir.shared.current,".dirty=true;"),ir.shared.vao&&Zr(ir.shared.vao,".setVAO(null);")}function ic(ir,Rt,Zr,cn){ir.batchId="a1",Il(ir,Rt);function jn(){return!0}tl(ir,Rt,Zr,cn.attributes,jn),Ts(ir,Rt,Zr,cn.uniforms,jn,!1),Jc(ir,Rt,Rt,Zr)}function Vh(ir,Rt,Zr,cn){Il(ir,Rt);var jn=Zr.contextDep,Wr=Rt.def(),wr="a0",nn="a1",Wt=Rt.def();ir.shared.props=Wt,ir.batchId=Wr;var Or=ir.scope(),ar=ir.scope();Rt(Or.entry,"for(",Wr,"=0;",Wr,"<",nn,";++",Wr,"){",Wt,"=",wr,"[",Wr,"];",ar,"}",Or.exit);function xn(aa){return aa.contextDep&&jn||aa.propDep}function mn(aa){return!xn(aa)}if(Zr.needsContext&&Vu(ir,ar,Zr.context),Zr.needsFramebuffer&&Wl(ir,ar,Zr.framebuffer),Qc(ir,ar,Zr.state,xn),Zr.profile&&xn(Zr.profile)&&ys(ir,ar,Zr,!1,!0),cn)Zr.useVAO?Zr.drawVAO?xn(Zr.drawVAO)?ar(ir.shared.vao,".setVAO(",Zr.drawVAO.append(ir,ar),");"):Or(ir.shared.vao,".setVAO(",Zr.drawVAO.append(ir,Or),");"):Or(ir.shared.vao,".setVAO(",ir.shared.vao,".targetVAO);"):(Or(ir.shared.vao,".setVAO(null);"),tl(ir,Or,Zr,cn.attributes,mn),tl(ir,ar,Zr,cn.attributes,xn)),Ts(ir,Or,Zr,cn.uniforms,mn,!1),Ts(ir,ar,Zr,cn.uniforms,xn,!0),Jc(ir,Or,ar,Zr);else{var wi=ir.global.def("{}"),ya=Zr.shader.progVar.append(ir,ar),xa=ar.def(ya,".id"),Sa=ar.def(wi,"[",xa,"]");ar(ir.shared.gl,".useProgram(",ya,".program);","if(!",Sa,"){",Sa,"=",wi,"[",xa,"]=",ir.link(function(aa){return Vo(ic,ir,Zr,aa,2)}),"(",ya,");}",Sa,".call(this,a0[",Wr,"],",Wr,");")}}function lr(ir,Rt){var Zr=ir.proc("batch",2);ir.batchId="0",Il(ir,Zr);var cn=!1,jn=!0;Object.keys(Rt.context).forEach(function(wi){cn=cn||Rt.context[wi].propDep}),cn||(Vu(ir,Zr,Rt.context),jn=!1);var Wr=Rt.framebuffer,wr=!1;Wr?(Wr.propDep?cn=wr=!0:Wr.contextDep&&cn&&(wr=!0),wr||Wl(ir,Zr,Wr)):Wl(ir,Zr,null),Rt.state.viewport&&Rt.state.viewport.propDep&&(cn=!0);function nn(wi){return wi.contextDep&&cn||wi.propDep}dc(ir,Zr,Rt),Qc(ir,Zr,Rt.state,function(wi){return!nn(wi)}),(!Rt.profile||!nn(Rt.profile))&&ys(ir,Zr,Rt,!1,"a1"),Rt.contextDep=cn,Rt.needsContext=jn,Rt.needsFramebuffer=wr;var Wt=Rt.shader.progVar;if(Wt.contextDep&&cn||Wt.propDep)Vh(ir,Zr,Rt,null);else{var Or=Wt.append(ir,Zr);if(Zr(ir.shared.gl,".useProgram(",Or,".program);"),Rt.shader.program)Vh(ir,Zr,Rt,Rt.shader.program);else{Zr(ir.shared.vao,".setVAO(null);");var ar=ir.global.def("{}"),xn=Zr.def(Or,".id"),mn=Zr.def(ar,"[",xn,"]");Zr(ir.cond(mn).then(mn,".call(this,a0,a1);").else(mn,"=",ar,"[",xn,"]=",ir.link(function(wi){return Vo(Vh,ir,Rt,wi,2)}),"(",Or,");",mn,".call(this,a0,a1);"))}}Object.keys(Rt.state).length>0&&Zr(ir.shared.current,".dirty=true;"),ir.shared.vao&&Zr(ir.shared.vao,".setVAO(null);")}function Wn(ir,Rt){var Zr=ir.proc("scope",3);ir.batchId="a2";var cn=ir.shared,jn=cn.current;Vu(ir,Zr,Rt.context),Rt.framebuffer&&Rt.framebuffer.append(ir,Zr),xp(Object.keys(Rt.state)).forEach(function(wr){var nn=Rt.state[wr],Wt=nn.append(ir,Zr);Go(Wt)?Wt.forEach(function(Or,ar){Zr.set(ir.next[wr],"["+ar+"]",Or)}):Zr.set(cn.next,"."+wr,Wt)}),ys(ir,Zr,Rt,!0,!0),[yf,Kh,Bh,yu,Gl].forEach(function(wr){var nn=Rt.draw[wr];nn&&Zr.set(cn.draw,"."+wr,""+nn.append(ir,Zr))}),Object.keys(Rt.uniforms).forEach(function(wr){var nn=Rt.uniforms[wr].append(ir,Zr);Array.isArray(nn)&&(nn="["+nn.join()+"]"),Zr.set(cn.uniforms,"["+Ut.id(wr)+"]",nn)}),Object.keys(Rt.attributes).forEach(function(wr){var nn=Rt.attributes[wr].append(ir,Zr),Wt=ir.scopeAttrib(wr);Object.keys(new yn).forEach(function(Or){Zr.set(Wt,"."+Or,nn[Or])})}),Rt.scopeVAO&&Zr.set(cn.vao,".targetVAO",Rt.scopeVAO.append(ir,Zr));function Wr(wr){var nn=Rt.shader[wr];nn&&Zr.set(cn.shader,"."+wr,nn.append(ir,Zr))}Wr(Vf),Wr(Yh),Object.keys(Rt.state).length>0&&(Zr(jn,".dirty=true;"),Zr.exit(jn,".dirty=true;")),Zr("a1(",ir.shared.context,",a0,",ir.batchId,");")}function Rn(ir){if(!(typeof ir!="object"||Go(ir))){for(var Rt=Object.keys(ir),Zr=0;Zr<Rt.length;++Zr)if(di.isDynamic(ir[Rt[Zr]]))return!0;return!1}}function ro(ir,Rt,Zr){var cn=Rt.static[Zr];if(!cn||!Rn(cn))return;var jn=ir.global,Wr=Object.keys(cn),wr=!1,nn=!1,Wt=!1,Or=ir.global.def("{}");Wr.forEach(function(xn){var mn=cn[xn];if(di.isDynamic(mn)){typeof mn=="function"&&(mn=cn[xn]=di.unbox(mn));var wi=Df(mn,null);wr=wr||wi.thisDep,Wt=Wt||wi.propDep,nn=nn||wi.contextDep}else{switch(jn(Or,".",xn,"="),typeof mn){case"number":jn(mn);break;case"string":jn('"',mn,'"');break;case"object":Array.isArray(mn)&&jn("[",mn.join(),"]");break;default:jn(ir.link(mn));break}jn(";")}});function ar(xn,mn){Wr.forEach(function(wi){var ya=cn[wi];if(di.isDynamic(ya)){var xa=xn.invoke(mn,ya);mn(Or,".",wi,"=",xa,";")}})}Rt.dynamic[Zr]=new di.DynamicVariable(nu,{thisDep:wr,contextDep:nn,propDep:Wt,ref:Or,append:ar}),delete Rt.static[Zr]}function qs(ir,Rt,Zr,cn,jn){var Wr=Bo();Wr.stats=Wr.link(jn),Object.keys(Rt.static).forEach(function(nn){ro(Wr,Rt,nn)}),fd.forEach(function(nn){ro(Wr,ir,nn)});var wr=Ol(ir,Rt,Zr,cn,Wr);return Iu(Wr,wr),Wn(Wr,wr),lr(Wr,wr),m(Wr.compile(),{destroy:function(){wr.shader.program.destroy()}})}return{next:ta,current:Ri,procs:function(){var ir=Bo(),Rt=ir.proc("poll"),Zr=ir.proc("refresh"),cn=ir.block();Rt(cn),Zr(cn);var jn=ir.shared,Wr=jn.gl,wr=jn.next,nn=jn.current;cn(nn,".dirty=false;"),Wl(ir,Rt),Wl(ir,Zr,null,!0);var Wt;Yi&&(Wt=ir.link(Yi)),Ar.oes_vertex_array_object&&Zr(ir.link(Ar.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Or=0;Or<On.maxAttributes;++Or){var ar=Zr.def(jn.attributes,"[",Or,"]"),xn=ir.cond(ar,".buffer");xn.then(Wr,".enableVertexAttribArray(",Or,");",Wr,".bindBuffer(",cp,",",ar,".buffer.buffer);",Wr,".vertexAttribPointer(",Or,",",ar,".size,",ar,".type,",ar,".normalized,",ar,".stride,",ar,".offset);").else(Wr,".disableVertexAttribArray(",Or,");",Wr,".vertexAttrib4f(",Or,",",ar,".x,",ar,".y,",ar,".z,",ar,".w);",ar,".buffer=null;"),Zr(xn),Yi&&Zr(Wt,".vertexAttribDivisorANGLE(",Or,",",ar,".divisor);")}return Zr(ir.shared.vao,".currentVAO=null;",ir.shared.vao,".setVAO(",ir.shared.vao,".targetVAO);"),Object.keys(mi).forEach(function(mn){var wi=mi[mn],ya=cn.def(wr,".",mn),xa=ir.block();xa("if(",ya,"){",Wr,".enable(",wi,")}else{",Wr,".disable(",wi,")}",nn,".",mn,"=",ya,";"),Zr(xa),Rt("if(",ya,"!==",nn,".",mn,"){",xa,"}")}),Object.keys(xi).forEach(function(mn){var wi=xi[mn],ya=Ri[mn],xa,Sa,aa=ir.block();if(aa(Wr,".",wi,"("),Go(ya)){var no=ya.length;xa=ir.global.def(wr,".",mn),Sa=ir.global.def(nn,".",mn),aa(Le(no,function(Ya){return xa+"["+Ya+"]"}),");",Le(no,function(Ya){return Sa+"["+Ya+"]="+xa+"["+Ya+"];"}).join("")),Rt("if(",Le(no,function(Ya){return xa+"["+Ya+"]!=="+Sa+"["+Ya+"]"}).join("||"),"){",aa,"}")}else xa=cn.def(wr,".",mn),Sa=cn.def(nn,".",mn),aa(xa,");",nn,".",mn,"=",xa,";"),Rt("if(",xa,"!==",Sa,"){",aa,"}");Zr(aa)}),ir.compile()}(),compile:qs}}function Jh(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Pd=34918,Qd=34919,ep=35007,gd=function(ke,Ut){if(!Ut.ext_disjoint_timer_query)return null;var Ar=[];function On(){return Ar.pop()||Ut.ext_disjoint_timer_query.createQueryEXT()}function bi(Yi){Ar.push(Yi)}var zn=[];function hi(Yi){var wa=On();Ut.ext_disjoint_timer_query.beginQueryEXT(ep,wa),zn.push(wa),Bi(zn.length-1,zn.length,Yi)}function Fi(){Ut.ext_disjoint_timer_query.endQueryEXT(ep)}function Gi(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Ki=[];function ia(){return Ki.pop()||new Gi}function oa(Yi){Ki.push(Yi)}var sa=[];function Bi(Yi,wa,yi){var Ri=ia();Ri.startQueryIndex=Yi,Ri.endQueryIndex=wa,Ri.sum=0,Ri.stats=yi,sa.push(Ri)}var Ji=[],yn=[];function Qn(){var Yi,wa,yi=zn.length;if(yi!==0){yn.length=Math.max(yn.length,yi+1),Ji.length=Math.max(Ji.length,yi+1),Ji[0]=0,yn[0]=0;var Ri=0;for(Yi=0,wa=0;wa<zn.length;++wa){var ta=zn[wa];Ut.ext_disjoint_timer_query.getQueryObjectEXT(ta,Qd)?(Ri+=Ut.ext_disjoint_timer_query.getQueryObjectEXT(ta,Pd),bi(ta)):zn[Yi++]=ta,Ji[wa+1]=Ri,yn[wa+1]=Yi}for(zn.length=Yi,Yi=0,wa=0;wa<sa.length;++wa){var wo=sa[wa],mi=wo.startQueryIndex,xi=wo.endQueryIndex;wo.sum+=Ji[xi]-Ji[mi];var Qa=yn[mi],Aa=yn[xi];Aa===Qa?(wo.stats.gpuTime+=wo.sum/1e6,oa(wo)):(wo.startQueryIndex=Qa,wo.endQueryIndex=Aa,sa[Yi++]=wo)}sa.length=Yi}}return{beginQuery:hi,endQuery:Fi,pushScopeStats:Bi,update:Qn,getNumPendingQueries:function(){return zn.length},clear:function(){Ar.push.apply(Ar,zn);for(var Yi=0;Yi<Ar.length;Yi++)Ut.ext_disjoint_timer_query.deleteQueryEXT(Ar[Yi]);zn.length=0,Ar.length=0},restore:function(){zn.length=0,Ar.length=0}}},Ov=16384,Ff=256,Dp=1024,pp=34962,Fp="webglcontextlost",Fu="webglcontextrestored",bp=1,jo=2,Oh=3;function Bp(ke,Ut){for(var Ar=0;Ar<ke.length;++Ar)if(ke[Ar]===Ut)return Ar;return-1}function Np(ke){var Ut=Et(ke);if(!Ut)return null;var Ar=Ut.gl,On=Ar.getContextAttributes(),bi=Ar.isContextLost(),zn=Bt(Ar,Ut);if(!zn)return null;var hi=Ba(),Fi=Jh(),Gi=zn.extensions,Ki=gd(Ar,Gi),ia=Wa(),oa=Ar.drawingBufferWidth,sa=Ar.drawingBufferHeight,Bi={tick:0,time:0,viewportWidth:oa,viewportHeight:sa,framebufferWidth:oa,framebufferHeight:sa,drawingBufferWidth:oa,drawingBufferHeight:sa,pixelRatio:Ut.pixelRatio},Ji={},yn={elements:null,primitive:4,count:-1,offset:0,instances:-1},Qn=is(Ar,Gi),Yi=_e(Ar,Fi,Ut,Ri),wa=Cs(Ar,Gi,Yi,Fi),yi=Tn(Ar,Gi,Qn,Fi,Yi,wa,yn);function Ri(Vo){return yi.destroyBuffer(Vo)}var ta=va(Ar,hi,Fi,Ut),wo=Ac(Ar,Gi,Qn,function(){Qa.procs.poll()},Bi,Fi,Ut),mi=Ja(Ar,Gi,Qn,Fi,Ut),xi=vr(Ar,Gi,Qn,wo,mi,Fi),Qa=jh(Ar,hi,Gi,Qn,Yi,wa,wo,xi,Ji,yi,ta,yn,Bi,Ki,Ut),Aa=ho(Ar,xi,Qa.procs.poll,Bi,On,Gi,Qn),ri=Qa.next,_a=Ar.canvas,Zi=[],vo=[],Bo=[],Hi=[Ut.onDestroy],ba=null;function go(){if(Zi.length===0){Ki&&Ki.update(),ba=null;return}ba=ca.next(go),Il();for(var Vo=Zi.length-1;Vo>=0;--Vo){var js=Zi[Vo];js&&js(Bi,null,0)}Ar.flush(),Ki&&Ki.update()}function Wo(){!ba&&Zi.length>0&&(ba=ca.next(go))}function Ps(){ba&&(ca.cancel(go),ba=null)}function xu(Vo){Vo.preventDefault(),bi=!0,Ps(),vo.forEach(function(js){js()})}function el(Vo){Ar.getError(),bi=!1,zn.restore(),ta.restore(),Yi.restore(),wo.restore(),mi.restore(),xi.restore(),yi.restore(),Ki&&Ki.restore(),Qa.procs.refresh(),Wo(),Bo.forEach(function(js){js()})}var Fs=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!Fs&&_a&&(_a.addEventListener(Fp,xu,!1),_a.addEventListener(Fu,el,!1));function pc(){Zi.length=0,Ps(),!Fs&&_a&&(_a.removeEventListener(Fp,xu),_a.removeEventListener(Fu,el)),ta.clear(),xi.clear(),mi.clear(),yi.clear(),wo.clear(),wa.clear(),Yi.clear(),Ki&&Ki.clear(),Hi.forEach(function(Vo){Vo()})}function pl(Vo){we(!!Vo,"invalid args to regl({...})"),we.type(Vo,"object","invalid args to regl({...})");function js(Wr){var wr=m({},Wr);delete wr.uniforms,delete wr.attributes,delete wr.context,delete wr.vao,"stencil"in wr&&wr.stencil.op&&(wr.stencil.opBack=wr.stencil.opFront=wr.stencil.op,delete wr.stencil.op);function nn(Wt){if(Wt in wr){var Or=wr[Wt];delete wr[Wt],Object.keys(Or).forEach(function(ar){wr[Wt+"."+ar]=Or[ar]})}}return nn("blend"),nn("depth"),nn("cull"),nn("stencil"),nn("polygonOffset"),nn("scissor"),nn("sample"),"vao"in Wr&&(wr.vao=Wr.vao),wr}function Iu(Wr,wr){var nn={},Wt={};return Object.keys(Wr).forEach(function(Or){var ar=Wr[Or];if(di.isDynamic(ar)){Wt[Or]=di.unbox(ar,Or);return}else if(wr&&Array.isArray(ar)){for(var xn=0;xn<ar.length;++xn)if(di.isDynamic(ar[xn])){Wt[Or]=di.unbox(ar,Or);return}}nn[Or]=ar}),{dynamic:Wt,static:nn}}var ic=Iu(Vo.context||{},!0),Vh=Iu(Vo.uniforms||{},!0),lr=Iu(Vo.attributes||{},!1),Wn=Iu(js(Vo),!1),Rn={gpuTime:0,cpuTime:0,count:0},ro=Qa.compile(Wn,lr,Vh,ic,Rn),qs=ro.draw,ir=ro.batch,Rt=ro.scope,Zr=[];function cn(Wr){for(;Zr.length<Wr;)Zr.push(null);return Zr}function jn(Wr,wr){var nn;if(bi&&we.raise("context lost"),typeof Wr=="function")return Rt.call(this,null,Wr,0);if(typeof wr=="function")if(typeof Wr=="number")for(nn=0;nn<Wr;++nn)Rt.call(this,null,wr,nn);else if(Array.isArray(Wr))for(nn=0;nn<Wr.length;++nn)Rt.call(this,Wr[nn],wr,nn);else return Rt.call(this,Wr,wr,0);else if(typeof Wr=="number"){if(Wr>0)return ir.call(this,cn(Wr|0),Wr|0)}else if(Array.isArray(Wr)){if(Wr.length)return ir.call(this,Wr,Wr.length)}else return qs.call(this,Wr)}return m(jn,{stats:Rn,destroy:function(){ro.destroy()}})}var Ol=xi.setFBO=pl({framebuffer:di.define.call(null,bp,"framebuffer")});function Vu(Vo,js){var Iu=0;Qa.procs.poll();var ic=js.color;ic&&(Ar.clearColor(+ic[0]||0,+ic[1]||0,+ic[2]||0,+ic[3]||0),Iu|=Ov),"depth"in js&&(Ar.clearDepth(+js.depth),Iu|=Ff),"stencil"in js&&(Ar.clearStencil(js.stencil|0),Iu|=Dp),we(!!Iu,"called regl.clear with no buffer specified"),Ar.clear(Iu)}function Wl(Vo){if(we(typeof Vo=="object"&&Vo,"regl.clear() takes an object as input"),"framebuffer"in Vo)if(Vo.framebuffer&&Vo.framebuffer_reglType==="framebufferCube")for(var js=0;js<6;++js)Ol(m({framebuffer:Vo.framebuffer.faces[js]},Vo),Vu);else Ol(Vo,Vu);else Vu(null,Vo)}function dc(Vo){we.type(Vo,"function","regl.frame() callback must be a function"),Zi.push(Vo);function js(){var Iu=Bp(Zi,Vo);we(Iu>=0,"cannot cancel a frame twice");function ic(){var Vh=Bp(Zi,ic);Zi[Vh]=Zi[Zi.length-1],Zi.length-=1,Zi.length<=0&&Ps()}Zi[Iu]=ic}return Wo(),{cancel:js}}function Qc(){var Vo=ri.viewport,js=ri.scissor_box;Vo[0]=Vo[1]=js[0]=js[1]=0,Bi.viewportWidth=Bi.framebufferWidth=Bi.drawingBufferWidth=Vo[2]=js[2]=Ar.drawingBufferWidth,Bi.viewportHeight=Bi.framebufferHeight=Bi.drawingBufferHeight=Vo[3]=js[3]=Ar.drawingBufferHeight}function Il(){Bi.tick+=1,Bi.time=tl(),Qc(),Qa.procs.poll()}function ys(){wo.refresh(),Qc(),Qa.procs.refresh(),Ki&&Ki.update()}function tl(){return(Wa()-ia)/1e3}ys();function Ts(Vo,js){we.type(js,"function","listener callback must be a function");var Iu;switch(Vo){case"frame":return dc(js);case"lost":Iu=vo;break;case"restore":Iu=Bo;break;case"destroy":Iu=Hi;break;default:we.raise("invalid event, must be one of frame,lost,restore,destroy")}return Iu.push(js),{cancel:function(){for(var ic=0;ic<Iu.length;++ic)if(Iu[ic]===js){Iu[ic]=Iu[Iu.length-1],Iu.pop();return}}}}var Jc=m(pl,{clear:Wl,prop:di.define.bind(null,bp),context:di.define.bind(null,jo),this:di.define.bind(null,Oh),draw:pl({}),buffer:function(Vo){return Yi.create(Vo,pp,!1,!1)},elements:function(Vo){return wa.create(Vo,!1)},texture:wo.create2D,cube:wo.createCube,renderbuffer:mi.create,framebuffer:xi.create,framebufferCube:xi.createCube,vao:yi.createVAO,attributes:On,frame:dc,on:Ts,limits:Qn,hasExtension:function(Vo){return Qn.extensions.indexOf(Vo.toLowerCase())>=0},read:Aa,destroy:pc,_gl:Ar,_refresh:ys,poll:function(){Il(),Ki&&Ki.update()},now:tl,stats:Fi});return Ut.onDone(null,Jc),Jc}return Np})},18552:function(Ne,fe,I){var D=I(10852),k=I(55639),m=D(k,"DataView");Ne.exports=m},1989:function(Ne,fe,I){var D=I(51789),k=I(80401),m=I(57667),ae=I(21327),F=I(81866);function K(W){var Y=-1,G=W==null?0:W.length;for(this.clear();++Y<G;){var $=W[Y];this.set($[0],$[1])}}K.prototype.clear=D,K.prototype.delete=k,K.prototype.get=m,K.prototype.has=ae,K.prototype.set=F,Ne.exports=K},38407:function(Ne,fe,I){var D=I(27040),k=I(14125),m=I(82117),ae=I(67518),F=I(13399);function K(W){var Y=-1,G=W==null?0:W.length;for(this.clear();++Y<G;){var $=W[Y];this.set($[0],$[1])}}K.prototype.clear=D,K.prototype.delete=k,K.prototype.get=m,K.prototype.has=ae,K.prototype.set=F,Ne.exports=K},57071:function(Ne,fe,I){var D=I(10852),k=I(55639),m=D(k,"Map");Ne.exports=m},83369:function(Ne,fe,I){var D=I(24785),k=I(11285),m=I(96e3),ae=I(49916),F=I(95265);function K(W){var Y=-1,G=W==null?0:W.length;for(this.clear();++Y<G;){var $=W[Y];this.set($[0],$[1])}}K.prototype.clear=D,K.prototype.delete=k,K.prototype.get=m,K.prototype.has=ae,K.prototype.set=F,Ne.exports=K},53818:function(Ne,fe,I){var D=I(10852),k=I(55639),m=D(k,"Promise");Ne.exports=m},58525:function(Ne,fe,I){var D=I(10852),k=I(55639),m=D(k,"Set");Ne.exports=m},88668:function(Ne,fe,I){var D=I(83369),k=I(90619),m=I(72385);function ae(F){var K=-1,W=F==null?0:F.length;for(this.__data__=new D;++K<W;)this.add(F[K])}ae.prototype.add=ae.prototype.push=k,ae.prototype.has=m,Ne.exports=ae},46384:function(Ne,fe,I){var D=I(38407),k=I(37465),m=I(63779),ae=I(67599),F=I(44758),K=I(34309);function W(Y){var G=this.__data__=new D(Y);this.size=G.size}W.prototype.clear=k,W.prototype.delete=m,W.prototype.get=ae,W.prototype.has=F,W.prototype.set=K,Ne.exports=W},62705:function(Ne,fe,I){var D=I(55639),k=D.Symbol;Ne.exports=k},11149:function(Ne,fe,I){var D=I(55639),k=D.Uint8Array;Ne.exports=k},70577:function(Ne,fe,I){var D=I(10852),k=I(55639),m=D(k,"WeakMap");Ne.exports=m},96874:function(Ne){function fe(I,D,k){switch(k.length){case 0:return I.call(D);case 1:return I.call(D,k[0]);case 2:return I.call(D,k[0],k[1]);case 3:return I.call(D,k[0],k[1],k[2])}return I.apply(D,k)}Ne.exports=fe},34963:function(Ne){function fe(I,D){for(var k=-1,m=I==null?0:I.length,ae=0,F=[];++k<m;){var K=I[k];D(K,k,I)&&(F[ae++]=K)}return F}Ne.exports=fe},14636:function(Ne,fe,I){var D=I(22545),k=I(35694),m=I(1469),ae=I(44144),F=I(65776),K=I(36719),W=Object.prototype,Y=W.hasOwnProperty;function G($,xe){var Fe=m($),Ce=!Fe&&k($),We=!Fe&&!Ce&&ae($),me=!Fe&&!Ce&&!We&&K($),Ge=Fe||Ce||We||me,Ke=Ge?D($.length,String):[],pt=Ke.length;for(var Xe in $)(xe||Y.call($,Xe))&&!(Ge&&(Xe=="length"||We&&(Xe=="offset"||Xe=="parent")||me&&(Xe=="buffer"||Xe=="byteLength"||Xe=="byteOffset")||F(Xe,pt)))&&Ke.push(Xe);return Ke}Ne.exports=G},62488:function(Ne){function fe(I,D){for(var k=-1,m=D.length,ae=I.length;++k<m;)I[ae+k]=D[k];return I}Ne.exports=fe},82908:function(Ne){function fe(I,D){for(var k=-1,m=I==null?0:I.length;++k<m;)if(D(I[k],k,I))return!0;return!1}Ne.exports=fe},86556:function(Ne,fe,I){var D=I(89465),k=I(77813);function m(ae,F,K){(K!==void 0&&!k(ae[F],K)||K===void 0&&!(F in ae))&&D(ae,F,K)}Ne.exports=m},34865:function(Ne,fe,I){var D=I(89465),k=I(77813),m=Object.prototype,ae=m.hasOwnProperty;function F(K,W,Y){var G=K[W];(!(ae.call(K,W)&&k(G,Y))||Y===void 0&&!(W in K))&&D(K,W,Y)}Ne.exports=F},18470:function(Ne,fe,I){var D=I(77813);function k(m,ae){for(var F=m.length;F--;)if(D(m[F][0],ae))return F;return-1}Ne.exports=k},89465:function(Ne,fe,I){var D=I(38777);function k(m,ae,F){ae=="__proto__"&&D?D(m,ae,{configurable:!0,enumerable:!0,value:F,writable:!0}):m[ae]=F}Ne.exports=k},3118:function(Ne,fe,I){var D=I(13218),k=Object.create,m=function(){function ae(){}return function(F){if(!D(F))return{};if(k)return k(F);ae.prototype=F;var K=new ae;return ae.prototype=void 0,K}}();Ne.exports=m},28483:function(Ne,fe,I){var D=I(25063),k=D();Ne.exports=k},68866:function(Ne,fe,I){var D=I(62488),k=I(1469);function m(ae,F,K){var W=F(ae);return k(ae)?W:D(W,K(ae))}Ne.exports=m},44239:function(Ne,fe,I){var D=I(62705),k=I(89607),m=I(2333),ae="[object Null]",F="[object Undefined]",K=D?D.toStringTag:void 0;function W(Y){return Y==null?Y===void 0?F:ae:K&&K in Object(Y)?k(Y):m(Y)}Ne.exports=W},9454:function(Ne,fe,I){var D=I(44239),k=I(37005),m="[object Arguments]";function ae(F){return k(F)&&D(F)==m}Ne.exports=ae},90939:function(Ne,fe,I){var D=I(2492),k=I(37005);function m(ae,F,K,W,Y){return ae===F?!0:ae==null||F==null||!k(ae)&&!k(F)?ae!==ae&&F!==F:D(ae,F,K,W,m,Y)}Ne.exports=m},2492:function(Ne,fe,I){var D=I(46384),k=I(67114),m=I(18351),ae=I(16096),F=I(64160),K=I(1469),W=I(44144),Y=I(36719),G=1,$="[object Arguments]",xe="[object Array]",Fe="[object Object]",Ce=Object.prototype,We=Ce.hasOwnProperty;function me(Ge,Ke,pt,Xe,gt,ie){var ft=K(Ge),ve=K(Ke),Ae=ft?xe:F(Ge),Re=ve?xe:F(Ke);Ae=Ae==$?Fe:Ae,Re=Re==$?Fe:Re;var Ye=Ae==Fe,at=Re==Fe,ht=Ae==Re;if(ht&&W(Ge)){if(!W(Ke))return!1;ft=!0,Ye=!1}if(ht&&!Ye)return ie||(ie=new D),ft||Y(Ge)?k(Ge,Ke,pt,Xe,gt,ie):m(Ge,Ke,Ae,pt,Xe,gt,ie);if(!(pt&G)){var Se=Ye&&We.call(Ge,"__wrapped__"),Qe=at&&We.call(Ke,"__wrapped__");if(Se||Qe){var oe=Se?Ge.value():Ge,ue=Qe?Ke.value():Ke;return ie||(ie=new D),gt(oe,ue,pt,Xe,ie)}}return ht?(ie||(ie=new D),ae(Ge,Ke,pt,Xe,gt,ie)):!1}Ne.exports=me},28458:function(Ne,fe,I){var D=I(23560),k=I(15346),m=I(13218),ae=I(80346),F=/[\\^$.*+?()[\]{}|]/g,K=/^\[object .+?Constructor\]$/,W=Function.prototype,Y=Object.prototype,G=W.toString,$=Y.hasOwnProperty,xe=RegExp("^"+G.call($).replace(F,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Fe(Ce){if(!m(Ce)||k(Ce))return!1;var We=D(Ce)?xe:K;return We.test(ae(Ce))}Ne.exports=Fe},38749:function(Ne,fe,I){var D=I(44239),k=I(41780),m=I(37005),ae="[object Arguments]",F="[object Array]",K="[object Boolean]",W="[object Date]",Y="[object Error]",G="[object Function]",$="[object Map]",xe="[object Number]",Fe="[object Object]",Ce="[object RegExp]",We="[object Set]",me="[object String]",Ge="[object WeakMap]",Ke="[object ArrayBuffer]",pt="[object DataView]",Xe="[object Float32Array]",gt="[object Float64Array]",ie="[object Int8Array]",ft="[object Int16Array]",ve="[object Int32Array]",Ae="[object Uint8Array]",Re="[object Uint8ClampedArray]",Ye="[object Uint16Array]",at="[object Uint32Array]",ht={};ht[Xe]=ht[gt]=ht[ie]=ht[ft]=ht[ve]=ht[Ae]=ht[Re]=ht[Ye]=ht[at]=!0,ht[ae]=ht[F]=ht[Ke]=ht[K]=ht[pt]=ht[W]=ht[Y]=ht[G]=ht[$]=ht[xe]=ht[Fe]=ht[Ce]=ht[We]=ht[me]=ht[Ge]=!1;function Se(Qe){return m(Qe)&&k(Qe.length)&&!!ht[D(Qe)]}Ne.exports=Se},280:function(Ne,fe,I){var D=I(25726),k=I(86916),m=Object.prototype,ae=m.hasOwnProperty;function F(K){if(!D(K))return k(K);var W=[];for(var Y in Object(K))ae.call(K,Y)&&Y!="constructor"&&W.push(Y);return W}Ne.exports=F},35014:function(Ne,fe,I){var D=I(13218),k=I(25726),m=I(33498),ae=Object.prototype,F=ae.hasOwnProperty;function K(W){if(!D(W))return m(W);var Y=k(W),G=[];for(var $ in W)$=="constructor"&&(Y||!F.call(W,$))||G.push($);return G}Ne.exports=K},42980:function(Ne,fe,I){var D=I(46384),k=I(86556),m=I(28483),ae=I(59783),F=I(13218),K=I(81704),W=I(36390);function Y(G,$,xe,Fe,Ce){G!==$&&m($,function(We,me){if(Ce||(Ce=new D),F(We))ae(G,$,me,xe,Y,Fe,Ce);else{var Ge=Fe?Fe(W(G,me),We,me+"",G,$,Ce):void 0;Ge===void 0&&(Ge=We),k(G,me,Ge)}},K)}Ne.exports=Y},59783:function(Ne,fe,I){var D=I(86556),k=I(64626),m=I(77133),ae=I(278),F=I(38517),K=I(35694),W=I(1469),Y=I(29246),G=I(44144),$=I(23560),xe=I(13218),Fe=I(68630),Ce=I(36719),We=I(36390),me=I(59881);function Ge(Ke,pt,Xe,gt,ie,ft,ve){var Ae=We(Ke,Xe),Re=We(pt,Xe),Ye=ve.get(Re);if(Ye){D(Ke,Xe,Ye);return}var at=ft?ft(Ae,Re,Xe+"",Ke,pt,ve):void 0,ht=at===void 0;if(ht){var Se=W(Re),Qe=!Se&&G(Re),oe=!Se&&!Qe&&Ce(Re);at=Re,Se||Qe||oe?W(Ae)?at=Ae:Y(Ae)?at=ae(Ae):Qe?(ht=!1,at=k(Re,!0)):oe?(ht=!1,at=m(Re,!0)):at=[]:Fe(Re)||K(Re)?(at=Ae,K(Ae)?at=me(Ae):(!xe(Ae)||$(Ae))&&(at=F(Re))):ht=!1}ht&&(ve.set(Re,at),ie(at,Re,gt,ft,ve),ve.delete(Re)),D(Ke,Xe,at)}Ne.exports=Ge},5976:function(Ne,fe,I){var D=I(6557),k=I(45357),m=I(30061);function ae(F,K){return m(k(F,K,D),F+"")}Ne.exports=ae},56560:function(Ne,fe,I){var D=I(75703),k=I(38777),m=I(6557),ae=k?function(F,K){return k(F,"toString",{configurable:!0,enumerable:!1,value:D(K),writable:!0})}:m;Ne.exports=ae},22545:function(Ne){function fe(I,D){for(var k=-1,m=Array(I);++k<I;)m[k]=D(k);return m}Ne.exports=fe},4107:function(Ne,fe,I){var D=I(67990),k=/^\s+/;function m(ae){return ae&&ae.slice(0,D(ae)+1).replace(k,"")}Ne.exports=m},7518:function(Ne){function fe(I){return function(D){return I(D)}}Ne.exports=fe},74757:function(Ne){function fe(I,D){return I.has(D)}Ne.exports=fe},74318:function(Ne,fe,I){var D=I(11149);function k(m){var ae=new m.constructor(m.byteLength);return new D(ae).set(new D(m)),ae}Ne.exports=k},64626:function(Ne,fe,I){Ne=I.nmd(Ne);var D=I(55639),k=fe&&!fe.nodeType&&fe,m=k&&!0&&Ne&&!Ne.nodeType&&Ne,ae=m&&m.exports===k,F=ae?D.Buffer:void 0,K=F?F.allocUnsafe:void 0;function W(Y,G){if(G)return Y.slice();var $=Y.length,xe=K?K($):new Y.constructor($);return Y.copy(xe),xe}Ne.exports=W},77133:function(Ne,fe,I){var D=I(74318);function k(m,ae){var F=ae?D(m.buffer):m.buffer;return new m.constructor(F,m.byteOffset,m.length)}Ne.exports=k},278:function(Ne){function fe(I,D){var k=-1,m=I.length;for(D||(D=Array(m));++k<m;)D[k]=I[k];return D}Ne.exports=fe},98363:function(Ne,fe,I){var D=I(34865),k=I(89465);function m(ae,F,K,W){var Y=!K;K||(K={});for(var G=-1,$=F.length;++G<$;){var xe=F[G],Fe=W?W(K[xe],ae[xe],xe,K,ae):void 0;Fe===void 0&&(Fe=ae[xe]),Y?k(K,xe,Fe):D(K,xe,Fe)}return K}Ne.exports=m},14429:function(Ne,fe,I){var D=I(55639),k=D["__core-js_shared__"];Ne.exports=k},21463:function(Ne,fe,I){var D=I(5976),k=I(16612);function m(ae){return D(function(F,K){var W=-1,Y=K.length,G=Y>1?K[Y-1]:void 0,$=Y>2?K[2]:void 0;for(G=ae.length>3&&typeof G=="function"?(Y--,G):void 0,$&&k(K[0],K[1],$)&&(G=Y<3?void 0:G,Y=1),F=Object(F);++W<Y;){var xe=K[W];xe&&ae(F,xe,W,G)}return F})}Ne.exports=m},25063:function(Ne){function fe(I){return function(D,k,m){for(var ae=-1,F=Object(D),K=m(D),W=K.length;W--;){var Y=K[I?W:++ae];if(k(F[Y],Y,F)===!1)break}return D}}Ne.exports=fe},38777:function(Ne,fe,I){var D=I(10852),k=function(){try{var m=D(Object,"defineProperty");return m({},"",{}),m}catch(ae){}}();Ne.exports=k},67114:function(Ne,fe,I){var D=I(88668),k=I(82908),m=I(74757),ae=1,F=2;function K(W,Y,G,$,xe,Fe){var Ce=G&ae,We=W.length,me=Y.length;if(We!=me&&!(Ce&&me>We))return!1;var Ge=Fe.get(W),Ke=Fe.get(Y);if(Ge&&Ke)return Ge==Y&&Ke==W;var pt=-1,Xe=!0,gt=G&F?new D:void 0;for(Fe.set(W,Y),Fe.set(Y,W);++pt<We;){var ie=W[pt],ft=Y[pt];if($)var ve=Ce?$(ft,ie,pt,Y,W,Fe):$(ie,ft,pt,W,Y,Fe);if(ve!==void 0){if(ve)continue;Xe=!1;break}if(gt){if(!k(Y,function(Ae,Re){if(!m(gt,Re)&&(ie===Ae||xe(ie,Ae,G,$,Fe)))return gt.push(Re)})){Xe=!1;break}}else if(!(ie===ft||xe(ie,ft,G,$,Fe))){Xe=!1;break}}return Fe.delete(W),Fe.delete(Y),Xe}Ne.exports=K},18351:function(Ne,fe,I){var D=I(62705),k=I(11149),m=I(77813),ae=I(67114),F=I(68776),K=I(21814),W=1,Y=2,G="[object Boolean]",$="[object Date]",xe="[object Error]",Fe="[object Map]",Ce="[object Number]",We="[object RegExp]",me="[object Set]",Ge="[object String]",Ke="[object Symbol]",pt="[object ArrayBuffer]",Xe="[object DataView]",gt=D?D.prototype:void 0,ie=gt?gt.valueOf:void 0;function ft(ve,Ae,Re,Ye,at,ht,Se){switch(Re){case Xe:if(ve.byteLength!=Ae.byteLength||ve.byteOffset!=Ae.byteOffset)return!1;ve=ve.buffer,Ae=Ae.buffer;case pt:return!(ve.byteLength!=Ae.byteLength||!ht(new k(ve),new k(Ae)));case G:case $:case Ce:return m(+ve,+Ae);case xe:return ve.name==Ae.name&&ve.message==Ae.message;case We:case Ge:return ve==Ae+"";case Fe:var Qe=F;case me:var oe=Ye&W;if(Qe||(Qe=K),ve.size!=Ae.size&&!oe)return!1;var ue=Se.get(ve);if(ue)return ue==Ae;Ye|=Y,Se.set(ve,Ae);var be=ae(Qe(ve),Qe(Ae),Ye,at,ht,Se);return Se.delete(ve),be;case Ke:if(ie)return ie.call(ve)==ie.call(Ae)}return!1}Ne.exports=ft},16096:function(Ne,fe,I){var D=I(58234),k=1,m=Object.prototype,ae=m.hasOwnProperty;function F(K,W,Y,G,$,xe){var Fe=Y&k,Ce=D(K),We=Ce.length,me=D(W),Ge=me.length;if(We!=Ge&&!Fe)return!1;for(var Ke=We;Ke--;){var pt=Ce[Ke];if(!(Fe?pt in W:ae.call(W,pt)))return!1}var Xe=xe.get(K),gt=xe.get(W);if(Xe&&gt)return Xe==W&&gt==K;var ie=!0;xe.set(K,W),xe.set(W,K);for(var ft=Fe;++Ke<We;){pt=Ce[Ke];var ve=K[pt],Ae=W[pt];if(G)var Re=Fe?G(Ae,ve,pt,W,K,xe):G(ve,Ae,pt,K,W,xe);if(!(Re===void 0?ve===Ae||$(ve,Ae,Y,G,xe):Re)){ie=!1;break}ft||(ft=pt=="constructor")}if(ie&&!ft){var Ye=K.constructor,at=W.constructor;Ye!=at&&"constructor"in K&&"constructor"in W&&!(typeof Ye=="function"&&Ye instanceof Ye&&typeof at=="function"&&at instanceof at)&&(ie=!1)}return xe.delete(K),xe.delete(W),ie}Ne.exports=F},31957:function(Ne,fe,I){var D=typeof I.g=="object"&&I.g&&I.g.Object===Object&&I.g;Ne.exports=D},58234:function(Ne,fe,I){var D=I(68866),k=I(99551),m=I(3674);function ae(F){return D(F,m,k)}Ne.exports=ae},45050:function(Ne,fe,I){var D=I(37019);function k(m,ae){var F=m.__data__;return D(ae)?F[typeof ae=="string"?"string":"hash"]:F.map}Ne.exports=k},10852:function(Ne,fe,I){var D=I(28458),k=I(47801);function m(ae,F){var K=k(ae,F);return D(K)?K:void 0}Ne.exports=m},85924:function(Ne,fe,I){var D=I(5569),k=D(Object.getPrototypeOf,Object);Ne.exports=k},89607:function(Ne,fe,I){var D=I(62705),k=Object.prototype,m=k.hasOwnProperty,ae=k.toString,F=D?D.toStringTag:void 0;function K(W){var Y=m.call(W,F),G=W[F];try{W[F]=void 0;var $=!0}catch(Fe){}var xe=ae.call(W);return $&&(Y?W[F]=G:delete W[F]),xe}Ne.exports=K},99551:function(Ne,fe,I){var D=I(34963),k=I(70479),m=Object.prototype,ae=m.propertyIsEnumerable,F=Object.getOwnPropertySymbols,K=F?function(W){return W==null?[]:(W=Object(W),D(F(W),function(Y){return ae.call(W,Y)}))}:k;Ne.exports=K},64160:function(Ne,fe,I){var D=I(18552),k=I(57071),m=I(53818),ae=I(58525),F=I(70577),K=I(44239),W=I(80346),Y="[object Map]",G="[object Object]",$="[object Promise]",xe="[object Set]",Fe="[object WeakMap]",Ce="[object DataView]",We=W(D),me=W(k),Ge=W(m),Ke=W(ae),pt=W(F),Xe=K;(D&&Xe(new D(new ArrayBuffer(1)))!=Ce||k&&Xe(new k)!=Y||m&&Xe(m.resolve())!=$||ae&&Xe(new ae)!=xe||F&&Xe(new F)!=Fe)&&(Xe=function(gt){var ie=K(gt),ft=ie==G?gt.constructor:void 0,ve=ft?W(ft):"";if(ve)switch(ve){case We:return Ce;case me:return Y;case Ge:return $;case Ke:return xe;case pt:return Fe}return ie}),Ne.exports=Xe},47801:function(Ne){function fe(I,D){return I==null?void 0:I[D]}Ne.exports=fe},51789:function(Ne,fe,I){var D=I(94536);function k(){this.__data__=D?D(null):{},this.size=0}Ne.exports=k},80401:function(Ne){function fe(I){var D=this.has(I)&&delete this.__data__[I];return this.size-=D?1:0,D}Ne.exports=fe},57667:function(Ne,fe,I){var D=I(94536),k="__lodash_hash_undefined__",m=Object.prototype,ae=m.hasOwnProperty;function F(K){var W=this.__data__;if(D){var Y=W[K];return Y===k?void 0:Y}return ae.call(W,K)?W[K]:void 0}Ne.exports=F},21327:function(Ne,fe,I){var D=I(94536),k=Object.prototype,m=k.hasOwnProperty;function ae(F){var K=this.__data__;return D?K[F]!==void 0:m.call(K,F)}Ne.exports=ae},81866:function(Ne,fe,I){var D=I(94536),k="__lodash_hash_undefined__";function m(ae,F){var K=this.__data__;return this.size+=this.has(ae)?0:1,K[ae]=D&&F===void 0?k:F,this}Ne.exports=m},38517:function(Ne,fe,I){var D=I(3118),k=I(85924),m=I(25726);function ae(F){return typeof F.constructor=="function"&&!m(F)?D(k(F)):{}}Ne.exports=ae},65776:function(Ne){var fe=9007199254740991,I=/^(?:0|[1-9]\d*)$/;function D(k,m){var ae=typeof k;return m=m==null?fe:m,!!m&&(ae=="number"||ae!="symbol"&&I.test(k))&&k>-1&&k%1==0&&k<m}Ne.exports=D},16612:function(Ne,fe,I){var D=I(77813),k=I(98612),m=I(65776),ae=I(13218);function F(K,W,Y){if(!ae(Y))return!1;var G=typeof W;return(G=="number"?k(Y)&&m(W,Y.length):G=="string"&&W in Y)?D(Y[W],K):!1}Ne.exports=F},37019:function(Ne){function fe(I){var D=typeof I;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?I!=="__proto__":I===null}Ne.exports=fe},15346:function(Ne,fe,I){var D=I(14429),k=function(){var ae=/[^.]+$/.exec(D&&D.keys&&D.keys.IE_PROTO||"");return ae?"Symbol(src)_1."+ae:""}();function m(ae){return!!k&&k in ae}Ne.exports=m},25726:function(Ne){var fe=Object.prototype;function I(D){var k=D&&D.constructor,m=typeof k=="function"&&k.prototype||fe;return D===m}Ne.exports=I},27040:function(Ne){function fe(){this.__data__=[],this.size=0}Ne.exports=fe},14125:function(Ne,fe,I){var D=I(18470),k=Array.prototype,m=k.splice;function ae(F){var K=this.__data__,W=D(K,F);if(W<0)return!1;var Y=K.length-1;return W==Y?K.pop():m.call(K,W,1),--this.size,!0}Ne.exports=ae},82117:function(Ne,fe,I){var D=I(18470);function k(m){var ae=this.__data__,F=D(ae,m);return F<0?void 0:ae[F][1]}Ne.exports=k},67518:function(Ne,fe,I){var D=I(18470);function k(m){return D(this.__data__,m)>-1}Ne.exports=k},13399:function(Ne,fe,I){var D=I(18470);function k(m,ae){var F=this.__data__,K=D(F,m);return K<0?(++this.size,F.push([m,ae])):F[K][1]=ae,this}Ne.exports=k},24785:function(Ne,fe,I){var D=I(1989),k=I(38407),m=I(57071);function ae(){this.size=0,this.__data__={hash:new D,map:new(m||k),string:new D}}Ne.exports=ae},11285:function(Ne,fe,I){var D=I(45050);function k(m){var ae=D(this,m).delete(m);return this.size-=ae?1:0,ae}Ne.exports=k},96e3:function(Ne,fe,I){var D=I(45050);function k(m){return D(this,m).get(m)}Ne.exports=k},49916:function(Ne,fe,I){var D=I(45050);function k(m){return D(this,m).has(m)}Ne.exports=k},95265:function(Ne,fe,I){var D=I(45050);function k(m,ae){var F=D(this,m),K=F.size;return F.set(m,ae),this.size+=F.size==K?0:1,this}Ne.exports=k},68776:function(Ne){function fe(I){var D=-1,k=Array(I.size);return I.forEach(function(m,ae){k[++D]=[ae,m]}),k}Ne.exports=fe},94536:function(Ne,fe,I){var D=I(10852),k=D(Object,"create");Ne.exports=k},86916:function(Ne,fe,I){var D=I(5569),k=D(Object.keys,Object);Ne.exports=k},33498:function(Ne){function fe(I){var D=[];if(I!=null)for(var k in Object(I))D.push(k);return D}Ne.exports=fe},31167:function(Ne,fe,I){Ne=I.nmd(Ne);var D=I(31957),k=fe&&!fe.nodeType&&fe,m=k&&!0&&Ne&&!Ne.nodeType&&Ne,ae=m&&m.exports===k,F=ae&&D.process,K=function(){try{var W=m&&m.require&&m.require("util").types;return W||F&&F.binding&&F.binding("util")}catch(Y){}}();Ne.exports=K},2333:function(Ne){var fe=Object.prototype,I=fe.toString;function D(k){return I.call(k)}Ne.exports=D},5569:function(Ne){function fe(I,D){return function(k){return I(D(k))}}Ne.exports=fe},45357:function(Ne,fe,I){var D=I(96874),k=Math.max;function m(ae,F,K){return F=k(F===void 0?ae.length-1:F,0),function(){for(var W=arguments,Y=-1,G=k(W.length-F,0),$=Array(G);++Y<G;)$[Y]=W[F+Y];Y=-1;for(var xe=Array(F+1);++Y<F;)xe[Y]=W[Y];return xe[F]=K($),D(ae,this,xe)}}Ne.exports=m},55639:function(Ne,fe,I){var D=I(31957),k=typeof self=="object"&&self&&self.Object===Object&&self,m=D||k||Function("return this")();Ne.exports=m},36390:function(Ne){function fe(I,D){if(!(D==="constructor"&&typeof I[D]=="function")&&D!="__proto__")return I[D]}Ne.exports=fe},90619:function(Ne){var fe="__lodash_hash_undefined__";function I(D){return this.__data__.set(D,fe),this}Ne.exports=I},72385:function(Ne){function fe(I){return this.__data__.has(I)}Ne.exports=fe},21814:function(Ne){function fe(I){var D=-1,k=Array(I.size);return I.forEach(function(m){k[++D]=m}),k}Ne.exports=fe},30061:function(Ne,fe,I){var D=I(56560),k=I(21275),m=k(D);Ne.exports=m},21275:function(Ne){var fe=800,I=16,D=Date.now;function k(m){var ae=0,F=0;return function(){var K=D(),W=I-(K-F);if(F=K,W>0){if(++ae>=fe)return arguments[0]}else ae=0;return m.apply(void 0,arguments)}}Ne.exports=k},37465:function(Ne,fe,I){var D=I(38407);function k(){this.__data__=new D,this.size=0}Ne.exports=k},63779:function(Ne){function fe(I){var D=this.__data__,k=D.delete(I);return this.size=D.size,k}Ne.exports=fe},67599:function(Ne){function fe(I){return this.__data__.get(I)}Ne.exports=fe},44758:function(Ne){function fe(I){return this.__data__.has(I)}Ne.exports=fe},34309:function(Ne,fe,I){var D=I(38407),k=I(57071),m=I(83369),ae=200;function F(K,W){var Y=this.__data__;if(Y instanceof D){var G=Y.__data__;if(!k||G.length<ae-1)return G.push([K,W]),this.size=++Y.size,this;Y=this.__data__=new m(G)}return Y.set(K,W),this.size=Y.size,this}Ne.exports=F},80346:function(Ne){var fe=Function.prototype,I=fe.toString;function D(k){if(k!=null){try{return I.call(k)}catch(m){}try{return k+""}catch(m){}}return""}Ne.exports=D},67990:function(Ne){var fe=/\s/;function I(D){for(var k=D.length;k--&&fe.test(D.charAt(k)););return k}Ne.exports=I},75703:function(Ne){function fe(I){return function(){return I}}Ne.exports=fe},23279:function(Ne,fe,I){var D=I(13218),k=I(7771),m=I(14841),ae="Expected a function",F=Math.max,K=Math.min;function W(Y,G,$){var xe,Fe,Ce,We,me,Ge,Ke=0,pt=!1,Xe=!1,gt=!0;if(typeof Y!="function")throw new TypeError(ae);G=m(G)||0,D($)&&(pt=!!$.leading,Xe="maxWait"in $,Ce=Xe?F(m($.maxWait)||0,G):Ce,gt="trailing"in $?!!$.trailing:gt);function ie(Qe){var oe=xe,ue=Fe;return xe=Fe=void 0,Ke=Qe,We=Y.apply(ue,oe),We}function ft(Qe){return Ke=Qe,me=setTimeout(Re,G),pt?ie(Qe):We}function ve(Qe){var oe=Qe-Ge,ue=Qe-Ke,be=G-oe;return Xe?K(be,Ce-ue):be}function Ae(Qe){var oe=Qe-Ge,ue=Qe-Ke;return Ge===void 0||oe>=G||oe<0||Xe&&ue>=Ce}function Re(){var Qe=k();if(Ae(Qe))return Ye(Qe);me=setTimeout(Re,ve(Qe))}function Ye(Qe){return me=void 0,gt&&xe?ie(Qe):(xe=Fe=void 0,We)}function at(){me!==void 0&&clearTimeout(me),Ke=0,xe=Ge=Fe=me=void 0}function ht(){return me===void 0?We:Ye(k())}function Se(){var Qe=k(),oe=Ae(Qe);if(xe=arguments,Fe=this,Ge=Qe,oe){if(me===void 0)return ft(Ge);if(Xe)return clearTimeout(me),me=setTimeout(Re,G),ie(Ge)}return me===void 0&&(me=setTimeout(Re,G)),We}return Se.cancel=at,Se.flush=ht,Se}Ne.exports=W},77813:function(Ne){function fe(I,D){return I===D||I!==I&&D!==D}Ne.exports=fe},6557:function(Ne){function fe(I){return I}Ne.exports=fe},35694:function(Ne,fe,I){var D=I(9454),k=I(37005),m=Object.prototype,ae=m.hasOwnProperty,F=m.propertyIsEnumerable,K=D(function(){return arguments}())?D:function(W){return k(W)&&ae.call(W,"callee")&&!F.call(W,"callee")};Ne.exports=K},1469:function(Ne){var fe=Array.isArray;Ne.exports=fe},98612:function(Ne,fe,I){var D=I(23560),k=I(41780);function m(ae){return ae!=null&&k(ae.length)&&!D(ae)}Ne.exports=m},29246:function(Ne,fe,I){var D=I(98612),k=I(37005);function m(ae){return k(ae)&&D(ae)}Ne.exports=m},44144:function(Ne,fe,I){Ne=I.nmd(Ne);var D=I(55639),k=I(95062),m=fe&&!fe.nodeType&&fe,ae=m&&!0&&Ne&&!Ne.nodeType&&Ne,F=ae&&ae.exports===m,K=F?D.Buffer:void 0,W=K?K.isBuffer:void 0,Y=W||k;Ne.exports=Y},18446:function(Ne,fe,I){var D=I(90939);function k(m,ae){return D(m,ae)}Ne.exports=k},23560:function(Ne,fe,I){var D=I(44239),k=I(13218),m="[object AsyncFunction]",ae="[object Function]",F="[object GeneratorFunction]",K="[object Proxy]";function W(Y){if(!k(Y))return!1;var G=D(Y);return G==ae||G==F||G==m||G==K}Ne.exports=W},41780:function(Ne){var fe=9007199254740991;function I(D){return typeof D=="number"&&D>-1&&D%1==0&&D<=fe}Ne.exports=I},13218:function(Ne){function fe(I){var D=typeof I;return I!=null&&(D=="object"||D=="function")}Ne.exports=fe},37005:function(Ne){function fe(I){return I!=null&&typeof I=="object"}Ne.exports=fe},68630:function(Ne,fe,I){var D=I(44239),k=I(85924),m=I(37005),ae="[object Object]",F=Function.prototype,K=Object.prototype,W=F.toString,Y=K.hasOwnProperty,G=W.call(Object);function $(xe){if(!m(xe)||D(xe)!=ae)return!1;var Fe=k(xe);if(Fe===null)return!0;var Ce=Y.call(Fe,"constructor")&&Fe.constructor;return typeof Ce=="function"&&Ce instanceof Ce&&W.call(Ce)==G}Ne.exports=$},33448:function(Ne,fe,I){var D=I(44239),k=I(37005),m="[object Symbol]";function ae(F){return typeof F=="symbol"||k(F)&&D(F)==m}Ne.exports=ae},36719:function(Ne,fe,I){var D=I(38749),k=I(7518),m=I(31167),ae=m&&m.isTypedArray,F=ae?k(ae):D;Ne.exports=F},3674:function(Ne,fe,I){var D=I(14636),k=I(280),m=I(98612);function ae(F){return m(F)?D(F):k(F)}Ne.exports=ae},81704:function(Ne,fe,I){var D=I(14636),k=I(35014),m=I(98612);function ae(F){return m(F)?D(F,!0):k(F)}Ne.exports=ae},96486:function(Ne,fe,I){Ne=I.nmd(Ne);var D;(function(){var k,m="4.17.21",ae=200,F="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",K="Expected a function",W="Invalid `variable` option passed into `_.template`",Y="__lodash_hash_undefined__",G=500,$="__lodash_placeholder__",xe=1,Fe=2,Ce=4,We=1,me=2,Ge=1,Ke=2,pt=4,Xe=8,gt=16,ie=32,ft=64,ve=128,Ae=256,Re=512,Ye=30,at="...",ht=800,Se=16,Qe=1,oe=2,ue=3,be=1/0,vt=9007199254740991,bt=17976931348623157e292,Ht=0/0,Er=4294967295,Vt=Er-1,on=Er>>>1,hn=[["ary",ve],["bind",Ge],["bindKey",Ke],["curry",Xe],["curryRight",gt],["flip",Re],["partial",ie],["partialRight",ft],["rearg",Ae]],gi="[object Arguments]",Hn="[object Array]",Dt="[object AsyncFunction]",Ea="[object Boolean]",Ze="[object Date]",ci="[object DOMException]",Ci="[object Error]",Oi="[object Function]",ea="[object GeneratorFunction]",fn="[object Map]",tn="[object Number]",da="[object Null]",Ii="[object Object]",Ai="[object Promise]",Pr="[object Proxy]",nt="[object RegExp]",it="[object Set]",_t="[object String]",we="[object Symbol]",er="[object Undefined]",$r="[object WeakMap]",Fn="[object WeakSet]",Qt="[object ArrayBuffer]",Br="[object DataView]",bn="[object Float32Array]",gr="[object Float64Array]",pn="[object Int8Array]",Sn="[object Int16Array]",Dn="[object Int32Array]",ui="[object Uint8Array]",di="[object Uint8ClampedArray]",ca="[object Uint16Array]",Ni="[object Uint32Array]",Wa=/\b__p \+= '';/g,Ba=/\b(__p \+=) '' \+/g,Ia=/(__e\(.*?\)|\b__t\)) \+\n'';/g,an=/&(?:amp|lt|gt|quot|#39);/g,Ln=/[&<>"']/g,re=RegExp(an.source),he=RegExp(Ln.source),V=/<%-([\s\S]+?)%>/g,Et=/<%([\s\S]+?)%>/g,Bt=/<%=([\s\S]+?)%>/g,Le=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,At=/[\\^$.*+?()[\]{}|]/g,tr=RegExp(At.source),en=/^\s+/,Kr=/\s/,Ft=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,rr=/\{\n\/\* \[wrapped with (.+)\] \*/,ot=/,? & /,Li=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Hr=/[()=,{}\[\]\/\s]/,_i=/\\(\\)?/g,vi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,It=/\w*$/,Yr=/^[-+]0x[0-9a-f]+$/i,Dr=/^0b[01]+$/i,Jn=/^\[object .+?Constructor\]$/,Kt=/^0o[0-7]+$/i,hr=/^(?:0|[1-9]\d*)$/,Fr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,qr=/($^)/,An=/['\n\r\u2028\u2029\\]/g,Ui="\\ud800-\\udfff",fa="\\u0300-\\u036f",Wi="\\ufe20-\\ufe2f",ct="\\u20d0-\\u20ff",qi=fa+Wi+ct,Na="\\u2700-\\u27bf",To="a-z\\xdf-\\xf6\\xf8-\\xff",ao="\\xac\\xb1\\xd7\\xf7",Ga="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ko="\\u2000-\\u206f",ws=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fo="A-Z\\xc0-\\xd6\\xd8-\\xde",su="\\ufe0e\\ufe0f",zo=ao+Ga+Ko+ws,ns="['\u2019]",ls="["+Ui+"]",_o="["+zo+"]",Po="["+qi+"]",Ss="\\d+",Wu="["+Na+"]",$s="["+To+"]",uu="[^"+Ui+zo+Ss+Na+To+Fo+"]",Jo="\\ud83c[\\udffb-\\udfff]",ms="(?:"+Po+"|"+Jo+")",eu="[^"+Ui+"]",Bs="(?:\\ud83c[\\udde6-\\uddff]){2}",fi="[\\ud800-\\udbff][\\udc00-\\udfff]",is="["+Fo+"]",ku="\\u200d",mt="(?:"+$s+"|"+uu+")",Gt="(?:"+is+"|"+uu+")",Cr="(?:"+ns+"(?:d|ll|m|re|s|t|ve))?",Rr="(?:"+ns+"(?:D|LL|M|RE|S|T|VE))?",ji=ms+"?",Pa="["+su+"]?",Yt="(?:"+ku+"(?:"+[eu,Bs,fi].join("|")+")"+Pa+ji+")*",De="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Me="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ce=Pa+ji+Yt,He="(?:"+[Wu,Bs,fi].join("|")+")"+ce,Pe="(?:"+[eu+Po+"?",Po,Bs,fi,ls].join("|")+")",Tt=RegExp(ns,"g"),Mt=RegExp(Po,"g"),$t=RegExp(Jo+"(?="+Jo+")|"+Pe+ce,"g"),fr=RegExp([is+"?"+$s+"+"+Cr+"(?="+[_o,is,"$"].join("|")+")",Gt+"+"+Rr+"(?="+[_o,is+mt,"$"].join("|")+")",is+"?"+mt+"+"+Cr,is+"+"+Rr,Me,De,Ss,He].join("|"),"g"),Tr=RegExp("["+ku+Ui+qi+su+"]"),Sr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,sn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],lt=-1,Xt={};Xt[bn]=Xt[gr]=Xt[pn]=Xt[Sn]=Xt[Dn]=Xt[ui]=Xt[di]=Xt[ca]=Xt[Ni]=!0,Xt[gi]=Xt[Hn]=Xt[Qt]=Xt[Ea]=Xt[Br]=Xt[Ze]=Xt[Ci]=Xt[Oi]=Xt[fn]=Xt[tn]=Xt[Ii]=Xt[nt]=Xt[it]=Xt[_t]=Xt[$r]=!1;var nr={};nr[gi]=nr[Hn]=nr[Qt]=nr[Br]=nr[Ea]=nr[Ze]=nr[bn]=nr[gr]=nr[pn]=nr[Sn]=nr[Dn]=nr[fn]=nr[tn]=nr[Ii]=nr[nt]=nr[it]=nr[_t]=nr[we]=nr[ui]=nr[di]=nr[ca]=nr[Ni]=!0,nr[Ci]=nr[Oi]=nr[$r]=!1;var ur={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Vr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ln={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Un={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Gn=parseFloat,qn=parseInt,oi=typeof I.g=="object"&&I.g&&I.g.Object===Object&&I.g,T=typeof self=="object"&&self&&self.Object===Object&&self,H=oi||T||Function("return this")(),_e=fe&&!fe.nodeType&&fe,ne=_e&&!0&&Ne&&!Ne.nodeType&&Ne,$e=ne&&ne.exports===_e,xt=$e&&oi.process,zt=function(){try{var un=ne&&ne.require&&ne.require("util").types;return un||xt&&xt.binding&&xt.binding("util")}catch(Mi){}}(),_r=zt&&zt.isArrayBuffer,xr=zt&&zt.isDate,dn=zt&&zt.isMap,Bn=zt&&zt.isRegExp,zi=zt&&zt.isSet,Vi=zt&&zt.isTypedArray;function Ei(un,Mi,ei){switch(ei.length){case 0:return un.call(Mi);case 1:return un.call(Mi,ei[0]);case 2:return un.call(Mi,ei[0],ei[1]);case 3:return un.call(Mi,ei[0],ei[1],ei[2])}return un.apply(Mi,ei)}function qa(un,Mi,ei,za){for(var Za=-1,Oo=un==null?0:un.length;++Za<Oo;){var mu=un[Za];Mi(za,mu,ei(mu),un)}return za}function $a(un,Mi){for(var ei=-1,za=un==null?0:un.length;++ei<za&&Mi(un[ei],ei,un)!==!1;);return un}function La(un,Mi){for(var ei=un==null?0:un.length;ei--&&Mi(un[ei],ei,un)!==!1;);return un}function to(un,Mi){for(var ei=-1,za=un==null?0:un.length;++ei<za;)if(!Mi(un[ei],ei,un))return!1;return!0}function Ho(un,Mi){for(var ei=-1,za=un==null?0:un.length,Za=0,Oo=[];++ei<za;){var mu=un[ei];Mi(mu,ei,un)&&(Oo[Za++]=mu)}return Oo}function xo(un,Mi){var ei=un==null?0:un.length;return!!ei&&Xu(un,Mi,0)>-1}function bo(un,Mi,ei){for(var za=-1,Za=un==null?0:un.length;++za<Za;)if(ei(Mi,un[za]))return!0;return!1}function so(un,Mi){for(var ei=-1,za=un==null?0:un.length,Za=Array(za);++ei<za;)Za[ei]=Mi(un[ei],ei,un);return Za}function Cs(un,Mi){for(var ei=-1,za=Mi.length,Za=un.length;++ei<za;)un[Za+ei]=Mi[ei];return un}function Ls(un,Mi,ei,za){var Za=-1,Oo=un==null?0:un.length;for(za&&Oo&&(ei=un[++Za]);++Za<Oo;)ei=Mi(ei,un[Za],Za,un);return ei}function Rs(un,Mi,ei,za){var Za=un==null?0:un.length;for(za&&Za&&(ei=un[--Za]);Za--;)ei=Mi(ei,un[Za],Za,un);return ei}function lu(un,Mi){for(var ei=-1,za=un==null?0:un.length;++ei<za;)if(Mi(un[ei],ei,un))return!0;return!1}var ps=vl("length");function Go(un){return un.split("")}function zu(un){return un.match(Li)||[]}function al(un,Mi,ei){var za;return ei(un,function(Za,Oo,mu){if(Mi(Za,Oo,mu))return za=Oo,!1}),za}function ou(un,Mi,ei,za){for(var Za=un.length,Oo=ei+(za?1:-1);za?Oo--:++Oo<Za;)if(Mi(un[Oo],Oo,un))return Oo;return-1}function Xu(un,Mi,ei){return Mi===Mi?gs(un,Mi,ei):ou(un,ks,ei)}function Nu(un,Mi,ei,za){for(var Za=ei-1,Oo=un.length;++Za<Oo;)if(za(un[Za],Mi))return Za;return-1}function ks(un){return un!==un}function Sc(un,Mi){var ei=un==null?0:un.length;return ei?Zl(un,Mi)/ei:Ht}function vl(un){return function(Mi){return Mi==null?k:Mi[un]}}function es(un){return function(Mi){return un==null?k:un[Mi]}}function Al(un,Mi,ei,za,Za){return Za(un,function(Oo,mu,Au){ei=za?(za=!1,Oo):Mi(ei,Oo,mu,Au)}),ei}function tf(un,Mi){var ei=un.length;for(un.sort(Mi);ei--;)un[ei]=un[ei].value;return un}function Zl(un,Mi){for(var ei,za=-1,Za=un.length;++za<Za;){var Oo=Mi(un[za]);Oo!==k&&(ei=ei===k?Oo:ei+Oo)}return ei}function uc(un,Mi){for(var ei=-1,za=Array(un);++ei<un;)za[ei]=Mi(ei);return za}function pf(un,Mi){return so(Mi,function(ei){return[ei,un[ei]]})}function ql(un){return un&&un.slice(0,Mu(un)+1).replace(en,"")}function Cu(un){return function(Mi){return un(Mi)}}function rf(un,Mi){return so(Mi,function(ei){return un[ei]})}function ol(un,Mi){return un.has(Mi)}function as(un,Mi){for(var ei=-1,za=un.length;++ei<za&&Xu(Mi,un[ei],0)>-1;);return ei}function Ds(un,Mi){for(var ei=un.length;ei--&&Xu(Mi,un[ei],0)>-1;);return ei}function Tl(un,Mi){for(var ei=un.length,za=0;ei--;)un[ei]===Mi&&++za;return za}var Yu=es(ur),Ml=es(Vr);function xl(un){return"\\"+Un[un]}function nf(un,Mi){return un==null?k:un[Mi]}function Vc(un){return Tr.test(un)}function Zf(un){return Sr.test(un)}function Hc(un){for(var Mi,ei=[];!(Mi=un.next()).done;)ei.push(Mi.value);return ei}function Ql(un){var Mi=-1,ei=Array(un.size);return un.forEach(function(za,Za){ei[++Mi]=[Za,za]}),ei}function sl(un,Mi){return function(ei){return un(Mi(ei))}}function vc(un,Mi){for(var ei=-1,za=un.length,Za=0,Oo=[];++ei<za;){var mu=un[ei];(mu===Mi||mu===$)&&(un[ei]=$,Oo[Za++]=ei)}return Oo}function Jl(un){var Mi=-1,ei=Array(un.size);return un.forEach(function(za){ei[++Mi]=za}),ei}function ts(un){var Mi=-1,ei=Array(un.size);return un.forEach(function(za){ei[++Mi]=[za,za]}),ei}function gs(un,Mi,ei){for(var za=ei-1,Za=un.length;++za<Za;)if(un[za]===Mi)return za;return-1}function $o(un,Mi,ei){for(var za=ei+1;za--;)if(un[za]===Mi)return za;return za}function ds(un){return Vc(un)?zs(un):ps(un)}function Ns(un){return Vc(un)?df(un):Go(un)}function Mu(un){for(var Mi=un.length;Mi--&&Kr.test(un.charAt(Mi)););return Mi}var ec=es(ln);function zs(un){for(var Mi=$t.lastIndex=0;$t.test(un);)++Mi;return Mi}function df(un){return un.match($t)||[]}function ha(un){return un.match(fr)||[]}var Gc=function un(Mi){Mi=Mi==null?H:kc.defaults(H.Object(),Mi,kc.pick(H,sn));var ei=Mi.Array,za=Mi.Date,Za=Mi.Error,Oo=Mi.Function,mu=Mi.Math,Au=Mi.Object,Rl=Mi.RegExp,xh=Mi.String,vf=Mi.TypeError,Wh=ei.prototype,oh=Oo.prototype,mc=Au.prototype,lc=Mi["__core-js_shared__"],Ku=oh.toString,xs=mc.hasOwnProperty,sh=0,bl=function(){var _=/[^.]+$/.exec(lc&&lc.keys&&lc.keys.IE_PROTO||"");return _?"Symbol(src)_1."+_:""}(),Ca=mc.toString,Zu=Ku.call(Au),$c=H._,os=Rl("^"+Ku.call(xs).replace(At,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),yo=$e?Mi.Buffer:k,As=Mi.Symbol,Ul=Mi.Uint8Array,Xi=yo?yo.allocUnsafe:k,cc=sl(Au.getPrototypeOf,Au),Dc=Au.create,af=mc.propertyIsEnumerable,Ws=Wh.splice,kl=As?As.isConcatSpreadable:k,Cc=As?As.iterator:k,fc=As?As.toStringTag:k,Fc=function(){try{var _=Np(Au,"defineProperty");return _({},"",{}),_}catch(M){}}(),Sf=Mi.clearTimeout!==H.clearTimeout&&Mi.clearTimeout,hc=za&&za.now!==H.Date.now&&za.now,ap=Mi.setTimeout!==H.setTimeout&&Mi.setTimeout,jl=mu.ceil,op=mu.floor,tc=Au.getOwnPropertySymbols,Tu=yo?yo.isBuffer:k,bs=Mi.isFinite,Xf=Wh.join,Cf=sl(Au.keys,Au),cu=mu.max,Dl=mu.min,mf=za.now,Fl=Mi.parseInt,Ac=mu.random,Yf=Wh.reverse,Qi=Np(Mi,"DataView"),Xa=Np(Mi,"Map"),of=Np(Mi,"Promise"),Pl=Np(Mi,"Set"),Bc=Np(Mi,"WeakMap"),Qu=Np(Au,"create"),ul=Bc&&new Bc,uh={},sp=el(Qi),fu=el(Xa),Pu=el(of),up=el(Pl),Ja=el(Bc),Kn=As?As.prototype:k,Wc=Kn?Kn.valueOf:k,Ju=Kn?Kn.toString:k;function Nt(_){if(Rc(_)&&!Zs(_)&&!(_ instanceof cs)){if(_ instanceof Uu)return _;if(xs.call(_,"__wrapped__"))return pc(_)}return new Uu(_)}var Xc=function(){function _(){}return function(M){if(!Ru(M))return{};if(Dc)return Dc(M);_.prototype=M;var J=new _;return _.prototype=k,J}}();function ss(){}function Uu(_,M){this.__wrapped__=_,this.__actions__=[],this.__chain__=!!M,this.__index__=0,this.__values__=k}Nt.templateSettings={escape:V,evaluate:Et,interpolate:Bt,variable:"",imports:{_:Nt}},Nt.prototype=ss.prototype,Nt.prototype.constructor=Nt,Uu.prototype=Xc(ss.prototype),Uu.prototype.constructor=Uu;function cs(_){this.__wrapped__=_,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Er,this.__views__=[]}function Kf(){var _=new cs(this.__wrapped__);return _.__actions__=nc(this.__actions__),_.__dir__=this.__dir__,_.__filtered__=this.__filtered__,_.__iteratees__=nc(this.__iteratees__),_.__takeCount__=this.__takeCount__,_.__views__=nc(this.__views__),_}function Uf(){if(this.__filtered__){var _=new cs(this);_.__dir__=-1,_.__filtered__=!0}else _=this.clone(),_.__dir__*=-1;return _}function Nc(){var _=this.__wrapped__.value(),M=this.__dir__,J=Zs(_),Te=M<0,yt=J?_.length:0,Jt=bi(0,yt,this.__views__),Gr=Jt.start,gn=Jt.end,$n=gn-Gr,pa=Te?gn:Gr-1,ma=this.__iteratees__,Ra=ma.length,Lo=0,_s=Dl($n,this.__takeCount__);if(!J||!Te&&yt==$n&&_s==$n)return Op(_,this.__actions__);var Js=[];e:for(;$n--&&Lo<_s;){pa+=M;for(var Gu=-1,Xo=_[pa];++Gu<Ra;){var nl=ma[Gu],yl=nl.iteratee,Vp=nl.type,Ap=yl(Xo);if(Vp==oe)Xo=Ap;else if(!Ap){if(Vp==Qe)continue e;break e}}Js[Lo++]=Xo}return Js}cs.prototype=Xc(ss.prototype),cs.prototype.constructor=cs;function Tc(_){var M=-1,J=_==null?0:_.length;for(this.clear();++M<J;){var Te=_[M];this.set(Te[0],Te[1])}}function gf(){this.__data__=Qu?Qu(null):{},this.size=0}function lh(_){var M=this.has(_)&&delete this.__data__[_];return this.size-=M?1:0,M}function Af(_){var M=this.__data__;if(Qu){var J=M[_];return J===Y?k:J}return xs.call(M,_)?M[_]:k}function Tf(_){var M=this.__data__;return Qu?M[_]!==k:xs.call(M,_)}function Mf(_,M){var J=this.__data__;return this.size+=this.has(_)?0:1,J[_]=Qu&&M===k?Y:M,this}Tc.prototype.clear=gf,Tc.prototype.delete=lh,Tc.prototype.get=Af,Tc.prototype.has=Tf,Tc.prototype.set=Mf;function Pf(_){var M=-1,J=_==null?0:_.length;for(this.clear();++M<J;){var Te=_[M];this.set(Te[0],Te[1])}}function ju(){this.__data__=[],this.size=0}function gp(_){var M=this.__data__,J=Pi(M,_);if(J<0)return!1;var Te=M.length-1;return J==Te?M.pop():Ws.call(M,J,1),--this.size,!0}function qf(_){var M=this.__data__,J=Pi(M,_);return J<0?k:M[J][1]}function h(_){return Pi(this.__data__,_)>-1}function g(_,M){var J=this.__data__,Te=Pi(J,_);return Te<0?(++this.size,J.push([_,M])):J[Te][1]=M,this}Pf.prototype.clear=ju,Pf.prototype.delete=gp,Pf.prototype.get=qf,Pf.prototype.has=h,Pf.prototype.set=g;function p(_){var M=-1,J=_==null?0:_.length;for(this.clear();++M<J;){var Te=_[M];this.set(Te[0],Te[1])}}function b(){this.size=0,this.__data__={hash:new Tc,map:new(Xa||Pf),string:new Tc}}function N(_){var M=Oh(this,_).delete(_);return this.size-=M?1:0,M}function q(_){return Oh(this,_).get(_)}function ee(_){return Oh(this,_).has(_)}function ge(_,M){var J=Oh(this,_),Te=J.size;return J.set(_,M),this.size+=J.size==Te?0:1,this}p.prototype.clear=b,p.prototype.delete=N,p.prototype.get=q,p.prototype.has=ee,p.prototype.set=ge;function Ue(_){var M=-1,J=_==null?0:_.length;for(this.__data__=new p;++M<J;)this.add(_[M])}function st(_){return this.__data__.set(_,Y),this}function kt(_){return this.__data__.has(_)}Ue.prototype.add=Ue.prototype.push=st,Ue.prototype.has=kt;function Lt(_){var M=this.__data__=new Pf(_);this.size=M.size}function Zt(){this.__data__=new Pf,this.size=0}function vr(_){var M=this.__data__,J=M.delete(_);return this.size=M.size,J}function pr(_){return this.__data__.get(_)}function Nr(_){return this.__data__.has(_)}function cr(_,M){var J=this.__data__;if(J instanceof Pf){var Te=J.__data__;if(!Xa||Te.length<ae-1)return Te.push([_,M]),this.size=++J.size,this;J=this.__data__=new p(Te)}return J.set(_,M),this.size=J.size,this}Lt.prototype.clear=Zt,Lt.prototype.delete=vr,Lt.prototype.get=pr,Lt.prototype.has=Nr,Lt.prototype.set=cr;function zr(_,M){var J=Zs(_),Te=!J&&gl(_),yt=!J&&!Te&&rh(_),Jt=!J&&!Te&&!yt&&Zp(_),Gr=J||Te||yt||Jt,gn=Gr?uc(_.length,xh):[],$n=gn.length;for(var pa in _)(M||xs.call(_,pa))&&!(Gr&&(pa=="length"||yt&&(pa=="offset"||pa=="parent")||Jt&&(pa=="buffer"||pa=="byteLength"||pa=="byteOffset")||sa(pa,$n)))&&gn.push(pa);return gn}function Ur(_){var M=_.length;return M?_[$l(0,M-1)]:k}function Tn(_,M){return Wo(nc(_),ho(M,0,_.length))}function ti(_){return Wo(nc(_))}function Yn(_,M,J){(J!==k&&!Ef(_[M],J)||J===k&&!(M in _))&&co(_,M,J)}function ai(_,M,J){var Te=_[M];(!(xs.call(_,M)&&Ef(Te,J))||J===k&&!(M in _))&&co(_,M,J)}function Pi(_,M){for(var J=_.length;J--;)if(Ef(_[J][0],M))return J;return-1}function va(_,M,J,Te){return po(_,function(yt,Jt,Gr){M(Te,yt,J(yt),Gr)}),Te}function na(_,M){return _&&kf(M,cf(M),_)}function Ua(_,M){return _&&kf(M,Nf(M),_)}function co(_,M,J){M=="__proto__"&&Fc?Fc(_,M,{configurable:!0,enumerable:!0,value:J,writable:!0}):_[M]=J}function Eo(_,M){for(var J=-1,Te=M.length,yt=ei(Te),Jt=_==null;++J<Te;)yt[J]=Jt?k:Nv(_,M[J]);return yt}function ho(_,M,J){return _===_&&(J!==k&&(_=_<=J?_:J),M!==k&&(_=_>=M?_:M)),_}function qo(_,M,J,Te,yt,Jt){var Gr,gn=M&xe,$n=M&Fe,pa=M&Ce;if(J&&(Gr=yt?J(_,Te,yt,Jt):J(_)),Gr!==k)return Gr;if(!Ru(_))return _;var ma=Zs(_);if(ma){if(Gr=Fi(_),!gn)return nc(_,Gr)}else{var Ra=On(_),Lo=Ra==Oi||Ra==ea;if(rh(_))return Kp(_,gn);if(Ra==Ii||Ra==gi||Lo&&!yt){if(Gr=$n||Lo?{}:Gi(_),!gn)return $n?vd(_,Ua(Gr,_)):Td(_,na(Gr,_))}else{if(!nr[Ra])return yt?_:{};Gr=Ki(_,Ra,gn)}}Jt||(Jt=new Lt);var _s=Jt.get(_);if(_s)return _s;Jt.set(_,Gr),mv(_)?_.forEach(function(Xo){Gr.add(qo(Xo,M,J,Xo,_,Jt))}):wp(_)&&_.forEach(function(Xo,nl){Gr.set(nl,qo(Xo,M,J,nl,_,Jt))});var Js=pa?$n?pp:Dp:$n?Nf:cf,Gu=ma?k:Js(_);return $a(Gu||_,function(Xo,nl){Gu&&(nl=Xo,Xo=_[nl]),ai(Gr,nl,qo(Xo,M,J,nl,_,Jt))}),Gr}function ga(_){var M=cf(_);return function(J){return Zo(J,_,M)}}function Zo(_,M,J){var Te=J.length;if(_==null)return!Te;for(_=Au(_);Te--;){var yt=J[Te],Jt=M[yt],Gr=_[yt];if(Gr===k&&!(yt in _)||!Jt(Gr))return!1}return!0}function Uo(_,M,J){if(typeof _!="function")throw new vf(K);return Bo(function(){_.apply(k,J)},M)}function Do(_,M,J,Te){var yt=-1,Jt=xo,Gr=!0,gn=_.length,$n=[],pa=M.length;if(!gn)return $n;J&&(M=so(M,Cu(J))),Te?(Jt=bo,Gr=!1):M.length>=ae&&(Jt=ol,Gr=!1,M=new Ue(M));e:for(;++yt<gn;){var ma=_[yt],Ra=J==null?ma:J(ma);if(ma=Te||ma!==0?ma:0,Gr&&Ra===Ra){for(var Lo=pa;Lo--;)if(M[Lo]===Ra)continue e;$n.push(ma)}else Jt(M,Ra,Te)||$n.push(ma)}return $n}var po=qp(gu),us=qp(gc,!0);function ko(_,M){var J=!0;return po(_,function(Te,yt,Jt){return J=!!M(Te,yt,Jt),J}),J}function Io(_,M,J){for(var Te=-1,yt=_.length;++Te<yt;){var Jt=_[Te],Gr=M(Jt);if(Gr!=null&&(gn===k?Gr===Gr&&!Ih(Gr):J(Gr,gn)))var gn=Gr,$n=Jt}return $n}function El(_,M,J,Te){var yt=_.length;for(J=Yo(J),J<0&&(J=-J>yt?0:yt+J),Te=Te===k||Te>yt?yt:Yo(Te),Te<0&&(Te+=yt),Te=J>Te?0:Up(Te);J<Te;)_[J++]=M;return _}function Ou(_,M){var J=[];return po(_,function(Te,yt,Jt){M(Te,yt,Jt)&&J.push(Te)}),J}function nu(_,M,J,Te,yt){var Jt=-1,Gr=_.length;for(J||(J=oa),yt||(yt=[]);++Jt<Gr;){var gn=_[Jt];M>0&&J(gn)?M>1?nu(gn,M-1,J,Te,yt):Cs(yt,gn):Te||(yt[yt.length]=gn)}return yt}var rc=Gf(),Du=Gf(!0);function gu(_,M){return _&&rc(_,M,cf)}function gc(_,M){return _&&Du(_,M,cf)}function Vl(_,M){return Ho(M,function(J){return dp(_[J])})}function ml(_,M){M=qc(M,_);for(var J=0,Te=M.length;_!=null&&J<Te;)_=_[xu(M[J++])];return J&&J==Te?_:k}function Mc(_,M,J){var Te=M(_);return Zs(_)?Te:Cs(Te,J(_))}function hl(_){return _==null?_===k?er:da:fc&&fc in Au(_)?ke(_):Qa(_)}function yc(_,M){return _>M}function lp(_,M){return _!=null&&xs.call(_,M)}function Dh(_,M){return _!=null&&M in Au(_)}function jf(_,M,J){return _>=Dl(M,J)&&_<cu(M,J)}function bh(_,M,J){for(var Te=J?bo:xo,yt=_[0].length,Jt=_.length,Gr=Jt,gn=ei(Jt),$n=1/0,pa=[];Gr--;){var ma=_[Gr];Gr&&M&&(ma=so(ma,Cu(M))),$n=Dl(ma.length,$n),gn[Gr]=!J&&(M||yt>=120&&ma.length>=120)?new Ue(Gr&&ma):k}ma=_[0];var Ra=-1,Lo=gn[0];e:for(;++Ra<yt&&pa.length<$n;){var _s=ma[Ra],Js=M?M(_s):_s;if(_s=J||_s!==0?_s:0,!(Lo?ol(Lo,Js):Te(pa,Js,J))){for(Gr=Jt;--Gr;){var Gu=gn[Gr];if(!(Gu?ol(Gu,Js):Te(_[Gr],Js,J)))continue e}Lo&&Lo.push(Js),pa.push(_s)}}return pa}function Qf(_,M,J,Te){return gu(_,function(yt,Jt,Gr){M(Te,J(yt),Jt,Gr)}),Te}function sf(_,M,J){M=qc(M,_),_=ri(_,M);var Te=_==null?_:_[xu(cn(M))];return Te==null?k:Ei(Te,_,J)}function ch(_){return Rc(_)&&hl(_)==gi}function Pc(_){return Rc(_)&&hl(_)==Qt}function Hl(_){return Rc(_)&&hl(_)==Ze}function zc(_,M,J,Te,yt){return _===M?!0:_==null||M==null||!Rc(_)&&!Rc(M)?_!==_&&M!==M:fh(_,M,J,Te,zc,yt)}function fh(_,M,J,Te,yt,Jt){var Gr=Zs(_),gn=Zs(M),$n=Gr?Hn:On(_),pa=gn?Hn:On(M);$n=$n==gi?Ii:$n,pa=pa==gi?Ii:pa;var ma=$n==Ii,Ra=pa==Ii,Lo=$n==pa;if(Lo&&rh(_)){if(!rh(M))return!1;Gr=!0,ma=!1}if(Lo&&!ma)return Jt||(Jt=new Lt),Gr||Zp(_)?ep(_,M,J,Te,yt,Jt):gd(_,M,$n,J,Te,yt,Jt);if(!(J&We)){var _s=ma&&xs.call(_,"__wrapped__"),Js=Ra&&xs.call(M,"__wrapped__");if(_s||Js){var Gu=_s?_.value():_,Xo=Js?M.value():M;return Jt||(Jt=new Lt),yt(Gu,Xo,J,Te,Jt)}}return Lo?(Jt||(Jt=new Lt),Ov(_,M,J,Te,yt,Jt)):!1}function Eh(_){return Rc(_)&&On(_)==fn}function iu(_,M,J,Te){var yt=J.length,Jt=yt,Gr=!Te;if(_==null)return!Jt;for(_=Au(_);yt--;){var gn=J[yt];if(Gr&&gn[2]?gn[1]!==_[gn[0]]:!(gn[0]in _))return!1}for(;++yt<Jt;){gn=J[yt];var $n=gn[0],pa=_[$n],ma=gn[1];if(Gr&&gn[2]){if(pa===k&&!($n in _))return!1}else{var Ra=new Lt;if(Te)var Lo=Te(pa,ma,$n,_,M,Ra);if(!(Lo===k?zc(ma,pa,We|me,Te,Ra):Lo))return!1}}return!0}function Xs(_){if(!Ru(_)||Yi(_))return!1;var M=dp(_)?os:Jn;return M.test(el(_))}function Yc(_){return Rc(_)&&hl(_)==nt}function hh(_){return Rc(_)&&On(_)==it}function Jf(_){return Rc(_)&&Lc(_.length)&&!!Xt[hl(_)]}function Fh(_){return typeof _=="function"?_:_==null?Hh:typeof _=="object"?Zs(_)?Yh(_[0],_[1]):Vf(_):_m(_)}function Xh(_){if(!yi(_))return Cf(_);var M=[];for(var J in Au(_))xs.call(_,J)&&J!="constructor"&&M.push(J);return M}function Of(_){if(!Ru(_))return xi(_);var M=yi(_),J=[];for(var Te in _)Te=="constructor"&&(M||!xs.call(_,Te))||J.push(Te);return J}function eh(_,M){return _<M}function If(_,M){var J=-1,Te=lf(_)?ei(_.length):[];return po(_,function(yt,Jt,Gr){Te[++J]=M(yt,Jt,Gr)}),Te}function Vf(_){var M=Bp(_);return M.length==1&&M[0][2]?ta(M[0][0],M[0][1]):function(J){return J===_||iu(J,_,M)}}function Yh(_,M){return Ji(_)&&Ri(M)?ta(xu(_),M):function(J){var Te=Nv(J,_);return Te===k&&Te===M?w0(J,_):zc(M,Te,We|me)}}function yf(_,M,J,Te,yt){_!==M&&rc(M,function(Jt,Gr){if(yt||(yt=new Lt),Ru(Jt))Gl(_,M,Gr,J,yf,Te,yt);else{var gn=Te?Te(Zi(_,Gr),Jt,Gr+"",_,M,yt):k;gn===k&&(gn=Jt),Yn(_,Gr,gn)}},Nf)}function Gl(_,M,J,Te,yt,Jt,Gr){var gn=Zi(_,J),$n=Zi(M,J),pa=Gr.get($n);if(pa){Yn(_,J,pa);return}var ma=Jt?Jt(gn,$n,J+"",_,M,Gr):k,Ra=ma===k;if(Ra){var Lo=Zs($n),_s=!Lo&&rh($n),Js=!Lo&&!_s&&Zp($n);ma=$n,Lo||_s||Js?Zs(gn)?ma=gn:xc(gn)?ma=nc(gn):_s?(Ra=!1,ma=Kp($n,!0)):Js?(Ra=!1,ma=qh($n,!0)):ma=[]:yd($n)||gl($n)?(ma=gn,gl(gn)?ma=mp(gn):(!Ru(gn)||dp(gn))&&(ma=Gi($n))):Ra=!1}Ra&&(Gr.set($n,ma),yt(ma,$n,Te,Jt,Gr),Gr.delete($n)),Yn(_,J,ma)}function Bh(_,M){var J=_.length;if(J)return M+=M<0?J:0,sa(M,J)?_[M]:k}function Kh(_,M,J){M.length?M=so(M,function(Jt){return Zs(Jt)?function(Gr){return ml(Gr,Jt.length===1?Jt[0]:Jt)}:Jt}):M=[Hh];var Te=-1;M=so(M,Cu(jo()));var yt=If(_,function(Jt,Gr,gn){var $n=so(M,function(pa){return pa(Jt)});return{criteria:$n,index:++Te,value:Jt}});return tf(yt,function(Jt,Gr){return Zh(Jt,Gr,J)})}function yu(_,M){return $p(_,M,function(J,Te){return w0(_,Te)})}function $p(_,M,J){for(var Te=-1,yt=M.length,Jt={};++Te<yt;){var Gr=M[Te],gn=ml(_,Gr);J(gn,Gr)&&fd(Jt,qc(Gr,_),gn)}return Jt}function Kc(_){return function(M){return ml(M,_)}}function Mp(_,M,J,Te){var yt=Te?Nu:Xu,Jt=-1,Gr=M.length,gn=_;for(_===M&&(M=nc(M)),J&&(gn=so(_,Cu(J)));++Jt<Gr;)for(var $n=0,pa=M[Jt],ma=J?J(pa):pa;($n=yt(gn,ma,$n,Te))>-1;)gn!==_&&Ws.call(gn,$n,1),Ws.call(_,$n,1);return _}function Hf(_,M){for(var J=_?M.length:0,Te=J-1;J--;){var yt=M[J];if(J==Te||yt!==Jt){var Jt=yt;sa(yt)?Ws.call(_,yt,1):Sh(_,yt)}}return _}function $l(_,M){return _+op(Ac()*(M-_+1))}function cd(_,M,J,Te){for(var yt=-1,Jt=cu(jl((M-_)/(J||1)),0),Gr=ei(Jt);Jt--;)Gr[Te?Jt:++yt]=_,_+=J;return Gr}function Wp(_,M){var J="";if(!_||M<1||M>vt)return J;do M%2&&(J+=_),M=op(M/2),M&&(_+=_);while(M);return J}function Es(_,M){return Hi(Aa(_,M,Hh),_+"")}function Xp(_){return Ur(oc(_))}function Nd(_,M){var J=oc(_);return Wo(J,ho(M,0,J.length))}function fd(_,M,J,Te){if(!Ru(_))return _;M=qc(M,_);for(var yt=-1,Jt=M.length,Gr=Jt-1,gn=_;gn!=null&&++yt<Jt;){var $n=xu(M[yt]),pa=J;if($n==="__proto__"||$n==="constructor"||$n==="prototype")return _;if(yt!=Gr){var ma=gn[$n];pa=Te?Te(ma,$n,gn):k,pa===k&&(pa=Ru(ma)?ma:sa(M[yt+1])?[]:{})}ai(gn,$n,pa),gn=gn[$n]}return _}var cp=ul?function(_,M){return ul.set(_,M),_}:Hh,Pp=Fc?function(_,M){return Fc(_,"toString",{configurable:!0,enumerable:!1,value:Wf(M),writable:!0})}:Hh;function hd(_){return Wo(oc(_))}function wh(_,M,J){var Te=-1,yt=_.length;M<0&&(M=-M>yt?0:yt+M),J=J>yt?yt:J,J<0&&(J+=yt),yt=M>J?0:J-M>>>0,M>>>=0;for(var Jt=ei(yt);++Te<yt;)Jt[Te]=_[Te+M];return Jt}function pd(_,M){var J;return po(_,function(Te,yt,Jt){return J=M(Te,yt,Jt),!J}),!!J}function ll(_,M,J){var Te=0,yt=_==null?Te:_.length;if(typeof M=="number"&&M===M&&yt<=on){for(;Te<yt;){var Jt=Te+yt>>>1,Gr=_[Jt];Gr!==null&&!Ih(Gr)&&(J?Gr<=M:Gr<M)?Te=Jt+1:yt=Jt}return yt}return zd(_,M,Hh,J)}function zd(_,M,J,Te){var yt=0,Jt=_==null?0:_.length;if(Jt===0)return 0;M=J(M);for(var Gr=M!==M,gn=M===null,$n=Ih(M),pa=M===k;yt<Jt;){var ma=op((yt+Jt)/2),Ra=J(_[ma]),Lo=Ra!==k,_s=Ra===null,Js=Ra===Ra,Gu=Ih(Ra);if(Gr)var Xo=Te||Js;else pa?Xo=Js&&(Te||Lo):gn?Xo=Js&&Lo&&(Te||!_s):$n?Xo=Js&&Lo&&!_s&&(Te||!Gu):_s||Gu?Xo=!1:Xo=Te?Ra<=M:Ra<M;Xo?yt=ma+1:Jt=ma}return Dl(Jt,Vt)}function yp(_,M){for(var J=-1,Te=_.length,yt=0,Jt=[];++J<Te;){var Gr=_[J],gn=M?M(Gr):Gr;if(!J||!Ef(gn,$n)){var $n=gn;Jt[yt++]=Gr===0?0:Gr}}return Jt}function Sd(_){return typeof _=="number"?_:Ih(_)?Ht:+_}function hu(_){if(typeof _=="string")return _;if(Zs(_))return so(_,hu)+"";if(Ih(_))return Ju?Ju.call(_):"";var M=_+"";return M=="0"&&1/_==-be?"-0":M}function Lf(_,M,J){var Te=-1,yt=xo,Jt=_.length,Gr=!0,gn=[],$n=gn;if(J)Gr=!1,yt=bo;else if(Jt>=ae){var pa=M?null:Df(_);if(pa)return Jl(pa);Gr=!1,yt=ol,$n=new Ue}else $n=M?[]:gn;e:for(;++Te<Jt;){var ma=_[Te],Ra=M?M(ma):ma;if(ma=J||ma!==0?ma:0,Gr&&Ra===Ra){for(var Lo=$n.length;Lo--;)if($n[Lo]===Ra)continue e;M&&$n.push(Ra),gn.push(ma)}else yt($n,Ra,J)||($n!==gn&&$n.push(Ra),gn.push(ma))}return gn}function Sh(_,M){return M=qc(M,_),_=ri(_,M),_==null||delete _[xu(cn(M))]}function _p(_,M,J,Te){return fd(_,M,J(ml(_,M)),Te)}function Ch(_,M,J,Te){for(var yt=_.length,Jt=Te?yt:-1;(Te?Jt--:++Jt<yt)&&M(_[Jt],Jt,_););return J?wh(_,Te?0:Jt,Te?Jt+1:yt):wh(_,Te?Jt+1:0,Te?yt:Jt)}function Op(_,M){var J=_;return J instanceof cs&&(J=J.value()),Ls(M,function(Te,yt){return yt.func.apply(yt.thisArg,Cs([Te],yt.args))},J)}function Ah(_,M,J){var Te=_.length;if(Te<2)return Te?Lf(_[0]):[];for(var yt=-1,Jt=ei(Te);++yt<Te;)for(var Gr=_[yt],gn=-1;++gn<Te;)gn!=yt&&(Jt[yt]=Do(Jt[yt]||Gr,_[gn],M,J));return Lf(nu(Jt,1),M,J)}function fp(_,M,J){for(var Te=-1,yt=_.length,Jt=M.length,Gr={};++Te<yt;){var gn=Te<Jt?M[Te]:k;J(Gr,_[Te],gn)}return Gr}function Nh(_){return xc(_)?_:[]}function zh(_){return typeof _=="function"?_:Hh}function qc(_,M){return Zs(_)?_:Ji(_,M)?[_]:Ps(Nl(_))}var Cd=Es;function Rf(_,M,J){var Te=_.length;return J=J===k?Te:J,!M&&J>=Te?_:wh(_,M,J)}var Yp=Sf||function(_){return H.clearTimeout(_)};function Kp(_,M){if(M)return _.slice();var J=_.length,Te=Xi?Xi(J):new _.constructor(J);return _.copy(Te),Te}function ph(_){var M=new _.constructor(_.byteLength);return new Ul(M).set(new Ul(_)),M}function th(_,M){var J=M?ph(_.buffer):_.buffer;return new _.constructor(J,_.byteOffset,_.byteLength)}function Ip(_){var M=new _.constructor(_.source,It.exec(_));return M.lastIndex=_.lastIndex,M}function Oc(_){return Wc?Au(Wc.call(_)):{}}function qh(_,M){var J=M?ph(_.buffer):_.buffer;return new _.constructor(J,_.byteOffset,_.length)}function Th(_,M){if(_!==M){var J=_!==k,Te=_===null,yt=_===_,Jt=Ih(_),Gr=M!==k,gn=M===null,$n=M===M,pa=Ih(M);if(!gn&&!pa&&!Jt&&_>M||Jt&&Gr&&$n&&!gn&&!pa||Te&&Gr&&$n||!J&&$n||!yt)return 1;if(!Te&&!Jt&&!pa&&_<M||pa&&J&&yt&&!Te&&!Jt||gn&&J&&yt||!Gr&&yt||!$n)return-1}return 0}function Zh(_,M,J){for(var Te=-1,yt=_.criteria,Jt=M.criteria,Gr=yt.length,gn=J.length;++Te<Gr;){var $n=Th(yt[Te],Jt[Te]);if($n){if(Te>=gn)return $n;var pa=J[Te];return $n*(pa=="desc"?-1:1)}}return _.index-M.index}function dd(_,M,J,Te){for(var yt=-1,Jt=_.length,Gr=J.length,gn=-1,$n=M.length,pa=cu(Jt-Gr,0),ma=ei($n+pa),Ra=!Te;++gn<$n;)ma[gn]=M[gn];for(;++yt<Gr;)(Ra||yt<Jt)&&(ma[J[yt]]=_[yt]);for(;pa--;)ma[gn++]=_[yt++];return ma}function Ad(_,M,J,Te){for(var yt=-1,Jt=_.length,Gr=-1,gn=J.length,$n=-1,pa=M.length,ma=cu(Jt-gn,0),Ra=ei(ma+pa),Lo=!Te;++yt<ma;)Ra[yt]=_[yt];for(var _s=yt;++$n<pa;)Ra[_s+$n]=M[$n];for(;++Gr<gn;)(Lo||yt<Jt)&&(Ra[_s+J[Gr]]=_[yt++]);return Ra}function nc(_,M){var J=-1,Te=_.length;for(M||(M=ei(Te));++J<Te;)M[J]=_[J];return M}function kf(_,M,J,Te){var yt=!J;J||(J={});for(var Jt=-1,Gr=M.length;++Jt<Gr;){var gn=M[Jt],$n=Te?Te(J[gn],_[gn],gn,J,_):k;$n===k&&($n=_[gn]),yt?co(J,gn,$n):ai(J,gn,$n)}return J}function Td(_,M){return kf(_,Ut(_),M)}function vd(_,M){return kf(_,Ar(_),M)}function hp(_,M){return function(J,Te){var yt=Zs(J)?qa:va,Jt=M?M():{};return yt(J,_,jo(Te,2),Jt)}}function Lp(_){return Es(function(M,J){var Te=-1,yt=J.length,Jt=yt>1?J[yt-1]:k,Gr=yt>2?J[2]:k;for(Jt=_.length>3&&typeof Jt=="function"?(yt--,Jt):k,Gr&&Bi(J[0],J[1],Gr)&&(Jt=yt<3?k:Jt,yt=1),M=Au(M);++Te<yt;){var gn=J[Te];gn&&_(M,gn,Te,Jt)}return M})}function qp(_,M){return function(J,Te){if(J==null)return J;if(!lf(J))return _(J,Te);for(var yt=J.length,Jt=M?yt:-1,Gr=Au(J);(M?Jt--:++Jt<yt)&&Te(Gr[Jt],Jt,Gr)!==!1;);return J}}function Gf(_){return function(M,J,Te){for(var yt=-1,Jt=Au(M),Gr=Te(M),gn=Gr.length;gn--;){var $n=Gr[_?gn:++yt];if(J(Jt[$n],$n,Jt)===!1)break}return M}}function qd(_,M,J){var Te=M&Ge,yt=_f(_);function Jt(){var Gr=this&&this!==H&&this instanceof Jt?yt:_;return Gr.apply(Te?J:this,arguments)}return Jt}function Rp(_){return function(M){M=Nl(M);var J=Vc(M)?Ns(M):k,Te=J?J[0]:M.charAt(0),yt=J?Rf(J,1).join(""):M.slice(1);return Te[_]()+yt}}function Uh(_){return function(M){return Ls(dm(O0(M).replace(Tt,"")),_,"")}}function _f(_){return function(){var M=arguments;switch(M.length){case 0:return new _;case 1:return new _(M[0]);case 2:return new _(M[0],M[1]);case 3:return new _(M[0],M[1],M[2]);case 4:return new _(M[0],M[1],M[2],M[3]);case 5:return new _(M[0],M[1],M[2],M[3],M[4]);case 6:return new _(M[0],M[1],M[2],M[3],M[4],M[5]);case 7:return new _(M[0],M[1],M[2],M[3],M[4],M[5],M[6])}var J=Xc(_.prototype),Te=_.apply(J,M);return Ru(Te)?Te:J}}function Md(_,M,J){var Te=_f(_);function yt(){for(var Jt=arguments.length,Gr=ei(Jt),gn=Jt,$n=bp(yt);gn--;)Gr[gn]=arguments[gn];var pa=Jt<3&&Gr[0]!==$n&&Gr[Jt-1]!==$n?[]:vc(Gr,$n);if(Jt-=pa.length,Jt<J)return Qh(_,M,dh,yt.placeholder,k,Gr,pa,k,k,J-Jt);var ma=this&&this!==H&&this instanceof yt?Te:_;return Ei(ma,this,Gr)}return yt}function Qp(_){return function(M,J,Te){var yt=Au(M);if(!lf(M)){var Jt=jo(J,3);M=cf(M),J=function(gn){return Jt(yt[gn],gn,yt)}}var Gr=_(M,J,Te);return Gr>-1?yt[Jt?M[Gr]:Gr]:k}}function Mh(_){return Ff(function(M){var J=M.length,Te=J,yt=Uu.prototype.thru;for(_&&M.reverse();Te--;){var Jt=M[Te];if(typeof Jt!="function")throw new vf(K);if(yt&&!Gr&&Fu(Jt)=="wrapper")var Gr=new Uu([],!0)}for(Te=Gr?Te:J;++Te<J;){Jt=M[Te];var gn=Fu(Jt),$n=gn=="wrapper"?Fp(Jt):k;$n&&Qn($n[0])&&$n[1]==(ve|Xe|ie|Ae)&&!$n[4].length&&$n[9]==1?Gr=Gr[Fu($n[0])].apply(Gr,$n[3]):Gr=Jt.length==1&&Qn(Jt)?Gr[gn]():Gr.thru(Jt)}return function(){var pa=arguments,ma=pa[0];if(Gr&&pa.length==1&&Zs(ma))return Gr.plant(ma).value();for(var Ra=0,Lo=J?M[Ra].apply(this,pa):ma;++Ra<J;)Lo=M[Ra].call(this,Lo);return Lo}})}function dh(_,M,J,Te,yt,Jt,Gr,gn,$n,pa){var ma=M&ve,Ra=M&Ge,Lo=M&Ke,_s=M&(Xe|gt),Js=M&Re,Gu=Lo?k:_f(_);function Xo(){for(var nl=arguments.length,yl=ei(nl),Vp=nl;Vp--;)yl[Vp]=arguments[Vp];if(_s)var Ap=bp(Xo),od=Tl(yl,Ap);if(Te&&(yl=dd(yl,Te,yt,_s)),Jt&&(yl=Ad(yl,Jt,Gr,_s)),nl-=od,_s&&nl<pa){var jc=vc(yl,Ap);return Qh(_,M,dh,Xo.placeholder,J,yl,jc,gn,$n,pa-nl)}var sd=Ra?J:this,Ld=Lo?sd[_]:_;return nl=yl.length,gn?yl=_a(yl,gn):Js&&nl>1&&yl.reverse(),ma&&$n<nl&&(yl.length=$n),this&&this!==H&&this instanceof Xo&&(Ld=Gu||_f(Ld)),Ld.apply(sd,yl)}return Xo}function Ph(_,M){return function(J,Te){return Qf(J,_,M(Te),{})}}function _u(_,M){return function(J,Te){var yt;if(J===k&&Te===k)return M;if(J!==k&&(yt=J),Te!==k){if(yt===k)return Te;typeof J=="string"||typeof Te=="string"?(J=hu(J),Te=hu(Te)):(J=Sd(J),Te=Sd(Te)),yt=_(J,Te)}return yt}}function md(_){return Ff(function(M){return M=so(M,Cu(jo())),Es(function(J){var Te=this;return _(M,function(yt){return Ei(yt,Te,J)})})})}function _c(_,M){M=M===k?" ":hu(M);var J=M.length;if(J<2)return J?Wp(M,_):M;var Te=Wp(M,jl(_/ds(M)));return Vc(M)?Rf(Ns(Te),0,_).join(""):Te.slice(0,_)}function kp(_,M,J,Te){var yt=M&Ge,Jt=_f(_);function Gr(){for(var gn=-1,$n=arguments.length,pa=-1,ma=Te.length,Ra=ei(ma+$n),Lo=this&&this!==H&&this instanceof Gr?Jt:_;++pa<ma;)Ra[pa]=Te[pa];for(;$n--;)Ra[pa++]=arguments[++gn];return Ei(Lo,yt?J:this,Ra)}return Gr}function xp(_){return function(M,J,Te){return Te&&typeof Te!="number"&&Bi(M,J,Te)&&(J=Te=k),M=Sp(M),J===k?(J=M,M=0):J=Sp(J),Te=Te===k?M<J?1:-1:Sp(Te),cd(M,J,Te,_)}}function Ks(_){return function(M,J){return typeof M=="string"&&typeof J=="string"||(M=Cp(M),J=Cp(J)),_(M,J)}}function Qh(_,M,J,Te,yt,Jt,Gr,gn,$n,pa){var ma=M&Xe,Ra=ma?Gr:k,Lo=ma?k:Gr,_s=ma?Jt:k,Js=ma?k:Jt;M|=ma?ie:ft,M&=~(ma?ft:ie),M&pt||(M&=~(Ge|Ke));var Gu=[_,M,yt,_s,Ra,Js,Lo,gn,$n,pa],Xo=J.apply(k,Gu);return Qn(_)&&vo(Xo,Gu),Xo.placeholder=Te,ba(Xo,_,M)}function Bl(_){var M=mu[_];return function(J,Te){if(J=Cp(J),Te=Te==null?0:Dl(Yo(Te),292),Te&&bs(J)){var yt=(Nl(J)+"e").split("e"),Jt=M(yt[0]+"e"+(+yt[1]+Te));return yt=(Nl(Jt)+"e").split("e"),+(yt[0]+"e"+(+yt[1]-Te))}return M(J)}}var Df=Pl&&1/Jl(new Pl([,-0]))[1]==be?function(_){return new Pl(_)}:mm;function Jp(_){return function(M){var J=On(M);return J==fn?Ql(M):J==it?ts(M):pf(M,_(M))}}function jh(_,M,J,Te,yt,Jt,Gr,gn){var $n=M&Ke;if(!$n&&typeof _!="function")throw new vf(K);var pa=Te?Te.length:0;if(pa||(M&=~(ie|ft),Te=yt=k),Gr=Gr===k?Gr:cu(Yo(Gr),0),gn=gn===k?gn:Yo(gn),pa-=yt?yt.length:0,M&ft){var ma=Te,Ra=yt;Te=yt=k}var Lo=$n?k:Fp(_),_s=[_,M,J,Te,yt,ma,Ra,Jt,Gr,gn];if(Lo&&mi(_s,Lo),_=_s[0],M=_s[1],J=_s[2],Te=_s[3],yt=_s[4],gn=_s[9]=_s[9]===k?$n?0:_.length:cu(_s[9]-pa,0),!gn&&M&(Xe|gt)&&(M&=~(Xe|gt)),!M||M==Ge)var Js=qd(_,M,J);else M==Xe||M==gt?Js=Md(_,M,gn):(M==ie||M==(Ge|ie))&&!yt.length?Js=kp(_,M,J,Te):Js=dh.apply(k,_s);var Gu=Lo?cp:vo;return ba(Gu(Js,_s),_,M)}function Jh(_,M,J,Te){return _===k||Ef(_,mc[J])&&!xs.call(Te,J)?M:_}function Pd(_,M,J,Te,yt,Jt){return Ru(_)&&Ru(M)&&(Jt.set(M,_),yf(_,M,k,Pd,Jt),Jt.delete(M)),_}function Qd(_){return yd(_)?k:_}function ep(_,M,J,Te,yt,Jt){var Gr=J&We,gn=_.length,$n=M.length;if(gn!=$n&&!(Gr&&$n>gn))return!1;var pa=Jt.get(_),ma=Jt.get(M);if(pa&&ma)return pa==M&&ma==_;var Ra=-1,Lo=!0,_s=J&me?new Ue:k;for(Jt.set(_,M),Jt.set(M,_);++Ra<gn;){var Js=_[Ra],Gu=M[Ra];if(Te)var Xo=Gr?Te(Gu,Js,Ra,M,_,Jt):Te(Js,Gu,Ra,_,M,Jt);if(Xo!==k){if(Xo)continue;Lo=!1;break}if(_s){if(!lu(M,function(nl,yl){if(!ol(_s,yl)&&(Js===nl||yt(Js,nl,J,Te,Jt)))return _s.push(yl)})){Lo=!1;break}}else if(!(Js===Gu||yt(Js,Gu,J,Te,Jt))){Lo=!1;break}}return Jt.delete(_),Jt.delete(M),Lo}function gd(_,M,J,Te,yt,Jt,Gr){switch(J){case Br:if(_.byteLength!=M.byteLength||_.byteOffset!=M.byteOffset)return!1;_=_.buffer,M=M.buffer;case Qt:return!(_.byteLength!=M.byteLength||!Jt(new Ul(_),new Ul(M)));case Ea:case Ze:case tn:return Ef(+_,+M);case Ci:return _.name==M.name&&_.message==M.message;case nt:case _t:return _==M+"";case fn:var gn=Ql;case it:var $n=Te&We;if(gn||(gn=Jl),_.size!=M.size&&!$n)return!1;var pa=Gr.get(_);if(pa)return pa==M;Te|=me,Gr.set(_,M);var ma=ep(gn(_),gn(M),Te,yt,Jt,Gr);return Gr.delete(_),ma;case we:if(Wc)return Wc.call(_)==Wc.call(M)}return!1}function Ov(_,M,J,Te,yt,Jt){var Gr=J&We,gn=Dp(_),$n=gn.length,pa=Dp(M),ma=pa.length;if($n!=ma&&!Gr)return!1;for(var Ra=$n;Ra--;){var Lo=gn[Ra];if(!(Gr?Lo in M:xs.call(M,Lo)))return!1}var _s=Jt.get(_),Js=Jt.get(M);if(_s&&Js)return _s==M&&Js==_;var Gu=!0;Jt.set(_,M),Jt.set(M,_);for(var Xo=Gr;++Ra<$n;){Lo=gn[Ra];var nl=_[Lo],yl=M[Lo];if(Te)var Vp=Gr?Te(yl,nl,Lo,M,_,Jt):Te(nl,yl,Lo,_,M,Jt);if(!(Vp===k?nl===yl||yt(nl,yl,J,Te,Jt):Vp)){Gu=!1;break}Xo||(Xo=Lo=="constructor")}if(Gu&&!Xo){var Ap=_.constructor,od=M.constructor;Ap!=od&&"constructor"in _&&"constructor"in M&&!(typeof Ap=="function"&&Ap instanceof Ap&&typeof od=="function"&&od instanceof od)&&(Gu=!1)}return Jt.delete(_),Jt.delete(M),Gu}function Ff(_){return Hi(Aa(_,k,Iu),_+"")}function Dp(_){return Mc(_,cf,Ut)}function pp(_){return Mc(_,Nf,Ar)}var Fp=ul?function(_){return ul.get(_)}:mm;function Fu(_){for(var M=_.name+"",J=uh[M],Te=xs.call(uh,M)?J.length:0;Te--;){var yt=J[Te],Jt=yt.func;if(Jt==null||Jt==_)return yt.name}return M}function bp(_){var M=xs.call(Nt,"placeholder")?Nt:_;return M.placeholder}function jo(){var _=Nt.iteratee||bv;return _=_===bv?Fh:_,arguments.length?_(arguments[0],arguments[1]):_}function Oh(_,M){var J=_.__data__;return yn(M)?J[typeof M=="string"?"string":"hash"]:J.map}function Bp(_){for(var M=cf(_),J=M.length;J--;){var Te=M[J],yt=_[Te];M[J]=[Te,yt,Ri(yt)]}return M}function Np(_,M){var J=nf(_,M);return Xs(J)?J:k}function ke(_){var M=xs.call(_,fc),J=_[fc];try{_[fc]=k;var Te=!0}catch(Jt){}var yt=Ca.call(_);return Te&&(M?_[fc]=J:delete _[fc]),yt}var Ut=tc?function(_){return _==null?[]:(_=Au(_),Ho(tc(_),function(M){return af.call(_,M)}))}:R0,Ar=tc?function(_){for(var M=[];_;)Cs(M,Ut(_)),_=cc(_);return M}:R0,On=hl;(Qi&&On(new Qi(new ArrayBuffer(1)))!=Br||Xa&&On(new Xa)!=fn||of&&On(of.resolve())!=Ai||Pl&&On(new Pl)!=it||Bc&&On(new Bc)!=$r)&&(On=function(_){var M=hl(_),J=M==Ii?_.constructor:k,Te=J?el(J):"";if(Te)switch(Te){case sp:return Br;case fu:return fn;case Pu:return Ai;case up:return it;case Ja:return $r}return M});function bi(_,M,J){for(var Te=-1,yt=J.length;++Te<yt;){var Jt=J[Te],Gr=Jt.size;switch(Jt.type){case"drop":_+=Gr;break;case"dropRight":M-=Gr;break;case"take":M=Dl(M,_+Gr);break;case"takeRight":_=cu(_,M-Gr);break}}return{start:_,end:M}}function zn(_){var M=_.match(rr);return M?M[1].split(ot):[]}function hi(_,M,J){M=qc(M,_);for(var Te=-1,yt=M.length,Jt=!1;++Te<yt;){var Gr=xu(M[Te]);if(!(Jt=_!=null&&J(_,Gr)))break;_=_[Gr]}return Jt||++Te!=yt?Jt:(yt=_==null?0:_.length,!!yt&&Lc(yt)&&sa(Gr,yt)&&(Zs(_)||gl(_)))}function Fi(_){var M=_.length,J=new _.constructor(M);return M&&typeof _[0]=="string"&&xs.call(_,"index")&&(J.index=_.index,J.input=_.input),J}function Gi(_){return typeof _.constructor=="function"&&!yi(_)?Xc(cc(_)):{}}function Ki(_,M,J){var Te=_.constructor;switch(M){case Qt:return ph(_);case Ea:case Ze:return new Te(+_);case Br:return th(_,J);case bn:case gr:case pn:case Sn:case Dn:case ui:case di:case ca:case Ni:return qh(_,J);case fn:return new Te;case tn:case _t:return new Te(_);case nt:return Ip(_);case it:return new Te;case we:return Oc(_)}}function ia(_,M){var J=M.length;if(!J)return _;var Te=J-1;return M[Te]=(J>1?"& ":"")+M[Te],M=M.join(J>2?", ":" "),_.replace(Ft,`{
/* [wrapped with `+M+`] */
`)}function oa(_){return Zs(_)||gl(_)||!!(kl&&_&&_[kl])}function sa(_,M){var J=typeof _;return M=M==null?vt:M,!!M&&(J=="number"||J!="symbol"&&hr.test(_))&&_>-1&&_%1==0&&_<M}function Bi(_,M,J){if(!Ru(J))return!1;var Te=typeof M;return(Te=="number"?lf(J)&&sa(M,J.length):Te=="string"&&M in J)?Ef(J[M],_):!1}function Ji(_,M){if(Zs(_))return!1;var J=typeof _;return J=="number"||J=="symbol"||J=="boolean"||_==null||Ih(_)?!0:St.test(_)||!Le.test(_)||M!=null&&_ in Au(M)}function yn(_){var M=typeof _;return M=="string"||M=="number"||M=="symbol"||M=="boolean"?_!=="__proto__":_===null}function Qn(_){var M=Fu(_),J=Nt[M];if(typeof J!="function"||!(M in cs.prototype))return!1;if(_===J)return!0;var Te=Fp(J);return!!Te&&_===Te[0]}function Yi(_){return!!bl&&bl in _}var wa=lc?dp:Em;function yi(_){var M=_&&_.constructor,J=typeof M=="function"&&M.prototype||mc;return _===J}function Ri(_){return _===_&&!Ru(_)}function ta(_,M){return function(J){return J==null?!1:J[_]===M&&(M!==k||_ in Au(J))}}function wo(_){var M=ac(_,function(Te){return J.size===G&&J.clear(),Te}),J=M.cache;return M}function mi(_,M){var J=_[1],Te=M[1],yt=J|Te,Jt=yt<(Ge|Ke|ve),Gr=Te==ve&&J==Xe||Te==ve&&J==Ae&&_[7].length<=M[8]||Te==(ve|Ae)&&M[7].length<=M[8]&&J==Xe;if(!(Jt||Gr))return _;Te&Ge&&(_[2]=M[2],yt|=J&Ge?0:pt);var gn=M[3];if(gn){var $n=_[3];_[3]=$n?dd($n,gn,M[4]):gn,_[4]=$n?vc(_[3],$):M[4]}return gn=M[5],gn&&($n=_[5],_[5]=$n?Ad($n,gn,M[6]):gn,_[6]=$n?vc(_[5],$):M[6]),gn=M[7],gn&&(_[7]=gn),Te&ve&&(_[8]=_[8]==null?M[8]:Dl(_[8],M[8])),_[9]==null&&(_[9]=M[9]),_[0]=M[0],_[1]=yt,_}function xi(_){var M=[];if(_!=null)for(var J in Au(_))M.push(J);return M}function Qa(_){return Ca.call(_)}function Aa(_,M,J){return M=cu(M===k?_.length-1:M,0),function(){for(var Te=arguments,yt=-1,Jt=cu(Te.length-M,0),Gr=ei(Jt);++yt<Jt;)Gr[yt]=Te[M+yt];yt=-1;for(var gn=ei(M+1);++yt<M;)gn[yt]=Te[yt];return gn[M]=J(Gr),Ei(_,this,gn)}}function ri(_,M){return M.length<2?_:ml(_,wh(M,0,-1))}function _a(_,M){for(var J=_.length,Te=Dl(M.length,J),yt=nc(_);Te--;){var Jt=M[Te];_[Te]=sa(Jt,J)?yt[Jt]:k}return _}function Zi(_,M){if(!(M==="constructor"&&typeof _[M]=="function")&&M!="__proto__")return _[M]}var vo=go(cp),Bo=ap||function(_,M){return H.setTimeout(_,M)},Hi=go(Pp);function ba(_,M,J){var Te=M+"";return Hi(_,ia(Te,Fs(zn(Te),J)))}function go(_){var M=0,J=0;return function(){var Te=mf(),yt=Se-(Te-J);if(J=Te,yt>0){if(++M>=ht)return arguments[0]}else M=0;return _.apply(k,arguments)}}function Wo(_,M){var J=-1,Te=_.length,yt=Te-1;for(M=M===k?Te:M;++J<M;){var Jt=$l(J,yt),Gr=_[Jt];_[Jt]=_[J],_[J]=Gr}return _.length=M,_}var Ps=wo(function(_){var M=[];return _.charCodeAt(0)===46&&M.push(""),_.replace(tt,function(J,Te,yt,Jt){M.push(yt?Jt.replace(_i,"$1"):Te||J)}),M});function xu(_){if(typeof _=="string"||Ih(_))return _;var M=_+"";return M=="0"&&1/_==-be?"-0":M}function el(_){if(_!=null){try{return Ku.call(_)}catch(M){}try{return _+""}catch(M){}}return""}function Fs(_,M){return $a(hn,function(J){var Te="_."+J[0];M&J[1]&&!xo(_,Te)&&_.push(Te)}),_.sort()}function pc(_){if(_ instanceof cs)return _.clone();var M=new Uu(_.__wrapped__,_.__chain__);return M.__actions__=nc(_.__actions__),M.__index__=_.__index__,M.__values__=_.__values__,M}function pl(_,M,J){(J?Bi(_,M,J):M===k)?M=1:M=cu(Yo(M),0);var Te=_==null?0:_.length;if(!Te||M<1)return[];for(var yt=0,Jt=0,Gr=ei(jl(Te/M));yt<Te;)Gr[Jt++]=wh(_,yt,yt+=M);return Gr}function Ol(_){for(var M=-1,J=_==null?0:_.length,Te=0,yt=[];++M<J;){var Jt=_[M];Jt&&(yt[Te++]=Jt)}return yt}function Vu(){var _=arguments.length;if(!_)return[];for(var M=ei(_-1),J=arguments[0],Te=_;Te--;)M[Te-1]=arguments[Te];return Cs(Zs(J)?nc(J):[J],nu(M,1))}var Wl=Es(function(_,M){return xc(_)?Do(_,nu(M,1,xc,!0)):[]}),dc=Es(function(_,M){var J=cn(M);return xc(J)&&(J=k),xc(_)?Do(_,nu(M,1,xc,!0),jo(J,2)):[]}),Qc=Es(function(_,M){var J=cn(M);return xc(J)&&(J=k),xc(_)?Do(_,nu(M,1,xc,!0),k,J):[]});function Il(_,M,J){var Te=_==null?0:_.length;return Te?(M=J||M===k?1:Yo(M),wh(_,M<0?0:M,Te)):[]}function ys(_,M,J){var Te=_==null?0:_.length;return Te?(M=J||M===k?1:Yo(M),M=Te-M,wh(_,0,M<0?0:M)):[]}function tl(_,M){return _&&_.length?Ch(_,jo(M,3),!0,!0):[]}function Ts(_,M){return _&&_.length?Ch(_,jo(M,3),!0):[]}function Jc(_,M,J,Te){var yt=_==null?0:_.length;return yt?(J&&typeof J!="number"&&Bi(_,M,J)&&(J=0,Te=yt),El(_,M,J,Te)):[]}function Vo(_,M,J){var Te=_==null?0:_.length;if(!Te)return-1;var yt=J==null?0:Yo(J);return yt<0&&(yt=cu(Te+yt,0)),ou(_,jo(M,3),yt)}function js(_,M,J){var Te=_==null?0:_.length;if(!Te)return-1;var yt=Te-1;return J!==k&&(yt=Yo(J),yt=J<0?cu(Te+yt,0):Dl(yt,Te-1)),ou(_,jo(M,3),yt,!0)}function Iu(_){var M=_==null?0:_.length;return M?nu(_,1):[]}function ic(_){var M=_==null?0:_.length;return M?nu(_,be):[]}function Vh(_,M){var J=_==null?0:_.length;return J?(M=M===k?1:Yo(M),nu(_,M)):[]}function lr(_){for(var M=-1,J=_==null?0:_.length,Te={};++M<J;){var yt=_[M];Te[yt[0]]=yt[1]}return Te}function Wn(_){return _&&_.length?_[0]:k}function Rn(_,M,J){var Te=_==null?0:_.length;if(!Te)return-1;var yt=J==null?0:Yo(J);return yt<0&&(yt=cu(Te+yt,0)),Xu(_,M,yt)}function ro(_){var M=_==null?0:_.length;return M?wh(_,0,-1):[]}var qs=Es(function(_){var M=so(_,Nh);return M.length&&M[0]===_[0]?bh(M):[]}),ir=Es(function(_){var M=cn(_),J=so(_,Nh);return M===cn(J)?M=k:J.pop(),J.length&&J[0]===_[0]?bh(J,jo(M,2)):[]}),Rt=Es(function(_){var M=cn(_),J=so(_,Nh);return M=typeof M=="function"?M:k,M&&J.pop(),J.length&&J[0]===_[0]?bh(J,k,M):[]});function Zr(_,M){return _==null?"":Xf.call(_,M)}function cn(_){var M=_==null?0:_.length;return M?_[M-1]:k}function jn(_,M,J){var Te=_==null?0:_.length;if(!Te)return-1;var yt=Te;return J!==k&&(yt=Yo(J),yt=yt<0?cu(Te+yt,0):Dl(yt,Te-1)),M===M?$o(_,M,yt):ou(_,ks,yt,!0)}function Wr(_,M){return _&&_.length?Bh(_,Yo(M)):k}var wr=Es(nn);function nn(_,M){return _&&_.length&&M&&M.length?Mp(_,M):_}function Wt(_,M,J){return _&&_.length&&M&&M.length?Mp(_,M,jo(J,2)):_}function Or(_,M,J){return _&&_.length&&M&&M.length?Mp(_,M,k,J):_}var ar=Ff(function(_,M){var J=_==null?0:_.length,Te=Eo(_,M);return Hf(_,so(M,function(yt){return sa(yt,J)?+yt:yt}).sort(Th)),Te});function xn(_,M){var J=[];if(!(_&&_.length))return J;var Te=-1,yt=[],Jt=_.length;for(M=jo(M,3);++Te<Jt;){var Gr=_[Te];M(Gr,Te,_)&&(J.push(Gr),yt.push(Te))}return Hf(_,yt),J}function mn(_){return _==null?_:Yf.call(_)}function wi(_,M,J){var Te=_==null?0:_.length;return Te?(J&&typeof J!="number"&&Bi(_,M,J)?(M=0,J=Te):(M=M==null?0:Yo(M),J=J===k?Te:Yo(J)),wh(_,M,J)):[]}function ya(_,M){return ll(_,M)}function xa(_,M,J){return zd(_,M,jo(J,2))}function Sa(_,M){var J=_==null?0:_.length;if(J){var Te=ll(_,M);if(Te<J&&Ef(_[Te],M))return Te}return-1}function aa(_,M){return ll(_,M,!0)}function no(_,M,J){return zd(_,M,jo(J,2),!0)}function Ya(_,M){var J=_==null?0:_.length;if(J){var Te=ll(_,M,!0)-1;if(Ef(_[Te],M))return Te}return-1}function io(_){return _&&_.length?yp(_):[]}function E(_,M){return _&&_.length?yp(_,jo(M,2)):[]}function A(_){var M=_==null?0:_.length;return M?wh(_,1,M):[]}function L(_,M,J){return _&&_.length?(M=J||M===k?1:Yo(M),wh(_,0,M<0?0:M)):[]}function P(_,M,J){var Te=_==null?0:_.length;return Te?(M=J||M===k?1:Yo(M),M=Te-M,wh(_,M<0?0:M,Te)):[]}function B(_,M){return _&&_.length?Ch(_,jo(M,3),!1,!0):[]}function j(_,M){return _&&_.length?Ch(_,jo(M,3)):[]}var te=Es(function(_){return Lf(nu(_,1,xc,!0))}),de=Es(function(_){var M=cn(_);return xc(M)&&(M=k),Lf(nu(_,1,xc,!0),jo(M,2))}),Oe=Es(function(_){var M=cn(_);return M=typeof M=="function"?M:k,Lf(nu(_,1,xc,!0),k,M)});function et(_){return _&&_.length?Lf(_):[]}function Pt(_,M){return _&&_.length?Lf(_,jo(M,2)):[]}function Mr(_,M){return M=typeof M=="function"?M:k,_&&_.length?Lf(_,k,M):[]}function Qr(_){if(!(_&&_.length))return[];var M=0;return _=Ho(_,function(J){if(xc(J))return M=cu(J.length,M),!0}),uc(M,function(J){return so(_,vl(J))})}function Xn(_,M){if(!(_&&_.length))return[];var J=Qr(_);return M==null?J:so(J,function(Te){return Ei(M,k,Te)})}var ii=Es(function(_,M){return xc(_)?Do(_,M):[]}),li=Es(function(_){return Ah(Ho(_,xc))}),Mn=Es(function(_){var M=cn(_);return xc(M)&&(M=k),Ah(Ho(_,xc),jo(M,2))}),wn=Es(function(_){var M=cn(_);return M=typeof M=="function"?M:k,Ah(Ho(_,xc),k,M)}),Vn=Es(Qr);function br(_,M){return fp(_||[],M||[],ai)}function si(_,M){return fp(_||[],M||[],fd)}var Ti=Es(function(_){var M=_.length,J=M>1?_[M-1]:k;return J=typeof J=="function"?(_.pop(),J):k,Xn(_,J)});function ka(_){var M=Nt(_);return M.__chain__=!0,M}function So(_,M){return M(_),_}function Mo(_,M){return M(_)}var rs=Ff(function(_){var M=_.length,J=M?_[0]:0,Te=this.__wrapped__,yt=function(Jt){return Eo(Jt,_)};return M>1||this.__actions__.length||!(Te instanceof cs)||!sa(J)?this.thru(yt):(Te=Te.slice(J,+J+(M?1:0)),Te.__actions__.push({func:Mo,args:[yt],thisArg:k}),new Uu(Te,this.__chain__).thru(function(Jt){return M&&!Jt.length&&Jt.push(k),Jt}))});function pu(){return ka(this)}function Co(){return new Uu(this.value(),this.__chain__)}function Qo(){this.__values__===k&&(this.__values__=Q0(this.value()));var _=this.__index__>=this.__values__.length,M=_?k:this.__values__[this.__index__++];return{done:_,value:M}}function bu(){return this}function o(_){for(var M,J=this;J instanceof ss;){var Te=pc(J);Te.__index__=0,Te.__values__=k,M?yt.__wrapped__=Te:M=Te;var yt=Te;J=J.__wrapped__}return yt.__wrapped__=_,M}function u(){var _=this.__wrapped__;if(_ instanceof cs){var M=_;return this.__actions__.length&&(M=new cs(this)),M=M.reverse(),M.__actions__.push({func:Mo,args:[mn],thisArg:k}),new Uu(M,this.__chain__)}return this.thru(mn)}function c(){return Op(this.__wrapped__,this.__actions__)}var y=hp(function(_,M,J){xs.call(_,J)?++_[J]:co(_,J,1)});function C(_,M,J){var Te=Zs(_)?to:ko;return J&&Bi(_,M,J)&&(M=k),Te(_,jo(M,3))}function R(_,M){var J=Zs(_)?Ho:Ou;return J(_,jo(M,3))}var z=Qp(Vo),Q=Qp(js);function pe(_,M){return nu(yr(_,M),1)}function Ie(_,M){return nu(yr(_,M),be)}function ze(_,M,J){return J=J===k?1:Yo(J),nu(yr(_,M),J)}function qe(_,M){var J=Zs(_)?$a:po;return J(_,jo(M,3))}function ut(_,M){var J=Zs(_)?La:us;return J(_,jo(M,3))}var wt=hp(function(_,M,J){xs.call(_,J)?_[J].push(M):co(_,J,[M])});function or(_,M,J,Te){_=lf(_)?_:oc(_),J=J&&!Te?Yo(J):0;var yt=_.length;return J<0&&(J=cu(yt+J,0)),nd(_)?J<=yt&&_.indexOf(M,J)>-1:!!yt&&Xu(_,M,J)>-1}var sr=Es(function(_,M,J){var Te=-1,yt=typeof M=="function",Jt=lf(_)?ei(_.length):[];return po(_,function(Gr){Jt[++Te]=yt?Ei(M,Gr,J):sf(Gr,M,J)}),Jt}),mr=hp(function(_,M,J){co(_,J,M)});function yr(_,M){var J=Zs(_)?so:If;return J(_,jo(M,3))}function rn(_,M,J,Te){return _==null?[]:(Zs(M)||(M=M==null?[]:[M]),J=Te?k:J,Zs(J)||(J=J==null?[]:[J]),Kh(_,M,J))}var _n=hp(function(_,M,J){_[J?0:1].push(M)},function(){return[[],[]]});function kn(_,M,J){var Te=Zs(_)?Ls:Al,yt=arguments.length<3;return Te(_,jo(M,4),J,yt,po)}function Nn(_,M,J){var Te=Zs(_)?Rs:Al,yt=arguments.length<3;return Te(_,jo(M,4),J,yt,us)}function pi(_,M){var J=Zs(_)?Ho:Ou;return J(_,Zc(jo(M,3)))}function Xr(_){var M=Zs(_)?Ur:Xp;return M(_)}function ua(_,M,J){(J?Bi(_,M,J):M===k)?M=1:M=Yo(M);var Te=Zs(_)?Tn:Nd;return Te(_,M)}function Ir(_){var M=Zs(_)?ti:hd;return M(_)}function vn(_){if(_==null)return 0;if(lf(_))return nd(_)?ds(_):_.length;var M=On(_);return M==fn||M==it?_.size:Xh(_).length}function $i(_,M,J){var Te=Zs(_)?lu:pd;return J&&Bi(_,M,J)&&(M=k),Te(_,jo(M,3))}var ki=Es(function(_,M){if(_==null)return[];var J=M.length;return J>1&&Bi(_,M[0],M[1])?M=[]:J>2&&Bi(M[0],M[1],M[2])&&(M=[M[0]]),Kh(_,nu(M,1),[])}),eo=hc||function(){return H.Date.now()};function Ha(_,M){if(typeof M!="function")throw new vf(K);return _=Yo(_),function(){if(--_<1)return M.apply(this,arguments)}}function Ta(_,M,J){return M=J?k:M,M=_&&M==null?_.length:M,jh(_,ve,k,k,k,k,M)}function Ro(_,M){var J;if(typeof M!="function")throw new vf(K);return _=Yo(_),function(){return--_>0&&(J=M.apply(this,arguments)),_<=1&&(M=k),J}}var No=Es(function(_,M,J){var Te=Ge;if(J.length){var yt=vc(J,bp(No));Te|=ie}return jh(_,Te,M,J,yt)}),vs=Es(function(_,M,J){var Te=Ge|Ke;if(J.length){var yt=vc(J,bp(vs));Te|=ie}return jh(M,Te,_,J,yt)});function oo(_,M,J){M=J?k:M;var Te=jh(_,Xe,k,k,k,k,k,M);return Te.placeholder=oo.placeholder,Te}function Qs(_,M,J){M=J?k:M;var Te=jh(_,gt,k,k,k,k,k,M);return Te.placeholder=Qs.placeholder,Te}function Lu(_,M,J){var Te,yt,Jt,Gr,gn,$n,pa=0,ma=!1,Ra=!1,Lo=!0;if(typeof _!="function")throw new vf(K);M=Cp(M)||0,Ru(J)&&(ma=!!J.leading,Ra="maxWait"in J,Jt=Ra?cu(Cp(J.maxWait)||0,M):Jt,Lo="trailing"in J?!!J.trailing:Lo);function _s(jc){var sd=Te,Ld=yt;return Te=yt=k,pa=jc,Gr=_.apply(Ld,sd),Gr}function Js(jc){return pa=jc,gn=Bo(nl,M),ma?_s(jc):Gr}function Gu(jc){var sd=jc-$n,Ld=jc-pa,Am=M-sd;return Ra?Dl(Am,Jt-Ld):Am}function Xo(jc){var sd=jc-$n,Ld=jc-pa;return $n===k||sd>=M||sd<0||Ra&&Ld>=Jt}function nl(){var jc=eo();if(Xo(jc))return yl(jc);gn=Bo(nl,Gu(jc))}function yl(jc){return gn=k,Lo&&Te?_s(jc):(Te=yt=k,Gr)}function Vp(){gn!==k&&Yp(gn),pa=0,Te=$n=yt=gn=k}function Ap(){return gn===k?Gr:yl(eo())}function od(){var jc=eo(),sd=Xo(jc);if(Te=arguments,yt=this,$n=jc,sd){if(gn===k)return Js($n);if(Ra)return Yp(gn),gn=Bo(nl,M),_s($n)}return gn===k&&(gn=Bo(nl,M)),Gr}return od.cancel=Vp,od.flush=Ap,od}var cl=Es(function(_,M){return Uo(_,1,M)}),qu=Es(function(_,M,J){return Uo(_,Cp(M)||0,J)});function Xl(_){return jh(_,Re)}function ac(_,M){if(typeof _!="function"||M!=null&&typeof M!="function")throw new vf(K);var J=function(){var Te=arguments,yt=M?M.apply(this,Te):Te[0],Jt=J.cache;if(Jt.has(yt))return Jt.get(yt);var Gr=_.apply(this,Te);return J.cache=Jt.set(yt,Gr)||Jt,Gr};return J.cache=new(ac.Cache||p),J}ac.Cache=p;function Zc(_){if(typeof _!="function")throw new vf(K);return function(){var M=arguments;switch(M.length){case 0:return!_.call(this);case 1:return!_.call(this,M[0]);case 2:return!_.call(this,M[0],M[1]);case 3:return!_.call(this,M[0],M[1],M[2])}return!_.apply(this,M)}}function xf(_){return Ro(2,_)}var vh=Cd(function(_,M){M=M.length==1&&Zs(M[0])?so(M[0],Cu(jo())):so(nu(M,1),Cu(jo()));var J=M.length;return Es(function(Te){for(var yt=-1,Jt=Dl(Te.length,J);++yt<Jt;)Te[yt]=M[yt].call(this,Te[yt]);return Ei(_,this,Te)})}),uf=Es(function(_,M){var J=vc(M,bp(uf));return jh(_,ie,k,M,J)}),fs=Es(function(_,M){var J=vc(M,bp(fs));return jh(_,ft,k,M,J)}),Ic=Ff(function(_,M){return jh(_,Ae,k,k,k,M)});function bf(_,M){if(typeof _!="function")throw new vf(K);return M=M===k?M:Yo(M),Es(_,M)}function Vs(_,M){if(typeof _!="function")throw new vf(K);return M=M==null?0:cu(Yo(M),0),Es(function(J){var Te=J[M],yt=Rf(J,0,M);return Te&&Cs(yt,Te),Ei(_,this,yt)})}function Eu(_,M,J){var Te=!0,yt=!0;if(typeof _!="function")throw new vf(K);return Ru(J)&&(Te="leading"in J?!!J.leading:Te,yt="trailing"in J?!!J.trailing:yt),Lu(_,M,{leading:Te,maxWait:M,trailing:yt})}function wu(_){return Ta(_,1)}function tu(_,M){return uf(zh(M),_)}function mh(){if(!arguments.length)return[];var _=arguments[0];return Zs(_)?_:[_]}function Bf(_){return qo(_,Ce)}function Yl(_,M){return M=typeof M=="function"?M:k,qo(_,Ce,M)}function Uc(_){return qo(_,xe|Ce)}function $f(_,M){return M=typeof M=="function"?M:k,qo(_,xe|Ce,M)}function Hu(_,M){return M==null||Zo(_,M,cf(M))}function Ef(_,M){return _===M||_!==_&&M!==M}var gh=Ks(yc),ed=Ks(function(_,M){return _>=M}),gl=ch(function(){return arguments}())?ch:function(_){return Rc(_)&&xs.call(_,"callee")&&!af.call(_,"callee")},Zs=ei.isArray,Ep=_r?Cu(_r):Pc;function lf(_){return _!=null&&Lc(_.length)&&!dp(_)}function xc(_){return Rc(_)&&lf(_)}function rl(_){return _===!0||_===!1||Rc(_)&&hl(_)==Ea}var rh=Tu||Em,Jd=xr?Cu(xr):Hl;function Iv(_){return Rc(_)&&_.nodeType===1&&!yd(_)}function pv(_){if(_==null)return!0;if(lf(_)&&(Zs(_)||typeof _=="string"||typeof _.splice=="function"||rh(_)||Zp(_)||gl(_)))return!_.length;var M=On(_);if(M==fn||M==it)return!_.size;if(yi(_))return!Xh(_).length;for(var J in _)if(xs.call(_,J))return!1;return!0}function Zd(_,M){return zc(_,M)}function Kv(_,M,J){J=typeof J=="function"?J:k;var Te=J?J(_,M):k;return Te===k?zc(_,M,k,J):!!Te}function td(_){if(!Rc(_))return!1;var M=hl(_);return M==Ci||M==ci||typeof _.message=="string"&&typeof _.name=="string"&&!yd(_)}function rd(_){return typeof _=="number"&&bs(_)}function dp(_){if(!Ru(_))return!1;var M=hl(_);return M==Oi||M==ea||M==Dt||M==Pr}function ef(_){return typeof _=="number"&&_==Yo(_)}function Lc(_){return typeof _=="number"&&_>-1&&_%1==0&&_<=vt}function Ru(_){var M=typeof _;return _!=null&&(M=="object"||M=="function")}function Rc(_){return _!=null&&typeof _=="object"}var wp=dn?Cu(dn):Eh;function zp(_,M){return _===M||iu(_,M,Bp(M))}function vp(_,M,J){return J=typeof J=="function"?J:k,iu(_,M,Bp(M),J)}function dv(_){return kv(_)&&_!=+_}function Lv(_){if(wa(_))throw new Za(F);return Xs(_)}function Rv(_){return _===null}function tp(_){return _==null}function kv(_){return typeof _=="number"||Rc(_)&&hl(_)==tn}function yd(_){if(!Rc(_)||hl(_)!=Ii)return!1;var M=cc(_);if(M===null)return!0;var J=xs.call(M,"constructor")&&M.constructor;return typeof J=="function"&&J instanceof J&&Ku.call(J)==Zu}var ev=Bn?Cu(Bn):Yc;function vv(_){return ef(_)&&_>=-vt&&_<=vt}var mv=zi?Cu(zi):hh;function nd(_){return typeof _=="string"||!Zs(_)&&Rc(_)&&hl(_)==_t}function Ih(_){return typeof _=="symbol"||Rc(_)&&hl(_)==we}var Zp=Vi?Cu(Vi):Jf;function m0(_){return _===k}function q0(_){return Rc(_)&&On(_)==$r}function g0(_){return Rc(_)&&hl(_)==Fn}var y0=Ks(eh),_d=Ks(function(_,M){return _<=M});function Q0(_){if(!_)return[];if(lf(_))return nd(_)?Ns(_):nc(_);if(Cc&&_[Cc])return Hc(_[Cc]());var M=On(_),J=M==fn?Ql:M==it?Jl:oc;return J(_)}function Sp(_){if(!_)return _===0?_:0;if(_=Cp(_),_===be||_===-be){var M=_<0?-1:1;return M*bt}return _===_?_:0}function Yo(_){var M=Sp(_),J=M%1;return M===M?J?M-J:M:0}function Up(_){return _?ho(Yo(_),0,Er):0}function Cp(_){if(typeof _=="number")return _;if(Ih(_))return Ht;if(Ru(_)){var M=typeof _.valueOf=="function"?_.valueOf():_;_=Ru(M)?M+"":M}if(typeof _!="string")return _===0?_:+_;_=ql(_);var J=Dr.test(_);return J||Kt.test(_)?qn(_.slice(2),J?2:8):Yr.test(_)?Ht:+_}function mp(_){return kf(_,Nf(_))}function _0(_){return _?ho(Yo(_),-vt,vt):_===0?_:0}function Nl(_){return _==null?"":hu(_)}var qv=Lp(function(_,M){if(yi(M)||lf(M)){kf(M,cf(M),_);return}for(var J in M)xs.call(M,J)&&ai(_,J,M[J])}),id=Lp(function(_,M){kf(M,Nf(M),_)}),Ud=Lp(function(_,M,J,Te){kf(M,Nf(M),_,Te)}),Dv=Lp(function(_,M,J,Te){kf(M,cf(M),_,Te)}),Qv=Ff(Eo);function Jv(_,M){var J=Xc(_);return M==null?J:na(J,M)}var Fv=Es(function(_,M){_=Au(_);var J=-1,Te=M.length,yt=Te>2?M[2]:k;for(yt&&Bi(M[0],M[1],yt)&&(Te=1);++J<Te;)for(var Jt=M[J],Gr=Nf(Jt),gn=-1,$n=Gr.length;++gn<$n;){var pa=Gr[gn],ma=_[pa];(ma===k||Ef(ma,mc[pa])&&!xs.call(_,pa))&&(_[pa]=Jt[pa])}return _}),J0=Es(function(_){return _.push(k,Pd),Ei(S0,k,_)});function Bv(_,M){return al(_,jo(M,3),gu)}function x0(_,M){return al(_,jo(M,3),gc)}function b0(_,M){return _==null?_:rc(_,jo(M,3),Nf)}function em(_,M){return _==null?_:Du(_,jo(M,3),Nf)}function jp(_,M){return _&&gu(_,jo(M,3))}function E0(_,M){return _&&gc(_,jo(M,3))}function rp(_){return _==null?[]:Vl(_,cf(_))}function e0(_){return _==null?[]:Vl(_,Nf(_))}function Nv(_,M,J){var Te=_==null?k:ml(_,M);return Te===k?J:Te}function ad(_,M){return _!=null&&hi(_,M,lp)}function w0(_,M){return _!=null&&hi(_,M,Dh)}var tm=Ph(function(_,M,J){M!=null&&typeof M.toString!="function"&&(M=Ca.call(M)),_[M]=J},Wf(Hh)),Od=Ph(function(_,M,J){M!=null&&typeof M.toString!="function"&&(M=Ca.call(M)),xs.call(_,M)?_[M].push(J):_[M]=[J]},jo),jd=Es(sf);function cf(_){return lf(_)?zr(_):Xh(_)}function Nf(_){return lf(_)?zr(_,!0):Of(_)}function tv(_,M){var J={};return M=jo(M,3),gu(_,function(Te,yt,Jt){co(J,M(Te,yt,Jt),Te)}),J}function rm(_,M){var J={};return M=jo(M,3),gu(_,function(Te,yt,Jt){co(J,yt,M(Te,yt,Jt))}),J}var nm=Lp(function(_,M,J){yf(_,M,J)}),S0=Lp(function(_,M,J,Te){yf(_,M,J,Te)}),t0=Ff(function(_,M){var J={};if(_==null)return J;var Te=!1;M=so(M,function(Jt){return Jt=qc(Jt,_),Te||(Te=Jt.length>1),Jt}),kf(_,pp(_),J),Te&&(J=qo(J,xe|Fe|Ce,Qd));for(var yt=M.length;yt--;)Sh(J,M[yt]);return J});function gv(_,M){return xd(_,Zc(jo(M)))}var C0=Ff(function(_,M){return _==null?{}:yu(_,M)});function xd(_,M){if(_==null)return{};var J=so(pp(_),function(Te){return[Te]});return M=jo(M),$p(_,J,function(Te,yt){return M(Te,yt[0])})}function im(_,M,J){M=qc(M,_);var Te=-1,yt=M.length;for(yt||(yt=1,_=k);++Te<yt;){var Jt=_==null?k:_[xu(M[Te])];Jt===k&&(Te=yt,Jt=J),_=dp(Jt)?Jt.call(_):Jt}return _}function Ys(_,M,J){return _==null?_:fd(_,M,J)}function Hs(_,M,J,Te){return Te=typeof Te=="function"?Te:k,_==null?_:fd(_,M,J,Te)}var zv=Jp(cf),A0=Jp(Nf);function T0(_,M,J){var Te=Zs(_),yt=Te||rh(_)||Zp(_);if(M=jo(M,4),J==null){var Jt=_&&_.constructor;yt?J=Te?new Jt:[]:Ru(_)?J=dp(Jt)?Xc(cc(_)):{}:J={}}return(yt?$a:gu)(_,function(Gr,gn,$n){return M(J,Gr,gn,$n)}),J}function og(_,M){return _==null?!0:Sh(_,M)}function am(_,M,J){return _==null?_:_p(_,M,zh(J))}function om(_,M,J,Te){return Te=typeof Te=="function"?Te:k,_==null?_:_p(_,M,zh(J),Te)}function oc(_){return _==null?[]:rf(_,cf(_))}function sg(_){return _==null?[]:rf(_,Nf(_))}function M0(_,M,J){return J===k&&(J=M,M=k),J!==k&&(J=Cp(J),J=J===J?J:0),M!==k&&(M=Cp(M),M=M===M?M:0),ho(Cp(_),M,J)}function P0(_,M,J){return M=Sp(M),J===k?(J=M,M=0):J=Sp(J),_=Cp(_),jf(_,M,J)}function r0(_,M,J){if(J&&typeof J!="boolean"&&Bi(_,M,J)&&(M=J=k),J===k&&(typeof M=="boolean"?(J=M,M=k):typeof _=="boolean"&&(J=_,_=k)),_===k&&M===k?(_=0,M=1):(_=Sp(_),M===k?(M=_,_=0):M=Sp(M)),_>M){var Te=_;_=M,M=Te}if(J||_%1||M%1){var yt=Ac();return Dl(_+yt*(M-_+Gn("1e-"+((yt+"").length-1))),M)}return $l(_,M)}var ug=Uh(function(_,M,J){return M=M.toLowerCase(),_+(J?sm(M):M)});function sm(_){return pm(Nl(_).toLowerCase())}function O0(_){return _=Nl(_),_&&_.replace(Fr,Yu).replace(Mt,"")}function um(_,M,J){_=Nl(_),M=hu(M);var Te=_.length;J=J===k?Te:ho(Yo(J),0,Te);var yt=J;return J-=M.length,J>=0&&_.slice(J,yt)==M}function lg(_){return _=Nl(_),_&&he.test(_)?_.replace(Ln,Ml):_}function iy(_){return _=Nl(_),_&&tr.test(_)?_.replace(At,"\\$&"):_}var ay=Uh(function(_,M,J){return _+(J?"-":"")+M.toLowerCase()}),cg=Uh(function(_,M,J){return _+(J?" ":"")+M.toLowerCase()}),Id=Rp("toLowerCase");function I0(_,M,J){_=Nl(_),M=Yo(M);var Te=M?ds(_):0;if(!M||Te>=M)return _;var yt=(M-Te)/2;return _c(op(yt),J)+_+_c(jl(yt),J)}function lm(_,M,J){_=Nl(_),M=Yo(M);var Te=M?ds(_):0;return M&&Te<M?_+_c(M-Te,J):_}function yv(_,M,J){_=Nl(_),M=Yo(M);var Te=M?ds(_):0;return M&&Te<M?_c(M-Te,J)+_:_}function n0(_,M,J){return J||M==null?M=0:M&&(M=+M),Fl(Nl(_).replace(en,""),M||0)}function rv(_,M,J){return(J?Bi(_,M,J):M===k)?M=1:M=Yo(M),Wp(Nl(_),M)}function Mb(){var _=arguments,M=Nl(_[0]);return _.length<3?M:M.replace(_[1],_[2])}var Pb=Uh(function(_,M,J){return _+(J?"_":"")+M.toLowerCase()});function Zv(_,M,J){return J&&typeof J!="number"&&Bi(_,M,J)&&(M=J=k),J=J===k?Er:J>>>0,J?(_=Nl(_),_&&(typeof M=="string"||M!=null&&!ev(M))&&(M=hu(M),!M&&Vc(_))?Rf(Ns(_),0,J):_.split(M,J)):[]}var S1=Uh(function(_,M,J){return _+(J?" ":"")+pm(M)});function Ob(_,M,J){return _=Nl(_),J=J==null?0:ho(Yo(J),0,_.length),M=hu(M),_.slice(J,J+M.length)==M}function oy(_,M,J){var Te=Nt.templateSettings;J&&Bi(_,M,J)&&(M=k),_=Nl(_),M=Ud({},M,Te,Jh);var yt=Ud({},M.imports,Te.imports,Jh),Jt=cf(yt),Gr=rf(yt,Jt),gn,$n,pa=0,ma=M.interpolate||qr,Ra="__p += '",Lo=Rl((M.escape||qr).source+"|"+ma.source+"|"+(ma===Bt?vi:qr).source+"|"+(M.evaluate||qr).source+"|$","g"),_s="//# sourceURL="+(xs.call(M,"sourceURL")?(M.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++lt+"]")+`
`;_.replace(Lo,function(Xo,nl,yl,Vp,Ap,od){return yl||(yl=Vp),Ra+=_.slice(pa,od).replace(An,xl),nl&&(gn=!0,Ra+=`' +
__e(`+nl+`) +
'`),Ap&&($n=!0,Ra+=`';
`+Ap+`;
__p += '`),yl&&(Ra+=`' +
((__t = (`+yl+`)) == null ? '' : __t) +
'`),pa=od+Xo.length,Xo}),Ra+=`';
`;var Js=xs.call(M,"variable")&&M.variable;if(!Js)Ra=`with (obj) {
`+Ra+`
}
`;else if(Hr.test(Js))throw new Za(W);Ra=($n?Ra.replace(Wa,""):Ra).replace(Ba,"$1").replace(Ia,"$1;"),Ra="function("+(Js||"obj")+`) {
`+(Js?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(gn?", __e = _.escape":"")+($n?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Ra+`return __p
}`;var Gu=Vd(function(){return Oo(Jt,_s+"return "+Ra).apply(k,Gr)});if(Gu.source=Ra,td(Gu))throw Gu;return Gu}function cm(_){return Nl(_).toLowerCase()}function fg(_){return Nl(_).toUpperCase()}function fm(_,M,J){if(_=Nl(_),_&&(J||M===k))return ql(_);if(!_||!(M=hu(M)))return _;var Te=Ns(_),yt=Ns(M),Jt=as(Te,yt),Gr=Ds(Te,yt)+1;return Rf(Te,Jt,Gr).join("")}function Ib(_,M,J){if(_=Nl(_),_&&(J||M===k))return _.slice(0,Mu(_)+1);if(!_||!(M=hu(M)))return _;var Te=Ns(_),yt=Ds(Te,Ns(M))+1;return Rf(Te,0,yt).join("")}function Lb(_,M,J){if(_=Nl(_),_&&(J||M===k))return _.replace(en,"");if(!_||!(M=hu(M)))return _;var Te=Ns(_),yt=as(Te,Ns(M));return Rf(Te,yt).join("")}function Rb(_,M){var J=Ye,Te=at;if(Ru(M)){var yt="separator"in M?M.separator:yt;J="length"in M?Yo(M.length):J,Te="omission"in M?hu(M.omission):Te}_=Nl(_);var Jt=_.length;if(Vc(_)){var Gr=Ns(_);Jt=Gr.length}if(J>=Jt)return _;var gn=J-ds(Te);if(gn<1)return Te;var $n=Gr?Rf(Gr,0,gn).join(""):_.slice(0,gn);if(yt===k)return $n+Te;if(Gr&&(gn+=$n.length-gn),ev(yt)){if(_.slice(gn).search(yt)){var pa,ma=$n;for(yt.global||(yt=Rl(yt.source,Nl(It.exec(yt))+"g")),yt.lastIndex=0;pa=yt.exec(ma);)var Ra=pa.index;$n=$n.slice(0,Ra===k?gn:Ra)}}else if(_.indexOf(hu(yt),gn)!=gn){var Lo=$n.lastIndexOf(yt);Lo>-1&&($n=$n.slice(0,Lo))}return $n+Te}function kb(_){return _=Nl(_),_&&re.test(_)?_.replace(an,ec):_}var hm=Uh(function(_,M,J){return _+(J?" ":"")+M.toUpperCase()}),pm=Rp("toUpperCase");function dm(_,M,J){return _=Nl(_),M=J?k:M,M===k?Zf(_)?ha(_):zu(_):_.match(M)||[]}var Vd=Es(function(_,M){try{return Ei(_,k,M)}catch(J){return td(J)?J:new Za(J)}}),nv=Ff(function(_,M){return $a(M,function(J){J=xu(J),co(_,J,No(_[J],_))}),_});function _v(_){var M=_==null?0:_.length,J=jo();return _=M?so(_,function(Te){if(typeof Te[1]!="function")throw new vf(K);return[J(Te[0]),Te[1]]}):[],Es(function(Te){for(var yt=-1;++yt<M;){var Jt=_[yt];if(Ei(Jt[0],this,Te))return Ei(Jt[1],this,Te)}})}function xv(_){return ga(qo(_,xe))}function Wf(_){return function(){return _}}function Hd(_,M){return _==null||_!==_?M:_}var iv=Mh(),hg=Mh(!0);function Hh(_){return _}function bv(_){return Fh(typeof _=="function"?_:qo(_,xe))}function vm(_){return Vf(qo(_,xe))}function sy(_,M){return Yh(_,qo(M,xe))}var C1=Es(function(_,M){return function(J){return sf(J,_,M)}}),av=Es(function(_,M){return function(J){return sf(_,J,M)}});function i0(_,M,J){var Te=cf(M),yt=Vl(M,Te);J==null&&!(Ru(M)&&(yt.length||!Te.length))&&(J=M,M=_,_=this,yt=Vl(M,cf(M)));var Jt=!(Ru(J)&&"chain"in J)||!!J.chain,Gr=dp(_);return $a(yt,function(gn){var $n=M[gn];_[gn]=$n,Gr&&(_.prototype[gn]=function(){var pa=this.__chain__;if(Jt||pa){var ma=_(this.__wrapped__),Ra=ma.__actions__=nc(this.__actions__);return Ra.push({func:$n,args:arguments,thisArg:_}),ma.__chain__=pa,ma}return $n.apply(_,Cs([this.value()],arguments))})}),_}function yh(){return H._===this&&(H._=$c),this}function mm(){}function gm(_){return _=Yo(_),Es(function(M){return Bh(M,_)})}var ym=md(so),a0=md(to),Lh=md(lu);function _m(_){return Ji(_)?vl(xu(_)):Kc(_)}function xm(_){return function(M){return _==null?k:ml(_,M)}}var bm=xp(),L0=xp(!0);function R0(){return[]}function Em(){return!1}function uy(){return{}}function A1(){return""}function T1(){return!0}function Ev(_,M){if(_=Yo(_),_<1||_>vt)return[];var J=Er,Te=Dl(_,Er);M=jo(M),_-=Er;for(var yt=uc(Te,M);++J<_;)M(J);return yt}function ly(_){return Zs(_)?so(_,xu):Ih(_)?[_]:nc(Ps(Nl(_)))}function cy(_){var M=++sh;return Nl(_)+M}var Ve=_u(function(_,M){return _+M},0),pg=Bl("ceil"),dg=_u(function(_,M){return _/M},1),vg=Bl("floor");function k0(_){return _&&_.length?Io(_,Hh,yc):k}function wm(_,M){return _&&_.length?Io(_,jo(M,2),yc):k}function Sm(_){return Sc(_,Hh)}function mg(_,M){return Sc(_,jo(M,2))}function wv(_){return _&&_.length?Io(_,Hh,eh):k}function gg(_,M){return _&&_.length?Io(_,jo(M,2),eh):k}var yg=_u(function(_,M){return _*M},1),Cm=Bl("round"),_g=_u(function(_,M){return _-M},0);function xg(_){return _&&_.length?Zl(_,Hh):0}function M1(_,M){return _&&_.length?Zl(_,jo(M,2)):0}return Nt.after=Ha,Nt.ary=Ta,Nt.assign=qv,Nt.assignIn=id,Nt.assignInWith=Ud,Nt.assignWith=Dv,Nt.at=Qv,Nt.before=Ro,Nt.bind=No,Nt.bindAll=nv,Nt.bindKey=vs,Nt.castArray=mh,Nt.chain=ka,Nt.chunk=pl,Nt.compact=Ol,Nt.concat=Vu,Nt.cond=_v,Nt.conforms=xv,Nt.constant=Wf,Nt.countBy=y,Nt.create=Jv,Nt.curry=oo,Nt.curryRight=Qs,Nt.debounce=Lu,Nt.defaults=Fv,Nt.defaultsDeep=J0,Nt.defer=cl,Nt.delay=qu,Nt.difference=Wl,Nt.differenceBy=dc,Nt.differenceWith=Qc,Nt.drop=Il,Nt.dropRight=ys,Nt.dropRightWhile=tl,Nt.dropWhile=Ts,Nt.fill=Jc,Nt.filter=R,Nt.flatMap=pe,Nt.flatMapDeep=Ie,Nt.flatMapDepth=ze,Nt.flatten=Iu,Nt.flattenDeep=ic,Nt.flattenDepth=Vh,Nt.flip=Xl,Nt.flow=iv,Nt.flowRight=hg,Nt.fromPairs=lr,Nt.functions=rp,Nt.functionsIn=e0,Nt.groupBy=wt,Nt.initial=ro,Nt.intersection=qs,Nt.intersectionBy=ir,Nt.intersectionWith=Rt,Nt.invert=tm,Nt.invertBy=Od,Nt.invokeMap=sr,Nt.iteratee=bv,Nt.keyBy=mr,Nt.keys=cf,Nt.keysIn=Nf,Nt.map=yr,Nt.mapKeys=tv,Nt.mapValues=rm,Nt.matches=vm,Nt.matchesProperty=sy,Nt.memoize=ac,Nt.merge=nm,Nt.mergeWith=S0,Nt.method=C1,Nt.methodOf=av,Nt.mixin=i0,Nt.negate=Zc,Nt.nthArg=gm,Nt.omit=t0,Nt.omitBy=gv,Nt.once=xf,Nt.orderBy=rn,Nt.over=ym,Nt.overArgs=vh,Nt.overEvery=a0,Nt.overSome=Lh,Nt.partial=uf,Nt.partialRight=fs,Nt.partition=_n,Nt.pick=C0,Nt.pickBy=xd,Nt.property=_m,Nt.propertyOf=xm,Nt.pull=wr,Nt.pullAll=nn,Nt.pullAllBy=Wt,Nt.pullAllWith=Or,Nt.pullAt=ar,Nt.range=bm,Nt.rangeRight=L0,Nt.rearg=Ic,Nt.reject=pi,Nt.remove=xn,Nt.rest=bf,Nt.reverse=mn,Nt.sampleSize=ua,Nt.set=Ys,Nt.setWith=Hs,Nt.shuffle=Ir,Nt.slice=wi,Nt.sortBy=ki,Nt.sortedUniq=io,Nt.sortedUniqBy=E,Nt.split=Zv,Nt.spread=Vs,Nt.tail=A,Nt.take=L,Nt.takeRight=P,Nt.takeRightWhile=B,Nt.takeWhile=j,Nt.tap=So,Nt.throttle=Eu,Nt.thru=Mo,Nt.toArray=Q0,Nt.toPairs=zv,Nt.toPairsIn=A0,Nt.toPath=ly,Nt.toPlainObject=mp,Nt.transform=T0,Nt.unary=wu,Nt.union=te,Nt.unionBy=de,Nt.unionWith=Oe,Nt.uniq=et,Nt.uniqBy=Pt,Nt.uniqWith=Mr,Nt.unset=og,Nt.unzip=Qr,Nt.unzipWith=Xn,Nt.update=am,Nt.updateWith=om,Nt.values=oc,Nt.valuesIn=sg,Nt.without=ii,Nt.words=dm,Nt.wrap=tu,Nt.xor=li,Nt.xorBy=Mn,Nt.xorWith=wn,Nt.zip=Vn,Nt.zipObject=br,Nt.zipObjectDeep=si,Nt.zipWith=Ti,Nt.entries=zv,Nt.entriesIn=A0,Nt.extend=id,Nt.extendWith=Ud,i0(Nt,Nt),Nt.add=Ve,Nt.attempt=Vd,Nt.camelCase=ug,Nt.capitalize=sm,Nt.ceil=pg,Nt.clamp=M0,Nt.clone=Bf,Nt.cloneDeep=Uc,Nt.cloneDeepWith=$f,Nt.cloneWith=Yl,Nt.conformsTo=Hu,Nt.deburr=O0,Nt.defaultTo=Hd,Nt.divide=dg,Nt.endsWith=um,Nt.eq=Ef,Nt.escape=lg,Nt.escapeRegExp=iy,Nt.every=C,Nt.find=z,Nt.findIndex=Vo,Nt.findKey=Bv,Nt.findLast=Q,Nt.findLastIndex=js,Nt.findLastKey=x0,Nt.floor=vg,Nt.forEach=qe,Nt.forEachRight=ut,Nt.forIn=b0,Nt.forInRight=em,Nt.forOwn=jp,Nt.forOwnRight=E0,Nt.get=Nv,Nt.gt=gh,Nt.gte=ed,Nt.has=ad,Nt.hasIn=w0,Nt.head=Wn,Nt.identity=Hh,Nt.includes=or,Nt.indexOf=Rn,Nt.inRange=P0,Nt.invoke=jd,Nt.isArguments=gl,Nt.isArray=Zs,Nt.isArrayBuffer=Ep,Nt.isArrayLike=lf,Nt.isArrayLikeObject=xc,Nt.isBoolean=rl,Nt.isBuffer=rh,Nt.isDate=Jd,Nt.isElement=Iv,Nt.isEmpty=pv,Nt.isEqual=Zd,Nt.isEqualWith=Kv,Nt.isError=td,Nt.isFinite=rd,Nt.isFunction=dp,Nt.isInteger=ef,Nt.isLength=Lc,Nt.isMap=wp,Nt.isMatch=zp,Nt.isMatchWith=vp,Nt.isNaN=dv,Nt.isNative=Lv,Nt.isNil=tp,Nt.isNull=Rv,Nt.isNumber=kv,Nt.isObject=Ru,Nt.isObjectLike=Rc,Nt.isPlainObject=yd,Nt.isRegExp=ev,Nt.isSafeInteger=vv,Nt.isSet=mv,Nt.isString=nd,Nt.isSymbol=Ih,Nt.isTypedArray=Zp,Nt.isUndefined=m0,Nt.isWeakMap=q0,Nt.isWeakSet=g0,Nt.join=Zr,Nt.kebabCase=ay,Nt.last=cn,Nt.lastIndexOf=jn,Nt.lowerCase=cg,Nt.lowerFirst=Id,Nt.lt=y0,Nt.lte=_d,Nt.max=k0,Nt.maxBy=wm,Nt.mean=Sm,Nt.meanBy=mg,Nt.min=wv,Nt.minBy=gg,Nt.stubArray=R0,Nt.stubFalse=Em,Nt.stubObject=uy,Nt.stubString=A1,Nt.stubTrue=T1,Nt.multiply=yg,Nt.nth=Wr,Nt.noConflict=yh,Nt.noop=mm,Nt.now=eo,Nt.pad=I0,Nt.padEnd=lm,Nt.padStart=yv,Nt.parseInt=n0,Nt.random=r0,Nt.reduce=kn,Nt.reduceRight=Nn,Nt.repeat=rv,Nt.replace=Mb,Nt.result=im,Nt.round=Cm,Nt.runInContext=un,Nt.sample=Xr,Nt.size=vn,Nt.snakeCase=Pb,Nt.some=$i,Nt.sortedIndex=ya,Nt.sortedIndexBy=xa,Nt.sortedIndexOf=Sa,Nt.sortedLastIndex=aa,Nt.sortedLastIndexBy=no,Nt.sortedLastIndexOf=Ya,Nt.startCase=S1,Nt.startsWith=Ob,Nt.subtract=_g,Nt.sum=xg,Nt.sumBy=M1,Nt.template=oy,Nt.times=Ev,Nt.toFinite=Sp,Nt.toInteger=Yo,Nt.toLength=Up,Nt.toLower=cm,Nt.toNumber=Cp,Nt.toSafeInteger=_0,Nt.toString=Nl,Nt.toUpper=fg,Nt.trim=fm,Nt.trimEnd=Ib,Nt.trimStart=Lb,Nt.truncate=Rb,Nt.unescape=kb,Nt.uniqueId=cy,Nt.upperCase=hm,Nt.upperFirst=pm,Nt.each=qe,Nt.eachRight=ut,Nt.first=Wn,i0(Nt,function(){var _={};return gu(Nt,function(M,J){xs.call(Nt.prototype,J)||(_[J]=M)}),_}(),{chain:!1}),Nt.VERSION=m,$a(["bind","bindKey","curry","curryRight","partial","partialRight"],function(_){Nt[_].placeholder=Nt}),$a(["drop","take"],function(_,M){cs.prototype[_]=function(J){J=J===k?1:cu(Yo(J),0);var Te=this.__filtered__&&!M?new cs(this):this.clone();return Te.__filtered__?Te.__takeCount__=Dl(J,Te.__takeCount__):Te.__views__.push({size:Dl(J,Er),type:_+(Te.__dir__<0?"Right":"")}),Te},cs.prototype[_+"Right"]=function(J){return this.reverse()[_](J).reverse()}}),$a(["filter","map","takeWhile"],function(_,M){var J=M+1,Te=J==Qe||J==ue;cs.prototype[_]=function(yt){var Jt=this.clone();return Jt.__iteratees__.push({iteratee:jo(yt,3),type:J}),Jt.__filtered__=Jt.__filtered__||Te,Jt}}),$a(["head","last"],function(_,M){var J="take"+(M?"Right":"");cs.prototype[_]=function(){return this[J](1).value()[0]}}),$a(["initial","tail"],function(_,M){var J="drop"+(M?"":"Right");cs.prototype[_]=function(){return this.__filtered__?new cs(this):this[J](1)}}),cs.prototype.compact=function(){return this.filter(Hh)},cs.prototype.find=function(_){return this.filter(_).head()},cs.prototype.findLast=function(_){return this.reverse().find(_)},cs.prototype.invokeMap=Es(function(_,M){return typeof _=="function"?new cs(this):this.map(function(J){return sf(J,_,M)})}),cs.prototype.reject=function(_){return this.filter(Zc(jo(_)))},cs.prototype.slice=function(_,M){_=Yo(_);var J=this;return J.__filtered__&&(_>0||M<0)?new cs(J):(_<0?J=J.takeRight(-_):_&&(J=J.drop(_)),M!==k&&(M=Yo(M),J=M<0?J.dropRight(-M):J.take(M-_)),J)},cs.prototype.takeRightWhile=function(_){return this.reverse().takeWhile(_).reverse()},cs.prototype.toArray=function(){return this.take(Er)},gu(cs.prototype,function(_,M){var J=/^(?:filter|find|map|reject)|While$/.test(M),Te=/^(?:head|last)$/.test(M),yt=Nt[Te?"take"+(M=="last"?"Right":""):M],Jt=Te||/^find/.test(M);yt&&(Nt.prototype[M]=function(){var Gr=this.__wrapped__,gn=Te?[1]:arguments,$n=Gr instanceof cs,pa=gn[0],ma=$n||Zs(Gr),Ra=function(nl){var yl=yt.apply(Nt,Cs([nl],gn));return Te&&Lo?yl[0]:yl};ma&&J&&typeof pa=="function"&&pa.length!=1&&($n=ma=!1);var Lo=this.__chain__,_s=!!this.__actions__.length,Js=Jt&&!Lo,Gu=$n&&!_s;if(!Jt&&ma){Gr=Gu?Gr:new cs(this);var Xo=_.apply(Gr,gn);return Xo.__actions__.push({func:Mo,args:[Ra],thisArg:k}),new Uu(Xo,Lo)}return Js&&Gu?_.apply(this,gn):(Xo=this.thru(Ra),Js?Te?Xo.value()[0]:Xo.value():Xo)})}),$a(["pop","push","shift","sort","splice","unshift"],function(_){var M=Wh[_],J=/^(?:push|sort|unshift)$/.test(_)?"tap":"thru",Te=/^(?:pop|shift)$/.test(_);Nt.prototype[_]=function(){var yt=arguments;if(Te&&!this.__chain__){var Jt=this.value();return M.apply(Zs(Jt)?Jt:[],yt)}return this[J](function(Gr){return M.apply(Zs(Gr)?Gr:[],yt)})}}),gu(cs.prototype,function(_,M){var J=Nt[M];if(J){var Te=J.name+"";xs.call(uh,Te)||(uh[Te]=[]),uh[Te].push({name:M,func:J})}}),uh[dh(k,Ke).name]=[{name:"wrapper",func:k}],cs.prototype.clone=Kf,cs.prototype.reverse=Uf,cs.prototype.value=Nc,Nt.prototype.at=rs,Nt.prototype.chain=pu,Nt.prototype.commit=Co,Nt.prototype.next=Qo,Nt.prototype.plant=o,Nt.prototype.reverse=u,Nt.prototype.toJSON=Nt.prototype.valueOf=Nt.prototype.value=c,Nt.prototype.first=Nt.prototype.head,Cc&&(Nt.prototype[Cc]=bu),Nt},kc=Gc();H._=kc,D=function(){return kc}.call(fe,I,fe,Ne),D!==k&&(Ne.exports=D)}).call(this)},82492:function(Ne,fe,I){var D=I(42980),k=I(21463),m=k(function(ae,F,K){D(ae,F,K)});Ne.exports=m},7771:function(Ne,fe,I){var D=I(55639),k=function(){return D.Date.now()};Ne.exports=k},70479:function(Ne){function fe(){return[]}Ne.exports=fe},95062:function(Ne){function fe(){return!1}Ne.exports=fe},14841:function(Ne,fe,I){var D=I(4107),k=I(13218),m=I(33448),ae=0/0,F=/^[-+]0x[0-9a-f]+$/i,K=/^0b[01]+$/i,W=/^0o[0-7]+$/i,Y=parseInt;function G($){if(typeof $=="number")return $;if(m($))return ae;if(k($)){var xe=typeof $.valueOf=="function"?$.valueOf():$;$=k(xe)?xe+"":xe}if(typeof $!="string")return $===0?$:+$;$=D($);var Fe=K.test($);return Fe||W.test($)?Y($.slice(2),Fe?2:8):F.test($)?ae:+$}Ne.exports=G},59881:function(Ne,fe,I){var D=I(98363),k=I(81704);function m(ae){return D(ae,k(ae))}Ne.exports=m},6158:function(Ne){(function(fe,I){Ne.exports=I()})(this,function(){"use strict";var fe,I,D;function k(m,ae){if(!fe)fe=ae;else if(!I)I=ae;else{var F="var sharedChunk = {}; ("+fe+")(sharedChunk); ("+I+")(sharedChunk);",K={};fe(K),D=ae(K),typeof window!="undefined"&&(D.workerUrl=window.URL.createObjectURL(new Blob([F],{type:"text/javascript"})))}}return k(["exports"],function(m){"use strict";function ae(o,u){return o(u={exports:{}},u.exports),u.exports}var F=K;function K(o,u,c,y){this.cx=3*o,this.bx=3*(c-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(y-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=y,this.p2x=c,this.p2y=y}K.prototype.sampleCurveX=function(o){return((this.ax*o+this.bx)*o+this.cx)*o},K.prototype.sampleCurveY=function(o){return((this.ay*o+this.by)*o+this.cy)*o},K.prototype.sampleCurveDerivativeX=function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},K.prototype.solveCurveX=function(o,u){var c,y,C,R,z;for(u===void 0&&(u=1e-6),C=o,z=0;z<8;z++){if(R=this.sampleCurveX(C)-o,Math.abs(R)<u)return C;var Q=this.sampleCurveDerivativeX(C);if(Math.abs(Q)<1e-6)break;C-=R/Q}if((C=o)<(c=0))return c;if(C>(y=1))return y;for(;c<y;){if(R=this.sampleCurveX(C),Math.abs(R-o)<u)return C;o>R?c=C:y=C,C=.5*(y-c)+c}return C},K.prototype.solve=function(o,u){return this.sampleCurveY(this.solveCurveX(o,u))};var W=Y;function Y(o,u){this.x=o,this.y=u}Y.prototype={clone:function(){return new Y(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,u){return this.clone()._rotateAround(o,u)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var u=o.x-this.x,c=o.y-this.y;return u*u+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,u){return Math.atan2(this.x*u-this.y*o,this.x*o+this.y*u)},_matMult:function(o){var u=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=u,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var u=Math.cos(o),c=Math.sin(o),y=c*this.x+u*this.y;return this.x=u*this.x-c*this.y,this.y=y,this},_rotateAround:function(o,u){var c=Math.cos(o),y=Math.sin(o),C=u.y+y*(this.x-u.x)+c*(this.y-u.y);return this.x=u.x+c*(this.x-u.x)-y*(this.y-u.y),this.y=C,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Y.convert=function(o){return o instanceof Y?o:Array.isArray(o)?new Y(o[0],o[1]):o};var G=typeof self!="undefined"?self:{},$=Math.pow(2,53)-1;function xe(o,u,c,y){var C=new F(o,u,c,y);return function(R){return C.solve(R)}}var Fe=xe(.25,.1,.25,1);function Ce(o,u,c){return Math.min(c,Math.max(u,o))}function We(o,u,c){var y=c-u,C=((o-u)%y+y)%y+u;return C===u?c:C}function me(o){for(var u=[],c=arguments.length-1;c-- >0;)u[c]=arguments[c+1];for(var y=0,C=u;y<C.length;y+=1){var R=C[y];for(var z in R)o[z]=R[z]}return o}var Ge=1;function Ke(){return Ge++}function pt(){return function o(u){return u?(u^16*Math.random()>>u/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,o)}()}function Xe(o){return!!o&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)}function gt(o,u){o.forEach(function(c){u[c]&&(u[c]=u[c].bind(u))})}function ie(o,u){return o.indexOf(u,o.length-u.length)!==-1}function ft(o,u,c){var y={};for(var C in o)y[C]=u.call(c||this,o[C],C,o);return y}function ve(o,u,c){var y={};for(var C in o)u.call(c||this,o[C],C,o)&&(y[C]=o[C]);return y}function Ae(o){return Array.isArray(o)?o.map(Ae):typeof o=="object"&&o?ft(o,Ae):o}var Re={};function Ye(o){Re[o]||(typeof console!="undefined"&&console.warn(o),Re[o]=!0)}function at(o,u,c){return(c.y-o.y)*(u.x-o.x)>(u.y-o.y)*(c.x-o.x)}function ht(o){for(var u=0,c=0,y=o.length,C=y-1,R=void 0,z=void 0;c<y;C=c++)u+=((z=o[C]).x-(R=o[c]).x)*(R.y+z.y);return u}function Se(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Qe(o){var u={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(y,C,R,z){var Q=R||z;return u[C]=!Q||Q.toLowerCase(),""}),u["max-age"]){var c=parseInt(u["max-age"],10);isNaN(c)?delete u["max-age"]:u["max-age"]=c}return u}var oe=null;function ue(o){if(oe==null){var u=o.navigator?o.navigator.userAgent:null;oe=!!o.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return oe}function be(o){try{var u=G[o];return u.setItem("_mapbox_test_",1),u.removeItem("_mapbox_test_"),!0}catch(c){return!1}}var vt,bt,Ht,Er,Vt=G.performance&&G.performance.now?G.performance.now.bind(G.performance):Date.now.bind(Date),on=G.requestAnimationFrame||G.mozRequestAnimationFrame||G.webkitRequestAnimationFrame||G.msRequestAnimationFrame,hn=G.cancelAnimationFrame||G.mozCancelAnimationFrame||G.webkitCancelAnimationFrame||G.msCancelAnimationFrame,gi={now:Vt,frame:function(o){var u=on(o);return{cancel:function(){return hn(u)}}},getImageData:function(o,u){u===void 0&&(u=0);var c=G.document.createElement("canvas"),y=c.getContext("2d");if(!y)throw new Error("failed to create canvas 2d context");return c.width=o.width,c.height=o.height,y.drawImage(o,0,0,o.width,o.height),y.getImageData(-u,-u,o.width+2*u,o.height+2*u)},resolveURL:function(o){return vt||(vt=G.document.createElement("a")),vt.href=o,vt.href},hardwareConcurrency:G.navigator&&G.navigator.hardwareConcurrency||4,get devicePixelRatio(){return G.devicePixelRatio},get prefersReducedMotion(){return!!G.matchMedia&&(bt==null&&(bt=G.matchMedia("(prefers-reduced-motion: reduce)")),bt.matches)}},Hn={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Dt={supported:!1,testSupport:function(o){!Ea&&Er&&(Ze?ci(o):Ht=o)}},Ea=!1,Ze=!1;function ci(o){var u=o.createTexture();o.bindTexture(o.TEXTURE_2D,u);try{if(o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,Er),o.isContextLost())return;Dt.supported=!0}catch(c){}o.deleteTexture(u),Ea=!0}G.document&&((Er=G.document.createElement("img")).onload=function(){Ht&&ci(Ht),Ht=null,Ze=!0},Er.onerror=function(){Ea=!0,Ht=null},Er.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Ci="01",Oi=function(o,u){this._transformRequestFn=o,this._customAccessToken=u,this._createSkuToken()};function ea(o){return o.indexOf("mapbox:")===0}Oi.prototype._createSkuToken=function(){var o=function(){for(var u="",c=0;c<10;c++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ci,u].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt},Oi.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Oi.prototype.transformRequest=function(o,u){return this._transformRequestFn&&this._transformRequestFn(o,u)||{url:o}},Oi.prototype.normalizeStyleURL=function(o,u){if(!ea(o))return o;var c=Ii(o);return c.path="/styles/v1"+c.path,this._makeAPIURL(c,this._customAccessToken||u)},Oi.prototype.normalizeGlyphsURL=function(o,u){if(!ea(o))return o;var c=Ii(o);return c.path="/fonts/v1"+c.path,this._makeAPIURL(c,this._customAccessToken||u)},Oi.prototype.normalizeSourceURL=function(o,u){if(!ea(o))return o;var c=Ii(o);return c.path="/v4/"+c.authority+".json",c.params.push("secure"),this._makeAPIURL(c,this._customAccessToken||u)},Oi.prototype.normalizeSpriteURL=function(o,u,c,y){var C=Ii(o);return ea(o)?(C.path="/styles/v1"+C.path+"/sprite"+u+c,this._makeAPIURL(C,this._customAccessToken||y)):(C.path+=""+u+c,Ai(C))},Oi.prototype.normalizeTileURL=function(o,u){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!ea(o))return o;var c=Ii(o);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,(gi.devicePixelRatio>=2||u===512?"@2x":"")+(Dt.supported?".webp":"$1")),c.path=c.path.replace(/^.+\/v4\//,"/"),c.path="/v4"+c.path;var y=this._customAccessToken||function(C){for(var R=0,z=C;R<z.length;R+=1){var Q=z[R].match(/^access_token=(.*)$/);if(Q)return Q[1]}return null}(c.params)||Hn.ACCESS_TOKEN;return Hn.REQUIRE_ACCESS_TOKEN&&y&&this._skuToken&&c.params.push("sku="+this._skuToken),this._makeAPIURL(c,y)},Oi.prototype.canonicalizeTileURL=function(o,u){var c=Ii(o);if(!c.path.match(/(^\/v4\/)/)||!c.path.match(/\.[\w]+$/))return o;var y="mapbox://tiles/";y+=c.path.replace("/v4/","");var C=c.params;return u&&(C=C.filter(function(R){return!R.match(/^access_token=/)})),C.length&&(y+="?"+C.join("&")),y},Oi.prototype.canonicalizeTileset=function(o,u){for(var c=!!u&&ea(u),y=[],C=0,R=o.tiles||[];C<R.length;C+=1){var z=R[C];tn(z)?y.push(this.canonicalizeTileURL(z,c)):y.push(z)}return y},Oi.prototype._makeAPIURL=function(o,u){var c="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",y=Ii(Hn.API_URL);if(o.protocol=y.protocol,o.authority=y.authority,o.protocol==="http"){var C=o.params.indexOf("secure");C>=0&&o.params.splice(C,1)}if(y.path!=="/"&&(o.path=""+y.path+o.path),!Hn.REQUIRE_ACCESS_TOKEN)return Ai(o);if(!(u=u||Hn.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+c);if(u[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+c);return o.params=o.params.filter(function(R){return R.indexOf("access_token")===-1}),o.params.push("access_token="+u),Ai(o)};var fn=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function tn(o){return fn.test(o)}var da=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ii(o){var u=o.match(da);if(!u)throw new Error("Unable to parse URL object");return{protocol:u[1],authority:u[2],path:u[3]||"/",params:u[4]?u[4].split("&"):[]}}function Ai(o){var u=o.params.length?"?"+o.params.join("&"):"";return o.protocol+"://"+o.authority+o.path+u}function Pr(o){if(!o)return null;var u=o.split(".");if(!u||u.length!==3)return null;try{return JSON.parse(decodeURIComponent(G.atob(u[1]).split("").map(function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(c){return null}}var nt=function(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};nt.prototype.getStorageKey=function(o){var u,c=Pr(Hn.ACCESS_TOKEN);return u=c&&c.u?G.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,function(y,C){return String.fromCharCode(Number("0x"+C))})):Hn.ACCESS_TOKEN||"",o?"mapbox.eventData."+o+":"+u:"mapbox.eventData:"+u},nt.prototype.fetchEventData=function(){var o=be("localStorage"),u=this.getStorageKey(),c=this.getStorageKey("uuid");if(o)try{var y=G.localStorage.getItem(u);y&&(this.eventData=JSON.parse(y));var C=G.localStorage.getItem(c);C&&(this.anonId=C)}catch(R){Ye("Unable to read from LocalStorage")}},nt.prototype.saveEventData=function(){var o=be("localStorage"),u=this.getStorageKey(),c=this.getStorageKey("uuid");if(o)try{G.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&G.localStorage.setItem(u,JSON.stringify(this.eventData))}catch(y){Ye("Unable to write to LocalStorage")}},nt.prototype.processRequests=function(o){},nt.prototype.postEvent=function(o,u,c,y){var C=this;if(Hn.EVENTS_URL){var R=Ii(Hn.EVENTS_URL);R.params.push("access_token="+(y||Hn.ACCESS_TOKEN||""));var z={event:this.type,created:new Date(o).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:Ci,userId:this.anonId},Q=u?me(z,u):z,pe={url:Ai(R),headers:{"Content-Type":"text/plain"},body:JSON.stringify([Q])};this.pendingRequest=Ln(pe,function(Ie){C.pendingRequest=null,c(Ie),C.saveEventData(),C.processRequests(y)})}},nt.prototype.queueRequest=function(o,u){this.queue.push(o),this.processRequests(u)};var it,_t,we=function(o){function u(){o.call(this,"map.load"),this.success={},this.skuToken=""}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.postMapLoadEvent=function(c,y,C,R){this.skuToken=C;var z=!(!R&&!Hn.ACCESS_TOKEN),Q=Array.isArray(c)&&c.some(function(pe){return ea(pe)||tn(pe)});Hn.EVENTS_URL&&z&&Q&&this.queueRequest({id:y,timestamp:Date.now()},R)},u.prototype.processRequests=function(c){var y=this;if(!this.pendingRequest&&this.queue.length!==0){var C=this.queue.shift(),R=C.id,z=C.timestamp;R&&this.success[R]||(this.anonId||this.fetchEventData(),Xe(this.anonId)||(this.anonId=pt()),this.postEvent(z,{skuToken:this.skuToken},function(Q){Q||R&&(y.success[R]=!0)},c))}},u}(nt),er=new(function(o){function u(c){o.call(this,"appUserTurnstile"),this._customAccessToken=c}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.postTurnstileEvent=function(c,y){Hn.EVENTS_URL&&Hn.ACCESS_TOKEN&&Array.isArray(c)&&c.some(function(C){return ea(C)||tn(C)})&&this.queueRequest(Date.now(),y)},u.prototype.processRequests=function(c){var y=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var C=Pr(Hn.ACCESS_TOKEN),R=C?C.u:Hn.ACCESS_TOKEN,z=R!==this.eventData.tokenU;Xe(this.anonId)||(this.anonId=pt(),z=!0);var Q=this.queue.shift();if(this.eventData.lastSuccess){var pe=new Date(this.eventData.lastSuccess),Ie=new Date(Q),ze=(Q-this.eventData.lastSuccess)/864e5;z=z||ze>=1||ze<-1||pe.getDate()!==Ie.getDate()}else z=!0;if(!z)return this.processRequests();this.postEvent(Q,{"enabled.telemetry":!1},function(qe){qe||(y.eventData.lastSuccess=Q,y.eventData.tokenU=R)},c)}},u}(nt)),$r=er.postTurnstileEvent.bind(er),Fn=new we,Qt=Fn.postMapLoadEvent.bind(Fn),Br=500,bn=50;function gr(){G.caches&&!it&&(it=G.caches.open("mapbox-tiles"))}function pn(o){var u=o.indexOf("?");return u<0?o:o.slice(0,u)}var Sn,Dn=1/0;function ui(){return Sn==null&&(Sn=G.OffscreenCanvas&&new G.OffscreenCanvas(1,1).getContext("2d")&&typeof G.createImageBitmap=="function"),Sn}var di={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(di);var ca=function(o){function u(c,y,C){y===401&&tn(C)&&(c+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),o.call(this,c),this.status=y,this.url=C,this.name=this.constructor.name,this.message=c}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},u}(Error),Ni=Se()?function(){return self.worker&&self.worker.referrer}:function(){return(G.location.protocol==="blob:"?G.parent:G).location.href},Wa,Ba,Ia=function(o,u){if(!(/^file:/.test(c=o.url)||/^file:/.test(Ni())&&!/^\w+:/.test(c))){if(G.fetch&&G.Request&&G.AbortController&&G.Request.prototype.hasOwnProperty("signal"))return function(y,C){var R,z=new G.AbortController,Q=new G.Request(y.url,{method:y.method||"GET",body:y.body,credentials:y.credentials,headers:y.headers,referrer:Ni(),signal:z.signal}),pe=!1,Ie=!1,ze=(R=Q.url).indexOf("sku=")>0&&tn(R);y.type==="json"&&Q.headers.set("Accept","application/json");var qe=function(wt,or,sr){if(!Ie){if(wt&&wt.message!=="SecurityError"&&Ye(wt),or&&sr)return ut(or);var mr=Date.now();G.fetch(Q).then(function(yr){if(yr.ok){var rn=ze?yr.clone():null;return ut(yr,rn,mr)}return C(new ca(yr.statusText,yr.status,y.url))}).catch(function(yr){yr.code!==20&&C(new Error(yr.message))})}},ut=function(wt,or,sr){(y.type==="arrayBuffer"?wt.arrayBuffer():y.type==="json"?wt.json():wt.text()).then(function(mr){Ie||(or&&sr&&function(yr,rn,_n){if(gr(),it){var kn={status:rn.status,statusText:rn.statusText,headers:new G.Headers};rn.headers.forEach(function(pi,Xr){return kn.headers.set(Xr,pi)});var Nn=Qe(rn.headers.get("Cache-Control")||"");Nn["no-store"]||(Nn["max-age"]&&kn.headers.set("Expires",new Date(_n+1e3*Nn["max-age"]).toUTCString()),new Date(kn.headers.get("Expires")).getTime()-_n<42e4||function(pi,Xr){if(_t===void 0)try{new Response(new ReadableStream),_t=!0}catch(ua){_t=!1}_t?Xr(pi.body):pi.blob().then(Xr)}(rn,function(pi){var Xr=new G.Response(pi,kn);gr(),it&&it.then(function(ua){return ua.put(pn(yr.url),Xr)}).catch(function(ua){return Ye(ua.message)})}))}}(Q,or,sr),pe=!0,C(null,mr,wt.headers.get("Cache-Control"),wt.headers.get("Expires")))}).catch(function(mr){Ie||C(new Error(mr.message))})};return ze?function(wt,or){if(gr(),!it)return or(null);var sr=pn(wt.url);it.then(function(mr){mr.match(sr).then(function(yr){var rn=function(_n){if(!_n)return!1;var kn=new Date(_n.headers.get("Expires")||0),Nn=Qe(_n.headers.get("Cache-Control")||"");return kn>Date.now()&&!Nn["no-cache"]}(yr);mr.delete(sr),rn&&mr.put(sr,yr.clone()),or(null,yr,rn)}).catch(or)}).catch(or)}(Q,qe):qe(null,null),{cancel:function(){Ie=!0,pe||z.abort()}}}(o,u);if(Se()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,u,void 0,!0)}var c;return function(y,C){var R=new G.XMLHttpRequest;for(var z in R.open(y.method||"GET",y.url,!0),y.type==="arrayBuffer"&&(R.responseType="arraybuffer"),y.headers)R.setRequestHeader(z,y.headers[z]);return y.type==="json"&&(R.responseType="text",R.setRequestHeader("Accept","application/json")),R.withCredentials=y.credentials==="include",R.onerror=function(){C(new Error(R.statusText))},R.onload=function(){if((R.status>=200&&R.status<300||R.status===0)&&R.response!==null){var Q=R.response;if(y.type==="json")try{Q=JSON.parse(R.response)}catch(pe){return C(pe)}C(null,Q,R.getResponseHeader("Cache-Control"),R.getResponseHeader("Expires"))}else C(new ca(R.statusText,R.status,y.url))},R.send(y.body),{cancel:function(){return R.abort()}}}(o,u)},an=function(o,u){return Ia(me(o,{type:"arrayBuffer"}),u)},Ln=function(o,u){return Ia(me(o,{method:"POST"}),u)},re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Wa=[],Ba=0;var he=function(o,u){if(Dt.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),Ba>=Hn.MAX_PARALLEL_IMAGE_REQUESTS){var c={requestParameters:o,callback:u,cancelled:!1,cancel:function(){this.cancelled=!0}};return Wa.push(c),c}Ba++;var y=!1,C=function(){if(!y)for(y=!0,Ba--;Wa.length&&Ba<Hn.MAX_PARALLEL_IMAGE_REQUESTS;){var z=Wa.shift();z.cancelled||(z.cancel=he(z.requestParameters,z.callback).cancel)}},R=an(o,function(z,Q,pe,Ie){C(),z?u(z):Q&&(ui()?function(ze,qe){var ut=new G.Blob([new Uint8Array(ze)],{type:"image/png"});G.createImageBitmap(ut).then(function(wt){qe(null,wt)}).catch(function(wt){qe(new Error("Could not load image because of "+wt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(Q,u):function(ze,qe,ut,wt){var or=new G.Image,sr=G.URL;or.onload=function(){qe(null,or),sr.revokeObjectURL(or.src),or.onload=null,G.requestAnimationFrame(function(){or.src=re})},or.onerror=function(){return qe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var mr=new G.Blob([new Uint8Array(ze)],{type:"image/png"});or.cacheControl=ut,or.expires=wt,or.src=ze.byteLength?sr.createObjectURL(mr):re}(Q,u,pe,Ie))});return{cancel:function(){R.cancel(),C()}}};function V(o,u,c){c[o]&&c[o].indexOf(u)!==-1||(c[o]=c[o]||[],c[o].push(u))}function Et(o,u,c){if(c&&c[o]){var y=c[o].indexOf(u);y!==-1&&c[o].splice(y,1)}}var Bt=function(o,u){u===void 0&&(u={}),me(this,u),this.type=o},Le=function(o){function u(c,y){y===void 0&&(y={}),o.call(this,"error",me({error:c},y))}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u}(Bt),St=function(){};St.prototype.on=function(o,u){return this._listeners=this._listeners||{},V(o,u,this._listeners),this},St.prototype.off=function(o,u){return Et(o,u,this._listeners),Et(o,u,this._oneTimeListeners),this},St.prototype.once=function(o,u){return this._oneTimeListeners=this._oneTimeListeners||{},V(o,u,this._oneTimeListeners),this},St.prototype.fire=function(o,u){typeof o=="string"&&(o=new Bt(o,u||{}));var c=o.type;if(this.listens(c)){o.target=this;for(var y=0,C=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];y<C.length;y+=1)C[y].call(this,o);for(var R=0,z=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];R<z.length;R+=1){var Q=z[R];Et(c,Q,this._oneTimeListeners),Q.call(this,o)}var pe=this._eventedParent;pe&&(me(o,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),pe.fire(o))}else o instanceof Le&&console.error(o.error);return this},St.prototype.listens=function(o){return this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o)},St.prototype.setEventedParent=function(o,u){return this._eventedParent=o,this._eventedParentData=u,this};var tt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},At=function(o,u,c,y){this.message=(o?o+": ":"")+c,y&&(this.identifier=y),u!=null&&u.__line__&&(this.line=u.__line__)};function tr(o){var u=o.value;return u?[new At(o.key,u,"constants have been deprecated as of v8")]:[]}function en(o){for(var u=[],c=arguments.length-1;c-- >0;)u[c]=arguments[c+1];for(var y=0,C=u;y<C.length;y+=1){var R=C[y];for(var z in R)o[z]=R[z]}return o}function Kr(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function Ft(o){if(Array.isArray(o))return o.map(Ft);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){var u={};for(var c in o)u[c]=Ft(o[c]);return u}return Kr(o)}var rr=function(o){function u(c,y){o.call(this,y),this.message=y,this.key=c}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u}(Error),ot=function(o,u){u===void 0&&(u=[]),this.parent=o,this.bindings={};for(var c=0,y=u;c<y.length;c+=1){var C=y[c];this.bindings[C[0]]=C[1]}};ot.prototype.concat=function(o){return new ot(this,o)},ot.prototype.get=function(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(o+" not found in scope.")},ot.prototype.has=function(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)};var Li={kind:"null"},Hr={kind:"number"},_i={kind:"string"},vi={kind:"boolean"},It={kind:"color"},Yr={kind:"object"},Dr={kind:"value"},Jn={kind:"collator"},Kt={kind:"formatted"},hr={kind:"resolvedImage"};function Fr(o,u){return{kind:"array",itemType:o,N:u}}function qr(o){if(o.kind==="array"){var u=qr(o.itemType);return typeof o.N=="number"?"array<"+u+", "+o.N+">":o.itemType.kind==="value"?"array":"array<"+u+">"}return o.kind}var An=[Li,Hr,_i,vi,It,Kt,Yr,Fr(Dr),hr];function Ui(o,u){if(u.kind==="error")return null;if(o.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!Ui(o.itemType,u.itemType))&&(typeof o.N!="number"||o.N===u.N))return null}else{if(o.kind===u.kind)return null;if(o.kind==="value"){for(var c=0,y=An;c<y.length;c+=1)if(!Ui(y[c],u))return null}}return"Expected "+qr(o)+" but found "+qr(u)+" instead."}function fa(o,u){return u.some(function(c){return c.kind===o.kind})}function Wi(o,u){return u.some(function(c){return c==="null"?o===null:c==="array"?Array.isArray(o):c==="object"?o&&!Array.isArray(o)&&typeof o=="object":c===typeof o})}var ct=ae(function(o,u){var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function y(Q){return(Q=Math.round(Q))<0?0:Q>255?255:Q}function C(Q){return y(Q[Q.length-1]==="%"?parseFloat(Q)/100*255:parseInt(Q))}function R(Q){return(pe=Q[Q.length-1]==="%"?parseFloat(Q)/100:parseFloat(Q))<0?0:pe>1?1:pe;var pe}function z(Q,pe,Ie){return Ie<0?Ie+=1:Ie>1&&(Ie-=1),6*Ie<1?Q+(pe-Q)*Ie*6:2*Ie<1?pe:3*Ie<2?Q+(pe-Q)*(2/3-Ie)*6:Q}try{u.parseCSSColor=function(Q){var pe,Ie=Q.replace(/ /g,"").toLowerCase();if(Ie in c)return c[Ie].slice();if(Ie[0]==="#")return Ie.length===4?(pe=parseInt(Ie.substr(1),16))>=0&&pe<=4095?[(3840&pe)>>4|(3840&pe)>>8,240&pe|(240&pe)>>4,15&pe|(15&pe)<<4,1]:null:Ie.length===7&&(pe=parseInt(Ie.substr(1),16))>=0&&pe<=16777215?[(16711680&pe)>>16,(65280&pe)>>8,255&pe,1]:null;var ze=Ie.indexOf("("),qe=Ie.indexOf(")");if(ze!==-1&&qe+1===Ie.length){var ut=Ie.substr(0,ze),wt=Ie.substr(ze+1,qe-(ze+1)).split(","),or=1;switch(ut){case"rgba":if(wt.length!==4)return null;or=R(wt.pop());case"rgb":return wt.length!==3?null:[C(wt[0]),C(wt[1]),C(wt[2]),or];case"hsla":if(wt.length!==4)return null;or=R(wt.pop());case"hsl":if(wt.length!==3)return null;var sr=(parseFloat(wt[0])%360+360)%360/360,mr=R(wt[1]),yr=R(wt[2]),rn=yr<=.5?yr*(mr+1):yr+mr-yr*mr,_n=2*yr-rn;return[y(255*z(_n,rn,sr+1/3)),y(255*z(_n,rn,sr)),y(255*z(_n,rn,sr-1/3)),or];default:return null}}return null}}catch(Q){}}).parseCSSColor,qi=function(o,u,c,y){y===void 0&&(y=1),this.r=o,this.g=u,this.b=c,this.a=y};qi.parse=function(o){if(o){if(o instanceof qi)return o;if(typeof o=="string"){var u=ct(o);if(u)return new qi(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3])}}},qi.prototype.toString=function(){var o=this.toArray(),u=o[1],c=o[2],y=o[3];return"rgba("+Math.round(o[0])+","+Math.round(u)+","+Math.round(c)+","+y+")"},qi.prototype.toArray=function(){var o=this.a;return o===0?[0,0,0,0]:[255*this.r/o,255*this.g/o,255*this.b/o,o]},qi.black=new qi(0,0,0,1),qi.white=new qi(1,1,1,1),qi.transparent=new qi(0,0,0,0),qi.red=new qi(1,0,0,1);var Na=function(o,u,c){this.sensitivity=o?u?"variant":"case":u?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Na.prototype.compare=function(o,u){return this.collator.compare(o,u)},Na.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var To=function(o,u,c,y,C){this.text=o,this.image=u,this.scale=c,this.fontStack=y,this.textColor=C},ao=function(o){this.sections=o};ao.fromString=function(o){return new ao([new To(o,null,null,null,null)])},ao.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(o){return o.text.length!==0||o.image&&o.image.name.length!==0})},ao.factory=function(o){return o instanceof ao?o:ao.fromString(o)},ao.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(o){return o.text}).join("")},ao.prototype.serialize=function(){for(var o=["format"],u=0,c=this.sections;u<c.length;u+=1){var y=c[u];if(y.image)o.push(["image",y.image.name]);else{o.push(y.text);var C={};y.fontStack&&(C["text-font"]=["literal",y.fontStack.split(",")]),y.scale&&(C["font-scale"]=y.scale),y.textColor&&(C["text-color"]=["rgba"].concat(y.textColor.toArray())),o.push(C)}}return o};var Ga=function(o){this.name=o.name,this.available=o.available};function Ko(o,u,c,y){return typeof o=="number"&&o>=0&&o<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof c=="number"&&c>=0&&c<=255?y===void 0||typeof y=="number"&&y>=0&&y<=1?null:"Invalid rgba value ["+[o,u,c,y].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof y=="number"?[o,u,c,y]:[o,u,c]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ws(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof qi||o instanceof Na||o instanceof ao||o instanceof Ga)return!0;if(Array.isArray(o)){for(var u=0,c=o;u<c.length;u+=1)if(!ws(c[u]))return!1;return!0}if(typeof o=="object"){for(var y in o)if(!ws(o[y]))return!1;return!0}return!1}function Fo(o){if(o===null)return Li;if(typeof o=="string")return _i;if(typeof o=="boolean")return vi;if(typeof o=="number")return Hr;if(o instanceof qi)return It;if(o instanceof Na)return Jn;if(o instanceof ao)return Kt;if(o instanceof Ga)return hr;if(Array.isArray(o)){for(var u,c=o.length,y=0,C=o;y<C.length;y+=1){var R=Fo(C[y]);if(u){if(u===R)continue;u=Dr;break}u=R}return Fr(u||Dr,c)}return Yr}function su(o){var u=typeof o;return o===null?"":u==="string"||u==="number"||u==="boolean"?String(o):o instanceof qi||o instanceof ao||o instanceof Ga?o.toString():JSON.stringify(o)}Ga.prototype.toString=function(){return this.name},Ga.fromString=function(o){return o?new Ga({name:o,available:!1}):null},Ga.prototype.serialize=function(){return["image",this.name]};var zo=function(o,u){this.type=o,this.value=u};zo.parse=function(o,u){if(o.length!==2)return u.error("'literal' expression requires exactly one argument, but found "+(o.length-1)+" instead.");if(!ws(o[1]))return u.error("invalid value");var c=o[1],y=Fo(c),C=u.expectedType;return y.kind!=="array"||y.N!==0||!C||C.kind!=="array"||typeof C.N=="number"&&C.N!==0||(y=C),new zo(y,c)},zo.prototype.evaluate=function(){return this.value},zo.prototype.eachChild=function(){},zo.prototype.outputDefined=function(){return!0},zo.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof qi?["rgba"].concat(this.value.toArray()):this.value instanceof ao?this.value.serialize():this.value};var ns=function(o){this.name="ExpressionEvaluationError",this.message=o};ns.prototype.toJSON=function(){return this.message};var ls={string:_i,number:Hr,boolean:vi,object:Yr},_o=function(o,u){this.type=o,this.args=u};_o.parse=function(o,u){if(o.length<2)return u.error("Expected at least one argument.");var c,y=1,C=o[0];if(C==="array"){var R,z;if(o.length>2){var Q=o[1];if(typeof Q!="string"||!(Q in ls)||Q==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);R=ls[Q],y++}else R=Dr;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return u.error('The length argument to "array" must be a positive integer literal',2);z=o[2],y++}c=Fr(R,z)}else c=ls[C];for(var pe=[];y<o.length;y++){var Ie=u.parse(o[y],y,Dr);if(!Ie)return null;pe.push(Ie)}return new _o(c,pe)},_o.prototype.evaluate=function(o){for(var u=0;u<this.args.length;u++){var c=this.args[u].evaluate(o);if(!Ui(this.type,Fo(c)))return c;if(u===this.args.length-1)throw new ns("Expected value to be of type "+qr(this.type)+", but found "+qr(Fo(c))+" instead.")}return null},_o.prototype.eachChild=function(o){this.args.forEach(o)},_o.prototype.outputDefined=function(){return this.args.every(function(o){return o.outputDefined()})},_o.prototype.serialize=function(){var o=this.type,u=[o.kind];if(o.kind==="array"){var c=o.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){u.push(c.kind);var y=o.N;(typeof y=="number"||this.args.length>1)&&u.push(y)}}return u.concat(this.args.map(function(C){return C.serialize()}))};var Po=function(o){this.type=Kt,this.sections=o};Po.parse=function(o,u){if(o.length<2)return u.error("Expected at least one argument.");var c=o[1];if(!Array.isArray(c)&&typeof c=="object")return u.error("First argument must be an image or text section.");for(var y=[],C=!1,R=1;R<=o.length-1;++R){var z=o[R];if(C&&typeof z=="object"&&!Array.isArray(z)){C=!1;var Q=null;if(z["font-scale"]&&!(Q=u.parse(z["font-scale"],1,Hr)))return null;var pe=null;if(z["text-font"]&&!(pe=u.parse(z["text-font"],1,Fr(_i))))return null;var Ie=null;if(z["text-color"]&&!(Ie=u.parse(z["text-color"],1,It)))return null;var ze=y[y.length-1];ze.scale=Q,ze.font=pe,ze.textColor=Ie}else{var qe=u.parse(o[R],1,Dr);if(!qe)return null;var ut=qe.type.kind;if(ut!=="string"&&ut!=="value"&&ut!=="null"&&ut!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,y.push({content:qe,scale:null,font:null,textColor:null})}}return new Po(y)},Po.prototype.evaluate=function(o){return new ao(this.sections.map(function(u){var c=u.content.evaluate(o);return Fo(c)===hr?new To("",c,null,null,null):new To(su(c),null,u.scale?u.scale.evaluate(o):null,u.font?u.font.evaluate(o).join(","):null,u.textColor?u.textColor.evaluate(o):null)}))},Po.prototype.eachChild=function(o){for(var u=0,c=this.sections;u<c.length;u+=1){var y=c[u];o(y.content),y.scale&&o(y.scale),y.font&&o(y.font),y.textColor&&o(y.textColor)}},Po.prototype.outputDefined=function(){return!1},Po.prototype.serialize=function(){for(var o=["format"],u=0,c=this.sections;u<c.length;u+=1){var y=c[u];o.push(y.content.serialize());var C={};y.scale&&(C["font-scale"]=y.scale.serialize()),y.font&&(C["text-font"]=y.font.serialize()),y.textColor&&(C["text-color"]=y.textColor.serialize()),o.push(C)}return o};var Ss=function(o){this.type=hr,this.input=o};Ss.parse=function(o,u){if(o.length!==2)return u.error("Expected two arguments.");var c=u.parse(o[1],1,_i);return c?new Ss(c):u.error("No image name provided.")},Ss.prototype.evaluate=function(o){var u=this.input.evaluate(o),c=Ga.fromString(u);return c&&o.availableImages&&(c.available=o.availableImages.indexOf(u)>-1),c},Ss.prototype.eachChild=function(o){o(this.input)},Ss.prototype.outputDefined=function(){return!1},Ss.prototype.serialize=function(){return["image",this.input.serialize()]};var Wu={"to-boolean":vi,"to-color":It,"to-number":Hr,"to-string":_i},$s=function(o,u){this.type=o,this.args=u};$s.parse=function(o,u){if(o.length<2)return u.error("Expected at least one argument.");var c=o[0];if((c==="to-boolean"||c==="to-string")&&o.length!==2)return u.error("Expected one argument.");for(var y=Wu[c],C=[],R=1;R<o.length;R++){var z=u.parse(o[R],R,Dr);if(!z)return null;C.push(z)}return new $s(y,C)},$s.prototype.evaluate=function(o){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(o));if(this.type.kind==="color"){for(var u,c,y=0,C=this.args;y<C.length;y+=1){if(c=null,(u=C[y].evaluate(o))instanceof qi)return u;if(typeof u=="string"){var R=o.parseColor(u);if(R)return R}else if(Array.isArray(u)&&!(c=u.length<3||u.length>4?"Invalid rbga value "+JSON.stringify(u)+": expected an array containing either three or four numeric values.":Ko(u[0],u[1],u[2],u[3])))return new qi(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new ns(c||"Could not parse color from value '"+(typeof u=="string"?u:String(JSON.stringify(u)))+"'")}if(this.type.kind==="number"){for(var z=null,Q=0,pe=this.args;Q<pe.length;Q+=1){if((z=pe[Q].evaluate(o))===null)return 0;var Ie=Number(z);if(!isNaN(Ie))return Ie}throw new ns("Could not convert "+JSON.stringify(z)+" to number.")}return this.type.kind==="formatted"?ao.fromString(su(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?Ga.fromString(su(this.args[0].evaluate(o))):su(this.args[0].evaluate(o))},$s.prototype.eachChild=function(o){this.args.forEach(o)},$s.prototype.outputDefined=function(){return this.args.every(function(o){return o.outputDefined()})},$s.prototype.serialize=function(){if(this.type.kind==="formatted")return new Po([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ss(this.args[0]).serialize();var o=["to-"+this.type.kind];return this.eachChild(function(u){o.push(u.serialize())}),o};var uu=["Unknown","Point","LineString","Polygon"],Jo=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Jo.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Jo.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?uu[this.feature.type]:this.feature.type:null},Jo.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Jo.prototype.canonicalID=function(){return this.canonical},Jo.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Jo.prototype.parseColor=function(o){var u=this._parseColorCache[o];return u||(u=this._parseColorCache[o]=qi.parse(o)),u};var ms=function(o,u,c,y){this.name=o,this.type=u,this._evaluate=c,this.args=y};ms.prototype.evaluate=function(o){return this._evaluate(o,this.args)},ms.prototype.eachChild=function(o){this.args.forEach(o)},ms.prototype.outputDefined=function(){return!1},ms.prototype.serialize=function(){return[this.name].concat(this.args.map(function(o){return o.serialize()}))},ms.parse=function(o,u){var c,y=o[0],C=ms.definitions[y];if(!C)return u.error('Unknown expression "'+y+'". If you wanted a literal array, use ["literal", [...]].',0);for(var R=Array.isArray(C)?C[0]:C.type,z=Array.isArray(C)?[[C[1],C[2]]]:C.overloads,Q=z.filter(function($i){var ki=$i[0];return!Array.isArray(ki)||ki.length===o.length-1}),pe=null,Ie=0,ze=Q;Ie<ze.length;Ie+=1){var qe=ze[Ie],ut=qe[0],wt=qe[1];pe=new Tr(u.registry,u.path,null,u.scope);for(var or=[],sr=!1,mr=1;mr<o.length;mr++){var yr=o[mr],rn=Array.isArray(ut)?ut[mr-1]:ut.type,_n=pe.parse(yr,1+or.length,rn);if(!_n){sr=!0;break}or.push(_n)}if(!sr)if(Array.isArray(ut)&&ut.length!==or.length)pe.error("Expected "+ut.length+" arguments, but found "+or.length+" instead.");else{for(var kn=0;kn<or.length;kn++){var Nn=Array.isArray(ut)?ut[kn]:ut.type,pi=or[kn];pe.concat(kn+1).checkSubtype(Nn,pi.type)}if(pe.errors.length===0)return new ms(y,R,wt,or)}}if(Q.length===1)(c=u.errors).push.apply(c,pe.errors);else{for(var Xr=(Q.length?Q:z).map(function($i){var ki;return ki=$i[0],Array.isArray(ki)?"("+ki.map(qr).join(", ")+")":"("+qr(ki.type)+"...)"}).join(" | "),ua=[],Ir=1;Ir<o.length;Ir++){var vn=u.parse(o[Ir],1+ua.length);if(!vn)return null;ua.push(qr(vn.type))}u.error("Expected arguments of type "+Xr+", but found ("+ua.join(", ")+") instead.")}return null},ms.register=function(o,u){for(var c in ms.definitions=u,u)o[c]=ms};var eu=function(o,u,c){this.type=Jn,this.locale=c,this.caseSensitive=o,this.diacriticSensitive=u};function Bs(o,u){o[0]=Math.min(o[0],u[0]),o[1]=Math.min(o[1],u[1]),o[2]=Math.max(o[2],u[0]),o[3]=Math.max(o[3],u[1])}function fi(o,u){return!(o[0]<=u[0]||o[2]>=u[2]||o[1]<=u[1]||o[3]>=u[3])}function is(o,u){var c=(180+o[0])/360,y=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,C=Math.pow(2,u.z);return[Math.round(c*C*8192),Math.round(y*C*8192)]}function ku(o,u,c){return u[1]>o[1]!=c[1]>o[1]&&o[0]<(c[0]-u[0])*(o[1]-u[1])/(c[1]-u[1])+u[0]}function mt(o,u){for(var c,y,C,R,z,Q,pe,Ie=!1,ze=0,qe=u.length;ze<qe;ze++)for(var ut=u[ze],wt=0,or=ut.length;wt<or-1;wt++){if((R=(c=o)[0]-(y=ut[wt])[0])*(pe=c[1]-(C=ut[wt+1])[1])-(Q=c[0]-C[0])*(z=c[1]-y[1])==0&&R*Q<=0&&z*pe<=0)return!1;ku(o,ut[wt],ut[wt+1])&&(Ie=!Ie)}return Ie}function Gt(o,u){for(var c=0;c<u.length;c++)if(mt(o,u[c]))return!0;return!1}function Cr(o,u,c,y){var C=y[0]-c[0],R=y[1]-c[1],z=(o[0]-c[0])*R-C*(o[1]-c[1]),Q=(u[0]-c[0])*R-C*(u[1]-c[1]);return z>0&&Q<0||z<0&&Q>0}function Rr(o,u,c){for(var y=0,C=c;y<C.length;y+=1)for(var R=C[y],z=0;z<R.length-1;++z)if((qe=[(ze=R[z+1])[0]-(Ie=R[z])[0],ze[1]-Ie[1]])[0]*(ut=[(pe=u)[0]-(Q=o)[0],pe[1]-Q[1]])[1]-qe[1]*ut[0]!=0&&Cr(Q,pe,Ie,ze)&&Cr(Ie,ze,Q,pe))return!0;var Q,pe,Ie,ze,qe,ut;return!1}function ji(o,u){for(var c=0;c<o.length;++c)if(!mt(o[c],u))return!1;for(var y=0;y<o.length-1;++y)if(Rr(o[y],o[y+1],u))return!1;return!0}function Pa(o,u){for(var c=0;c<u.length;c++)if(ji(o,u[c]))return!0;return!1}function Yt(o,u,c){for(var y=[],C=0;C<o.length;C++){for(var R=[],z=0;z<o[C].length;z++){var Q=is(o[C][z],c);Bs(u,Q),R.push(Q)}y.push(R)}return y}function De(o,u,c){for(var y=[],C=0;C<o.length;C++){var R=Yt(o[C],u,c);y.push(R)}return y}function Me(o,u,c,y){if(o[0]<c[0]||o[0]>c[2]){var C=.5*y,R=o[0]-c[0]>C?-y:c[0]-o[0]>C?y:0;R===0&&(R=o[0]-c[2]>C?-y:c[2]-o[0]>C?y:0),o[0]+=R}Bs(u,o)}function ce(o,u,c,y){for(var C=8192*Math.pow(2,y.z),R=[8192*y.x,8192*y.y],z=[],Q=0,pe=o;Q<pe.length;Q+=1)for(var Ie=0,ze=pe[Q];Ie<ze.length;Ie+=1){var qe=ze[Ie],ut=[qe.x+R[0],qe.y+R[1]];Me(ut,u,c,C),z.push(ut)}return z}function He(o,u,c,y){for(var C,R=8192*Math.pow(2,y.z),z=[8192*y.x,8192*y.y],Q=[],pe=0,Ie=o;pe<Ie.length;pe+=1){for(var ze=[],qe=0,ut=Ie[pe];qe<ut.length;qe+=1){var wt=ut[qe],or=[wt.x+z[0],wt.y+z[1]];Bs(u,or),ze.push(or)}Q.push(ze)}if(u[2]-u[0]<=R/2){(C=u)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(var sr=0,mr=Q;sr<mr.length;sr+=1)for(var yr=0,rn=mr[sr];yr<rn.length;yr+=1)Me(rn[yr],u,c,R)}return Q}eu.parse=function(o,u){if(o.length!==2)return u.error("Expected one argument.");var c=o[1];if(typeof c!="object"||Array.isArray(c))return u.error("Collator options argument must be an object.");var y=u.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,vi);if(!y)return null;var C=u.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,vi);if(!C)return null;var R=null;return c.locale&&!(R=u.parse(c.locale,1,_i))?null:new eu(y,C,R)},eu.prototype.evaluate=function(o){return new Na(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)},eu.prototype.eachChild=function(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)},eu.prototype.outputDefined=function(){return!1},eu.prototype.serialize=function(){var o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]};var Pe=function(o,u){this.type=vi,this.geojson=o,this.geometries=u};function Tt(o){if(o instanceof ms&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof Pe)return!1;var u=!0;return o.eachChild(function(c){u&&!Tt(c)&&(u=!1)}),u}function Mt(o){if(o instanceof ms&&o.name==="feature-state")return!1;var u=!0;return o.eachChild(function(c){u&&!Mt(c)&&(u=!1)}),u}function $t(o,u){if(o instanceof ms&&u.indexOf(o.name)>=0)return!1;var c=!0;return o.eachChild(function(y){c&&!$t(y,u)&&(c=!1)}),c}Pe.parse=function(o,u){if(o.length!==2)return u.error("'within' expression requires exactly one argument, but found "+(o.length-1)+" instead.");if(ws(o[1])){var c=o[1];if(c.type==="FeatureCollection")for(var y=0;y<c.features.length;++y){var C=c.features[y].geometry.type;if(C==="Polygon"||C==="MultiPolygon")return new Pe(c,c.features[y].geometry)}else if(c.type==="Feature"){var R=c.geometry.type;if(R==="Polygon"||R==="MultiPolygon")return new Pe(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new Pe(c,c)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Pe.prototype.evaluate=function(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(u,c){var y=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],R=u.canonicalID();if(c.type==="Polygon"){var z=Yt(c.coordinates,C,R),Q=ce(u.geometry(),y,C,R);if(!fi(y,C))return!1;for(var pe=0,Ie=Q;pe<Ie.length;pe+=1)if(!mt(Ie[pe],z))return!1}if(c.type==="MultiPolygon"){var ze=De(c.coordinates,C,R),qe=ce(u.geometry(),y,C,R);if(!fi(y,C))return!1;for(var ut=0,wt=qe;ut<wt.length;ut+=1)if(!Gt(wt[ut],ze))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(u,c){var y=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],R=u.canonicalID();if(c.type==="Polygon"){var z=Yt(c.coordinates,C,R),Q=He(u.geometry(),y,C,R);if(!fi(y,C))return!1;for(var pe=0,Ie=Q;pe<Ie.length;pe+=1)if(!ji(Ie[pe],z))return!1}if(c.type==="MultiPolygon"){var ze=De(c.coordinates,C,R),qe=He(u.geometry(),y,C,R);if(!fi(y,C))return!1;for(var ut=0,wt=qe;ut<wt.length;ut+=1)if(!Pa(wt[ut],ze))return!1}return!0}(o,this.geometries)}return!1},Pe.prototype.eachChild=function(){},Pe.prototype.outputDefined=function(){return!0},Pe.prototype.serialize=function(){return["within",this.geojson]};var fr=function(o,u){this.type=u.type,this.name=o,this.boundExpression=u};fr.parse=function(o,u){if(o.length!==2||typeof o[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");var c=o[1];return u.scope.has(c)?new fr(c,u.scope.get(c)):u.error('Unknown variable "'+c+'". Make sure "'+c+'" has been bound in an enclosing "let" expression before using it.',1)},fr.prototype.evaluate=function(o){return this.boundExpression.evaluate(o)},fr.prototype.eachChild=function(){},fr.prototype.outputDefined=function(){return!1},fr.prototype.serialize=function(){return["var",this.name]};var Tr=function(o,u,c,y,C){u===void 0&&(u=[]),y===void 0&&(y=new ot),C===void 0&&(C=[]),this.registry=o,this.path=u,this.key=u.map(function(R){return"["+R+"]"}).join(""),this.scope=y,this.errors=C,this.expectedType=c};function Sr(o,u){for(var c,y=o.length-1,C=0,R=y,z=0;C<=R;)if((c=o[z=Math.floor((C+R)/2)])<=u){if(z===y||u<o[z+1])return z;C=z+1}else{if(!(c>u))throw new ns("Input is not a number.");R=z-1}return 0}Tr.prototype.parse=function(o,u,c,y,C){return C===void 0&&(C={}),u?this.concat(u,c,y)._parse(o,C):this._parse(o,C)},Tr.prototype._parse=function(o,u){function c(Ie,ze,qe){return qe==="assert"?new _o(ze,[Ie]):qe==="coerce"?new $s(ze,[Ie]):Ie}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var y=o[0];if(typeof y!="string")return this.error("Expression name must be a string, but found "+typeof y+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var C=this.registry[y];if(C){var R=C.parse(o,this);if(!R)return null;if(this.expectedType){var z=this.expectedType,Q=R.type;if(z.kind!=="string"&&z.kind!=="number"&&z.kind!=="boolean"&&z.kind!=="object"&&z.kind!=="array"||Q.kind!=="value")if(z.kind!=="color"&&z.kind!=="formatted"&&z.kind!=="resolvedImage"||Q.kind!=="value"&&Q.kind!=="string"){if(this.checkSubtype(z,Q))return null}else R=c(R,z,u.typeAnnotation||"coerce");else R=c(R,z,u.typeAnnotation||"assert")}if(!(R instanceof zo)&&R.type.kind!=="resolvedImage"&&function Ie(ze){if(ze instanceof fr)return Ie(ze.boundExpression);if(ze instanceof ms&&ze.name==="error"||ze instanceof eu||ze instanceof Pe)return!1;var qe=ze instanceof $s||ze instanceof _o,ut=!0;return ze.eachChild(function(wt){ut=qe?ut&&Ie(wt):ut&&wt instanceof zo}),!!ut&&Tt(ze)&&$t(ze,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(R)){var pe=new Jo;try{R=new zo(R.type,R.evaluate(pe))}catch(Ie){return this.error(Ie.message),null}}return R}return this.error('Unknown expression "'+y+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof o+" instead.")},Tr.prototype.concat=function(o,u,c){var y=typeof o=="number"?this.path.concat(o):this.path,C=c?this.scope.concat(c):this.scope;return new Tr(this.registry,y,u||null,C,this.errors)},Tr.prototype.error=function(o){for(var u=[],c=arguments.length-1;c-- >0;)u[c]=arguments[c+1];var y=""+this.key+u.map(function(C){return"["+C+"]"}).join("");this.errors.push(new rr(y,o))},Tr.prototype.checkSubtype=function(o,u){var c=Ui(o,u);return c&&this.error(c),c};var sn=function(o,u,c){this.type=o,this.input=u,this.labels=[],this.outputs=[];for(var y=0,C=c;y<C.length;y+=1){var R=C[y],z=R[1];this.labels.push(R[0]),this.outputs.push(z)}};function lt(o,u,c){return o*(1-c)+u*c}sn.parse=function(o,u){if(o.length-1<4)return u.error("Expected at least 4 arguments, but found only "+(o.length-1)+".");if((o.length-1)%2!=0)return u.error("Expected an even number of arguments.");var c=u.parse(o[1],1,Hr);if(!c)return null;var y=[],C=null;u.expectedType&&u.expectedType.kind!=="value"&&(C=u.expectedType);for(var R=1;R<o.length;R+=2){var z=R===1?-1/0:o[R],Q=o[R+1],pe=R,Ie=R+1;if(typeof z!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',pe);if(y.length&&y[y.length-1][0]>=z)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',pe);var ze=u.parse(Q,Ie,C);if(!ze)return null;C=C||ze.type,y.push([z,ze])}return new sn(C,c,y)},sn.prototype.evaluate=function(o){var u=this.labels,c=this.outputs;if(u.length===1)return c[0].evaluate(o);var y=this.input.evaluate(o);if(y<=u[0])return c[0].evaluate(o);var C=u.length;return y>=u[C-1]?c[C-1].evaluate(o):c[Sr(u,y)].evaluate(o)},sn.prototype.eachChild=function(o){o(this.input);for(var u=0,c=this.outputs;u<c.length;u+=1)o(c[u])},sn.prototype.outputDefined=function(){return this.outputs.every(function(o){return o.outputDefined()})},sn.prototype.serialize=function(){for(var o=["step",this.input.serialize()],u=0;u<this.labels.length;u++)u>0&&o.push(this.labels[u]),o.push(this.outputs[u].serialize());return o};var Xt=Object.freeze({__proto__:null,number:lt,color:function(o,u,c){return new qi(lt(o.r,u.r,c),lt(o.g,u.g,c),lt(o.b,u.b,c),lt(o.a,u.a,c))},array:function(o,u,c){return o.map(function(y,C){return lt(y,u[C],c)})}}),nr=6/29*3*(6/29),ur=Math.PI/180,Vr=180/Math.PI;function ln(o){return o>.008856451679035631?Math.pow(o,1/3):o/nr+4/29}function Un(o){return o>6/29?o*o*o:nr*(o-4/29)}function Gn(o){return 255*(o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055)}function qn(o){return(o/=255)<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function oi(o){var u=qn(o.r),c=qn(o.g),y=qn(o.b),C=ln((.4124564*u+.3575761*c+.1804375*y)/.95047),R=ln((.2126729*u+.7151522*c+.072175*y)/1);return{l:116*R-16,a:500*(C-R),b:200*(R-ln((.0193339*u+.119192*c+.9503041*y)/1.08883)),alpha:o.a}}function T(o){var u=(o.l+16)/116,c=isNaN(o.a)?u:u+o.a/500,y=isNaN(o.b)?u:u-o.b/200;return u=1*Un(u),c=.95047*Un(c),y=1.08883*Un(y),new qi(Gn(3.2404542*c-1.5371385*u-.4985314*y),Gn(-.969266*c+1.8760108*u+.041556*y),Gn(.0556434*c-.2040259*u+1.0572252*y),o.alpha)}function H(o,u,c){var y=u-o;return o+c*(y>180||y<-180?y-360*Math.round(y/360):y)}var _e={forward:oi,reverse:T,interpolate:function(o,u,c){return{l:lt(o.l,u.l,c),a:lt(o.a,u.a,c),b:lt(o.b,u.b,c),alpha:lt(o.alpha,u.alpha,c)}}},ne={forward:function(o){var u=oi(o),c=u.l,y=u.a,C=u.b,R=Math.atan2(C,y)*Vr;return{h:R<0?R+360:R,c:Math.sqrt(y*y+C*C),l:c,alpha:o.a}},reverse:function(o){var u=o.h*ur,c=o.c;return T({l:o.l,a:Math.cos(u)*c,b:Math.sin(u)*c,alpha:o.alpha})},interpolate:function(o,u,c){return{h:H(o.h,u.h,c),c:lt(o.c,u.c,c),l:lt(o.l,u.l,c),alpha:lt(o.alpha,u.alpha,c)}}},$e=Object.freeze({__proto__:null,lab:_e,hcl:ne}),xt=function(o,u,c,y,C){this.type=o,this.operator=u,this.interpolation=c,this.input=y,this.labels=[],this.outputs=[];for(var R=0,z=C;R<z.length;R+=1){var Q=z[R],pe=Q[1];this.labels.push(Q[0]),this.outputs.push(pe)}};function zt(o,u,c,y){var C=y-c,R=o-c;return C===0?0:u===1?R/C:(Math.pow(u,R)-1)/(Math.pow(u,C)-1)}xt.interpolationFactor=function(o,u,c,y){var C=0;if(o.name==="exponential")C=zt(u,o.base,c,y);else if(o.name==="linear")C=zt(u,1,c,y);else if(o.name==="cubic-bezier"){var R=o.controlPoints;C=new F(R[0],R[1],R[2],R[3]).solve(zt(u,1,c,y))}return C},xt.parse=function(o,u){var c=o[0],y=o[1],C=o[2],R=o.slice(3);if(!Array.isArray(y)||y.length===0)return u.error("Expected an interpolation type expression.",1);if(y[0]==="linear")y={name:"linear"};else if(y[0]==="exponential"){var z=y[1];if(typeof z!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:z}}else{if(y[0]!=="cubic-bezier")return u.error("Unknown interpolation type "+String(y[0]),1,0);var Q=y.slice(1);if(Q.length!==4||Q.some(function(mr){return typeof mr!="number"||mr<0||mr>1}))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:Q}}if(o.length-1<4)return u.error("Expected at least 4 arguments, but found only "+(o.length-1)+".");if((o.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(!(C=u.parse(C,2,Hr)))return null;var pe=[],Ie=null;c==="interpolate-hcl"||c==="interpolate-lab"?Ie=It:u.expectedType&&u.expectedType.kind!=="value"&&(Ie=u.expectedType);for(var ze=0;ze<R.length;ze+=2){var qe=R[ze],ut=R[ze+1],wt=ze+3,or=ze+4;if(typeof qe!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',wt);if(pe.length&&pe[pe.length-1][0]>=qe)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',wt);var sr=u.parse(ut,or,Ie);if(!sr)return null;Ie=Ie||sr.type,pe.push([qe,sr])}return Ie.kind==="number"||Ie.kind==="color"||Ie.kind==="array"&&Ie.itemType.kind==="number"&&typeof Ie.N=="number"?new xt(Ie,c,y,C,pe):u.error("Type "+qr(Ie)+" is not interpolatable.")},xt.prototype.evaluate=function(o){var u=this.labels,c=this.outputs;if(u.length===1)return c[0].evaluate(o);var y=this.input.evaluate(o);if(y<=u[0])return c[0].evaluate(o);var C=u.length;if(y>=u[C-1])return c[C-1].evaluate(o);var R=Sr(u,y),z=xt.interpolationFactor(this.interpolation,y,u[R],u[R+1]),Q=c[R].evaluate(o),pe=c[R+1].evaluate(o);return this.operator==="interpolate"?Xt[this.type.kind.toLowerCase()](Q,pe,z):this.operator==="interpolate-hcl"?ne.reverse(ne.interpolate(ne.forward(Q),ne.forward(pe),z)):_e.reverse(_e.interpolate(_e.forward(Q),_e.forward(pe),z))},xt.prototype.eachChild=function(o){o(this.input);for(var u=0,c=this.outputs;u<c.length;u+=1)o(c[u])},xt.prototype.outputDefined=function(){return this.outputs.every(function(o){return o.outputDefined()})},xt.prototype.serialize=function(){var o;o=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var u=[this.operator,o,this.input.serialize()],c=0;c<this.labels.length;c++)u.push(this.labels[c],this.outputs[c].serialize());return u};var _r=function(o,u){this.type=o,this.args=u};_r.parse=function(o,u){if(o.length<2)return u.error("Expectected at least one argument.");var c=null,y=u.expectedType;y&&y.kind!=="value"&&(c=y);for(var C=[],R=0,z=o.slice(1);R<z.length;R+=1){var Q=u.parse(z[R],1+C.length,c,void 0,{typeAnnotation:"omit"});if(!Q)return null;c=c||Q.type,C.push(Q)}var pe=y&&C.some(function(Ie){return Ui(y,Ie.type)});return new _r(pe?Dr:c,C)},_r.prototype.evaluate=function(o){for(var u,c=null,y=0,C=0,R=this.args;C<R.length&&(y++,(c=R[C].evaluate(o))&&c instanceof Ga&&!c.available&&(u||(u=c.name),c=null,y===this.args.length&&(c=u)),c===null);C+=1);return c},_r.prototype.eachChild=function(o){this.args.forEach(o)},_r.prototype.outputDefined=function(){return this.args.every(function(o){return o.outputDefined()})},_r.prototype.serialize=function(){var o=["coalesce"];return this.eachChild(function(u){o.push(u.serialize())}),o};var xr=function(o,u){this.type=u.type,this.bindings=[].concat(o),this.result=u};xr.prototype.evaluate=function(o){return this.result.evaluate(o)},xr.prototype.eachChild=function(o){for(var u=0,c=this.bindings;u<c.length;u+=1)o(c[u][1]);o(this.result)},xr.parse=function(o,u){if(o.length<4)return u.error("Expected at least 3 arguments, but found "+(o.length-1)+" instead.");for(var c=[],y=1;y<o.length-1;y+=2){var C=o[y];if(typeof C!="string")return u.error("Expected string, but found "+typeof C+" instead.",y);if(/[^a-zA-Z0-9_]/.test(C))return u.error("Variable names must contain only alphanumeric characters or '_'.",y);var R=u.parse(o[y+1],y+1);if(!R)return null;c.push([C,R])}var z=u.parse(o[o.length-1],o.length-1,u.expectedType,c);return z?new xr(c,z):null},xr.prototype.outputDefined=function(){return this.result.outputDefined()},xr.prototype.serialize=function(){for(var o=["let"],u=0,c=this.bindings;u<c.length;u+=1){var y=c[u];o.push(y[0],y[1].serialize())}return o.push(this.result.serialize()),o};var dn=function(o,u,c){this.type=o,this.index=u,this.input=c};dn.parse=function(o,u){if(o.length!==3)return u.error("Expected 2 arguments, but found "+(o.length-1)+" instead.");var c=u.parse(o[1],1,Hr),y=u.parse(o[2],2,Fr(u.expectedType||Dr));return c&&y?new dn(y.type.itemType,c,y):null},dn.prototype.evaluate=function(o){var u=this.index.evaluate(o),c=this.input.evaluate(o);if(u<0)throw new ns("Array index out of bounds: "+u+" < 0.");if(u>=c.length)throw new ns("Array index out of bounds: "+u+" > "+(c.length-1)+".");if(u!==Math.floor(u))throw new ns("Array index must be an integer, but found "+u+" instead.");return c[u]},dn.prototype.eachChild=function(o){o(this.index),o(this.input)},dn.prototype.outputDefined=function(){return!1},dn.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Bn=function(o,u){this.type=vi,this.needle=o,this.haystack=u};Bn.parse=function(o,u){if(o.length!==3)return u.error("Expected 2 arguments, but found "+(o.length-1)+" instead.");var c=u.parse(o[1],1,Dr),y=u.parse(o[2],2,Dr);return c&&y?fa(c.type,[vi,_i,Hr,Li,Dr])?new Bn(c,y):u.error("Expected first argument to be of type boolean, string, number or null, but found "+qr(c.type)+" instead"):null},Bn.prototype.evaluate=function(o){var u=this.needle.evaluate(o),c=this.haystack.evaluate(o);if(!c)return!1;if(!Wi(u,["boolean","string","number","null"]))throw new ns("Expected first argument to be of type boolean, string, number or null, but found "+qr(Fo(u))+" instead.");if(!Wi(c,["string","array"]))throw new ns("Expected second argument to be of type array or string, but found "+qr(Fo(c))+" instead.");return c.indexOf(u)>=0},Bn.prototype.eachChild=function(o){o(this.needle),o(this.haystack)},Bn.prototype.outputDefined=function(){return!0},Bn.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var zi=function(o,u,c){this.type=Hr,this.needle=o,this.haystack=u,this.fromIndex=c};zi.parse=function(o,u){if(o.length<=2||o.length>=5)return u.error("Expected 3 or 4 arguments, but found "+(o.length-1)+" instead.");var c=u.parse(o[1],1,Dr),y=u.parse(o[2],2,Dr);if(!c||!y)return null;if(!fa(c.type,[vi,_i,Hr,Li,Dr]))return u.error("Expected first argument to be of type boolean, string, number or null, but found "+qr(c.type)+" instead");if(o.length===4){var C=u.parse(o[3],3,Hr);return C?new zi(c,y,C):null}return new zi(c,y)},zi.prototype.evaluate=function(o){var u=this.needle.evaluate(o),c=this.haystack.evaluate(o);if(!Wi(u,["boolean","string","number","null"]))throw new ns("Expected first argument to be of type boolean, string, number or null, but found "+qr(Fo(u))+" instead.");if(!Wi(c,["string","array"]))throw new ns("Expected second argument to be of type array or string, but found "+qr(Fo(c))+" instead.");if(this.fromIndex){var y=this.fromIndex.evaluate(o);return c.indexOf(u,y)}return c.indexOf(u)},zi.prototype.eachChild=function(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)},zi.prototype.outputDefined=function(){return!1},zi.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Vi=function(o,u,c,y,C,R){this.inputType=o,this.type=u,this.input=c,this.cases=y,this.outputs=C,this.otherwise=R};Vi.parse=function(o,u){if(o.length<5)return u.error("Expected at least 4 arguments, but found only "+(o.length-1)+".");if(o.length%2!=1)return u.error("Expected an even number of arguments.");var c,y;u.expectedType&&u.expectedType.kind!=="value"&&(y=u.expectedType);for(var C={},R=[],z=2;z<o.length-1;z+=2){var Q=o[z],pe=o[z+1];Array.isArray(Q)||(Q=[Q]);var Ie=u.concat(z);if(Q.length===0)return Ie.error("Expected at least one branch label.");for(var ze=0,qe=Q;ze<qe.length;ze+=1){var ut=qe[ze];if(typeof ut!="number"&&typeof ut!="string")return Ie.error("Branch labels must be numbers or strings.");if(typeof ut=="number"&&Math.abs(ut)>Number.MAX_SAFE_INTEGER)return Ie.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof ut=="number"&&Math.floor(ut)!==ut)return Ie.error("Numeric branch labels must be integer values.");if(c){if(Ie.checkSubtype(c,Fo(ut)))return null}else c=Fo(ut);if(C[String(ut)]!==void 0)return Ie.error("Branch labels must be unique.");C[String(ut)]=R.length}var wt=u.parse(pe,z,y);if(!wt)return null;y=y||wt.type,R.push(wt)}var or=u.parse(o[1],1,Dr);if(!or)return null;var sr=u.parse(o[o.length-1],o.length-1,y);return sr?or.type.kind!=="value"&&u.concat(1).checkSubtype(c,or.type)?null:new Vi(c,y,or,C,R,sr):null},Vi.prototype.evaluate=function(o){var u=this.input.evaluate(o);return(Fo(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(o)},Vi.prototype.eachChild=function(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)},Vi.prototype.outputDefined=function(){return this.outputs.every(function(o){return o.outputDefined()})&&this.otherwise.outputDefined()},Vi.prototype.serialize=function(){for(var o=this,u=["match",this.input.serialize()],c=[],y={},C=0,R=Object.keys(this.cases).sort();C<R.length;C+=1){var z=R[C];(qe=y[this.cases[z]])===void 0?(y[this.cases[z]]=c.length,c.push([this.cases[z],[z]])):c[qe][1].push(z)}for(var Q=function(wt){return o.inputType.kind==="number"?Number(wt):wt},pe=0,Ie=c;pe<Ie.length;pe+=1){var ze=Ie[pe],qe=ze[0],ut=ze[1];u.push(ut.length===1?Q(ut[0]):ut.map(Q)),u.push(this.outputs[outputIndex$1].serialize())}return u.push(this.otherwise.serialize()),u};var Ei=function(o,u,c){this.type=o,this.branches=u,this.otherwise=c};Ei.parse=function(o,u){if(o.length<4)return u.error("Expected at least 3 arguments, but found only "+(o.length-1)+".");if(o.length%2!=0)return u.error("Expected an odd number of arguments.");var c;u.expectedType&&u.expectedType.kind!=="value"&&(c=u.expectedType);for(var y=[],C=1;C<o.length-1;C+=2){var R=u.parse(o[C],C,vi);if(!R)return null;var z=u.parse(o[C+1],C+1,c);if(!z)return null;y.push([R,z]),c=c||z.type}var Q=u.parse(o[o.length-1],o.length-1,c);return Q?new Ei(c,y,Q):null},Ei.prototype.evaluate=function(o){for(var u=0,c=this.branches;u<c.length;u+=1){var y=c[u],C=y[1];if(y[0].evaluate(o))return C.evaluate(o)}return this.otherwise.evaluate(o)},Ei.prototype.eachChild=function(o){for(var u=0,c=this.branches;u<c.length;u+=1){var y=c[u],C=y[1];o(y[0]),o(C)}o(this.otherwise)},Ei.prototype.outputDefined=function(){return this.branches.every(function(o){return o[1].outputDefined()})&&this.otherwise.outputDefined()},Ei.prototype.serialize=function(){var o=["case"];return this.eachChild(function(u){o.push(u.serialize())}),o};var qa=function(o,u,c,y){this.type=o,this.input=u,this.beginIndex=c,this.endIndex=y};function $a(o,u){return o==="=="||o==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function La(o,u,c,y){return y.compare(u,c)===0}function to(o,u,c){var y=o!=="=="&&o!=="!=";return function(){function C(R,z,Q){this.type=vi,this.lhs=R,this.rhs=z,this.collator=Q,this.hasUntypedArgument=R.type.kind==="value"||z.type.kind==="value"}return C.parse=function(R,z){if(R.length!==3&&R.length!==4)return z.error("Expected two or three arguments.");var Q=R[0],pe=z.parse(R[1],1,Dr);if(!pe)return null;if(!$a(Q,pe.type))return z.concat(1).error('"'+Q+`" comparisons are not supported for type '`+qr(pe.type)+"'.");var Ie=z.parse(R[2],2,Dr);if(!Ie)return null;if(!$a(Q,Ie.type))return z.concat(2).error('"'+Q+`" comparisons are not supported for type '`+qr(Ie.type)+"'.");if(pe.type.kind!==Ie.type.kind&&pe.type.kind!=="value"&&Ie.type.kind!=="value")return z.error("Cannot compare types '"+qr(pe.type)+"' and '"+qr(Ie.type)+"'.");y&&(pe.type.kind==="value"&&Ie.type.kind!=="value"?pe=new _o(Ie.type,[pe]):pe.type.kind!=="value"&&Ie.type.kind==="value"&&(Ie=new _o(pe.type,[Ie])));var ze=null;if(R.length===4){if(pe.type.kind!=="string"&&Ie.type.kind!=="string"&&pe.type.kind!=="value"&&Ie.type.kind!=="value")return z.error("Cannot use collator to compare non-string types.");if(!(ze=z.parse(R[3],3,Jn)))return null}return new C(pe,Ie,ze)},C.prototype.evaluate=function(R){var z=this.lhs.evaluate(R),Q=this.rhs.evaluate(R);if(y&&this.hasUntypedArgument){var pe=Fo(z),Ie=Fo(Q);if(pe.kind!==Ie.kind||pe.kind!=="string"&&pe.kind!=="number")throw new ns('Expected arguments for "'+o+'" to be (string, string) or (number, number), but found ('+pe.kind+", "+Ie.kind+") instead.")}if(this.collator&&!y&&this.hasUntypedArgument){var ze=Fo(z),qe=Fo(Q);if(ze.kind!=="string"||qe.kind!=="string")return u(R,z,Q)}return this.collator?c(R,z,Q,this.collator.evaluate(R)):u(R,z,Q)},C.prototype.eachChild=function(R){R(this.lhs),R(this.rhs),this.collator&&R(this.collator)},C.prototype.outputDefined=function(){return!0},C.prototype.serialize=function(){var R=[o];return this.eachChild(function(z){R.push(z.serialize())}),R},C}()}qa.parse=function(o,u){if(o.length<=2||o.length>=5)return u.error("Expected 3 or 4 arguments, but found "+(o.length-1)+" instead.");var c=u.parse(o[1],1,Dr),y=u.parse(o[2],2,Hr);if(!c||!y)return null;if(!fa(c.type,[Fr(Dr),_i,Dr]))return u.error("Expected first argument to be of type array or string, but found "+qr(c.type)+" instead");if(o.length===4){var C=u.parse(o[3],3,Hr);return C?new qa(c.type,c,y,C):null}return new qa(c.type,c,y)},qa.prototype.evaluate=function(o){var u=this.input.evaluate(o),c=this.beginIndex.evaluate(o);if(!Wi(u,["string","array"]))throw new ns("Expected first argument to be of type array or string, but found "+qr(Fo(u))+" instead.");if(this.endIndex){var y=this.endIndex.evaluate(o);return u.slice(c,y)}return u.slice(c)},qa.prototype.eachChild=function(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)},qa.prototype.outputDefined=function(){return!1},qa.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ho=to("==",function(o,u,c){return u===c},La),xo=to("!=",function(o,u,c){return u!==c},function(o,u,c,y){return!La(0,u,c,y)}),bo=to("<",function(o,u,c){return u<c},function(o,u,c,y){return y.compare(u,c)<0}),so=to(">",function(o,u,c){return u>c},function(o,u,c,y){return y.compare(u,c)>0}),Cs=to("<=",function(o,u,c){return u<=c},function(o,u,c,y){return y.compare(u,c)<=0}),Ls=to(">=",function(o,u,c){return u>=c},function(o,u,c,y){return y.compare(u,c)>=0}),Rs=function(o,u,c,y,C){this.type=_i,this.number=o,this.locale=u,this.currency=c,this.minFractionDigits=y,this.maxFractionDigits=C};Rs.parse=function(o,u){if(o.length!==3)return u.error("Expected two arguments.");var c=u.parse(o[1],1,Hr);if(!c)return null;var y=o[2];if(typeof y!="object"||Array.isArray(y))return u.error("NumberFormat options argument must be an object.");var C=null;if(y.locale&&!(C=u.parse(y.locale,1,_i)))return null;var R=null;if(y.currency&&!(R=u.parse(y.currency,1,_i)))return null;var z=null;if(y["min-fraction-digits"]&&!(z=u.parse(y["min-fraction-digits"],1,Hr)))return null;var Q=null;return y["max-fraction-digits"]&&!(Q=u.parse(y["max-fraction-digits"],1,Hr))?null:new Rs(c,C,R,z,Q)},Rs.prototype.evaluate=function(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))},Rs.prototype.eachChild=function(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)},Rs.prototype.outputDefined=function(){return!1},Rs.prototype.serialize=function(){var o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]};var lu=function(o){this.type=Hr,this.input=o};lu.parse=function(o,u){if(o.length!==2)return u.error("Expected 1 argument, but found "+(o.length-1)+" instead.");var c=u.parse(o[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?u.error("Expected argument of type string or array, but found "+qr(c.type)+" instead."):new lu(c):null},lu.prototype.evaluate=function(o){var u=this.input.evaluate(o);if(typeof u=="string"||Array.isArray(u))return u.length;throw new ns("Expected value to be of type string or array, but found "+qr(Fo(u))+" instead.")},lu.prototype.eachChild=function(o){o(this.input)},lu.prototype.outputDefined=function(){return!1},lu.prototype.serialize=function(){var o=["length"];return this.eachChild(function(u){o.push(u.serialize())}),o};var ps={"==":Ho,"!=":xo,">":so,"<":bo,">=":Ls,"<=":Cs,array:_o,at:dn,boolean:_o,case:Ei,coalesce:_r,collator:eu,format:Po,image:Ss,in:Bn,"index-of":zi,interpolate:xt,"interpolate-hcl":xt,"interpolate-lab":xt,length:lu,let:xr,literal:zo,match:Vi,number:_o,"number-format":Rs,object:_o,slice:qa,step:sn,string:_o,"to-boolean":$s,"to-color":$s,"to-number":$s,"to-string":$s,var:fr,within:Pe};function Go(o,u){var c=u[0],y=u[1],C=u[2],R=u[3];c=c.evaluate(o),y=y.evaluate(o),C=C.evaluate(o);var z=R?R.evaluate(o):1,Q=Ko(c,y,C,z);if(Q)throw new ns(Q);return new qi(c/255*z,y/255*z,C/255*z,z)}function zu(o,u){return o in u}function al(o,u){var c=u[o];return c===void 0?null:c}function ou(o){return{type:o}}function Xu(o){return{result:"success",value:o}}function Nu(o){return{result:"error",value:o}}function ks(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function Sc(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function vl(o){return!!o.expression&&o.expression.interpolated}function es(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function Al(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function tf(o){return o}function Zl(o,u,c){return o!==void 0?o:u!==void 0?u:c!==void 0?c:void 0}function uc(o,u,c,y,C){return Zl(typeof c===C?y[c]:void 0,o.default,u.default)}function pf(o,u,c){if(es(c)!=="number")return Zl(o.default,u.default);var y=o.stops.length;if(y===1||c<=o.stops[0][0])return o.stops[0][1];if(c>=o.stops[y-1][0])return o.stops[y-1][1];var C=Sr(o.stops.map(function(R){return R[0]}),c);return o.stops[C][1]}function ql(o,u,c){var y=o.base!==void 0?o.base:1;if(es(c)!=="number")return Zl(o.default,u.default);var C=o.stops.length;if(C===1||c<=o.stops[0][0])return o.stops[0][1];if(c>=o.stops[C-1][0])return o.stops[C-1][1];var R=Sr(o.stops.map(function(qe){return qe[0]}),c),z=function(qe,ut,wt,or){var sr=or-wt,mr=qe-wt;return sr===0?0:ut===1?mr/sr:(Math.pow(ut,mr)-1)/(Math.pow(ut,sr)-1)}(c,y,o.stops[R][0],o.stops[R+1][0]),Q=o.stops[R][1],pe=o.stops[R+1][1],Ie=Xt[u.type]||tf;if(o.colorSpace&&o.colorSpace!=="rgb"){var ze=$e[o.colorSpace];Ie=function(qe,ut){return ze.reverse(ze.interpolate(ze.forward(qe),ze.forward(ut),z))}}return typeof Q.evaluate=="function"?{evaluate:function(){for(var qe=[],ut=arguments.length;ut--;)qe[ut]=arguments[ut];var wt=Q.evaluate.apply(void 0,qe),or=pe.evaluate.apply(void 0,qe);if(wt!==void 0&&or!==void 0)return Ie(wt,or,z)}}:Ie(Q,pe,z)}function Cu(o,u,c){return u.type==="color"?c=qi.parse(c):u.type==="formatted"?c=ao.fromString(c.toString()):u.type==="resolvedImage"?c=Ga.fromString(c.toString()):es(c)===u.type||u.type==="enum"&&u.values[c]||(c=void 0),Zl(c,o.default,u.default)}ms.register(ps,{error:[{kind:"error"},[_i],function(o,u){throw new ns(u[0].evaluate(o))}],typeof:[_i,[Dr],function(o,u){return qr(Fo(u[0].evaluate(o)))}],"to-rgba":[Fr(Hr,4),[It],function(o,u){return u[0].evaluate(o).toArray()}],rgb:[It,[Hr,Hr,Hr],Go],rgba:[It,[Hr,Hr,Hr,Hr],Go],has:{type:vi,overloads:[[[_i],function(o,u){return zu(u[0].evaluate(o),o.properties())}],[[_i,Yr],function(o,u){var c=u[1];return zu(u[0].evaluate(o),c.evaluate(o))}]]},get:{type:Dr,overloads:[[[_i],function(o,u){return al(u[0].evaluate(o),o.properties())}],[[_i,Yr],function(o,u){var c=u[1];return al(u[0].evaluate(o),c.evaluate(o))}]]},"feature-state":[Dr,[_i],function(o,u){return al(u[0].evaluate(o),o.featureState||{})}],properties:[Yr,[],function(o){return o.properties()}],"geometry-type":[_i,[],function(o){return o.geometryType()}],id:[Dr,[],function(o){return o.id()}],zoom:[Hr,[],function(o){return o.globals.zoom}],"heatmap-density":[Hr,[],function(o){return o.globals.heatmapDensity||0}],"line-progress":[Hr,[],function(o){return o.globals.lineProgress||0}],accumulated:[Dr,[],function(o){return o.globals.accumulated===void 0?null:o.globals.accumulated}],"+":[Hr,ou(Hr),function(o,u){for(var c=0,y=0,C=u;y<C.length;y+=1)c+=C[y].evaluate(o);return c}],"*":[Hr,ou(Hr),function(o,u){for(var c=1,y=0,C=u;y<C.length;y+=1)c*=C[y].evaluate(o);return c}],"-":{type:Hr,overloads:[[[Hr,Hr],function(o,u){var c=u[1];return u[0].evaluate(o)-c.evaluate(o)}],[[Hr],function(o,u){return-u[0].evaluate(o)}]]},"/":[Hr,[Hr,Hr],function(o,u){var c=u[1];return u[0].evaluate(o)/c.evaluate(o)}],"%":[Hr,[Hr,Hr],function(o,u){var c=u[1];return u[0].evaluate(o)%c.evaluate(o)}],ln2:[Hr,[],function(){return Math.LN2}],pi:[Hr,[],function(){return Math.PI}],e:[Hr,[],function(){return Math.E}],"^":[Hr,[Hr,Hr],function(o,u){var c=u[1];return Math.pow(u[0].evaluate(o),c.evaluate(o))}],sqrt:[Hr,[Hr],function(o,u){return Math.sqrt(u[0].evaluate(o))}],log10:[Hr,[Hr],function(o,u){return Math.log(u[0].evaluate(o))/Math.LN10}],ln:[Hr,[Hr],function(o,u){return Math.log(u[0].evaluate(o))}],log2:[Hr,[Hr],function(o,u){return Math.log(u[0].evaluate(o))/Math.LN2}],sin:[Hr,[Hr],function(o,u){return Math.sin(u[0].evaluate(o))}],cos:[Hr,[Hr],function(o,u){return Math.cos(u[0].evaluate(o))}],tan:[Hr,[Hr],function(o,u){return Math.tan(u[0].evaluate(o))}],asin:[Hr,[Hr],function(o,u){return Math.asin(u[0].evaluate(o))}],acos:[Hr,[Hr],function(o,u){return Math.acos(u[0].evaluate(o))}],atan:[Hr,[Hr],function(o,u){return Math.atan(u[0].evaluate(o))}],min:[Hr,ou(Hr),function(o,u){return Math.min.apply(Math,u.map(function(c){return c.evaluate(o)}))}],max:[Hr,ou(Hr),function(o,u){return Math.max.apply(Math,u.map(function(c){return c.evaluate(o)}))}],abs:[Hr,[Hr],function(o,u){return Math.abs(u[0].evaluate(o))}],round:[Hr,[Hr],function(o,u){var c=u[0].evaluate(o);return c<0?-Math.round(-c):Math.round(c)}],floor:[Hr,[Hr],function(o,u){return Math.floor(u[0].evaluate(o))}],ceil:[Hr,[Hr],function(o,u){return Math.ceil(u[0].evaluate(o))}],"filter-==":[vi,[_i,Dr],function(o,u){var c=u[0],y=u[1];return o.properties()[c.value]===y.value}],"filter-id-==":[vi,[Dr],function(o,u){var c=u[0];return o.id()===c.value}],"filter-type-==":[vi,[_i],function(o,u){var c=u[0];return o.geometryType()===c.value}],"filter-<":[vi,[_i,Dr],function(o,u){var c=u[0],y=u[1],C=o.properties()[c.value],R=y.value;return typeof C==typeof R&&C<R}],"filter-id-<":[vi,[Dr],function(o,u){var c=u[0],y=o.id(),C=c.value;return typeof y==typeof C&&y<C}],"filter->":[vi,[_i,Dr],function(o,u){var c=u[0],y=u[1],C=o.properties()[c.value],R=y.value;return typeof C==typeof R&&C>R}],"filter-id->":[vi,[Dr],function(o,u){var c=u[0],y=o.id(),C=c.value;return typeof y==typeof C&&y>C}],"filter-<=":[vi,[_i,Dr],function(o,u){var c=u[0],y=u[1],C=o.properties()[c.value],R=y.value;return typeof C==typeof R&&C<=R}],"filter-id-<=":[vi,[Dr],function(o,u){var c=u[0],y=o.id(),C=c.value;return typeof y==typeof C&&y<=C}],"filter->=":[vi,[_i,Dr],function(o,u){var c=u[0],y=u[1],C=o.properties()[c.value],R=y.value;return typeof C==typeof R&&C>=R}],"filter-id->=":[vi,[Dr],function(o,u){var c=u[0],y=o.id(),C=c.value;return typeof y==typeof C&&y>=C}],"filter-has":[vi,[Dr],function(o,u){return u[0].value in o.properties()}],"filter-has-id":[vi,[],function(o){return o.id()!==null&&o.id()!==void 0}],"filter-type-in":[vi,[Fr(_i)],function(o,u){return u[0].value.indexOf(o.geometryType())>=0}],"filter-id-in":[vi,[Fr(Dr)],function(o,u){return u[0].value.indexOf(o.id())>=0}],"filter-in-small":[vi,[_i,Fr(Dr)],function(o,u){var c=u[0];return u[1].value.indexOf(o.properties()[c.value])>=0}],"filter-in-large":[vi,[_i,Fr(Dr)],function(o,u){var c=u[0],y=u[1];return function(C,R,z,Q){for(;z<=Q;){var pe=z+Q>>1;if(R[pe]===C)return!0;R[pe]>C?Q=pe-1:z=pe+1}return!1}(o.properties()[c.value],y.value,0,y.value.length-1)}],all:{type:vi,overloads:[[[vi,vi],function(o,u){var c=u[1];return u[0].evaluate(o)&&c.evaluate(o)}],[ou(vi),function(o,u){for(var c=0,y=u;c<y.length;c+=1)if(!y[c].evaluate(o))return!1;return!0}]]},any:{type:vi,overloads:[[[vi,vi],function(o,u){var c=u[1];return u[0].evaluate(o)||c.evaluate(o)}],[ou(vi),function(o,u){for(var c=0,y=u;c<y.length;c+=1)if(y[c].evaluate(o))return!0;return!1}]]},"!":[vi,[vi],function(o,u){return!u[0].evaluate(o)}],"is-supported-script":[vi,[_i],function(o,u){var c=o.globals&&o.globals.isSupportedScript;return!c||c(u[0].evaluate(o))}],upcase:[_i,[_i],function(o,u){return u[0].evaluate(o).toUpperCase()}],downcase:[_i,[_i],function(o,u){return u[0].evaluate(o).toLowerCase()}],concat:[_i,ou(Dr),function(o,u){return u.map(function(c){return su(c.evaluate(o))}).join("")}],"resolved-locale":[_i,[Jn],function(o,u){return u[0].evaluate(o).resolvedLocale()}]});var rf=function(o,u){this.expression=o,this._warningHistory={},this._evaluator=new Jo,this._defaultValue=u?function(c){return c.type==="color"&&Al(c.default)?new qi(0,0,0,0):c.type==="color"?qi.parse(c.default)||null:c.default===void 0?null:c.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null};function ol(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in ps}function as(o,u){var c=new Tr(ps,[],u?function(C){var R={color:It,string:_i,number:Hr,enum:_i,boolean:vi,formatted:Kt,resolvedImage:hr};return C.type==="array"?Fr(R[C.value]||Dr,C.length):R[C.type]}(u):void 0),y=c.parse(o,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return y?Xu(new rf(y,u)):Nu(c.errors)}rf.prototype.evaluateWithoutErrorHandling=function(o,u,c,y,C,R){return this._evaluator.globals=o,this._evaluator.feature=u,this._evaluator.featureState=c,this._evaluator.canonical=y,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=R,this.expression.evaluate(this._evaluator)},rf.prototype.evaluate=function(o,u,c,y,C,R){this._evaluator.globals=o,this._evaluator.feature=u||null,this._evaluator.featureState=c||null,this._evaluator.canonical=y,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=R||null;try{var z=this.expression.evaluate(this._evaluator);if(z==null||typeof z=="number"&&z!=z)return this._defaultValue;if(this._enumValues&&!(z in this._enumValues))throw new ns("Expected value to be one of "+Object.keys(this._enumValues).map(function(Q){return JSON.stringify(Q)}).join(", ")+", but found "+JSON.stringify(z)+" instead.");return z}catch(Q){return this._warningHistory[Q.message]||(this._warningHistory[Q.message]=!0,typeof console!="undefined"&&console.warn(Q.message)),this._defaultValue}};var Ds=function(o,u){this.kind=o,this._styleExpression=u,this.isStateDependent=o!=="constant"&&!Mt(u.expression)};Ds.prototype.evaluateWithoutErrorHandling=function(o,u,c,y,C,R){return this._styleExpression.evaluateWithoutErrorHandling(o,u,c,y,C,R)},Ds.prototype.evaluate=function(o,u,c,y,C,R){return this._styleExpression.evaluate(o,u,c,y,C,R)};var Tl=function(o,u,c,y){this.kind=o,this.zoomStops=c,this._styleExpression=u,this.isStateDependent=o!=="camera"&&!Mt(u.expression),this.interpolationType=y};function Yu(o,u){if((o=as(o,u)).result==="error")return o;var c=o.value.expression,y=Tt(c);if(!y&&!ks(u))return Nu([new rr("","data expressions not supported")]);var C=$t(c,["zoom"]);if(!C&&!Sc(u))return Nu([new rr("","zoom expressions not supported")]);var R=function z(Q){var pe=null;if(Q instanceof xr)pe=z(Q.result);else if(Q instanceof _r)for(var Ie=0,ze=Q.args;Ie<ze.length&&!(pe=z(ze[Ie]));Ie+=1);else(Q instanceof sn||Q instanceof xt)&&Q.input instanceof ms&&Q.input.name==="zoom"&&(pe=Q);return pe instanceof rr||Q.eachChild(function(qe){var ut=z(qe);ut instanceof rr?pe=ut:!pe&&ut?pe=new rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):pe&&ut&&pe!==ut&&(pe=new rr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),pe}(c);return R||C?R instanceof rr?Nu([R]):R instanceof xt&&!vl(u)?Nu([new rr("",'"interpolate" expressions cannot be used with this property')]):Xu(R?new Tl(y?"camera":"composite",o.value,R.labels,R instanceof xt?R.interpolation:void 0):new Ds(y?"constant":"source",o.value)):Nu([new rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Tl.prototype.evaluateWithoutErrorHandling=function(o,u,c,y,C,R){return this._styleExpression.evaluateWithoutErrorHandling(o,u,c,y,C,R)},Tl.prototype.evaluate=function(o,u,c,y,C,R){return this._styleExpression.evaluate(o,u,c,y,C,R)},Tl.prototype.interpolationFactor=function(o,u,c){return this.interpolationType?xt.interpolationFactor(this.interpolationType,o,u,c):0};var Ml=function(o,u){this._parameters=o,this._specification=u,en(this,function c(y,C){var R,z,Q,pe=C.type==="color",Ie=y.stops&&typeof y.stops[0][0]=="object",ze=Ie||!(Ie||y.property!==void 0),qe=y.type||(vl(C)?"exponential":"interval");if(pe&&((y=en({},y)).stops&&(y.stops=y.stops.map(function(vn){return[vn[0],qi.parse(vn[1])]})),y.default=qi.parse(y.default?y.default:C.default)),y.colorSpace&&y.colorSpace!=="rgb"&&!$e[y.colorSpace])throw new Error("Unknown color space: "+y.colorSpace);if(qe==="exponential")R=ql;else if(qe==="interval")R=pf;else if(qe==="categorical"){R=uc,z=Object.create(null);for(var ut=0,wt=y.stops;ut<wt.length;ut+=1){var or=wt[ut];z[or[0]]=or[1]}Q=typeof y.stops[0][0]}else{if(qe!=="identity")throw new Error('Unknown function type "'+qe+'"');R=Cu}if(Ie){for(var sr={},mr=[],yr=0;yr<y.stops.length;yr++){var rn=y.stops[yr],_n=rn[0].zoom;sr[_n]===void 0&&(sr[_n]={zoom:_n,type:y.type,property:y.property,default:y.default,stops:[]},mr.push(_n)),sr[_n].stops.push([rn[0].value,rn[1]])}for(var kn=[],Nn=0,pi=mr;Nn<pi.length;Nn+=1){var Xr=pi[Nn];kn.push([sr[Xr].zoom,c(sr[Xr],C)])}var ua={name:"linear"};return{kind:"composite",interpolationType:ua,interpolationFactor:xt.interpolationFactor.bind(void 0,ua),zoomStops:kn.map(function(vn){return vn[0]}),evaluate:function(vn,$i){var ki=vn.zoom;return ql({stops:kn,base:y.base},C,ki).evaluate(ki,$i)}}}if(ze){var Ir=qe==="exponential"?{name:"exponential",base:y.base!==void 0?y.base:1}:null;return{kind:"camera",interpolationType:Ir,interpolationFactor:xt.interpolationFactor.bind(void 0,Ir),zoomStops:y.stops.map(function(vn){return vn[0]}),evaluate:function(vn){return R(y,C,vn.zoom,z,Q)}}}return{kind:"source",evaluate:function(vn,$i){var ki=$i&&$i.properties?$i.properties[y.property]:void 0;return ki===void 0?Zl(y.default,C.default):R(y,C,ki,z,Q)}}}(this._parameters,this._specification))};function xl(o){var u=o.key,c=o.value,y=o.valueSpec||{},C=o.objectElementValidators||{},R=o.style,z=o.styleSpec,Q=[],pe=es(c);if(pe!=="object")return[new At(u,c,"object expected, "+pe+" found")];for(var Ie in c){var ze=Ie.split(".")[0],qe=y[ze]||y["*"],ut=void 0;if(C[ze])ut=C[ze];else if(y[ze])ut=Za;else if(C["*"])ut=C["*"];else{if(!y["*"]){Q.push(new At(u,c[Ie],'unknown property "'+Ie+'"'));continue}ut=Za}Q=Q.concat(ut({key:(u&&u+".")+Ie,value:c[Ie],valueSpec:qe,style:R,styleSpec:z,object:c,objectKey:Ie},c))}for(var wt in y)C[wt]||y[wt].required&&y[wt].default===void 0&&c[wt]===void 0&&Q.push(new At(u,c,'missing required property "'+wt+'"'));return Q}function nf(o){var u=o.value,c=o.valueSpec,y=o.style,C=o.styleSpec,R=o.key,z=o.arrayElementValidator||Za;if(es(u)!=="array")return[new At(R,u,"array expected, "+es(u)+" found")];if(c.length&&u.length!==c.length)return[new At(R,u,"array length "+c.length+" expected, length "+u.length+" found")];if(c["min-length"]&&u.length<c["min-length"])return[new At(R,u,"array length at least "+c["min-length"]+" expected, length "+u.length+" found")];var Q={type:c.value,values:c.values};C.$version<7&&(Q.function=c.function),es(c.value)==="object"&&(Q=c.value);for(var pe=[],Ie=0;Ie<u.length;Ie++)pe=pe.concat(z({array:u,arrayIndex:Ie,value:u[Ie],valueSpec:Q,style:y,styleSpec:C,key:R+"["+Ie+"]"}));return pe}function Vc(o){var u=o.key,c=o.value,y=o.valueSpec,C=es(c);return C==="number"&&c!=c&&(C="NaN"),C!=="number"?[new At(u,c,"number expected, "+C+" found")]:"minimum"in y&&c<y.minimum?[new At(u,c,c+" is less than the minimum value "+y.minimum)]:"maximum"in y&&c>y.maximum?[new At(u,c,c+" is greater than the maximum value "+y.maximum)]:[]}function Zf(o){var u,c,y,C=o.valueSpec,R=Kr(o.value.type),z={},Q=R!=="categorical"&&o.value.property===void 0,pe=!Q,Ie=es(o.value.stops)==="array"&&es(o.value.stops[0])==="array"&&es(o.value.stops[0][0])==="object",ze=xl({key:o.key,value:o.value,valueSpec:o.styleSpec.function,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(wt){if(R==="identity")return[new At(wt.key,wt.value,'identity function may not have a "stops" property')];var or=[],sr=wt.value;return or=or.concat(nf({key:wt.key,value:sr,valueSpec:wt.valueSpec,style:wt.style,styleSpec:wt.styleSpec,arrayElementValidator:qe})),es(sr)==="array"&&sr.length===0&&or.push(new At(wt.key,sr,"array must have at least one stop")),or},default:function(wt){return Za({key:wt.key,value:wt.value,valueSpec:C,style:wt.style,styleSpec:wt.styleSpec})}}});return R==="identity"&&Q&&ze.push(new At(o.key,o.value,'missing required property "property"')),R==="identity"||o.value.stops||ze.push(new At(o.key,o.value,'missing required property "stops"')),R==="exponential"&&o.valueSpec.expression&&!vl(o.valueSpec)&&ze.push(new At(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(pe&&!ks(o.valueSpec)?ze.push(new At(o.key,o.value,"property functions not supported")):Q&&!Sc(o.valueSpec)&&ze.push(new At(o.key,o.value,"zoom functions not supported"))),R!=="categorical"&&!Ie||o.value.property!==void 0||ze.push(new At(o.key,o.value,'"property" property is required')),ze;function qe(wt){var or=[],sr=wt.value,mr=wt.key;if(es(sr)!=="array")return[new At(mr,sr,"array expected, "+es(sr)+" found")];if(sr.length!==2)return[new At(mr,sr,"array length 2 expected, length "+sr.length+" found")];if(Ie){if(es(sr[0])!=="object")return[new At(mr,sr,"object expected, "+es(sr[0])+" found")];if(sr[0].zoom===void 0)return[new At(mr,sr,"object stop key must have zoom")];if(sr[0].value===void 0)return[new At(mr,sr,"object stop key must have value")];if(y&&y>Kr(sr[0].zoom))return[new At(mr,sr[0].zoom,"stop zoom values must appear in ascending order")];Kr(sr[0].zoom)!==y&&(y=Kr(sr[0].zoom),c=void 0,z={}),or=or.concat(xl({key:mr+"[0]",value:sr[0],valueSpec:{zoom:{}},style:wt.style,styleSpec:wt.styleSpec,objectElementValidators:{zoom:Vc,value:ut}}))}else or=or.concat(ut({key:mr+"[0]",value:sr[0],valueSpec:{},style:wt.style,styleSpec:wt.styleSpec},sr));return ol(Ft(sr[1]))?or.concat([new At(mr+"[1]",sr[1],"expressions are not allowed in function stops.")]):or.concat(Za({key:mr+"[1]",value:sr[1],valueSpec:C,style:wt.style,styleSpec:wt.styleSpec}))}function ut(wt,or){var sr=es(wt.value),mr=Kr(wt.value),yr=wt.value!==null?wt.value:or;if(u){if(sr!==u)return[new At(wt.key,yr,sr+" stop domain type must match previous stop domain type "+u)]}else u=sr;if(sr!=="number"&&sr!=="string"&&sr!=="boolean")return[new At(wt.key,yr,"stop domain value must be a number, string, or boolean")];if(sr!=="number"&&R!=="categorical"){var rn="number expected, "+sr+" found";return ks(C)&&R===void 0&&(rn+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new At(wt.key,yr,rn)]}return R!=="categorical"||sr!=="number"||isFinite(mr)&&Math.floor(mr)===mr?R!=="categorical"&&sr==="number"&&c!==void 0&&mr<c?[new At(wt.key,yr,"stop domain values must appear in ascending order")]:(c=mr,R==="categorical"&&mr in z?[new At(wt.key,yr,"stop domain values must be unique")]:(z[mr]=!0,[])):[new At(wt.key,yr,"integer expected, found "+mr)]}}function Hc(o){var u=(o.expressionContext==="property"?Yu:as)(Ft(o.value),o.valueSpec);if(u.result==="error")return u.value.map(function(y){return new At(""+o.key+y.key,o.value,y.message)});var c=u.value.expression||u.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!c.outputDefined())return[new At(o.key,o.value,'Invalid data expression for "'+o.propertyKey+'". Output values must be contained as literals within the expression.')];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!Mt(c))return[new At(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!Mt(c))return[new At(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!$t(c,["zoom","feature-state"]))return[new At(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!Tt(c))return[new At(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ql(o){var u=o.key,c=o.value,y=o.valueSpec,C=[];return Array.isArray(y.values)?y.values.indexOf(Kr(c))===-1&&C.push(new At(u,c,"expected one of ["+y.values.join(", ")+"], "+JSON.stringify(c)+" found")):Object.keys(y.values).indexOf(Kr(c))===-1&&C.push(new At(u,c,"expected one of ["+Object.keys(y.values).join(", ")+"], "+JSON.stringify(c)+" found")),C}function sl(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(var u=0,c=o.slice(1);u<c.length;u+=1){var y=c[u];if(!sl(y)&&typeof y!="boolean")return!1}return!0;default:return!0}}Ml.deserialize=function(o){return new Ml(o._parameters,o._specification)},Ml.serialize=function(o){return{_parameters:o._parameters,_specification:o._specification}};var vc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Jl(o){if(o==null)return{filter:function(){return!0},needGeometry:!1};sl(o)||(o=gs(o));var u=as(o,vc);if(u.result==="error")throw new Error(u.value.map(function(c){return c.key+": "+c.message}).join(", "));return{filter:function(c,y,C){return u.value.evaluate(c,y,{},C)},needGeometry:function c(y){if(!Array.isArray(y))return!1;if(y[0]==="within")return!0;for(var C=1;C<y.length;C++)if(c(y[C]))return!0;return!1}(o)}}function ts(o,u){return o<u?-1:o>u?1:0}function gs(o){if(!o)return!0;var u,c=o[0];return o.length<=1?c!=="any":c==="=="?$o(o[1],o[2],"=="):c==="!="?Mu($o(o[1],o[2],"==")):c==="<"||c===">"||c==="<="||c===">="?$o(o[1],o[2],c):c==="any"?(u=o.slice(1),["any"].concat(u.map(gs))):c==="all"?["all"].concat(o.slice(1).map(gs)):c==="none"?["all"].concat(o.slice(1).map(gs).map(Mu)):c==="in"?ds(o[1],o.slice(2)):c==="!in"?Mu(ds(o[1],o.slice(2))):c==="has"?Ns(o[1]):c==="!has"?Mu(Ns(o[1])):c!=="within"||o}function $o(o,u,c){switch(o){case"$type":return["filter-type-"+c,u];case"$id":return["filter-id-"+c,u];default:return["filter-"+c,o,u]}}function ds(o,u){if(u.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(function(c){return typeof c!=typeof u[0]})?["filter-in-large",o,["literal",u.sort(ts)]]:["filter-in-small",o,["literal",u]]}}function Ns(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function Mu(o){return["!",o]}function ec(o){return sl(Ft(o.value))?Hc(en({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function u(c){var y=c.value,C=c.key;if(es(y)!=="array")return[new At(C,y,"array expected, "+es(y)+" found")];var R,z=c.styleSpec,Q=[];if(y.length<1)return[new At(C,y,"filter array must have at least 1 element")];switch(Q=Q.concat(Ql({key:C+"[0]",value:y[0],valueSpec:z.filter_operator,style:c.style,styleSpec:c.styleSpec})),Kr(y[0])){case"<":case"<=":case">":case">=":y.length>=2&&Kr(y[1])==="$type"&&Q.push(new At(C,y,'"$type" cannot be use with operator "'+y[0]+'"'));case"==":case"!=":y.length!==3&&Q.push(new At(C,y,'filter array for operator "'+y[0]+'" must have 3 elements'));case"in":case"!in":y.length>=2&&(R=es(y[1]))!=="string"&&Q.push(new At(C+"[1]",y[1],"string expected, "+R+" found"));for(var pe=2;pe<y.length;pe++)R=es(y[pe]),Kr(y[1])==="$type"?Q=Q.concat(Ql({key:C+"["+pe+"]",value:y[pe],valueSpec:z.geometry_type,style:c.style,styleSpec:c.styleSpec})):R!=="string"&&R!=="number"&&R!=="boolean"&&Q.push(new At(C+"["+pe+"]",y[pe],"string, number, or boolean expected, "+R+" found"));break;case"any":case"all":case"none":for(var Ie=1;Ie<y.length;Ie++)Q=Q.concat(u({key:C+"["+Ie+"]",value:y[Ie],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":R=es(y[1]),y.length!==2?Q.push(new At(C,y,'filter array for "'+y[0]+'" operator must have 2 elements')):R!=="string"&&Q.push(new At(C+"[1]",y[1],"string expected, "+R+" found"));break;case"within":R=es(y[1]),y.length!==2?Q.push(new At(C,y,'filter array for "'+y[0]+'" operator must have 2 elements')):R!=="object"&&Q.push(new At(C+"[1]",y[1],"object expected, "+R+" found"))}return Q}(o)}function zs(o,u){var c=o.key,y=o.style,C=o.styleSpec,R=o.value,z=o.objectKey,Q=C[u+"_"+o.layerType];if(!Q)return[];var pe=z.match(/^(.*)-transition$/);if(u==="paint"&&pe&&Q[pe[1]]&&Q[pe[1]].transition)return Za({key:c,value:R,valueSpec:C.transition,style:y,styleSpec:C});var Ie,ze=o.valueSpec||Q[z];if(!ze)return[new At(c,R,'unknown property "'+z+'"')];if(es(R)==="string"&&ks(ze)&&!ze.tokens&&(Ie=/^{([^}]+)}$/.exec(R)))return[new At(c,R,'"'+z+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(Ie[1])+" }`.")];var qe=[];return o.layerType==="symbol"&&(z==="text-field"&&y&&!y.glyphs&&qe.push(new At(c,R,'use of "text-field" requires a style "glyphs" property')),z==="text-font"&&Al(Ft(R))&&Kr(R.type)==="identity"&&qe.push(new At(c,R,'"text-font" does not support identity functions'))),qe.concat(Za({key:o.key,value:R,valueSpec:ze,style:y,styleSpec:C,expressionContext:"property",propertyType:u,propertyKey:z}))}function df(o){return zs(o,"paint")}function ha(o){return zs(o,"layout")}function Gc(o){var u=[],c=o.value,y=o.key,C=o.style,R=o.styleSpec;c.type||c.ref||u.push(new At(y,c,'either "type" or "ref" is required'));var z,Q=Kr(c.type),pe=Kr(c.ref);if(c.id)for(var Ie=Kr(c.id),ze=0;ze<o.arrayIndex;ze++){var qe=C.layers[ze];Kr(qe.id)===Ie&&u.push(new At(y,c.id,'duplicate layer id "'+c.id+'", previously used at line '+qe.id.__line__))}if("ref"in c)["type","source","source-layer","filter","layout"].forEach(function(or){or in c&&u.push(new At(y,c[or],'"'+or+'" is prohibited for ref layers'))}),C.layers.forEach(function(or){Kr(or.id)===pe&&(z=or)}),z?z.ref?u.push(new At(y,c.ref,"ref cannot reference another ref layer")):Q=Kr(z.type):u.push(new At(y,c.ref,'ref layer "'+pe+'" not found'));else if(Q!=="background")if(c.source){var ut=C.sources&&C.sources[c.source],wt=ut&&Kr(ut.type);ut?wt==="vector"&&Q==="raster"?u.push(new At(y,c.source,'layer "'+c.id+'" requires a raster source')):wt==="raster"&&Q!=="raster"?u.push(new At(y,c.source,'layer "'+c.id+'" requires a vector source')):wt!=="vector"||c["source-layer"]?wt==="raster-dem"&&Q!=="hillshade"?u.push(new At(y,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):Q!=="line"||!c.paint||!c.paint["line-gradient"]||wt==="geojson"&&ut.lineMetrics||u.push(new At(y,c,'layer "'+c.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):u.push(new At(y,c,'layer "'+c.id+'" must specify a "source-layer"')):u.push(new At(y,c.source,'source "'+c.source+'" not found'))}else u.push(new At(y,c,'missing required property "source"'));return u=u.concat(xl({key:y,value:c,valueSpec:R.layer,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Za({key:y+".type",value:c.type,valueSpec:R.layer.type,style:o.style,styleSpec:o.styleSpec,object:c,objectKey:"type"})},filter:ec,layout:function(or){return xl({layer:c,key:or.key,value:or.value,style:or.style,styleSpec:or.styleSpec,objectElementValidators:{"*":function(sr){return ha(en({layerType:Q},sr))}}})},paint:function(or){return xl({layer:c,key:or.key,value:or.value,style:or.style,styleSpec:or.styleSpec,objectElementValidators:{"*":function(sr){return df(en({layerType:Q},sr))}}})}}}))}function kc(o){var u=o.value,c=o.key,y=es(u);return y!=="string"?[new At(c,u,"string expected, "+y+" found")]:[]}var un={promoteId:function(o){var u=o.key,c=o.value;if(es(c)==="string")return kc({key:u,value:c});var y=[];for(var C in c)y.push.apply(y,kc({key:u+"."+C,value:c[C]}));return y}};function Mi(o){var u=o.value,c=o.key,y=o.styleSpec,C=o.style;if(!u.type)return[new At(c,u,'"type" is required')];var R,z=Kr(u.type);switch(z){case"vector":case"raster":case"raster-dem":return xl({key:c,value:u,valueSpec:y["source_"+z.replace("-","_")],style:o.style,styleSpec:y,objectElementValidators:un});case"geojson":if(R=xl({key:c,value:u,valueSpec:y.source_geojson,style:C,styleSpec:y,objectElementValidators:un}),u.cluster)for(var Q in u.clusterProperties){var pe=u.clusterProperties[Q],Ie=pe[0],ze=typeof Ie=="string"?[Ie,["accumulated"],["get",Q]]:Ie;R.push.apply(R,Hc({key:c+"."+Q+".map",value:pe[1],expressionContext:"cluster-map"})),R.push.apply(R,Hc({key:c+"."+Q+".reduce",value:ze,expressionContext:"cluster-reduce"}))}return R;case"video":return xl({key:c,value:u,valueSpec:y.source_video,style:C,styleSpec:y});case"image":return xl({key:c,value:u,valueSpec:y.source_image,style:C,styleSpec:y});case"canvas":return[new At(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ql({key:c+".type",value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:C,styleSpec:y})}}function ei(o){var u=o.value,c=o.styleSpec,y=c.light,C=o.style,R=[],z=es(u);if(u===void 0)return R;if(z!=="object")return R.concat([new At("light",u,"object expected, "+z+" found")]);for(var Q in u){var pe=Q.match(/^(.*)-transition$/);R=R.concat(pe&&y[pe[1]]&&y[pe[1]].transition?Za({key:Q,value:u[Q],valueSpec:c.transition,style:C,styleSpec:c}):y[Q]?Za({key:Q,value:u[Q],valueSpec:y[Q],style:C,styleSpec:c}):[new At(Q,u[Q],'unknown property "'+Q+'"')])}return R}var za={"*":function(){return[]},array:nf,boolean:function(o){var u=o.value,c=o.key,y=es(u);return y!=="boolean"?[new At(c,u,"boolean expected, "+y+" found")]:[]},number:Vc,color:function(o){var u=o.key,c=o.value,y=es(c);return y!=="string"?[new At(u,c,"color expected, "+y+" found")]:ct(c)===null?[new At(u,c,'color expected, "'+c+'" found')]:[]},constants:tr,enum:Ql,filter:ec,function:Zf,layer:Gc,object:xl,source:Mi,light:ei,string:kc,formatted:function(o){return kc(o).length===0?[]:Hc(o)},resolvedImage:function(o){return kc(o).length===0?[]:Hc(o)}};function Za(o){var u=o.value,c=o.valueSpec,y=o.styleSpec;return c.expression&&Al(Kr(u))?Zf(o):c.expression&&ol(Ft(u))?Hc(o):c.type&&za[c.type]?za[c.type](o):xl(en({},o,{valueSpec:c.type?y[c.type]:c}))}function Oo(o){var u=o.value,c=o.key,y=kc(o);return y.length||(u.indexOf("{fontstack}")===-1&&y.push(new At(c,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&y.push(new At(c,u,'"glyphs" url must include a "{range}" token'))),y}function mu(o,u){u===void 0&&(u=tt);var c=[];return c=c.concat(Za({key:"",value:o,valueSpec:u.$root,styleSpec:u,style:o,objectElementValidators:{glyphs:Oo,"*":function(){return[]}}})),o.constants&&(c=c.concat(tr({key:"constants",value:o.constants,style:o,styleSpec:u}))),Au(c)}function Au(o){return[].concat(o).sort(function(u,c){return u.line-c.line})}function Rl(o){return function(){for(var u=[],c=arguments.length;c--;)u[c]=arguments[c];return Au(o.apply(this,u))}}mu.source=Rl(Mi),mu.light=Rl(ei),mu.layer=Rl(Gc),mu.filter=Rl(ec),mu.paintProperty=Rl(df),mu.layoutProperty=Rl(ha);var xh=mu,vf=xh.light,Wh=xh.paintProperty,oh=xh.layoutProperty;function mc(o,u){var c=!1;if(u&&u.length)for(var y=0,C=u;y<C.length;y+=1)o.fire(new Le(new Error(C[y].message))),c=!0;return c}var lc=Ku;function Ku(o,u,c){var y=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var C=new Int32Array(this.arrayBuffer);o=C[0],this.d=(u=C[1])+2*(c=C[2]);for(var R=0;R<this.d*this.d;R++){var z=C[3+R],Q=C[3+R+1];y.push(z===Q?null:C.subarray(z,Q))}var pe=C[3+y.length+1];this.keys=C.subarray(C[3+y.length],pe),this.bboxes=C.subarray(pe),this.insert=this._insertReadonly}else{this.d=u+2*c;for(var Ie=0;Ie<this.d*this.d;Ie++)y.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=o,this.padding=c,this.scale=u/o,this.uid=0;var ze=c/u*o;this.min=-ze,this.max=o+ze}Ku.prototype.insert=function(o,u,c,y,C){this._forEachCell(u,c,y,C,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(u),this.bboxes.push(c),this.bboxes.push(y),this.bboxes.push(C)},Ku.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ku.prototype._insertCell=function(o,u,c,y,C,R){this.cells[C].push(R)},Ku.prototype.query=function(o,u,c,y,C){var R=this.min,z=this.max;if(o<=R&&u<=R&&z<=c&&z<=y&&!C)return Array.prototype.slice.call(this.keys);var Q=[];return this._forEachCell(o,u,c,y,this._queryCell,Q,{},C),Q},Ku.prototype._queryCell=function(o,u,c,y,C,R,z,Q){var pe=this.cells[C];if(pe!==null)for(var Ie=this.keys,ze=this.bboxes,qe=0;qe<pe.length;qe++){var ut=pe[qe];if(z[ut]===void 0){var wt=4*ut;(Q?Q(ze[wt+0],ze[wt+1],ze[wt+2],ze[wt+3]):o<=ze[wt+2]&&u<=ze[wt+3]&&c>=ze[wt+0]&&y>=ze[wt+1])?(z[ut]=!0,R.push(Ie[ut])):z[ut]=!1}}},Ku.prototype._forEachCell=function(o,u,c,y,C,R,z,Q){for(var pe=this._convertToCellCoord(o),Ie=this._convertToCellCoord(u),ze=this._convertToCellCoord(c),qe=this._convertToCellCoord(y),ut=pe;ut<=ze;ut++)for(var wt=Ie;wt<=qe;wt++){var or=this.d*wt+ut;if((!Q||Q(this._convertFromCellCoord(ut),this._convertFromCellCoord(wt),this._convertFromCellCoord(ut+1),this._convertFromCellCoord(wt+1)))&&C.call(this,o,u,c,y,or,R,z,Q))return}},Ku.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},Ku.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},Ku.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,u=3+this.cells.length+1+1,c=0,y=0;y<this.cells.length;y++)c+=this.cells[y].length;var C=new Int32Array(u+c+this.keys.length+this.bboxes.length);C[0]=this.extent,C[1]=this.n,C[2]=this.padding;for(var R=u,z=0;z<o.length;z++){var Q=o[z];C[3+z]=R,C.set(Q,R),R+=Q.length}return C[3+o.length]=R,C.set(this.keys,R),C[3+o.length+1]=R+=this.keys.length,C.set(this.bboxes,R),R+=this.bboxes.length,C.buffer};var xs=G.ImageData,sh=G.ImageBitmap,bl={};function Ca(o,u,c){c===void 0&&(c={}),Object.defineProperty(u,"_classRegistryKey",{value:o,writeable:!1}),bl[o]={klass:u,omit:c.omit||[],shallow:c.shallow||[]}}for(var Zu in Ca("Object",Object),lc.serialize=function(o,u){var c=o.toArrayBuffer();return u&&u.push(c),{buffer:c}},lc.deserialize=function(o){return new lc(o.buffer)},Ca("Grid",lc),Ca("Color",qi),Ca("Error",Error),Ca("ResolvedImage",Ga),Ca("StylePropertyFunction",Ml),Ca("StyleExpression",rf,{omit:["_evaluator"]}),Ca("ZoomDependentExpression",Tl),Ca("ZoomConstantExpression",Ds),Ca("CompoundExpression",ms,{omit:["_evaluate"]}),ps)ps[Zu]._classRegistryKey||Ca("Expression_"+Zu,ps[Zu]);function $c(o){return o&&typeof ArrayBuffer!="undefined"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function os(o){return sh&&o instanceof sh}function yo(o,u){if(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp)return o;if($c(o)||os(o))return u&&u.push(o),o;if(ArrayBuffer.isView(o)){var c=o;return u&&u.push(c.buffer),c}if(o instanceof xs)return u&&u.push(o.data.buffer),o;if(Array.isArray(o)){for(var y=[],C=0,R=o;C<R.length;C+=1)y.push(yo(R[C],u));return y}if(typeof o=="object"){var z=o.constructor,Q=z._classRegistryKey;if(!Q)throw new Error("can't serialize object of unregistered class");var pe=z.serialize?z.serialize(o,u):{};if(!z.serialize){for(var Ie in o)if(o.hasOwnProperty(Ie)&&!(bl[Q].omit.indexOf(Ie)>=0)){var ze=o[Ie];pe[Ie]=bl[Q].shallow.indexOf(Ie)>=0?ze:yo(ze,u)}o instanceof Error&&(pe.message=o.message)}if(pe.$name)throw new Error("$name property is reserved for worker serialization logic.");return Q!=="Object"&&(pe.$name=Q),pe}throw new Error("can't serialize object of type "+typeof o)}function As(o){if(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||$c(o)||os(o)||ArrayBuffer.isView(o)||o instanceof xs)return o;if(Array.isArray(o))return o.map(As);if(typeof o=="object"){var u=o.$name||"Object",c=bl[u].klass;if(!c)throw new Error("can't deserialize unregistered class "+u);if(c.deserialize)return c.deserialize(o);for(var y=Object.create(c.prototype),C=0,R=Object.keys(o);C<R.length;C+=1){var z=R[C];if(z!=="$name"){var Q=o[z];y[z]=bl[u].shallow.indexOf(z)>=0?Q:As(Q)}}return y}throw new Error("can't deserialize object of type "+typeof o)}var Ul=function(){this.first=!0};Ul.prototype.update=function(o,u){var c=Math.floor(o);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=o,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=u),o!==this.lastZoom&&(this.lastZoom=o,this.lastFloorZoom=c,!0))};var Xi={"Latin-1 Supplement":function(o){return o>=128&&o<=255},Arabic:function(o){return o>=1536&&o<=1791},"Arabic Supplement":function(o){return o>=1872&&o<=1919},"Arabic Extended-A":function(o){return o>=2208&&o<=2303},"Hangul Jamo":function(o){return o>=4352&&o<=4607},"Unified Canadian Aboriginal Syllabics":function(o){return o>=5120&&o<=5759},Khmer:function(o){return o>=6016&&o<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(o){return o>=6320&&o<=6399},"General Punctuation":function(o){return o>=8192&&o<=8303},"Letterlike Symbols":function(o){return o>=8448&&o<=8527},"Number Forms":function(o){return o>=8528&&o<=8591},"Miscellaneous Technical":function(o){return o>=8960&&o<=9215},"Control Pictures":function(o){return o>=9216&&o<=9279},"Optical Character Recognition":function(o){return o>=9280&&o<=9311},"Enclosed Alphanumerics":function(o){return o>=9312&&o<=9471},"Geometric Shapes":function(o){return o>=9632&&o<=9727},"Miscellaneous Symbols":function(o){return o>=9728&&o<=9983},"Miscellaneous Symbols and Arrows":function(o){return o>=11008&&o<=11263},"CJK Radicals Supplement":function(o){return o>=11904&&o<=12031},"Kangxi Radicals":function(o){return o>=12032&&o<=12255},"Ideographic Description Characters":function(o){return o>=12272&&o<=12287},"CJK Symbols and Punctuation":function(o){return o>=12288&&o<=12351},Hiragana:function(o){return o>=12352&&o<=12447},Katakana:function(o){return o>=12448&&o<=12543},Bopomofo:function(o){return o>=12544&&o<=12591},"Hangul Compatibility Jamo":function(o){return o>=12592&&o<=12687},Kanbun:function(o){return o>=12688&&o<=12703},"Bopomofo Extended":function(o){return o>=12704&&o<=12735},"CJK Strokes":function(o){return o>=12736&&o<=12783},"Katakana Phonetic Extensions":function(o){return o>=12784&&o<=12799},"Enclosed CJK Letters and Months":function(o){return o>=12800&&o<=13055},"CJK Compatibility":function(o){return o>=13056&&o<=13311},"CJK Unified Ideographs Extension A":function(o){return o>=13312&&o<=19903},"Yijing Hexagram Symbols":function(o){return o>=19904&&o<=19967},"CJK Unified Ideographs":function(o){return o>=19968&&o<=40959},"Yi Syllables":function(o){return o>=40960&&o<=42127},"Yi Radicals":function(o){return o>=42128&&o<=42191},"Hangul Jamo Extended-A":function(o){return o>=43360&&o<=43391},"Hangul Syllables":function(o){return o>=44032&&o<=55215},"Hangul Jamo Extended-B":function(o){return o>=55216&&o<=55295},"Private Use Area":function(o){return o>=57344&&o<=63743},"CJK Compatibility Ideographs":function(o){return o>=63744&&o<=64255},"Arabic Presentation Forms-A":function(o){return o>=64336&&o<=65023},"Vertical Forms":function(o){return o>=65040&&o<=65055},"CJK Compatibility Forms":function(o){return o>=65072&&o<=65103},"Small Form Variants":function(o){return o>=65104&&o<=65135},"Arabic Presentation Forms-B":function(o){return o>=65136&&o<=65279},"Halfwidth and Fullwidth Forms":function(o){return o>=65280&&o<=65519}};function cc(o){for(var u=0,c=o;u<c.length;u+=1)if(Dc(c[u].charCodeAt(0)))return!0;return!1}function Dc(o){return!(o!==746&&o!==747&&(o<4352||!(Xi["Bopomofo Extended"](o)||Xi.Bopomofo(o)||Xi["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||Xi["CJK Compatibility Ideographs"](o)||Xi["CJK Compatibility"](o)||Xi["CJK Radicals Supplement"](o)||Xi["CJK Strokes"](o)||!(!Xi["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||Xi["CJK Unified Ideographs Extension A"](o)||Xi["CJK Unified Ideographs"](o)||Xi["Enclosed CJK Letters and Months"](o)||Xi["Hangul Compatibility Jamo"](o)||Xi["Hangul Jamo Extended-A"](o)||Xi["Hangul Jamo Extended-B"](o)||Xi["Hangul Jamo"](o)||Xi["Hangul Syllables"](o)||Xi.Hiragana(o)||Xi["Ideographic Description Characters"](o)||Xi.Kanbun(o)||Xi["Kangxi Radicals"](o)||Xi["Katakana Phonetic Extensions"](o)||Xi.Katakana(o)&&o!==12540||!(!Xi["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!Xi["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||Xi["Unified Canadian Aboriginal Syllabics"](o)||Xi["Unified Canadian Aboriginal Syllabics Extended"](o)||Xi["Vertical Forms"](o)||Xi["Yijing Hexagram Symbols"](o)||Xi["Yi Syllables"](o)||Xi["Yi Radicals"](o))))}function af(o){return!(Dc(o)||function(u){return!!(Xi["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||Xi["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||Xi["Letterlike Symbols"](u)||Xi["Number Forms"](u)||Xi["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||Xi["Control Pictures"](u)&&u!==9251||Xi["Optical Character Recognition"](u)||Xi["Enclosed Alphanumerics"](u)||Xi["Geometric Shapes"](u)||Xi["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||Xi["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||Xi["CJK Symbols and Punctuation"](u)||Xi.Katakana(u)||Xi["Private Use Area"](u)||Xi["CJK Compatibility Forms"](u)||Xi["Small Form Variants"](u)||Xi["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(o))}function Ws(o){return o>=1424&&o<=2303||Xi["Arabic Presentation Forms-A"](o)||Xi["Arabic Presentation Forms-B"](o)}function kl(o,u){return!(!u&&Ws(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||Xi.Khmer(o))}function Cc(o){for(var u=0,c=o;u<c.length;u+=1)if(Ws(c[u].charCodeAt(0)))return!0;return!1}var fc=null,Fc="unavailable",Sf=null,hc=function(o){o&&typeof o=="string"&&o.indexOf("NetworkError")>-1&&(Fc="error"),fc&&fc(o)};function ap(){jl.fire(new Bt("pluginStateChange",{pluginStatus:Fc,pluginURL:Sf}))}var jl=new St,op=function(){return Fc},tc=function(){if(Fc!=="deferred"||!Sf)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Fc="loading",ap(),Sf&&an({url:Sf},function(o){o?hc(o):(Fc="loaded",ap())})},Tu={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Fc==="loaded"||Tu.applyArabicShaping!=null},isLoading:function(){return Fc==="loading"},setState:function(o){Fc=o.pluginStatus,Sf=o.pluginURL},isParsed:function(){return Tu.applyArabicShaping!=null&&Tu.processBidirectionalText!=null&&Tu.processStyledBidirectionalText!=null},getPluginURL:function(){return Sf}},bs=function(o,u){this.zoom=o,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ul,this.transition={})};bs.prototype.isSupportedScript=function(o){return function(u,c){for(var y=0,C=u;y<C.length;y+=1)if(!kl(C[y].charCodeAt(0),c))return!1;return!0}(o,Tu.isLoaded())},bs.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},bs.prototype.getCrossfadeParameters=function(){var o=this.zoom,u=o-Math.floor(o),c=this.crossFadingFactor();return o>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*u}};var Xf=function(o,u){this.property=o,this.value=u,this.expression=function(c,y){if(Al(c))return new Ml(c,y);if(ol(c)){var C=Yu(c,y);if(C.result==="error")throw new Error(C.value.map(function(z){return z.key+": "+z.message}).join(", "));return C.value}var R=c;return typeof c=="string"&&y.type==="color"&&(R=qi.parse(c)),{kind:"constant",evaluate:function(){return R}}}(u===void 0?o.specification.default:u,o.specification)};Xf.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Xf.prototype.possiblyEvaluate=function(o,u,c){return this.property.possiblyEvaluate(this,o,u,c)};var Cf=function(o){this.property=o,this.value=new Xf(o,void 0)};Cf.prototype.transitioned=function(o,u){return new Dl(this.property,this.value,u,me({},o.transition,this.transition),o.now)},Cf.prototype.untransitioned=function(){return new Dl(this.property,this.value,null,{},0)};var cu=function(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)};cu.prototype.getValue=function(o){return Ae(this._values[o].value.value)},cu.prototype.setValue=function(o,u){this._values.hasOwnProperty(o)||(this._values[o]=new Cf(this._values[o].property)),this._values[o].value=new Xf(this._values[o].property,u===null?void 0:Ae(u))},cu.prototype.getTransition=function(o){return Ae(this._values[o].transition)},cu.prototype.setTransition=function(o,u){this._values.hasOwnProperty(o)||(this._values[o]=new Cf(this._values[o].property)),this._values[o].transition=Ae(u)||void 0},cu.prototype.serialize=function(){for(var o={},u=0,c=Object.keys(this._values);u<c.length;u+=1){var y=c[u],C=this.getValue(y);C!==void 0&&(o[y]=C);var R=this.getTransition(y);R!==void 0&&(o[y+"-transition"]=R)}return o},cu.prototype.transitioned=function(o,u){for(var c=new mf(this._properties),y=0,C=Object.keys(this._values);y<C.length;y+=1){var R=C[y];c._values[R]=this._values[R].transitioned(o,u._values[R])}return c},cu.prototype.untransitioned=function(){for(var o=new mf(this._properties),u=0,c=Object.keys(this._values);u<c.length;u+=1){var y=c[u];o._values[y]=this._values[y].untransitioned()}return o};var Dl=function(o,u,c,y,C){this.property=o,this.value=u,this.begin=C+y.delay||0,this.end=this.begin+y.duration||0,o.specification.transition&&(y.delay||y.duration)&&(this.prior=c)};Dl.prototype.possiblyEvaluate=function(o,u,c){var y=o.now||0,C=this.value.possiblyEvaluate(o,u,c),R=this.prior;if(R){if(y>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(y<this.begin)return R.possiblyEvaluate(o,u,c);var z=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(R.possiblyEvaluate(o,u,c),C,function(Q){if(Q<=0)return 0;if(Q>=1)return 1;var pe=Q*Q,Ie=pe*Q;return 4*(Q<.5?Ie:3*(Q-pe)+Ie-.75)}(z))}return C};var mf=function(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)};mf.prototype.possiblyEvaluate=function(o,u,c){for(var y=new Yf(this._properties),C=0,R=Object.keys(this._values);C<R.length;C+=1){var z=R[C];y._values[z]=this._values[z].possiblyEvaluate(o,u,c)}return y},mf.prototype.hasTransition=function(){for(var o=0,u=Object.keys(this._values);o<u.length;o+=1)if(this._values[u[o]].prior)return!0;return!1};var Fl=function(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)};Fl.prototype.getValue=function(o){return Ae(this._values[o].value)},Fl.prototype.setValue=function(o,u){this._values[o]=new Xf(this._values[o].property,u===null?void 0:Ae(u))},Fl.prototype.serialize=function(){for(var o={},u=0,c=Object.keys(this._values);u<c.length;u+=1){var y=c[u],C=this.getValue(y);C!==void 0&&(o[y]=C)}return o},Fl.prototype.possiblyEvaluate=function(o,u,c){for(var y=new Yf(this._properties),C=0,R=Object.keys(this._values);C<R.length;C+=1){var z=R[C];y._values[z]=this._values[z].possiblyEvaluate(o,u,c)}return y};var Ac=function(o,u,c){this.property=o,this.value=u,this.parameters=c};Ac.prototype.isConstant=function(){return this.value.kind==="constant"},Ac.prototype.constantOr=function(o){return this.value.kind==="constant"?this.value.value:o},Ac.prototype.evaluate=function(o,u,c,y){return this.property.evaluate(this.value,this.parameters,o,u,c,y)};var Yf=function(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)};Yf.prototype.get=function(o){return this._values[o]};var Qi=function(o){this.specification=o};Qi.prototype.possiblyEvaluate=function(o,u){return o.expression.evaluate(u)},Qi.prototype.interpolate=function(o,u,c){var y=Xt[this.specification.type];return y?y(o,u,c):o};var Xa=function(o,u){this.specification=o,this.overrides=u};Xa.prototype.possiblyEvaluate=function(o,u,c,y){return new Ac(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(u,null,{},c,y)}:o.expression,u)},Xa.prototype.interpolate=function(o,u,c){if(o.value.kind!=="constant"||u.value.kind!=="constant")return o;if(o.value.value===void 0||u.value.value===void 0)return new Ac(this,{kind:"constant",value:void 0},o.parameters);var y=Xt[this.specification.type];return y?new Ac(this,{kind:"constant",value:y(o.value.value,u.value.value,c)},o.parameters):o},Xa.prototype.evaluate=function(o,u,c,y,C,R){return o.kind==="constant"?o.value:o.evaluate(u,c,y,C,R)};var of=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.possiblyEvaluate=function(c,y,C,R){if(c.value===void 0)return new Ac(this,{kind:"constant",value:void 0},y);if(c.expression.kind==="constant"){var z=c.expression.evaluate(y,null,{},C,R),Q=c.property.specification.type==="resolvedImage"&&typeof z!="string"?z.name:z,pe=this._calculate(Q,Q,Q,y);return new Ac(this,{kind:"constant",value:pe},y)}if(c.expression.kind==="camera"){var Ie=this._calculate(c.expression.evaluate({zoom:y.zoom-1}),c.expression.evaluate({zoom:y.zoom}),c.expression.evaluate({zoom:y.zoom+1}),y);return new Ac(this,{kind:"constant",value:Ie},y)}return new Ac(this,c.expression,y)},u.prototype.evaluate=function(c,y,C,R,z,Q){if(c.kind==="source"){var pe=c.evaluate(y,C,R,z,Q);return this._calculate(pe,pe,pe,y)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(y.zoom)-1},C,R),c.evaluate({zoom:Math.floor(y.zoom)},C,R),c.evaluate({zoom:Math.floor(y.zoom)+1},C,R),y):c.value},u.prototype._calculate=function(c,y,C,R){return R.zoom>R.zoomHistory.lastIntegerZoom?{from:c,to:y}:{from:C,to:y}},u.prototype.interpolate=function(c){return c},u}(Xa),Pl=function(o){this.specification=o};Pl.prototype.possiblyEvaluate=function(o,u,c,y){if(o.value!==void 0){if(o.expression.kind==="constant"){var C=o.expression.evaluate(u,null,{},c,y);return this._calculate(C,C,C,u)}return this._calculate(o.expression.evaluate(new bs(Math.floor(u.zoom-1),u)),o.expression.evaluate(new bs(Math.floor(u.zoom),u)),o.expression.evaluate(new bs(Math.floor(u.zoom+1),u)),u)}},Pl.prototype._calculate=function(o,u,c,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:o,to:u}:{from:c,to:u}},Pl.prototype.interpolate=function(o){return o};var Bc=function(o){this.specification=o};Bc.prototype.possiblyEvaluate=function(o,u,c,y){return!!o.expression.evaluate(u,null,{},c,y)},Bc.prototype.interpolate=function(){return!1};var Qu=function(o){for(var u in this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],o){var c=o[u];c.specification.overridable&&this.overridableProperties.push(u);var y=this.defaultPropertyValues[u]=new Xf(c,void 0),C=this.defaultTransitionablePropertyValues[u]=new Cf(c);this.defaultTransitioningPropertyValues[u]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=y.possiblyEvaluate({})}};Ca("DataDrivenProperty",Xa),Ca("DataConstantProperty",Qi),Ca("CrossFadedDataDrivenProperty",of),Ca("CrossFadedProperty",Pl),Ca("ColorRampProperty",Bc);var ul=function(o){function u(c,y){if(o.call(this),this.id=c.id,this.type=c.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},c.type!=="custom"&&(this.metadata=(c=c).metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter),y.layout&&(this._unevaluatedLayout=new Fl(y.layout)),y.paint)){for(var C in this._transitionablePaint=new cu(y.paint),c.paint)this.setPaintProperty(C,c.paint[C],{validate:!1});for(var R in c.layout)this.setLayoutProperty(R,c.layout[R],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Yf(y.paint)}}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},u.prototype.getLayoutProperty=function(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)},u.prototype.setLayoutProperty=function(c,y,C){C===void 0&&(C={}),y!=null&&this._validate(oh,"layers."+this.id+".layout."+c,c,y,C)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,y):this.visibility=y)},u.prototype.getPaintProperty=function(c){return ie(c,"-transition")?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)},u.prototype.setPaintProperty=function(c,y,C){if(C===void 0&&(C={}),y!=null&&this._validate(Wh,"layers."+this.id+".paint."+c,c,y,C))return!1;if(ie(c,"-transition"))return this._transitionablePaint.setTransition(c.slice(0,-11),y||void 0),!1;var R=this._transitionablePaint._values[c],z=R.property.specification["property-type"]==="cross-faded-data-driven",Q=R.value.isDataDriven(),pe=R.value;this._transitionablePaint.setValue(c,y),this._handleSpecialPaintPropertyUpdate(c);var Ie=this._transitionablePaint._values[c].value;return Ie.isDataDriven()||Q||z||this._handleOverridablePaintPropertyUpdate(c,pe,Ie)},u.prototype._handleSpecialPaintPropertyUpdate=function(c){},u.prototype._handleOverridablePaintPropertyUpdate=function(c,y,C){return!1},u.prototype.isHidden=function(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"},u.prototype.updateTransitions=function(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)},u.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},u.prototype.recalculate=function(c,y){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,y)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,y)},u.prototype.serialize=function(){var c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),ve(c,function(y,C){return!(y===void 0||C==="layout"&&!Object.keys(y).length||C==="paint"&&!Object.keys(y).length)})},u.prototype._validate=function(c,y,C,R,z){return z===void 0&&(z={}),(!z||z.validate!==!1)&&mc(this,c.call(xh,{key:y,layerType:this.type,objectKey:C,value:R,styleSpec:tt,style:{glyphs:!0,sprite:!0}}))},u.prototype.is3D=function(){return!1},u.prototype.isTileClipped=function(){return!1},u.prototype.hasOffscreenPass=function(){return!1},u.prototype.resize=function(){},u.prototype.isStateDependent=function(){for(var c in this.paint._values){var y=this.paint.get(c);if(y instanceof Ac&&ks(y.property.specification)&&(y.value.kind==="source"||y.value.kind==="composite")&&y.value.isStateDependent)return!0}return!1},u}(St),uh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},sp=function(o,u){this._structArray=o,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},fu=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Pu(o,u){u===void 0&&(u=1);var c=0,y=0;return{members:o.map(function(C){var R=uh[C.type].BYTES_PER_ELEMENT,z=c=up(c,Math.max(u,R)),Q=C.components||1;return y=Math.max(y,R),c+=R*Q,{name:C.name,type:C.type,components:Q,offset:z}}),size:up(c,Math.max(y,u)),alignment:u}}function up(o,u){return Math.ceil(o/u)*u}fu.serialize=function(o,u){return o._trim(),u&&(o.isTransferred=!0,u.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}},fu.deserialize=function(o){var u=Object.create(this.prototype);return u.arrayBuffer=o.arrayBuffer,u.length=o.length,u.capacity=o.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u},fu.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},fu.prototype.clear=function(){this.length=0},fu.prototype.resize=function(o){this.reserve(o),this.length=o},fu.prototype.reserve=function(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}},fu.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ja=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y){var C=this.length;return this.resize(C+1),this.emplace(C,c,y)},u.prototype.emplace=function(c,y,C){var R=2*c;return this.int16[R+0]=y,this.int16[R+1]=C,c},u}(fu);Ja.prototype.bytesPerElement=4,Ca("StructArrayLayout2i4",Ja);var Kn=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R){var z=this.length;return this.resize(z+1),this.emplace(z,c,y,C,R)},u.prototype.emplace=function(c,y,C,R,z){var Q=4*c;return this.int16[Q+0]=y,this.int16[Q+1]=C,this.int16[Q+2]=R,this.int16[Q+3]=z,c},u}(fu);Kn.prototype.bytesPerElement=8,Ca("StructArrayLayout4i8",Kn);var Wc=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R,z,Q){var pe=this.length;return this.resize(pe+1),this.emplace(pe,c,y,C,R,z,Q)},u.prototype.emplace=function(c,y,C,R,z,Q,pe){var Ie=6*c;return this.int16[Ie+0]=y,this.int16[Ie+1]=C,this.int16[Ie+2]=R,this.int16[Ie+3]=z,this.int16[Ie+4]=Q,this.int16[Ie+5]=pe,c},u}(fu);Wc.prototype.bytesPerElement=12,Ca("StructArrayLayout2i4i12",Wc);var Ju=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R,z,Q){var pe=this.length;return this.resize(pe+1),this.emplace(pe,c,y,C,R,z,Q)},u.prototype.emplace=function(c,y,C,R,z,Q,pe){var Ie=4*c,ze=8*c;return this.int16[Ie+0]=y,this.int16[Ie+1]=C,this.uint8[ze+4]=R,this.uint8[ze+5]=z,this.uint8[ze+6]=Q,this.uint8[ze+7]=pe,c},u}(fu);Ju.prototype.bytesPerElement=8,Ca("StructArrayLayout2i4ub8",Ju);var Nt=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y){var C=this.length;return this.resize(C+1),this.emplace(C,c,y)},u.prototype.emplace=function(c,y,C){var R=2*c;return this.float32[R+0]=y,this.float32[R+1]=C,c},u}(fu);Nt.prototype.bytesPerElement=8,Ca("StructArrayLayout2f8",Nt);var Xc=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R,z,Q,pe,Ie,ze,qe){var ut=this.length;return this.resize(ut+1),this.emplace(ut,c,y,C,R,z,Q,pe,Ie,ze,qe)},u.prototype.emplace=function(c,y,C,R,z,Q,pe,Ie,ze,qe,ut){var wt=10*c;return this.uint16[wt+0]=y,this.uint16[wt+1]=C,this.uint16[wt+2]=R,this.uint16[wt+3]=z,this.uint16[wt+4]=Q,this.uint16[wt+5]=pe,this.uint16[wt+6]=Ie,this.uint16[wt+7]=ze,this.uint16[wt+8]=qe,this.uint16[wt+9]=ut,c},u}(fu);Xc.prototype.bytesPerElement=20,Ca("StructArrayLayout10ui20",Xc);var ss=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt){var or=this.length;return this.resize(or+1),this.emplace(or,c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt)},u.prototype.emplace=function(c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or){var sr=12*c;return this.int16[sr+0]=y,this.int16[sr+1]=C,this.int16[sr+2]=R,this.int16[sr+3]=z,this.uint16[sr+4]=Q,this.uint16[sr+5]=pe,this.uint16[sr+6]=Ie,this.uint16[sr+7]=ze,this.int16[sr+8]=qe,this.int16[sr+9]=ut,this.int16[sr+10]=wt,this.int16[sr+11]=or,c},u}(fu);ss.prototype.bytesPerElement=24,Ca("StructArrayLayout4i4ui4i24",ss);var Uu=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C){var R=this.length;return this.resize(R+1),this.emplace(R,c,y,C)},u.prototype.emplace=function(c,y,C,R){var z=3*c;return this.float32[z+0]=y,this.float32[z+1]=C,this.float32[z+2]=R,c},u}(fu);Uu.prototype.bytesPerElement=12,Ca("StructArrayLayout3f12",Uu);var cs=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c){var y=this.length;return this.resize(y+1),this.emplace(y,c)},u.prototype.emplace=function(c,y){return this.uint32[1*c+0]=y,c},u}(fu);cs.prototype.bytesPerElement=4,Ca("StructArrayLayout1ul4",cs);var Kf=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R,z,Q,pe,Ie,ze){var qe=this.length;return this.resize(qe+1),this.emplace(qe,c,y,C,R,z,Q,pe,Ie,ze)},u.prototype.emplace=function(c,y,C,R,z,Q,pe,Ie,ze,qe){var ut=10*c,wt=5*c;return this.int16[ut+0]=y,this.int16[ut+1]=C,this.int16[ut+2]=R,this.int16[ut+3]=z,this.int16[ut+4]=Q,this.int16[ut+5]=pe,this.uint32[wt+3]=Ie,this.uint16[ut+8]=ze,this.uint16[ut+9]=qe,c},u}(fu);Kf.prototype.bytesPerElement=20,Ca("StructArrayLayout6i1ul2ui20",Kf);var Uf=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R,z,Q){var pe=this.length;return this.resize(pe+1),this.emplace(pe,c,y,C,R,z,Q)},u.prototype.emplace=function(c,y,C,R,z,Q,pe){var Ie=6*c;return this.int16[Ie+0]=y,this.int16[Ie+1]=C,this.int16[Ie+2]=R,this.int16[Ie+3]=z,this.int16[Ie+4]=Q,this.int16[Ie+5]=pe,c},u}(fu);Uf.prototype.bytesPerElement=12,Ca("StructArrayLayout2i2i2i12",Uf);var Nc=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R,z){var Q=this.length;return this.resize(Q+1),this.emplace(Q,c,y,C,R,z)},u.prototype.emplace=function(c,y,C,R,z,Q){var pe=4*c,Ie=8*c;return this.float32[pe+0]=y,this.float32[pe+1]=C,this.float32[pe+2]=R,this.int16[Ie+6]=z,this.int16[Ie+7]=Q,c},u}(fu);Nc.prototype.bytesPerElement=16,Ca("StructArrayLayout2f1f2i16",Nc);var Tc=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R){var z=this.length;return this.resize(z+1),this.emplace(z,c,y,C,R)},u.prototype.emplace=function(c,y,C,R,z){var Q=12*c,pe=3*c;return this.uint8[Q+0]=y,this.uint8[Q+1]=C,this.float32[pe+1]=R,this.float32[pe+2]=z,c},u}(fu);Tc.prototype.bytesPerElement=12,Ca("StructArrayLayout2ub2f12",Tc);var gf=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C){var R=this.length;return this.resize(R+1),this.emplace(R,c,y,C)},u.prototype.emplace=function(c,y,C,R){var z=3*c;return this.uint16[z+0]=y,this.uint16[z+1]=C,this.uint16[z+2]=R,c},u}(fu);gf.prototype.bytesPerElement=6,Ca("StructArrayLayout3ui6",gf);var lh=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or,sr,mr,yr,rn){var _n=this.length;return this.resize(_n+1),this.emplace(_n,c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or,sr,mr,yr,rn)},u.prototype.emplace=function(c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or,sr,mr,yr,rn,_n){var kn=24*c,Nn=12*c,pi=48*c;return this.int16[kn+0]=y,this.int16[kn+1]=C,this.uint16[kn+2]=R,this.uint16[kn+3]=z,this.uint32[Nn+2]=Q,this.uint32[Nn+3]=pe,this.uint32[Nn+4]=Ie,this.uint16[kn+10]=ze,this.uint16[kn+11]=qe,this.uint16[kn+12]=ut,this.float32[Nn+7]=wt,this.float32[Nn+8]=or,this.uint8[pi+36]=sr,this.uint8[pi+37]=mr,this.uint8[pi+38]=yr,this.uint32[Nn+10]=rn,this.int16[kn+22]=_n,c},u}(fu);lh.prototype.bytesPerElement=48,Ca("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",lh);var Af=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or,sr,mr,yr,rn,_n,kn,Nn,pi,Xr,ua,Ir,vn,$i,ki,eo){var Ha=this.length;return this.resize(Ha+1),this.emplace(Ha,c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or,sr,mr,yr,rn,_n,kn,Nn,pi,Xr,ua,Ir,vn,$i,ki,eo)},u.prototype.emplace=function(c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or,sr,mr,yr,rn,_n,kn,Nn,pi,Xr,ua,Ir,vn,$i,ki,eo,Ha){var Ta=34*c,Ro=17*c;return this.int16[Ta+0]=y,this.int16[Ta+1]=C,this.int16[Ta+2]=R,this.int16[Ta+3]=z,this.int16[Ta+4]=Q,this.int16[Ta+5]=pe,this.int16[Ta+6]=Ie,this.int16[Ta+7]=ze,this.uint16[Ta+8]=qe,this.uint16[Ta+9]=ut,this.uint16[Ta+10]=wt,this.uint16[Ta+11]=or,this.uint16[Ta+12]=sr,this.uint16[Ta+13]=mr,this.uint16[Ta+14]=yr,this.uint16[Ta+15]=rn,this.uint16[Ta+16]=_n,this.uint16[Ta+17]=kn,this.uint16[Ta+18]=Nn,this.uint16[Ta+19]=pi,this.uint16[Ta+20]=Xr,this.uint16[Ta+21]=ua,this.uint16[Ta+22]=Ir,this.uint32[Ro+12]=vn,this.float32[Ro+13]=$i,this.float32[Ro+14]=ki,this.float32[Ro+15]=eo,this.float32[Ro+16]=Ha,c},u}(fu);Af.prototype.bytesPerElement=68,Ca("StructArrayLayout8i15ui1ul4f68",Af);var Tf=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c){var y=this.length;return this.resize(y+1),this.emplace(y,c)},u.prototype.emplace=function(c,y){return this.float32[1*c+0]=y,c},u}(fu);Tf.prototype.bytesPerElement=4,Ca("StructArrayLayout1f4",Tf);var Mf=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C){var R=this.length;return this.resize(R+1),this.emplace(R,c,y,C)},u.prototype.emplace=function(c,y,C,R){var z=3*c;return this.int16[z+0]=y,this.int16[z+1]=C,this.int16[z+2]=R,c},u}(fu);Mf.prototype.bytesPerElement=6,Ca("StructArrayLayout3i6",Mf);var Pf=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C){var R=this.length;return this.resize(R+1),this.emplace(R,c,y,C)},u.prototype.emplace=function(c,y,C,R){var z=4*c;return this.uint32[2*c+0]=y,this.uint16[z+2]=C,this.uint16[z+3]=R,c},u}(fu);Pf.prototype.bytesPerElement=8,Ca("StructArrayLayout1ul2ui8",Pf);var ju=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y){var C=this.length;return this.resize(C+1),this.emplace(C,c,y)},u.prototype.emplace=function(c,y,C){var R=2*c;return this.uint16[R+0]=y,this.uint16[R+1]=C,c},u}(fu);ju.prototype.bytesPerElement=4,Ca("StructArrayLayout2ui4",ju);var gp=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c){var y=this.length;return this.resize(y+1),this.emplace(y,c)},u.prototype.emplace=function(c,y){return this.uint16[1*c+0]=y,c},u}(fu);gp.prototype.bytesPerElement=2,Ca("StructArrayLayout1ui2",gp);var qf=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},u.prototype.emplaceBack=function(c,y,C,R){var z=this.length;return this.resize(z+1),this.emplace(z,c,y,C,R)},u.prototype.emplace=function(c,y,C,R,z){var Q=4*c;return this.float32[Q+0]=y,this.float32[Q+1]=C,this.float32[Q+2]=R,this.float32[Q+3]=z,c},u}(fu);qf.prototype.bytesPerElement=16,Ca("StructArrayLayout4f16",qf);var h=function(o){function u(){o.apply(this,arguments)}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var c={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return c.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},c.x1.get=function(){return this._structArray.int16[this._pos2+2]},c.y1.get=function(){return this._structArray.int16[this._pos2+3]},c.x2.get=function(){return this._structArray.int16[this._pos2+4]},c.y2.get=function(){return this._structArray.int16[this._pos2+5]},c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.anchorPoint.get=function(){return new W(this.anchorPointX,this.anchorPointY)},Object.defineProperties(u.prototype,c),u}(sp);h.prototype.size=20;var g=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.get=function(c){return new h(this,c)},u}(Kf);Ca("CollisionBoxArray",g);var p=function(o){function u(){o.apply(this,arguments)}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},c.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},c.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},c.segment.get=function(){return this._structArray.uint16[this._pos2+10]},c.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},c.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},c.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},c.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},c.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},c.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},c.placedOrientation.set=function(y){this._structArray.uint8[this._pos1+37]=y},c.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},c.hidden.set=function(y){this._structArray.uint8[this._pos1+38]=y},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},c.crossTileID.set=function(y){this._structArray.uint32[this._pos4+10]=y},c.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(u.prototype,c),u}(sp);p.prototype.size=48;var b=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.get=function(c){return new p(this,c)},u}(lh);Ca("PlacedSymbolArray",b);var N=function(o){function u(){o.apply(this,arguments)}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},c.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},c.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},c.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},c.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},c.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},c.key.get=function(){return this._structArray.uint16[this._pos2+8]},c.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},c.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},c.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},c.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},c.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},c.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},c.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},c.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},c.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},c.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},c.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},c.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},c.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},c.crossTileID.set=function(y){this._structArray.uint32[this._pos4+12]=y},c.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},c.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},c.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},c.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(u.prototype,c),u}(sp);N.prototype.size=68;var q=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.get=function(c){return new N(this,c)},u}(Af);Ca("SymbolInstanceArray",q);var ee=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.getoffsetX=function(c){return this.float32[1*c+0]},u}(Tf);Ca("GlyphOffsetArray",ee);var ge=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.getx=function(c){return this.int16[3*c+0]},u.prototype.gety=function(c){return this.int16[3*c+1]},u.prototype.gettileUnitDistanceFromAnchor=function(c){return this.int16[3*c+2]},u}(Mf);Ca("SymbolLineVertexArray",ge);var Ue=function(o){function u(){o.apply(this,arguments)}o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u;var c={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(u.prototype,c),u}(sp);Ue.prototype.size=8;var st=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.get=function(c){return new Ue(this,c)},u}(Pf);Ca("FeatureIndexArray",st);var kt=Pu([{name:"a_pos",components:2,type:"Int16"}],4).members,Lt=function(o){o===void 0&&(o=[]),this.segments=o};function Zt(o,u){return 256*(o=Ce(Math.floor(o),0,255))+Ce(Math.floor(u),0,255)}Lt.prototype.prepareSegment=function(o,u,c,y){var C=this.segments[this.segments.length-1];return o>Lt.MAX_VERTEX_ARRAY_LENGTH&&Ye("Max vertices per segment is "+Lt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+o),(!C||C.vertexLength+o>Lt.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==y)&&(C={vertexOffset:u.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},y!==void 0&&(C.sortKey=y),this.segments.push(C)),C},Lt.prototype.get=function(){return this.segments},Lt.prototype.destroy=function(){for(var o=0,u=this.segments;o<u.length;o+=1){var c=u[o];for(var y in c.vaos)c.vaos[y].destroy()}},Lt.simpleSegment=function(o,u,c,y){return new Lt([{vertexOffset:o,primitiveOffset:u,vertexLength:c,primitiveLength:y,vaos:{},sortKey:0}])},Lt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ca("SegmentVector",Lt);var vr=Pu([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),pr=ae(function(o){o.exports=function(u,c){var y,C,R,z,Q,pe,Ie,ze;for(C=u.length-(y=3&u.length),R=c,Q=3432918353,pe=461845907,ze=0;ze<C;)Ie=255&u.charCodeAt(ze)|(255&u.charCodeAt(++ze))<<8|(255&u.charCodeAt(++ze))<<16|(255&u.charCodeAt(++ze))<<24,++ze,R=27492+(65535&(z=5*(65535&(R=(R^=Ie=(65535&(Ie=(Ie=(65535&Ie)*Q+(((Ie>>>16)*Q&65535)<<16)&4294967295)<<15|Ie>>>17))*pe+(((Ie>>>16)*pe&65535)<<16)&4294967295)<<13|R>>>19))+((5*(R>>>16)&65535)<<16)&4294967295))+((58964+(z>>>16)&65535)<<16);switch(Ie=0,y){case 3:Ie^=(255&u.charCodeAt(ze+2))<<16;case 2:Ie^=(255&u.charCodeAt(ze+1))<<8;case 1:R^=Ie=(65535&(Ie=(Ie=(65535&(Ie^=255&u.charCodeAt(ze)))*Q+(((Ie>>>16)*Q&65535)<<16)&4294967295)<<15|Ie>>>17))*pe+(((Ie>>>16)*pe&65535)<<16)&4294967295}return R^=u.length,R=2246822507*(65535&(R^=R>>>16))+((2246822507*(R>>>16)&65535)<<16)&4294967295,R=3266489909*(65535&(R^=R>>>13))+((3266489909*(R>>>16)&65535)<<16)&4294967295,(R^=R>>>16)>>>0}}),Nr=ae(function(o){o.exports=function(u,c){for(var y,C=u.length,R=c^C,z=0;C>=4;)y=1540483477*(65535&(y=255&u.charCodeAt(z)|(255&u.charCodeAt(++z))<<8|(255&u.charCodeAt(++z))<<16|(255&u.charCodeAt(++z))<<24))+((1540483477*(y>>>16)&65535)<<16),R=1540483477*(65535&R)+((1540483477*(R>>>16)&65535)<<16)^(y=1540483477*(65535&(y^=y>>>24))+((1540483477*(y>>>16)&65535)<<16)),C-=4,++z;switch(C){case 3:R^=(255&u.charCodeAt(z+2))<<16;case 2:R^=(255&u.charCodeAt(z+1))<<8;case 1:R=1540483477*(65535&(R^=255&u.charCodeAt(z)))+((1540483477*(R>>>16)&65535)<<16)}return R=1540483477*(65535&(R^=R>>>13))+((1540483477*(R>>>16)&65535)<<16),(R^=R>>>15)>>>0}}),cr=pr,zr=Nr;cr.murmur3=pr,cr.murmur2=zr;var Ur=function(){this.ids=[],this.positions=[],this.indexed=!1};Ur.prototype.add=function(o,u,c,y){this.ids.push(ti(o)),this.positions.push(u,c,y)},Ur.prototype.getPositions=function(o){for(var u=ti(o),c=0,y=this.ids.length-1;c<y;){var C=c+y>>1;this.ids[C]>=u?y=C:c=C+1}for(var R=[];this.ids[c]===u;)R.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return R},Ur.serialize=function(o,u){var c=new Float64Array(o.ids),y=new Uint32Array(o.positions);return function C(R,z,Q,pe){for(;Q<pe;){for(var Ie=R[Q+pe>>1],ze=Q-1,qe=pe+1;;){do ze++;while(R[ze]<Ie);do qe--;while(R[qe]>Ie);if(ze>=qe)break;Yn(R,ze,qe),Yn(z,3*ze,3*qe),Yn(z,3*ze+1,3*qe+1),Yn(z,3*ze+2,3*qe+2)}qe-Q<pe-qe?(C(R,z,Q,qe),Q=qe+1):(C(R,z,qe+1,pe),pe=qe)}}(c,y,0,c.length-1),u&&u.push(c.buffer,y.buffer),{ids:c,positions:y}},Ur.deserialize=function(o){var u=new Ur;return u.ids=o.ids,u.positions=o.positions,u.indexed=!0,u};var Tn=Math.pow(2,53)-1;function ti(o){var u=+o;return!isNaN(u)&&u<=Tn?u:cr(String(o))}function Yn(o,u,c){var y=o[u];o[u]=o[c],o[c]=y}Ca("FeaturePositionMap",Ur);var ai=function(o,u){this.gl=o.gl,this.location=u},Pi=function(o){function u(c,y){o.call(this,c,y),this.current=0}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.set=function(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))},u}(ai),va=function(o){function u(c,y){o.call(this,c,y),this.current=0}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.set=function(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))},u}(ai),na=function(o){function u(c,y){o.call(this,c,y),this.current=[0,0]}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.set=function(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))},u}(ai),Ua=function(o){function u(c,y){o.call(this,c,y),this.current=[0,0,0]}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.set=function(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))},u}(ai),co=function(o){function u(c,y){o.call(this,c,y),this.current=[0,0,0,0]}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.set=function(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))},u}(ai),Eo=function(o){function u(c,y){o.call(this,c,y),this.current=qi.transparent}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.set=function(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))},u}(ai),ho=new Float32Array(16),qo=function(o){function u(c,y){o.call(this,c,y),this.current=ho}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.set=function(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(var y=1;y<16;y++)if(c[y]!==this.current[y]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}},u}(ai);function ga(o){return[Zt(255*o.r,255*o.g),Zt(255*o.b,255*o.a)]}var Zo=function(o,u,c){this.value=o,this.uniformNames=u.map(function(y){return"u_"+y}),this.type=c};Zo.prototype.setUniform=function(o,u,c){o.set(c.constantOr(this.value))},Zo.prototype.getBinding=function(o,u,c){return this.type==="color"?new Eo(o,u):new va(o,u)};var Uo=function(o,u){this.uniformNames=u.map(function(c){return"u_"+c}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Uo.prototype.setConstantPatternPositions=function(o,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=o.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=o.tlbr},Uo.prototype.setUniform=function(o,u,c,y){var C=y==="u_pattern_to"?this.patternTo:y==="u_pattern_from"?this.patternFrom:y==="u_pixel_ratio_to"?this.pixelRatioTo:y==="u_pixel_ratio_from"?this.pixelRatioFrom:null;C&&o.set(C)},Uo.prototype.getBinding=function(o,u,c){return c.substr(0,9)==="u_pattern"?new co(o,u):new va(o,u)};var Do=function(o,u,c,y){this.expression=o,this.type=c,this.maxValue=0,this.paintVertexAttributes=u.map(function(C){return{name:"a_"+C,type:"Float32",components:c==="color"?2:1,offset:0}}),this.paintVertexArray=new y};Do.prototype.populatePaintArray=function(o,u,c,y,C){var R=this.paintVertexArray.length,z=this.expression.evaluate(new bs(0),u,{},y,[],C);this.paintVertexArray.resize(o),this._setPaintValue(R,o,z)},Do.prototype.updatePaintArray=function(o,u,c,y){var C=this.expression.evaluate({zoom:0},c,y);this._setPaintValue(o,u,C)},Do.prototype._setPaintValue=function(o,u,c){if(this.type==="color")for(var y=ga(c),C=o;C<u;C++)this.paintVertexArray.emplace(C,y[0],y[1]);else{for(var R=o;R<u;R++)this.paintVertexArray.emplace(R,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}},Do.prototype.upload=function(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Do.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var po=function(o,u,c,y,C,R){this.expression=o,this.uniformNames=u.map(function(z){return"u_"+z+"_t"}),this.type=c,this.useIntegerZoom=y,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=u.map(function(z){return{name:"a_"+z,type:"Float32",components:c==="color"?4:2,offset:0}}),this.paintVertexArray=new R};po.prototype.populatePaintArray=function(o,u,c,y,C){var R=this.expression.evaluate(new bs(this.zoom),u,{},y,[],C),z=this.expression.evaluate(new bs(this.zoom+1),u,{},y,[],C),Q=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(Q,o,R,z)},po.prototype.updatePaintArray=function(o,u,c,y){var C=this.expression.evaluate({zoom:this.zoom},c,y),R=this.expression.evaluate({zoom:this.zoom+1},c,y);this._setPaintValue(o,u,C,R)},po.prototype._setPaintValue=function(o,u,c,y){if(this.type==="color")for(var C=ga(c),R=ga(y),z=o;z<u;z++)this.paintVertexArray.emplace(z,C[0],C[1],R[0],R[1]);else{for(var Q=o;Q<u;Q++)this.paintVertexArray.emplace(Q,c,y);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(y))}},po.prototype.upload=function(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},po.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},po.prototype.setUniform=function(o,u){var c=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,y=Ce(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);o.set(y)},po.prototype.getBinding=function(o,u,c){return new va(o,u)};var us=function(o,u,c,y,C,R){this.expression=o,this.type=u,this.useIntegerZoom=c,this.zoom=y,this.layerId=R,this.zoomInPaintVertexArray=new C,this.zoomOutPaintVertexArray=new C};us.prototype.populatePaintArray=function(o,u,c){var y=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(o),this.zoomOutPaintVertexArray.resize(o),this._setPaintValues(y,o,u.patterns&&u.patterns[this.layerId],c)},us.prototype.updatePaintArray=function(o,u,c,y,C){this._setPaintValues(o,u,c.patterns&&c.patterns[this.layerId],C)},us.prototype._setPaintValues=function(o,u,c,y){if(y&&c){var C=y[c.min],R=y[c.mid],z=y[c.max];if(C&&R&&z)for(var Q=o;Q<u;Q++)this.zoomInPaintVertexArray.emplace(Q,R.tl[0],R.tl[1],R.br[0],R.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],R.pixelRatio,C.pixelRatio),this.zoomOutPaintVertexArray.emplace(Q,R.tl[0],R.tl[1],R.br[0],R.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],R.pixelRatio,z.pixelRatio)}},us.prototype.upload=function(o){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=o.createVertexBuffer(this.zoomInPaintVertexArray,vr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=o.createVertexBuffer(this.zoomOutPaintVertexArray,vr.members,this.expression.isStateDependent))},us.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ko=function(o,u,c){this.binders={},this._buffers=[];var y=[];for(var C in o.paint._values)if(c(C)){var R=o.paint.get(C);if(R instanceof Ac&&ks(R.property.specification)){var z=El(C,o.type),Q=R.value,pe=R.property.specification.type,Ie=R.property.useIntegerZoom,ze=R.property.specification["property-type"],qe=ze==="cross-faded"||ze==="cross-faded-data-driven";if(Q.kind==="constant")this.binders[C]=qe?new Uo(Q.value,z):new Zo(Q.value,z,pe),y.push("/u_"+C);else if(Q.kind==="source"||qe){var ut=Ou(C,pe,"source");this.binders[C]=qe?new us(Q,pe,Ie,u,ut,o.id):new Do(Q,z,pe,ut),y.push("/a_"+C)}else{var wt=Ou(C,pe,"composite");this.binders[C]=new po(Q,z,pe,Ie,u,wt),y.push("/z_"+C)}}}this.cacheKey=y.sort().join("")};ko.prototype.getMaxValue=function(o){var u=this.binders[o];return u instanceof Do||u instanceof po?u.maxValue:0},ko.prototype.populatePaintArrays=function(o,u,c,y,C){for(var R in this.binders){var z=this.binders[R];(z instanceof Do||z instanceof po||z instanceof us)&&z.populatePaintArray(o,u,c,y,C)}},ko.prototype.setConstantPatternPositions=function(o,u){for(var c in this.binders){var y=this.binders[c];y instanceof Uo&&y.setConstantPatternPositions(o,u)}},ko.prototype.updatePaintArrays=function(o,u,c,y,C){var R=!1;for(var z in o)for(var Q=0,pe=u.getPositions(z);Q<pe.length;Q+=1){var Ie=pe[Q],ze=c.feature(Ie.index);for(var qe in this.binders){var ut=this.binders[qe];if((ut instanceof Do||ut instanceof po||ut instanceof us)&&ut.expression.isStateDependent===!0){var wt=y.paint.get(qe);ut.expression=wt.value,ut.updatePaintArray(Ie.start,Ie.end,ze,o[z],C),R=!0}}}return R},ko.prototype.defines=function(){var o=[];for(var u in this.binders){var c=this.binders[u];(c instanceof Zo||c instanceof Uo)&&o.push.apply(o,c.uniformNames.map(function(y){return"#define HAS_UNIFORM_"+y}))}return o},ko.prototype.getBinderAttributes=function(){var o=[];for(var u in this.binders){var c=this.binders[u];if(c instanceof Do||c instanceof po)for(var y=0;y<c.paintVertexAttributes.length;y++)o.push(c.paintVertexAttributes[y].name);else if(c instanceof us)for(var C=0;C<vr.members.length;C++)o.push(vr.members[C].name)}return o},ko.prototype.getBinderUniforms=function(){var o=[];for(var u in this.binders){var c=this.binders[u];if(c instanceof Zo||c instanceof Uo||c instanceof po)for(var y=0,C=c.uniformNames;y<C.length;y+=1)o.push(C[y])}return o},ko.prototype.getPaintVertexBuffers=function(){return this._buffers},ko.prototype.getUniforms=function(o,u){var c=[];for(var y in this.binders){var C=this.binders[y];if(C instanceof Zo||C instanceof Uo||C instanceof po)for(var R=0,z=C.uniformNames;R<z.length;R+=1){var Q=z[R];if(u[Q]){var pe=C.getBinding(o,u[Q],Q);c.push({name:Q,property:y,binding:pe})}}}return c},ko.prototype.setUniforms=function(o,u,c,y){for(var C=0,R=u;C<R.length;C+=1){var z=R[C],Q=z.name,pe=z.property;this.binders[pe].setUniform(z.binding,y,c.get(pe),Q)}},ko.prototype.updatePaintBuffers=function(o){for(var u in this._buffers=[],this.binders){var c=this.binders[u];if(o&&c instanceof us){var y=o.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;y&&this._buffers.push(y)}else(c instanceof Do||c instanceof po)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}},ko.prototype.upload=function(o){for(var u in this.binders){var c=this.binders[u];(c instanceof Do||c instanceof po||c instanceof us)&&c.upload(o)}this.updatePaintBuffers()},ko.prototype.destroy=function(){for(var o in this.binders){var u=this.binders[o];(u instanceof Do||u instanceof po||u instanceof us)&&u.destroy()}};var Io=function(o,u,c){c===void 0&&(c=function(){return!0}),this.programConfigurations={};for(var y=0,C=o;y<C.length;y+=1){var R=C[y];this.programConfigurations[R.id]=new ko(R,u,c)}this.needsUpload=!1,this._featureMap=new Ur,this._bufferOffset=0};function El(o,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(u+"-","").replace(/-/g,"_")]}function Ou(o,u,c){var y={color:{source:Nt,composite:qf},number:{source:Tf,composite:Nt}},C=function(R){return{"line-pattern":{source:Xc,composite:Xc},"fill-pattern":{source:Xc,composite:Xc},"fill-extrusion-pattern":{source:Xc,composite:Xc}}[R]}(o);return C&&C[c]||y[u][c]}Io.prototype.populatePaintArrays=function(o,u,c,y,C,R){for(var z in this.programConfigurations)this.programConfigurations[z].populatePaintArrays(o,u,y,C,R);u.id!==void 0&&this._featureMap.add(u.id,c,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0},Io.prototype.updatePaintArrays=function(o,u,c,y){for(var C=0,R=c;C<R.length;C+=1){var z=R[C];this.needsUpload=this.programConfigurations[z.id].updatePaintArrays(o,this._featureMap,u,z,y)||this.needsUpload}},Io.prototype.get=function(o){return this.programConfigurations[o]},Io.prototype.upload=function(o){if(this.needsUpload){for(var u in this.programConfigurations)this.programConfigurations[u].upload(o);this.needsUpload=!1}},Io.prototype.destroy=function(){for(var o in this.programConfigurations)this.programConfigurations[o].destroy()},Ca("ConstantBinder",Zo),Ca("CrossFadedConstantBinder",Uo),Ca("SourceExpressionBinder",Do),Ca("CrossFadedCompositeBinder",us),Ca("CompositeExpressionBinder",po),Ca("ProgramConfiguration",ko,{omit:["_buffers"]}),Ca("ProgramConfigurationSet",Io);var nu=Math.pow(2,14)-1,rc=-nu-1;function Du(o){for(var u=8192/o.extent,c=o.loadGeometry(),y=0;y<c.length;y++)for(var C=c[y],R=0;R<C.length;R++){var z=C[R],Q=Math.round(z.x*u),pe=Math.round(z.y*u);z.x=Ce(Q,rc,nu),z.y=Ce(pe,rc,nu),(Q<z.x||Q>z.x+1||pe<z.y||pe>z.y+1)&&Ye("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return c}function gu(o,u){return{type:o.type,id:o.id,properties:o.properties,geometry:u?Du(o):[]}}function gc(o,u,c,y,C){o.emplaceBack(2*u+(y+1)/2,2*c+(C+1)/2)}var Vl=function(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new Ja,this.indexArray=new gf,this.segments=new Lt,this.programConfigurations=new Io(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};function ml(o,u){for(var c=0;c<o.length;c++)if(sf(u,o[c]))return!0;for(var y=0;y<u.length;y++)if(sf(o,u[y]))return!0;return!!lp(o,u)}function Mc(o,u,c){return!!sf(o,u)||!!jf(u,o,c)}function hl(o,u){if(o.length===1)return Qf(u,o[0]);for(var c=0;c<u.length;c++)for(var y=u[c],C=0;C<y.length;C++)if(sf(o,y[C]))return!0;for(var R=0;R<o.length;R++)if(Qf(u,o[R]))return!0;for(var z=0;z<u.length;z++)if(lp(o,u[z]))return!0;return!1}function yc(o,u,c){if(o.length>1){if(lp(o,u))return!0;for(var y=0;y<u.length;y++)if(jf(u[y],o,c))return!0}for(var C=0;C<o.length;C++)if(jf(o[C],u,c))return!0;return!1}function lp(o,u){if(o.length===0||u.length===0)return!1;for(var c=0;c<o.length-1;c++)for(var y=o[c],C=o[c+1],R=0;R<u.length-1;R++)if(Dh(y,C,u[R],u[R+1]))return!0;return!1}function Dh(o,u,c,y){return at(o,c,y)!==at(u,c,y)&&at(o,u,c)!==at(o,u,y)}function jf(o,u,c){var y=c*c;if(u.length===1)return o.distSqr(u[0])<y;for(var C=1;C<u.length;C++)if(bh(o,u[C-1],u[C])<y)return!0;return!1}function bh(o,u,c){var y=u.distSqr(c);if(y===0)return o.distSqr(u);var C=((o.x-u.x)*(c.x-u.x)+(o.y-u.y)*(c.y-u.y))/y;return o.distSqr(C<0?u:C>1?c:c.sub(u)._mult(C)._add(u))}function Qf(o,u){for(var c,y,C,R=!1,z=0;z<o.length;z++)for(var Q=0,pe=(c=o[z]).length-1;Q<c.length;pe=Q++)(y=c[Q]).y>u.y!=(C=c[pe]).y>u.y&&u.x<(C.x-y.x)*(u.y-y.y)/(C.y-y.y)+y.x&&(R=!R);return R}function sf(o,u){for(var c=!1,y=0,C=o.length-1;y<o.length;C=y++){var R=o[y],z=o[C];R.y>u.y!=z.y>u.y&&u.x<(z.x-R.x)*(u.y-R.y)/(z.y-R.y)+R.x&&(c=!c)}return c}function ch(o,u,c){var y=c[0],C=c[2];if(o.x<y.x&&u.x<y.x||o.x>C.x&&u.x>C.x||o.y<y.y&&u.y<y.y||o.y>C.y&&u.y>C.y)return!1;var R=at(o,u,c[0]);return R!==at(o,u,c[1])||R!==at(o,u,c[2])||R!==at(o,u,c[3])}function Pc(o,u,c){var y=u.paint.get(o).value;return y.kind==="constant"?y.value:c.programConfigurations.get(u.id).getMaxValue(o)}function Hl(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function zc(o,u,c,y,C){if(!u[0]&&!u[1])return o;var R=W.convert(u)._mult(C);c==="viewport"&&R._rotate(-y);for(var z=[],Q=0;Q<o.length;Q++)z.push(o[Q].sub(R));return z}Vl.prototype.populate=function(o,u,c){var y=this.layers[0],C=[],R=null;y.type==="circle"&&(R=y.layout.get("circle-sort-key"));for(var z=0,Q=o;z<Q.length;z+=1){var pe=Q[z],Ie=pe.feature,ze=pe.id,qe=pe.index,ut=pe.sourceLayerIndex,wt=this.layers[0]._featureFilter.needGeometry,or=gu(Ie,wt);if(this.layers[0]._featureFilter.filter(new bs(this.zoom),or,c)){var sr=R?R.evaluate(or,{},c):void 0,mr={id:ze,properties:Ie.properties,type:Ie.type,sourceLayerIndex:ut,index:qe,geometry:wt?or.geometry:Du(Ie),patterns:{},sortKey:sr};C.push(mr)}}R&&C.sort(function(ua,Ir){return ua.sortKey-Ir.sortKey});for(var yr=0,rn=C;yr<rn.length;yr+=1){var _n=rn[yr],kn=_n.geometry,Nn=_n.index,pi=_n.sourceLayerIndex,Xr=o[Nn].feature;this.addFeature(_n,kn,Nn,c),u.featureIndex.insert(Xr,kn,Nn,pi,this.index)}},Vl.prototype.update=function(o,u,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,c)},Vl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Vl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Vl.prototype.upload=function(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,kt),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0},Vl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Vl.prototype.addFeature=function(o,u,c,y){for(var C=0,R=u;C<R.length;C+=1)for(var z=0,Q=R[C];z<Q.length;z+=1){var pe=Q[z],Ie=pe.x,ze=pe.y;if(!(Ie<0||Ie>=8192||ze<0||ze>=8192)){var qe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),ut=qe.vertexLength;gc(this.layoutVertexArray,Ie,ze,-1,-1),gc(this.layoutVertexArray,Ie,ze,1,-1),gc(this.layoutVertexArray,Ie,ze,1,1),gc(this.layoutVertexArray,Ie,ze,-1,1),this.indexArray.emplaceBack(ut,ut+1,ut+2),this.indexArray.emplaceBack(ut,ut+3,ut+2),qe.vertexLength+=4,qe.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,c,{},y)},Ca("CircleBucket",Vl,{omit:["layers"]});var fh=new Qu({"circle-sort-key":new Xa(tt.layout_circle["circle-sort-key"])}),Eh={paint:new Qu({"circle-radius":new Xa(tt.paint_circle["circle-radius"]),"circle-color":new Xa(tt.paint_circle["circle-color"]),"circle-blur":new Xa(tt.paint_circle["circle-blur"]),"circle-opacity":new Xa(tt.paint_circle["circle-opacity"]),"circle-translate":new Qi(tt.paint_circle["circle-translate"]),"circle-translate-anchor":new Qi(tt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Qi(tt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Qi(tt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xa(tt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xa(tt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xa(tt.paint_circle["circle-stroke-opacity"])}),layout:fh},iu=typeof Float32Array!="undefined"?Float32Array:Array;function Xs(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Yc(o,u,c){var y=u[0],C=u[1],R=u[2],z=u[3],Q=u[4],pe=u[5],Ie=u[6],ze=u[7],qe=u[8],ut=u[9],wt=u[10],or=u[11],sr=u[12],mr=u[13],yr=u[14],rn=u[15],_n=c[0],kn=c[1],Nn=c[2],pi=c[3];return o[0]=_n*y+kn*Q+Nn*qe+pi*sr,o[1]=_n*C+kn*pe+Nn*ut+pi*mr,o[2]=_n*R+kn*Ie+Nn*wt+pi*yr,o[3]=_n*z+kn*ze+Nn*or+pi*rn,o[4]=(_n=c[4])*y+(kn=c[5])*Q+(Nn=c[6])*qe+(pi=c[7])*sr,o[5]=_n*C+kn*pe+Nn*ut+pi*mr,o[6]=_n*R+kn*Ie+Nn*wt+pi*yr,o[7]=_n*z+kn*ze+Nn*or+pi*rn,o[8]=(_n=c[8])*y+(kn=c[9])*Q+(Nn=c[10])*qe+(pi=c[11])*sr,o[9]=_n*C+kn*pe+Nn*ut+pi*mr,o[10]=_n*R+kn*Ie+Nn*wt+pi*yr,o[11]=_n*z+kn*ze+Nn*or+pi*rn,o[12]=(_n=c[12])*y+(kn=c[13])*Q+(Nn=c[14])*qe+(pi=c[15])*sr,o[13]=_n*C+kn*pe+Nn*ut+pi*mr,o[14]=_n*R+kn*Ie+Nn*wt+pi*yr,o[15]=_n*z+kn*ze+Nn*or+pi*rn,o}Math.hypot||(Math.hypot=function(){for(var o=arguments,u=0,c=arguments.length;c--;)u+=o[c]*o[c];return Math.sqrt(u)});var hh,Jf=Yc;function Fh(o,u,c){var y=u[0],C=u[1],R=u[2],z=u[3];return o[0]=c[0]*y+c[4]*C+c[8]*R+c[12]*z,o[1]=c[1]*y+c[5]*C+c[9]*R+c[13]*z,o[2]=c[2]*y+c[6]*C+c[10]*R+c[14]*z,o[3]=c[3]*y+c[7]*C+c[11]*R+c[15]*z,o}hh=new iu(3),iu!=Float32Array&&(hh[0]=0,hh[1]=0,hh[2]=0),function(){var o=new iu(4);iu!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[3]=0)}();var Xh=(function(){var o=new iu(2);iu!=Float32Array&&(o[0]=0,o[1]=0)}(),function(o){function u(c){o.call(this,c,Eh)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.createBucket=function(c){return new Vl(c)},u.prototype.queryRadius=function(c){var y=c;return Pc("circle-radius",this,y)+Pc("circle-stroke-width",this,y)+Hl(this.paint.get("circle-translate"))},u.prototype.queryIntersectsFeature=function(c,y,C,R,z,Q,pe,Ie){for(var ze=zc(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Q.angle,pe),qe=this.paint.get("circle-radius").evaluate(y,C)+this.paint.get("circle-stroke-width").evaluate(y,C),ut=this.paint.get("circle-pitch-alignment")==="map",wt=ut?ze:function(Xr,ua){return Xr.map(function(Ir){return Of(Ir,ua)})}(ze,Ie),or=ut?qe*pe:qe,sr=0,mr=R;sr<mr.length;sr+=1)for(var yr=0,rn=mr[sr];yr<rn.length;yr+=1){var _n=rn[yr],kn=ut?_n:Of(_n,Ie),Nn=or,pi=Fh([],[_n.x,_n.y,0,1],Ie);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Nn*=pi[3]/Q.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Nn*=Q.cameraToCenterDistance/pi[3]),Mc(wt,kn,Nn))return!0}return!1},u}(ul));function Of(o,u){var c=Fh([],[o.x,o.y,0,1],u);return new W(c[0]/c[3],c[1]/c[3])}var eh=function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u}(Vl);function If(o,u,c,y){var C=u.width,R=u.height;if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==C*R*c)throw new RangeError("mismatched image size")}else y=new Uint8Array(C*R*c);return o.width=C,o.height=R,o.data=y,o}function Vf(o,u,c){var y=u.width,C=u.height;if(y!==o.width||C!==o.height){var R=If({},{width:y,height:C},c);Yh(o,R,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,y),height:Math.min(o.height,C)},c),o.width=y,o.height=C,o.data=R.data}}function Yh(o,u,c,y,C,R){if(C.width===0||C.height===0)return u;if(C.width>o.width||C.height>o.height||c.x>o.width-C.width||c.y>o.height-C.height)throw new RangeError("out of range source coordinates for image copy");if(C.width>u.width||C.height>u.height||y.x>u.width-C.width||y.y>u.height-C.height)throw new RangeError("out of range destination coordinates for image copy");for(var z=o.data,Q=u.data,pe=0;pe<C.height;pe++)for(var Ie=((c.y+pe)*o.width+c.x)*R,ze=((y.y+pe)*u.width+y.x)*R,qe=0;qe<C.width*R;qe++)Q[ze+qe]=z[Ie+qe];return u}Ca("HeatmapBucket",eh,{omit:["layers"]});var yf=function(o,u){If(this,o,1,u)};yf.prototype.resize=function(o){Vf(this,o,1)},yf.prototype.clone=function(){return new yf({width:this.width,height:this.height},new Uint8Array(this.data))},yf.copy=function(o,u,c,y,C){Yh(o,u,c,y,C,1)};var Gl=function(o,u){If(this,o,4,u)};Gl.prototype.resize=function(o){Vf(this,o,4)},Gl.prototype.replace=function(o,u){u?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o},Gl.prototype.clone=function(){return new Gl({width:this.width,height:this.height},new Uint8Array(this.data))},Gl.copy=function(o,u,c,y,C){Yh(o,u,c,y,C,4)},Ca("AlphaImage",yf),Ca("RGBAImage",Gl);var Bh={paint:new Qu({"heatmap-radius":new Xa(tt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xa(tt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Qi(tt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Bc(tt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Qi(tt.paint_heatmap["heatmap-opacity"])})};function Kh(o){var u={},c=o.resolution||256,y=o.clips?o.clips.length:1,C=o.image||new Gl({width:c,height:y}),R=function(or,sr,mr){u[o.evaluationKey]=mr;var yr=o.expression.evaluate(u);C.data[or+sr+0]=Math.floor(255*yr.r/yr.a),C.data[or+sr+1]=Math.floor(255*yr.g/yr.a),C.data[or+sr+2]=Math.floor(255*yr.b/yr.a),C.data[or+sr+3]=Math.floor(255*yr.a)};if(o.clips)for(var z=0,Q=0;z<y;++z,Q+=4*c)for(var pe=0,Ie=0;pe<c;pe++,Ie+=4){var ze=pe/(c-1),qe=o.clips[z];R(Q,Ie,qe.start*(1-ze)+qe.end*ze)}else for(var ut=0,wt=0;ut<c;ut++,wt+=4)R(0,wt,ut/(c-1));return C}var yu=function(o){function u(c){o.call(this,c,Bh),this._updateColorRamp()}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.createBucket=function(c){return new eh(c)},u.prototype._handleSpecialPaintPropertyUpdate=function(c){c==="heatmap-color"&&this._updateColorRamp()},u.prototype._updateColorRamp=function(){this.colorRamp=Kh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},u.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},u.prototype.queryRadius=function(){return 0},u.prototype.queryIntersectsFeature=function(){return!1},u.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},u}(ul),$p={paint:new Qu({"hillshade-illumination-direction":new Qi(tt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Qi(tt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Qi(tt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Qi(tt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Qi(tt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Qi(tt.paint_hillshade["hillshade-accent-color"])})},Kc=function(o){function u(c){o.call(this,c,$p)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},u}(ul),Mp=Pu([{name:"a_pos",components:2,type:"Int16"}],4).members,Hf=cd,$l=cd;function cd(o,u,c){c=c||2;var y,C,R,z,Q,pe,Ie,ze=u&&u.length,qe=ze?u[0]*c:o.length,ut=Wp(o,0,qe,c,!0),wt=[];if(!ut||ut.next===ut.prev)return wt;if(ze&&(ut=function(sr,mr,yr,rn){var _n,kn,Nn,pi=[];for(_n=0,kn=mr.length;_n<kn;_n++)(Nn=Wp(sr,mr[_n]*rn,_n<kn-1?mr[_n+1]*rn:sr.length,rn,!1))===Nn.next&&(Nn.steiner=!0),pi.push(zd(Nn));for(pi.sort(hd),_n=0;_n<pi.length;_n++)wh(pi[_n],yr),yr=Es(yr,yr.next);return yr}(o,u,ut,c)),o.length>80*c){y=R=o[0],C=z=o[1];for(var or=c;or<qe;or+=c)(Q=o[or])<y&&(y=Q),(pe=o[or+1])<C&&(C=pe),Q>R&&(R=Q),pe>z&&(z=pe);Ie=(Ie=Math.max(R-y,z-C))!==0?1/Ie:0}return Xp(ut,wt,c,y,C,Ie),wt}function Wp(o,u,c,y,C){var R,z;if(C===qc(o,u,c,y)>0)for(R=u;R<c;R+=y)z=fp(R,o[R],o[R+1],z);else for(R=c-y;R>=u;R-=y)z=fp(R,o[R],o[R+1],z);return z&&Lf(z,z.next)&&(Nh(z),z=z.next),z}function Es(o,u){if(!o)return o;u||(u=o);var c,y=o;do if(c=!1,y.steiner||!Lf(y,y.next)&&hu(y.prev,y,y.next)!==0)y=y.next;else{if(Nh(y),(y=u=y.prev)===y.next)break;c=!0}while(c||y!==u);return u}function Xp(o,u,c,y,C,R,z){if(o){!z&&R&&function(ze,qe,ut,wt){var or=ze;do or.z===null&&(or.z=ll(or.x,or.y,qe,ut,wt)),or.prevZ=or.prev,or.nextZ=or.next,or=or.next;while(or!==ze);or.prevZ.nextZ=null,or.prevZ=null,function(sr){var mr,yr,rn,_n,kn,Nn,pi,Xr,ua=1;do{for(yr=sr,sr=null,kn=null,Nn=0;yr;){for(Nn++,rn=yr,pi=0,mr=0;mr<ua&&(pi++,rn=rn.nextZ);mr++);for(Xr=ua;pi>0||Xr>0&&rn;)pi!==0&&(Xr===0||!rn||yr.z<=rn.z)?(_n=yr,yr=yr.nextZ,pi--):(_n=rn,rn=rn.nextZ,Xr--),kn?kn.nextZ=_n:sr=_n,_n.prevZ=kn,kn=_n;yr=rn}kn.nextZ=null,ua*=2}while(Nn>1)}(or)}(o,y,C,R);for(var Q,pe,Ie=o;o.prev!==o.next;)if(Q=o.prev,pe=o.next,R?fd(o,y,C,R):Nd(o))u.push(Q.i/c),u.push(o.i/c),u.push(pe.i/c),Nh(o),o=pe.next,Ie=pe.next;else if((o=pe)===Ie){z?z===1?Xp(o=cp(Es(o),u,c),u,c,y,C,R,2):z===2&&Pp(o,u,c,y,C,R):Xp(Es(o),u,c,y,C,R,1);break}}}function Nd(o){var u=o.prev,c=o,y=o.next;if(hu(u,c,y)>=0)return!1;for(var C=o.next.next;C!==o.prev;){if(yp(u.x,u.y,c.x,c.y,y.x,y.y,C.x,C.y)&&hu(C.prev,C,C.next)>=0)return!1;C=C.next}return!0}function fd(o,u,c,y){var C=o.prev,R=o,z=o.next;if(hu(C,R,z)>=0)return!1;for(var Q=C.x>R.x?C.x>z.x?C.x:z.x:R.x>z.x?R.x:z.x,pe=C.y>R.y?C.y>z.y?C.y:z.y:R.y>z.y?R.y:z.y,Ie=ll(C.x<R.x?C.x<z.x?C.x:z.x:R.x<z.x?R.x:z.x,C.y<R.y?C.y<z.y?C.y:z.y:R.y<z.y?R.y:z.y,u,c,y),ze=ll(Q,pe,u,c,y),qe=o.prevZ,ut=o.nextZ;qe&&qe.z>=Ie&&ut&&ut.z<=ze;){if(qe!==o.prev&&qe!==o.next&&yp(C.x,C.y,R.x,R.y,z.x,z.y,qe.x,qe.y)&&hu(qe.prev,qe,qe.next)>=0||(qe=qe.prevZ,ut!==o.prev&&ut!==o.next&&yp(C.x,C.y,R.x,R.y,z.x,z.y,ut.x,ut.y)&&hu(ut.prev,ut,ut.next)>=0))return!1;ut=ut.nextZ}for(;qe&&qe.z>=Ie;){if(qe!==o.prev&&qe!==o.next&&yp(C.x,C.y,R.x,R.y,z.x,z.y,qe.x,qe.y)&&hu(qe.prev,qe,qe.next)>=0)return!1;qe=qe.prevZ}for(;ut&&ut.z<=ze;){if(ut!==o.prev&&ut!==o.next&&yp(C.x,C.y,R.x,R.y,z.x,z.y,ut.x,ut.y)&&hu(ut.prev,ut,ut.next)>=0)return!1;ut=ut.nextZ}return!0}function cp(o,u,c){var y=o;do{var C=y.prev,R=y.next.next;!Lf(C,R)&&Sh(C,y,y.next,R)&&Op(C,R)&&Op(R,C)&&(u.push(C.i/c),u.push(y.i/c),u.push(R.i/c),Nh(y),Nh(y.next),y=o=R),y=y.next}while(y!==o);return Es(y)}function Pp(o,u,c,y,C,R){var z=o;do{for(var Q=z.next.next;Q!==z.prev;){if(z.i!==Q.i&&Sd(z,Q)){var pe=Ah(z,Q);return z=Es(z,z.next),pe=Es(pe,pe.next),Xp(z,u,c,y,C,R),void Xp(pe,u,c,y,C,R)}Q=Q.next}z=z.next}while(z!==o)}function hd(o,u){return o.x-u.x}function wh(o,u){if(u=function(y,C){var R,z=C,Q=y.x,pe=y.y,Ie=-1/0;do{if(pe<=z.y&&pe>=z.next.y&&z.next.y!==z.y){var ze=z.x+(pe-z.y)*(z.next.x-z.x)/(z.next.y-z.y);if(ze<=Q&&ze>Ie){if(Ie=ze,ze===Q){if(pe===z.y)return z;if(pe===z.next.y)return z.next}R=z.x<z.next.x?z:z.next}}z=z.next}while(z!==C);if(!R)return null;if(Q===Ie)return R;var qe,ut=R,wt=R.x,or=R.y,sr=1/0;z=R;do Q>=z.x&&z.x>=wt&&Q!==z.x&&yp(pe<or?Q:Ie,pe,wt,or,pe<or?Ie:Q,pe,z.x,z.y)&&(qe=Math.abs(pe-z.y)/(Q-z.x),Op(z,y)&&(qe<sr||qe===sr&&(z.x>R.x||z.x===R.x&&pd(R,z)))&&(R=z,sr=qe)),z=z.next;while(z!==ut);return R}(o,u)){var c=Ah(u,o);Es(u,u.next),Es(c,c.next)}}function pd(o,u){return hu(o.prev,o,u.prev)<0&&hu(u.next,o,o.next)<0}function ll(o,u,c,y,C){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-c)*C)|o<<8))|o<<4))|o<<2))|o<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=32767*(u-y)*C)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function zd(o){var u=o,c=o;do(u.x<c.x||u.x===c.x&&u.y<c.y)&&(c=u),u=u.next;while(u!==o);return c}function yp(o,u,c,y,C,R,z,Q){return(C-z)*(u-Q)-(o-z)*(R-Q)>=0&&(o-z)*(y-Q)-(c-z)*(u-Q)>=0&&(c-z)*(R-Q)-(C-z)*(y-Q)>=0}function Sd(o,u){return o.next.i!==u.i&&o.prev.i!==u.i&&!function(c,y){var C=c;do{if(C.i!==c.i&&C.next.i!==c.i&&C.i!==y.i&&C.next.i!==y.i&&Sh(C,C.next,c,y))return!0;C=C.next}while(C!==c);return!1}(o,u)&&(Op(o,u)&&Op(u,o)&&function(c,y){var C=c,R=!1,z=(c.x+y.x)/2,Q=(c.y+y.y)/2;do C.y>Q!=C.next.y>Q&&C.next.y!==C.y&&z<(C.next.x-C.x)*(Q-C.y)/(C.next.y-C.y)+C.x&&(R=!R),C=C.next;while(C!==c);return R}(o,u)&&(hu(o.prev,o,u.prev)||hu(o,u.prev,u))||Lf(o,u)&&hu(o.prev,o,o.next)>0&&hu(u.prev,u,u.next)>0)}function hu(o,u,c){return(u.y-o.y)*(c.x-u.x)-(u.x-o.x)*(c.y-u.y)}function Lf(o,u){return o.x===u.x&&o.y===u.y}function Sh(o,u,c,y){var C=Ch(hu(o,u,c)),R=Ch(hu(o,u,y)),z=Ch(hu(c,y,o)),Q=Ch(hu(c,y,u));return C!==R&&z!==Q||!(C!==0||!_p(o,c,u))||!(R!==0||!_p(o,y,u))||!(z!==0||!_p(c,o,y))||!(Q!==0||!_p(c,u,y))}function _p(o,u,c){return u.x<=Math.max(o.x,c.x)&&u.x>=Math.min(o.x,c.x)&&u.y<=Math.max(o.y,c.y)&&u.y>=Math.min(o.y,c.y)}function Ch(o){return o>0?1:o<0?-1:0}function Op(o,u){return hu(o.prev,o,o.next)<0?hu(o,u,o.next)>=0&&hu(o,o.prev,u)>=0:hu(o,u,o.prev)<0||hu(o,o.next,u)<0}function Ah(o,u){var c=new zh(o.i,o.x,o.y),y=new zh(u.i,u.x,u.y),C=o.next,R=u.prev;return o.next=u,u.prev=o,c.next=C,C.prev=c,y.next=c,c.prev=y,R.next=y,y.prev=R,y}function fp(o,u,c,y){var C=new zh(o,u,c);return y?(C.next=y.next,C.prev=y,y.next.prev=C,y.next=C):(C.prev=C,C.next=C),C}function Nh(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function zh(o,u,c){this.i=o,this.x=u,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function qc(o,u,c,y){for(var C=0,R=u,z=c-y;R<c;R+=y)C+=(o[z]-o[R])*(o[R+1]+o[z+1]),z=R;return C}function Cd(o,u,c,y,C){(function R(z,Q,pe,Ie,ze){for(;Ie>pe;){if(Ie-pe>600){var qe=Ie-pe+1,ut=Q-pe+1,wt=Math.log(qe),or=.5*Math.exp(2*wt/3),sr=.5*Math.sqrt(wt*or*(qe-or)/qe)*(ut-qe/2<0?-1:1);R(z,Q,Math.max(pe,Math.floor(Q-ut*or/qe+sr)),Math.min(Ie,Math.floor(Q+(qe-ut)*or/qe+sr)),ze)}var mr=z[Q],yr=pe,rn=Ie;for(Rf(z,pe,Q),ze(z[Ie],mr)>0&&Rf(z,pe,Ie);yr<rn;){for(Rf(z,yr,rn),yr++,rn--;ze(z[yr],mr)<0;)yr++;for(;ze(z[rn],mr)>0;)rn--}ze(z[pe],mr)===0?Rf(z,pe,rn):Rf(z,++rn,Ie),rn<=Q&&(pe=rn+1),Q<=rn&&(Ie=rn-1)}})(o,u,c||0,y||o.length-1,C||Yp)}function Rf(o,u,c){var y=o[u];o[u]=o[c],o[c]=y}function Yp(o,u){return o<u?-1:o>u?1:0}function Kp(o,u){var c=o.length;if(c<=1)return[o];for(var y,C,R=[],z=0;z<c;z++){var Q=ht(o[z]);Q!==0&&(o[z].area=Math.abs(Q),C===void 0&&(C=Q<0),C===Q<0?(y&&R.push(y),y=[o[z]]):y.push(o[z]))}if(y&&R.push(y),u>1)for(var pe=0;pe<R.length;pe++)R[pe].length<=u||(Cd(R[pe],u,1,R[pe].length-1,ph),R[pe]=R[pe].slice(0,u));return R}function ph(o,u){return u.area-o.area}function th(o,u,c){for(var y=c.patternDependencies,C=!1,R=0,z=u;R<z.length;R+=1){var Q=z[R].paint.get(o+"-pattern");Q.isConstant()||(C=!0);var pe=Q.constantOr(null);pe&&(C=!0,y[pe.to]=!0,y[pe.from]=!0)}return C}function Ip(o,u,c,y,C){for(var R=C.patternDependencies,z=0,Q=u;z<Q.length;z+=1){var pe=Q[z],Ie=pe.paint.get(o+"-pattern").value;if(Ie.kind!=="constant"){var ze=Ie.evaluate({zoom:y-1},c,{},C.availableImages),qe=Ie.evaluate({zoom:y},c,{},C.availableImages),ut=Ie.evaluate({zoom:y+1},c,{},C.availableImages);qe=qe&&qe.name?qe.name:qe,ut=ut&&ut.name?ut.name:ut,R[ze=ze&&ze.name?ze.name:ze]=!0,R[qe]=!0,R[ut]=!0,c.patterns[pe.id]={min:ze,mid:qe,max:ut}}}return c}cd.deviation=function(o,u,c,y){var C=u&&u.length,R=Math.abs(qc(o,0,C?u[0]*c:o.length,c));if(C)for(var z=0,Q=u.length;z<Q;z++)R-=Math.abs(qc(o,u[z]*c,z<Q-1?u[z+1]*c:o.length,c));var pe=0;for(z=0;z<y.length;z+=3){var Ie=y[z]*c,ze=y[z+1]*c,qe=y[z+2]*c;pe+=Math.abs((o[Ie]-o[qe])*(o[ze+1]-o[Ie+1])-(o[Ie]-o[ze])*(o[qe+1]-o[Ie+1]))}return R===0&&pe===0?0:Math.abs((pe-R)/R)},cd.flatten=function(o){for(var u=o[0][0].length,c={vertices:[],holes:[],dimensions:u},y=0,C=0;C<o.length;C++){for(var R=0;R<o[C].length;R++)for(var z=0;z<u;z++)c.vertices.push(o[C][R][z]);C>0&&c.holes.push(y+=o[C-1].length)}return c},Hf.default=$l;var Oc=function(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ja,this.indexArray=new gf,this.indexArray2=new ju,this.programConfigurations=new Io(o.layers,o.zoom),this.segments=new Lt,this.segments2=new Lt,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Oc.prototype.populate=function(o,u,c){this.hasPattern=th("fill",this.layers,u);for(var y=this.layers[0].layout.get("fill-sort-key"),C=[],R=0,z=o;R<z.length;R+=1){var Q=z[R],pe=Q.feature,Ie=Q.id,ze=Q.index,qe=Q.sourceLayerIndex,ut=this.layers[0]._featureFilter.needGeometry,wt=gu(pe,ut);if(this.layers[0]._featureFilter.filter(new bs(this.zoom),wt,c)){var or=y?y.evaluate(wt,{},c,u.availableImages):void 0,sr={id:Ie,properties:pe.properties,type:pe.type,sourceLayerIndex:qe,index:ze,geometry:ut?wt.geometry:Du(pe),patterns:{},sortKey:or};C.push(sr)}}y&&C.sort(function(Xr,ua){return Xr.sortKey-ua.sortKey});for(var mr=0,yr=C;mr<yr.length;mr+=1){var rn=yr[mr],_n=rn.geometry,kn=rn.index,Nn=rn.sourceLayerIndex;if(this.hasPattern){var pi=Ip("fill",this.layers,rn,this.zoom,u);this.patternFeatures.push(pi)}else this.addFeature(rn,_n,kn,c,{});u.featureIndex.insert(o[kn].feature,_n,kn,Nn,this.index)}},Oc.prototype.update=function(o,u,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,c)},Oc.prototype.addFeatures=function(o,u,c){for(var y=0,C=this.patternFeatures;y<C.length;y+=1){var R=C[y];this.addFeature(R,R.geometry,R.index,u,c)}},Oc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Oc.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Oc.prototype.upload=function(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Mp),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0},Oc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Oc.prototype.addFeature=function(o,u,c,y,C){for(var R=0,z=Kp(u,500);R<z.length;R+=1){for(var Q=z[R],pe=0,Ie=0,ze=Q;Ie<ze.length;Ie+=1)pe+=ze[Ie].length;for(var qe=this.segments.prepareSegment(pe,this.layoutVertexArray,this.indexArray),ut=qe.vertexLength,wt=[],or=[],sr=0,mr=Q;sr<mr.length;sr+=1){var yr=mr[sr];if(yr.length!==0){yr!==Q[0]&&or.push(wt.length/2);var rn=this.segments2.prepareSegment(yr.length,this.layoutVertexArray,this.indexArray2),_n=rn.vertexLength;this.layoutVertexArray.emplaceBack(yr[0].x,yr[0].y),this.indexArray2.emplaceBack(_n+yr.length-1,_n),wt.push(yr[0].x),wt.push(yr[0].y);for(var kn=1;kn<yr.length;kn++)this.layoutVertexArray.emplaceBack(yr[kn].x,yr[kn].y),this.indexArray2.emplaceBack(_n+kn-1,_n+kn),wt.push(yr[kn].x),wt.push(yr[kn].y);rn.vertexLength+=yr.length,rn.primitiveLength+=yr.length}}for(var Nn=Hf(wt,or),pi=0;pi<Nn.length;pi+=3)this.indexArray.emplaceBack(ut+Nn[pi],ut+Nn[pi+1],ut+Nn[pi+2]);qe.vertexLength+=pe,qe.primitiveLength+=Nn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,c,C,y)},Ca("FillBucket",Oc,{omit:["layers","patternFeatures"]});var qh=new Qu({"fill-sort-key":new Xa(tt.layout_fill["fill-sort-key"])}),Th={paint:new Qu({"fill-antialias":new Qi(tt.paint_fill["fill-antialias"]),"fill-opacity":new Xa(tt.paint_fill["fill-opacity"]),"fill-color":new Xa(tt.paint_fill["fill-color"]),"fill-outline-color":new Xa(tt.paint_fill["fill-outline-color"]),"fill-translate":new Qi(tt.paint_fill["fill-translate"]),"fill-translate-anchor":new Qi(tt.paint_fill["fill-translate-anchor"]),"fill-pattern":new of(tt.paint_fill["fill-pattern"])}),layout:qh},Zh=function(o){function u(c){o.call(this,c,Th)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.recalculate=function(c,y){o.prototype.recalculate.call(this,c,y);var C=this.paint._values["fill-outline-color"];C.value.kind==="constant"&&C.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},u.prototype.createBucket=function(c){return new Oc(c)},u.prototype.queryRadius=function(){return Hl(this.paint.get("fill-translate"))},u.prototype.queryIntersectsFeature=function(c,y,C,R,z,Q,pe){return hl(zc(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Q.angle,pe),R)},u.prototype.isTileClipped=function(){return!0},u}(ul),dd=Pu([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Ad=nc;function nc(o,u,c,y,C){this.properties={},this.extent=c,this.type=0,this._pbf=o,this._geometry=-1,this._keys=y,this._values=C,o.readFields(kf,this,u)}function kf(o,u,c){o==1?u.id=c.readVarint():o==2?function(y,C){for(var R=y.readVarint()+y.pos;y.pos<R;){var z=C._keys[y.readVarint()],Q=C._values[y.readVarint()];C.properties[z]=Q}}(c,u):o==3?u.type=c.readVarint():o==4&&(u._geometry=c.pos)}function Td(o){for(var u,c,y=0,C=0,R=o.length,z=R-1;C<R;z=C++)y+=((c=o[z]).x-(u=o[C]).x)*(u.y+c.y);return y}nc.types=["Unknown","Point","LineString","Polygon"],nc.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var u,c=o.readVarint()+o.pos,y=1,C=0,R=0,z=0,Q=[];o.pos<c;){if(C<=0){var pe=o.readVarint();y=7&pe,C=pe>>3}if(C--,y===1||y===2)R+=o.readSVarint(),z+=o.readSVarint(),y===1&&(u&&Q.push(u),u=[]),u.push(new W(R,z));else{if(y!==7)throw new Error("unknown command "+y);u&&u.push(u[0].clone())}}return u&&Q.push(u),Q},nc.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var u=o.readVarint()+o.pos,c=1,y=0,C=0,R=0,z=1/0,Q=-1/0,pe=1/0,Ie=-1/0;o.pos<u;){if(y<=0){var ze=o.readVarint();c=7&ze,y=ze>>3}if(y--,c===1||c===2)(C+=o.readSVarint())<z&&(z=C),C>Q&&(Q=C),(R+=o.readSVarint())<pe&&(pe=R),R>Ie&&(Ie=R);else if(c!==7)throw new Error("unknown command "+c)}return[z,pe,Q,Ie]},nc.prototype.toGeoJSON=function(o,u,c){var y,C,R=this.extent*Math.pow(2,c),z=this.extent*o,Q=this.extent*u,pe=this.loadGeometry(),Ie=nc.types[this.type];function ze(wt){for(var or=0;or<wt.length;or++){var sr=wt[or];wt[or]=[360*(sr.x+z)/R-180,360/Math.PI*Math.atan(Math.exp((180-360*(sr.y+Q)/R)*Math.PI/180))-90]}}switch(this.type){case 1:var qe=[];for(y=0;y<pe.length;y++)qe[y]=pe[y][0];ze(pe=qe);break;case 2:for(y=0;y<pe.length;y++)ze(pe[y]);break;case 3:for(pe=function(wt){var or=wt.length;if(or<=1)return[wt];for(var sr,mr,yr=[],rn=0;rn<or;rn++){var _n=Td(wt[rn]);_n!==0&&(mr===void 0&&(mr=_n<0),mr===_n<0?(sr&&yr.push(sr),sr=[wt[rn]]):sr.push(wt[rn]))}return sr&&yr.push(sr),yr}(pe),y=0;y<pe.length;y++)for(C=0;C<pe[y].length;C++)ze(pe[y][C])}pe.length===1?pe=pe[0]:Ie="Multi"+Ie;var ut={type:"Feature",geometry:{type:Ie,coordinates:pe},properties:this.properties};return"id"in this&&(ut.id=this.id),ut};var vd=hp;function hp(o,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(Lp,this,u),this.length=this._features.length}function Lp(o,u,c){o===15?u.version=c.readVarint():o===1?u.name=c.readString():o===5?u.extent=c.readVarint():o===2?u._features.push(c.pos):o===3?u._keys.push(c.readString()):o===4&&u._values.push(function(y){for(var C=null,R=y.readVarint()+y.pos;y.pos<R;){var z=y.readVarint()>>3;C=z===1?y.readString():z===2?y.readFloat():z===3?y.readDouble():z===4?y.readVarint64():z===5?y.readVarint():z===6?y.readSVarint():z===7?y.readBoolean():null}return C}(c))}function qp(o,u,c){if(o===3){var y=new vd(c,c.readVarint()+c.pos);y.length&&(u[y.name]=y)}}hp.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var u=this._pbf.readVarint()+this._pbf.pos;return new Ad(this._pbf,u,this.extent,this._keys,this._values)};var Gf={VectorTile:function(o,u){this.layers=o.readFields(qp,{},u)},VectorTileFeature:Ad,VectorTileLayer:vd},qd=Gf.VectorTileFeature.types,Rp=Math.pow(2,13);function Uh(o,u,c,y,C,R,z,Q){o.emplaceBack(u,c,2*Math.floor(y*Rp)+z,C*Rp*2,R*Rp*2,Math.round(Q))}var _f=function(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new Wc,this.indexArray=new gf,this.programConfigurations=new Io(o.layers,o.zoom),this.segments=new Lt,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};function Md(o,u){return o.x===u.x&&(o.x<0||o.x>8192)||o.y===u.y&&(o.y<0||o.y>8192)}_f.prototype.populate=function(o,u,c){this.features=[],this.hasPattern=th("fill-extrusion",this.layers,u);for(var y=0,C=o;y<C.length;y+=1){var R=C[y],z=R.feature,Q=R.id,pe=R.index,Ie=R.sourceLayerIndex,ze=this.layers[0]._featureFilter.needGeometry,qe=gu(z,ze);if(this.layers[0]._featureFilter.filter(new bs(this.zoom),qe,c)){var ut={id:Q,sourceLayerIndex:Ie,index:pe,geometry:ze?qe.geometry:Du(z),properties:z.properties,type:z.type,patterns:{}};this.hasPattern?this.features.push(Ip("fill-extrusion",this.layers,ut,this.zoom,u)):this.addFeature(ut,ut.geometry,pe,c,{}),u.featureIndex.insert(z,ut.geometry,pe,Ie,this.index,!0)}}},_f.prototype.addFeatures=function(o,u,c){for(var y=0,C=this.features;y<C.length;y+=1){var R=C[y];this.addFeature(R,R.geometry,R.index,u,c)}},_f.prototype.update=function(o,u,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,c)},_f.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},_f.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},_f.prototype.upload=function(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,dd),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0},_f.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},_f.prototype.addFeature=function(o,u,c,y,C){for(var R=0,z=Kp(u,500);R<z.length;R+=1){for(var Q=z[R],pe=0,Ie=0,ze=Q;Ie<ze.length;Ie+=1)pe+=ze[Ie].length;for(var qe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),ut=0,wt=Q;ut<wt.length;ut+=1){var or=wt[ut];if(or.length!==0&&!((Ro=or).every(function(No){return No.x<0})||Ro.every(function(No){return No.x>8192})||Ro.every(function(No){return No.y<0})||Ro.every(function(No){return No.y>8192})))for(var sr=0,mr=0;mr<or.length;mr++){var yr=or[mr];if(mr>=1){var rn=or[mr-1];if(!Md(yr,rn)){qe.vertexLength+4>Lt.MAX_VERTEX_ARRAY_LENGTH&&(qe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _n=yr.sub(rn)._perp()._unit(),kn=rn.dist(yr);sr+kn>32768&&(sr=0),Uh(this.layoutVertexArray,yr.x,yr.y,_n.x,_n.y,0,0,sr),Uh(this.layoutVertexArray,yr.x,yr.y,_n.x,_n.y,0,1,sr),Uh(this.layoutVertexArray,rn.x,rn.y,_n.x,_n.y,0,0,sr+=kn),Uh(this.layoutVertexArray,rn.x,rn.y,_n.x,_n.y,0,1,sr);var Nn=qe.vertexLength;this.indexArray.emplaceBack(Nn,Nn+2,Nn+1),this.indexArray.emplaceBack(Nn+1,Nn+2,Nn+3),qe.vertexLength+=4,qe.primitiveLength+=2}}}}if(qe.vertexLength+pe>Lt.MAX_VERTEX_ARRAY_LENGTH&&(qe=this.segments.prepareSegment(pe,this.layoutVertexArray,this.indexArray)),qd[o.type]==="Polygon"){for(var pi=[],Xr=[],ua=qe.vertexLength,Ir=0,vn=Q;Ir<vn.length;Ir+=1){var $i=vn[Ir];if($i.length!==0){$i!==Q[0]&&Xr.push(pi.length/2);for(var ki=0;ki<$i.length;ki++){var eo=$i[ki];Uh(this.layoutVertexArray,eo.x,eo.y,0,0,1,1,0),pi.push(eo.x),pi.push(eo.y)}}}for(var Ha=Hf(pi,Xr),Ta=0;Ta<Ha.length;Ta+=3)this.indexArray.emplaceBack(ua+Ha[Ta],ua+Ha[Ta+2],ua+Ha[Ta+1]);qe.primitiveLength+=Ha.length/3,qe.vertexLength+=pe}}var Ro;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,c,C,y)},Ca("FillExtrusionBucket",_f,{omit:["layers","features"]});var Qp={paint:new Qu({"fill-extrusion-opacity":new Qi(tt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xa(tt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Qi(tt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Qi(tt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new of(tt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xa(tt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xa(tt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Qi(tt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Mh=function(o){function u(c){o.call(this,c,Qp)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.createBucket=function(c){return new _f(c)},u.prototype.queryRadius=function(){return Hl(this.paint.get("fill-extrusion-translate"))},u.prototype.is3D=function(){return!0},u.prototype.queryIntersectsFeature=function(c,y,C,R,z,Q,pe,Ie){var ze=zc(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Q.angle,pe),qe=this.paint.get("fill-extrusion-height").evaluate(y,C),ut=this.paint.get("fill-extrusion-base").evaluate(y,C),wt=function(sr,mr,yr,rn){for(var _n=[],kn=0,Nn=sr;kn<Nn.length;kn+=1){var pi=Nn[kn],Xr=[pi.x,pi.y,0,1];Fh(Xr,Xr,mr),_n.push(new W(Xr[0]/Xr[3],Xr[1]/Xr[3]))}return _n}(ze,Ie),or=function(sr,mr,yr,rn){for(var _n=[],kn=[],Nn=rn[8]*mr,pi=rn[9]*mr,Xr=rn[10]*mr,ua=rn[11]*mr,Ir=rn[8]*yr,vn=rn[9]*yr,$i=rn[10]*yr,ki=rn[11]*yr,eo=0,Ha=sr;eo<Ha.length;eo+=1){for(var Ta=[],Ro=[],No=0,vs=Ha[eo];No<vs.length;No+=1){var oo=vs[No],Qs=oo.x,Lu=oo.y,cl=rn[0]*Qs+rn[4]*Lu+rn[12],qu=rn[1]*Qs+rn[5]*Lu+rn[13],Xl=rn[2]*Qs+rn[6]*Lu+rn[14],ac=rn[3]*Qs+rn[7]*Lu+rn[15],Zc=Xl+Xr,xf=ac+ua,vh=cl+Ir,uf=qu+vn,fs=Xl+$i,Ic=ac+ki,bf=new W((cl+Nn)/xf,(qu+pi)/xf);bf.z=Zc/xf,Ta.push(bf);var Vs=new W(vh/Ic,uf/Ic);Vs.z=fs/Ic,Ro.push(Vs)}_n.push(Ta),kn.push(Ro)}return[_n,kn]}(R,ut,qe,Ie);return function(sr,mr,yr){var rn=1/0;hl(yr,mr)&&(rn=Ph(yr,mr[0]));for(var _n=0;_n<mr.length;_n++)for(var kn=mr[_n],Nn=sr[_n],pi=0;pi<kn.length-1;pi++){var Xr=kn[pi],ua=[Xr,kn[pi+1],Nn[pi+1],Nn[pi],Xr];ml(yr,ua)&&(rn=Math.min(rn,Ph(yr,ua)))}return rn!==1/0&&rn}(or[0],or[1],wt)},u}(ul);function dh(o,u){return o.x*u.x+o.y*u.y}function Ph(o,u){if(o.length===1){for(var c,y=0,C=u[y++];!c||C.equals(c);)if(!(c=u[y++]))return 1/0;for(;y<u.length;y++){var R=u[y],z=o[0],Q=c.sub(C),pe=R.sub(C),Ie=z.sub(C),ze=dh(Q,Q),qe=dh(Q,pe),ut=dh(pe,pe),wt=dh(Ie,Q),or=dh(Ie,pe),sr=ze*ut-qe*qe,mr=(ut*wt-qe*or)/sr,yr=(ze*or-qe*wt)/sr,rn=C.z*(1-mr-yr)+c.z*mr+R.z*yr;if(isFinite(rn))return rn}return 1/0}for(var _n=1/0,kn=0,Nn=u;kn<Nn.length;kn+=1)_n=Math.min(_n,Nn[kn].z);return _n}var _u=Pu([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,md=Pu([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,_c=Gf.VectorTileFeature.types,kp=Math.cos(Math.PI/180*37.5),xp=Math.pow(2,14)/.5,Ks=function(o){var u=this;this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(c){return c.id}),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(c){u.gradients[c.id]={}}),this.layoutVertexArray=new Ju,this.layoutVertexArray2=new Nt,this.indexArray=new gf,this.programConfigurations=new Io(o.layers,o.zoom),this.segments=new Lt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(c){return c.isStateDependent()}).map(function(c){return c.id})};Ks.prototype.populate=function(o,u,c){this.hasPattern=th("line",this.layers,u);for(var y=this.layers[0].layout.get("line-sort-key"),C=[],R=0,z=o;R<z.length;R+=1){var Q=z[R],pe=Q.feature,Ie=Q.id,ze=Q.index,qe=Q.sourceLayerIndex,ut=this.layers[0]._featureFilter.needGeometry,wt=gu(pe,ut);if(this.layers[0]._featureFilter.filter(new bs(this.zoom),wt,c)){var or=y?y.evaluate(wt,{},c):void 0,sr={id:Ie,properties:pe.properties,type:pe.type,sourceLayerIndex:qe,index:ze,geometry:ut?wt.geometry:Du(pe),patterns:{},sortKey:or};C.push(sr)}}y&&C.sort(function(Xr,ua){return Xr.sortKey-ua.sortKey});for(var mr=0,yr=C;mr<yr.length;mr+=1){var rn=yr[mr],_n=rn.geometry,kn=rn.index,Nn=rn.sourceLayerIndex;if(this.hasPattern){var pi=Ip("line",this.layers,rn,this.zoom,u);this.patternFeatures.push(pi)}else this.addFeature(rn,_n,kn,c,{});u.featureIndex.insert(o[kn].feature,_n,kn,Nn,this.index)}},Ks.prototype.update=function(o,u,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,c)},Ks.prototype.addFeatures=function(o,u,c){for(var y=0,C=this.patternFeatures;y<C.length;y+=1){var R=C[y];this.addFeature(R,R.geometry,R.index,u,c)}},Ks.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ks.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ks.prototype.upload=function(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,md)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,_u),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0},Ks.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ks.prototype.lineFeatureClips=function(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}},Ks.prototype.addFeature=function(o,u,c,y,C){var R=this.layers[0].layout,z=R.get("line-join").evaluate(o,{}),Q=R.get("line-cap"),pe=R.get("line-miter-limit"),Ie=R.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(var ze=0,qe=u;ze<qe.length;ze+=1)this.addLine(qe[ze],o,z,Q,pe,Ie);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,c,C,y)},Ks.prototype.addLine=function(o,u,c,y,C,R){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var z=0;z<o.length-1;z++)this.totalDistance+=o[z].dist(o[z+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var Q=_c[u.type]==="Polygon",pe=o.length;pe>=2&&o[pe-1].equals(o[pe-2]);)pe--;for(var Ie=0;Ie<pe-1&&o[Ie].equals(o[Ie+1]);)Ie++;if(!(pe<(Q?3:2))){c==="bevel"&&(C=1.05);var ze,qe=this.overscaling<=16?122880/(512*this.overscaling):0,ut=this.segments.prepareSegment(10*pe,this.layoutVertexArray,this.indexArray),wt=void 0,or=void 0,sr=void 0,mr=void 0;this.e1=this.e2=-1,Q&&(mr=o[Ie].sub(ze=o[pe-2])._unit()._perp());for(var yr=Ie;yr<pe;yr++)if(!(or=yr===pe-1?Q?o[Ie+1]:void 0:o[yr+1])||!o[yr].equals(or)){mr&&(sr=mr),ze&&(wt=ze),ze=o[yr],mr=or?or.sub(ze)._unit()._perp():sr;var rn=(sr=sr||mr).add(mr);rn.x===0&&rn.y===0||rn._unit();var _n=sr.x*mr.x+sr.y*mr.y,kn=rn.x*mr.x+rn.y*mr.y,Nn=kn!==0?1/kn:1/0,pi=2*Math.sqrt(2-2*kn),Xr=kn<kp&&wt&&or,ua=sr.x*mr.y-sr.y*mr.x>0;if(Xr&&yr>Ie){var Ir=ze.dist(wt);if(Ir>2*qe){var vn=ze.sub(ze.sub(wt)._mult(qe/Ir)._round());this.updateDistance(wt,vn),this.addCurrentVertex(vn,sr,0,0,ut),wt=vn}}var $i=wt&&or,ki=$i?c:Q?"butt":y;if($i&&ki==="round"&&(Nn<R?ki="miter":Nn<=2&&(ki="fakeround")),ki==="miter"&&Nn>C&&(ki="bevel"),ki==="bevel"&&(Nn>2&&(ki="flipbevel"),Nn<C&&(ki="miter")),wt&&this.updateDistance(wt,ze),ki==="miter")rn._mult(Nn),this.addCurrentVertex(ze,rn,0,0,ut);else if(ki==="flipbevel"){if(Nn>100)rn=mr.mult(-1);else{var eo=Nn*sr.add(mr).mag()/sr.sub(mr).mag();rn._perp()._mult(eo*(ua?-1:1))}this.addCurrentVertex(ze,rn,0,0,ut),this.addCurrentVertex(ze,rn.mult(-1),0,0,ut)}else if(ki==="bevel"||ki==="fakeround"){var Ha=-Math.sqrt(Nn*Nn-1),Ta=ua?Ha:0,Ro=ua?0:Ha;if(wt&&this.addCurrentVertex(ze,sr,Ta,Ro,ut),ki==="fakeround")for(var No=Math.round(180*pi/Math.PI/20),vs=1;vs<No;vs++){var oo=vs/No;if(oo!==.5){var Qs=oo-.5;oo+=oo*Qs*(oo-1)*((1.0904+_n*(_n*(3.55645-1.43519*_n)-3.2452))*Qs*Qs+(.848013+_n*(.215638*_n-1.06021)))}var Lu=mr.sub(sr)._mult(oo)._add(sr)._unit()._mult(ua?-1:1);this.addHalfVertex(ze,Lu.x,Lu.y,!1,ua,0,ut)}or&&this.addCurrentVertex(ze,mr,-Ta,-Ro,ut)}else if(ki==="butt")this.addCurrentVertex(ze,rn,0,0,ut);else if(ki==="square"){var cl=wt?1:-1;this.addCurrentVertex(ze,rn,cl,cl,ut)}else ki==="round"&&(wt&&(this.addCurrentVertex(ze,sr,0,0,ut),this.addCurrentVertex(ze,sr,1,1,ut,!0)),or&&(this.addCurrentVertex(ze,mr,-1,-1,ut,!0),this.addCurrentVertex(ze,mr,0,0,ut)));if(Xr&&yr<pe-1){var qu=ze.dist(or);if(qu>2*qe){var Xl=ze.add(or.sub(ze)._mult(qe/qu)._round());this.updateDistance(ze,Xl),this.addCurrentVertex(Xl,mr,0,0,ut),ze=Xl}}}}},Ks.prototype.addCurrentVertex=function(o,u,c,y,C,R){R===void 0&&(R=!1);var z=u.y*y-u.x,Q=-u.y-u.x*y;this.addHalfVertex(o,u.x+u.y*c,u.y-u.x*c,R,!1,c,C),this.addHalfVertex(o,z,Q,R,!0,-y,C),this.distance>xp/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(o,u,c,y,C,R))},Ks.prototype.addHalfVertex=function(o,u,c,y,C,R,z){var Q=.5*(this.lineClips?this.scaledDistance*(xp-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((o.x<<1)+(y?1:0),(o.y<<1)+(C?1:0),Math.round(63*u)+128,Math.round(63*c)+128,1+(R===0?0:R<0?-1:1)|(63&Q)<<2,Q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var pe=z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,pe),z.primitiveLength++),C?this.e2=pe:this.e1=pe},Ks.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Ks.prototype.updateDistance=function(o,u){this.distance+=o.dist(u),this.updateScaledDistance()},Ca("LineBucket",Ks,{omit:["layers","patternFeatures"]});var Qh=new Qu({"line-cap":new Qi(tt.layout_line["line-cap"]),"line-join":new Xa(tt.layout_line["line-join"]),"line-miter-limit":new Qi(tt.layout_line["line-miter-limit"]),"line-round-limit":new Qi(tt.layout_line["line-round-limit"]),"line-sort-key":new Xa(tt.layout_line["line-sort-key"])}),Bl={paint:new Qu({"line-opacity":new Xa(tt.paint_line["line-opacity"]),"line-color":new Xa(tt.paint_line["line-color"]),"line-translate":new Qi(tt.paint_line["line-translate"]),"line-translate-anchor":new Qi(tt.paint_line["line-translate-anchor"]),"line-width":new Xa(tt.paint_line["line-width"]),"line-gap-width":new Xa(tt.paint_line["line-gap-width"]),"line-offset":new Xa(tt.paint_line["line-offset"]),"line-blur":new Xa(tt.paint_line["line-blur"]),"line-dasharray":new Pl(tt.paint_line["line-dasharray"]),"line-pattern":new of(tt.paint_line["line-pattern"]),"line-gradient":new Bc(tt.paint_line["line-gradient"])}),layout:Qh},Df=new(function(o){function u(){o.apply(this,arguments)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.possiblyEvaluate=function(c,y){return y=new bs(Math.floor(y.zoom),{now:y.now,fadeDuration:y.fadeDuration,zoomHistory:y.zoomHistory,transition:y.transition}),o.prototype.possiblyEvaluate.call(this,c,y)},u.prototype.evaluate=function(c,y,C,R){return y=me({},y,{zoom:Math.floor(y.zoom)}),o.prototype.evaluate.call(this,c,y,C,R)},u}(Xa))(Bl.paint.properties["line-width"].specification);Df.useIntegerZoom=!0;var Jp=function(o){function u(c){o.call(this,c,Bl),this.gradientVersion=0}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype._handleSpecialPaintPropertyUpdate=function(c){c==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof sn,this.gradientVersion=(this.gradientVersion+1)%$)},u.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},u.prototype.recalculate=function(c,y){o.prototype.recalculate.call(this,c,y),this.paint._values["line-floorwidth"]=Df.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)},u.prototype.createBucket=function(c){return new Ks(c)},u.prototype.queryRadius=function(c){var y=c,C=jh(Pc("line-width",this,y),Pc("line-gap-width",this,y)),R=Pc("line-offset",this,y);return C/2+Math.abs(R)+Hl(this.paint.get("line-translate"))},u.prototype.queryIntersectsFeature=function(c,y,C,R,z,Q,pe){var Ie=zc(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Q.angle,pe),ze=pe/2*jh(this.paint.get("line-width").evaluate(y,C),this.paint.get("line-gap-width").evaluate(y,C)),qe=this.paint.get("line-offset").evaluate(y,C);return qe&&(R=function(ut,wt){for(var or=[],sr=new W(0,0),mr=0;mr<ut.length;mr++){for(var yr=ut[mr],rn=[],_n=0;_n<yr.length;_n++){var kn=yr[_n],Nn=yr[_n+1],pi=_n===0?sr:kn.sub(yr[_n-1])._unit()._perp(),Xr=_n===yr.length-1?sr:Nn.sub(kn)._unit()._perp(),ua=pi._add(Xr)._unit();ua._mult(1/(ua.x*Xr.x+ua.y*Xr.y)),rn.push(ua._mult(wt)._add(kn))}or.push(rn)}return or}(R,qe*pe)),function(ut,wt,or){for(var sr=0;sr<wt.length;sr++){var mr=wt[sr];if(ut.length>=3){for(var yr=0;yr<mr.length;yr++)if(sf(ut,mr[yr]))return!0}if(yc(ut,mr,or))return!0}return!1}(Ie,R,ze)},u.prototype.isTileClipped=function(){return!0},u}(ul);function jh(o,u){return u>0?u+2*o:o}var Jh=Pu([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Pd=Pu([{name:"a_projected_pos",components:3,type:"Float32"}],4),Qd=(Pu([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Pu([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ep=(Pu([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Pu([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),gd=Pu([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ov(o,u,c){return o.sections.forEach(function(y){y.text=function(C,R,z){var Q=R.layout.get("text-transform").evaluate(z,{});return Q==="uppercase"?C=C.toLocaleUpperCase():Q==="lowercase"&&(C=C.toLocaleLowerCase()),Tu.applyArabicShaping&&(C=Tu.applyArabicShaping(C)),C}(y.text,u,c)}),o}Pu([{name:"triangle",components:3,type:"Uint16"}]),Pu([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Pu([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Pu([{type:"Float32",name:"offsetX"}]),Pu([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ff={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Dp=function(o,u,c,y,C){var R,z,Q=8*C-y-1,pe=(1<<Q)-1,Ie=pe>>1,ze=-7,qe=c?C-1:0,ut=c?-1:1,wt=o[u+qe];for(qe+=ut,R=wt&(1<<-ze)-1,wt>>=-ze,ze+=Q;ze>0;R=256*R+o[u+qe],qe+=ut,ze-=8);for(z=R&(1<<-ze)-1,R>>=-ze,ze+=y;ze>0;z=256*z+o[u+qe],qe+=ut,ze-=8);if(R===0)R=1-Ie;else{if(R===pe)return z?NaN:1/0*(wt?-1:1);z+=Math.pow(2,y),R-=Ie}return(wt?-1:1)*z*Math.pow(2,R-y)},pp=function(o,u,c,y,C,R){var z,Q,pe,Ie=8*R-C-1,ze=(1<<Ie)-1,qe=ze>>1,ut=C===23?Math.pow(2,-24)-Math.pow(2,-77):0,wt=y?0:R-1,or=y?1:-1,sr=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(Q=isNaN(u)?1:0,z=ze):(z=Math.floor(Math.log(u)/Math.LN2),u*(pe=Math.pow(2,-z))<1&&(z--,pe*=2),(u+=z+qe>=1?ut/pe:ut*Math.pow(2,1-qe))*pe>=2&&(z++,pe/=2),z+qe>=ze?(Q=0,z=ze):z+qe>=1?(Q=(u*pe-1)*Math.pow(2,C),z+=qe):(Q=u*Math.pow(2,qe-1)*Math.pow(2,C),z=0));C>=8;o[c+wt]=255&Q,wt+=or,Q/=256,C-=8);for(z=z<<C|Q,Ie+=C;Ie>0;o[c+wt]=255&z,wt+=or,z/=256,Ie-=8);o[c+wt-or]|=128*sr},Fp=Fu;function Fu(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}Fu.Varint=0,Fu.Fixed64=1,Fu.Bytes=2,Fu.Fixed32=5;var bp=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function jo(o){return o.type===Fu.Bytes?o.readVarint()+o.pos:o.pos+1}function Oh(o,u,c){return c?4294967296*u+(o>>>0):4294967296*(u>>>0)+(o>>>0)}function Bp(o,u,c){var y=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));c.realloc(y);for(var C=c.pos-1;C>=o;C--)c.buf[C+y]=c.buf[C]}function Np(o,u){for(var c=0;c<o.length;c++)u.writeVarint(o[c])}function ke(o,u){for(var c=0;c<o.length;c++)u.writeSVarint(o[c])}function Ut(o,u){for(var c=0;c<o.length;c++)u.writeFloat(o[c])}function Ar(o,u){for(var c=0;c<o.length;c++)u.writeDouble(o[c])}function On(o,u){for(var c=0;c<o.length;c++)u.writeBoolean(o[c])}function bi(o,u){for(var c=0;c<o.length;c++)u.writeFixed32(o[c])}function zn(o,u){for(var c=0;c<o.length;c++)u.writeSFixed32(o[c])}function hi(o,u){for(var c=0;c<o.length;c++)u.writeFixed64(o[c])}function Fi(o,u){for(var c=0;c<o.length;c++)u.writeSFixed64(o[c])}function Gi(o,u){return(o[u]|o[u+1]<<8|o[u+2]<<16)+16777216*o[u+3]}function Ki(o,u,c){o[c]=u,o[c+1]=u>>>8,o[c+2]=u>>>16,o[c+3]=u>>>24}function ia(o,u){return(o[u]|o[u+1]<<8|o[u+2]<<16)+(o[u+3]<<24)}function oa(o,u,c){o===1&&c.readMessage(sa,u)}function sa(o,u,c){if(o===3){var y=c.readMessage(Bi,{}),C=y.width,R=y.height,z=y.left,Q=y.top,pe=y.advance;u.push({id:y.id,bitmap:new yf({width:C+6,height:R+6},y.bitmap),metrics:{width:C,height:R,left:z,top:Q,advance:pe}})}}function Bi(o,u,c){o===1?u.id=c.readVarint():o===2?u.bitmap=c.readBytes():o===3?u.width=c.readVarint():o===4?u.height=c.readVarint():o===5?u.left=c.readSVarint():o===6?u.top=c.readSVarint():o===7&&(u.advance=c.readVarint())}function Ji(o){for(var u=0,c=0,y=0,C=o;y<C.length;y+=1){var R=C[y];u+=R.w*R.h,c=Math.max(c,R.w)}o.sort(function(sr,mr){return mr.h-sr.h});for(var z=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),c),h:1/0}],Q=0,pe=0,Ie=0,ze=o;Ie<ze.length;Ie+=1)for(var qe=ze[Ie],ut=z.length-1;ut>=0;ut--){var wt=z[ut];if(!(qe.w>wt.w||qe.h>wt.h)){if(qe.x=wt.x,qe.y=wt.y,pe=Math.max(pe,qe.y+qe.h),Q=Math.max(Q,qe.x+qe.w),qe.w===wt.w&&qe.h===wt.h){var or=z.pop();ut<z.length&&(z[ut]=or)}else qe.h===wt.h?(wt.x+=qe.w,wt.w-=qe.w):qe.w===wt.w?(wt.y+=qe.h,wt.h-=qe.h):(z.push({x:wt.x+qe.w,y:wt.y,w:wt.w-qe.w,h:qe.h}),wt.y+=qe.h,wt.h-=qe.h);break}}return{w:Q,h:pe,fill:u/(Q*pe)||0}}Fu.prototype={destroy:function(){this.buf=null},readFields:function(o,u,c){for(c=c||this.length;this.pos<c;){var y=this.readVarint(),C=y>>3,R=this.pos;this.type=7&y,o(C,u,this),this.pos===R&&this.skip(y)}return u},readMessage:function(o,u){return this.readFields(o,u,this.readVarint()+this.pos)},readFixed32:function(){var o=Gi(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=ia(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=Gi(this.buf,this.pos)+4294967296*Gi(this.buf,this.pos+4);return this.pos+=8,o},readSFixed64:function(){var o=Gi(this.buf,this.pos)+4294967296*ia(this.buf,this.pos+4);return this.pos+=8,o},readFloat:function(){var o=Dp(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=Dp(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var u,c,y=this.buf;return u=127&(c=y[this.pos++]),c<128?u:(u|=(127&(c=y[this.pos++]))<<7,c<128?u:(u|=(127&(c=y[this.pos++]))<<14,c<128?u:(u|=(127&(c=y[this.pos++]))<<21,c<128?u:function(C,R,z){var Q,pe,Ie=z.buf;if(Q=(112&(pe=Ie[z.pos++]))>>4,pe<128||(Q|=(127&(pe=Ie[z.pos++]))<<3,pe<128)||(Q|=(127&(pe=Ie[z.pos++]))<<10,pe<128)||(Q|=(127&(pe=Ie[z.pos++]))<<17,pe<128)||(Q|=(127&(pe=Ie[z.pos++]))<<24,pe<128)||(Q|=(1&(pe=Ie[z.pos++]))<<31,pe<128))return Oh(C,Q,R);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(c=y[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var o=this.readVarint()+this.pos,u=this.pos;return this.pos=o,o-u>=12&&bp?function(c,y,C){return bp.decode(c.subarray(y,C))}(this.buf,u,o):function(c,y,C){for(var R="",z=y;z<C;){var Q,pe,Ie,ze=c[z],qe=null,ut=ze>239?4:ze>223?3:ze>191?2:1;if(z+ut>C)break;ut===1?ze<128&&(qe=ze):ut===2?(192&(Q=c[z+1]))==128&&(qe=(31&ze)<<6|63&Q)<=127&&(qe=null):ut===3?(pe=c[z+2],(192&(Q=c[z+1]))==128&&(192&pe)==128&&((qe=(15&ze)<<12|(63&Q)<<6|63&pe)<=2047||qe>=55296&&qe<=57343)&&(qe=null)):ut===4&&(pe=c[z+2],Ie=c[z+3],(192&(Q=c[z+1]))==128&&(192&pe)==128&&(192&Ie)==128&&((qe=(15&ze)<<18|(63&Q)<<12|(63&pe)<<6|63&Ie)<=65535||qe>=1114112)&&(qe=null)),qe===null?(qe=65533,ut=1):qe>65535&&(qe-=65536,R+=String.fromCharCode(qe>>>10&1023|55296),qe=56320|1023&qe),R+=String.fromCharCode(qe),z+=ut}return R}(this.buf,u,o)},readBytes:function(){var o=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,o);return this.pos=o,u},readPackedVarint:function(o,u){if(this.type!==Fu.Bytes)return o.push(this.readVarint(u));var c=jo(this);for(o=o||[];this.pos<c;)o.push(this.readVarint(u));return o},readPackedSVarint:function(o){if(this.type!==Fu.Bytes)return o.push(this.readSVarint());var u=jo(this);for(o=o||[];this.pos<u;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==Fu.Bytes)return o.push(this.readBoolean());var u=jo(this);for(o=o||[];this.pos<u;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==Fu.Bytes)return o.push(this.readFloat());var u=jo(this);for(o=o||[];this.pos<u;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==Fu.Bytes)return o.push(this.readDouble());var u=jo(this);for(o=o||[];this.pos<u;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==Fu.Bytes)return o.push(this.readFixed32());var u=jo(this);for(o=o||[];this.pos<u;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==Fu.Bytes)return o.push(this.readSFixed32());var u=jo(this);for(o=o||[];this.pos<u;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==Fu.Bytes)return o.push(this.readFixed64());var u=jo(this);for(o=o||[];this.pos<u;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==Fu.Bytes)return o.push(this.readSFixed64());var u=jo(this);for(o=o||[];this.pos<u;)o.push(this.readSFixed64());return o},skip:function(o){var u=7&o;if(u===Fu.Varint)for(;this.buf[this.pos++]>127;);else if(u===Fu.Bytes)this.pos=this.readVarint()+this.pos;else if(u===Fu.Fixed32)this.pos+=4;else{if(u!==Fu.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(o,u){this.writeVarint(o<<3|u)},realloc:function(o){for(var u=this.length||16;u<this.pos+o;)u*=2;if(u!==this.length){var c=new Uint8Array(u);c.set(this.buf),this.buf=c,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Ki(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Ki(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Ki(this.buf,-1&o,this.pos),Ki(this.buf,Math.floor(o*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Ki(this.buf,-1&o,this.pos),Ki(this.buf,Math.floor(o*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(u,c){var y,C;if(u>=0?(y=u%4294967296|0,C=u/4294967296|0):(C=~(-u/4294967296),4294967295^(y=~(-u%4294967296))?y=y+1|0:(y=0,C=C+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(R,z,Q){Q.buf[Q.pos++]=127&R|128,R>>>=7,Q.buf[Q.pos++]=127&R|128,R>>>=7,Q.buf[Q.pos++]=127&R|128,R>>>=7,Q.buf[Q.pos++]=127&R|128,Q.buf[Q.pos]=127&(R>>>=7)}(y,0,c),function(R,z){var Q=(7&R)<<4;z.buf[z.pos++]|=Q|((R>>>=3)?128:0),R&&(z.buf[z.pos++]=127&R|((R>>>=7)?128:0),R&&(z.buf[z.pos++]=127&R|((R>>>=7)?128:0),R&&(z.buf[z.pos++]=127&R|((R>>>=7)?128:0),R&&(z.buf[z.pos++]=127&R|((R>>>=7)?128:0),R&&(z.buf[z.pos++]=127&R)))))}(C,c)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(Boolean(o))},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var u=this.pos;this.pos=function(y,C,R){for(var z,Q,pe=0;pe<C.length;pe++){if((z=C.charCodeAt(pe))>55295&&z<57344){if(!Q){z>56319||pe+1===C.length?(y[R++]=239,y[R++]=191,y[R++]=189):Q=z;continue}if(z<56320){y[R++]=239,y[R++]=191,y[R++]=189,Q=z;continue}z=Q-55296<<10|z-56320|65536,Q=null}else Q&&(y[R++]=239,y[R++]=191,y[R++]=189,Q=null);z<128?y[R++]=z:(z<2048?y[R++]=z>>6|192:(z<65536?y[R++]=z>>12|224:(y[R++]=z>>18|240,y[R++]=z>>12&63|128),y[R++]=z>>6&63|128),y[R++]=63&z|128)}return R}(this.buf,o,this.pos);var c=this.pos-u;c>=128&&Bp(u,c,this),this.pos=u-1,this.writeVarint(c),this.pos+=c},writeFloat:function(o){this.realloc(4),pp(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),pp(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var u=o.length;this.writeVarint(u),this.realloc(u);for(var c=0;c<u;c++)this.buf[this.pos++]=o[c]},writeRawMessage:function(o,u){this.pos++;var c=this.pos;o(u,this);var y=this.pos-c;y>=128&&Bp(c,y,this),this.pos=c-1,this.writeVarint(y),this.pos+=y},writeMessage:function(o,u,c){this.writeTag(o,Fu.Bytes),this.writeRawMessage(u,c)},writePackedVarint:function(o,u){u.length&&this.writeMessage(o,Np,u)},writePackedSVarint:function(o,u){u.length&&this.writeMessage(o,ke,u)},writePackedBoolean:function(o,u){u.length&&this.writeMessage(o,On,u)},writePackedFloat:function(o,u){u.length&&this.writeMessage(o,Ut,u)},writePackedDouble:function(o,u){u.length&&this.writeMessage(o,Ar,u)},writePackedFixed32:function(o,u){u.length&&this.writeMessage(o,bi,u)},writePackedSFixed32:function(o,u){u.length&&this.writeMessage(o,zn,u)},writePackedFixed64:function(o,u){u.length&&this.writeMessage(o,hi,u)},writePackedSFixed64:function(o,u){u.length&&this.writeMessage(o,Fi,u)},writeBytesField:function(o,u){this.writeTag(o,Fu.Bytes),this.writeBytes(u)},writeFixed32Field:function(o,u){this.writeTag(o,Fu.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(o,u){this.writeTag(o,Fu.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(o,u){this.writeTag(o,Fu.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(o,u){this.writeTag(o,Fu.Fixed64),this.writeSFixed64(u)},writeVarintField:function(o,u){this.writeTag(o,Fu.Varint),this.writeVarint(u)},writeSVarintField:function(o,u){this.writeTag(o,Fu.Varint),this.writeSVarint(u)},writeStringField:function(o,u){this.writeTag(o,Fu.Bytes),this.writeString(u)},writeFloatField:function(o,u){this.writeTag(o,Fu.Fixed32),this.writeFloat(u)},writeDoubleField:function(o,u){this.writeTag(o,Fu.Fixed64),this.writeDouble(u)},writeBooleanField:function(o,u){this.writeVarintField(o,Boolean(u))}};var yn=function(o,u){var c=u.pixelRatio,y=u.version,C=u.stretchX,R=u.stretchY,z=u.content;this.paddedRect=o,this.pixelRatio=c,this.stretchX=C,this.stretchY=R,this.content=z,this.version=y},Qn={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Qn.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Qn.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Qn.tlbr.get=function(){return this.tl.concat(this.br)},Qn.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(yn.prototype,Qn);var Yi=function(o,u){var c={},y={};this.haveRenderCallbacks=[];var C=[];this.addImages(o,c,C),this.addImages(u,y,C);var R=Ji(C),z=new Gl({width:R.w||1,height:R.h||1});for(var Q in o){var pe=o[Q],Ie=c[Q].paddedRect;Gl.copy(pe.data,z,{x:0,y:0},{x:Ie.x+1,y:Ie.y+1},pe.data)}for(var ze in u){var qe=u[ze],ut=y[ze].paddedRect,wt=ut.x+1,or=ut.y+1,sr=qe.data.width,mr=qe.data.height;Gl.copy(qe.data,z,{x:0,y:0},{x:wt,y:or},qe.data),Gl.copy(qe.data,z,{x:0,y:mr-1},{x:wt,y:or-1},{width:sr,height:1}),Gl.copy(qe.data,z,{x:0,y:0},{x:wt,y:or+mr},{width:sr,height:1}),Gl.copy(qe.data,z,{x:sr-1,y:0},{x:wt-1,y:or},{width:1,height:mr}),Gl.copy(qe.data,z,{x:0,y:0},{x:wt+sr,y:or},{width:1,height:mr})}this.image=z,this.iconPositions=c,this.patternPositions=y};Yi.prototype.addImages=function(o,u,c){for(var y in o){var C=o[y],R={x:0,y:0,w:C.data.width+2,h:C.data.height+2};c.push(R),u[y]=new yn(R,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(y)}},Yi.prototype.patchUpdatedImages=function(o,u){for(var c in o.dispatchRenderCallbacks(this.haveRenderCallbacks),o.updatedImages)this.patchUpdatedImage(this.iconPositions[c],o.getImage(c),u),this.patchUpdatedImage(this.patternPositions[c],o.getImage(c),u)},Yi.prototype.patchUpdatedImage=function(o,u,c){if(o&&u&&o.version!==u.version){o.version=u.version;var y=o.tl;c.update(u.data,void 0,{x:y[0],y:y[1]})}},Ca("ImagePosition",yn),Ca("ImageAtlas",Yi);var wa={horizontal:1,vertical:2,horizontalOnly:3},yi=function(){this.scale=1,this.fontStack="",this.imageName=null};yi.forText=function(o,u){var c=new yi;return c.scale=o||1,c.fontStack=u,c},yi.forImage=function(o){var u=new yi;return u.imageName=o,u};var Ri=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function ta(o,u,c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or,sr){var mr,yr=Ri.fromFeature(o,C);qe===wa.vertical&&yr.verticalizePunctuation();var rn=Tu.processBidirectionalText,_n=Tu.processStyledBidirectionalText;if(rn&&yr.sections.length===1){mr=[];for(var kn=0,Nn=rn(yr.toString(),_a(yr,Ie,R,u,y,wt,or));kn<Nn.length;kn+=1){var pi=Nn[kn],Xr=new Ri;Xr.text=pi,Xr.sections=yr.sections;for(var ua=0;ua<pi.length;ua++)Xr.sectionIndex.push(0);mr.push(Xr)}}else if(_n){mr=[];for(var Ir=0,vn=_n(yr.text,yr.sectionIndex,_a(yr,Ie,R,u,y,wt,or));Ir<vn.length;Ir+=1){var $i=vn[Ir],ki=new Ri;ki.text=$i[0],ki.sectionIndex=$i[1],ki.sections=yr.sections,mr.push(ki)}}else mr=function(Ta,Ro){for(var No=[],vs=Ta.text,oo=0,Qs=0,Lu=Ro;Qs<Lu.length;Qs+=1){var cl=Lu[Qs];No.push(Ta.substring(oo,cl)),oo=cl}return oo<vs.length&&No.push(Ta.substring(oo,vs.length)),No}(yr,_a(yr,Ie,R,u,y,wt,or));var eo=[],Ha={positionedLines:eo,text:yr.toString(),top:ze[1],bottom:ze[1],left:ze[0],right:ze[0],writingMode:qe,iconsInText:!1,verticalizable:!1};return function(Ta,Ro,No,vs,oo,Qs,Lu,cl,qu,Xl,ac,Zc){for(var xf=0,vh=-17,uf=0,fs=0,Ic=cl==="right"?1:cl==="left"?0:.5,bf=0,Vs=0,Eu=oo;Vs<Eu.length;Vs+=1){var wu=Eu[Vs];wu.trim();var tu=wu.getMaxScale(),mh=24*(tu-1),Bf={positionedGlyphs:[],lineOffset:0};Ta.positionedLines[bf]=Bf;var Yl=Bf.positionedGlyphs,Uc=0;if(wu.length()){for(var $f=0;$f<wu.length();$f++){var Hu=wu.getSection($f),Ef=wu.getSectionIndex($f),gh=wu.getCharCode($f),ed=0,gl=null,Zs=null,Ep=null,lf=24,xc=!(qu===wa.horizontal||!ac&&!Dc(gh)||ac&&(wo[gh]||(rd=gh,Xi.Arabic(rd)||Xi["Arabic Supplement"](rd)||Xi["Arabic Extended-A"](rd)||Xi["Arabic Presentation Forms-A"](rd)||Xi["Arabic Presentation Forms-B"](rd))));if(Hu.imageName){var rl=vs[Hu.imageName];if(!rl)continue;Ep=Hu.imageName,Ta.iconsInText=Ta.iconsInText||!0,Zs=rl.paddedRect;var rh=rl.displaySize;Hu.scale=24*Hu.scale/Zc,ed=mh+(24-rh[1]*Hu.scale),lf=(gl={width:rh[0],height:rh[1],left:1,top:-3,advance:xc?rh[1]:rh[0]}).advance;var Jd=xc?rh[0]*Hu.scale-24*tu:rh[1]*Hu.scale-24*tu;Jd>0&&Jd>Uc&&(Uc=Jd)}else{var Iv=No[Hu.fontStack],pv=Iv&&Iv[gh];if(pv&&pv.rect)Zs=pv.rect,gl=pv.metrics;else{var Zd=Ro[Hu.fontStack],Kv=Zd&&Zd[gh];if(!Kv)continue;gl=Kv.metrics}ed=24*(tu-Hu.scale)}xc?(Ta.verticalizable=!0,Yl.push({glyph:gh,imageName:Ep,x:xf,y:vh+ed,vertical:xc,scale:Hu.scale,fontStack:Hu.fontStack,sectionIndex:Ef,metrics:gl,rect:Zs}),xf+=lf*Hu.scale+Xl):(Yl.push({glyph:gh,imageName:Ep,x:xf,y:vh+ed,vertical:xc,scale:Hu.scale,fontStack:Hu.fontStack,sectionIndex:Ef,metrics:gl,rect:Zs}),xf+=gl.advance*Hu.scale+Xl)}Yl.length!==0&&(uf=Math.max(xf-Xl,uf),vo(Yl,0,Yl.length-1,Ic,Uc)),xf=0;var td=Qs*tu+Uc;Bf.lineOffset=Math.max(Uc,mh),vh+=td,fs=Math.max(td,fs),++bf}else vh+=Qs,++bf}var rd,dp=vh- -17,ef=Zi(Lu),Lc=ef.horizontalAlign,Ru=ef.verticalAlign;(function(Rc,wp,zp,vp,dv,Lv,Rv,tp,kv){var yd,ev=(wp-zp)*dv;yd=Lv!==Rv?-tp*vp- -17:(-vp*kv+.5)*Rv;for(var vv=0,mv=Rc;vv<mv.length;vv+=1)for(var nd=0,Ih=mv[vv].positionedGlyphs;nd<Ih.length;nd+=1){var Zp=Ih[nd];Zp.x+=ev,Zp.y+=yd}})(Ta.positionedLines,Ic,Lc,Ru,uf,fs,Qs,dp,oo.length),Ta.top+=-Ru*dp,Ta.bottom=Ta.top+dp,Ta.left+=-Lc*uf,Ta.right=Ta.left+uf}(Ha,u,c,y,mr,z,Q,pe,qe,Ie,ut,sr),!function(Ta){for(var Ro=0,No=Ta;Ro<No.length;Ro+=1)if(No[Ro].positionedGlyphs.length!==0)return!1;return!0}(eo)&&Ha}Ri.fromFeature=function(o,u){for(var c=new Ri,y=0;y<o.sections.length;y++){var C=o.sections[y];C.image?c.addImageSection(C):c.addTextSection(C,u)}return c},Ri.prototype.length=function(){return this.text.length},Ri.prototype.getSection=function(o){return this.sections[this.sectionIndex[o]]},Ri.prototype.getSectionIndex=function(o){return this.sectionIndex[o]},Ri.prototype.getCharCode=function(o){return this.text.charCodeAt(o)},Ri.prototype.verticalizePunctuation=function(){this.text=function(o){for(var u="",c=0;c<o.length;c++){var y=o.charCodeAt(c+1)||null,C=o.charCodeAt(c-1)||null;u+=y&&af(y)&&!Ff[o[c+1]]||C&&af(C)&&!Ff[o[c-1]]||!Ff[o[c]]?o[c]:Ff[o[c]]}return u}(this.text)},Ri.prototype.trim=function(){for(var o=0,u=0;u<this.text.length&&wo[this.text.charCodeAt(u)];u++)o++;for(var c=this.text.length,y=this.text.length-1;y>=0&&y>=o&&wo[this.text.charCodeAt(y)];y--)c--;this.text=this.text.substring(o,c),this.sectionIndex=this.sectionIndex.slice(o,c)},Ri.prototype.substring=function(o,u){var c=new Ri;return c.text=this.text.substring(o,u),c.sectionIndex=this.sectionIndex.slice(o,u),c.sections=this.sections,c},Ri.prototype.toString=function(){return this.text},Ri.prototype.getMaxScale=function(){var o=this;return this.sectionIndex.reduce(function(u,c){return Math.max(u,o.sections[c].scale)},0)},Ri.prototype.addTextSection=function(o,u){this.text+=o.text,this.sections.push(yi.forText(o.scale,o.fontStack||u));for(var c=this.sections.length-1,y=0;y<o.text.length;++y)this.sectionIndex.push(c)},Ri.prototype.addImageSection=function(o){var u=o.image?o.image.name:"";if(u.length!==0){var c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(yi.forImage(u)),this.sectionIndex.push(this.sections.length-1)):Ye("Reached maximum number of images 6401")}else Ye("Can't add FormattedSection with an empty image.")},Ri.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var wo={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},mi={};function xi(o,u,c,y,C,R){if(u.imageName){var z=y[u.imageName];return z?z.displaySize[0]*u.scale*24/R+C:0}var Q=c[u.fontStack],pe=Q&&Q[o];return pe?pe.metrics.advance*u.scale+C:0}function Qa(o,u,c,y){var C=Math.pow(o-u,2);return y?o<u?C/2:2*C:C+Math.abs(c)*c}function Aa(o,u,c){var y=0;return o===10&&(y-=1e4),c&&(y+=150),o!==40&&o!==65288||(y+=50),u!==41&&u!==65289||(y+=50),y}function ri(o,u,c,y,C,R){for(var z=null,Q=Qa(u,c,C,R),pe=0,Ie=y;pe<Ie.length;pe+=1){var ze=Ie[pe],qe=Qa(u-ze.x,c,C,R)+ze.badness;qe<=Q&&(z=ze,Q=qe)}return{index:o,x:u,priorBreak:z,badness:Q}}function _a(o,u,c,y,C,R,z){if(R!=="point")return[];if(!o)return[];for(var Q,pe=[],Ie=function(mr,yr,rn,_n,kn,Nn){for(var pi=0,Xr=0;Xr<mr.length();Xr++){var ua=mr.getSection(Xr);pi+=xi(mr.getCharCode(Xr),ua,_n,kn,yr,Nn)}return pi/Math.max(1,Math.ceil(pi/rn))}(o,u,c,y,C,z),ze=o.text.indexOf("\u200B")>=0,qe=0,ut=0;ut<o.length();ut++){var wt=o.getSection(ut),or=o.getCharCode(ut);if(wo[or]||(qe+=xi(or,wt,y,C,u,z)),ut<o.length()-1){var sr=!((Q=or)<11904||!(Xi["Bopomofo Extended"](Q)||Xi.Bopomofo(Q)||Xi["CJK Compatibility Forms"](Q)||Xi["CJK Compatibility Ideographs"](Q)||Xi["CJK Compatibility"](Q)||Xi["CJK Radicals Supplement"](Q)||Xi["CJK Strokes"](Q)||Xi["CJK Symbols and Punctuation"](Q)||Xi["CJK Unified Ideographs Extension A"](Q)||Xi["CJK Unified Ideographs"](Q)||Xi["Enclosed CJK Letters and Months"](Q)||Xi["Halfwidth and Fullwidth Forms"](Q)||Xi.Hiragana(Q)||Xi["Ideographic Description Characters"](Q)||Xi["Kangxi Radicals"](Q)||Xi["Katakana Phonetic Extensions"](Q)||Xi.Katakana(Q)||Xi["Vertical Forms"](Q)||Xi["Yi Radicals"](Q)||Xi["Yi Syllables"](Q)));(mi[or]||sr||wt.imageName)&&pe.push(ri(ut+1,qe,Ie,pe,Aa(or,o.getCharCode(ut+1),sr&&ze),!1))}}return function mr(yr){return yr?mr(yr.priorBreak).concat(yr.index):[]}(ri(o.length(),qe,Ie,pe,0,!0))}function Zi(o){var u=.5,c=.5;switch(o){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:u,verticalAlign:c}}function vo(o,u,c,y,C){if(y||C)for(var R=o[c],z=(o[c].x+R.metrics.advance*R.scale)*y,Q=u;Q<=c;Q++)o[Q].x-=z,o[Q].y+=C}function Bo(o,u,c,y,C,R){var z,Q=o.image;if(Q.content){var pe=Q.content,Ie=Q.pixelRatio||1;z=[pe[0]/Ie,pe[1]/Ie,Q.displaySize[0]-pe[2]/Ie,Q.displaySize[1]-pe[3]/Ie]}var ze,qe,ut,wt,or=u.left*R,sr=u.right*R;c==="width"||c==="both"?(wt=C[0]+or-y[3],qe=C[0]+sr+y[1]):qe=(wt=C[0]+(or+sr-Q.displaySize[0])/2)+Q.displaySize[0];var mr=u.top*R,yr=u.bottom*R;return c==="height"||c==="both"?(ze=C[1]+mr-y[0],ut=C[1]+yr+y[2]):ut=(ze=C[1]+(mr+yr-Q.displaySize[1])/2)+Q.displaySize[1],{image:Q,top:ze,right:qe,bottom:ut,left:wt,collisionPadding:z}}mi[10]=!0,mi[32]=!0,mi[38]=!0,mi[40]=!0,mi[41]=!0,mi[43]=!0,mi[45]=!0,mi[47]=!0,mi[173]=!0,mi[183]=!0,mi[8203]=!0,mi[8208]=!0,mi[8211]=!0,mi[8231]=!0;var Hi=function(o){function u(c,y,C,R){o.call(this,c,y),this.angle=C,R!==void 0&&(this.segment=R)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.clone=function(){return new u(this.x,this.y,this.angle,this.segment)},u}(W);function ba(o,u){var c=u.expression;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new bs(o+1))};if(c.kind==="source")return{kind:"source"};for(var y=c.zoomStops,C=c.interpolationType,R=0;R<y.length&&y[R]<=o;)R++;for(var z=R=Math.max(0,R-1);z<y.length&&y[z]<o+1;)z++;z=Math.min(y.length-1,z);var Q=y[R],pe=y[z];return c.kind==="composite"?{kind:"composite",minZoom:Q,maxZoom:pe,interpolationType:C}:{kind:"camera",minZoom:Q,maxZoom:pe,minSize:c.evaluate(new bs(Q)),maxSize:c.evaluate(new bs(pe)),interpolationType:C}}function go(o,u,c){var y=u.uSize,C=c.lowerSize;return o.kind==="source"?C/128:o.kind==="composite"?lt(C/128,c.upperSize/128,u.uSizeT):y}function Wo(o,u){var c=0,y=0;if(o.kind==="constant")y=o.layoutSize;else if(o.kind!=="source"){var C=o.interpolationType,R=C?Ce(xt.interpolationFactor(C,u,o.minZoom,o.maxZoom),0,1):0;o.kind==="camera"?y=lt(o.minSize,o.maxSize,R):c=R}return{uSizeT:c,uSize:y}}Ca("Anchor",Hi);var Ps=Object.freeze({__proto__:null,getSizeData:ba,evaluateSizeForFeature:go,evaluateSizeForZoom:Wo,SIZE_PACK_FACTOR:128});function xu(o,u,c,y,C){if(u.segment===void 0)return!0;for(var R=u,z=u.segment+1,Q=0;Q>-c/2;){if(--z<0)return!1;Q-=o[z].dist(R),R=o[z]}Q+=o[z].dist(o[z+1]),z++;for(var pe=[],Ie=0;Q<c/2;){var ze=o[z],qe=o[z+1];if(!qe)return!1;var ut=o[z-1].angleTo(ze)-ze.angleTo(qe);for(ut=Math.abs((ut+3*Math.PI)%(2*Math.PI)-Math.PI),pe.push({distance:Q,angleDelta:ut}),Ie+=ut;Q-pe[0].distance>y;)Ie-=pe.shift().angleDelta;if(Ie>C)return!1;z++,Q+=ze.dist(qe)}return!0}function el(o){for(var u=0,c=0;c<o.length-1;c++)u+=o[c].dist(o[c+1]);return u}function Fs(o,u,c){return o?.6*u*c:0}function pc(o,u){return Math.max(o?o.right-o.left:0,u?u.right-u.left:0)}function pl(o,u,c,y,C,R){for(var z=Fs(c,C,R),Q=pc(c,y)*R,pe=0,Ie=el(o)/2,ze=0;ze<o.length-1;ze++){var qe=o[ze],ut=o[ze+1],wt=qe.dist(ut);if(pe+wt>Ie){var or=(Ie-pe)/wt,sr=lt(qe.x,ut.x,or),mr=lt(qe.y,ut.y,or),yr=new Hi(sr,mr,ut.angleTo(qe),ze);return yr._round(),!z||xu(o,yr,Q,z,u)?yr:void 0}pe+=wt}}function Ol(o,u,c,y,C,R,z,Q,pe){var Ie=Fs(y,R,z),ze=pc(y,C),qe=ze*z,ut=o[0].x===0||o[0].x===pe||o[0].y===0||o[0].y===pe;return u-qe<u/4&&(u=qe+u/4),function wt(or,sr,mr,yr,rn,_n,kn,Nn,pi){for(var Xr=_n/2,ua=el(or),Ir=0,vn=sr-mr,$i=[],ki=0;ki<or.length-1;ki++){for(var eo=or[ki],Ha=or[ki+1],Ta=eo.dist(Ha),Ro=Ha.angleTo(eo);vn+mr<Ir+Ta;){var No=((vn+=mr)-Ir)/Ta,vs=lt(eo.x,Ha.x,No),oo=lt(eo.y,Ha.y,No);if(vs>=0&&vs<pi&&oo>=0&&oo<pi&&vn-Xr>=0&&vn+Xr<=ua){var Qs=new Hi(vs,oo,Ro,ki);Qs._round(),yr&&!xu(or,Qs,_n,yr,rn)||$i.push(Qs)}}Ir+=Ta}return Nn||$i.length||kn||($i=wt(or,Ir/2,mr,yr,rn,_n,kn,!0,pi)),$i}(o,ut?u/2*Q%u:(ze/2+2*R)*z*Q%u,u,Ie,c,qe,ut,!1,pe)}function Vu(o,u,c,y,C){for(var R=[],z=0;z<o.length;z++)for(var Q=o[z],pe=void 0,Ie=0;Ie<Q.length-1;Ie++){var ze=Q[Ie],qe=Q[Ie+1];ze.x<u&&qe.x<u||(ze.x<u?ze=new W(u,ze.y+(u-ze.x)/(qe.x-ze.x)*(qe.y-ze.y))._round():qe.x<u&&(qe=new W(u,ze.y+(u-ze.x)/(qe.x-ze.x)*(qe.y-ze.y))._round()),ze.y<c&&qe.y<c||(ze.y<c?ze=new W(ze.x+(c-ze.y)/(qe.y-ze.y)*(qe.x-ze.x),c)._round():qe.y<c&&(qe=new W(ze.x+(c-ze.y)/(qe.y-ze.y)*(qe.x-ze.x),c)._round()),ze.x>=y&&qe.x>=y||(ze.x>=y?ze=new W(y,ze.y+(y-ze.x)/(qe.x-ze.x)*(qe.y-ze.y))._round():qe.x>=y&&(qe=new W(y,ze.y+(y-ze.x)/(qe.x-ze.x)*(qe.y-ze.y))._round()),ze.y>=C&&qe.y>=C||(ze.y>=C?ze=new W(ze.x+(C-ze.y)/(qe.y-ze.y)*(qe.x-ze.x),C)._round():qe.y>=C&&(qe=new W(ze.x+(C-ze.y)/(qe.y-ze.y)*(qe.x-ze.x),C)._round()),pe&&ze.equals(pe[pe.length-1])||R.push(pe=[ze]),pe.push(qe)))))}return R}function Wl(o,u,c,y){var C=[],R=o.image,z=R.pixelRatio,Q=R.paddedRect.w-2,pe=R.paddedRect.h-2,Ie=o.right-o.left,ze=o.bottom-o.top,qe=R.stretchX||[[0,Q]],ut=R.stretchY||[[0,pe]],wt=function(vs,oo){return vs+oo[1]-oo[0]},or=qe.reduce(wt,0),sr=ut.reduce(wt,0),mr=Q-or,yr=pe-sr,rn=0,_n=or,kn=0,Nn=sr,pi=0,Xr=mr,ua=0,Ir=yr;if(R.content&&y){var vn=R.content;rn=dc(qe,0,vn[0]),kn=dc(ut,0,vn[1]),_n=dc(qe,vn[0],vn[2]),Nn=dc(ut,vn[1],vn[3]),pi=vn[0]-rn,ua=vn[1]-kn,Xr=vn[2]-vn[0]-_n,Ir=vn[3]-vn[1]-Nn}var $i=function(vs,oo,Qs,Lu){var cl=Il(vs.stretch-rn,_n,Ie,o.left),qu=ys(vs.fixed-pi,Xr,vs.stretch,or),Xl=Il(oo.stretch-kn,Nn,ze,o.top),ac=ys(oo.fixed-ua,Ir,oo.stretch,sr),Zc=Il(Qs.stretch-rn,_n,Ie,o.left),xf=ys(Qs.fixed-pi,Xr,Qs.stretch,or),vh=Il(Lu.stretch-kn,Nn,ze,o.top),uf=ys(Lu.fixed-ua,Ir,Lu.stretch,sr),fs=new W(cl,Xl),Ic=new W(Zc,Xl),bf=new W(Zc,vh),Vs=new W(cl,vh),Eu=new W(qu/z,ac/z),wu=new W(xf/z,uf/z),tu=u*Math.PI/180;if(tu){var mh=Math.sin(tu),Bf=Math.cos(tu),Yl=[Bf,-mh,mh,Bf];fs._matMult(Yl),Ic._matMult(Yl),Vs._matMult(Yl),bf._matMult(Yl)}var Uc=vs.stretch+vs.fixed,$f=oo.stretch+oo.fixed;return{tl:fs,tr:Ic,bl:Vs,br:bf,tex:{x:R.paddedRect.x+1+Uc,y:R.paddedRect.y+1+$f,w:Qs.stretch+Qs.fixed-Uc,h:Lu.stretch+Lu.fixed-$f},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Eu,pixelOffsetBR:wu,minFontScaleX:Xr/z/Ie,minFontScaleY:Ir/z/ze,isSDF:c}};if(y&&(R.stretchX||R.stretchY))for(var ki=Qc(qe,mr,or),eo=Qc(ut,yr,sr),Ha=0;Ha<ki.length-1;Ha++)for(var Ta=ki[Ha],Ro=ki[Ha+1],No=0;No<eo.length-1;No++)C.push($i(Ta,eo[No],Ro,eo[No+1]));else C.push($i({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Q+1},{fixed:0,stretch:pe+1}));return C}function dc(o,u,c){for(var y=0,C=0,R=o;C<R.length;C+=1){var z=R[C];y+=Math.max(u,Math.min(c,z[1]))-Math.max(u,Math.min(c,z[0]))}return y}function Qc(o,u,c){for(var y=[{fixed:-1,stretch:0}],C=0,R=o;C<R.length;C+=1){var z=R[C],Q=z[0],pe=z[1],Ie=y[y.length-1];y.push({fixed:Q-Ie.stretch,stretch:Ie.stretch}),y.push({fixed:Q-Ie.stretch,stretch:Ie.stretch+(pe-Q)})}return y.push({fixed:u+1,stretch:c}),y}function Il(o,u,c,y){return o/u*c+y}function ys(o,u,c,y){return o-u*c/y}var tl=function(o,u,c,y,C,R,z,Q,pe,Ie){if(this.boxStartIndex=o.length,pe){var ze=R.top,qe=R.bottom,ut=R.collisionPadding;ut&&(ze-=ut[1],qe+=ut[3]);var wt=qe-ze;wt>0&&(wt=Math.max(10,wt),this.circleDiameter=wt)}else{var or=R.top*z-Q,sr=R.bottom*z+Q,mr=R.left*z-Q,yr=R.right*z+Q,rn=R.collisionPadding;if(rn&&(mr-=rn[0]*z,or-=rn[1]*z,yr+=rn[2]*z,sr+=rn[3]*z),Ie){var _n=new W(mr,or),kn=new W(yr,or),Nn=new W(mr,sr),pi=new W(yr,sr),Xr=Ie*Math.PI/180;_n._rotate(Xr),kn._rotate(Xr),Nn._rotate(Xr),pi._rotate(Xr),mr=Math.min(_n.x,kn.x,Nn.x,pi.x),yr=Math.max(_n.x,kn.x,Nn.x,pi.x),or=Math.min(_n.y,kn.y,Nn.y,pi.y),sr=Math.max(_n.y,kn.y,Nn.y,pi.y)}o.emplaceBack(u.x,u.y,mr,or,yr,sr,c,y,C)}this.boxEndIndex=o.length},Ts=function(o,u){if(o===void 0&&(o=[]),u===void 0&&(u=Jc),this.data=o,this.length=this.data.length,this.compare=u,this.length>0)for(var c=(this.length>>1)-1;c>=0;c--)this._down(c)};function Jc(o,u){return o<u?-1:o>u?1:0}function Vo(o,u,c){u===void 0&&(u=1),c===void 0&&(c=!1);for(var y=1/0,C=1/0,R=-1/0,z=-1/0,Q=o[0],pe=0;pe<Q.length;pe++){var Ie=Q[pe];(!pe||Ie.x<y)&&(y=Ie.x),(!pe||Ie.y<C)&&(C=Ie.y),(!pe||Ie.x>R)&&(R=Ie.x),(!pe||Ie.y>z)&&(z=Ie.y)}var ze=Math.min(R-y,z-C),qe=ze/2,ut=new Ts([],js);if(ze===0)return new W(y,C);for(var wt=y;wt<R;wt+=ze)for(var or=C;or<z;or+=ze)ut.push(new Iu(wt+qe,or+qe,qe,o));for(var sr=function(rn){for(var _n=0,kn=0,Nn=0,pi=rn[0],Xr=0,ua=pi.length,Ir=ua-1;Xr<ua;Ir=Xr++){var vn=pi[Xr],$i=pi[Ir],ki=vn.x*$i.y-$i.x*vn.y;kn+=(vn.x+$i.x)*ki,Nn+=(vn.y+$i.y)*ki,_n+=3*ki}return new Iu(kn/_n,Nn/_n,0,rn)}(o),mr=ut.length;ut.length;){var yr=ut.pop();(yr.d>sr.d||!sr.d)&&(sr=yr,c&&console.log("found best %d after %d probes",Math.round(1e4*yr.d)/1e4,mr)),yr.max-sr.d<=u||(ut.push(new Iu(yr.p.x-(qe=yr.h/2),yr.p.y-qe,qe,o)),ut.push(new Iu(yr.p.x+qe,yr.p.y-qe,qe,o)),ut.push(new Iu(yr.p.x-qe,yr.p.y+qe,qe,o)),ut.push(new Iu(yr.p.x+qe,yr.p.y+qe,qe,o)),mr+=4)}return c&&(console.log("num probes: "+mr),console.log("best distance: "+sr.d)),sr.p}function js(o,u){return u.max-o.max}function Iu(o,u,c,y){this.p=new W(o,u),this.h=c,this.d=function(C,R){for(var z=!1,Q=1/0,pe=0;pe<R.length;pe++)for(var Ie=R[pe],ze=0,qe=Ie.length,ut=qe-1;ze<qe;ut=ze++){var wt=Ie[ze],or=Ie[ut];wt.y>C.y!=or.y>C.y&&C.x<(or.x-wt.x)*(C.y-wt.y)/(or.y-wt.y)+wt.x&&(z=!z),Q=Math.min(Q,bh(C,wt,or))}return(z?1:-1)*Math.sqrt(Q)}(this.p,y),this.max=this.d+this.h*Math.SQRT2}Ts.prototype.push=function(o){this.data.push(o),this.length++,this._up(this.length-1)},Ts.prototype.pop=function(){if(this.length!==0){var o=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),o}},Ts.prototype.peek=function(){return this.data[0]},Ts.prototype._up=function(o){for(var u=this.data,c=this.compare,y=u[o];o>0;){var C=o-1>>1,R=u[C];if(c(y,R)>=0)break;u[o]=R,o=C}u[o]=y},Ts.prototype._down=function(o){for(var u=this.data,c=this.compare,y=this.length>>1,C=u[o];o<y;){var R=1+(o<<1),z=u[R],Q=R+1;if(Q<this.length&&c(u[Q],z)<0&&(R=Q,z=u[Q]),c(z,C)>=0)break;u[o]=z,o=R}u[o]=C};var ic=Number.POSITIVE_INFINITY;function Vh(o,u){return u[1]!==ic?function(c,y,C){var R=0,z=0;switch(y=Math.abs(y),C=Math.abs(C),c){case"top-right":case"top-left":case"top":z=C-7;break;case"bottom-right":case"bottom-left":case"bottom":z=7-C}switch(c){case"top-right":case"bottom-right":case"right":R=-y;break;case"top-left":case"bottom-left":case"left":R=y}return[R,z]}(o,u[0],u[1]):function(c,y){var C=0,R=0;y<0&&(y=0);var z=y/Math.sqrt(2);switch(c){case"top-right":case"top-left":R=z-7;break;case"bottom-right":case"bottom-left":R=7-z;break;case"bottom":R=7-y;break;case"top":R=y-7}switch(c){case"top-right":case"bottom-right":C=-z;break;case"top-left":case"bottom-left":C=z;break;case"left":C=y;break;case"right":C=-y}return[C,R]}(o,u[0])}function lr(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Wn(o,u,c,y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or){var sr=function(kn,Nn,pi,Xr,ua,Ir,vn,$i){for(var ki=Xr.layout.get("text-rotate").evaluate(Ir,{})*Math.PI/180,eo=[],Ha=0,Ta=Nn.positionedLines;Ha<Ta.length;Ha+=1)for(var Ro=Ta[Ha],No=0,vs=Ro.positionedGlyphs;No<vs.length;No+=1){var oo=vs[No];if(oo.rect){var Qs=oo.rect||{},Lu=4,cl=!0,qu=1,Xl=0,ac=(ua||$i)&&oo.vertical,Zc=oo.metrics.advance*oo.scale/2;if($i&&Nn.verticalizable&&(Xl=Ro.lineOffset/2-(oo.imageName?-(24-oo.metrics.width*oo.scale)/2:24*(oo.scale-1))),oo.imageName){var xf=vn[oo.imageName];cl=xf.sdf,Lu=1/(qu=xf.pixelRatio)}var vh=ua?[oo.x+Zc,oo.y]:[0,0],uf=ua?[0,0]:[oo.x+Zc+pi[0],oo.y+pi[1]-Xl],fs=[0,0];ac&&(fs=uf,uf=[0,0]);var Ic=(oo.metrics.left-Lu)*oo.scale-Zc+uf[0],bf=(-oo.metrics.top-Lu)*oo.scale+uf[1],Vs=Ic+Qs.w*oo.scale/qu,Eu=bf+Qs.h*oo.scale/qu,wu=new W(Ic,bf),tu=new W(Vs,bf),mh=new W(Ic,Eu),Bf=new W(Vs,Eu);if(ac){var Yl=new W(-Zc,Zc- -17),Uc=-Math.PI/2,$f=12-Zc,Hu=new W(22-$f,-(oo.imageName?$f:0)),Ef=new(Function.prototype.bind.apply(W,[null].concat(fs)));wu._rotateAround(Uc,Yl)._add(Hu)._add(Ef),tu._rotateAround(Uc,Yl)._add(Hu)._add(Ef),mh._rotateAround(Uc,Yl)._add(Hu)._add(Ef),Bf._rotateAround(Uc,Yl)._add(Hu)._add(Ef)}if(ki){var gh=Math.sin(ki),ed=Math.cos(ki),gl=[ed,-gh,gh,ed];wu._matMult(gl),tu._matMult(gl),mh._matMult(gl),Bf._matMult(gl)}var Zs=new W(0,0),Ep=new W(0,0);eo.push({tl:wu,tr:tu,bl:mh,br:Bf,tex:Qs,writingMode:Nn.writingMode,glyphOffset:vh,sectionIndex:oo.sectionIndex,isSDF:cl,pixelOffsetTL:Zs,pixelOffsetBR:Ep,minFontScaleX:0,minFontScaleY:0})}}return eo}(0,c,Q,C,R,z,y,o.allowVerticalPlacement),mr=o.textSizeData,yr=null;mr.kind==="source"?(yr=[128*C.layout.get("text-size").evaluate(z,{})])[0]>32640&&Ye(o.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):mr.kind==="composite"&&((yr=[128*wt.compositeTextSizes[0].evaluate(z,{},or),128*wt.compositeTextSizes[1].evaluate(z,{},or)])[0]>32640||yr[1]>32640)&&Ye(o.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),o.addSymbols(o.text,sr,yr,Q,R,z,Ie,u,pe.lineStartIndex,pe.lineLength,ut,or);for(var rn=0,_n=ze;rn<_n.length;rn+=1)qe[_n[rn]]=o.text.placedSymbolArray.length-1;return 4*sr.length}function Rn(o){for(var u in o)return o[u];return null}function ro(o,u,c,y){var C=o.compareText;if(u in C){for(var R=C[u],z=R.length-1;z>=0;z--)if(y.dist(R[z])<c)return!0}else C[u]=[];return C[u].push(y),!1}var qs=Gf.VectorTileFeature.types,ir=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Rt(o,u,c,y,C,R,z,Q,pe,Ie,ze,qe,ut){var wt=Q?Math.min(32640,Math.round(Q[0])):0,or=Q?Math.min(32640,Math.round(Q[1])):0;o.emplaceBack(u,c,Math.round(32*y),Math.round(32*C),R,z,(wt<<1)+(pe?1:0),or,16*Ie,16*ze,256*qe,256*ut)}function Zr(o,u,c){o.emplaceBack(u.x,u.y,c),o.emplaceBack(u.x,u.y,c),o.emplaceBack(u.x,u.y,c),o.emplaceBack(u.x,u.y,c)}function cn(o){for(var u=0,c=o.sections;u<c.length;u+=1)if(Cc(c[u].text))return!0;return!1}var jn=function(o){this.layoutVertexArray=new ss,this.indexArray=new gf,this.programConfigurations=o,this.segments=new Lt,this.dynamicLayoutVertexArray=new Uu,this.opacityVertexArray=new cs,this.placedSymbolArray=new b};jn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},jn.prototype.upload=function(o,u,c,y){this.isEmpty()||(c&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Jh.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,Pd.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,ir,!0),this.opacityVertexBuffer.itemSize=1),(c||y)&&this.programConfigurations.upload(o))},jn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Ca("SymbolBuffers",jn);var Wr=function(o,u,c){this.layoutVertexArray=new o,this.layoutAttributes=u,this.indexArray=new c,this.segments=new Lt,this.collisionVertexArray=new Tc};Wr.prototype.upload=function(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,Qd.members,!0)},Wr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Ca("CollisionBuffers",Wr);var wr=function(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(R){return R.id}),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Xs([]),this.placementViewportMatrix=Xs([]);var u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ba(this.zoom,u["text-size"]),this.iconSizeData=ba(this.zoom,u["icon-size"]);var c=this.layers[0].layout,y=c.get("symbol-sort-key"),C=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=C!=="viewport-y"&&y.constantOr(1)!==void 0,this.sortFeaturesByY=(C==="viewport-y"||C==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map(function(R){return wa[R]})),this.stateDependentLayerIds=this.layers.filter(function(R){return R.isStateDependent()}).map(function(R){return R.id}),this.sourceID=o.sourceID};wr.prototype.createArrays=function(){this.text=new jn(new Io(this.layers,this.zoom,function(o){return/^text/.test(o)})),this.icon=new jn(new Io(this.layers,this.zoom,function(o){return/^icon/.test(o)})),this.glyphOffsetArray=new ee,this.lineVertexArray=new ge,this.symbolInstances=new q},wr.prototype.calculateGlyphDependencies=function(o,u,c,y,C){for(var R=0;R<o.length;R++)if(u[o.charCodeAt(R)]=!0,(c||y)&&C){var z=Ff[o.charAt(R)];z&&(u[z.charCodeAt(0)]=!0)}},wr.prototype.populate=function(o,u,c){var y=this.layers[0],C=y.layout,R=C.get("text-font"),z=C.get("text-field"),Q=C.get("icon-image"),pe=(z.value.kind!=="constant"||z.value.value instanceof ao&&!z.value.value.isEmpty()||z.value.value.toString().length>0)&&(R.value.kind!=="constant"||R.value.value.length>0),Ie=Q.value.kind!=="constant"||!!Q.value.value||Object.keys(Q.parameters).length>0,ze=C.get("symbol-sort-key");if(this.features=[],pe||Ie){for(var qe=u.iconDependencies,ut=u.glyphDependencies,wt=u.availableImages,or=new bs(this.zoom),sr=0,mr=o;sr<mr.length;sr+=1){var yr=mr[sr],rn=yr.feature,_n=yr.id,kn=yr.index,Nn=yr.sourceLayerIndex,pi=y._featureFilter.needGeometry,Xr=gu(rn,pi);if(y._featureFilter.filter(or,Xr,c)){pi||(Xr.geometry=Du(rn));var ua=void 0;if(pe){var Ir=y.getValueAndResolveTokens("text-field",Xr,c,wt),vn=ao.factory(Ir);cn(vn)&&(this.hasRTLText=!0),(!this.hasRTLText||op()==="unavailable"||this.hasRTLText&&Tu.isParsed())&&(ua=Ov(vn,y,Xr))}var $i=void 0;if(Ie){var ki=y.getValueAndResolveTokens("icon-image",Xr,c,wt);$i=ki instanceof Ga?ki:Ga.fromString(ki)}if(ua||$i){var eo=this.sortFeaturesByKey?ze.evaluate(Xr,{},c):void 0;if(this.features.push({id:_n,text:ua,icon:$i,index:kn,sourceLayerIndex:Nn,geometry:Xr.geometry,properties:rn.properties,type:qs[rn.type],sortKey:eo}),$i&&(qe[$i.name]=!0),ua){var Ha=R.evaluate(Xr,{},c).join(","),Ta=C.get("text-rotation-alignment")==="map"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(wa.vertical)>=0;for(var Ro=0,No=ua.sections;Ro<No.length;Ro+=1){var vs=No[Ro];if(vs.image)qe[vs.image.name]=!0;else{var oo=cc(ua.toString()),Qs=vs.fontStack||Ha,Lu=ut[Qs]=ut[Qs]||{};this.calculateGlyphDependencies(vs.text,Lu,Ta,this.allowVerticalPlacement,oo)}}}}}}C.get("symbol-placement")==="line"&&(this.features=function(cl){var qu={},Xl={},ac=[],Zc=0;function xf(Yl){ac.push(cl[Yl]),Zc++}function vh(Yl,Uc,$f){var Hu=Xl[Yl];return delete Xl[Yl],Xl[Uc]=Hu,ac[Hu].geometry[0].pop(),ac[Hu].geometry[0]=ac[Hu].geometry[0].concat($f[0]),Hu}function uf(Yl,Uc,$f){var Hu=qu[Uc];return delete qu[Uc],qu[Yl]=Hu,ac[Hu].geometry[0].shift(),ac[Hu].geometry[0]=$f[0].concat(ac[Hu].geometry[0]),Hu}function fs(Yl,Uc,$f){var Hu=$f?Uc[0][Uc[0].length-1]:Uc[0][0];return Yl+":"+Hu.x+":"+Hu.y}for(var Ic=0;Ic<cl.length;Ic++){var bf=cl[Ic],Vs=bf.geometry,Eu=bf.text?bf.text.toString():null;if(Eu){var wu=fs(Eu,Vs),tu=fs(Eu,Vs,!0);if(wu in Xl&&tu in qu&&Xl[wu]!==qu[tu]){var mh=uf(wu,tu,Vs),Bf=vh(wu,tu,ac[mh].geometry);delete qu[wu],delete Xl[tu],Xl[fs(Eu,ac[Bf].geometry,!0)]=Bf,ac[mh].geometry=null}else wu in Xl?vh(wu,tu,Vs):tu in qu?uf(wu,tu,Vs):(xf(Ic),qu[wu]=Zc-1,Xl[tu]=Zc-1)}else xf(Ic)}return ac.filter(function(Yl){return Yl.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(cl,qu){return cl.sortKey-qu.sortKey})}},wr.prototype.update=function(o,u,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,u,this.layers,c),this.icon.programConfigurations.updatePaintArrays(o,u,this.layers,c))},wr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},wr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},wr.prototype.upload=function(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},wr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},wr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},wr.prototype.addToLineVertexArray=function(o,u){var c=this.lineVertexArray.length;if(o.segment!==void 0){for(var y=o.dist(u[o.segment+1]),C=o.dist(u[o.segment]),R={},z=o.segment+1;z<u.length;z++)R[z]={x:u[z].x,y:u[z].y,tileUnitDistanceFromAnchor:y},z<u.length-1&&(y+=u[z+1].dist(u[z]));for(var Q=o.segment||0;Q>=0;Q--)R[Q]={x:u[Q].x,y:u[Q].y,tileUnitDistanceFromAnchor:C},Q>0&&(C+=u[Q-1].dist(u[Q]));for(var pe=0;pe<u.length;pe++){var Ie=R[pe];this.lineVertexArray.emplaceBack(Ie.x,Ie.y,Ie.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}},wr.prototype.addSymbols=function(o,u,c,y,C,R,z,Q,pe,Ie,ze,qe){for(var ut=o.indexArray,wt=o.layoutVertexArray,or=o.segments.prepareSegment(4*u.length,wt,ut,this.canOverlap?R.sortKey:void 0),sr=this.glyphOffsetArray.length,mr=or.vertexLength,yr=this.allowVerticalPlacement&&z===wa.vertical?Math.PI/2:0,rn=R.text&&R.text.sections,_n=0;_n<u.length;_n++){var kn=u[_n],Nn=kn.tl,pi=kn.tr,Xr=kn.bl,ua=kn.br,Ir=kn.tex,vn=kn.pixelOffsetTL,$i=kn.pixelOffsetBR,ki=kn.minFontScaleX,eo=kn.minFontScaleY,Ha=kn.glyphOffset,Ta=kn.isSDF,Ro=kn.sectionIndex,No=or.vertexLength,vs=Ha[1];Rt(wt,Q.x,Q.y,Nn.x,vs+Nn.y,Ir.x,Ir.y,c,Ta,vn.x,vn.y,ki,eo),Rt(wt,Q.x,Q.y,pi.x,vs+pi.y,Ir.x+Ir.w,Ir.y,c,Ta,$i.x,vn.y,ki,eo),Rt(wt,Q.x,Q.y,Xr.x,vs+Xr.y,Ir.x,Ir.y+Ir.h,c,Ta,vn.x,$i.y,ki,eo),Rt(wt,Q.x,Q.y,ua.x,vs+ua.y,Ir.x+Ir.w,Ir.y+Ir.h,c,Ta,$i.x,$i.y,ki,eo),Zr(o.dynamicLayoutVertexArray,Q,yr),ut.emplaceBack(No,No+1,No+2),ut.emplaceBack(No+1,No+2,No+3),or.vertexLength+=4,or.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ha[0]),_n!==u.length-1&&Ro===u[_n+1].sectionIndex||o.programConfigurations.populatePaintArrays(wt.length,R,R.index,{},qe,rn&&rn[Ro])}o.placedSymbolArray.emplaceBack(Q.x,Q.y,sr,this.glyphOffsetArray.length-sr,mr,pe,Ie,Q.segment,c?c[0]:0,c?c[1]:0,y[0],y[1],z,0,!1,0,ze)},wr.prototype._addCollisionDebugVertex=function(o,u,c,y,C,R){return u.emplaceBack(0,0),o.emplaceBack(c.x,c.y,y,C,Math.round(R.x),Math.round(R.y))},wr.prototype.addCollisionDebugVertices=function(o,u,c,y,C,R,z){var Q=C.segments.prepareSegment(4,C.layoutVertexArray,C.indexArray),pe=Q.vertexLength,Ie=C.layoutVertexArray,ze=C.collisionVertexArray,qe=z.anchorX,ut=z.anchorY;this._addCollisionDebugVertex(Ie,ze,R,qe,ut,new W(o,u)),this._addCollisionDebugVertex(Ie,ze,R,qe,ut,new W(c,u)),this._addCollisionDebugVertex(Ie,ze,R,qe,ut,new W(c,y)),this._addCollisionDebugVertex(Ie,ze,R,qe,ut,new W(o,y)),Q.vertexLength+=4;var wt=C.indexArray;wt.emplaceBack(pe,pe+1),wt.emplaceBack(pe+1,pe+2),wt.emplaceBack(pe+2,pe+3),wt.emplaceBack(pe+3,pe),Q.primitiveLength+=4},wr.prototype.addDebugCollisionBoxes=function(o,u,c,y){for(var C=o;C<u;C++){var R=this.collisionBoxArray.get(C);this.addCollisionDebugVertices(R.x1,R.y1,R.x2,R.y2,y?this.textCollisionBox:this.iconCollisionBox,R.anchorPoint,c)}},wr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Wr(Uf,ep.members,ju),this.iconCollisionBox=new Wr(Uf,ep.members,ju);for(var o=0;o<this.symbolInstances.length;o++){var u=this.symbolInstances.get(o);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}},wr.prototype._deserializeCollisionBoxesForSymbol=function(o,u,c,y,C,R,z,Q,pe){for(var Ie={},ze=u;ze<c;ze++){var qe=o.get(ze);Ie.textBox={x1:qe.x1,y1:qe.y1,x2:qe.x2,y2:qe.y2,anchorPointX:qe.anchorPointX,anchorPointY:qe.anchorPointY},Ie.textFeatureIndex=qe.featureIndex;break}for(var ut=y;ut<C;ut++){var wt=o.get(ut);Ie.verticalTextBox={x1:wt.x1,y1:wt.y1,x2:wt.x2,y2:wt.y2,anchorPointX:wt.anchorPointX,anchorPointY:wt.anchorPointY},Ie.verticalTextFeatureIndex=wt.featureIndex;break}for(var or=R;or<z;or++){var sr=o.get(or);Ie.iconBox={x1:sr.x1,y1:sr.y1,x2:sr.x2,y2:sr.y2,anchorPointX:sr.anchorPointX,anchorPointY:sr.anchorPointY},Ie.iconFeatureIndex=sr.featureIndex;break}for(var mr=Q;mr<pe;mr++){var yr=o.get(mr);Ie.verticalIconBox={x1:yr.x1,y1:yr.y1,x2:yr.x2,y2:yr.y2,anchorPointX:yr.anchorPointX,anchorPointY:yr.anchorPointY},Ie.verticalIconFeatureIndex=yr.featureIndex;break}return Ie},wr.prototype.deserializeCollisionBoxes=function(o){this.collisionArrays=[];for(var u=0;u<this.symbolInstances.length;u++){var c=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}},wr.prototype.hasTextData=function(){return this.text.segments.get().length>0},wr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},wr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},wr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},wr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},wr.prototype.addIndicesForPlacedSymbol=function(o,u){for(var c=o.placedSymbolArray.get(u),y=c.vertexStartIndex+4*c.numGlyphs,C=c.vertexStartIndex;C<y;C+=4)o.indexArray.emplaceBack(C,C+1,C+2),o.indexArray.emplaceBack(C+1,C+2,C+3)},wr.prototype.getSortedSymbolIndexes=function(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var u=Math.sin(o),c=Math.cos(o),y=[],C=[],R=[],z=0;z<this.symbolInstances.length;++z){R.push(z);var Q=this.symbolInstances.get(z);y.push(0|Math.round(u*Q.anchorX+c*Q.anchorY)),C.push(Q.featureIndex)}return R.sort(function(pe,Ie){return y[pe]-y[Ie]||C[Ie]-C[pe]}),R},wr.prototype.addToSortKeyRanges=function(o,u){var c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===u?c.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:o,symbolInstanceEnd:o+1})},wr.prototype.sortFeatures=function(o){var u=this;if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var c=0,y=this.symbolInstanceIndexes;c<y.length;c+=1){var C=this.symbolInstances.get(y[c]);this.featureSortOrder.push(C.featureIndex),[C.rightJustifiedTextSymbolIndex,C.centerJustifiedTextSymbolIndex,C.leftJustifiedTextSymbolIndex].forEach(function(R,z,Q){R>=0&&Q.indexOf(R)===z&&u.addIndicesForPlacedSymbol(u.text,R)}),C.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,C.verticalPlacedTextSymbolIndex),C.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,C.placedIconSymbolIndex),C.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,C.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Ca("SymbolBucket",wr,{omit:["layers","collisionBoxArray","features","compareText"]}),wr.MAX_GLYPHS=65535,wr.addDynamicAttributes=Zr;var nn=new Qu({"symbol-placement":new Qi(tt.layout_symbol["symbol-placement"]),"symbol-spacing":new Qi(tt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Qi(tt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xa(tt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Qi(tt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Qi(tt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Qi(tt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Qi(tt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Qi(tt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xa(tt.layout_symbol["icon-size"]),"icon-text-fit":new Qi(tt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qi(tt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xa(tt.layout_symbol["icon-image"]),"icon-rotate":new Xa(tt.layout_symbol["icon-rotate"]),"icon-padding":new Qi(tt.layout_symbol["icon-padding"]),"icon-keep-upright":new Qi(tt.layout_symbol["icon-keep-upright"]),"icon-offset":new Xa(tt.layout_symbol["icon-offset"]),"icon-anchor":new Xa(tt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Qi(tt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Qi(tt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Qi(tt.layout_symbol["text-rotation-alignment"]),"text-field":new Xa(tt.layout_symbol["text-field"]),"text-font":new Xa(tt.layout_symbol["text-font"]),"text-size":new Xa(tt.layout_symbol["text-size"]),"text-max-width":new Xa(tt.layout_symbol["text-max-width"]),"text-line-height":new Qi(tt.layout_symbol["text-line-height"]),"text-letter-spacing":new Xa(tt.layout_symbol["text-letter-spacing"]),"text-justify":new Xa(tt.layout_symbol["text-justify"]),"text-radial-offset":new Xa(tt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Qi(tt.layout_symbol["text-variable-anchor"]),"text-anchor":new Xa(tt.layout_symbol["text-anchor"]),"text-max-angle":new Qi(tt.layout_symbol["text-max-angle"]),"text-writing-mode":new Qi(tt.layout_symbol["text-writing-mode"]),"text-rotate":new Xa(tt.layout_symbol["text-rotate"]),"text-padding":new Qi(tt.layout_symbol["text-padding"]),"text-keep-upright":new Qi(tt.layout_symbol["text-keep-upright"]),"text-transform":new Xa(tt.layout_symbol["text-transform"]),"text-offset":new Xa(tt.layout_symbol["text-offset"]),"text-allow-overlap":new Qi(tt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Qi(tt.layout_symbol["text-ignore-placement"]),"text-optional":new Qi(tt.layout_symbol["text-optional"])}),Wt={paint:new Qu({"icon-opacity":new Xa(tt.paint_symbol["icon-opacity"]),"icon-color":new Xa(tt.paint_symbol["icon-color"]),"icon-halo-color":new Xa(tt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xa(tt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xa(tt.paint_symbol["icon-halo-blur"]),"icon-translate":new Qi(tt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Qi(tt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xa(tt.paint_symbol["text-opacity"]),"text-color":new Xa(tt.paint_symbol["text-color"],{runtimeType:It,getOverride:function(o){return o.textColor},hasOverride:function(o){return!!o.textColor}}),"text-halo-color":new Xa(tt.paint_symbol["text-halo-color"]),"text-halo-width":new Xa(tt.paint_symbol["text-halo-width"]),"text-halo-blur":new Xa(tt.paint_symbol["text-halo-blur"]),"text-translate":new Qi(tt.paint_symbol["text-translate"]),"text-translate-anchor":new Qi(tt.paint_symbol["text-translate-anchor"])}),layout:nn},Or=function(o){this.type=o.property.overrides?o.property.overrides.runtimeType:Li,this.defaultValue=o};Or.prototype.evaluate=function(o){if(o.formattedSection){var u=this.defaultValue.property.overrides;if(u&&u.hasOverride(o.formattedSection))return u.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default},Or.prototype.eachChild=function(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)},Or.prototype.outputDefined=function(){return!1},Or.prototype.serialize=function(){return null},Ca("FormatSectionOverride",Or,{omit:["defaultValue"]});var ar=function(o){function u(c){o.call(this,c,Wt)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.recalculate=function(c,y){if(o.prototype.recalculate.call(this,c,y),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var C=this.layout.get("text-writing-mode");if(C){for(var R=[],z=0,Q=C;z<Q.length;z+=1){var pe=Q[z];R.indexOf(pe)<0&&R.push(pe)}this.layout._values["text-writing-mode"]=R}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},u.prototype.getValueAndResolveTokens=function(c,y,C,R){var z=this.layout.get(c).evaluate(y,{},C,R),Q=this._unevaluatedLayout._values[c];return Q.isDataDriven()||ol(Q.value)||!z?z:function(pe,Ie){return Ie.replace(/{([^{}]+)}/g,function(ze,qe){return qe in pe?String(pe[qe]):""})}(y.properties,z)},u.prototype.createBucket=function(c){return new wr(c)},u.prototype.queryRadius=function(){return 0},u.prototype.queryIntersectsFeature=function(){return!1},u.prototype._setPaintOverrides=function(){for(var c=0,y=Wt.paint.overridableProperties;c<y.length;c+=1){var C=y[c];if(u.hasPaintOverride(this.layout,C)){var R,z=this.paint.get(C),Q=new Or(z),pe=new rf(Q,z.property.specification);R=z.value.kind==="constant"||z.value.kind==="source"?new Ds("source",pe):new Tl("composite",pe,z.value.zoomStops,z.value._interpolationType),this.paint._values[C]=new Ac(z.property,R,z.parameters)}}},u.prototype._handleOverridablePaintPropertyUpdate=function(c,y,C){return!(!this.layout||y.isDataDriven()||C.isDataDriven())&&u.hasPaintOverride(this.layout,c)},u.hasPaintOverride=function(c,y){var C=c.get("text-field"),R=Wt.paint.properties[y],z=!1,Q=function(ze){for(var qe=0,ut=ze;qe<ut.length;qe+=1)if(R.overrides&&R.overrides.hasOverride(ut[qe]))return void(z=!0)};if(C.value.kind==="constant"&&C.value.value instanceof ao)Q(C.value.value.sections);else if(C.value.kind==="source"){var pe=function(ze){z||(ze instanceof zo&&Fo(ze.value)===Kt?Q(ze.value.sections):ze instanceof Po?Q(ze.sections):ze.eachChild(pe))},Ie=C.value;Ie._styleExpression&&pe(Ie._styleExpression.expression)}return z},u}(ul),xn={paint:new Qu({"background-color":new Qi(tt.paint_background["background-color"]),"background-pattern":new Pl(tt.paint_background["background-pattern"]),"background-opacity":new Qi(tt.paint_background["background-opacity"])})},mn=function(o){function u(c){o.call(this,c,xn)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u}(ul),wi={paint:new Qu({"raster-opacity":new Qi(tt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Qi(tt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Qi(tt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Qi(tt.paint_raster["raster-brightness-max"]),"raster-saturation":new Qi(tt.paint_raster["raster-saturation"]),"raster-contrast":new Qi(tt.paint_raster["raster-contrast"]),"raster-resampling":new Qi(tt.paint_raster["raster-resampling"]),"raster-fade-duration":new Qi(tt.paint_raster["raster-fade-duration"])})},ya=function(o){function u(c){o.call(this,c,wi)}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u}(ul),xa=function(o){function u(c){o.call(this,c,{}),this.implementation=c}return o&&(u.__proto__=o),(u.prototype=Object.create(o&&o.prototype)).constructor=u,u.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},u.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},u.prototype.recalculate=function(){},u.prototype.updateTransitions=function(){},u.prototype.hasTransition=function(){},u.prototype.serialize=function(){},u.prototype.onAdd=function(c){this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},u.prototype.onRemove=function(c){this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},u}(ul),Sa={circle:Xh,heatmap:yu,hillshade:Kc,fill:Zh,"fill-extrusion":Mh,line:Jp,symbol:ar,background:mn,raster:ya},aa=G.HTMLImageElement,no=G.HTMLCanvasElement,Ya=G.HTMLVideoElement,io=G.ImageData,E=G.ImageBitmap,A=function(o,u,c,y){this.context=o,this.format=c,this.texture=o.gl.createTexture(),this.update(u,y)};A.prototype.update=function(o,u,c){var y=o.width,C=o.height,R=!(this.size&&this.size[0]===y&&this.size[1]===C||c),z=this.context,Q=z.gl;if(this.useMipmap=Boolean(u&&u.useMipmap),Q.bindTexture(Q.TEXTURE_2D,this.texture),z.pixelStoreUnpackFlipY.set(!1),z.pixelStoreUnpack.set(1),z.pixelStoreUnpackPremultiplyAlpha.set(this.format===Q.RGBA&&(!u||u.premultiply!==!1)),R)this.size=[y,C],o instanceof aa||o instanceof no||o instanceof Ya||o instanceof io||E&&o instanceof E?Q.texImage2D(Q.TEXTURE_2D,0,this.format,this.format,Q.UNSIGNED_BYTE,o):Q.texImage2D(Q.TEXTURE_2D,0,this.format,y,C,0,this.format,Q.UNSIGNED_BYTE,o.data);else{var pe=c||{x:0,y:0},Ie=pe.x,ze=pe.y;o instanceof aa||o instanceof no||o instanceof Ya||o instanceof io||E&&o instanceof E?Q.texSubImage2D(Q.TEXTURE_2D,0,Ie,ze,Q.RGBA,Q.UNSIGNED_BYTE,o):Q.texSubImage2D(Q.TEXTURE_2D,0,Ie,ze,y,C,Q.RGBA,Q.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Q.generateMipmap(Q.TEXTURE_2D)},A.prototype.bind=function(o,u,c){var y=this.context.gl;y.bindTexture(y.TEXTURE_2D,this.texture),c!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=y.LINEAR),o!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,o),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,c||o),this.filter=o),u!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,u),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,u),this.wrap=u)},A.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},A.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var L=function(o){var u=this;this._callback=o,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){u._triggered=!1,u._callback()})};L.prototype.trigger=function(){var o=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){o._triggered=!1,o._callback()},0))},L.prototype.remove=function(){delete this._channel,this._callback=function(){}};var P=function(o,u,c){this.target=o,this.parent=u,this.mapId=c,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},gt(["receive","process"],this),this.invoker=new L(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Se()?o:G};function B(o,u,c){var y=2*Math.PI*6378137/256/Math.pow(2,c);return[o*y-2*Math.PI*6378137/2,u*y-2*Math.PI*6378137/2]}P.prototype.send=function(o,u,c,y,C){var R=this;C===void 0&&(C=!1);var z=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(this.callbacks[z]=c);var Q=ue(this.globalScope)?void 0:[];return this.target.postMessage({id:z,type:o,hasCallback:!!c,targetMapId:y,mustQueue:C,sourceMapId:this.mapId,data:yo(u,Q)},Q),{cancel:function(){c&&delete R.callbacks[z],R.target.postMessage({id:z,type:"<cancel>",targetMapId:y,sourceMapId:R.mapId})}}},P.prototype.receive=function(o){var u=o.data,c=u.id;if(c&&(!u.targetMapId||this.mapId===u.targetMapId))if(u.type==="<cancel>"){delete this.tasks[c];var y=this.cancelCallbacks[c];delete this.cancelCallbacks[c],y&&y()}else Se()||u.mustQueue?(this.tasks[c]=u,this.taskQueue.push(c),this.invoker.trigger()):this.processTask(c,u)},P.prototype.process=function(){if(this.taskQueue.length){var o=this.taskQueue.shift(),u=this.tasks[o];delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),u&&this.processTask(o,u)}},P.prototype.processTask=function(o,u){var c=this;if(u.type==="<response>"){var y=this.callbacks[o];delete this.callbacks[o],y&&(u.error?y(As(u.error)):y(null,As(u.data)))}else{var C=!1,R=ue(this.globalScope)?void 0:[],z=u.hasCallback?function(ze,qe){C=!0,delete c.cancelCallbacks[o],c.target.postMessage({id:o,type:"<response>",sourceMapId:c.mapId,error:ze?yo(ze):null,data:yo(qe,R)},R)}:function(ze){C=!0},Q=null,pe=As(u.data);if(this.parent[u.type])Q=this.parent[u.type](u.sourceMapId,pe,z);else if(this.parent.getWorkerSource){var Ie=u.type.split(".");Q=this.parent.getWorkerSource(u.sourceMapId,Ie[0],pe.source)[Ie[1]](pe,z)}else z(new Error("Could not find function "+u.type));!C&&Q&&Q.cancel&&(this.cancelCallbacks[o]=Q.cancel)}},P.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var j=function(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))};j.prototype.setNorthEast=function(o){return this._ne=o instanceof te?new te(o.lng,o.lat):te.convert(o),this},j.prototype.setSouthWest=function(o){return this._sw=o instanceof te?new te(o.lng,o.lat):te.convert(o),this},j.prototype.extend=function(o){var u,c,y=this._sw,C=this._ne;if(o instanceof te)u=o,c=o;else{if(!(o instanceof j))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(j.convert(o)):this.extend(te.convert(o)):this;if(c=o._ne,!(u=o._sw)||!c)return this}return y||C?(y.lng=Math.min(u.lng,y.lng),y.lat=Math.min(u.lat,y.lat),C.lng=Math.max(c.lng,C.lng),C.lat=Math.max(c.lat,C.lat)):(this._sw=new te(u.lng,u.lat),this._ne=new te(c.lng,c.lat)),this},j.prototype.getCenter=function(){return new te((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},j.prototype.getSouthWest=function(){return this._sw},j.prototype.getNorthEast=function(){return this._ne},j.prototype.getNorthWest=function(){return new te(this.getWest(),this.getNorth())},j.prototype.getSouthEast=function(){return new te(this.getEast(),this.getSouth())},j.prototype.getWest=function(){return this._sw.lng},j.prototype.getSouth=function(){return this._sw.lat},j.prototype.getEast=function(){return this._ne.lng},j.prototype.getNorth=function(){return this._ne.lat},j.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},j.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},j.prototype.isEmpty=function(){return!(this._sw&&this._ne)},j.prototype.contains=function(o){var u=te.convert(o),c=u.lng,y=u.lat,C=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(C=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=y&&y<=this._ne.lat&&C},j.convert=function(o){return!o||o instanceof j?o:new j(o)};var te=function(o,u){if(isNaN(o)||isNaN(u))throw new Error("Invalid LngLat object: ("+o+", "+u+")");if(this.lng=+o,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};te.prototype.wrap=function(){return new te(We(this.lng,-180,180),this.lat)},te.prototype.toArray=function(){return[this.lng,this.lat]},te.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},te.prototype.distanceTo=function(o){var u=Math.PI/180,c=this.lat*u,y=o.lat*u,C=Math.sin(c)*Math.sin(y)+Math.cos(c)*Math.cos(y)*Math.cos((o.lng-this.lng)*u);return 63710088e-1*Math.acos(Math.min(C,1))},te.prototype.toBounds=function(o){o===void 0&&(o=0);var u=360*o/40075017,c=u/Math.cos(Math.PI/180*this.lat);return new j(new te(this.lng-c,this.lat-u),new te(this.lng+c,this.lat+u))},te.convert=function(o){if(o instanceof te)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new te(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new te(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var de=2*Math.PI*63710088e-1;function Oe(o){return de*Math.cos(o*Math.PI/180)}function et(o){return(180+o)/360}function Pt(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function Mr(o,u){return o/Oe(u)}function Qr(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}var Xn=function(o,u,c){c===void 0&&(c=0),this.x=+o,this.y=+u,this.z=+c};Xn.fromLngLat=function(o,u){u===void 0&&(u=0);var c=te.convert(o);return new Xn(et(c.lng),Pt(c.lat),Mr(u,c.lat))},Xn.prototype.toLngLat=function(){return new te(360*this.x-180,Qr(this.y))},Xn.prototype.toAltitude=function(){return this.z*Oe(Qr(this.y))},Xn.prototype.meterInMercatorCoordinateUnits=function(){return 1/de*(o=Qr(this.y),1/Math.cos(o*Math.PI/180));var o};var ii=function(o,u,c){this.z=o,this.x=u,this.y=c,this.key=wn(0,o,o,u,c)};ii.prototype.equals=function(o){return this.z===o.z&&this.x===o.x&&this.y===o.y},ii.prototype.url=function(o,u){var c,y,C,R,z,Q=(y=this.y,C=this.z,R=B(256*(c=this.x),256*(y=Math.pow(2,C)-y-1),C),z=B(256*(c+1),256*(y+1),C),R[0]+","+R[1]+","+z[0]+","+z[1]),pe=function(Ie,ze,qe){for(var ut,wt="",or=Ie;or>0;or--)wt+=(ze&(ut=1<<or-1)?1:0)+(qe&ut?2:0);return wt}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",pe).replace("{bbox-epsg-3857}",Q)},ii.prototype.getTilePoint=function(o){var u=Math.pow(2,this.z);return new W(8192*(o.x*u-this.x),8192*(o.y*u-this.y))},ii.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var li=function(o,u){this.wrap=o,this.canonical=u,this.key=wn(o,u.z,u.z,u.x,u.y)},Mn=function(o,u,c,y,C){this.overscaledZ=o,this.wrap=u,this.canonical=new ii(c,+y,+C),this.key=wn(u,o,c,y,C)};function wn(o,u,c,y,C){(o*=2)<0&&(o=-1*o-1);var R=1<<c;return(R*R*o+R*C+y).toString(36)+c.toString(36)+u.toString(36)}Mn.prototype.equals=function(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)},Mn.prototype.scaledTo=function(o){var u=this.canonical.z-o;return o>this.canonical.z?new Mn(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Mn(o,this.wrap,o,this.canonical.x>>u,this.canonical.y>>u)},Mn.prototype.calculateScaledKey=function(o,u){var c=this.canonical.z-o;return o>this.canonical.z?wn(this.wrap*+u,o,this.canonical.z,this.canonical.x,this.canonical.y):wn(this.wrap*+u,o,o,this.canonical.x>>c,this.canonical.y>>c)},Mn.prototype.isChildOf=function(o){if(o.wrap!==this.wrap)return!1;var u=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>u&&o.canonical.y===this.canonical.y>>u},Mn.prototype.children=function(o){if(this.overscaledZ>=o)return[new Mn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var u=this.canonical.z+1,c=2*this.canonical.x,y=2*this.canonical.y;return[new Mn(u,this.wrap,u,c,y),new Mn(u,this.wrap,u,c+1,y),new Mn(u,this.wrap,u,c,y+1),new Mn(u,this.wrap,u,c+1,y+1)]},Mn.prototype.isLessThan=function(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))},Mn.prototype.wrapped=function(){return new Mn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Mn.prototype.unwrapTo=function(o){return new Mn(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)},Mn.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Mn.prototype.toUnwrapped=function(){return new li(this.wrap,this.canonical)},Mn.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Mn.prototype.getTilePoint=function(o){return this.canonical.getTilePoint(new Xn(o.x-this.wrap,o.y))},Ca("CanonicalTileID",ii),Ca("OverscaledTileID",Mn,{omit:["posMatrix"]});var Vn=function(o,u,c){if(this.uid=o,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return Ye('"'+c+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=u.height;var y=this.dim=u.height-2;this.data=new Uint32Array(u.data.buffer),this.encoding=c||"mapbox";for(var C=0;C<y;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(y,C)]=this.data[this._idx(y-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,y)]=this.data[this._idx(C,y-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(y,-1)]=this.data[this._idx(y-1,0)],this.data[this._idx(-1,y)]=this.data[this._idx(0,y-1)],this.data[this._idx(y,y)]=this.data[this._idx(y-1,y-1)]};Vn.prototype.get=function(o,u){var c=new Uint8Array(this.data.buffer),y=4*this._idx(o,u);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(c[y],c[y+1],c[y+2])},Vn.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Vn.prototype._idx=function(o,u){if(o<-1||o>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(o+1)},Vn.prototype._unpackMapbox=function(o,u,c){return(256*o*256+256*u+c)/10-1e4},Vn.prototype._unpackTerrarium=function(o,u,c){return 256*o+u+c/256-32768},Vn.prototype.getPixels=function(){return new Gl({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Vn.prototype.backfillBorder=function(o,u,c){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");var y=u*this.dim,C=u*this.dim+this.dim,R=c*this.dim,z=c*this.dim+this.dim;switch(u){case-1:y=C-1;break;case 1:C=y+1}switch(c){case-1:R=z-1;break;case 1:z=R+1}for(var Q=-u*this.dim,pe=-c*this.dim,Ie=R;Ie<z;Ie++)for(var ze=y;ze<C;ze++)this.data[this._idx(ze,Ie)]=o.data[this._idx(ze+Q,Ie+pe)]},Ca("DEMData",Vn);var br=function(o){this._stringToNumber={},this._numberToString=[];for(var u=0;u<o.length;u++){var c=o[u];this._stringToNumber[c]=u,this._numberToString[u]=c}};br.prototype.encode=function(o){return this._stringToNumber[o]},br.prototype.decode=function(o){return this._numberToString[o]};var si=function(o,u,c,y,C){this.type="Feature",this._vectorTileFeature=o,o._z=u,o._x=c,o._y=y,this.properties=o.properties,this.id=C},Ti={geometry:{configurable:!0}};Ti.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Ti.geometry.set=function(o){this._geometry=o},si.prototype.toJSON=function(){var o={geometry:this.geometry};for(var u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(o[u]=this[u]);return o},Object.defineProperties(si.prototype,Ti);var ka=function(){this.state={},this.stateChanges={},this.deletedStates={}};ka.prototype.updateState=function(o,u,c){var y=String(u);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][y]=this.stateChanges[o][y]||{},me(this.stateChanges[o][y],c),this.deletedStates[o]===null)for(var C in this.deletedStates[o]={},this.state[o])C!==y&&(this.deletedStates[o][C]=null);else if(this.deletedStates[o]&&this.deletedStates[o][y]===null)for(var R in this.deletedStates[o][y]={},this.state[o][y])c[R]||(this.deletedStates[o][y][R]=null);else for(var z in c)this.deletedStates[o]&&this.deletedStates[o][y]&&this.deletedStates[o][y][z]===null&&delete this.deletedStates[o][y][z]},ka.prototype.removeFeatureState=function(o,u,c){if(this.deletedStates[o]!==null){var y=String(u);if(this.deletedStates[o]=this.deletedStates[o]||{},c&&u!==void 0)this.deletedStates[o][y]!==null&&(this.deletedStates[o][y]=this.deletedStates[o][y]||{},this.deletedStates[o][y][c]=null);else if(u!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][y])for(c in this.deletedStates[o][y]={},this.stateChanges[o][y])this.deletedStates[o][y][c]=null;else this.deletedStates[o][y]=null;else this.deletedStates[o]=null}},ka.prototype.getState=function(o,u){var c=String(u),y=me({},(this.state[o]||{})[c],(this.stateChanges[o]||{})[c]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){var C=this.deletedStates[o][u];if(C===null)return{};for(var R in C)delete y[R]}return y},ka.prototype.initializeTileState=function(o,u){o.setFeatureState(this.state,u)},ka.prototype.coalesceChanges=function(o,u){var c={};for(var y in this.stateChanges){this.state[y]=this.state[y]||{};var C={};for(var R in this.stateChanges[y])this.state[y][R]||(this.state[y][R]={}),me(this.state[y][R],this.stateChanges[y][R]),C[R]=this.state[y][R];c[y]=C}for(var z in this.deletedStates){this.state[z]=this.state[z]||{};var Q={};if(this.deletedStates[z]===null)for(var pe in this.state[z])Q[pe]={},this.state[z][pe]={};else for(var Ie in this.deletedStates[z]){if(this.deletedStates[z][Ie]===null)this.state[z][Ie]={};else for(var ze=0,qe=Object.keys(this.deletedStates[z][Ie]);ze<qe.length;ze+=1)delete this.state[z][Ie][qe[ze]];Q[Ie]=this.state[z][Ie]}c[z]=c[z]||{},me(c[z],Q)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(var ut in o)o[ut].setFeatureState(c,u)};var So=function(o,u){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new lc(8192,16,0),this.grid3D=new lc(8192,16,0),this.featureIndexArray=new st,this.promoteId=u};function Mo(o,u,c,y,C){return ft(o,function(R,z){var Q=u instanceof Yf?u.get(z):null;return Q&&Q.evaluate?Q.evaluate(c,y,C):Q})}function rs(o){for(var u=1/0,c=1/0,y=-1/0,C=-1/0,R=0,z=o;R<z.length;R+=1){var Q=z[R];u=Math.min(u,Q.x),c=Math.min(c,Q.y),y=Math.max(y,Q.x),C=Math.max(C,Q.y)}return{minX:u,minY:c,maxX:y,maxY:C}}function pu(o,u){return u-o}So.prototype.insert=function(o,u,c,y,C,R){var z=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,y,C);for(var Q=R?this.grid3D:this.grid,pe=0;pe<u.length;pe++){for(var Ie=u[pe],ze=[1/0,1/0,-1/0,-1/0],qe=0;qe<Ie.length;qe++){var ut=Ie[qe];ze[0]=Math.min(ze[0],ut.x),ze[1]=Math.min(ze[1],ut.y),ze[2]=Math.max(ze[2],ut.x),ze[3]=Math.max(ze[3],ut.y)}ze[0]<8192&&ze[1]<8192&&ze[2]>=0&&ze[3]>=0&&Q.insert(z,ze[0],ze[1],ze[2],ze[3])}},So.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Gf.VectorTile(new Fp(this.rawTileData)).layers,this.sourceLayerCoder=new br(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},So.prototype.query=function(o,u,c,y){var C=this;this.loadVTLayers();for(var R=o.params||{},z=8192/o.tileSize/o.scale,Q=Jl(R.filter),pe=o.queryGeometry,Ie=o.queryPadding*z,ze=rs(pe),qe=this.grid.query(ze.minX-Ie,ze.minY-Ie,ze.maxX+Ie,ze.maxY+Ie),ut=rs(o.cameraQueryGeometry),wt=this.grid3D.query(ut.minX-Ie,ut.minY-Ie,ut.maxX+Ie,ut.maxY+Ie,function(kn,Nn,pi,Xr){return function(ua,Ir,vn,$i,ki){for(var eo=0,Ha=ua;eo<Ha.length;eo+=1){var Ta=Ha[eo];if(Ir<=Ta.x&&vn<=Ta.y&&$i>=Ta.x&&ki>=Ta.y)return!0}var Ro=[new W(Ir,vn),new W(Ir,ki),new W($i,ki),new W($i,vn)];if(ua.length>2){for(var No=0,vs=Ro;No<vs.length;No+=1)if(sf(ua,vs[No]))return!0}for(var oo=0;oo<ua.length-1;oo++)if(ch(ua[oo],ua[oo+1],Ro))return!0;return!1}(o.cameraQueryGeometry,kn-Ie,Nn-Ie,pi+Ie,Xr+Ie)}),or=0,sr=wt;or<sr.length;or+=1)qe.push(sr[or]);qe.sort(pu);for(var mr,yr={},rn=function(kn){var Nn=qe[kn];if(Nn!==mr){mr=Nn;var pi=C.featureIndexArray.get(Nn),Xr=null;C.loadMatchingFeature(yr,pi.bucketIndex,pi.sourceLayerIndex,pi.featureIndex,Q,R.layers,R.availableImages,u,c,y,function(ua,Ir,vn){return Xr||(Xr=Du(ua)),Ir.queryIntersectsFeature(pe,ua,vn,Xr,C.z,o.transform,z,o.pixelPosMatrix)})}},_n=0;_n<qe.length;_n++)rn(_n);return yr},So.prototype.loadMatchingFeature=function(o,u,c,y,C,R,z,Q,pe,Ie,ze){var qe=this.bucketLayerIDs[u];if(!R||function(ua,Ir){for(var vn=0;vn<ua.length;vn++)if(Ir.indexOf(ua[vn])>=0)return!0;return!1}(R,qe)){var ut=this.sourceLayerCoder.decode(c),wt=this.vtLayers[ut].feature(y);if(C.needGeometry){var or=gu(wt,!0);if(!C.filter(new bs(this.tileID.overscaledZ),or,this.tileID.canonical))return}else if(!C.filter(new bs(this.tileID.overscaledZ),wt))return;for(var sr=this.getId(wt,ut),mr=0;mr<qe.length;mr++){var yr=qe[mr];if(!(R&&R.indexOf(yr)<0)){var rn=Q[yr];if(rn){var _n={};sr!==void 0&&Ie&&(_n=Ie.getState(rn.sourceLayer||"_geojsonTileLayer",sr));var kn=me({},pe[yr]);kn.paint=Mo(kn.paint,rn.paint,wt,_n,z),kn.layout=Mo(kn.layout,rn.layout,wt,_n,z);var Nn=!ze||ze(wt,rn,_n);if(Nn){var pi=new si(wt,this.z,this.x,this.y,sr);pi.layer=kn;var Xr=o[yr];Xr===void 0&&(Xr=o[yr]=[]),Xr.push({featureIndex:y,feature:pi,intersectionZ:Nn})}}}}}},So.prototype.lookupSymbolFeatures=function(o,u,c,y,C,R,z,Q){var pe={};this.loadVTLayers();for(var Ie=Jl(C),ze=0,qe=o;ze<qe.length;ze+=1)this.loadMatchingFeature(pe,c,y,qe[ze],Ie,R,z,Q,u);return pe},So.prototype.hasLayer=function(o){for(var u=0,c=this.bucketLayerIDs;u<c.length;u+=1)for(var y=0,C=c[u];y<C.length;y+=1)if(o===C[y])return!0;return!1},So.prototype.getId=function(o,u){var c=o.id;return this.promoteId&&typeof(c=o.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]])=="boolean"&&(c=Number(c)),c},Ca("FeatureIndex",So,{omit:["rawTileData","sourceLayerCoder"]});var Co=function(o,u){this.tileID=o,this.uid=Ke(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Co.prototype.registerFadeDuration=function(o){var u=o+this.timeAdded;u<gi.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)},Co.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Co.prototype.loadVectorData=function(o,u,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){for(var y in o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(Ie,ze){var qe={};if(!ze)return qe;for(var ut=function(){var sr=or[wt],mr=sr.layerIds.map(function(_n){return ze.getLayer(_n)}).filter(Boolean);if(mr.length!==0){sr.layers=mr,sr.stateDependentLayerIds&&(sr.stateDependentLayers=sr.stateDependentLayerIds.map(function(_n){return mr.filter(function(kn){return kn.id===_n})[0]}));for(var yr=0,rn=mr;yr<rn.length;yr+=1)qe[rn[yr].id]=sr}},wt=0,or=Ie;wt<or.length;wt+=1)ut();return qe}(o.buckets,u.style),this.hasSymbolBuckets=!1,this.buckets){var C=this.buckets[y];if(C instanceof wr){if(this.hasSymbolBuckets=!0,!c)break;C.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var R in this.buckets){var z=this.buckets[R];if(z instanceof wr&&z.hasRTLText){this.hasRTLText=!0,Tu.isLoading()||Tu.isLoaded()||op()!=="deferred"||tc();break}}for(var Q in this.queryPadding=0,this.buckets){var pe=this.buckets[Q];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(Q).queryRadius(pe))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new g},Co.prototype.unloadVectorData=function(){for(var o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Co.prototype.getBucket=function(o){return this.buckets[o.id]},Co.prototype.upload=function(o){for(var u in this.buckets){var c=this.buckets[u];c.uploadPending()&&c.upload(o)}var y=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new A(o,this.imageAtlas.image,y.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new A(o,this.glyphAtlasImage,y.ALPHA),this.glyphAtlasImage=null)},Co.prototype.prepare=function(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)},Co.prototype.queryRenderedFeatures=function(o,u,c,y,C,R,z,Q,pe,Ie){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:C,scale:R,tileSize:this.tileSize,pixelPosMatrix:Ie,transform:Q,params:z,queryPadding:this.queryPadding*pe},o,u,c):{}},Co.prototype.querySourceFeatures=function(o,u){var c=this.latestFeatureIndex;if(c&&c.rawTileData){var y=c.loadVTLayers(),C=u?u.sourceLayer:"",R=y._geojsonTileLayer||y[C];if(R)for(var z=Jl(u&&u.filter),Q=this.tileID.canonical,pe=Q.z,Ie=Q.x,ze=Q.y,qe={z:pe,x:Ie,y:ze},ut=0;ut<R.length;ut++){var wt=R.feature(ut);if(z.needGeometry){var or=gu(wt,!0);if(!z.filter(new bs(this.tileID.overscaledZ),or,this.tileID.canonical))continue}else if(!z.filter(new bs(this.tileID.overscaledZ),wt))continue;var sr=c.getId(wt,C),mr=new si(wt,pe,Ie,ze,sr);mr.tile=qe,o.push(mr)}}},Co.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Co.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Co.prototype.setExpiryData=function(o){var u=this.expirationTime;if(o.cacheControl){var c=Qe(o.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){var y=Date.now(),C=!1;if(this.expirationTime>y)C=!1;else if(u)if(this.expirationTime<u)C=!0;else{var R=this.expirationTime-u;R?this.expirationTime=y+Math.max(R,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Co.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Co.prototype.setFeatureState=function(o,u){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(o).length!==0){var c=this.latestFeatureIndex.loadVTLayers();for(var y in this.buckets)if(u.style.hasLayer(y)){var C=this.buckets[y],R=C.layers[0].sourceLayer||"_geojsonTileLayer",z=c[R],Q=o[R];if(z&&Q&&Object.keys(Q).length!==0){C.update(Q,z,this.imageAtlas&&this.imageAtlas.patternPositions||{});var pe=u&&u.style&&u.style.getLayer(y);pe&&(this.queryPadding=Math.max(this.queryPadding,pe.queryRadius(C)))}}}},Co.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Co.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<gi.now()},Co.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Co.prototype.setHoldDuration=function(o){this.symbolFadeHoldUntil=gi.now()+o},Co.prototype.setDependencies=function(o,u){for(var c={},y=0,C=u;y<C.length;y+=1)c[C[y]]=!0;this.dependencies[o]=c},Co.prototype.hasDependency=function(o,u){for(var c=0,y=o;c<y.length;c+=1){var C=this.dependencies[y[c]];if(C){for(var R=0,z=u;R<z.length;R+=1)if(C[z[R]])return!0}}return!1};var Qo=G.performance,bu=function(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},Qo.mark(this._marks.start)};bu.prototype.finish=function(){Qo.mark(this._marks.end);var o=Qo.getEntriesByName(this._marks.measure);return o.length===0&&(Qo.measure(this._marks.measure,this._marks.start,this._marks.end),o=Qo.getEntriesByName(this._marks.measure),Qo.clearMarks(this._marks.start),Qo.clearMarks(this._marks.end),Qo.clearMeasures(this._marks.measure)),o},m.Actor=P,m.AlphaImage=yf,m.CanonicalTileID=ii,m.CollisionBoxArray=g,m.Color=qi,m.DEMData=Vn,m.DataConstantProperty=Qi,m.DictionaryCoder=br,m.EXTENT=8192,m.ErrorEvent=Le,m.EvaluationParameters=bs,m.Event=Bt,m.Evented=St,m.FeatureIndex=So,m.FillBucket=Oc,m.FillExtrusionBucket=_f,m.ImageAtlas=Yi,m.ImagePosition=yn,m.LineBucket=Ks,m.LngLat=te,m.LngLatBounds=j,m.MercatorCoordinate=Xn,m.ONE_EM=24,m.OverscaledTileID=Mn,m.Point=W,m.Point$1=W,m.Properties=Qu,m.Protobuf=Fp,m.RGBAImage=Gl,m.RequestManager=Oi,m.RequestPerformance=bu,m.ResourceType=di,m.SegmentVector=Lt,m.SourceFeatureState=ka,m.StructArrayLayout1ui2=gp,m.StructArrayLayout2f1f2i16=Nc,m.StructArrayLayout2i4=Ja,m.StructArrayLayout3ui6=gf,m.StructArrayLayout4i8=Kn,m.SymbolBucket=wr,m.Texture=A,m.Tile=Co,m.Transitionable=cu,m.Uniform1f=va,m.Uniform1i=Pi,m.Uniform2f=na,m.Uniform3f=Ua,m.Uniform4f=co,m.UniformColor=Eo,m.UniformMatrix4f=qo,m.UnwrappedTileID=li,m.ValidationError=At,m.WritingMode=wa,m.ZoomHistory=Ul,m.add=function(o,u,c){return o[0]=u[0]+c[0],o[1]=u[1]+c[1],o[2]=u[2]+c[2],o},m.addDynamicAttributes=Zr,m.asyncAll=function(o,u,c){if(!o.length)return c(null,[]);var y=o.length,C=new Array(o.length),R=null;o.forEach(function(z,Q){u(z,function(pe,Ie){pe&&(R=pe),C[Q]=Ie,--y==0&&c(R,C)})})},m.bezier=xe,m.bindAll=gt,m.browser=gi,m.cacheEntryPossiblyAdded=function(o){++Dn>bn&&(o.getActor().send("enforceCacheSizeLimit",Br),Dn=0)},m.clamp=Ce,m.clearTileCache=function(o){var u=G.caches.delete("mapbox-tiles");o&&u.catch(o).then(function(){return o()})},m.clipLine=Vu,m.clone=function(o){var u=new iu(16);return u[0]=o[0],u[1]=o[1],u[2]=o[2],u[3]=o[3],u[4]=o[4],u[5]=o[5],u[6]=o[6],u[7]=o[7],u[8]=o[8],u[9]=o[9],u[10]=o[10],u[11]=o[11],u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15],u},m.clone$1=Ae,m.clone$2=function(o){var u=new iu(3);return u[0]=o[0],u[1]=o[1],u[2]=o[2],u},m.collisionCircleLayout=gd,m.config=Hn,m.create=function(){var o=new iu(16);return iu!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},m.create$1=function(){var o=new iu(9);return iu!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o},m.create$2=function(){var o=new iu(4);return iu!=Float32Array&&(o[1]=0,o[2]=0),o[0]=1,o[3]=1,o},m.createCommonjsModule=ae,m.createExpression=as,m.createLayout=Pu,m.createStyleLayer=function(o){return o.type==="custom"?new xa(o):new Sa[o.type](o)},m.cross=function(o,u,c){var y=u[0],C=u[1],R=u[2],z=c[0],Q=c[1],pe=c[2];return o[0]=C*pe-R*Q,o[1]=R*z-y*pe,o[2]=y*Q-C*z,o},m.deepEqual=function o(u,c){if(Array.isArray(u)){if(!Array.isArray(c)||u.length!==c.length)return!1;for(var y=0;y<u.length;y++)if(!o(u[y],c[y]))return!1;return!0}if(typeof u=="object"&&u!==null&&c!==null){if(typeof c!="object"||Object.keys(u).length!==Object.keys(c).length)return!1;for(var C in u)if(!o(u[C],c[C]))return!1;return!0}return u===c},m.dot=function(o,u){return o[0]*u[0]+o[1]*u[1]+o[2]*u[2]},m.dot$1=function(o,u){return o[0]*u[0]+o[1]*u[1]+o[2]*u[2]+o[3]*u[3]},m.ease=Fe,m.emitValidationErrors=mc,m.endsWith=ie,m.enforceCacheSizeLimit=function(o){gr(),it&&it.then(function(u){u.keys().then(function(c){for(var y=0;y<c.length-o;y++)u.delete(c[y])})})},m.evaluateSizeForFeature=go,m.evaluateSizeForZoom=Wo,m.evaluateVariableOffset=Vh,m.evented=jl,m.extend=me,m.featureFilter=Jl,m.filterObject=ve,m.fromRotation=function(o,u){var c=Math.sin(u),y=Math.cos(u);return o[0]=y,o[1]=c,o[2]=0,o[3]=-c,o[4]=y,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},m.getAnchorAlignment=Zi,m.getAnchorJustification=lr,m.getArrayBuffer=an,m.getImage=he,m.getJSON=function(o,u){return Ia(me(o,{type:"json"}),u)},m.getRTLTextPluginStatus=op,m.getReferrer=Ni,m.getVideo=function(o,u){var c,y,C=G.document.createElement("video");C.muted=!0,C.onloadstart=function(){u(null,C)};for(var R=0;R<o.length;R++){var z=G.document.createElement("source");c=o[R],y=void 0,(y=G.document.createElement("a")).href=c,(y.protocol!==G.document.location.protocol||y.host!==G.document.location.host)&&(C.crossOrigin="Anonymous"),z.src=o[R],C.appendChild(z)}return{cancel:function(){}}},m.identity=Xs,m.invert=function(o,u){var c=u[0],y=u[1],C=u[2],R=u[3],z=u[4],Q=u[5],pe=u[6],Ie=u[7],ze=u[8],qe=u[9],ut=u[10],wt=u[11],or=u[12],sr=u[13],mr=u[14],yr=u[15],rn=c*Q-y*z,_n=c*pe-C*z,kn=c*Ie-R*z,Nn=y*pe-C*Q,pi=y*Ie-R*Q,Xr=C*Ie-R*pe,ua=ze*sr-qe*or,Ir=ze*mr-ut*or,vn=ze*yr-wt*or,$i=qe*mr-ut*sr,ki=qe*yr-wt*sr,eo=ut*yr-wt*mr,Ha=rn*eo-_n*ki+kn*$i+Nn*vn-pi*Ir+Xr*ua;return Ha?(o[0]=(Q*eo-pe*ki+Ie*$i)*(Ha=1/Ha),o[1]=(C*ki-y*eo-R*$i)*Ha,o[2]=(sr*Xr-mr*pi+yr*Nn)*Ha,o[3]=(ut*pi-qe*Xr-wt*Nn)*Ha,o[4]=(pe*vn-z*eo-Ie*Ir)*Ha,o[5]=(c*eo-C*vn+R*Ir)*Ha,o[6]=(mr*kn-or*Xr-yr*_n)*Ha,o[7]=(ze*Xr-ut*kn+wt*_n)*Ha,o[8]=(z*ki-Q*vn+Ie*ua)*Ha,o[9]=(y*vn-c*ki-R*ua)*Ha,o[10]=(or*pi-sr*kn+yr*rn)*Ha,o[11]=(qe*kn-ze*pi-wt*rn)*Ha,o[12]=(Q*Ir-z*$i-pe*ua)*Ha,o[13]=(c*$i-y*Ir+C*ua)*Ha,o[14]=(sr*_n-or*Nn-mr*rn)*Ha,o[15]=(ze*Nn-qe*_n+ut*rn)*Ha,o):null},m.isChar=Xi,m.isMapboxURL=ea,m.keysDifference=function(o,u){var c=[];for(var y in o)y in u||c.push(y);return c},m.makeRequest=Ia,m.mapObject=ft,m.mercatorXfromLng=et,m.mercatorYfromLat=Pt,m.mercatorZfromAltitude=Mr,m.mul=Jf,m.multiply=Yc,m.mvt=Gf,m.nextPowerOfTwo=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},m.normalize=function(o,u){var c=u[0],y=u[1],C=u[2],R=c*c+y*y+C*C;return R>0&&(R=1/Math.sqrt(R)),o[0]=u[0]*R,o[1]=u[1]*R,o[2]=u[2]*R,o},m.number=lt,m.offscreenCanvasSupported=ui,m.ortho=function(o,u,c,y,C,R,z){var Q=1/(u-c),pe=1/(y-C),Ie=1/(R-z);return o[0]=-2*Q,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*pe,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*Ie,o[11]=0,o[12]=(u+c)*Q,o[13]=(C+y)*pe,o[14]=(z+R)*Ie,o[15]=1,o},m.parseGlyphPBF=function(o){return new Fp(o).readFields(oa,[])},m.pbf=Fp,m.performSymbolLayout=function(o,u,c,y,C,R,z){o.createArrays(),o.tilePixelRatio=8192/(512*o.overscaling),o.compareText={},o.iconsNeedLinear=!1;var Q=o.layers[0].layout,pe=o.layers[0]._unevaluatedLayout._values,Ie={};if(o.textSizeData.kind==="composite"){var ze=o.textSizeData,qe=ze.maxZoom;Ie.compositeTextSizes=[pe["text-size"].possiblyEvaluate(new bs(ze.minZoom),z),pe["text-size"].possiblyEvaluate(new bs(qe),z)]}if(o.iconSizeData.kind==="composite"){var ut=o.iconSizeData,wt=ut.maxZoom;Ie.compositeIconSizes=[pe["icon-size"].possiblyEvaluate(new bs(ut.minZoom),z),pe["icon-size"].possiblyEvaluate(new bs(wt),z)]}Ie.layoutTextSize=pe["text-size"].possiblyEvaluate(new bs(o.zoom+1),z),Ie.layoutIconSize=pe["icon-size"].possiblyEvaluate(new bs(o.zoom+1),z),Ie.textMaxSize=pe["text-size"].possiblyEvaluate(new bs(18));for(var or=24*Q.get("text-line-height"),sr=Q.get("text-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",mr=Q.get("text-keep-upright"),yr=Q.get("text-size"),rn=function(){var Nn=kn[_n],pi=Q.get("text-font").evaluate(Nn,{},z).join(","),Xr=yr.evaluate(Nn,{},z),ua=Ie.layoutTextSize.evaluate(Nn,{},z),Ir=Ie.layoutIconSize.evaluate(Nn,{},z),vn={horizontal:{},vertical:void 0},$i=Nn.text,ki=[0,0];if($i){var eo=$i.toString(),Ha=24*Q.get("text-letter-spacing").evaluate(Nn,{},z),Ta=function(Vs){for(var Eu=0,wu=Vs;Eu<wu.length;Eu+=1)if(tu=wu[Eu].charCodeAt(0),Xi.Arabic(tu)||Xi["Arabic Supplement"](tu)||Xi["Arabic Extended-A"](tu)||Xi["Arabic Presentation Forms-A"](tu)||Xi["Arabic Presentation Forms-B"](tu))return!1;var tu;return!0}(eo)?Ha:0,Ro=Q.get("text-anchor").evaluate(Nn,{},z),No=Q.get("text-variable-anchor");if(!No){var vs=Q.get("text-radial-offset").evaluate(Nn,{},z);ki=vs?Vh(Ro,[24*vs,ic]):Q.get("text-offset").evaluate(Nn,{},z).map(function(Vs){return 24*Vs})}var oo=sr?"center":Q.get("text-justify").evaluate(Nn,{},z),Qs=Q.get("symbol-placement"),Lu=Qs==="point"?24*Q.get("text-max-width").evaluate(Nn,{},z):0,cl=function(){o.allowVerticalPlacement&&cc(eo)&&(vn.vertical=ta($i,u,c,C,pi,Lu,or,Ro,"left",Ta,ki,wa.vertical,!0,Qs,ua,Xr))};if(!sr&&No){for(var qu=oo==="auto"?No.map(function(Vs){return lr(Vs)}):[oo],Xl=!1,ac=0;ac<qu.length;ac++){var Zc=qu[ac];if(!vn.horizontal[Zc])if(Xl)vn.horizontal[Zc]=vn.horizontal[0];else{var xf=ta($i,u,c,C,pi,Lu,or,"center",Zc,Ta,ki,wa.horizontal,!1,Qs,ua,Xr);xf&&(vn.horizontal[Zc]=xf,Xl=xf.positionedLines.length===1)}}cl()}else{oo==="auto"&&(oo=lr(Ro));var vh=ta($i,u,c,C,pi,Lu,or,Ro,oo,Ta,ki,wa.horizontal,!1,Qs,ua,Xr);vh&&(vn.horizontal[oo]=vh),cl(),cc(eo)&&sr&&mr&&(vn.vertical=ta($i,u,c,C,pi,Lu,or,Ro,oo,Ta,ki,wa.vertical,!1,Qs,ua,Xr))}}var uf=void 0,fs=!1;if(Nn.icon&&Nn.icon.name){var Ic=y[Nn.icon.name];Ic&&(uf=function(Vs,Eu,wu){var tu=Zi(wu),mh=Eu[0]-Vs.displaySize[0]*tu.horizontalAlign,Bf=Eu[1]-Vs.displaySize[1]*tu.verticalAlign;return{image:Vs,top:Bf,bottom:Bf+Vs.displaySize[1],left:mh,right:mh+Vs.displaySize[0]}}(C[Nn.icon.name],Q.get("icon-offset").evaluate(Nn,{},z),Q.get("icon-anchor").evaluate(Nn,{},z)),fs=Ic.sdf,o.sdfIcons===void 0?o.sdfIcons=Ic.sdf:o.sdfIcons!==Ic.sdf&&Ye("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ic.pixelRatio!==o.pixelRatio||Q.get("icon-rotate").constantOr(1)!==0)&&(o.iconsNeedLinear=!0))}var bf=Rn(vn.horizontal)||vn.vertical;o.iconsInText=!!bf&&bf.iconsInText,(bf||uf)&&function(Vs,Eu,wu,tu,mh,Bf,Yl,Uc,$f,Hu,Ef){var gh=Bf.textMaxSize.evaluate(Eu,{});gh===void 0&&(gh=Yl);var ed,gl=Vs.layers[0].layout,Zs=gl.get("icon-offset").evaluate(Eu,{},Ef),Ep=Rn(wu.horizontal),lf=Yl/24,xc=Vs.tilePixelRatio*lf,rl=Vs.tilePixelRatio*gh/24,rh=Vs.tilePixelRatio*Uc,Jd=Vs.tilePixelRatio*gl.get("symbol-spacing"),Iv=gl.get("text-padding")*Vs.tilePixelRatio,pv=gl.get("icon-padding")*Vs.tilePixelRatio,Zd=gl.get("text-max-angle")/180*Math.PI,Kv=gl.get("text-rotation-alignment")==="map"&&gl.get("symbol-placement")!=="point",td=gl.get("icon-rotation-alignment")==="map"&&gl.get("symbol-placement")!=="point",rd=gl.get("symbol-placement"),dp=Jd/2,ef=gl.get("icon-text-fit");tu&&ef!=="none"&&(Vs.allowVerticalPlacement&&wu.vertical&&(ed=Bo(tu,wu.vertical,ef,gl.get("icon-text-fit-padding"),Zs,lf)),Ep&&(tu=Bo(tu,Ep,ef,gl.get("icon-text-fit-padding"),Zs,lf)));var Lc=function(Q0,Sp){Sp.x<0||Sp.x>=8192||Sp.y<0||Sp.y>=8192||function(Yo,Up,Cp,mp,_0,Nl,qv,id,Ud,Dv,Qv,Jv,Fv,J0,Bv,x0,b0,em,jp,E0,rp,e0,Nv,ad,w0){var tm,Od,jd,cf,Nf,tv=Yo.addToLineVertexArray(Up,Cp),rm=0,nm=0,S0=0,t0=0,gv=-1,C0=-1,xd={},im=cr(""),Ys=0,Hs=0;if(id._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Ys=(tm=id.layout.get("text-offset").evaluate(rp,{},ad).map(function(yv){return 24*yv}))[0],Hs=tm[1]):(Ys=24*id.layout.get("text-radial-offset").evaluate(rp,{},ad),Hs=ic),Yo.allowVerticalPlacement&&mp.vertical){var zv=id.layout.get("text-rotate").evaluate(rp,{},ad)+90;cf=new tl(Ud,Up,Dv,Qv,Jv,mp.vertical,Fv,J0,Bv,zv),qv&&(Nf=new tl(Ud,Up,Dv,Qv,Jv,qv,b0,em,Bv,zv))}if(_0){var A0=id.layout.get("icon-rotate").evaluate(rp,{}),T0=id.layout.get("icon-text-fit")!=="none",og=Wl(_0,A0,Nv,T0),am=qv?Wl(qv,A0,Nv,T0):void 0;jd=new tl(Ud,Up,Dv,Qv,Jv,_0,b0,em,!1,A0),rm=4*og.length;var om=Yo.iconSizeData,oc=null;om.kind==="source"?(oc=[128*id.layout.get("icon-size").evaluate(rp,{})])[0]>32640&&Ye(Yo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):om.kind==="composite"&&((oc=[128*e0.compositeIconSizes[0].evaluate(rp,{},ad),128*e0.compositeIconSizes[1].evaluate(rp,{},ad)])[0]>32640||oc[1]>32640)&&Ye(Yo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Yo.addSymbols(Yo.icon,og,oc,E0,jp,rp,!1,Up,tv.lineStartIndex,tv.lineLength,-1,ad),gv=Yo.icon.placedSymbolArray.length-1,am&&(nm=4*am.length,Yo.addSymbols(Yo.icon,am,oc,E0,jp,rp,wa.vertical,Up,tv.lineStartIndex,tv.lineLength,-1,ad),C0=Yo.icon.placedSymbolArray.length-1)}for(var sg in mp.horizontal){var M0=mp.horizontal[sg];if(!Od){im=cr(M0.text);var P0=id.layout.get("text-rotate").evaluate(rp,{},ad);Od=new tl(Ud,Up,Dv,Qv,Jv,M0,Fv,J0,Bv,P0)}var r0=M0.positionedLines.length===1;if(S0+=Wn(Yo,Up,M0,Nl,id,Bv,rp,x0,tv,mp.vertical?wa.horizontal:wa.horizontalOnly,r0?Object.keys(mp.horizontal):[sg],xd,gv,e0,ad),r0)break}mp.vertical&&(t0+=Wn(Yo,Up,mp.vertical,Nl,id,Bv,rp,x0,tv,wa.vertical,["vertical"],xd,C0,e0,ad));var ug=Od?Od.boxStartIndex:Yo.collisionBoxArray.length,sm=Od?Od.boxEndIndex:Yo.collisionBoxArray.length,O0=cf?cf.boxStartIndex:Yo.collisionBoxArray.length,um=cf?cf.boxEndIndex:Yo.collisionBoxArray.length,lg=jd?jd.boxStartIndex:Yo.collisionBoxArray.length,iy=jd?jd.boxEndIndex:Yo.collisionBoxArray.length,ay=Nf?Nf.boxStartIndex:Yo.collisionBoxArray.length,cg=Nf?Nf.boxEndIndex:Yo.collisionBoxArray.length,Id=-1,I0=function(yv,n0){return yv&&yv.circleDiameter?Math.max(yv.circleDiameter,n0):n0};Id=I0(Od,Id),Id=I0(cf,Id),Id=I0(jd,Id);var lm=(Id=I0(Nf,Id))>-1?1:0;lm&&(Id*=w0/24),Yo.glyphOffsetArray.length>=wr.MAX_GLYPHS&&Ye("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),rp.sortKey!==void 0&&Yo.addToSortKeyRanges(Yo.symbolInstances.length,rp.sortKey),Yo.symbolInstances.emplaceBack(Up.x,Up.y,xd.right>=0?xd.right:-1,xd.center>=0?xd.center:-1,xd.left>=0?xd.left:-1,xd.vertical||-1,gv,C0,im,ug,sm,O0,um,lg,iy,ay,cg,Dv,S0,t0,rm,nm,lm,0,Fv,Ys,Hs,Id)}(Vs,Sp,Q0,wu,tu,mh,ed,Vs.layers[0],Vs.collisionBoxArray,Eu.index,Eu.sourceLayerIndex,Vs.index,xc,Iv,Kv,$f,rh,pv,td,Zs,Eu,Bf,Hu,Ef,Yl)};if(rd==="line")for(var Ru=0,Rc=Vu(Eu.geometry,0,0,8192,8192);Ru<Rc.length;Ru+=1)for(var wp=Rc[Ru],zp=0,vp=Ol(wp,Jd,Zd,wu.vertical||Ep,tu,24,rl,Vs.overscaling,8192);zp<vp.length;zp+=1){var dv=vp[zp];Ep&&ro(Vs,Ep.text,dp,dv)||Lc(wp,dv)}else if(rd==="line-center")for(var Lv=0,Rv=Eu.geometry;Lv<Rv.length;Lv+=1){var tp=Rv[Lv];if(tp.length>1){var kv=pl(tp,Zd,wu.vertical||Ep,tu,24,rl);kv&&Lc(tp,kv)}}else if(Eu.type==="Polygon")for(var yd=0,ev=Kp(Eu.geometry,0);yd<ev.length;yd+=1){var vv=ev[yd],mv=Vo(vv,16);Lc(vv[0],new Hi(mv.x,mv.y,0))}else if(Eu.type==="LineString")for(var nd=0,Ih=Eu.geometry;nd<Ih.length;nd+=1){var Zp=Ih[nd];Lc(Zp,new Hi(Zp[0].x,Zp[0].y,0))}else if(Eu.type==="Point")for(var m0=0,q0=Eu.geometry;m0<q0.length;m0+=1)for(var g0=0,y0=q0[m0];g0<y0.length;g0+=1){var _d=y0[g0];Lc([_d],new Hi(_d.x,_d.y,0))}}(o,Nn,vn,uf,y,Ie,ua,Ir,ki,fs,z)},_n=0,kn=o.features;_n<kn.length;_n+=1)rn();R&&o.generateCollisionDebugBuffers()},m.perspective=function(o,u,c,y,C){var R,z=1/Math.tan(u/2);return o[0]=z/c,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=z,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,C!=null&&C!==1/0?(o[10]=(C+y)*(R=1/(y-C)),o[14]=2*C*y*R):(o[10]=-1,o[14]=-2*y),o},m.pick=function(o,u){for(var c={},y=0;y<u.length;y++){var C=u[y];C in o&&(c[C]=o[C])}return c},m.plugin=Tu,m.polygonIntersectsPolygon=ml,m.postMapLoadEvent=Qt,m.postTurnstileEvent=$r,m.potpack=Ji,m.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],m.register=Ca,m.registerForPluginStateChange=function(o){return o({pluginStatus:Fc,pluginURL:Sf}),jl.on("pluginStateChange",o),o},m.renderColorRamp=Kh,m.rotate=function(o,u,c){var y=u[0],C=u[1],R=u[2],z=u[3],Q=Math.sin(c),pe=Math.cos(c);return o[0]=y*pe+R*Q,o[1]=C*pe+z*Q,o[2]=y*-Q+R*pe,o[3]=C*-Q+z*pe,o},m.rotateX=function(o,u,c){var y=Math.sin(c),C=Math.cos(c),R=u[4],z=u[5],Q=u[6],pe=u[7],Ie=u[8],ze=u[9],qe=u[10],ut=u[11];return u!==o&&(o[0]=u[0],o[1]=u[1],o[2]=u[2],o[3]=u[3],o[12]=u[12],o[13]=u[13],o[14]=u[14],o[15]=u[15]),o[4]=R*C+Ie*y,o[5]=z*C+ze*y,o[6]=Q*C+qe*y,o[7]=pe*C+ut*y,o[8]=Ie*C-R*y,o[9]=ze*C-z*y,o[10]=qe*C-Q*y,o[11]=ut*C-pe*y,o},m.rotateZ=function(o,u,c){var y=Math.sin(c),C=Math.cos(c),R=u[0],z=u[1],Q=u[2],pe=u[3],Ie=u[4],ze=u[5],qe=u[6],ut=u[7];return u!==o&&(o[8]=u[8],o[9]=u[9],o[10]=u[10],o[11]=u[11],o[12]=u[12],o[13]=u[13],o[14]=u[14],o[15]=u[15]),o[0]=R*C+Ie*y,o[1]=z*C+ze*y,o[2]=Q*C+qe*y,o[3]=pe*C+ut*y,o[4]=Ie*C-R*y,o[5]=ze*C-z*y,o[6]=qe*C-Q*y,o[7]=ut*C-pe*y,o},m.scale=function(o,u,c){var y=c[0],C=c[1],R=c[2];return o[0]=u[0]*y,o[1]=u[1]*y,o[2]=u[2]*y,o[3]=u[3]*y,o[4]=u[4]*C,o[5]=u[5]*C,o[6]=u[6]*C,o[7]=u[7]*C,o[8]=u[8]*R,o[9]=u[9]*R,o[10]=u[10]*R,o[11]=u[11]*R,o[12]=u[12],o[13]=u[13],o[14]=u[14],o[15]=u[15],o},m.scale$1=function(o,u,c){return o[0]=u[0]*c,o[1]=u[1]*c,o[2]=u[2]*c,o[3]=u[3]*c,o},m.scale$2=function(o,u,c){return o[0]=u[0]*c,o[1]=u[1]*c,o[2]=u[2]*c,o},m.setCacheLimits=function(o,u){Br=o,bn=u},m.setRTLTextPlugin=function(o,u,c){if(c===void 0&&(c=!1),Fc==="deferred"||Fc==="loading"||Fc==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Sf=gi.resolveURL(o),Fc="deferred",fc=u,ap(),c||tc()},m.sphericalToCartesian=function(o){var u=o[0],c=o[1],y=o[2];return c+=90,c*=Math.PI/180,y*=Math.PI/180,{x:u*Math.cos(c)*Math.sin(y),y:u*Math.sin(c)*Math.sin(y),z:u*Math.cos(y)}},m.sqrLen=function(o){var u=o[0],c=o[1];return u*u+c*c},m.styleSpec=tt,m.sub=function(o,u,c){return o[0]=u[0]-c[0],o[1]=u[1]-c[1],o[2]=u[2]-c[2],o},m.symbolSize=Ps,m.transformMat3=function(o,u,c){var y=u[0],C=u[1],R=u[2];return o[0]=y*c[0]+C*c[3]+R*c[6],o[1]=y*c[1]+C*c[4]+R*c[7],o[2]=y*c[2]+C*c[5]+R*c[8],o},m.transformMat4=Fh,m.translate=function(o,u,c){var y,C,R,z,Q,pe,Ie,ze,qe,ut,wt,or,sr=c[0],mr=c[1],yr=c[2];return u===o?(o[12]=u[0]*sr+u[4]*mr+u[8]*yr+u[12],o[13]=u[1]*sr+u[5]*mr+u[9]*yr+u[13],o[14]=u[2]*sr+u[6]*mr+u[10]*yr+u[14],o[15]=u[3]*sr+u[7]*mr+u[11]*yr+u[15]):(C=u[1],R=u[2],z=u[3],Q=u[4],pe=u[5],Ie=u[6],ze=u[7],qe=u[8],ut=u[9],wt=u[10],or=u[11],o[0]=y=u[0],o[1]=C,o[2]=R,o[3]=z,o[4]=Q,o[5]=pe,o[6]=Ie,o[7]=ze,o[8]=qe,o[9]=ut,o[10]=wt,o[11]=or,o[12]=y*sr+Q*mr+qe*yr+u[12],o[13]=C*sr+pe*mr+ut*yr+u[13],o[14]=R*sr+Ie*mr+wt*yr+u[14],o[15]=z*sr+ze*mr+or*yr+u[15]),o},m.triggerPluginCompletionEvent=hc,m.uniqueId=Ke,m.validateCustomStyleLayer=function(o){var u=[],c=o.id;return c===void 0&&u.push({message:"layers."+c+': missing required property "id"'}),o.render===void 0&&u.push({message:"layers."+c+': missing required method "render"'}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&u.push({message:"layers."+c+': property "renderingMode" must be either "2d" or "3d"'}),u},m.validateLight=vf,m.validateStyle=xh,m.values=function(o){var u=[];for(var c in o)u.push(o[c]);return u},m.vectorTile=Gf,m.version="1.13.3",m.warnOnce=Ye,m.webpSupported=Dt,m.window=G,m.wrap=We}),k(["./shared"],function(m){"use strict";function ae(re){var he=typeof re;if(he==="number"||he==="boolean"||he==="string"||re==null)return JSON.stringify(re);if(Array.isArray(re)){for(var V="[",Et=0,Bt=re;Et<Bt.length;Et+=1)V+=ae(Bt[Et])+",";return V+"]"}for(var Le=Object.keys(re).sort(),St="{",tt=0;tt<Le.length;tt++)St+=JSON.stringify(Le[tt])+":"+ae(re[Le[tt]])+",";return St+"}"}function F(re){for(var he="",V=0,Et=m.refProperties;V<Et.length;V+=1)he+="/"+ae(re[Et[V]]);return he}var K=function(re){this.keyCache={},re&&this.replace(re)};K.prototype.replace=function(re){this._layerConfigs={},this._layers={},this.update(re,[])},K.prototype.update=function(re,he){for(var V=this,Et=0,Bt=re;Et<Bt.length;Et+=1){var Le=Bt[Et];this._layerConfigs[Le.id]=Le;var St=this._layers[Le.id]=m.createStyleLayer(Le);St._featureFilter=m.featureFilter(St.filter),this.keyCache[Le.id]&&delete this.keyCache[Le.id]}for(var tt=0,At=he;tt<At.length;tt+=1){var tr=At[tt];delete this.keyCache[tr],delete this._layerConfigs[tr],delete this._layers[tr]}this.familiesBySource={};for(var en=0,Kr=function(vi,It){for(var Yr={},Dr=0;Dr<vi.length;Dr++){var Jn=It&&It[vi[Dr].id]||F(vi[Dr]);It&&(It[vi[Dr].id]=Jn);var Kt=Yr[Jn];Kt||(Kt=Yr[Jn]=[]),Kt.push(vi[Dr])}var hr=[];for(var Fr in Yr)hr.push(Yr[Fr]);return hr}(m.values(this._layerConfigs),this.keyCache);en<Kr.length;en+=1){var Ft=Kr[en].map(function(vi){return V._layers[vi.id]}),rr=Ft[0];if(rr.visibility!=="none"){var ot=rr.source||"",Li=this.familiesBySource[ot];Li||(Li=this.familiesBySource[ot]={});var Hr=rr.sourceLayer||"_geojsonTileLayer",_i=Li[Hr];_i||(_i=Li[Hr]=[]),_i.push(Ft)}}};var W=function(re){var he={},V=[];for(var Et in re){var Bt=re[Et],Le=he[Et]={};for(var St in Bt){var tt=Bt[+St];if(tt&&tt.bitmap.width!==0&&tt.bitmap.height!==0){var At={x:0,y:0,w:tt.bitmap.width+2,h:tt.bitmap.height+2};V.push(At),Le[St]={rect:At,metrics:tt.metrics}}}}var tr=m.potpack(V),en=new m.AlphaImage({width:tr.w||1,height:tr.h||1});for(var Kr in re){var Ft=re[Kr];for(var rr in Ft){var ot=Ft[+rr];if(ot&&ot.bitmap.width!==0&&ot.bitmap.height!==0){var Li=he[Kr][rr].rect;m.AlphaImage.copy(ot.bitmap,en,{x:0,y:0},{x:Li.x+1,y:Li.y+1},ot.bitmap)}}}this.image=en,this.positions=he};m.register("GlyphAtlas",W);var Y=function(re){this.tileID=new m.OverscaledTileID(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),this.uid=re.uid,this.zoom=re.zoom,this.pixelRatio=re.pixelRatio,this.tileSize=re.tileSize,this.source=re.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=re.showCollisionBoxes,this.collectResourceTiming=!!re.collectResourceTiming,this.returnDependencies=!!re.returnDependencies,this.promoteId=re.promoteId};function G(re,he,V){for(var Et=new m.EvaluationParameters(he),Bt=0,Le=re;Bt<Le.length;Bt+=1)Le[Bt].recalculate(Et,V)}function $(re,he){var V=m.getArrayBuffer(re.request,function(Et,Bt,Le,St){Et?he(Et):Bt&&he(null,{vectorTile:new m.vectorTile.VectorTile(new m.pbf(Bt)),rawData:Bt,cacheControl:Le,expires:St})});return function(){V.cancel(),he()}}Y.prototype.parse=function(re,he,V,Et,Bt){var Le=this;this.status="parsing",this.data=re,this.collisionBoxArray=new m.CollisionBoxArray;var St=new m.DictionaryCoder(Object.keys(re.layers).sort()),tt=new m.FeatureIndex(this.tileID,this.promoteId);tt.bucketLayerIDs=[];var At,tr,en,Kr,Ft={},rr={featureIndex:tt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},ot=he.familiesBySource[this.source];for(var Li in ot){var Hr=re.layers[Li];if(Hr){Hr.version===1&&m.warnOnce('Vector tile source "'+this.source+'" layer "'+Li+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var _i=St.encode(Li),vi=[],It=0;It<Hr.length;It++){var Yr=Hr.feature(It),Dr=tt.getId(Yr,Li);vi.push({feature:Yr,id:Dr,index:It,sourceLayerIndex:_i})}for(var Jn=0,Kt=ot[Li];Jn<Kt.length;Jn+=1){var hr=Kt[Jn],Fr=hr[0];Fr.minzoom&&this.zoom<Math.floor(Fr.minzoom)||Fr.maxzoom&&this.zoom>=Fr.maxzoom||Fr.visibility!=="none"&&(G(hr,this.zoom,V),(Ft[Fr.id]=Fr.createBucket({index:tt.bucketLayerIDs.length,layers:hr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:_i,sourceID:this.source})).populate(vi,rr,this.tileID.canonical),tt.bucketLayerIDs.push(hr.map(function(Wi){return Wi.id})))}}}var qr=m.mapObject(rr.glyphDependencies,function(Wi){return Object.keys(Wi).map(Number)});Object.keys(qr).length?Et.send("getGlyphs",{uid:this.uid,stacks:qr},function(Wi,ct){At||(At=Wi,tr=ct,fa.call(Le))}):tr={};var An=Object.keys(rr.iconDependencies);An.length?Et.send("getImages",{icons:An,source:this.source,tileID:this.tileID,type:"icons"},function(Wi,ct){At||(At=Wi,en=ct,fa.call(Le))}):en={};var Ui=Object.keys(rr.patternDependencies);function fa(){if(At)return Bt(At);if(tr&&en&&Kr){var Wi=new W(tr),ct=new m.ImageAtlas(en,Kr);for(var qi in Ft){var Na=Ft[qi];Na instanceof m.SymbolBucket?(G(Na.layers,this.zoom,V),m.performSymbolLayout(Na,tr,Wi.positions,en,ct.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Na.hasPattern&&(Na instanceof m.LineBucket||Na instanceof m.FillBucket||Na instanceof m.FillExtrusionBucket)&&(G(Na.layers,this.zoom,V),Na.addFeatures(rr,this.tileID.canonical,ct.patternPositions))}this.status="done",Bt(null,{buckets:m.values(Ft).filter(function(To){return!To.isEmpty()}),featureIndex:tt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Wi.image,imageAtlas:ct,glyphMap:this.returnDependencies?tr:null,iconMap:this.returnDependencies?en:null,glyphPositions:this.returnDependencies?Wi.positions:null})}}Ui.length?Et.send("getImages",{icons:Ui,source:this.source,tileID:this.tileID,type:"patterns"},function(Wi,ct){At||(At=Wi,Kr=ct,fa.call(Le))}):Kr={},fa.call(this)};var xe=function(re,he,V,Et){this.actor=re,this.layerIndex=he,this.availableImages=V,this.loadVectorData=Et||$,this.loading={},this.loaded={}};xe.prototype.loadTile=function(re,he){var V=this,Et=re.uid;this.loading||(this.loading={});var Bt=!!(re&&re.request&&re.request.collectResourceTiming)&&new m.RequestPerformance(re.request),Le=this.loading[Et]=new Y(re);Le.abort=this.loadVectorData(re,function(St,tt){if(delete V.loading[Et],St||!tt)return Le.status="done",V.loaded[Et]=Le,he(St);var At=tt.rawData,tr={};tt.expires&&(tr.expires=tt.expires),tt.cacheControl&&(tr.cacheControl=tt.cacheControl);var en={};if(Bt){var Kr=Bt.finish();Kr&&(en.resourceTiming=JSON.parse(JSON.stringify(Kr)))}Le.vectorTile=tt.vectorTile,Le.parse(tt.vectorTile,V.layerIndex,V.availableImages,V.actor,function(Ft,rr){if(Ft||!rr)return he(Ft);he(null,m.extend({rawTileData:At.slice(0)},rr,tr,en))}),V.loaded=V.loaded||{},V.loaded[Et]=Le})},xe.prototype.reloadTile=function(re,he){var V=this,Et=this.loaded,Bt=re.uid,Le=this;if(Et&&Et[Bt]){var St=Et[Bt];St.showCollisionBoxes=re.showCollisionBoxes;var tt=function(At,tr){var en=St.reloadCallback;en&&(delete St.reloadCallback,St.parse(St.vectorTile,Le.layerIndex,V.availableImages,Le.actor,en)),he(At,tr)};St.status==="parsing"?St.reloadCallback=tt:St.status==="done"&&(St.vectorTile?St.parse(St.vectorTile,this.layerIndex,this.availableImages,this.actor,tt):tt())}},xe.prototype.abortTile=function(re,he){var V=this.loading,Et=re.uid;V&&V[Et]&&V[Et].abort&&(V[Et].abort(),delete V[Et]),he()},xe.prototype.removeTile=function(re,he){var V=this.loaded,Et=re.uid;V&&V[Et]&&delete V[Et],he()};var Fe=m.window.ImageBitmap,Ce=function(){this.loaded={}};function We(re,he){if(re.length!==0){me(re[0],he);for(var V=1;V<re.length;V++)me(re[V],!he)}}function me(re,he){for(var V=0,Et=0,Bt=0,Le=re.length,St=Le-1;Bt<Le;St=Bt++){var tt=(re[Bt][0]-re[St][0])*(re[St][1]+re[Bt][1]),At=V+tt;Et+=Math.abs(V)>=Math.abs(tt)?V-At+tt:tt-At+V,V=At}V+Et>=0!=!!he&&re.reverse()}Ce.prototype.loadTile=function(re,he){var V=re.uid,Et=re.encoding,Bt=re.rawImageData,Le=Fe&&Bt instanceof Fe?this.getImageData(Bt):Bt,St=new m.DEMData(V,Le,Et);this.loaded=this.loaded||{},this.loaded[V]=St,he(null,St)},Ce.prototype.getImageData=function(re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(re.width,re.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=re.width,this.offscreenCanvas.height=re.height,this.offscreenCanvasContext.drawImage(re,0,0,re.width,re.height);var he=this.offscreenCanvasContext.getImageData(-1,-1,re.width+2,re.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new m.RGBAImage({width:he.width,height:he.height},he.data)},Ce.prototype.removeTile=function(re){var he=this.loaded,V=re.uid;he&&he[V]&&delete he[V]};var Ge=m.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ke=function(re){this._feature=re,this.extent=m.EXTENT,this.type=re.type,this.properties=re.tags,"id"in re&&!isNaN(re.id)&&(this.id=parseInt(re.id,10))};Ke.prototype.loadGeometry=function(){if(this._feature.type===1){for(var re=[],he=0,V=this._feature.geometry;he<V.length;he+=1){var Et=V[he];re.push([new m.Point$1(Et[0],Et[1])])}return re}for(var Bt=[],Le=0,St=this._feature.geometry;Le<St.length;Le+=1){for(var tt=[],At=0,tr=St[Le];At<tr.length;At+=1){var en=tr[At];tt.push(new m.Point$1(en[0],en[1]))}Bt.push(tt)}return Bt},Ke.prototype.toGeoJSON=function(re,he,V){return Ge.call(this,re,he,V)};var pt=function(re){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=m.EXTENT,this.length=re.length,this._features=re};pt.prototype.feature=function(re){return new Ke(this._features[re])};var Xe=m.vectorTile.VectorTileFeature,gt=ie;function ie(re,he){this.options=he||{},this.features=re,this.length=re.length}function ft(re,he){this.id=typeof re.id=="number"?re.id:void 0,this.type=re.type,this.rawGeometry=re.type===1?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=he||4096}ie.prototype.feature=function(re){return new ft(this.features[re],this.options.extent)},ft.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var he=0;he<re.length;he++){for(var V=re[he],Et=[],Bt=0;Bt<V.length;Bt++)Et.push(new m.Point$1(V[Bt][0],V[Bt][1]));this.geometry.push(Et)}return this.geometry},ft.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,he=1/0,V=-1/0,Et=1/0,Bt=-1/0,Le=0;Le<re.length;Le++)for(var St=re[Le],tt=0;tt<St.length;tt++){var At=St[tt];he=Math.min(he,At.x),V=Math.max(V,At.x),Et=Math.min(Et,At.y),Bt=Math.max(Bt,At.y)}return[he,Et,V,Bt]},ft.prototype.toGeoJSON=Xe.prototype.toGeoJSON;var ve=Re,Ae=gt;function Re(re){var he=new m.pbf;return function(V,Et){for(var Bt in V.layers)Et.writeMessage(3,Ye,V.layers[Bt])}(re,he),he.finish()}function Ye(re,he){var V;he.writeVarintField(15,re.version||1),he.writeStringField(1,re.name||""),he.writeVarintField(5,re.extent||4096);var Et={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<re.length;V++)Et.feature=re.feature(V),he.writeMessage(2,at,Et);var Bt=Et.keys;for(V=0;V<Bt.length;V++)he.writeStringField(3,Bt[V]);var Le=Et.values;for(V=0;V<Le.length;V++)he.writeMessage(4,ue,Le[V])}function at(re,he){var V=re.feature;V.id!==void 0&&he.writeVarintField(1,V.id),he.writeMessage(2,ht,re),he.writeVarintField(3,V.type),he.writeMessage(4,oe,V)}function ht(re,he){var V=re.feature,Et=re.keys,Bt=re.values,Le=re.keycache,St=re.valuecache;for(var tt in V.properties){var At=Le[tt];At===void 0&&(Et.push(tt),Le[tt]=At=Et.length-1),he.writeVarint(At);var tr=V.properties[tt],en=typeof tr;en!=="string"&&en!=="boolean"&&en!=="number"&&(tr=JSON.stringify(tr));var Kr=en+":"+tr,Ft=St[Kr];Ft===void 0&&(Bt.push(tr),St[Kr]=Ft=Bt.length-1),he.writeVarint(Ft)}}function Se(re,he){return(he<<3)+(7&re)}function Qe(re){return re<<1^re>>31}function oe(re,he){for(var V=re.loadGeometry(),Et=re.type,Bt=0,Le=0,St=V.length,tt=0;tt<St;tt++){var At=V[tt],tr=1;Et===1&&(tr=At.length),he.writeVarint(Se(1,tr));for(var en=Et===3?At.length-1:At.length,Kr=0;Kr<en;Kr++){Kr===1&&Et!==1&&he.writeVarint(Se(2,en-1));var Ft=At[Kr].x-Bt,rr=At[Kr].y-Le;he.writeVarint(Qe(Ft)),he.writeVarint(Qe(rr)),Bt+=Ft,Le+=rr}Et===3&&he.writeVarint(Se(7,1))}}function ue(re,he){var V=typeof re;V==="string"?he.writeStringField(1,re):V==="boolean"?he.writeBooleanField(7,re):V==="number"&&(re%1!=0?he.writeDoubleField(3,re):re<0?he.writeSVarintField(6,re):he.writeVarintField(5,re))}function be(re,he,V,Et){vt(re,V,Et),vt(he,2*V,2*Et),vt(he,2*V+1,2*Et+1)}function vt(re,he,V){var Et=re[he];re[he]=re[V],re[V]=Et}function bt(re,he,V,Et){var Bt=re-V,Le=he-Et;return Bt*Bt+Le*Le}ve.fromVectorTileJs=Re,ve.fromGeojsonVt=function(re,he){he=he||{};var V={};for(var Et in re)V[Et]=new gt(re[Et].features,he),V[Et].name=Et,V[Et].version=he.version,V[Et].extent=he.extent;return Re({layers:V})},ve.GeoJSONWrapper=Ae;var Ht=function(re){return re[0]},Er=function(re){return re[1]},Vt=function(re,he,V,Et,Bt){he===void 0&&(he=Ht),V===void 0&&(V=Er),Et===void 0&&(Et=64),Bt===void 0&&(Bt=Float64Array),this.nodeSize=Et,this.points=re;for(var Le=re.length<65536?Uint16Array:Uint32Array,St=this.ids=new Le(re.length),tt=this.coords=new Bt(2*re.length),At=0;At<re.length;At++)St[At]=At,tt[2*At]=he(re[At]),tt[2*At+1]=V(re[At]);(function tr(en,Kr,Ft,rr,ot,Li){if(!(ot-rr<=Ft)){var Hr=rr+ot>>1;(function _i(vi,It,Yr,Dr,Jn,Kt){for(;Jn>Dr;){if(Jn-Dr>600){var hr=Jn-Dr+1,Fr=Yr-Dr+1,qr=Math.log(hr),An=.5*Math.exp(2*qr/3),Ui=.5*Math.sqrt(qr*An*(hr-An)/hr)*(Fr-hr/2<0?-1:1);_i(vi,It,Yr,Math.max(Dr,Math.floor(Yr-Fr*An/hr+Ui)),Math.min(Jn,Math.floor(Yr+(hr-Fr)*An/hr+Ui)),Kt)}var fa=It[2*Yr+Kt],Wi=Dr,ct=Jn;for(be(vi,It,Dr,Yr),It[2*Jn+Kt]>fa&&be(vi,It,Dr,Jn);Wi<ct;){for(be(vi,It,Wi,ct),Wi++,ct--;It[2*Wi+Kt]<fa;)Wi++;for(;It[2*ct+Kt]>fa;)ct--}It[2*Dr+Kt]===fa?be(vi,It,Dr,ct):be(vi,It,++ct,Jn),ct<=Yr&&(Dr=ct+1),Yr<=ct&&(Jn=ct-1)}})(en,Kr,Hr,rr,ot,Li%2),tr(en,Kr,Ft,rr,Hr-1,Li+1),tr(en,Kr,Ft,Hr+1,ot,Li+1)}})(St,tt,Et,0,St.length-1,0)};Vt.prototype.range=function(re,he,V,Et){return function(Bt,Le,St,tt,At,tr,en){for(var Kr,Ft,rr=[0,Bt.length-1,0],ot=[];rr.length;){var Li=rr.pop(),Hr=rr.pop(),_i=rr.pop();if(Hr-_i<=en)for(var vi=_i;vi<=Hr;vi++)Ft=Le[2*vi+1],(Kr=Le[2*vi])>=St&&Kr<=At&&Ft>=tt&&Ft<=tr&&ot.push(Bt[vi]);else{var It=Math.floor((_i+Hr)/2);Ft=Le[2*It+1],(Kr=Le[2*It])>=St&&Kr<=At&&Ft>=tt&&Ft<=tr&&ot.push(Bt[It]);var Yr=(Li+1)%2;(Li===0?St<=Kr:tt<=Ft)&&(rr.push(_i),rr.push(It-1),rr.push(Yr)),(Li===0?At>=Kr:tr>=Ft)&&(rr.push(It+1),rr.push(Hr),rr.push(Yr))}}return ot}(this.ids,this.coords,re,he,V,Et,this.nodeSize)},Vt.prototype.within=function(re,he,V){return function(Et,Bt,Le,St,tt,At){for(var tr=[0,Et.length-1,0],en=[],Kr=tt*tt;tr.length;){var Ft=tr.pop(),rr=tr.pop(),ot=tr.pop();if(rr-ot<=At)for(var Li=ot;Li<=rr;Li++)bt(Bt[2*Li],Bt[2*Li+1],Le,St)<=Kr&&en.push(Et[Li]);else{var Hr=Math.floor((ot+rr)/2),_i=Bt[2*Hr],vi=Bt[2*Hr+1];bt(_i,vi,Le,St)<=Kr&&en.push(Et[Hr]);var It=(Ft+1)%2;(Ft===0?Le-tt<=_i:St-tt<=vi)&&(tr.push(ot),tr.push(Hr-1),tr.push(It)),(Ft===0?Le+tt>=_i:St+tt>=vi)&&(tr.push(Hr+1),tr.push(rr),tr.push(It))}}return en}(this.ids,this.coords,re,he,V,this.nodeSize)};var on={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(re){return re}},hn=function(re){this.options=Ci(Object.create(on),re),this.trees=new Array(this.options.maxZoom+1)};function gi(re,he,V,Et,Bt){return{x:re,y:he,zoom:1/0,id:V,parentId:-1,numPoints:Et,properties:Bt}}function Hn(re,he){var V=re.geometry.coordinates,Et=V[1];return{x:Ze(V[0]),y:ci(Et),zoom:1/0,index:he,parentId:-1}}function Dt(re){return{type:"Feature",id:re.id,properties:Ea(re),geometry:{type:"Point",coordinates:[(Et=re.x,360*(Et-.5)),(he=re.y,V=(180-360*he)*Math.PI/180,360*Math.atan(Math.exp(V))/Math.PI-90)]}};var he,V,Et}function Ea(re){var he=re.numPoints,V=he>=1e4?Math.round(he/1e3)+"k":he>=1e3?Math.round(he/100)/10+"k":he;return Ci(Ci({},re.properties),{cluster:!0,cluster_id:re.id,point_count:he,point_count_abbreviated:V})}function Ze(re){return re/360+.5}function ci(re){var he=Math.sin(re*Math.PI/180),V=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return V<0?0:V>1?1:V}function Ci(re,he){for(var V in he)re[V]=he[V];return re}function Oi(re){return re.x}function ea(re){return re.y}function fn(re,he,V,Et,Bt,Le){var St=Bt-V,tt=Le-Et;if(St!==0||tt!==0){var At=((re-V)*St+(he-Et)*tt)/(St*St+tt*tt);At>1?(V=Bt,Et=Le):At>0&&(V+=St*At,Et+=tt*At)}return(St=re-V)*St+(tt=he-Et)*tt}function tn(re,he,V,Et){var Bt={id:re===void 0?null:re,type:he,geometry:V,tags:Et,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Le){var St=Le.geometry,tt=Le.type;if(tt==="Point"||tt==="MultiPoint"||tt==="LineString")da(Le,St);else if(tt==="Polygon"||tt==="MultiLineString")for(var At=0;At<St.length;At++)da(Le,St[At]);else if(tt==="MultiPolygon")for(At=0;At<St.length;At++)for(var tr=0;tr<St[At].length;tr++)da(Le,St[At][tr])}(Bt),Bt}function da(re,he){for(var V=0;V<he.length;V+=3)re.minX=Math.min(re.minX,he[V]),re.minY=Math.min(re.minY,he[V+1]),re.maxX=Math.max(re.maxX,he[V]),re.maxY=Math.max(re.maxY,he[V+1])}function Ii(re,he,V,Et){if(he.geometry){var Bt=he.geometry.coordinates,Le=he.geometry.type,St=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),tt=[],At=he.id;if(V.promoteId?At=he.properties[V.promoteId]:V.generateId&&(At=Et||0),Le==="Point")Ai(Bt,tt);else if(Le==="MultiPoint")for(var tr=0;tr<Bt.length;tr++)Ai(Bt[tr],tt);else if(Le==="LineString")Pr(Bt,tt,St,!1);else if(Le==="MultiLineString"){if(V.lineMetrics){for(tr=0;tr<Bt.length;tr++)Pr(Bt[tr],tt=[],St,!1),re.push(tn(At,"LineString",tt,he.properties));return}nt(Bt,tt,St,!1)}else if(Le==="Polygon")nt(Bt,tt,St,!0);else{if(Le!=="MultiPolygon"){if(Le==="GeometryCollection"){for(tr=0;tr<he.geometry.geometries.length;tr++)Ii(re,{id:At,geometry:he.geometry.geometries[tr],properties:he.properties},V,Et);return}throw new Error("Input data is not a valid GeoJSON object.")}for(tr=0;tr<Bt.length;tr++){var en=[];nt(Bt[tr],en,St,!0),tt.push(en)}}re.push(tn(At,Le,tt,he.properties))}}function Ai(re,he){he.push(it(re[0])),he.push(_t(re[1])),he.push(0)}function Pr(re,he,V,Et){for(var Bt,Le,St=0,tt=0;tt<re.length;tt++){var At=it(re[tt][0]),tr=_t(re[tt][1]);he.push(At),he.push(tr),he.push(0),tt>0&&(St+=Et?(Bt*tr-At*Le)/2:Math.sqrt(Math.pow(At-Bt,2)+Math.pow(tr-Le,2))),Bt=At,Le=tr}var en=he.length-3;he[2]=1,function Kr(Ft,rr,ot,Li){for(var Hr,_i=Li,vi=ot-rr>>1,It=ot-rr,Yr=Ft[rr],Dr=Ft[rr+1],Jn=Ft[ot],Kt=Ft[ot+1],hr=rr+3;hr<ot;hr+=3){var Fr=fn(Ft[hr],Ft[hr+1],Yr,Dr,Jn,Kt);if(Fr>_i)Hr=hr,_i=Fr;else if(Fr===_i){var qr=Math.abs(hr-vi);qr<It&&(Hr=hr,It=qr)}}_i>Li&&(Hr-rr>3&&Kr(Ft,rr,Hr,Li),Ft[Hr+2]=_i,ot-Hr>3&&Kr(Ft,Hr,ot,Li))}(he,0,en,V),he[en+2]=1,he.size=Math.abs(St),he.start=0,he.end=he.size}function nt(re,he,V,Et){for(var Bt=0;Bt<re.length;Bt++){var Le=[];Pr(re[Bt],Le,V,Et),he.push(Le)}}function it(re){return re/360+.5}function _t(re){var he=Math.sin(re*Math.PI/180),V=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return V<0?0:V>1?1:V}function we(re,he,V,Et,Bt,Le,St,tt){if(Et/=he,Le>=(V/=he)&&St<Et)return re;if(St<V||Le>=Et)return null;for(var At=[],tr=0;tr<re.length;tr++){var en=re[tr],Kr=en.geometry,Ft=en.type,rr=Bt===0?en.minX:en.minY,ot=Bt===0?en.maxX:en.maxY;if(rr>=V&&ot<Et)At.push(en);else if(!(ot<V||rr>=Et)){var Li=[];if(Ft==="Point"||Ft==="MultiPoint")er(Kr,Li,V,Et,Bt);else if(Ft==="LineString")$r(Kr,Li,V,Et,Bt,!1,tt.lineMetrics);else if(Ft==="MultiLineString")Qt(Kr,Li,V,Et,Bt,!1);else if(Ft==="Polygon")Qt(Kr,Li,V,Et,Bt,!0);else if(Ft==="MultiPolygon")for(var Hr=0;Hr<Kr.length;Hr++){var _i=[];Qt(Kr[Hr],_i,V,Et,Bt,!0),_i.length&&Li.push(_i)}if(Li.length){if(tt.lineMetrics&&Ft==="LineString"){for(Hr=0;Hr<Li.length;Hr++)At.push(tn(en.id,Ft,Li[Hr],en.tags));continue}Ft!=="LineString"&&Ft!=="MultiLineString"||(Li.length===1?(Ft="LineString",Li=Li[0]):Ft="MultiLineString"),Ft!=="Point"&&Ft!=="MultiPoint"||(Ft=Li.length===3?"Point":"MultiPoint"),At.push(tn(en.id,Ft,Li,en.tags))}}}return At.length?At:null}function er(re,he,V,Et,Bt){for(var Le=0;Le<re.length;Le+=3){var St=re[Le+Bt];St>=V&&St<=Et&&(he.push(re[Le]),he.push(re[Le+1]),he.push(re[Le+2]))}}function $r(re,he,V,Et,Bt,Le,St){for(var tt,At,tr=Fn(re),en=Bt===0?bn:gr,Kr=re.start,Ft=0;Ft<re.length-3;Ft+=3){var rr=re[Ft],ot=re[Ft+1],Li=re[Ft+2],Hr=re[Ft+3],_i=re[Ft+4],vi=Bt===0?rr:ot,It=Bt===0?Hr:_i,Yr=!1;St&&(tt=Math.sqrt(Math.pow(rr-Hr,2)+Math.pow(ot-_i,2))),vi<V?It>V&&(At=en(tr,rr,ot,Hr,_i,V),St&&(tr.start=Kr+tt*At)):vi>Et?It<Et&&(At=en(tr,rr,ot,Hr,_i,Et),St&&(tr.start=Kr+tt*At)):Br(tr,rr,ot,Li),It<V&&vi>=V&&(At=en(tr,rr,ot,Hr,_i,V),Yr=!0),It>Et&&vi<=Et&&(At=en(tr,rr,ot,Hr,_i,Et),Yr=!0),!Le&&Yr&&(St&&(tr.end=Kr+tt*At),he.push(tr),tr=Fn(re)),St&&(Kr+=tt)}var Dr=re.length-3;rr=re[Dr],ot=re[Dr+1],Li=re[Dr+2],(vi=Bt===0?rr:ot)>=V&&vi<=Et&&Br(tr,rr,ot,Li),Dr=tr.length-3,Le&&Dr>=3&&(tr[Dr]!==tr[0]||tr[Dr+1]!==tr[1])&&Br(tr,tr[0],tr[1],tr[2]),tr.length&&he.push(tr)}function Fn(re){var he=[];return he.size=re.size,he.start=re.start,he.end=re.end,he}function Qt(re,he,V,Et,Bt,Le){for(var St=0;St<re.length;St++)$r(re[St],he,V,Et,Bt,Le,!1)}function Br(re,he,V,Et){re.push(he),re.push(V),re.push(Et)}function bn(re,he,V,Et,Bt,Le){var St=(Le-he)/(Et-he);return re.push(Le),re.push(V+(Bt-V)*St),re.push(1),St}function gr(re,he,V,Et,Bt,Le){var St=(Le-V)/(Bt-V);return re.push(he+(Et-he)*St),re.push(Le),re.push(1),St}function pn(re,he){for(var V=[],Et=0;Et<re.length;Et++){var Bt,Le=re[Et],St=Le.type;if(St==="Point"||St==="MultiPoint"||St==="LineString")Bt=Sn(Le.geometry,he);else if(St==="MultiLineString"||St==="Polygon"){Bt=[];for(var tt=0;tt<Le.geometry.length;tt++)Bt.push(Sn(Le.geometry[tt],he))}else if(St==="MultiPolygon")for(Bt=[],tt=0;tt<Le.geometry.length;tt++){for(var At=[],tr=0;tr<Le.geometry[tt].length;tr++)At.push(Sn(Le.geometry[tt][tr],he));Bt.push(At)}V.push(tn(Le.id,St,Bt,Le.tags))}return V}function Sn(re,he){var V=[];V.size=re.size,re.start!==void 0&&(V.start=re.start,V.end=re.end);for(var Et=0;Et<re.length;Et+=3)V.push(re[Et]+he,re[Et+1],re[Et+2]);return V}function Dn(re,he){if(re.transformed)return re;var V,Et,Bt,Le=1<<re.z,St=re.x,tt=re.y;for(V=0;V<re.features.length;V++){var At=re.features[V],tr=At.geometry,en=At.type;if(At.geometry=[],en===1)for(Et=0;Et<tr.length;Et+=2)At.geometry.push(ui(tr[Et],tr[Et+1],he,Le,St,tt));else for(Et=0;Et<tr.length;Et++){var Kr=[];for(Bt=0;Bt<tr[Et].length;Bt+=2)Kr.push(ui(tr[Et][Bt],tr[Et][Bt+1],he,Le,St,tt));At.geometry.push(Kr)}}return re.transformed=!0,re}function ui(re,he,V,Et,Bt,Le){return[Math.round(V*(re*Et-Bt)),Math.round(V*(he*Et-Le))]}function di(re,he,V,Et,Bt){for(var Le=he===Bt.maxZoom?0:Bt.tolerance/((1<<he)*Bt.extent),St={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:Et,z:he,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},tt=0;tt<re.length;tt++){St.numFeatures++,ca(St,re[tt],Le,Bt);var At=re[tt].minX,tr=re[tt].minY,en=re[tt].maxX,Kr=re[tt].maxY;At<St.minX&&(St.minX=At),tr<St.minY&&(St.minY=tr),en>St.maxX&&(St.maxX=en),Kr>St.maxY&&(St.maxY=Kr)}return St}function ca(re,he,V,Et){var Bt=he.geometry,Le=he.type,St=[];if(Le==="Point"||Le==="MultiPoint")for(var tt=0;tt<Bt.length;tt+=3)St.push(Bt[tt]),St.push(Bt[tt+1]),re.numPoints++,re.numSimplified++;else if(Le==="LineString")Ni(St,Bt,re,V,!1,!1);else if(Le==="MultiLineString"||Le==="Polygon")for(tt=0;tt<Bt.length;tt++)Ni(St,Bt[tt],re,V,Le==="Polygon",tt===0);else if(Le==="MultiPolygon")for(var At=0;At<Bt.length;At++){var tr=Bt[At];for(tt=0;tt<tr.length;tt++)Ni(St,tr[tt],re,V,!0,tt===0)}if(St.length){var en=he.tags||null;if(Le==="LineString"&&Et.lineMetrics){for(var Kr in en={},he.tags)en[Kr]=he.tags[Kr];en.mapbox_clip_start=Bt.start/Bt.size,en.mapbox_clip_end=Bt.end/Bt.size}var Ft={geometry:St,type:Le==="Polygon"||Le==="MultiPolygon"?3:Le==="LineString"||Le==="MultiLineString"?2:1,tags:en};he.id!==null&&(Ft.id=he.id),re.features.push(Ft)}}function Ni(re,he,V,Et,Bt,Le){var St=Et*Et;if(Et>0&&he.size<(Bt?St:Et))V.numPoints+=he.length/3;else{for(var tt=[],At=0;At<he.length;At+=3)(Et===0||he[At+2]>St)&&(V.numSimplified++,tt.push(he[At]),tt.push(he[At+1])),V.numPoints++;Bt&&function(tr,en){for(var Kr=0,Ft=0,rr=tr.length,ot=rr-2;Ft<rr;ot=Ft,Ft+=2)Kr+=(tr[Ft]-tr[ot])*(tr[Ft+1]+tr[ot+1]);if(Kr>0===en)for(Ft=0,rr=tr.length;Ft<rr/2;Ft+=2){var Li=tr[Ft],Hr=tr[Ft+1];tr[Ft]=tr[rr-2-Ft],tr[Ft+1]=tr[rr-1-Ft],tr[rr-2-Ft]=Li,tr[rr-1-Ft]=Hr}}(tt,Le),re.push(tt)}}function Wa(re,he){var V=(he=this.options=function(Bt,Le){for(var St in Le)Bt[St]=Le[St];return Bt}(Object.create(this.options),he)).debug;if(V&&console.time("preprocess data"),he.maxZoom<0||he.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(he.promoteId&&he.generateId)throw new Error("promoteId and generateId cannot be used together.");var Et=function(Bt,Le){var St=[];if(Bt.type==="FeatureCollection")for(var tt=0;tt<Bt.features.length;tt++)Ii(St,Bt.features[tt],Le,tt);else Ii(St,Bt.type==="Feature"?Bt:{geometry:Bt},Le);return St}(re,he);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",he.indexMaxZoom,he.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Et=function(Bt,Le){var St=Le.buffer/Le.extent,tt=Bt,At=we(Bt,1,-1-St,St,0,-1,2,Le),tr=we(Bt,1,1-St,2+St,0,-1,2,Le);return(At||tr)&&(tt=we(Bt,1,-St,1+St,0,-1,2,Le)||[],At&&(tt=pn(At,1).concat(tt)),tr&&(tt=tt.concat(pn(tr,-1)))),tt}(Et,he)).length&&this.splitTile(Et,0,0,0),V&&(Et.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ba(re,he,V){return 32*((1<<re)*V+he)+re}function Ia(re,he){var V=re.tileID.canonical;if(!this._geoJSONIndex)return he(null,null);var Et=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!Et)return he(null,null);var Bt=new pt(Et.features),Le=ve(Bt);Le.byteOffset===0&&Le.byteLength===Le.buffer.byteLength||(Le=new Uint8Array(Le)),he(null,{vectorTile:Bt,rawData:Le.buffer})}hn.prototype.load=function(re){var he=this.options,V=he.log,Et=he.minZoom,Bt=he.maxZoom,Le=he.nodeSize;V&&console.time("total time");var St="prepare "+re.length+" points";V&&console.time(St),this.points=re;for(var tt=[],At=0;At<re.length;At++)re[At].geometry&&tt.push(Hn(re[At],At));this.trees[Bt+1]=new Vt(tt,Oi,ea,Le,Float32Array),V&&console.timeEnd(St);for(var tr=Bt;tr>=Et;tr--){var en=+Date.now();tt=this._cluster(tt,tr),this.trees[tr]=new Vt(tt,Oi,ea,Le,Float32Array),V&&console.log("z%d: %d clusters in %dms",tr,tt.length,+Date.now()-en)}return V&&console.timeEnd("total time"),this},hn.prototype.getClusters=function(re,he){var V=((re[0]+180)%360+360)%360-180,Et=Math.max(-90,Math.min(90,re[1])),Bt=re[2]===180?180:((re[2]+180)%360+360)%360-180,Le=Math.max(-90,Math.min(90,re[3]));if(re[2]-re[0]>=360)V=-180,Bt=180;else if(V>Bt){var St=this.getClusters([V,Et,180,Le],he),tt=this.getClusters([-180,Et,Bt,Le],he);return St.concat(tt)}for(var At=this.trees[this._limitZoom(he)],tr=[],en=0,Kr=At.range(Ze(V),ci(Le),Ze(Bt),ci(Et));en<Kr.length;en+=1){var Ft=At.points[Kr[en]];tr.push(Ft.numPoints?Dt(Ft):this.points[Ft.index])}return tr},hn.prototype.getChildren=function(re){var he=this._getOriginId(re),V=this._getOriginZoom(re),Et="No cluster with the specified id.",Bt=this.trees[V];if(!Bt)throw new Error(Et);var Le=Bt.points[he];if(!Le)throw new Error(Et);for(var St=this.options.radius/(this.options.extent*Math.pow(2,V-1)),tt=[],At=0,tr=Bt.within(Le.x,Le.y,St);At<tr.length;At+=1){var en=Bt.points[tr[At]];en.parentId===re&&tt.push(en.numPoints?Dt(en):this.points[en.index])}if(tt.length===0)throw new Error(Et);return tt},hn.prototype.getLeaves=function(re,he,V){var Et=[];return this._appendLeaves(Et,re,he=he||10,V=V||0,0),Et},hn.prototype.getTile=function(re,he,V){var Et=this.trees[this._limitZoom(re)],Bt=Math.pow(2,re),Le=this.options,St=Le.radius/Le.extent,tt=(V-St)/Bt,At=(V+1+St)/Bt,tr={features:[]};return this._addTileFeatures(Et.range((he-St)/Bt,tt,(he+1+St)/Bt,At),Et.points,he,V,Bt,tr),he===0&&this._addTileFeatures(Et.range(1-St/Bt,tt,1,At),Et.points,Bt,V,Bt,tr),he===Bt-1&&this._addTileFeatures(Et.range(0,tt,St/Bt,At),Et.points,-1,V,Bt,tr),tr.features.length?tr:null},hn.prototype.getClusterExpansionZoom=function(re){for(var he=this._getOriginZoom(re)-1;he<=this.options.maxZoom;){var V=this.getChildren(re);if(he++,V.length!==1)break;re=V[0].properties.cluster_id}return he},hn.prototype._appendLeaves=function(re,he,V,Et,Bt){for(var Le=0,St=this.getChildren(he);Le<St.length;Le+=1){var tt=St[Le],At=tt.properties;if(At&&At.cluster?Bt+At.point_count<=Et?Bt+=At.point_count:Bt=this._appendLeaves(re,At.cluster_id,V,Et,Bt):Bt<Et?Bt++:re.push(tt),re.length===V)break}return Bt},hn.prototype._addTileFeatures=function(re,he,V,Et,Bt,Le){for(var St=0,tt=re;St<tt.length;St+=1){var At=he[tt[St]],tr=At.numPoints,en={type:1,geometry:[[Math.round(this.options.extent*(At.x*Bt-V)),Math.round(this.options.extent*(At.y*Bt-Et))]],tags:tr?Ea(At):this.points[At.index].properties},Kr=void 0;tr?Kr=At.id:this.options.generateId?Kr=At.index:this.points[At.index].id&&(Kr=this.points[At.index].id),Kr!==void 0&&(en.id=Kr),Le.features.push(en)}},hn.prototype._limitZoom=function(re){return Math.max(this.options.minZoom,Math.min(+re,this.options.maxZoom+1))},hn.prototype._cluster=function(re,he){for(var V=[],Et=this.options,Bt=Et.reduce,Le=Et.minPoints,St=Et.radius/(Et.extent*Math.pow(2,he)),tt=0;tt<re.length;tt++){var At=re[tt];if(!(At.zoom<=he)){At.zoom=he;for(var tr=this.trees[he+1],en=tr.within(At.x,At.y,St),Kr=At.numPoints||1,Ft=Kr,rr=0,ot=en;rr<ot.length;rr+=1){var Li=tr.points[ot[rr]];Li.zoom>he&&(Ft+=Li.numPoints||1)}if(Ft>=Le){for(var Hr=At.x*Kr,_i=At.y*Kr,vi=Bt&&Kr>1?this._map(At,!0):null,It=(tt<<5)+(he+1)+this.points.length,Yr=0,Dr=en;Yr<Dr.length;Yr+=1){var Jn=tr.points[Dr[Yr]];if(!(Jn.zoom<=he)){Jn.zoom=he;var Kt=Jn.numPoints||1;Hr+=Jn.x*Kt,_i+=Jn.y*Kt,Jn.parentId=It,Bt&&(vi||(vi=this._map(At,!0)),Bt(vi,this._map(Jn)))}}At.parentId=It,V.push(gi(Hr/Ft,_i/Ft,It,Ft,vi))}else if(V.push(At),Ft>1)for(var hr=0,Fr=en;hr<Fr.length;hr+=1){var qr=tr.points[Fr[hr]];qr.zoom<=he||(qr.zoom=he,V.push(qr))}}}return V},hn.prototype._getOriginId=function(re){return re-this.points.length>>5},hn.prototype._getOriginZoom=function(re){return(re-this.points.length)%32},hn.prototype._map=function(re,he){if(re.numPoints)return he?Ci({},re.properties):re.properties;var V=this.points[re.index].properties,Et=this.options.map(V);return he&&Et===V?Ci({},Et):Et},Wa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Wa.prototype.splitTile=function(re,he,V,Et,Bt,Le,St){for(var tt=[re,he,V,Et],At=this.options,tr=At.debug;tt.length;){Et=tt.pop(),V=tt.pop(),he=tt.pop(),re=tt.pop();var en=1<<he,Kr=Ba(he,V,Et),Ft=this.tiles[Kr];if(!Ft&&(tr>1&&console.time("creation"),Ft=this.tiles[Kr]=di(re,he,V,Et,At),this.tileCoords.push({z:he,x:V,y:Et}),tr)){tr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",he,V,Et,Ft.numFeatures,Ft.numPoints,Ft.numSimplified),console.timeEnd("creation"));var rr="z"+he;this.stats[rr]=(this.stats[rr]||0)+1,this.total++}if(Ft.source=re,Bt){if(he===At.maxZoom||he===Bt)continue;var ot=1<<Bt-he;if(V!==Math.floor(Le/ot)||Et!==Math.floor(St/ot))continue}else if(he===At.indexMaxZoom||Ft.numPoints<=At.indexMaxPoints)continue;if(Ft.source=null,re.length!==0){tr>1&&console.time("clipping");var Li,Hr,_i,vi,It,Yr,Dr=.5*At.buffer/At.extent,Jn=.5-Dr,Kt=.5+Dr,hr=1+Dr;Li=Hr=_i=vi=null,It=we(re,en,V-Dr,V+Kt,0,Ft.minX,Ft.maxX,At),Yr=we(re,en,V+Jn,V+hr,0,Ft.minX,Ft.maxX,At),re=null,It&&(Li=we(It,en,Et-Dr,Et+Kt,1,Ft.minY,Ft.maxY,At),Hr=we(It,en,Et+Jn,Et+hr,1,Ft.minY,Ft.maxY,At),It=null),Yr&&(_i=we(Yr,en,Et-Dr,Et+Kt,1,Ft.minY,Ft.maxY,At),vi=we(Yr,en,Et+Jn,Et+hr,1,Ft.minY,Ft.maxY,At),Yr=null),tr>1&&console.timeEnd("clipping"),tt.push(Li||[],he+1,2*V,2*Et),tt.push(Hr||[],he+1,2*V,2*Et+1),tt.push(_i||[],he+1,2*V+1,2*Et),tt.push(vi||[],he+1,2*V+1,2*Et+1)}}},Wa.prototype.getTile=function(re,he,V){var Et=this.options,Bt=Et.extent,Le=Et.debug;if(re<0||re>24)return null;var St=1<<re,tt=Ba(re,he=(he%St+St)%St,V);if(this.tiles[tt])return Dn(this.tiles[tt],Bt);Le>1&&console.log("drilling down to z%d-%d-%d",re,he,V);for(var At,tr=re,en=he,Kr=V;!At&&tr>0;)tr--,en=Math.floor(en/2),Kr=Math.floor(Kr/2),At=this.tiles[Ba(tr,en,Kr)];return At&&At.source?(Le>1&&console.log("found parent tile z%d-%d-%d",tr,en,Kr),Le>1&&console.time("drilling down"),this.splitTile(At.source,tr,en,Kr,re,he,V),Le>1&&console.timeEnd("drilling down"),this.tiles[tt]?Dn(this.tiles[tt],Bt):null):null};var an=function(re){function he(V,Et,Bt,Le){re.call(this,V,Et,Bt,Ia),Le&&(this.loadGeoJSON=Le)}return re&&(he.__proto__=re),(he.prototype=Object.create(re&&re.prototype)).constructor=he,he.prototype.loadData=function(V,Et){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Et,this._pendingLoadDataParams=V,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},he.prototype._loadData=function(){var V=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Et=this._pendingCallback,Bt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Le=!!(Bt&&Bt.request&&Bt.request.collectResourceTiming)&&new m.RequestPerformance(Bt.request);this.loadGeoJSON(Bt,function(St,tt){if(St||!tt)return Et(St);if(typeof tt!="object")return Et(new Error("Input data given to '"+Bt.source+"' is not a valid GeoJSON object."));(function Ft(rr,ot){var Li,Hr=rr&&rr.type;if(Hr==="FeatureCollection")for(Li=0;Li<rr.features.length;Li++)Ft(rr.features[Li],ot);else if(Hr==="GeometryCollection")for(Li=0;Li<rr.geometries.length;Li++)Ft(rr.geometries[Li],ot);else if(Hr==="Feature")Ft(rr.geometry,ot);else if(Hr==="Polygon")We(rr.coordinates,ot);else if(Hr==="MultiPolygon")for(Li=0;Li<rr.coordinates.length;Li++)We(rr.coordinates[Li],ot);return rr})(tt,!0);try{if(Bt.filter){var At=m.createExpression(Bt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(At.result==="error")throw new Error(At.value.map(function(Ft){return Ft.key+": "+Ft.message}).join(", "));var tr=tt.features.filter(function(Ft){return At.value.evaluate({zoom:0},Ft)});tt={type:"FeatureCollection",features:tr}}V._geoJSONIndex=Bt.cluster?new hn(function(Ft){var rr=Ft.superclusterOptions,ot=Ft.clusterProperties;if(!ot||!rr)return rr;for(var Li={},Hr={},_i={accumulated:null,zoom:0},vi={properties:null},It=Object.keys(ot),Yr=0,Dr=It;Yr<Dr.length;Yr+=1){var Jn=Dr[Yr],Kt=ot[Jn],hr=Kt[0],Fr=m.createExpression(Kt[1]),qr=m.createExpression(typeof hr=="string"?[hr,["accumulated"],["get",Jn]]:hr);Li[Jn]=Fr.value,Hr[Jn]=qr.value}return rr.map=function(An){vi.properties=An;for(var Ui={},fa=0,Wi=It;fa<Wi.length;fa+=1){var ct=Wi[fa];Ui[ct]=Li[ct].evaluate(_i,vi)}return Ui},rr.reduce=function(An,Ui){vi.properties=Ui;for(var fa=0,Wi=It;fa<Wi.length;fa+=1){var ct=Wi[fa];_i.accumulated=An[ct],An[ct]=Hr[ct].evaluate(_i,vi)}},rr}(Bt)).load(tt.features):function(Ft,rr){return new Wa(Ft,rr)}(tt,Bt.geojsonVtOptions)}catch(Ft){return Et(Ft)}V.loaded={};var en={};if(Le){var Kr=Le.finish();Kr&&(en.resourceTiming={},en.resourceTiming[Bt.source]=JSON.parse(JSON.stringify(Kr)))}Et(null,en)})}},he.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},he.prototype.reloadTile=function(V,Et){var Bt=this.loaded;return Bt&&Bt[V.uid]?re.prototype.reloadTile.call(this,V,Et):this.loadTile(V,Et)},he.prototype.loadGeoJSON=function(V,Et){if(V.request)m.getJSON(V.request,Et);else{if(typeof V.data!="string")return Et(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."));try{return Et(null,JSON.parse(V.data))}catch(Bt){return Et(new Error("Input data given to '"+V.source+"' is not a valid GeoJSON object."))}}},he.prototype.removeSource=function(V,Et){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Et()},he.prototype.getClusterExpansionZoom=function(V,Et){try{Et(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch(Bt){Et(Bt)}},he.prototype.getClusterChildren=function(V,Et){try{Et(null,this._geoJSONIndex.getChildren(V.clusterId))}catch(Bt){Et(Bt)}},he.prototype.getClusterLeaves=function(V,Et){try{Et(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch(Bt){Et(Bt)}},he}(xe),Ln=function(re){var he=this;this.self=re,this.actor=new m.Actor(re,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:xe,geojson:an},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(V,Et){if(he.workerSourceTypes[V])throw new Error('Worker source with name "'+V+'" already registered.');he.workerSourceTypes[V]=Et},this.self.registerRTLTextPlugin=function(V){if(m.plugin.isParsed())throw new Error("RTL text plugin already registered.");m.plugin.applyArabicShaping=V.applyArabicShaping,m.plugin.processBidirectionalText=V.processBidirectionalText,m.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}};return Ln.prototype.setReferrer=function(re,he){this.referrer=he},Ln.prototype.setImages=function(re,he,V){for(var Et in this.availableImages[re]=he,this.workerSources[re]){var Bt=this.workerSources[re][Et];for(var Le in Bt)Bt[Le].availableImages=he}V()},Ln.prototype.setLayers=function(re,he,V){this.getLayerIndex(re).replace(he),V()},Ln.prototype.updateLayers=function(re,he,V){this.getLayerIndex(re).update(he.layers,he.removedIds),V()},Ln.prototype.loadTile=function(re,he,V){this.getWorkerSource(re,he.type,he.source).loadTile(he,V)},Ln.prototype.loadDEMTile=function(re,he,V){this.getDEMWorkerSource(re,he.source).loadTile(he,V)},Ln.prototype.reloadTile=function(re,he,V){this.getWorkerSource(re,he.type,he.source).reloadTile(he,V)},Ln.prototype.abortTile=function(re,he,V){this.getWorkerSource(re,he.type,he.source).abortTile(he,V)},Ln.prototype.removeTile=function(re,he,V){this.getWorkerSource(re,he.type,he.source).removeTile(he,V)},Ln.prototype.removeDEMTile=function(re,he){this.getDEMWorkerSource(re,he.source).removeTile(he)},Ln.prototype.removeSource=function(re,he,V){if(this.workerSources[re]&&this.workerSources[re][he.type]&&this.workerSources[re][he.type][he.source]){var Et=this.workerSources[re][he.type][he.source];delete this.workerSources[re][he.type][he.source],Et.removeSource!==void 0?Et.removeSource(he,V):V()}},Ln.prototype.loadWorkerSource=function(re,he,V){try{this.self.importScripts(he.url),V()}catch(Et){V(Et.toString())}},Ln.prototype.syncRTLPluginState=function(re,he,V){try{m.plugin.setState(he);var Et=m.plugin.getPluginURL();if(m.plugin.isLoaded()&&!m.plugin.isParsed()&&Et!=null){this.self.importScripts(Et);var Bt=m.plugin.isParsed();V(Bt?void 0:new Error("RTL Text Plugin failed to import scripts from "+Et),Bt)}}catch(Le){V(Le.toString())}},Ln.prototype.getAvailableImages=function(re){var he=this.availableImages[re];return he||(he=[]),he},Ln.prototype.getLayerIndex=function(re){var he=this.layerIndexes[re];return he||(he=this.layerIndexes[re]=new K),he},Ln.prototype.getWorkerSource=function(re,he,V){var Et=this;return this.workerSources[re]||(this.workerSources[re]={}),this.workerSources[re][he]||(this.workerSources[re][he]={}),this.workerSources[re][he][V]||(this.workerSources[re][he][V]=new this.workerSourceTypes[he]({send:function(Bt,Le,St){Et.actor.send(Bt,Le,St,re)}},this.getLayerIndex(re),this.getAvailableImages(re))),this.workerSources[re][he][V]},Ln.prototype.getDEMWorkerSource=function(re,he){return this.demWorkerSources[re]||(this.demWorkerSources[re]={}),this.demWorkerSources[re][he]||(this.demWorkerSources[re][he]=new Ce),this.demWorkerSources[re][he]},Ln.prototype.enforceCacheSizeLimit=function(re,he){m.enforceCacheSizeLimit(he)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Ln(self)),Ln}),k(["./shared"],function(m){"use strict";var ae=m.createCommonjsModule(function(h){function g(N){return!p(N)}function p(N){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var ee,ge,Ue=new Blob([""],{type:"text/javascript"}),st=URL.createObjectURL(Ue);try{ge=new Worker(st),ee=!0}catch(kt){ee=!1}return ge&&ge.terminate(),URL.revokeObjectURL(st),ee}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var ee=document.createElement("canvas");ee.width=ee.height=1;var ge=ee.getContext("2d");if(!ge)return!1;var Ue=ge.getImageData(0,0,1,1);return Ue&&Ue.width===ee.width}()?(b[q=N&&N.failIfMajorPerformanceCaveat]===void 0&&(b[q]=function(ee){var ge=function(st){var kt=document.createElement("canvas"),Lt=Object.create(g.webGLContextAttributes);return Lt.failIfMajorPerformanceCaveat=st,kt.probablySupportsContext?kt.probablySupportsContext("webgl",Lt)||kt.probablySupportsContext("experimental-webgl",Lt):kt.supportsContext?kt.supportsContext("webgl",Lt)||kt.supportsContext("experimental-webgl",Lt):kt.getContext("webgl",Lt)||kt.getContext("experimental-webgl",Lt)}(ee);if(!ge)return!1;var Ue=ge.createShader(ge.VERTEX_SHADER);return!(!Ue||ge.isContextLost())&&(ge.shaderSource(Ue,"void main() {}"),ge.compileShader(Ue),ge.getShaderParameter(Ue,ge.COMPILE_STATUS)===!0)}(q)),b[q]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var q}h.exports?h.exports=g:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=g,window.mapboxgl.notSupportedReason=p);var b={};g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),F={create:function(h,g,p){var b=m.window.document.createElement(h);return g!==void 0&&(b.className=g),p&&p.appendChild(b),b},createNS:function(h,g){return m.window.document.createElementNS(h,g)}},K=m.window.document&&m.window.document.documentElement.style;function W(h){if(!K)return h[0];for(var g=0;g<h.length;g++)if(h[g]in K)return h[g];return h[0]}var Y,G=W(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);F.disableDrag=function(){K&&G&&(Y=K[G],K[G]="none")},F.enableDrag=function(){K&&G&&(K[G]=Y)};var $=W(["transform","WebkitTransform"]);F.setTransform=function(h,g){h.style[$]=g};var xe=!1;try{var Fe=Object.defineProperty({},"passive",{get:function(){xe=!0}});m.window.addEventListener("test",Fe,Fe),m.window.removeEventListener("test",Fe,Fe)}catch(h){xe=!1}F.addEventListener=function(h,g,p,b){b===void 0&&(b={}),h.addEventListener(g,p,"passive"in b&&xe?b:b.capture)},F.removeEventListener=function(h,g,p,b){b===void 0&&(b={}),h.removeEventListener(g,p,"passive"in b&&xe?b:b.capture)};var Ce=function(h){h.preventDefault(),h.stopPropagation(),m.window.removeEventListener("click",Ce,!0)};function We(h){var g=h.userImage;return!!(g&&g.render&&g.render())&&(h.data.replace(new Uint8Array(g.data.buffer)),!0)}F.suppressClick=function(){m.window.addEventListener("click",Ce,!0),m.window.setTimeout(function(){m.window.removeEventListener("click",Ce,!0)},0)},F.mousePos=function(h,g){var p=h.getBoundingClientRect();return new m.Point(g.clientX-p.left-h.clientLeft,g.clientY-p.top-h.clientTop)},F.touchPos=function(h,g){for(var p=h.getBoundingClientRect(),b=[],N=0;N<g.length;N++)b.push(new m.Point(g[N].clientX-p.left-h.clientLeft,g[N].clientY-p.top-h.clientTop));return b},F.mouseButton=function(h){return m.window.InstallTrigger!==void 0&&h.button===2&&h.ctrlKey&&m.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button},F.remove=function(h){h.parentNode&&h.parentNode.removeChild(h)};var me=function(h){function g(){h.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new m.RGBAImage({width:1,height:1}),this.dirty=!0}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.isLoaded=function(){return this.loaded},g.prototype.setLoaded=function(p){if(this.loaded!==p&&(this.loaded=p,p)){for(var b=0,N=this.requestors;b<N.length;b+=1){var q=N[b];this._notify(q.ids,q.callback)}this.requestors=[]}},g.prototype.getImage=function(p){return this.images[p]},g.prototype.addImage=function(p,b){this._validate(p,b)&&(this.images[p]=b)},g.prototype._validate=function(p,b){var N=!0;return this._validateStretch(b.stretchX,b.data&&b.data.width)||(this.fire(new m.ErrorEvent(new Error('Image "'+p+'" has invalid "stretchX" value'))),N=!1),this._validateStretch(b.stretchY,b.data&&b.data.height)||(this.fire(new m.ErrorEvent(new Error('Image "'+p+'" has invalid "stretchY" value'))),N=!1),this._validateContent(b.content,b)||(this.fire(new m.ErrorEvent(new Error('Image "'+p+'" has invalid "content" value'))),N=!1),N},g.prototype._validateStretch=function(p,b){if(!p)return!0;for(var N=0,q=0,ee=p;q<ee.length;q+=1){var ge=ee[q];if(ge[0]<N||ge[1]<ge[0]||b<ge[1])return!1;N=ge[1]}return!0},g.prototype._validateContent=function(p,b){return!(p&&(p.length!==4||p[0]<0||b.data.width<p[0]||p[1]<0||b.data.height<p[1]||p[2]<0||b.data.width<p[2]||p[3]<0||b.data.height<p[3]||p[2]<p[0]||p[3]<p[1]))},g.prototype.updateImage=function(p,b){b.version=this.images[p].version+1,this.images[p]=b,this.updatedImages[p]=!0},g.prototype.removeImage=function(p){var b=this.images[p];delete this.images[p],delete this.patterns[p],b.userImage&&b.userImage.onRemove&&b.userImage.onRemove()},g.prototype.listImages=function(){return Object.keys(this.images)},g.prototype.getImages=function(p,b){var N=!0;if(!this.isLoaded())for(var q=0,ee=p;q<ee.length;q+=1)this.images[ee[q]]||(N=!1);this.isLoaded()||N?this._notify(p,b):this.requestors.push({ids:p,callback:b})},g.prototype._notify=function(p,b){for(var N={},q=0,ee=p;q<ee.length;q+=1){var ge=ee[q];this.images[ge]||this.fire(new m.Event("styleimagemissing",{id:ge}));var Ue=this.images[ge];Ue?N[ge]={data:Ue.data.clone(),pixelRatio:Ue.pixelRatio,sdf:Ue.sdf,version:Ue.version,stretchX:Ue.stretchX,stretchY:Ue.stretchY,content:Ue.content,hasRenderCallback:Boolean(Ue.userImage&&Ue.userImage.render)}:m.warnOnce('Image "'+ge+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}b(null,N)},g.prototype.getPixelSize=function(){var p=this.atlasImage;return{width:p.width,height:p.height}},g.prototype.getPattern=function(p){var b=this.patterns[p],N=this.getImage(p);if(!N)return null;if(b&&b.position.version===N.version)return b.position;if(b)b.position.version=N.version;else{var q={w:N.data.width+2,h:N.data.height+2,x:0,y:0},ee=new m.ImagePosition(q,N);this.patterns[p]={bin:q,position:ee}}return this._updatePatternAtlas(),this.patterns[p].position},g.prototype.bind=function(p){var b=p.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new m.Texture(p,this.atlasImage,b.RGBA),this.atlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE)},g.prototype._updatePatternAtlas=function(){var p=[];for(var b in this.patterns)p.push(this.patterns[b].bin);var N=m.potpack(p),q=N.w,ee=N.h,ge=this.atlasImage;for(var Ue in ge.resize({width:q||1,height:ee||1}),this.patterns){var st=this.patterns[Ue].bin,kt=st.x+1,Lt=st.y+1,Zt=this.images[Ue].data,vr=Zt.width,pr=Zt.height;m.RGBAImage.copy(Zt,ge,{x:0,y:0},{x:kt,y:Lt},{width:vr,height:pr}),m.RGBAImage.copy(Zt,ge,{x:0,y:pr-1},{x:kt,y:Lt-1},{width:vr,height:1}),m.RGBAImage.copy(Zt,ge,{x:0,y:0},{x:kt,y:Lt+pr},{width:vr,height:1}),m.RGBAImage.copy(Zt,ge,{x:vr-1,y:0},{x:kt-1,y:Lt},{width:1,height:pr}),m.RGBAImage.copy(Zt,ge,{x:0,y:0},{x:kt+vr,y:Lt},{width:1,height:pr})}this.dirty=!0},g.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},g.prototype.dispatchRenderCallbacks=function(p){for(var b=0,N=p;b<N.length;b+=1){var q=N[b];if(!this.callbackDispatchedThisFrame[q]){this.callbackDispatchedThisFrame[q]=!0;var ee=this.images[q];We(ee)&&this.updateImage(q,ee)}}},g}(m.Evented),Ge=Xe,Ke=Xe,pt=1e20;function Xe(h,g,p,b,N,q){this.fontSize=h||24,this.buffer=g===void 0?3:g,this.cutoff=b||.25,this.fontFamily=N||"sans-serif",this.fontWeight=q||"normal",this.radius=p||8;var ee=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=ee,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(ee*ee),this.gridInner=new Float64Array(ee*ee),this.f=new Float64Array(ee),this.d=new Float64Array(ee),this.z=new Float64Array(ee+1),this.v=new Int16Array(ee),this.middle=Math.round(ee/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function gt(h,g,p,b,N,q,ee){for(var ge=0;ge<g;ge++){for(var Ue=0;Ue<p;Ue++)b[Ue]=h[Ue*g+ge];for(ie(b,N,q,ee,p),Ue=0;Ue<p;Ue++)h[Ue*g+ge]=N[Ue]}for(Ue=0;Ue<p;Ue++){for(ge=0;ge<g;ge++)b[ge]=h[Ue*g+ge];for(ie(b,N,q,ee,g),ge=0;ge<g;ge++)h[Ue*g+ge]=Math.sqrt(N[ge])}}function ie(h,g,p,b,N){p[0]=0,b[0]=-pt,b[1]=+pt;for(var q=1,ee=0;q<N;q++){for(var ge=(h[q]+q*q-(h[p[ee]]+p[ee]*p[ee]))/(2*q-2*p[ee]);ge<=b[ee];)ee--,ge=(h[q]+q*q-(h[p[ee]]+p[ee]*p[ee]))/(2*q-2*p[ee]);p[++ee]=q,b[ee]=ge,b[ee+1]=+pt}for(q=0,ee=0;q<N;q++){for(;b[ee+1]<q;)ee++;g[q]=(q-p[ee])*(q-p[ee])+h[p[ee]]}}Xe.prototype.draw=function(h){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(h,this.buffer,this.middle);for(var g=this.ctx.getImageData(0,0,this.size,this.size),p=new Uint8ClampedArray(this.size*this.size),b=0;b<this.size*this.size;b++){var N=g.data[4*b+3]/255;this.gridOuter[b]=N===1?0:N===0?pt:Math.pow(Math.max(0,.5-N),2),this.gridInner[b]=N===1?pt:N===0?0:Math.pow(Math.max(0,N-.5),2)}for(gt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),gt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),b=0;b<this.size*this.size;b++)p[b]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[b]-this.gridInner[b])/this.radius+this.cutoff))));return p},Ge.default=Ke;var ft=function(h,g){this.requestManager=h,this.localIdeographFontFamily=g,this.entries={}};ft.prototype.setURL=function(h){this.url=h},ft.prototype.getGlyphs=function(h,g){var p=this,b=[];for(var N in h)for(var q=0,ee=h[N];q<ee.length;q+=1)b.push({stack:N,id:ee[q]});m.asyncAll(b,function(ge,Ue){var st=ge.stack,kt=ge.id,Lt=p.entries[st];Lt||(Lt=p.entries[st]={glyphs:{},requests:{},ranges:{}});var Zt=Lt.glyphs[kt];if(Zt===void 0){if(Zt=p._tinySDF(Lt,st,kt))return Lt.glyphs[kt]=Zt,void Ue(null,{stack:st,id:kt,glyph:Zt});var vr=Math.floor(kt/256);if(256*vr>65535)Ue(new Error("glyphs > 65535 not supported"));else if(Lt.ranges[vr])Ue(null,{stack:st,id:kt,glyph:Zt});else{var pr=Lt.requests[vr];pr||(pr=Lt.requests[vr]=[],ft.loadGlyphRange(st,vr,p.url,p.requestManager,function(Nr,cr){if(cr){for(var zr in cr)p._doesCharSupportLocalGlyph(+zr)||(Lt.glyphs[+zr]=cr[+zr]);Lt.ranges[vr]=!0}for(var Ur=0,Tn=pr;Ur<Tn.length;Ur+=1)(0,Tn[Ur])(Nr,cr);delete Lt.requests[vr]})),pr.push(function(Nr,cr){Nr?Ue(Nr):cr&&Ue(null,{stack:st,id:kt,glyph:cr[kt]||null})})}}else Ue(null,{stack:st,id:kt,glyph:Zt})},function(ge,Ue){if(ge)g(ge);else if(Ue){for(var st={},kt=0,Lt=Ue;kt<Lt.length;kt+=1){var Zt=Lt[kt],vr=Zt.stack,pr=Zt.id,Nr=Zt.glyph;(st[vr]||(st[vr]={}))[pr]=Nr&&{id:Nr.id,bitmap:Nr.bitmap.clone(),metrics:Nr.metrics}}g(null,st)}})},ft.prototype._doesCharSupportLocalGlyph=function(h){return!!this.localIdeographFontFamily&&(m.isChar["CJK Unified Ideographs"](h)||m.isChar["Hangul Syllables"](h)||m.isChar.Hiragana(h)||m.isChar.Katakana(h))},ft.prototype._tinySDF=function(h,g,p){var b=this.localIdeographFontFamily;if(b&&this._doesCharSupportLocalGlyph(p)){var N=h.tinySDF;if(!N){var q="400";/bold/i.test(g)?q="900":/medium/i.test(g)?q="500":/light/i.test(g)&&(q="200"),N=h.tinySDF=new ft.TinySDF(24,3,8,.25,b,q)}return{id:p,bitmap:new m.AlphaImage({width:30,height:30},N.draw(String.fromCharCode(p))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ft.loadGlyphRange=function(h,g,p,b,N){var q=256*g,ee=q+255,ge=b.transformRequest(b.normalizeGlyphsURL(p).replace("{fontstack}",h).replace("{range}",q+"-"+ee),m.ResourceType.Glyphs);m.getArrayBuffer(ge,function(Ue,st){if(Ue)N(Ue);else if(st){for(var kt={},Lt=0,Zt=m.parseGlyphPBF(st);Lt<Zt.length;Lt+=1){var vr=Zt[Lt];kt[vr.id]=vr}N(null,kt)}})},ft.TinySDF=Ge;var ve=function(){this.specification=m.styleSpec.light.position};ve.prototype.possiblyEvaluate=function(h,g){return m.sphericalToCartesian(h.expression.evaluate(g))},ve.prototype.interpolate=function(h,g,p){return{x:m.number(h.x,g.x,p),y:m.number(h.y,g.y,p),z:m.number(h.z,g.z,p)}};var Ae=new m.Properties({anchor:new m.DataConstantProperty(m.styleSpec.light.anchor),position:new ve,color:new m.DataConstantProperty(m.styleSpec.light.color),intensity:new m.DataConstantProperty(m.styleSpec.light.intensity)}),Re=function(h){function g(p){h.call(this),this._transitionable=new m.Transitionable(Ae),this.setLight(p),this._transitioning=this._transitionable.untransitioned()}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getLight=function(){return this._transitionable.serialize()},g.prototype.setLight=function(p,b){if(b===void 0&&(b={}),!this._validate(m.validateLight,p,b))for(var N in p){var q=p[N];m.endsWith(N,"-transition")?this._transitionable.setTransition(N.slice(0,-11),q):this._transitionable.setValue(N,q)}},g.prototype.updateTransitions=function(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)},g.prototype.hasTransition=function(){return this._transitioning.hasTransition()},g.prototype.recalculate=function(p){this.properties=this._transitioning.possiblyEvaluate(p)},g.prototype._validate=function(p,b,N){return(!N||N.validate!==!1)&&m.emitValidationErrors(this,p.call(m.validateStyle,m.extend({value:b,style:{glyphs:!0,sprite:!0},styleSpec:m.styleSpec})))},g}(m.Evented),Ye=function(h,g){this.width=h,this.height=g,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Ye.prototype.getDash=function(h,g){var p=h.join(",")+String(g);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(h,g)),this.dashEntry[p]},Ye.prototype.getDashRanges=function(h,g,p){var b=[],N=h.length%2==1?-h[h.length-1]*p:0,q=h[0]*p,ee=!0;b.push({left:N,right:q,isDash:ee,zeroLength:h[0]===0});for(var ge=h[0],Ue=1;Ue<h.length;Ue++){var st=h[Ue];b.push({left:N=ge*p,right:q=(ge+=st)*p,isDash:ee=!ee,zeroLength:st===0})}return b},Ye.prototype.addRoundDash=function(h,g,p){for(var b=g/2,N=-p;N<=p;N++)for(var q=this.width*(this.nextRow+p+N),ee=0,ge=h[ee],Ue=0;Ue<this.width;Ue++){Ue/ge.right>1&&(ge=h[++ee]);var st=Math.abs(Ue-ge.left),kt=Math.abs(Ue-ge.right),Lt=Math.min(st,kt),Zt=void 0,vr=N/p*(b+1);if(ge.isDash){var pr=b-Math.abs(vr);Zt=Math.sqrt(Lt*Lt+pr*pr)}else Zt=b-Math.sqrt(Lt*Lt+vr*vr);this.data[q+Ue]=Math.max(0,Math.min(255,Zt+128))}},Ye.prototype.addRegularDash=function(h){for(var g=h.length-1;g>=0;--g){var p=h[g],b=h[g+1];p.zeroLength?h.splice(g,1):b&&b.isDash===p.isDash&&(b.left=p.left,h.splice(g,1))}var N=h[0],q=h[h.length-1];N.isDash===q.isDash&&(N.left=q.left-this.width,q.right=N.right+this.width);for(var ee=this.width*this.nextRow,ge=0,Ue=h[ge],st=0;st<this.width;st++){st/Ue.right>1&&(Ue=h[++ge]);var kt=Math.abs(st-Ue.left),Lt=Math.abs(st-Ue.right),Zt=Math.min(kt,Lt);this.data[ee+st]=Math.max(0,Math.min(255,(Ue.isDash?Zt:-Zt)+128))}},Ye.prototype.addDash=function(h,g){var p=g?7:0,b=2*p+1;if(this.nextRow+b>this.height)return m.warnOnce("LineAtlas out of space"),null;for(var N=0,q=0;q<h.length;q++)N+=h[q];if(N!==0){var ee=this.width/N,ge=this.getDashRanges(h,this.width,ee);g?this.addRoundDash(ge,ee,p):this.addRegularDash(ge)}var Ue={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:N};return this.nextRow+=b,this.dirty=!0,Ue},Ye.prototype.bind=function(h){var g=h.gl;this.texture?(g.bindTexture(g.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,g.texSubImage2D(g.TEXTURE_2D,0,0,0,this.width,this.height,g.ALPHA,g.UNSIGNED_BYTE,this.data))):(this.texture=g.createTexture(),g.bindTexture(g.TEXTURE_2D,this.texture),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texImage2D(g.TEXTURE_2D,0,g.ALPHA,this.width,this.height,0,g.ALPHA,g.UNSIGNED_BYTE,this.data))};var at=function h(g,p){this.workerPool=g,this.actors=[],this.currentActor=0,this.id=m.uniqueId();for(var b=this.workerPool.acquire(this.id),N=0;N<b.length;N++){var q=new h.Actor(b[N],p,this.id);q.name="Worker "+N,this.actors.push(q)}};function ht(h,g,p){var b=function(N,q){if(N)return p(N);if(q){var ee=m.pick(m.extend(q,h),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);q.vector_layers&&(ee.vectorLayers=q.vector_layers,ee.vectorLayerIds=ee.vectorLayers.map(function(ge){return ge.id})),ee.tiles=g.canonicalizeTileset(ee,h.url),p(null,ee)}};return h.url?m.getJSON(g.transformRequest(g.normalizeSourceURL(h.url),m.ResourceType.Source),b):m.browser.frame(function(){return b(null,h)})}at.prototype.broadcast=function(h,g,p){m.asyncAll(this.actors,function(b,N){b.send(h,g,N)},p=p||function(){})},at.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},at.prototype.remove=function(){this.actors.forEach(function(h){h.remove()}),this.actors=[],this.workerPool.release(this.id)},at.Actor=m.Actor;var Se=function(h,g,p){this.bounds=m.LngLatBounds.convert(this.validateBounds(h)),this.minzoom=g||0,this.maxzoom=p||24};Se.prototype.validateBounds=function(h){return Array.isArray(h)&&h.length===4?[Math.max(-180,h[0]),Math.max(-90,h[1]),Math.min(180,h[2]),Math.min(90,h[3])]:[-180,-90,180,90]},Se.prototype.contains=function(h){var g=Math.pow(2,h.z),p=Math.floor(m.mercatorXfromLng(this.bounds.getWest())*g),b=Math.floor(m.mercatorYfromLat(this.bounds.getNorth())*g),N=Math.ceil(m.mercatorXfromLng(this.bounds.getEast())*g),q=Math.ceil(m.mercatorYfromLat(this.bounds.getSouth())*g);return h.x>=p&&h.x<N&&h.y>=b&&h.y<q};var Qe=function(h){function g(p,b,N,q){if(h.call(this),this.id=p,this.dispatcher=N,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,m.extend(this,m.pick(b,["url","scheme","tileSize","promoteId"])),this._options=m.extend({type:"vector"},b),this._collectResourceTiming=b.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(q)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.load=function(){var p=this;this._loaded=!1,this.fire(new m.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ht(this._options,this.map._requestManager,function(b,N){p._tileJSONRequest=null,p._loaded=!0,b?p.fire(new m.ErrorEvent(b)):N&&(m.extend(p,N),N.bounds&&(p.tileBounds=new Se(N.bounds,p.minzoom,p.maxzoom)),m.postTurnstileEvent(N.tiles,p.map._requestManager._customAccessToken),m.postMapLoadEvent(N.tiles,p.map._getMapId(),p.map._requestManager._skuToken,p.map._requestManager._customAccessToken),p.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})),p.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"})))})},g.prototype.loaded=function(){return this._loaded},g.prototype.hasTile=function(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)},g.prototype.onAdd=function(p){this.map=p,this.load()},g.prototype.setSourceProperty=function(p){this._tileJSONRequest&&this._tileJSONRequest.cancel(),p(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},g.prototype.setTiles=function(p){var b=this;return this.setSourceProperty(function(){b._options.tiles=p}),this},g.prototype.setUrl=function(p){var b=this;return this.setSourceProperty(function(){b.url=p,b._options.url=p}),this},g.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},g.prototype.serialize=function(){return m.extend({},this._options)},g.prototype.loadTile=function(p,b){var N=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),q={request:this.map._requestManager.transformRequest(N,m.ResourceType.Tile),uid:p.uid,tileID:p.tileID,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:m.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function ee(ge,Ue){return delete p.request,p.aborted?b(null):ge&&ge.status!==404?b(ge):(Ue&&Ue.resourceTiming&&(p.resourceTiming=Ue.resourceTiming),this.map._refreshExpiredTiles&&Ue&&p.setExpiryData(Ue),p.loadVectorData(Ue,this.map.painter),m.cacheEntryPossiblyAdded(this.dispatcher),b(null),void(p.reloadCallback&&(this.loadTile(p,p.reloadCallback),p.reloadCallback=null)))}q.request.collectResourceTiming=this._collectResourceTiming,p.actor&&p.state!=="expired"?p.state==="loading"?p.reloadCallback=b:p.request=p.actor.send("reloadTile",q,ee.bind(this)):(p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",q,ee.bind(this)))},g.prototype.abortTile=function(p){p.request&&(p.request.cancel(),delete p.request),p.actor&&p.actor.send("abortTile",{uid:p.uid,type:this.type,source:this.id},void 0)},g.prototype.unloadTile=function(p){p.unloadVectorData(),p.actor&&p.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id},void 0)},g.prototype.hasTransition=function(){return!1},g}(m.Evented),oe=function(h){function g(p,b,N,q){h.call(this),this.id=p,this.dispatcher=N,this.setEventedParent(q),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=m.extend({type:"raster"},b),m.extend(this,m.pick(b,["url","scheme","tileSize"]))}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.load=function(){var p=this;this._loaded=!1,this.fire(new m.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ht(this._options,this.map._requestManager,function(b,N){p._tileJSONRequest=null,p._loaded=!0,b?p.fire(new m.ErrorEvent(b)):N&&(m.extend(p,N),N.bounds&&(p.tileBounds=new Se(N.bounds,p.minzoom,p.maxzoom)),m.postTurnstileEvent(N.tiles),m.postMapLoadEvent(N.tiles,p.map._getMapId(),p.map._requestManager._skuToken),p.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})),p.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"})))})},g.prototype.loaded=function(){return this._loaded},g.prototype.onAdd=function(p){this.map=p,this.load()},g.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},g.prototype.serialize=function(){return m.extend({},this._options)},g.prototype.hasTile=function(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)},g.prototype.loadTile=function(p,b){var N=this,q=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);p.request=m.getImage(this.map._requestManager.transformRequest(q,m.ResourceType.Tile),function(ee,ge){if(delete p.request,p.aborted)p.state="unloaded",b(null);else if(ee)p.state="errored",b(ee);else if(ge){N.map._refreshExpiredTiles&&p.setExpiryData(ge),delete ge.cacheControl,delete ge.expires;var Ue=N.map.painter.context,st=Ue.gl;p.texture=N.map.painter.getTileTexture(ge.width),p.texture?p.texture.update(ge,{useMipmap:!0}):(p.texture=new m.Texture(Ue,ge,st.RGBA,{useMipmap:!0}),p.texture.bind(st.LINEAR,st.CLAMP_TO_EDGE,st.LINEAR_MIPMAP_NEAREST),Ue.extTextureFilterAnisotropic&&st.texParameterf(st.TEXTURE_2D,Ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ue.extTextureFilterAnisotropicMax)),p.state="loaded",m.cacheEntryPossiblyAdded(N.dispatcher),b(null)}})},g.prototype.abortTile=function(p,b){p.request&&(p.request.cancel(),delete p.request),b()},g.prototype.unloadTile=function(p,b){p.texture&&this.map.painter.saveTileTexture(p.texture),b()},g.prototype.hasTransition=function(){return!1},g}(m.Evented),ue=function(h){function g(p,b,N,q){h.call(this,p,b,N,q),this.type="raster-dem",this.maxzoom=22,this._options=m.extend({type:"raster-dem"},b),this.encoding=b.encoding||"mapbox"}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},g.prototype.loadTile=function(p,b){var N=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function q(ee,ge){ee&&(p.state="errored",b(ee)),ge&&(p.dem=ge,p.needsHillshadePrepare=!0,p.state="loaded",b(null))}p.request=m.getImage(this.map._requestManager.transformRequest(N,m.ResourceType.Tile),function(ee,ge){if(delete p.request,p.aborted)p.state="unloaded",b(null);else if(ee)p.state="errored",b(ee);else if(ge){this.map._refreshExpiredTiles&&p.setExpiryData(ge),delete ge.cacheControl,delete ge.expires;var Ue=m.window.ImageBitmap&&ge instanceof m.window.ImageBitmap&&m.offscreenCanvasSupported()?ge:m.browser.getImageData(ge,1),st={uid:p.uid,coord:p.tileID,source:this.id,rawImageData:Ue,encoding:this.encoding};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",st,q.bind(this)))}}.bind(this)),p.neighboringTiles=this._getNeighboringTiles(p.tileID)},g.prototype._getNeighboringTiles=function(p){var b=p.canonical,N=Math.pow(2,b.z),q=(b.x-1+N)%N,ee=b.x===0?p.wrap-1:p.wrap,ge=(b.x+1+N)%N,Ue=b.x+1===N?p.wrap+1:p.wrap,st={};return st[new m.OverscaledTileID(p.overscaledZ,ee,b.z,q,b.y).key]={backfilled:!1},st[new m.OverscaledTileID(p.overscaledZ,Ue,b.z,ge,b.y).key]={backfilled:!1},b.y>0&&(st[new m.OverscaledTileID(p.overscaledZ,ee,b.z,q,b.y-1).key]={backfilled:!1},st[new m.OverscaledTileID(p.overscaledZ,p.wrap,b.z,b.x,b.y-1).key]={backfilled:!1},st[new m.OverscaledTileID(p.overscaledZ,Ue,b.z,ge,b.y-1).key]={backfilled:!1}),b.y+1<N&&(st[new m.OverscaledTileID(p.overscaledZ,ee,b.z,q,b.y+1).key]={backfilled:!1},st[new m.OverscaledTileID(p.overscaledZ,p.wrap,b.z,b.x,b.y+1).key]={backfilled:!1},st[new m.OverscaledTileID(p.overscaledZ,Ue,b.z,ge,b.y+1).key]={backfilled:!1}),st},g.prototype.unloadTile=function(p){p.demTexture&&this.map.painter.saveTileTexture(p.demTexture),p.fbo&&(p.fbo.destroy(),delete p.fbo),p.dem&&delete p.dem,delete p.neighboringTiles,p.state="unloaded",p.actor&&p.actor.send("removeDEMTile",{uid:p.uid,source:this.id})},g}(oe),be=function(h){function g(p,b,N,q){h.call(this),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=N.getActor(),this.setEventedParent(q),this._data=b.data,this._options=m.extend({},b),this._collectResourceTiming=b.collectResourceTiming,this._resourceTiming=[],b.maxzoom!==void 0&&(this.maxzoom=b.maxzoom),b.type&&(this.type=b.type),b.attribution&&(this.attribution=b.attribution),this.promoteId=b.promoteId;var ee=m.EXTENT/this.tileSize;this.workerOptions=m.extend({source:this.id,cluster:b.cluster||!1,geojsonVtOptions:{buffer:(b.buffer!==void 0?b.buffer:128)*ee,tolerance:(b.tolerance!==void 0?b.tolerance:.375)*ee,extent:m.EXTENT,maxZoom:this.maxzoom,lineMetrics:b.lineMetrics||!1,generateId:b.generateId||!1},superclusterOptions:{maxZoom:b.clusterMaxZoom!==void 0?Math.min(b.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,b.clusterMinPoints||2),extent:m.EXTENT,radius:(b.clusterRadius||50)*ee,log:!1,generateId:b.generateId||!1},clusterProperties:b.clusterProperties,filter:b.filter},b.workerOptions)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.load=function(){var p=this;this.fire(new m.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(b){if(b)p.fire(new m.ErrorEvent(b));else{var N={dataType:"source",sourceDataType:"metadata"};p._collectResourceTiming&&p._resourceTiming&&p._resourceTiming.length>0&&(N.resourceTiming=p._resourceTiming,p._resourceTiming=[]),p.fire(new m.Event("data",N))}})},g.prototype.onAdd=function(p){this.map=p,this.load()},g.prototype.setData=function(p){var b=this;return this._data=p,this.fire(new m.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(N){if(N)b.fire(new m.ErrorEvent(N));else{var q={dataType:"source",sourceDataType:"content"};b._collectResourceTiming&&b._resourceTiming&&b._resourceTiming.length>0&&(q.resourceTiming=b._resourceTiming,b._resourceTiming=[]),b.fire(new m.Event("data",q))}}),this},g.prototype.getClusterExpansionZoom=function(p,b){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id},b),this},g.prototype.getClusterChildren=function(p,b){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id},b),this},g.prototype.getClusterLeaves=function(p,b,N,q){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:p,limit:b,offset:N},q),this},g.prototype._updateWorkerData=function(p){var b=this;this._loaded=!1;var N=m.extend({},this.workerOptions),q=this._data;typeof q=="string"?(N.request=this.map._requestManager.transformRequest(m.browser.resolveURL(q),m.ResourceType.Source),N.request.collectResourceTiming=this._collectResourceTiming):N.data=JSON.stringify(q),this.actor.send(this.type+".loadData",N,function(ee,ge){b._removed||ge&&ge.abandoned||(b._loaded=!0,ge&&ge.resourceTiming&&ge.resourceTiming[b.id]&&(b._resourceTiming=ge.resourceTiming[b.id].slice(0)),b.actor.send(b.type+".coalesce",{source:N.source},null),p(ee))})},g.prototype.loaded=function(){return this._loaded},g.prototype.loadTile=function(p,b){var N=this,q=p.actor?"reloadTile":"loadTile";p.actor=this.actor,p.request=this.actor.send(q,{type:this.type,uid:p.uid,tileID:p.tileID,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:m.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(ee,ge){return delete p.request,p.unloadVectorData(),p.aborted?b(null):ee?b(ee):(p.loadVectorData(ge,N.map.painter,q==="reloadTile"),b(null))})},g.prototype.abortTile=function(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0},g.prototype.unloadTile=function(p){p.unloadVectorData(),this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id})},g.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},g.prototype.serialize=function(){return m.extend({},this._options,{type:this.type,data:this._data})},g.prototype.hasTransition=function(){return!1},g}(m.Evented),vt=m.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),bt=function(h){function g(p,b,N,q){h.call(this),this.id=p,this.dispatcher=N,this.coordinates=b.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(q),this.options=b}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.load=function(p,b){var N=this;this._loaded=!1,this.fire(new m.Event("dataloading",{dataType:"source"})),this.url=this.options.url,m.getImage(this.map._requestManager.transformRequest(this.url,m.ResourceType.Image),function(q,ee){N._loaded=!0,q?N.fire(new m.ErrorEvent(q)):ee&&(N.image=ee,p&&(N.coordinates=p),b&&b(),N._finishLoading())})},g.prototype.loaded=function(){return this._loaded},g.prototype.updateImage=function(p){var b=this;return this.image&&p.url?(this.options.url=p.url,this.load(p.coordinates,function(){b.texture=null}),this):this},g.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"metadata"})))},g.prototype.onAdd=function(p){this.map=p,this.load()},g.prototype.setCoordinates=function(p){var b=this;this.coordinates=p;var N=p.map(m.MercatorCoordinate.fromLngLat);this.tileID=function(ee){for(var ge=1/0,Ue=1/0,st=-1/0,kt=-1/0,Lt=0,Zt=ee;Lt<Zt.length;Lt+=1){var vr=Zt[Lt];ge=Math.min(ge,vr.x),Ue=Math.min(Ue,vr.y),st=Math.max(st,vr.x),kt=Math.max(kt,vr.y)}var pr=Math.max(st-ge,kt-Ue),Nr=Math.max(0,Math.floor(-Math.log(pr)/Math.LN2)),cr=Math.pow(2,Nr);return new m.CanonicalTileID(Nr,Math.floor((ge+st)/2*cr),Math.floor((Ue+kt)/2*cr))}(N),this.minzoom=this.maxzoom=this.tileID.z;var q=N.map(function(ee){return b.tileID.getTilePoint(ee)._round()});return this._boundsArray=new m.StructArrayLayout4i8,this._boundsArray.emplaceBack(q[0].x,q[0].y,0,0),this._boundsArray.emplaceBack(q[1].x,q[1].y,m.EXTENT,0),this._boundsArray.emplaceBack(q[3].x,q[3].y,0,m.EXTENT),this._boundsArray.emplaceBack(q[2].x,q[2].y,m.EXTENT,m.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new m.Event("data",{dataType:"source",sourceDataType:"content"})),this},g.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var p=this.map.painter.context,b=p.gl;for(var N in this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,vt.members)),this.boundsSegments||(this.boundsSegments=m.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new m.Texture(p,this.image,b.RGBA),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE)),this.tiles){var q=this.tiles[N];q.state!=="loaded"&&(q.state="loaded",q.texture=this.texture)}}},g.prototype.loadTile=function(p,b){this.tileID&&this.tileID.equals(p.tileID.canonical)?(this.tiles[String(p.tileID.wrap)]=p,p.buckets={},b(null)):(p.state="errored",b(null))},g.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},g.prototype.hasTransition=function(){return!1},g}(m.Evented),Ht=function(h){function g(p,b,N,q){h.call(this,p,b,N,q),this.roundZoom=!0,this.type="video",this.options=b}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.load=function(){var p=this;this._loaded=!1;var b=this.options;this.urls=[];for(var N=0,q=b.urls;N<q.length;N+=1)this.urls.push(this.map._requestManager.transformRequest(q[N],m.ResourceType.Source).url);m.getVideo(this.urls,function(ee,ge){p._loaded=!0,ee?p.fire(new m.ErrorEvent(ee)):ge&&(p.video=ge,p.video.loop=!0,p.video.setAttribute("playsinline",""),p.video.addEventListener("playing",function(){p.map.triggerRepaint()}),p.map&&p.video.play(),p._finishLoading())})},g.prototype.pause=function(){this.video&&this.video.pause()},g.prototype.play=function(){this.video&&this.video.play()},g.prototype.seek=function(p){if(this.video){var b=this.video.seekable;p<b.start(0)||p>b.end(0)?this.fire(new m.ErrorEvent(new m.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+b.start(0)+" and "+b.end(0)+"-second mark."))):this.video.currentTime=p}},g.prototype.getVideo=function(){return this.video},g.prototype.onAdd=function(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},g.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var p=this.map.painter.context,b=p.gl;for(var N in this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,vt.members)),this.boundsSegments||(this.boundsSegments=m.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE),b.texSubImage2D(b.TEXTURE_2D,0,0,0,b.RGBA,b.UNSIGNED_BYTE,this.video)):(this.texture=new m.Texture(p,this.video,b.RGBA),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE)),this.tiles){var q=this.tiles[N];q.state!=="loaded"&&(q.state="loaded",q.texture=this.texture)}}},g.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},g.prototype.hasTransition=function(){return this.video&&!this.video.paused},g}(bt),Er=function(h){function g(p,b,N,q){h.call(this,p,b,N,q),b.coordinates?Array.isArray(b.coordinates)&&b.coordinates.length===4&&!b.coordinates.some(function(ee){return!Array.isArray(ee)||ee.length!==2||ee.some(function(ge){return typeof ge!="number"})})||this.fire(new m.ErrorEvent(new m.ValidationError("sources."+p,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new m.ErrorEvent(new m.ValidationError("sources."+p,null,'missing required property "coordinates"'))),b.animate&&typeof b.animate!="boolean"&&this.fire(new m.ErrorEvent(new m.ValidationError("sources."+p,null,'optional "animate" property must be a boolean value'))),b.canvas?typeof b.canvas=="string"||b.canvas instanceof m.window.HTMLCanvasElement||this.fire(new m.ErrorEvent(new m.ValidationError("sources."+p,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new m.ErrorEvent(new m.ValidationError("sources."+p,null,'missing required property "canvas"'))),this.options=b,this.animate=b.animate===void 0||b.animate}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof m.window.HTMLCanvasElement?this.options.canvas:m.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new m.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},g.prototype.getCanvas=function(){return this.canvas},g.prototype.onAdd=function(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()},g.prototype.onRemove=function(){this.pause()},g.prototype.prepare=function(){var p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var b=this.map.painter.context,N=b.gl;for(var q in this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,vt.members)),this.boundsSegments||(this.boundsSegments=m.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(p||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new m.Texture(b,this.canvas,N.RGBA,{premultiply:!0}),this.tiles){var ee=this.tiles[q];ee.state!=="loaded"&&(ee.state="loaded",ee.texture=this.texture)}}},g.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},g.prototype.hasTransition=function(){return this._playing},g.prototype._hasInvalidDimensions=function(){for(var p=0,b=[this.canvas.width,this.canvas.height];p<b.length;p+=1){var N=b[p];if(isNaN(N)||N<=0)return!0}return!1},g}(bt),Vt={vector:Qe,raster:oe,"raster-dem":ue,geojson:be,video:Ht,image:bt,canvas:Er};function on(h,g){var p=m.identity([]);return m.translate(p,p,[1,1,0]),m.scale(p,p,[.5*h.width,.5*h.height,1]),m.multiply(p,p,h.calculatePosMatrix(g.toUnwrapped()))}function hn(h,g,p,b,N,q){var ee=function(Nr,cr,zr){if(Nr)for(var Ur=0,Tn=Nr;Ur<Tn.length;Ur+=1){var ti=cr[Tn[Ur]];if(ti&&ti.source===zr&&ti.type==="fill-extrusion")return!0}else for(var Yn in cr){var ai=cr[Yn];if(ai.source===zr&&ai.type==="fill-extrusion")return!0}return!1}(N&&N.layers,g,h.id),ge=q.maxPitchScaleFactor(),Ue=h.tilesIn(b,ge,ee);Ue.sort(gi);for(var st=[],kt=0,Lt=Ue;kt<Lt.length;kt+=1){var Zt=Lt[kt];st.push({wrappedTileID:Zt.tileID.wrapped().key,queryResults:Zt.tile.queryRenderedFeatures(g,p,h._state,Zt.queryGeometry,Zt.cameraQueryGeometry,Zt.scale,N,q,ge,on(h.transform,Zt.tileID))})}var vr=function(Nr){for(var cr={},zr={},Ur=0,Tn=Nr;Ur<Tn.length;Ur+=1){var ti=Tn[Ur],Yn=ti.queryResults,ai=ti.wrappedTileID,Pi=zr[ai]=zr[ai]||{};for(var va in Yn)for(var na=Yn[va],Ua=Pi[va]=Pi[va]||{},co=cr[va]=cr[va]||[],Eo=0,ho=na;Eo<ho.length;Eo+=1){var qo=ho[Eo];Ua[qo.featureIndex]||(Ua[qo.featureIndex]=!0,co.push(qo))}}return cr}(st);for(var pr in vr)vr[pr].forEach(function(Nr){var cr=Nr.feature,zr=h.getFeatureState(cr.layer["source-layer"],cr.id);cr.source=cr.layer.source,cr.layer["source-layer"]&&(cr.sourceLayer=cr.layer["source-layer"]),cr.state=zr});return vr}function gi(h,g){var p=h.tileID,b=g.tileID;return p.overscaledZ-b.overscaledZ||p.canonical.y-b.canonical.y||p.wrap-b.wrap||p.canonical.x-b.canonical.x}var Hn=function(h,g){this.max=h,this.onRemove=g,this.reset()};Hn.prototype.reset=function(){for(var h in this.data)for(var g=0,p=this.data[h];g<p.length;g+=1){var b=p[g];b.timeout&&clearTimeout(b.timeout),this.onRemove(b.value)}return this.data={},this.order=[],this},Hn.prototype.add=function(h,g,p){var b=this,N=h.wrapped().key;this.data[N]===void 0&&(this.data[N]=[]);var q={value:g,timeout:void 0};if(p!==void 0&&(q.timeout=setTimeout(function(){b.remove(h,q)},p)),this.data[N].push(q),this.order.push(N),this.order.length>this.max){var ee=this._getAndRemoveByKey(this.order[0]);ee&&this.onRemove(ee)}return this},Hn.prototype.has=function(h){return h.wrapped().key in this.data},Hn.prototype.getAndRemove=function(h){return this.has(h)?this._getAndRemoveByKey(h.wrapped().key):null},Hn.prototype._getAndRemoveByKey=function(h){var g=this.data[h].shift();return g.timeout&&clearTimeout(g.timeout),this.data[h].length===0&&delete this.data[h],this.order.splice(this.order.indexOf(h),1),g.value},Hn.prototype.getByKey=function(h){var g=this.data[h];return g?g[0].value:null},Hn.prototype.get=function(h){return this.has(h)?this.data[h.wrapped().key][0].value:null},Hn.prototype.remove=function(h,g){if(!this.has(h))return this;var p=h.wrapped().key,b=g===void 0?0:this.data[p].indexOf(g),N=this.data[p][b];return this.data[p].splice(b,1),N.timeout&&clearTimeout(N.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(N.value),this.order.splice(this.order.indexOf(p),1),this},Hn.prototype.setMaxSize=function(h){for(this.max=h;this.order.length>this.max;){var g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this},Hn.prototype.filter=function(h){var g=[];for(var p in this.data)for(var b=0,N=this.data[p];b<N.length;b+=1){var q=N[b];h(q.value)||g.push(q)}for(var ee=0,ge=g;ee<ge.length;ee+=1){var Ue=ge[ee];this.remove(Ue.value.tileID,Ue)}};var Dt=function(h,g,p){this.context=h;var b=h.gl;this.buffer=b.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),h.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete g.arrayBuffer};Dt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Dt.prototype.updateData=function(h){var g=this.context.gl;this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,h.arrayBuffer)},Dt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Ea={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Ze=function(h,g,p,b){this.length=g.length,this.attributes=p,this.itemSize=g.bytesPerElement,this.dynamicDraw=b,this.context=h;var N=h.gl;this.buffer=N.createBuffer(),h.bindVertexBuffer.set(this.buffer),N.bufferData(N.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?N.DYNAMIC_DRAW:N.STATIC_DRAW),this.dynamicDraw||delete g.arrayBuffer};Ze.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Ze.prototype.updateData=function(h){var g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,h.arrayBuffer)},Ze.prototype.enableAttributes=function(h,g){for(var p=0;p<this.attributes.length;p++){var b=g.attributes[this.attributes[p].name];b!==void 0&&h.enableVertexAttribArray(b)}},Ze.prototype.setVertexAttribPointers=function(h,g,p){for(var b=0;b<this.attributes.length;b++){var N=this.attributes[b],q=g.attributes[N.name];q!==void 0&&h.vertexAttribPointer(q,N.components,h[Ea[N.type]],!1,this.itemSize,N.offset+this.itemSize*(p||0))}},Ze.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ci=function(h){this.gl=h.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ci.prototype.get=function(){return this.current},ci.prototype.set=function(h){},ci.prototype.getDefault=function(){return this.default},ci.prototype.setDefault=function(){this.set(this.default)};var Ci=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return m.Color.transparent},g.prototype.set=function(p){var b=this.current;(p.r!==b.r||p.g!==b.g||p.b!==b.b||p.a!==b.a||this.dirty)&&(this.gl.clearColor(p.r,p.g,p.b,p.a),this.current=p,this.dirty=!1)},g}(ci),Oi=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return 1},g.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.clearDepth(p),this.current=p,this.dirty=!1)},g}(ci),ea=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return 0},g.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.clearStencil(p),this.current=p,this.dirty=!1)},g}(ci),fn=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return[!0,!0,!0,!0]},g.prototype.set=function(p){var b=this.current;(p[0]!==b[0]||p[1]!==b[1]||p[2]!==b[2]||p[3]!==b[3]||this.dirty)&&(this.gl.colorMask(p[0],p[1],p[2],p[3]),this.current=p,this.dirty=!1)},g}(ci),tn=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return!0},g.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.depthMask(p),this.current=p,this.dirty=!1)},g}(ci),da=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return 255},g.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.stencilMask(p),this.current=p,this.dirty=!1)},g}(ci),Ii=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},g.prototype.set=function(p){var b=this.current;(p.func!==b.func||p.ref!==b.ref||p.mask!==b.mask||this.dirty)&&(this.gl.stencilFunc(p.func,p.ref,p.mask),this.current=p,this.dirty=!1)},g}(ci),Ai=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){var p=this.gl;return[p.KEEP,p.KEEP,p.KEEP]},g.prototype.set=function(p){var b=this.current;(p[0]!==b[0]||p[1]!==b[1]||p[2]!==b[2]||this.dirty)&&(this.gl.stencilOp(p[0],p[1],p[2]),this.current=p,this.dirty=!1)},g}(ci),Pr=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return!1},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;p?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST),this.current=p,this.dirty=!1}},g}(ci),nt=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return[0,1]},g.prototype.set=function(p){var b=this.current;(p[0]!==b[0]||p[1]!==b[1]||this.dirty)&&(this.gl.depthRange(p[0],p[1]),this.current=p,this.dirty=!1)},g}(ci),it=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return!1},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;p?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST),this.current=p,this.dirty=!1}},g}(ci),_t=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return this.gl.LESS},g.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.depthFunc(p),this.current=p,this.dirty=!1)},g}(ci),we=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return!1},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;p?b.enable(b.BLEND):b.disable(b.BLEND),this.current=p,this.dirty=!1}},g}(ci),er=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){var p=this.gl;return[p.ONE,p.ZERO]},g.prototype.set=function(p){var b=this.current;(p[0]!==b[0]||p[1]!==b[1]||this.dirty)&&(this.gl.blendFunc(p[0],p[1]),this.current=p,this.dirty=!1)},g}(ci),$r=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return m.Color.transparent},g.prototype.set=function(p){var b=this.current;(p.r!==b.r||p.g!==b.g||p.b!==b.b||p.a!==b.a||this.dirty)&&(this.gl.blendColor(p.r,p.g,p.b,p.a),this.current=p,this.dirty=!1)},g}(ci),Fn=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return this.gl.FUNC_ADD},g.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.blendEquation(p),this.current=p,this.dirty=!1)},g}(ci),Qt=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return!1},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;p?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE),this.current=p,this.dirty=!1}},g}(ci),Br=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return this.gl.BACK},g.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.cullFace(p),this.current=p,this.dirty=!1)},g}(ci),bn=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return this.gl.CCW},g.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.frontFace(p),this.current=p,this.dirty=!1)},g}(ci),gr=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return null},g.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)},g}(ci),pn=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return this.gl.TEXTURE0},g.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.activeTexture(p),this.current=p,this.dirty=!1)},g}(ci),Sn=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){var p=this.gl;return[0,0,p.drawingBufferWidth,p.drawingBufferHeight]},g.prototype.set=function(p){var b=this.current;(p[0]!==b[0]||p[1]!==b[1]||p[2]!==b[2]||p[3]!==b[3]||this.dirty)&&(this.gl.viewport(p[0],p[1],p[2],p[3]),this.current=p,this.dirty=!1)},g}(ci),Dn=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return null},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,p),this.current=p,this.dirty=!1}},g}(ci),ui=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return null},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;b.bindRenderbuffer(b.RENDERBUFFER,p),this.current=p,this.dirty=!1}},g}(ci),di=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return null},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;b.bindTexture(b.TEXTURE_2D,p),this.current=p,this.dirty=!1}},g}(ci),ca=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return null},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,p),this.current=p,this.dirty=!1}},g}(ci),Ni=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return null},g.prototype.set=function(p){var b=this.gl;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,p),this.current=p,this.dirty=!1},g}(ci),Wa=function(h){function g(p){h.call(this,p),this.vao=p.extVertexArrayObject}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return null},g.prototype.set=function(p){this.vao&&(p!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(p),this.current=p,this.dirty=!1)},g}(ci),Ba=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return 4},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_ALIGNMENT,p),this.current=p,this.dirty=!1}},g}(ci),Ia=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return!1},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),this.current=p,this.dirty=!1}},g}(ci),an=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return!1},g.prototype.set=function(p){if(p!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,p),this.current=p,this.dirty=!1}},g}(ci),Ln=function(h){function g(p,b){h.call(this,p),this.context=p,this.parent=b}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getDefault=function(){return null},g}(ci),re=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.setDirty=function(){this.dirty=!0},g.prototype.set=function(p){if(p!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var b=this.gl;b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,p,0),this.current=p,this.dirty=!1}},g}(Ln),he=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.set=function(p){if(p!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var b=this.gl;b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,p),this.current=p,this.dirty=!1}},g}(Ln),V=function(h,g,p,b){this.context=h,this.width=g,this.height=p;var N=this.framebuffer=h.gl.createFramebuffer();this.colorAttachment=new re(h,N),b&&(this.depthAttachment=new he(h,N))};V.prototype.destroy=function(){var h=this.context.gl,g=this.colorAttachment.get();if(g&&h.deleteTexture(g),this.depthAttachment){var p=this.depthAttachment.get();p&&h.deleteRenderbuffer(p)}h.deleteFramebuffer(this.framebuffer)};var Et=function(h,g,p){this.func=h,this.mask=g,this.range=p};Et.ReadOnly=!1,Et.ReadWrite=!0,Et.disabled=new Et(519,Et.ReadOnly,[0,1]);var Bt=function(h,g,p,b,N,q){this.test=h,this.ref=g,this.mask=p,this.fail=b,this.depthFail=N,this.pass=q};Bt.disabled=new Bt({func:519,mask:0},0,0,7680,7680,7680);var Le=function(h,g,p){this.blendFunction=h,this.blendColor=g,this.mask=p};Le.disabled=new Le(Le.Replace=[1,0],m.Color.transparent,[!1,!1,!1,!1]),Le.unblended=new Le(Le.Replace,m.Color.transparent,[!0,!0,!0,!0]),Le.alphaBlended=new Le([1,771],m.Color.transparent,[!0,!0,!0,!0]);var St=function(h,g,p){this.enable=h,this.mode=g,this.frontFace=p};St.disabled=new St(!1,1029,2305),St.backCCW=new St(!0,1029,2305);var tt=function(h){this.gl=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ci(this),this.clearDepth=new Oi(this),this.clearStencil=new ea(this),this.colorMask=new fn(this),this.depthMask=new tn(this),this.stencilMask=new da(this),this.stencilFunc=new Ii(this),this.stencilOp=new Ai(this),this.stencilTest=new Pr(this),this.depthRange=new nt(this),this.depthTest=new it(this),this.depthFunc=new _t(this),this.blend=new we(this),this.blendFunc=new er(this),this.blendColor=new $r(this),this.blendEquation=new Fn(this),this.cullFace=new Qt(this),this.cullFaceSide=new Br(this),this.frontFace=new bn(this),this.program=new gr(this),this.activeTexture=new pn(this),this.viewport=new Sn(this),this.bindFramebuffer=new Dn(this),this.bindRenderbuffer=new ui(this),this.bindTexture=new di(this),this.bindVertexBuffer=new ca(this),this.bindElementBuffer=new Ni(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Wa(this),this.pixelStoreUnpack=new Ba(this),this.pixelStoreUnpackPremultiplyAlpha=new Ia(this),this.pixelStoreUnpackFlipY=new an(this),this.extTextureFilterAnisotropic=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=h.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=h.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(h.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=h.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=h.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE)};tt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},tt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},tt.prototype.createIndexBuffer=function(h,g){return new Dt(this,h,g)},tt.prototype.createVertexBuffer=function(h,g,p){return new Ze(this,h,g,p)},tt.prototype.createRenderbuffer=function(h,g,p){var b=this.gl,N=b.createRenderbuffer();return this.bindRenderbuffer.set(N),b.renderbufferStorage(b.RENDERBUFFER,h,g,p),this.bindRenderbuffer.set(null),N},tt.prototype.createFramebuffer=function(h,g,p){return new V(this,h,g,p)},tt.prototype.clear=function(h){var g=h.color,p=h.depth,b=this.gl,N=0;g&&(N|=b.COLOR_BUFFER_BIT,this.clearColor.set(g),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(N|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),b.clear(N)},tt.prototype.setCullFace=function(h){h.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(h.mode),this.frontFace.set(h.frontFace))},tt.prototype.setDepthMode=function(h){h.func!==this.gl.ALWAYS||h.mask?(this.depthTest.set(!0),this.depthFunc.set(h.func),this.depthMask.set(h.mask),this.depthRange.set(h.range)):this.depthTest.set(!1)},tt.prototype.setStencilMode=function(h){h.test.func!==this.gl.ALWAYS||h.mask?(this.stencilTest.set(!0),this.stencilMask.set(h.mask),this.stencilOp.set([h.fail,h.depthFail,h.pass]),this.stencilFunc.set({func:h.test.func,ref:h.ref,mask:h.test.mask})):this.stencilTest.set(!1)},tt.prototype.setColorMode=function(h){m.deepEqual(h.blendFunction,Le.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(h.blendFunction),this.blendColor.set(h.blendColor)),this.colorMask.set(h.mask)},tt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var At=function(h){function g(p,b,N){var q=this;h.call(this),this.id=p,this.dispatcher=N,this.on("data",function(ee){ee.dataType==="source"&&ee.sourceDataType==="metadata"&&(q._sourceLoaded=!0),q._sourceLoaded&&!q._paused&&ee.dataType==="source"&&ee.sourceDataType==="content"&&(q.reload(),q.transform&&q.update(q.transform))}),this.on("error",function(){q._sourceErrored=!0}),this._source=function(ee,ge,Ue,st){var kt=new Vt[ge.type](ee,ge,Ue,st);if(kt.id!==ee)throw new Error("Expected Source id to be "+ee+" instead of "+kt.id);return m.bindAll(["load","abort","unload","serialize","prepare"],kt),kt}(p,b,N,this),this._tiles={},this._cache=new Hn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new m.SourceFeatureState}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.onAdd=function(p){this.map=p,this._maxTileCacheSize=p?p._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(p)},g.prototype.onRemove=function(p){this._source&&this._source.onRemove&&this._source.onRemove(p)},g.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var p in this._tiles){var b=this._tiles[p];if(b.state!=="loaded"&&b.state!=="errored")return!1}return!0},g.prototype.getSource=function(){return this._source},g.prototype.pause=function(){this._paused=!0},g.prototype.resume=function(){if(this._paused){var p=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,p&&this.reload(),this.transform&&this.update(this.transform)}},g.prototype._loadTile=function(p,b){return this._source.loadTile(p,b)},g.prototype._unloadTile=function(p){if(this._source.unloadTile)return this._source.unloadTile(p,function(){})},g.prototype._abortTile=function(p){if(this._source.abortTile)return this._source.abortTile(p,function(){})},g.prototype.serialize=function(){return this._source.serialize()},g.prototype.prepare=function(p){for(var b in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var N=this._tiles[b];N.upload(p),N.prepare(this.map.style.imageManager)}},g.prototype.getIds=function(){return m.values(this._tiles).map(function(p){return p.tileID}).sort(tr).map(function(p){return p.key})},g.prototype.getRenderableIds=function(p){var b=this,N=[];for(var q in this._tiles)this._isIdRenderable(q,p)&&N.push(this._tiles[q]);return p?N.sort(function(ee,ge){var Ue=ee.tileID,st=ge.tileID,kt=new m.Point(Ue.canonical.x,Ue.canonical.y)._rotate(b.transform.angle),Lt=new m.Point(st.canonical.x,st.canonical.y)._rotate(b.transform.angle);return Ue.overscaledZ-st.overscaledZ||Lt.y-kt.y||Lt.x-kt.x}).map(function(ee){return ee.tileID.key}):N.map(function(ee){return ee.tileID}).sort(tr).map(function(ee){return ee.key})},g.prototype.hasRenderableParent=function(p){var b=this.findLoadedParent(p,0);return!!b&&this._isIdRenderable(b.tileID.key)},g.prototype._isIdRenderable=function(p,b){return this._tiles[p]&&this._tiles[p].hasData()&&!this._coveredTiles[p]&&(b||!this._tiles[p].holdingForFade())},g.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var p in this._cache.reset(),this._tiles)this._tiles[p].state!=="errored"&&this._reloadTile(p,"reloading")},g.prototype._reloadTile=function(p,b){var N=this._tiles[p];N&&(N.state!=="loading"&&(N.state=b),this._loadTile(N,this._tileLoaded.bind(this,N,p,b)))},g.prototype._tileLoaded=function(p,b,N,q){if(q)return p.state="errored",void(q.status!==404?this._source.fire(new m.ErrorEvent(q,{tile:p})):this.update(this.transform));p.timeAdded=m.browser.now(),N==="expired"&&(p.refreshedUponExpiration=!0),this._setTileReloadTimer(b,p),this.getSource().type==="raster-dem"&&p.dem&&this._backfillDEM(p),this._state.initializeTileState(p,this.map?this.map.painter:null),this._source.fire(new m.Event("data",{dataType:"source",tile:p,coord:p.tileID}))},g.prototype._backfillDEM=function(p){for(var b=this.getRenderableIds(),N=0;N<b.length;N++){var q=b[N];if(p.neighboringTiles&&p.neighboringTiles[q]){var ee=this.getTileByID(q);ge(p,ee),ge(ee,p)}}function ge(Ue,st){Ue.needsHillshadePrepare=!0;var kt=st.tileID.canonical.x-Ue.tileID.canonical.x,Lt=st.tileID.canonical.y-Ue.tileID.canonical.y,Zt=Math.pow(2,Ue.tileID.canonical.z),vr=st.tileID.key;kt===0&&Lt===0||Math.abs(Lt)>1||(Math.abs(kt)>1&&(Math.abs(kt+Zt)===1?kt+=Zt:Math.abs(kt-Zt)===1&&(kt-=Zt)),st.dem&&Ue.dem&&(Ue.dem.backfillBorder(st.dem,kt,Lt),Ue.neighboringTiles&&Ue.neighboringTiles[vr]&&(Ue.neighboringTiles[vr].backfilled=!0)))}},g.prototype.getTile=function(p){return this.getTileByID(p.key)},g.prototype.getTileByID=function(p){return this._tiles[p]},g.prototype._retainLoadedChildren=function(p,b,N,q){for(var ee in this._tiles){var ge=this._tiles[ee];if(!(q[ee]||!ge.hasData()||ge.tileID.overscaledZ<=b||ge.tileID.overscaledZ>N)){for(var Ue=ge.tileID;ge&&ge.tileID.overscaledZ>b+1;){var st=ge.tileID.scaledTo(ge.tileID.overscaledZ-1);(ge=this._tiles[st.key])&&ge.hasData()&&(Ue=st)}for(var kt=Ue;kt.overscaledZ>b;)if(p[(kt=kt.scaledTo(kt.overscaledZ-1)).key]){q[Ue.key]=Ue;break}}}},g.prototype.findLoadedParent=function(p,b){if(p.key in this._loadedParentTiles){var N=this._loadedParentTiles[p.key];return N&&N.tileID.overscaledZ>=b?N:null}for(var q=p.overscaledZ-1;q>=b;q--){var ee=p.scaledTo(q),ge=this._getLoadedTile(ee);if(ge)return ge}},g.prototype._getLoadedTile=function(p){var b=this._tiles[p.key];return b&&b.hasData()?b:this._cache.getByKey(p.wrapped().key)},g.prototype.updateCacheSize=function(p){var b=Math.ceil(p.width/this._source.tileSize)+1,N=Math.ceil(p.height/this._source.tileSize)+1,q=Math.floor(b*N*5),ee=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,q):q;this._cache.setMaxSize(ee)},g.prototype.handleWrapJump=function(p){var b=Math.round((p-(this._prevLng===void 0?p:this._prevLng))/360);if(this._prevLng=p,b){var N={};for(var q in this._tiles){var ee=this._tiles[q];ee.tileID=ee.tileID.unwrapTo(ee.tileID.wrap+b),N[ee.tileID.key]=ee}for(var ge in this._tiles=N,this._timers)clearTimeout(this._timers[ge]),delete this._timers[ge];for(var Ue in this._tiles)this._setTileReloadTimer(Ue,this._tiles[Ue])}},g.prototype.update=function(p){var b=this;if(this.transform=p,this._sourceLoaded&&!this._paused){var N;this.updateCacheSize(p),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?N=p.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Pi){return new m.OverscaledTileID(Pi.canonical.z,Pi.wrap,Pi.canonical.z,Pi.canonical.x,Pi.canonical.y)}):(N=p.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(N=N.filter(function(Pi){return b._source.hasTile(Pi)}))):N=[];var q=p.coveringZoomLevel(this._source),ee=Math.max(q-g.maxOverzooming,this._source.minzoom),ge=Math.max(q+g.maxUnderzooming,this._source.minzoom),Ue=this._updateRetainedTiles(N,q);if(en(this._source.type)){for(var st={},kt={},Lt=0,Zt=Object.keys(Ue);Lt<Zt.length;Lt+=1){var vr=Zt[Lt],pr=Ue[vr],Nr=this._tiles[vr];if(Nr&&!(Nr.fadeEndTime&&Nr.fadeEndTime<=m.browser.now())){var cr=this.findLoadedParent(pr,ee);cr&&(this._addTile(cr.tileID),st[cr.tileID.key]=cr.tileID),kt[vr]=pr}}for(var zr in this._retainLoadedChildren(kt,q,ge,Ue),st)Ue[zr]||(this._coveredTiles[zr]=!0,Ue[zr]=st[zr])}for(var Ur in Ue)this._tiles[Ur].clearFadeHold();for(var Tn=0,ti=m.keysDifference(this._tiles,Ue);Tn<ti.length;Tn+=1){var Yn=ti[Tn],ai=this._tiles[Yn];ai.hasSymbolBuckets&&!ai.holdingForFade()?ai.setHoldDuration(this.map._fadeDuration):ai.hasSymbolBuckets&&!ai.symbolFadeFinished()||this._removeTile(Yn)}this._updateLoadedParentTileCache()}},g.prototype.releaseSymbolFadeTiles=function(){for(var p in this._tiles)this._tiles[p].holdingForFade()&&this._removeTile(p)},g.prototype._updateRetainedTiles=function(p,b){for(var N={},q={},ee=Math.max(b-g.maxOverzooming,this._source.minzoom),ge=Math.max(b+g.maxUnderzooming,this._source.minzoom),Ue={},st=0,kt=p;st<kt.length;st+=1){var Lt=kt[st],Zt=this._addTile(Lt);N[Lt.key]=Lt,Zt.hasData()||b<this._source.maxzoom&&(Ue[Lt.key]=Lt)}this._retainLoadedChildren(Ue,b,ge,N);for(var vr=0,pr=p;vr<pr.length;vr+=1){var Nr=pr[vr],cr=this._tiles[Nr.key];if(!cr.hasData()){if(b+1>this._source.maxzoom){var zr=Nr.children(this._source.maxzoom)[0],Ur=this.getTile(zr);if(Ur&&Ur.hasData()){N[zr.key]=zr;continue}}else{var Tn=Nr.children(this._source.maxzoom);if(N[Tn[0].key]&&N[Tn[1].key]&&N[Tn[2].key]&&N[Tn[3].key])continue}for(var ti=cr.wasRequested(),Yn=Nr.overscaledZ-1;Yn>=ee;--Yn){var ai=Nr.scaledTo(Yn);if(q[ai.key]||(q[ai.key]=!0,!(cr=this.getTile(ai))&&ti&&(cr=this._addTile(ai)),cr&&(N[ai.key]=ai,ti=cr.wasRequested(),cr.hasData())))break}}}return N},g.prototype._updateLoadedParentTileCache=function(){for(var p in this._loadedParentTiles={},this._tiles){for(var b=[],N=void 0,q=this._tiles[p].tileID;q.overscaledZ>0;){if(q.key in this._loadedParentTiles){N=this._loadedParentTiles[q.key];break}b.push(q.key);var ee=q.scaledTo(q.overscaledZ-1);if(N=this._getLoadedTile(ee))break;q=ee}for(var ge=0,Ue=b;ge<Ue.length;ge+=1)this._loadedParentTiles[Ue[ge]]=N}},g.prototype._addTile=function(p){var b=this._tiles[p.key];if(b)return b;(b=this._cache.getAndRemove(p))&&(this._setTileReloadTimer(p.key,b),b.tileID=p,this._state.initializeTileState(b,this.map?this.map.painter:null),this._cacheTimers[p.key]&&(clearTimeout(this._cacheTimers[p.key]),delete this._cacheTimers[p.key],this._setTileReloadTimer(p.key,b)));var N=Boolean(b);return N||(b=new m.Tile(p,this._source.tileSize*p.overscaleFactor()),this._loadTile(b,this._tileLoaded.bind(this,b,p.key,b.state))),b?(b.uses++,this._tiles[p.key]=b,N||this._source.fire(new m.Event("dataloading",{tile:b,coord:b.tileID,dataType:"source"})),b):null},g.prototype._setTileReloadTimer=function(p,b){var N=this;p in this._timers&&(clearTimeout(this._timers[p]),delete this._timers[p]);var q=b.getExpiryTimeout();q&&(this._timers[p]=setTimeout(function(){N._reloadTile(p,"expired"),delete N._timers[p]},q))},g.prototype._removeTile=function(p){var b=this._tiles[p];b&&(b.uses--,delete this._tiles[p],this._timers[p]&&(clearTimeout(this._timers[p]),delete this._timers[p]),b.uses>0||(b.hasData()&&b.state!=="reloading"?this._cache.add(b.tileID,b,b.getExpiryTimeout()):(b.aborted=!0,this._abortTile(b),this._unloadTile(b))))},g.prototype.clearTiles=function(){for(var p in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(p);this._cache.reset()},g.prototype.tilesIn=function(p,b,N){var q=this,ee=[],ge=this.transform;if(!ge)return ee;for(var Ue=N?ge.getCameraQueryGeometry(p):p,st=p.map(function(Yn){return ge.pointCoordinate(Yn)}),kt=Ue.map(function(Yn){return ge.pointCoordinate(Yn)}),Lt=this.getIds(),Zt=1/0,vr=1/0,pr=-1/0,Nr=-1/0,cr=0,zr=kt;cr<zr.length;cr+=1){var Ur=zr[cr];Zt=Math.min(Zt,Ur.x),vr=Math.min(vr,Ur.y),pr=Math.max(pr,Ur.x),Nr=Math.max(Nr,Ur.y)}for(var Tn=function(Yn){var ai=q._tiles[Lt[Yn]];if(!ai.holdingForFade()){var Pi=ai.tileID,va=Math.pow(2,ge.zoom-ai.tileID.overscaledZ),na=b*ai.queryPadding*m.EXTENT/ai.tileSize/va,Ua=[Pi.getTilePoint(new m.MercatorCoordinate(Zt,vr)),Pi.getTilePoint(new m.MercatorCoordinate(pr,Nr))];if(Ua[0].x-na<m.EXTENT&&Ua[0].y-na<m.EXTENT&&Ua[1].x+na>=0&&Ua[1].y+na>=0){var co=st.map(function(ho){return Pi.getTilePoint(ho)}),Eo=kt.map(function(ho){return Pi.getTilePoint(ho)});ee.push({tile:ai,tileID:Pi,queryGeometry:co,cameraQueryGeometry:Eo,scale:va})}}},ti=0;ti<Lt.length;ti++)Tn(ti);return ee},g.prototype.getVisibleCoordinates=function(p){for(var b=this,N=this.getRenderableIds(p).map(function(Ue){return b._tiles[Ue].tileID}),q=0,ee=N;q<ee.length;q+=1){var ge=ee[q];ge.posMatrix=this.transform.calculatePosMatrix(ge.toUnwrapped())}return N},g.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(en(this._source.type))for(var p in this._tiles){var b=this._tiles[p];if(b.fadeEndTime!==void 0&&b.fadeEndTime>=m.browser.now())return!0}return!1},g.prototype.setFeatureState=function(p,b,N){this._state.updateState(p=p||"_geojsonTileLayer",b,N)},g.prototype.removeFeatureState=function(p,b,N){this._state.removeFeatureState(p=p||"_geojsonTileLayer",b,N)},g.prototype.getFeatureState=function(p,b){return this._state.getState(p=p||"_geojsonTileLayer",b)},g.prototype.setDependencies=function(p,b,N){var q=this._tiles[p];q&&q.setDependencies(b,N)},g.prototype.reloadTilesForDependencies=function(p,b){for(var N in this._tiles)this._tiles[N].hasDependency(p,b)&&this._reloadTile(N,"reloading");this._cache.filter(function(q){return!q.hasDependency(p,b)})},g}(m.Evented);function tr(h,g){var p=Math.abs(2*h.wrap)-+(h.wrap<0),b=Math.abs(2*g.wrap)-+(g.wrap<0);return h.overscaledZ-g.overscaledZ||b-p||g.canonical.y-h.canonical.y||g.canonical.x-h.canonical.x}function en(h){return h==="raster"||h==="image"||h==="video"}function Kr(){return new m.window.Worker(qf.workerUrl)}At.maxOverzooming=10,At.maxUnderzooming=3;var Ft="mapboxgl_preloaded_worker_pool",rr=function(){this.active={}};rr.prototype.acquire=function(h){if(!this.workers)for(this.workers=[];this.workers.length<rr.workerCount;)this.workers.push(new Kr);return this.active[h]=!0,this.workers.slice()},rr.prototype.release=function(h){delete this.active[h],this.numActive()===0&&(this.workers.forEach(function(g){g.terminate()}),this.workers=null)},rr.prototype.isPreloaded=function(){return!!this.active[Ft]},rr.prototype.numActive=function(){return Object.keys(this.active).length};var ot,Li=Math.floor(m.browser.hardwareConcurrency/2);function Hr(){return ot||(ot=new rr),ot}function _i(h,g){var p={};for(var b in h)b!=="ref"&&(p[b]=h[b]);return m.refProperties.forEach(function(N){N in g&&(p[N]=g[N])}),p}function vi(h){h=h.slice();for(var g=Object.create(null),p=0;p<h.length;p++)g[h[p].id]=h[p];for(var b=0;b<h.length;b++)"ref"in h[b]&&(h[b]=_i(h[b],g[h[b].ref]));return h}rr.workerCount=Math.max(Math.min(Li,6),1);var It={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Yr(h,g,p){p.push({command:It.addSource,args:[h,g[h]]})}function Dr(h,g,p){g.push({command:It.removeSource,args:[h]}),p[h]=!0}function Jn(h,g,p,b){Dr(h,p,b),Yr(h,g,p)}function Kt(h,g,p){var b;for(b in h[p])if(h[p].hasOwnProperty(b)&&b!=="data"&&!m.deepEqual(h[p][b],g[p][b]))return!1;for(b in g[p])if(g[p].hasOwnProperty(b)&&b!=="data"&&!m.deepEqual(h[p][b],g[p][b]))return!1;return!0}function hr(h,g,p,b,N,q){var ee;for(ee in g=g||{},h=h||{})h.hasOwnProperty(ee)&&(m.deepEqual(h[ee],g[ee])||p.push({command:q,args:[b,ee,g[ee],N]}));for(ee in g)g.hasOwnProperty(ee)&&!h.hasOwnProperty(ee)&&(m.deepEqual(h[ee],g[ee])||p.push({command:q,args:[b,ee,g[ee],N]}))}function Fr(h){return h.id}function qr(h,g){return h[g.id]=g,h}var An=function(h,g){this.reset(h,g)};An.prototype.reset=function(h,g){this.points=h||[],this._distances=[0];for(var p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding},An.prototype.lerp=function(h){if(this.points.length===1)return this.points[0];h=m.clamp(h,0,1);for(var g=1,p=this._distances[g],b=h*this.paddedLength+this.padding;p<b&&g<this._distances.length;)p=this._distances[++g];var N=g-1,q=this._distances[N],ee=p-q,ge=ee>0?(b-q)/ee:0;return this.points[N].mult(1-ge).add(this.points[g].mult(ge))};var Ui=function(h,g,p){var b=this.boxCells=[],N=this.circleCells=[];this.xCellCount=Math.ceil(h/p),this.yCellCount=Math.ceil(g/p);for(var q=0;q<this.xCellCount*this.yCellCount;q++)b.push([]),N.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=h,this.height=g,this.xScale=this.xCellCount/h,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0};function fa(h,g,p,b,N){var q=m.create();return g?(m.scale(q,q,[1/N,1/N,1]),p||m.rotateZ(q,q,b.angle)):m.multiply(q,b.labelPlaneMatrix,h),q}function Wi(h,g,p,b,N){if(g){var q=m.clone(h);return m.scale(q,q,[N,N,1]),p||m.rotateZ(q,q,-b.angle),q}return b.glCoordMatrix}function ct(h,g){var p=[h.x,h.y,0,1];ns(p,p,g);var b=p[3];return{point:new m.Point(p[0]/b,p[1]/b),signedDistanceFromCamera:b}}function qi(h,g){return .5+h/g*.5}function Na(h,g){var p=h[0]/h[3],b=h[1]/h[3];return p>=-g[0]&&p<=g[0]&&b>=-g[1]&&b<=g[1]}function To(h,g,p,b,N,q,ee,ge){var Ue=b?h.textSizeData:h.iconSizeData,st=m.evaluateSizeForZoom(Ue,p.transform.zoom),kt=[256/p.width*2+1,256/p.height*2+1],Lt=b?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;Lt.clear();for(var Zt=h.lineVertexArray,vr=b?h.text.placedSymbolArray:h.icon.placedSymbolArray,pr=p.transform.width/p.transform.height,Nr=!1,cr=0;cr<vr.length;cr++){var zr=vr.get(cr);if(zr.hidden||zr.writingMode===m.WritingMode.vertical&&!Nr)zo(zr.numGlyphs,Lt);else{Nr=!1;var Ur=[zr.anchorX,zr.anchorY,0,1];if(m.transformMat4(Ur,Ur,g),Na(Ur,kt)){var Tn=qi(p.transform.cameraToCenterDistance,Ur[3]),ti=m.evaluateSizeForFeature(Ue,st,zr),Yn=ee?ti/Tn:ti*Tn,ai=new m.Point(zr.anchorX,zr.anchorY),Pi=ct(ai,N).point,va={},na=Ko(zr,Yn,!1,ge,g,N,q,h.glyphOffsetArray,Zt,Lt,Pi,ai,va,pr);Nr=na.useVertical,(na.notEnoughRoom||Nr||na.needsFlipping&&Ko(zr,Yn,!0,ge,g,N,q,h.glyphOffsetArray,Zt,Lt,Pi,ai,va,pr).notEnoughRoom)&&zo(zr.numGlyphs,Lt)}else zo(zr.numGlyphs,Lt)}}b?h.text.dynamicLayoutVertexBuffer.updateData(Lt):h.icon.dynamicLayoutVertexBuffer.updateData(Lt)}function ao(h,g,p,b,N,q,ee,ge,Ue,st,kt){var Lt=ge.glyphStartIndex+ge.numGlyphs,Zt=ge.lineStartIndex,vr=ge.lineStartIndex+ge.lineLength,pr=g.getoffsetX(ge.glyphStartIndex),Nr=g.getoffsetX(Lt-1),cr=Fo(h*pr,p,b,N,q,ee,ge.segment,Zt,vr,Ue,st,kt);if(!cr)return null;var zr=Fo(h*Nr,p,b,N,q,ee,ge.segment,Zt,vr,Ue,st,kt);return zr?{first:cr,last:zr}:null}function Ga(h,g,p,b){return h===m.WritingMode.horizontal&&Math.abs(p.y-g.y)>Math.abs(p.x-g.x)*b?{useVertical:!0}:(h===m.WritingMode.vertical?g.y<p.y:g.x>p.x)?{needsFlipping:!0}:null}function Ko(h,g,p,b,N,q,ee,ge,Ue,st,kt,Lt,Zt,vr){var pr,Nr=g/24,cr=h.lineOffsetX*Nr,zr=h.lineOffsetY*Nr;if(h.numGlyphs>1){var Ur=h.glyphStartIndex+h.numGlyphs,Tn=h.lineStartIndex,ti=h.lineStartIndex+h.lineLength,Yn=ao(Nr,ge,cr,zr,p,kt,Lt,h,Ue,q,Zt);if(!Yn)return{notEnoughRoom:!0};var ai=ct(Yn.first.point,ee).point,Pi=ct(Yn.last.point,ee).point;if(b&&!p){var va=Ga(h.writingMode,ai,Pi,vr);if(va)return va}pr=[Yn.first];for(var na=h.glyphStartIndex+1;na<Ur-1;na++)pr.push(Fo(Nr*ge.getoffsetX(na),cr,zr,p,kt,Lt,h.segment,Tn,ti,Ue,q,Zt));pr.push(Yn.last)}else{if(b&&!p){var Ua=ct(Lt,N).point,co=h.lineStartIndex+h.segment+1,Eo=new m.Point(Ue.getx(co),Ue.gety(co)),ho=ct(Eo,N),qo=ho.signedDistanceFromCamera>0?ho.point:ws(Lt,Eo,Ua,1,N),ga=Ga(h.writingMode,Ua,qo,vr);if(ga)return ga}var Zo=Fo(Nr*ge.getoffsetX(h.glyphStartIndex),cr,zr,p,kt,Lt,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,Ue,q,Zt);if(!Zo)return{notEnoughRoom:!0};pr=[Zo]}for(var Uo=0,Do=pr;Uo<Do.length;Uo+=1){var po=Do[Uo];m.addDynamicAttributes(st,po.point,po.angle)}return{}}function ws(h,g,p,b,N){var q=ct(h.add(h.sub(g)._unit()),N).point,ee=p.sub(q);return p.add(ee._mult(b/ee.mag()))}function Fo(h,g,p,b,N,q,ee,ge,Ue,st,kt,Lt){var Zt=b?h-g:h+g,vr=Zt>0?1:-1,pr=0;b&&(vr*=-1,pr=Math.PI),vr<0&&(pr+=Math.PI);for(var Nr=vr>0?ge+ee:ge+ee+1,cr=N,zr=N,Ur=0,Tn=0,ti=Math.abs(Zt),Yn=[];Ur+Tn<=ti;){if((Nr+=vr)<ge||Nr>=Ue)return null;if(zr=cr,Yn.push(cr),(cr=Lt[Nr])===void 0){var ai=new m.Point(st.getx(Nr),st.gety(Nr)),Pi=ct(ai,kt);if(Pi.signedDistanceFromCamera>0)cr=Lt[Nr]=Pi.point;else{var va=Nr-vr;cr=ws(Ur===0?q:new m.Point(st.getx(va),st.gety(va)),ai,zr,ti-Ur+1,kt)}}Ur+=Tn,Tn=zr.dist(cr)}var na=(ti-Ur)/Tn,Ua=cr.sub(zr),co=Ua.mult(na)._add(zr);co._add(Ua._unit()._perp()._mult(p*vr));var Eo=pr+Math.atan2(cr.y-zr.y,cr.x-zr.x);return Yn.push(co),{point:co,angle:Eo,path:Yn}}Ui.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ui.prototype.insert=function(h,g,p,b,N){this._forEachCell(g,p,b,N,this._insertBoxCell,this.boxUid++),this.boxKeys.push(h),this.bboxes.push(g),this.bboxes.push(p),this.bboxes.push(b),this.bboxes.push(N)},Ui.prototype.insertCircle=function(h,g,p,b){this._forEachCell(g-b,p-b,g+b,p+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(h),this.circles.push(g),this.circles.push(p),this.circles.push(b)},Ui.prototype._insertBoxCell=function(h,g,p,b,N,q){this.boxCells[N].push(q)},Ui.prototype._insertCircleCell=function(h,g,p,b,N,q){this.circleCells[N].push(q)},Ui.prototype._query=function(h,g,p,b,N,q){if(p<0||h>this.width||b<0||g>this.height)return!N&&[];var ee=[];if(h<=0&&g<=0&&this.width<=p&&this.height<=b){if(N)return!0;for(var ge=0;ge<this.boxKeys.length;ge++)ee.push({key:this.boxKeys[ge],x1:this.bboxes[4*ge],y1:this.bboxes[4*ge+1],x2:this.bboxes[4*ge+2],y2:this.bboxes[4*ge+3]});for(var Ue=0;Ue<this.circleKeys.length;Ue++){var st=this.circles[3*Ue],kt=this.circles[3*Ue+1],Lt=this.circles[3*Ue+2];ee.push({key:this.circleKeys[Ue],x1:st-Lt,y1:kt-Lt,x2:st+Lt,y2:kt+Lt})}return q?ee.filter(q):ee}return this._forEachCell(h,g,p,b,this._queryCell,ee,{hitTest:N,seenUids:{box:{},circle:{}}},q),N?ee.length>0:ee},Ui.prototype._queryCircle=function(h,g,p,b,N){var q=h-p,ee=h+p,ge=g-p,Ue=g+p;if(ee<0||q>this.width||Ue<0||ge>this.height)return!b&&[];var st=[];return this._forEachCell(q,ge,ee,Ue,this._queryCellCircle,st,{hitTest:b,circle:{x:h,y:g,radius:p},seenUids:{box:{},circle:{}}},N),b?st.length>0:st},Ui.prototype.query=function(h,g,p,b,N){return this._query(h,g,p,b,!1,N)},Ui.prototype.hitTest=function(h,g,p,b,N){return this._query(h,g,p,b,!0,N)},Ui.prototype.hitTestCircle=function(h,g,p,b){return this._queryCircle(h,g,p,!0,b)},Ui.prototype._queryCell=function(h,g,p,b,N,q,ee,ge){var Ue=ee.seenUids,st=this.boxCells[N];if(st!==null)for(var kt=this.bboxes,Lt=0,Zt=st;Lt<Zt.length;Lt+=1){var vr=Zt[Lt];if(!Ue.box[vr]){Ue.box[vr]=!0;var pr=4*vr;if(h<=kt[pr+2]&&g<=kt[pr+3]&&p>=kt[pr+0]&&b>=kt[pr+1]&&(!ge||ge(this.boxKeys[vr]))){if(ee.hitTest)return q.push(!0),!0;q.push({key:this.boxKeys[vr],x1:kt[pr],y1:kt[pr+1],x2:kt[pr+2],y2:kt[pr+3]})}}}var Nr=this.circleCells[N];if(Nr!==null)for(var cr=this.circles,zr=0,Ur=Nr;zr<Ur.length;zr+=1){var Tn=Ur[zr];if(!Ue.circle[Tn]){Ue.circle[Tn]=!0;var ti=3*Tn;if(this._circleAndRectCollide(cr[ti],cr[ti+1],cr[ti+2],h,g,p,b)&&(!ge||ge(this.circleKeys[Tn]))){if(ee.hitTest)return q.push(!0),!0;var Yn=cr[ti],ai=cr[ti+1],Pi=cr[ti+2];q.push({key:this.circleKeys[Tn],x1:Yn-Pi,y1:ai-Pi,x2:Yn+Pi,y2:ai+Pi})}}}},Ui.prototype._queryCellCircle=function(h,g,p,b,N,q,ee,ge){var Ue=ee.circle,st=ee.seenUids,kt=this.boxCells[N];if(kt!==null)for(var Lt=this.bboxes,Zt=0,vr=kt;Zt<vr.length;Zt+=1){var pr=vr[Zt];if(!st.box[pr]){st.box[pr]=!0;var Nr=4*pr;if(this._circleAndRectCollide(Ue.x,Ue.y,Ue.radius,Lt[Nr+0],Lt[Nr+1],Lt[Nr+2],Lt[Nr+3])&&(!ge||ge(this.boxKeys[pr])))return q.push(!0),!0}}var cr=this.circleCells[N];if(cr!==null)for(var zr=this.circles,Ur=0,Tn=cr;Ur<Tn.length;Ur+=1){var ti=Tn[Ur];if(!st.circle[ti]){st.circle[ti]=!0;var Yn=3*ti;if(this._circlesCollide(zr[Yn],zr[Yn+1],zr[Yn+2],Ue.x,Ue.y,Ue.radius)&&(!ge||ge(this.circleKeys[ti])))return q.push(!0),!0}}},Ui.prototype._forEachCell=function(h,g,p,b,N,q,ee,ge){for(var Ue=this._convertToXCellCoord(h),st=this._convertToYCellCoord(g),kt=this._convertToXCellCoord(p),Lt=this._convertToYCellCoord(b),Zt=Ue;Zt<=kt;Zt++)for(var vr=st;vr<=Lt;vr++)if(N.call(this,h,g,p,b,this.xCellCount*vr+Zt,q,ee,ge))return},Ui.prototype._convertToXCellCoord=function(h){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(h*this.xScale)))},Ui.prototype._convertToYCellCoord=function(h){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(h*this.yScale)))},Ui.prototype._circlesCollide=function(h,g,p,b,N,q){var ee=b-h,ge=N-g,Ue=p+q;return Ue*Ue>ee*ee+ge*ge},Ui.prototype._circleAndRectCollide=function(h,g,p,b,N,q,ee){var ge=(q-b)/2,Ue=Math.abs(h-(b+ge));if(Ue>ge+p)return!1;var st=(ee-N)/2,kt=Math.abs(g-(N+st));if(kt>st+p)return!1;if(Ue<=ge||kt<=st)return!0;var Lt=Ue-ge,Zt=kt-st;return Lt*Lt+Zt*Zt<=p*p};var su=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function zo(h,g){for(var p=0;p<h;p++){var b=g.length;g.resize(b+4),g.float32.set(su,3*b)}}function ns(h,g,p){var b=g[0],N=g[1];return h[0]=p[0]*b+p[4]*N+p[12],h[1]=p[1]*b+p[5]*N+p[13],h[3]=p[3]*b+p[7]*N+p[15],h}var ls=function(h,g,p){g===void 0&&(g=new Ui(h.width+200,h.height+200,25)),p===void 0&&(p=new Ui(h.width+200,h.height+200,25)),this.transform=h,this.grid=g,this.ignoredGrid=p,this.pitchfactor=Math.cos(h._pitch)*h.cameraToCenterDistance,this.screenRightBoundary=h.width+100,this.screenBottomBoundary=h.height+100,this.gridRightBoundary=h.width+200,this.gridBottomBoundary=h.height+200};function _o(h,g,p){return g*(m.EXTENT/(h.tileSize*Math.pow(2,p-h.tileID.overscaledZ)))}ls.prototype.placeCollisionBox=function(h,g,p,b,N){var q=this.projectAndGetPerspectiveRatio(b,h.anchorPointX,h.anchorPointY),ee=p*q.perspectiveRatio,ge=h.x1*ee+q.point.x,Ue=h.y1*ee+q.point.y,st=h.x2*ee+q.point.x,kt=h.y2*ee+q.point.y;return!this.isInsideGrid(ge,Ue,st,kt)||!g&&this.grid.hitTest(ge,Ue,st,kt,N)?{box:[],offscreen:!1}:{box:[ge,Ue,st,kt],offscreen:this.isOffscreen(ge,Ue,st,kt)}},ls.prototype.placeCollisionCircles=function(h,g,p,b,N,q,ee,ge,Ue,st,kt,Lt,Zt){var vr=[],pr=new m.Point(g.anchorX,g.anchorY),Nr=ct(pr,q),cr=qi(this.transform.cameraToCenterDistance,Nr.signedDistanceFromCamera),zr=(st?N/cr:N*cr)/m.ONE_EM,Ur=ct(pr,ee).point,Tn=ao(zr,b,g.lineOffsetX*zr,g.lineOffsetY*zr,!1,Ur,pr,g,p,ee,{}),ti=!1,Yn=!1,ai=!0;if(Tn){for(var Pi=.5*Lt*cr+Zt,va=new m.Point(-100,-100),na=new m.Point(this.screenRightBoundary,this.screenBottomBoundary),Ua=new An,co=Tn.first,Eo=Tn.last,ho=[],qo=co.path.length-1;qo>=1;qo--)ho.push(co.path[qo]);for(var ga=1;ga<Eo.path.length;ga++)ho.push(Eo.path[ga]);var Zo=2.5*Pi;if(ge){var Uo=ho.map(function(yc){return ct(yc,ge)});ho=Uo.some(function(yc){return yc.signedDistanceFromCamera<=0})?[]:Uo.map(function(yc){return yc.point})}var Do=[];if(ho.length>0){for(var po=ho[0].clone(),us=ho[0].clone(),ko=1;ko<ho.length;ko++)po.x=Math.min(po.x,ho[ko].x),po.y=Math.min(po.y,ho[ko].y),us.x=Math.max(us.x,ho[ko].x),us.y=Math.max(us.y,ho[ko].y);Do=po.x>=va.x&&us.x<=na.x&&po.y>=va.y&&us.y<=na.y?[ho]:us.x<va.x||po.x>na.x||us.y<va.y||po.y>na.y?[]:m.clipLine([ho],va.x,va.y,na.x,na.y)}for(var Io=0,El=Do;Io<El.length;Io+=1){var Ou;Ua.reset(El[Io],.25*Pi),Ou=Ua.length<=.5*Pi?1:Math.ceil(Ua.paddedLength/Zo)+1;for(var nu=0;nu<Ou;nu++){var rc=nu/Math.max(Ou-1,1),Du=Ua.lerp(rc),gu=Du.x+100,gc=Du.y+100;vr.push(gu,gc,Pi,0);var Vl=gu-Pi,ml=gc-Pi,Mc=gu+Pi,hl=gc+Pi;if(ai=ai&&this.isOffscreen(Vl,ml,Mc,hl),Yn=Yn||this.isInsideGrid(Vl,ml,Mc,hl),!h&&this.grid.hitTestCircle(gu,gc,Pi,kt)&&(ti=!0,!Ue))return{circles:[],offscreen:!1,collisionDetected:ti}}}}return{circles:!Ue&&ti||!Yn?[]:vr,offscreen:ai,collisionDetected:ti}},ls.prototype.queryRenderedSymbols=function(h){if(h.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var g=[],p=1/0,b=1/0,N=-1/0,q=-1/0,ee=0,ge=h;ee<ge.length;ee+=1){var Ue=ge[ee],st=new m.Point(Ue.x+100,Ue.y+100);p=Math.min(p,st.x),b=Math.min(b,st.y),N=Math.max(N,st.x),q=Math.max(q,st.y),g.push(st)}for(var kt={},Lt={},Zt=0,vr=this.grid.query(p,b,N,q).concat(this.ignoredGrid.query(p,b,N,q));Zt<vr.length;Zt+=1){var pr=vr[Zt],Nr=pr.key;if(kt[Nr.bucketInstanceId]===void 0&&(kt[Nr.bucketInstanceId]={}),!kt[Nr.bucketInstanceId][Nr.featureIndex]){var cr=[new m.Point(pr.x1,pr.y1),new m.Point(pr.x2,pr.y1),new m.Point(pr.x2,pr.y2),new m.Point(pr.x1,pr.y2)];m.polygonIntersectsPolygon(g,cr)&&(kt[Nr.bucketInstanceId][Nr.featureIndex]=!0,Lt[Nr.bucketInstanceId]===void 0&&(Lt[Nr.bucketInstanceId]=[]),Lt[Nr.bucketInstanceId].push(Nr.featureIndex))}}return Lt},ls.prototype.insertCollisionBox=function(h,g,p,b,N){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:b,collisionGroupID:N},h[0],h[1],h[2],h[3])},ls.prototype.insertCollisionCircles=function(h,g,p,b,N){for(var q=g?this.ignoredGrid:this.grid,ee={bucketInstanceId:p,featureIndex:b,collisionGroupID:N},ge=0;ge<h.length;ge+=4)q.insertCircle(ee,h[ge],h[ge+1],h[ge+2])},ls.prototype.projectAndGetPerspectiveRatio=function(h,g,p){var b=[g,p,0,1];return ns(b,b,h),{point:new m.Point((b[0]/b[3]+1)/2*this.transform.width+100,(-b[1]/b[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b[3]*.5}},ls.prototype.isOffscreen=function(h,g,p,b){return p<100||h>=this.screenRightBoundary||b<100||g>this.screenBottomBoundary},ls.prototype.isInsideGrid=function(h,g,p,b){return p>=0&&h<this.gridRightBoundary&&b>=0&&g<this.gridBottomBoundary},ls.prototype.getViewportMatrix=function(){var h=m.identity([]);return m.translate(h,h,[-100,-100,0]),h};var Po=function(h,g,p,b){this.opacity=h?Math.max(0,Math.min(1,h.opacity+(h.placed?g:-g))):b&&p?1:0,this.placed=p};Po.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Ss=function(h,g,p,b,N){this.text=new Po(h?h.text:null,g,p,N),this.icon=new Po(h?h.icon:null,g,b,N)};Ss.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Wu=function(h,g,p){this.text=h,this.icon=g,this.skipFade=p},$s=function(){this.invProjMatrix=m.create(),this.viewportMatrix=m.create(),this.circles=[]},uu=function(h,g,p,b,N){this.bucketInstanceId=h,this.featureIndex=g,this.sourceLayerIndex=p,this.bucketIndex=b,this.tileID=N},Jo=function(h){this.crossSourceCollisions=h,this.maxGroupID=0,this.collisionGroups={}};function ms(h,g,p,b,N){var q=m.getAnchorAlignment(h),ee=-(q.horizontalAlign-.5)*g,ge=-(q.verticalAlign-.5)*p,Ue=m.evaluateVariableOffset(h,b);return new m.Point(ee+Ue[0]*N,ge+Ue[1]*N)}function eu(h,g,p,b,N,q){var ee=h.x1,ge=h.x2,Ue=h.y1,st=h.y2,kt=h.anchorPointX,Lt=h.anchorPointY,Zt=new m.Point(g,p);return b&&Zt._rotate(N?q:-q),{x1:ee+Zt.x,y1:Ue+Zt.y,x2:ge+Zt.x,y2:st+Zt.y,anchorPointX:kt,anchorPointY:Lt}}Jo.prototype.get=function(h){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[h]){var g=++this.maxGroupID;this.collisionGroups[h]={ID:g,predicate:function(p){return p.collisionGroupID===g}}}return this.collisionGroups[h]};var Bs=function(h,g,p,b){this.transform=h.clone(),this.collisionIndex=new ls(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Jo(p),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}};function fi(h,g,p,b,N){h.emplaceBack(g?1:0,p?1:0,b||0,N||0),h.emplaceBack(g?1:0,p?1:0,b||0,N||0),h.emplaceBack(g?1:0,p?1:0,b||0,N||0),h.emplaceBack(g?1:0,p?1:0,b||0,N||0)}Bs.prototype.getBucketParts=function(h,g,p,b){var N=p.getBucket(g),q=p.latestFeatureIndex;if(N&&q&&g.id===N.layerIds[0]){var ee=p.collisionBoxArray,ge=N.layers[0].layout,Ue=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),st=p.tileSize/m.EXTENT,kt=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),Lt=ge.get("text-pitch-alignment")==="map",Zt=ge.get("text-rotation-alignment")==="map",vr=_o(p,1,this.transform.zoom),pr=fa(kt,Lt,Zt,this.transform,vr),Nr=null;if(Lt){var cr=Wi(kt,Lt,Zt,this.transform,vr);Nr=m.multiply([],this.transform.labelPlaneMatrix,cr)}this.retainedQueryData[N.bucketInstanceId]=new uu(N.bucketInstanceId,q,N.sourceLayerIndex,N.index,p.tileID);var zr={bucket:N,layout:ge,posMatrix:kt,textLabelPlaneMatrix:pr,labelToScreenMatrix:Nr,scale:Ue,textPixelRatio:st,holdingForFade:p.holdingForFade(),collisionBoxArray:ee,partiallyEvaluatedTextSize:m.evaluateSizeForZoom(N.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(N.sourceID)};if(b)for(var Ur=0,Tn=N.sortKeyRanges;Ur<Tn.length;Ur+=1){var ti=Tn[Ur];h.push({sortKey:ti.sortKey,symbolInstanceStart:ti.symbolInstanceStart,symbolInstanceEnd:ti.symbolInstanceEnd,parameters:zr})}else h.push({symbolInstanceStart:0,symbolInstanceEnd:N.symbolInstances.length,parameters:zr})}},Bs.prototype.attemptAnchorPlacement=function(h,g,p,b,N,q,ee,ge,Ue,st,kt,Lt,Zt,vr,pr){var Nr,cr=[Lt.textOffset0,Lt.textOffset1],zr=ms(h,p,b,cr,N),Ur=this.collisionIndex.placeCollisionBox(eu(g,zr.x,zr.y,q,ee,this.transform.angle),kt,ge,Ue,st.predicate);if(!pr||this.collisionIndex.placeCollisionBox(eu(pr,zr.x,zr.y,q,ee,this.transform.angle),kt,ge,Ue,st.predicate).box.length!==0)return Ur.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Lt.crossTileID]&&this.prevPlacement.placements[Lt.crossTileID]&&this.prevPlacement.placements[Lt.crossTileID].text&&(Nr=this.prevPlacement.variableOffsets[Lt.crossTileID].anchor),this.variableOffsets[Lt.crossTileID]={textOffset:cr,width:p,height:b,anchor:h,textBoxScale:N,prevAnchor:Nr},this.markUsedJustification(Zt,h,Lt,vr),Zt.allowVerticalPlacement&&(this.markUsedOrientation(Zt,vr,Lt),this.placedOrientations[Lt.crossTileID]=vr),{shift:zr,placedGlyphBoxes:Ur}):void 0},Bs.prototype.placeLayerBucketPart=function(h,g,p){var b=this,N=h.parameters,q=N.bucket,ee=N.layout,ge=N.posMatrix,Ue=N.textLabelPlaneMatrix,st=N.labelToScreenMatrix,kt=N.textPixelRatio,Lt=N.holdingForFade,Zt=N.collisionBoxArray,vr=N.partiallyEvaluatedTextSize,pr=N.collisionGroup,Nr=ee.get("text-optional"),cr=ee.get("icon-optional"),zr=ee.get("text-allow-overlap"),Ur=ee.get("icon-allow-overlap"),Tn=ee.get("text-rotation-alignment")==="map",ti=ee.get("text-pitch-alignment")==="map",Yn=ee.get("icon-text-fit")!=="none",ai=ee.get("symbol-z-order")==="viewport-y",Pi=zr&&(Ur||!q.hasIconData()||cr),va=Ur&&(zr||!q.hasTextData()||Nr);!q.collisionArrays&&Zt&&q.deserializeCollisionBoxes(Zt);var na=function(ga,Zo){if(!g[ga.crossTileID])if(Lt)b.placements[ga.crossTileID]=new Wu(!1,!1,!1);else{var Uo,Do=!1,po=!1,us=!0,ko=null,Io={box:null,offscreen:null},El={box:null,offscreen:null},Ou=null,nu=null,rc=0,Du=0,gu=0;Zo.textFeatureIndex?rc=Zo.textFeatureIndex:ga.useRuntimeCollisionCircles&&(rc=ga.featureIndex),Zo.verticalTextFeatureIndex&&(Du=Zo.verticalTextFeatureIndex);var gc=Zo.textBox;if(gc){var Vl=function(iu){var Xs=m.WritingMode.horizontal;if(q.allowVerticalPlacement&&!iu&&b.prevPlacement){var Yc=b.prevPlacement.placedOrientations[ga.crossTileID];Yc&&(b.placedOrientations[ga.crossTileID]=Yc,b.markUsedOrientation(q,Xs=Yc,ga))}return Xs},ml=function(iu,Xs){if(q.allowVerticalPlacement&&ga.numVerticalGlyphVertices>0&&Zo.verticalTextBox)for(var Yc=0,hh=q.writingModes;Yc<hh.length&&(hh[Yc]===m.WritingMode.vertical?(Io=Xs(),El=Io):Io=iu(),!(Io&&Io.box&&Io.box.length));Yc+=1);else Io=iu()};if(ee.get("text-variable-anchor")){var Mc=ee.get("text-variable-anchor");if(b.prevPlacement&&b.prevPlacement.variableOffsets[ga.crossTileID]){var hl=b.prevPlacement.variableOffsets[ga.crossTileID];Mc.indexOf(hl.anchor)>0&&(Mc=Mc.filter(function(iu){return iu!==hl.anchor})).unshift(hl.anchor)}var yc=function(iu,Xs,Yc){for(var hh=iu.x2-iu.x1,Jf=iu.y2-iu.y1,Fh=ga.textBoxScale,Xh=Yn&&!Ur?Xs:null,Of={box:[],offscreen:!1},eh=zr?2*Mc.length:Mc.length,If=0;If<eh;++If){var Vf=b.attemptAnchorPlacement(Mc[If%Mc.length],iu,hh,Jf,Fh,Tn,ti,kt,ge,pr,If>=Mc.length,ga,q,Yc,Xh);if(Vf&&(Of=Vf.placedGlyphBoxes)&&Of.box&&Of.box.length){Do=!0,ko=Vf.shift;break}}return Of};ml(function(){return yc(gc,Zo.iconBox,m.WritingMode.horizontal)},function(){var iu=Zo.verticalTextBox;return q.allowVerticalPlacement&&!(Io&&Io.box&&Io.box.length)&&ga.numVerticalGlyphVertices>0&&iu?yc(iu,Zo.verticalIconBox,m.WritingMode.vertical):{box:null,offscreen:null}}),Io&&(Do=Io.box,us=Io.offscreen);var lp=Vl(Io&&Io.box);if(!Do&&b.prevPlacement){var Dh=b.prevPlacement.variableOffsets[ga.crossTileID];Dh&&(b.variableOffsets[ga.crossTileID]=Dh,b.markUsedJustification(q,Dh.anchor,ga,lp))}}else{var jf=function(iu,Xs){var Yc=b.collisionIndex.placeCollisionBox(iu,zr,kt,ge,pr.predicate);return Yc&&Yc.box&&Yc.box.length&&(b.markUsedOrientation(q,Xs,ga),b.placedOrientations[ga.crossTileID]=Xs),Yc};ml(function(){return jf(gc,m.WritingMode.horizontal)},function(){var iu=Zo.verticalTextBox;return q.allowVerticalPlacement&&ga.numVerticalGlyphVertices>0&&iu?jf(iu,m.WritingMode.vertical):{box:null,offscreen:null}}),Vl(Io&&Io.box&&Io.box.length)}}if(Do=(Uo=Io)&&Uo.box&&Uo.box.length>0,us=Uo&&Uo.offscreen,ga.useRuntimeCollisionCircles){var bh=q.text.placedSymbolArray.get(ga.centerJustifiedTextSymbolIndex),Qf=m.evaluateSizeForFeature(q.textSizeData,vr,bh),sf=ee.get("text-padding");Ou=b.collisionIndex.placeCollisionCircles(zr,bh,q.lineVertexArray,q.glyphOffsetArray,Qf,ge,Ue,st,p,ti,pr.predicate,ga.collisionCircleDiameter,sf),Do=zr||Ou.circles.length>0&&!Ou.collisionDetected,us=us&&Ou.offscreen}if(Zo.iconFeatureIndex&&(gu=Zo.iconFeatureIndex),Zo.iconBox){var ch=function(iu){var Xs=Yn&&ko?eu(iu,ko.x,ko.y,Tn,ti,b.transform.angle):iu;return b.collisionIndex.placeCollisionBox(Xs,Ur,kt,ge,pr.predicate)};po=El&&El.box&&El.box.length&&Zo.verticalIconBox?(nu=ch(Zo.verticalIconBox)).box.length>0:(nu=ch(Zo.iconBox)).box.length>0,us=us&&nu.offscreen}var Pc=Nr||ga.numHorizontalGlyphVertices===0&&ga.numVerticalGlyphVertices===0,Hl=cr||ga.numIconVertices===0;if(Pc||Hl?Hl?Pc||(po=po&&Do):Do=po&&Do:po=Do=po&&Do,Do&&Uo&&Uo.box&&b.collisionIndex.insertCollisionBox(Uo.box,ee.get("text-ignore-placement"),q.bucketInstanceId,El&&El.box&&Du?Du:rc,pr.ID),po&&nu&&b.collisionIndex.insertCollisionBox(nu.box,ee.get("icon-ignore-placement"),q.bucketInstanceId,gu,pr.ID),Ou&&(Do&&b.collisionIndex.insertCollisionCircles(Ou.circles,ee.get("text-ignore-placement"),q.bucketInstanceId,rc,pr.ID),p)){var zc=q.bucketInstanceId,fh=b.collisionCircleArrays[zc];fh===void 0&&(fh=b.collisionCircleArrays[zc]=new $s);for(var Eh=0;Eh<Ou.circles.length;Eh+=4)fh.circles.push(Ou.circles[Eh+0]),fh.circles.push(Ou.circles[Eh+1]),fh.circles.push(Ou.circles[Eh+2]),fh.circles.push(Ou.collisionDetected?1:0)}b.placements[ga.crossTileID]=new Wu(Do||Pi,po||va,us||q.justReloaded),g[ga.crossTileID]=!0}};if(ai)for(var Ua=q.getSortedSymbolIndexes(this.transform.angle),co=Ua.length-1;co>=0;--co){var Eo=Ua[co];na(q.symbolInstances.get(Eo),q.collisionArrays[Eo])}else for(var ho=h.symbolInstanceStart;ho<h.symbolInstanceEnd;ho++)na(q.symbolInstances.get(ho),q.collisionArrays[ho]);if(p&&q.bucketInstanceId in this.collisionCircleArrays){var qo=this.collisionCircleArrays[q.bucketInstanceId];m.invert(qo.invProjMatrix,ge),qo.viewportMatrix=this.collisionIndex.getViewportMatrix()}q.justReloaded=!1},Bs.prototype.markUsedJustification=function(h,g,p,b){var N;N=b===m.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[m.getAnchorJustification(g)];for(var q=0,ee=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];q<ee.length;q+=1){var ge=ee[q];ge>=0&&(h.text.placedSymbolArray.get(ge).crossTileID=N>=0&&ge!==N?0:p.crossTileID)}},Bs.prototype.markUsedOrientation=function(h,g,p){for(var b=g===m.WritingMode.horizontal||g===m.WritingMode.horizontalOnly?g:0,N=g===m.WritingMode.vertical?g:0,q=0,ee=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];q<ee.length;q+=1)h.text.placedSymbolArray.get(ee[q]).placedOrientation=b;p.verticalPlacedTextSymbolIndex&&(h.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=N)},Bs.prototype.commit=function(h){this.commitTime=h,this.zoomAtLastRecencyCheck=this.transform.zoom;var g=this.prevPlacement,p=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;var b=g?g.symbolFadeChange(h):1,N=g?g.opacities:{},q=g?g.variableOffsets:{},ee=g?g.placedOrientations:{};for(var ge in this.placements){var Ue=this.placements[ge],st=N[ge];st?(this.opacities[ge]=new Ss(st,b,Ue.text,Ue.icon),p=p||Ue.text!==st.text.placed||Ue.icon!==st.icon.placed):(this.opacities[ge]=new Ss(null,b,Ue.text,Ue.icon,Ue.skipFade),p=p||Ue.text||Ue.icon)}for(var kt in N){var Lt=N[kt];if(!this.opacities[kt]){var Zt=new Ss(Lt,b,!1,!1);Zt.isHidden()||(this.opacities[kt]=Zt,p=p||Lt.text.placed||Lt.icon.placed)}}for(var vr in q)this.variableOffsets[vr]||!this.opacities[vr]||this.opacities[vr].isHidden()||(this.variableOffsets[vr]=q[vr]);for(var pr in ee)this.placedOrientations[pr]||!this.opacities[pr]||this.opacities[pr].isHidden()||(this.placedOrientations[pr]=ee[pr]);p?this.lastPlacementChangeTime=h:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:h)},Bs.prototype.updateLayerOpacities=function(h,g){for(var p={},b=0,N=g;b<N.length;b+=1){var q=N[b],ee=q.getBucket(h);ee&&q.latestFeatureIndex&&h.id===ee.layerIds[0]&&this.updateBucketOpacities(ee,p,q.collisionBoxArray)}},Bs.prototype.updateBucketOpacities=function(h,g,p){var b=this;h.hasTextData()&&h.text.opacityVertexArray.clear(),h.hasIconData()&&h.icon.opacityVertexArray.clear(),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexArray.clear(),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexArray.clear();var N=h.layers[0].layout,q=new Ss(null,0,!1,!1,!0),ee=N.get("text-allow-overlap"),ge=N.get("icon-allow-overlap"),Ue=N.get("text-variable-anchor"),st=N.get("text-rotation-alignment")==="map",kt=N.get("text-pitch-alignment")==="map",Lt=N.get("icon-text-fit")!=="none",Zt=new Ss(null,0,ee&&(ge||!h.hasIconData()||N.get("icon-optional")),ge&&(ee||!h.hasTextData()||N.get("text-optional")),!0);!h.collisionArrays&&p&&(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData())&&h.deserializeCollisionBoxes(p);for(var vr=function(zr,Ur,Tn){for(var ti=0;ti<Ur/4;ti++)zr.opacityVertexArray.emplaceBack(Tn)},pr=function(zr){var Ur=h.symbolInstances.get(zr),Tn=Ur.numHorizontalGlyphVertices,ti=Ur.numVerticalGlyphVertices,Yn=Ur.crossTileID,ai=b.opacities[Yn];g[Yn]?ai=q:ai||(b.opacities[Yn]=ai=Zt),g[Yn]=!0;var Pi=Ur.numIconVertices>0,va=b.placedOrientations[Ur.crossTileID],na=va===m.WritingMode.vertical,Ua=va===m.WritingMode.horizontal||va===m.WritingMode.horizontalOnly;if(Tn>0||ti>0){var co=Pa(ai.text);vr(h.text,Tn,na?Yt:co),vr(h.text,ti,Ua?Yt:co);var Eo=ai.text.isHidden();[Ur.rightJustifiedTextSymbolIndex,Ur.centerJustifiedTextSymbolIndex,Ur.leftJustifiedTextSymbolIndex].forEach(function(Io){Io>=0&&(h.text.placedSymbolArray.get(Io).hidden=Eo||na?1:0)}),Ur.verticalPlacedTextSymbolIndex>=0&&(h.text.placedSymbolArray.get(Ur.verticalPlacedTextSymbolIndex).hidden=Eo||Ua?1:0);var ho=b.variableOffsets[Ur.crossTileID];ho&&b.markUsedJustification(h,ho.anchor,Ur,va);var qo=b.placedOrientations[Ur.crossTileID];qo&&(b.markUsedJustification(h,"left",Ur,qo),b.markUsedOrientation(h,qo,Ur))}if(Pi){var ga=Pa(ai.icon),Zo=!(Lt&&Ur.verticalPlacedIconSymbolIndex&&na);Ur.placedIconSymbolIndex>=0&&(vr(h.icon,Ur.numIconVertices,Zo?ga:Yt),h.icon.placedSymbolArray.get(Ur.placedIconSymbolIndex).hidden=ai.icon.isHidden()),Ur.verticalPlacedIconSymbolIndex>=0&&(vr(h.icon,Ur.numVerticalIconVertices,Zo?Yt:ga),h.icon.placedSymbolArray.get(Ur.verticalPlacedIconSymbolIndex).hidden=ai.icon.isHidden())}if(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData()){var Uo=h.collisionArrays[zr];if(Uo){var Do=new m.Point(0,0);if(Uo.textBox||Uo.verticalTextBox){var po=!0;if(Ue){var us=b.variableOffsets[Yn];us?(Do=ms(us.anchor,us.width,us.height,us.textOffset,us.textBoxScale),st&&Do._rotate(kt?b.transform.angle:-b.transform.angle)):po=!1}Uo.textBox&&fi(h.textCollisionBox.collisionVertexArray,ai.text.placed,!po||na,Do.x,Do.y),Uo.verticalTextBox&&fi(h.textCollisionBox.collisionVertexArray,ai.text.placed,!po||Ua,Do.x,Do.y)}var ko=Boolean(!Ua&&Uo.verticalIconBox);Uo.iconBox&&fi(h.iconCollisionBox.collisionVertexArray,ai.icon.placed,ko,Lt?Do.x:0,Lt?Do.y:0),Uo.verticalIconBox&&fi(h.iconCollisionBox.collisionVertexArray,ai.icon.placed,!ko,Lt?Do.x:0,Lt?Do.y:0)}}},Nr=0;Nr<h.symbolInstances.length;Nr++)pr(Nr);if(h.sortFeatures(this.transform.angle),this.retainedQueryData[h.bucketInstanceId]&&(this.retainedQueryData[h.bucketInstanceId].featureSortOrder=h.featureSortOrder),h.hasTextData()&&h.text.opacityVertexBuffer&&h.text.opacityVertexBuffer.updateData(h.text.opacityVertexArray),h.hasIconData()&&h.icon.opacityVertexBuffer&&h.icon.opacityVertexBuffer.updateData(h.icon.opacityVertexArray),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexBuffer&&h.iconCollisionBox.collisionVertexBuffer.updateData(h.iconCollisionBox.collisionVertexArray),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexBuffer&&h.textCollisionBox.collisionVertexBuffer.updateData(h.textCollisionBox.collisionVertexArray),h.bucketInstanceId in this.collisionCircleArrays){var cr=this.collisionCircleArrays[h.bucketInstanceId];h.placementInvProjMatrix=cr.invProjMatrix,h.placementViewportMatrix=cr.viewportMatrix,h.collisionCircleArray=cr.circles,delete this.collisionCircleArrays[h.bucketInstanceId]}},Bs.prototype.symbolFadeChange=function(h){return this.fadeDuration===0?1:(h-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Bs.prototype.zoomAdjustment=function(h){return Math.max(0,(this.transform.zoom-h)/1.5)},Bs.prototype.hasTransitions=function(h){return this.stale||h-this.lastPlacementChangeTime<this.fadeDuration},Bs.prototype.stillRecent=function(h,g){var p=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*p>h},Bs.prototype.setStale=function(){this.stale=!0};var is=Math.pow(2,25),ku=Math.pow(2,24),mt=Math.pow(2,17),Gt=Math.pow(2,16),Cr=Math.pow(2,9),Rr=Math.pow(2,8),ji=Math.pow(2,1);function Pa(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;var g=h.placed?1:0,p=Math.floor(127*h.opacity);return p*is+g*ku+p*mt+g*Gt+p*Cr+g*Rr+p*ji+g}var Yt=0,De=function(h){this._sortAcrossTiles=h.layout.get("symbol-z-order")!=="viewport-y"&&h.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};De.prototype.continuePlacement=function(h,g,p,b,N){for(var q=this._bucketParts;this._currentTileIndex<h.length;)if(g.getBucketParts(q,b,h[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,N())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,q.sort(function(ee,ge){return ee.sortKey-ge.sortKey}));this._currentPartIndex<q.length;)if(g.placeLayerBucketPart(q[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,N())return!0;return!1};var Me=function(h,g,p,b,N,q,ee){this.placement=new Bs(h,N,q,ee),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=b,this._done=!1};Me.prototype.isDone=function(){return this._done},Me.prototype.continuePlacement=function(h,g,p){for(var b=this,N=m.browser.now(),q=function(){var Ue=m.browser.now()-N;return!b._forceFullPlacement&&Ue>2};this._currentPlacementIndex>=0;){var ee=g[h[this._currentPlacementIndex]],ge=this.placement.collisionIndex.transform.zoom;if(ee.type==="symbol"&&(!ee.minzoom||ee.minzoom<=ge)&&(!ee.maxzoom||ee.maxzoom>ge)){if(this._inProgressLayer||(this._inProgressLayer=new De(ee)),this._inProgressLayer.continuePlacement(p[ee.source],this.placement,this._showCollisionBoxes,ee,q))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Me.prototype.commit=function(h){return this.placement.commit(h),this.placement};var ce=512/m.EXTENT/2,He=function(h,g,p){this.tileID=h,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(var b=0;b<g.length;b++){var N=g.get(b),q=N.key;this.indexedSymbolInstances[q]||(this.indexedSymbolInstances[q]=[]),this.indexedSymbolInstances[q].push({crossTileID:N.crossTileID,coord:this.getScaledCoordinates(N,h)})}};He.prototype.getScaledCoordinates=function(h,g){var p=ce/Math.pow(2,g.canonical.z-this.tileID.canonical.z);return{x:Math.floor((g.canonical.x*m.EXTENT+h.anchorX)*p),y:Math.floor((g.canonical.y*m.EXTENT+h.anchorY)*p)}},He.prototype.findMatches=function(h,g,p){for(var b=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z),N=0;N<h.length;N++){var q=h.get(N);if(!q.crossTileID){var ee=this.indexedSymbolInstances[q.key];if(ee)for(var ge=this.getScaledCoordinates(q,g),Ue=0,st=ee;Ue<st.length;Ue+=1){var kt=st[Ue];if(Math.abs(kt.coord.x-ge.x)<=b&&Math.abs(kt.coord.y-ge.y)<=b&&!p[kt.crossTileID]){p[kt.crossTileID]=!0,q.crossTileID=kt.crossTileID;break}}}}};var Pe=function(){this.maxCrossTileID=0};Pe.prototype.generate=function(){return++this.maxCrossTileID};var Tt=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Tt.prototype.handleWrapJump=function(h){var g=Math.round((h-this.lng)/360);if(g!==0)for(var p in this.indexes){var b=this.indexes[p],N={};for(var q in b){var ee=b[q];ee.tileID=ee.tileID.unwrapTo(ee.tileID.wrap+g),N[ee.tileID.key]=ee}this.indexes[p]=N}this.lng=h},Tt.prototype.addBucket=function(h,g,p){if(this.indexes[h.overscaledZ]&&this.indexes[h.overscaledZ][h.key]){if(this.indexes[h.overscaledZ][h.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(h.overscaledZ,this.indexes[h.overscaledZ][h.key])}for(var b=0;b<g.symbolInstances.length;b++)g.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[h.overscaledZ]||(this.usedCrossTileIDs[h.overscaledZ]={});var N=this.usedCrossTileIDs[h.overscaledZ];for(var q in this.indexes){var ee=this.indexes[q];if(Number(q)>h.overscaledZ)for(var ge in ee){var Ue=ee[ge];Ue.tileID.isChildOf(h)&&Ue.findMatches(g.symbolInstances,h,N)}else{var st=ee[h.scaledTo(Number(q)).key];st&&st.findMatches(g.symbolInstances,h,N)}}for(var kt=0;kt<g.symbolInstances.length;kt++){var Lt=g.symbolInstances.get(kt);Lt.crossTileID||(Lt.crossTileID=p.generate(),N[Lt.crossTileID]=!0)}return this.indexes[h.overscaledZ]===void 0&&(this.indexes[h.overscaledZ]={}),this.indexes[h.overscaledZ][h.key]=new He(h,g.symbolInstances,g.bucketInstanceId),!0},Tt.prototype.removeBucketCrossTileIDs=function(h,g){for(var p in g.indexedSymbolInstances)for(var b=0,N=g.indexedSymbolInstances[p];b<N.length;b+=1)delete this.usedCrossTileIDs[h][N[b].crossTileID]},Tt.prototype.removeStaleBuckets=function(h){var g=!1;for(var p in this.indexes){var b=this.indexes[p];for(var N in b)h[b[N].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,b[N]),delete b[N],g=!0)}return g};var Mt=function(){this.layerIndexes={},this.crossTileIDs=new Pe,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Mt.prototype.addLayer=function(h,g,p){var b=this.layerIndexes[h.id];b===void 0&&(b=this.layerIndexes[h.id]=new Tt);var N=!1,q={};b.handleWrapJump(p);for(var ee=0,ge=g;ee<ge.length;ee+=1){var Ue=ge[ee],st=Ue.getBucket(h);st&&h.id===st.layerIds[0]&&(st.bucketInstanceId||(st.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(Ue.tileID,st,this.crossTileIDs)&&(N=!0),q[st.bucketInstanceId]=!0)}return b.removeStaleBuckets(q)&&(N=!0),N},Mt.prototype.pruneUnusedLayers=function(h){var g={};for(var p in h.forEach(function(b){g[b]=!0}),this.layerIndexes)g[p]||delete this.layerIndexes[p]};var $t=function(h,g){return m.emitValidationErrors(h,g&&g.filter(function(p){return p.identifier!=="source.canvas"}))},fr=m.pick(It,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Tr=m.pick(It,["setCenter","setZoom","setBearing","setPitch"]),Sr=function(){var h={},g=m.styleSpec.$version;for(var p in m.styleSpec.$root){var b,N=m.styleSpec.$root[p];N.required&&(b=p==="version"?g:N.type==="array"?[]:{})!=null&&(h[p]=b)}return h}(),sn=function(h){function g(p,b){var N=this;b===void 0&&(b={}),h.call(this),this.map=p,this.dispatcher=new at(Hr(),this),this.imageManager=new me,this.imageManager.setEventedParent(this),this.glyphManager=new ft(p._requestManager,b.localIdeographFontFamily),this.lineAtlas=new Ye(256,512),this.crossTileSymbolIndex=new Mt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new m.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",m.getReferrer());var q=this;this._rtlTextPluginCallback=g.registerForPluginStateChange(function(ee){q.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:ee.pluginStatus,pluginURL:ee.pluginURL},function(ge,Ue){if(m.triggerPluginCompletionEvent(ge),Ue&&Ue.every(function(kt){return kt}))for(var st in q.sourceCaches)q.sourceCaches[st].reload()})}),this.on("data",function(ee){if(ee.dataType==="source"&&ee.sourceDataType==="metadata"){var ge=N.sourceCaches[ee.sourceId];if(ge){var Ue=ge.getSource();if(Ue&&Ue.vectorLayerIds)for(var st in N._layers){var kt=N._layers[st];kt.source===Ue.id&&N._validateLayer(kt)}}}})}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.loadURL=function(p,b){var N=this;b===void 0&&(b={}),this.fire(new m.Event("dataloading",{dataType:"style"}));var q=typeof b.validate=="boolean"?b.validate:!m.isMapboxURL(p);p=this.map._requestManager.normalizeStyleURL(p,b.accessToken);var ee=this.map._requestManager.transformRequest(p,m.ResourceType.Style);this._request=m.getJSON(ee,function(ge,Ue){N._request=null,ge?N.fire(new m.ErrorEvent(ge)):Ue&&N._load(Ue,q)})},g.prototype.loadJSON=function(p,b){var N=this;b===void 0&&(b={}),this.fire(new m.Event("dataloading",{dataType:"style"})),this._request=m.browser.frame(function(){N._request=null,N._load(p,b.validate!==!1)})},g.prototype.loadEmpty=function(){this.fire(new m.Event("dataloading",{dataType:"style"})),this._load(Sr,!1)},g.prototype._load=function(p,b){if(!b||!$t(this,m.validateStyle(p))){for(var N in this._loaded=!0,this.stylesheet=p,p.sources)this.addSource(N,p.sources[N],{validate:!1});p.sprite?this._loadSprite(p.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(p.glyphs);var q=vi(this.stylesheet.layers);this._order=q.map(function(st){return st.id}),this._layers={},this._serializedLayers={};for(var ee=0,ge=q;ee<ge.length;ee+=1){var Ue=ge[ee];(Ue=m.createStyleLayer(Ue)).setEventedParent(this,{layer:{id:Ue.id}}),this._layers[Ue.id]=Ue,this._serializedLayers[Ue.id]=Ue.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Re(this.stylesheet.light),this.fire(new m.Event("data",{dataType:"style"})),this.fire(new m.Event("style.load"))}},g.prototype._loadSprite=function(p){var b=this;this._spriteRequest=function(N,q,ee){var ge,Ue,st,kt=m.browser.devicePixelRatio>1?"@2x":"",Lt=m.getJSON(q.transformRequest(q.normalizeSpriteURL(N,kt,".json"),m.ResourceType.SpriteJSON),function(pr,Nr){Lt=null,st||(st=pr,ge=Nr,vr())}),Zt=m.getImage(q.transformRequest(q.normalizeSpriteURL(N,kt,".png"),m.ResourceType.SpriteImage),function(pr,Nr){Zt=null,st||(st=pr,Ue=Nr,vr())});function vr(){if(st)ee(st);else if(ge&&Ue){var pr=m.browser.getImageData(Ue),Nr={};for(var cr in ge){var zr=ge[cr],Ur=zr.width,Tn=zr.height,ti=zr.x,Yn=zr.y,ai=zr.sdf,Pi=zr.pixelRatio,va=zr.stretchX,na=zr.stretchY,Ua=zr.content,co=new m.RGBAImage({width:Ur,height:Tn});m.RGBAImage.copy(pr,co,{x:ti,y:Yn},{x:0,y:0},{width:Ur,height:Tn}),Nr[cr]={data:co,pixelRatio:Pi,sdf:ai,stretchX:va,stretchY:na,content:Ua}}ee(null,Nr)}}return{cancel:function(){Lt&&(Lt.cancel(),Lt=null),Zt&&(Zt.cancel(),Zt=null)}}}(p,this.map._requestManager,function(N,q){if(b._spriteRequest=null,N)b.fire(new m.ErrorEvent(N));else if(q)for(var ee in q)b.imageManager.addImage(ee,q[ee]);b.imageManager.setLoaded(!0),b._availableImages=b.imageManager.listImages(),b.dispatcher.broadcast("setImages",b._availableImages),b.fire(new m.Event("data",{dataType:"style"}))})},g.prototype._validateLayer=function(p){var b=this.sourceCaches[p.source];if(b){var N=p.sourceLayer;if(N){var q=b.getSource();(q.type==="geojson"||q.vectorLayerIds&&q.vectorLayerIds.indexOf(N)===-1)&&this.fire(new m.ErrorEvent(new Error('Source layer "'+N+'" does not exist on source "'+q.id+'" as specified by style layer "'+p.id+'"')))}}},g.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var p in this.sourceCaches)if(!this.sourceCaches[p].loaded())return!1;return!!this.imageManager.isLoaded()},g.prototype._serializeLayers=function(p){for(var b=[],N=0,q=p;N<q.length;N+=1){var ee=this._layers[q[N]];ee.type!=="custom"&&b.push(ee.serialize())}return b},g.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var p in this.sourceCaches)if(this.sourceCaches[p].hasTransition())return!0;for(var b in this._layers)if(this._layers[b].hasTransition())return!0;return!1},g.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},g.prototype.update=function(p){if(this._loaded){var b=this._changed;if(this._changed){var N=Object.keys(this._updatedLayers),q=Object.keys(this._removedLayers);for(var ee in(N.length||q.length)&&this._updateWorkerLayers(N,q),this._updatedSources){var ge=this._updatedSources[ee];ge==="reload"?this._reloadSource(ee):ge==="clear"&&this._clearSource(ee)}for(var Ue in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Ue].updateTransitions(p);this.light.updateTransitions(p),this._resetUpdates()}var st={};for(var kt in this.sourceCaches){var Lt=this.sourceCaches[kt];st[kt]=Lt.used,Lt.used=!1}for(var Zt=0,vr=this._order;Zt<vr.length;Zt+=1){var pr=this._layers[vr[Zt]];pr.recalculate(p,this._availableImages),!pr.isHidden(p.zoom)&&pr.source&&(this.sourceCaches[pr.source].used=!0)}for(var Nr in st){var cr=this.sourceCaches[Nr];st[Nr]!==cr.used&&cr.fire(new m.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Nr}))}this.light.recalculate(p),this.z=p.zoom,b&&this.fire(new m.Event("data",{dataType:"style"}))}},g.prototype._updateTilesForChangedImages=function(){var p=Object.keys(this._changedImages);if(p.length){for(var b in this.sourceCaches)this.sourceCaches[b].reloadTilesForDependencies(["icons","patterns"],p);this._changedImages={}}},g.prototype._updateWorkerLayers=function(p,b){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(p),removedIds:b})},g.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},g.prototype.setState=function(p){var b=this;if(this._checkLoaded(),$t(this,m.validateStyle(p)))return!1;(p=m.clone$1(p)).layers=vi(p.layers);var N=function(ee,ge){if(!ee)return[{command:It.setStyle,args:[ge]}];var Ue=[];try{if(!m.deepEqual(ee.version,ge.version))return[{command:It.setStyle,args:[ge]}];m.deepEqual(ee.center,ge.center)||Ue.push({command:It.setCenter,args:[ge.center]}),m.deepEqual(ee.zoom,ge.zoom)||Ue.push({command:It.setZoom,args:[ge.zoom]}),m.deepEqual(ee.bearing,ge.bearing)||Ue.push({command:It.setBearing,args:[ge.bearing]}),m.deepEqual(ee.pitch,ge.pitch)||Ue.push({command:It.setPitch,args:[ge.pitch]}),m.deepEqual(ee.sprite,ge.sprite)||Ue.push({command:It.setSprite,args:[ge.sprite]}),m.deepEqual(ee.glyphs,ge.glyphs)||Ue.push({command:It.setGlyphs,args:[ge.glyphs]}),m.deepEqual(ee.transition,ge.transition)||Ue.push({command:It.setTransition,args:[ge.transition]}),m.deepEqual(ee.light,ge.light)||Ue.push({command:It.setLight,args:[ge.light]});var st={},kt=[];(function(Zt,vr,pr,Nr){var cr;for(cr in vr=vr||{},Zt=Zt||{})Zt.hasOwnProperty(cr)&&(vr.hasOwnProperty(cr)||Dr(cr,pr,Nr));for(cr in vr)vr.hasOwnProperty(cr)&&(Zt.hasOwnProperty(cr)?m.deepEqual(Zt[cr],vr[cr])||(Zt[cr].type==="geojson"&&vr[cr].type==="geojson"&&Kt(Zt,vr,cr)?pr.push({command:It.setGeoJSONSourceData,args:[cr,vr[cr].data]}):Jn(cr,vr,pr,Nr)):Yr(cr,vr,pr))})(ee.sources,ge.sources,kt,st);var Lt=[];ee.layers&&ee.layers.forEach(function(Zt){st[Zt.source]?Ue.push({command:It.removeLayer,args:[Zt.id]}):Lt.push(Zt)}),Ue=Ue.concat(kt),function(Zt,vr,pr){vr=vr||[];var Nr,cr,zr,Ur,Tn,ti,Yn,ai=(Zt=Zt||[]).map(Fr),Pi=vr.map(Fr),va=Zt.reduce(qr,{}),na=vr.reduce(qr,{}),Ua=ai.slice(),co=Object.create(null);for(Nr=0,cr=0;Nr<ai.length;Nr++)na.hasOwnProperty(zr=ai[Nr])?cr++:(pr.push({command:It.removeLayer,args:[zr]}),Ua.splice(Ua.indexOf(zr,cr),1));for(Nr=0,cr=0;Nr<Pi.length;Nr++)Ua[Ua.length-1-Nr]!==(zr=Pi[Pi.length-1-Nr])&&(va.hasOwnProperty(zr)?(pr.push({command:It.removeLayer,args:[zr]}),Ua.splice(Ua.lastIndexOf(zr,Ua.length-cr),1)):cr++,pr.push({command:It.addLayer,args:[na[zr],ti=Ua[Ua.length-Nr]]}),Ua.splice(Ua.length-Nr,0,zr),co[zr]=!0);for(Nr=0;Nr<Pi.length;Nr++)if(Ur=va[zr=Pi[Nr]],Tn=na[zr],!co[zr]&&!m.deepEqual(Ur,Tn))if(m.deepEqual(Ur.source,Tn.source)&&m.deepEqual(Ur["source-layer"],Tn["source-layer"])&&m.deepEqual(Ur.type,Tn.type)){for(Yn in hr(Ur.layout,Tn.layout,pr,zr,null,It.setLayoutProperty),hr(Ur.paint,Tn.paint,pr,zr,null,It.setPaintProperty),m.deepEqual(Ur.filter,Tn.filter)||pr.push({command:It.setFilter,args:[zr,Tn.filter]}),m.deepEqual(Ur.minzoom,Tn.minzoom)&&m.deepEqual(Ur.maxzoom,Tn.maxzoom)||pr.push({command:It.setLayerZoomRange,args:[zr,Tn.minzoom,Tn.maxzoom]}),Ur)Ur.hasOwnProperty(Yn)&&Yn!=="layout"&&Yn!=="paint"&&Yn!=="filter"&&Yn!=="metadata"&&Yn!=="minzoom"&&Yn!=="maxzoom"&&(Yn.indexOf("paint.")===0?hr(Ur[Yn],Tn[Yn],pr,zr,Yn.slice(6),It.setPaintProperty):m.deepEqual(Ur[Yn],Tn[Yn])||pr.push({command:It.setLayerProperty,args:[zr,Yn,Tn[Yn]]}));for(Yn in Tn)Tn.hasOwnProperty(Yn)&&!Ur.hasOwnProperty(Yn)&&Yn!=="layout"&&Yn!=="paint"&&Yn!=="filter"&&Yn!=="metadata"&&Yn!=="minzoom"&&Yn!=="maxzoom"&&(Yn.indexOf("paint.")===0?hr(Ur[Yn],Tn[Yn],pr,zr,Yn.slice(6),It.setPaintProperty):m.deepEqual(Ur[Yn],Tn[Yn])||pr.push({command:It.setLayerProperty,args:[zr,Yn,Tn[Yn]]}))}else pr.push({command:It.removeLayer,args:[zr]}),ti=Ua[Ua.lastIndexOf(zr)+1],pr.push({command:It.addLayer,args:[Tn,ti]})}(Lt,ge.layers,Ue)}catch(Zt){console.warn("Unable to compute style diff:",Zt),Ue=[{command:It.setStyle,args:[ge]}]}return Ue}(this.serialize(),p).filter(function(ee){return!(ee.command in Tr)});if(N.length===0)return!1;var q=N.filter(function(ee){return!(ee.command in fr)});if(q.length>0)throw new Error("Unimplemented: "+q.map(function(ee){return ee.command}).join(", ")+".");return N.forEach(function(ee){ee.command!=="setTransition"&&b[ee.command].apply(b,ee.args)}),this.stylesheet=p,!0},g.prototype.addImage=function(p,b){if(this.getImage(p))return this.fire(new m.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(p,b),this._afterImageUpdated(p)},g.prototype.updateImage=function(p,b){this.imageManager.updateImage(p,b)},g.prototype.getImage=function(p){return this.imageManager.getImage(p)},g.prototype.removeImage=function(p){if(!this.getImage(p))return this.fire(new m.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(p),this._afterImageUpdated(p)},g.prototype._afterImageUpdated=function(p){this._availableImages=this.imageManager.listImages(),this._changedImages[p]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new m.Event("data",{dataType:"style"}))},g.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},g.prototype.addSource=function(p,b,N){var q=this;if(N===void 0&&(N={}),this._checkLoaded(),this.sourceCaches[p]!==void 0)throw new Error("There is already a source with this ID");if(!b.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(b).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(b.type)>=0&&this._validate(m.validateStyle.source,"sources."+p,b,null,N))){this.map&&this.map._collectResourceTiming&&(b.collectResourceTiming=!0);var ee=this.sourceCaches[p]=new At(p,b,this.dispatcher);ee.style=this,ee.setEventedParent(this,function(){return{isSourceLoaded:q.loaded(),source:ee.serialize(),sourceId:p}}),ee.onAdd(this.map),this._changed=!0}},g.prototype.removeSource=function(p){if(this._checkLoaded(),this.sourceCaches[p]===void 0)throw new Error("There is no source with this ID");for(var b in this._layers)if(this._layers[b].source===p)return this.fire(new m.ErrorEvent(new Error('Source "'+p+'" cannot be removed while layer "'+b+'" is using it.')));var N=this.sourceCaches[p];delete this.sourceCaches[p],delete this._updatedSources[p],N.fire(new m.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:p})),N.setEventedParent(null),N.clearTiles(),N.onRemove&&N.onRemove(this.map),this._changed=!0},g.prototype.setGeoJSONSourceData=function(p,b){this._checkLoaded(),this.sourceCaches[p].getSource().setData(b),this._changed=!0},g.prototype.getSource=function(p){return this.sourceCaches[p]&&this.sourceCaches[p].getSource()},g.prototype.addLayer=function(p,b,N){N===void 0&&(N={}),this._checkLoaded();var q=p.id;if(this.getLayer(q))this.fire(new m.ErrorEvent(new Error('Layer with id "'+q+'" already exists on this map')));else{var ee;if(p.type==="custom"){if($t(this,m.validateCustomStyleLayer(p)))return;ee=m.createStyleLayer(p)}else{if(typeof p.source=="object"&&(this.addSource(q,p.source),p=m.clone$1(p),p=m.extend(p,{source:q})),this._validate(m.validateStyle.layer,"layers."+q,p,{arrayIndex:-1},N))return;ee=m.createStyleLayer(p),this._validateLayer(ee),ee.setEventedParent(this,{layer:{id:q}}),this._serializedLayers[ee.id]=ee.serialize()}var ge=b?this._order.indexOf(b):this._order.length;if(b&&ge===-1)this.fire(new m.ErrorEvent(new Error('Layer with id "'+b+'" does not exist on this map.')));else{if(this._order.splice(ge,0,q),this._layerOrderChanged=!0,this._layers[q]=ee,this._removedLayers[q]&&ee.source&&ee.type!=="custom"){var Ue=this._removedLayers[q];delete this._removedLayers[q],Ue.type!==ee.type?this._updatedSources[ee.source]="clear":(this._updatedSources[ee.source]="reload",this.sourceCaches[ee.source].pause())}this._updateLayer(ee),ee.onAdd&&ee.onAdd(this.map)}}},g.prototype.moveLayer=function(p,b){if(this._checkLoaded(),this._changed=!0,this._layers[p]){if(p!==b){var N=this._order.indexOf(p);this._order.splice(N,1);var q=b?this._order.indexOf(b):this._order.length;b&&q===-1?this.fire(new m.ErrorEvent(new Error('Layer with id "'+b+'" does not exist on this map.'))):(this._order.splice(q,0,p),this._layerOrderChanged=!0)}}else this.fire(new m.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be moved.")))},g.prototype.removeLayer=function(p){this._checkLoaded();var b=this._layers[p];if(b){b.setEventedParent(null);var N=this._order.indexOf(p);this._order.splice(N,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[p]=b,delete this._layers[p],delete this._serializedLayers[p],delete this._updatedLayers[p],delete this._updatedPaintProps[p],b.onRemove&&b.onRemove(this.map)}else this.fire(new m.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be removed.")))},g.prototype.getLayer=function(p){return this._layers[p]},g.prototype.hasLayer=function(p){return p in this._layers},g.prototype.setLayerZoomRange=function(p,b,N){this._checkLoaded();var q=this.getLayer(p);q?q.minzoom===b&&q.maxzoom===N||(b!=null&&(q.minzoom=b),N!=null&&(q.maxzoom=N),this._updateLayer(q)):this.fire(new m.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot have zoom extent.")))},g.prototype.setFilter=function(p,b,N){N===void 0&&(N={}),this._checkLoaded();var q=this.getLayer(p);if(q){if(!m.deepEqual(q.filter,b))return b==null?(q.filter=void 0,void this._updateLayer(q)):void(this._validate(m.validateStyle.filter,"layers."+q.id+".filter",b,null,N)||(q.filter=m.clone$1(b),this._updateLayer(q)))}else this.fire(new m.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be filtered.")))},g.prototype.getFilter=function(p){return m.clone$1(this.getLayer(p).filter)},g.prototype.setLayoutProperty=function(p,b,N,q){q===void 0&&(q={}),this._checkLoaded();var ee=this.getLayer(p);ee?m.deepEqual(ee.getLayoutProperty(b),N)||(ee.setLayoutProperty(b,N,q),this._updateLayer(ee)):this.fire(new m.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be styled.")))},g.prototype.getLayoutProperty=function(p,b){var N=this.getLayer(p);if(N)return N.getLayoutProperty(b);this.fire(new m.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style.")))},g.prototype.setPaintProperty=function(p,b,N,q){q===void 0&&(q={}),this._checkLoaded();var ee=this.getLayer(p);ee?m.deepEqual(ee.getPaintProperty(b),N)||(ee.setPaintProperty(b,N,q)&&this._updateLayer(ee),this._changed=!0,this._updatedPaintProps[p]=!0):this.fire(new m.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be styled.")))},g.prototype.getPaintProperty=function(p,b){return this.getLayer(p).getPaintProperty(b)},g.prototype.setFeatureState=function(p,b){this._checkLoaded();var N=p.source,q=p.sourceLayer,ee=this.sourceCaches[N];if(ee!==void 0){var ge=ee.getSource().type;ge==="geojson"&&q?this.fire(new m.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ge!=="vector"||q?(p.id===void 0&&this.fire(new m.ErrorEvent(new Error("The feature id parameter must be provided."))),ee.setFeatureState(q,p.id,b)):this.fire(new m.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new m.ErrorEvent(new Error("The source '"+N+"' does not exist in the map's style.")))},g.prototype.removeFeatureState=function(p,b){this._checkLoaded();var N=p.source,q=this.sourceCaches[N];if(q!==void 0){var ee=q.getSource().type,ge=ee==="vector"?p.sourceLayer:void 0;ee!=="vector"||ge?b&&typeof p.id!="string"&&typeof p.id!="number"?this.fire(new m.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):q.removeFeatureState(ge,p.id,b):this.fire(new m.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new m.ErrorEvent(new Error("The source '"+N+"' does not exist in the map's style.")))},g.prototype.getFeatureState=function(p){this._checkLoaded();var b=p.source,N=p.sourceLayer,q=this.sourceCaches[b];if(q!==void 0){if(q.getSource().type!=="vector"||N)return p.id===void 0&&this.fire(new m.ErrorEvent(new Error("The feature id parameter must be provided."))),q.getFeatureState(N,p.id);this.fire(new m.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new m.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},g.prototype.getTransition=function(){return m.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},g.prototype.serialize=function(){return m.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:m.mapObject(this.sourceCaches,function(p){return p.serialize()}),layers:this._serializeLayers(this._order)},function(p){return p!==void 0})},g.prototype._updateLayer=function(p){this._updatedLayers[p.id]=!0,p.source&&!this._updatedSources[p.source]&&this.sourceCaches[p.source].getSource().type!=="raster"&&(this._updatedSources[p.source]="reload",this.sourceCaches[p.source].pause()),this._changed=!0},g.prototype._flattenAndSortRenderedFeatures=function(p){for(var b=this,N=function(va){return b._layers[va].type==="fill-extrusion"},q={},ee=[],ge=this._order.length-1;ge>=0;ge--){var Ue=this._order[ge];if(N(Ue)){q[Ue]=ge;for(var st=0,kt=p;st<kt.length;st+=1){var Lt=kt[st][Ue];if(Lt)for(var Zt=0,vr=Lt;Zt<vr.length;Zt+=1)ee.push(vr[Zt])}}}ee.sort(function(va,na){return na.intersectionZ-va.intersectionZ});for(var pr=[],Nr=this._order.length-1;Nr>=0;Nr--){var cr=this._order[Nr];if(N(cr))for(var zr=ee.length-1;zr>=0;zr--){var Ur=ee[zr].feature;if(q[Ur.layer.id]<Nr)break;pr.push(Ur),ee.pop()}else for(var Tn=0,ti=p;Tn<ti.length;Tn+=1){var Yn=ti[Tn][cr];if(Yn)for(var ai=0,Pi=Yn;ai<Pi.length;ai+=1)pr.push(Pi[ai].feature)}}return pr},g.prototype.queryRenderedFeatures=function(p,b,N){b&&b.filter&&this._validate(m.validateStyle.filter,"queryRenderedFeatures.filter",b.filter,null,b);var q={};if(b&&b.layers){if(!Array.isArray(b.layers))return this.fire(new m.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var ee=0,ge=b.layers;ee<ge.length;ee+=1){var Ue=ge[ee],st=this._layers[Ue];if(!st)return this.fire(new m.ErrorEvent(new Error("The layer '"+Ue+"' does not exist in the map's style and cannot be queried for features."))),[];q[st.source]=!0}}var kt=[];for(var Lt in b.availableImages=this._availableImages,this.sourceCaches)b.layers&&!q[Lt]||kt.push(hn(this.sourceCaches[Lt],this._layers,this._serializedLayers,p,b,N));return this.placement&&kt.push(function(Zt,vr,pr,Nr,cr,zr,Ur){for(var Tn={},ti=zr.queryRenderedSymbols(Nr),Yn=[],ai=0,Pi=Object.keys(ti).map(Number);ai<Pi.length;ai+=1)Yn.push(Ur[Pi[ai]]);Yn.sort(gi);for(var va=function(){var ho=Ua[na],qo=ho.featureIndex.lookupSymbolFeatures(ti[ho.bucketInstanceId],vr,ho.bucketIndex,ho.sourceLayerIndex,cr.filter,cr.layers,cr.availableImages,Zt);for(var ga in qo){var Zo=Tn[ga]=Tn[ga]||[],Uo=qo[ga];Uo.sort(function(us,ko){var Io=ho.featureSortOrder;if(Io){var El=Io.indexOf(us.featureIndex);return Io.indexOf(ko.featureIndex)-El}return ko.featureIndex-us.featureIndex});for(var Do=0,po=Uo;Do<po.length;Do+=1)Zo.push(po[Do])}},na=0,Ua=Yn;na<Ua.length;na+=1)va();var co=function(ho){Tn[ho].forEach(function(qo){var ga=qo.feature,Zo=pr[Zt[ho].source].getFeatureState(ga.layer["source-layer"],ga.id);ga.source=ga.layer.source,ga.layer["source-layer"]&&(ga.sourceLayer=ga.layer["source-layer"]),ga.state=Zo})};for(var Eo in Tn)co(Eo);return Tn}(this._layers,this._serializedLayers,this.sourceCaches,p,b,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(kt)},g.prototype.querySourceFeatures=function(p,b){b&&b.filter&&this._validate(m.validateStyle.filter,"querySourceFeatures.filter",b.filter,null,b);var N=this.sourceCaches[p];return N?function(q,ee){for(var ge=q.getRenderableIds().map(function(vr){return q.getTileByID(vr)}),Ue=[],st={},kt=0;kt<ge.length;kt++){var Lt=ge[kt],Zt=Lt.tileID.canonical.key;st[Zt]||(st[Zt]=!0,Lt.querySourceFeatures(Ue,ee))}return Ue}(N,b):[]},g.prototype.addSourceType=function(p,b,N){return g.getSourceType(p)?N(new Error('A source type called "'+p+'" already exists.')):(g.setSourceType(p,b),b.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:p,url:b.workerSourceURL},N):N(null,null))},g.prototype.getLight=function(){return this.light.getLight()},g.prototype.setLight=function(p,b){b===void 0&&(b={}),this._checkLoaded();var N=this.light.getLight(),q=!1;for(var ee in p)if(!m.deepEqual(p[ee],N[ee])){q=!0;break}if(q){var ge={now:m.browser.now(),transition:m.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(p,b),this.light.updateTransitions(ge)}},g.prototype._validate=function(p,b,N,q,ee){return ee===void 0&&(ee={}),(!ee||ee.validate!==!1)&&$t(this,p.call(m.validateStyle,m.extend({key:b,style:this.serialize(),value:N,styleSpec:m.styleSpec},q)))},g.prototype._remove=function(){for(var p in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),m.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[p].setEventedParent(null);for(var b in this.sourceCaches)this.sourceCaches[b].clearTiles(),this.sourceCaches[b].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},g.prototype._clearSource=function(p){this.sourceCaches[p].clearTiles()},g.prototype._reloadSource=function(p){this.sourceCaches[p].resume(),this.sourceCaches[p].reload()},g.prototype._updateSources=function(p){for(var b in this.sourceCaches)this.sourceCaches[b].update(p)},g.prototype._generateCollisionBoxes=function(){for(var p in this.sourceCaches)this._reloadSource(p)},g.prototype._updatePlacement=function(p,b,N,q,ee){ee===void 0&&(ee=!1);for(var ge=!1,Ue=!1,st={},kt=0,Lt=this._order;kt<Lt.length;kt+=1){var Zt=this._layers[Lt[kt]];if(Zt.type==="symbol"){if(!st[Zt.source]){var vr=this.sourceCaches[Zt.source];st[Zt.source]=vr.getRenderableIds(!0).map(function(Ur){return vr.getTileByID(Ur)}).sort(function(Ur,Tn){return Tn.tileID.overscaledZ-Ur.tileID.overscaledZ||(Ur.tileID.isLessThan(Tn.tileID)?-1:1)})}var pr=this.crossTileSymbolIndex.addLayer(Zt,st[Zt.source],p.center.lng);ge=ge||pr}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((ee=ee||this._layerOrderChanged||N===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(m.browser.now(),p.zoom))&&(this.pauseablePlacement=new Me(p,this._order,ee,b,N,q,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,st),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(m.browser.now()),Ue=!0),ge&&this.pauseablePlacement.placement.setStale()),Ue||ge)for(var Nr=0,cr=this._order;Nr<cr.length;Nr+=1){var zr=this._layers[cr[Nr]];zr.type==="symbol"&&this.placement.updateLayerOpacities(zr,st[zr.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(m.browser.now())},g.prototype._releaseSymbolFadeTiles=function(){for(var p in this.sourceCaches)this.sourceCaches[p].releaseSymbolFadeTiles()},g.prototype.getImages=function(p,b,N){this.imageManager.getImages(b.icons,N),this._updateTilesForChangedImages();var q=this.sourceCaches[b.source];q&&q.setDependencies(b.tileID.key,b.type,b.icons)},g.prototype.getGlyphs=function(p,b,N){this.glyphManager.getGlyphs(b.stacks,N)},g.prototype.getResource=function(p,b,N){return m.makeRequest(b,N)},g}(m.Evented);sn.getSourceType=function(h){return Vt[h]},sn.setSourceType=function(h,g){Vt[h]=g},sn.registerForPluginStateChange=m.registerForPluginStateChange;var lt=m.createLayout([{name:"a_pos",type:"Int16",components:2}]),Xt=to(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),nr=to(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ur=to(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Vr=to(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),ln=to("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Un=to(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Gn=to(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),qn=to("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),oi=to("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),T=to("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),H=to(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),_e=to(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ne=to(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),$e=to(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),xt=to(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),zt=to(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),_r=to(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),xr=to(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),dn=to(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Bn=to(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),zi=to(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Vi=to(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Ei=to(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),qa=to(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),$a=to(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),La=to(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function to(h,g){var p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=g.match(/attribute ([\w]+) ([\w]+)/g),N=h.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),q=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),ee=q?q.concat(N):N,ge={};return{fragmentSource:h=h.replace(p,function(Ue,st,kt,Lt,Zt){return ge[Zt]=!0,st==="define"?`
#ifndef HAS_UNIFORM_u_`+Zt+`
varying `+kt+" "+Lt+" "+Zt+`;
#else
uniform `+kt+" "+Lt+" u_"+Zt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Zt+`
    `+kt+" "+Lt+" "+Zt+" = u_"+Zt+`;
#endif
`}),vertexSource:g=g.replace(p,function(Ue,st,kt,Lt,Zt){var vr=Lt==="float"?"vec2":"vec4",pr=Zt.match(/color/)?"color":vr;return ge[Zt]?st==="define"?`
#ifndef HAS_UNIFORM_u_`+Zt+`
uniform lowp float u_`+Zt+`_t;
attribute `+kt+" "+vr+" a_"+Zt+`;
varying `+kt+" "+Lt+" "+Zt+`;
#else
uniform `+kt+" "+Lt+" u_"+Zt+`;
#endif
`:pr==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Zt+`
    `+Zt+" = a_"+Zt+`;
#else
    `+kt+" "+Lt+" "+Zt+" = u_"+Zt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Zt+`
    `+Zt+" = unpack_mix_"+pr+"(a_"+Zt+", u_"+Zt+`_t);
#else
    `+kt+" "+Lt+" "+Zt+" = u_"+Zt+`;
#endif
`:st==="define"?`
#ifndef HAS_UNIFORM_u_`+Zt+`
uniform lowp float u_`+Zt+`_t;
attribute `+kt+" "+vr+" a_"+Zt+`;
#else
uniform `+kt+" "+Lt+" u_"+Zt+`;
#endif
`:pr==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Zt+`
    `+kt+" "+Lt+" "+Zt+" = a_"+Zt+`;
#else
    `+kt+" "+Lt+" "+Zt+" = u_"+Zt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Zt+`
    `+kt+" "+Lt+" "+Zt+" = unpack_mix_"+pr+"(a_"+Zt+", u_"+Zt+`_t);
#else
    `+kt+" "+Lt+" "+Zt+" = u_"+Zt+`;
#endif
`}),staticAttributes:b,staticUniforms:ee}}var Ho=Object.freeze({__proto__:null,prelude:Xt,background:nr,backgroundPattern:ur,circle:Vr,clippingMask:ln,heatmap:Un,heatmapTexture:Gn,collisionBox:qn,collisionCircle:oi,debug:T,fill:H,fillOutline:_e,fillOutlinePattern:ne,fillPattern:$e,fillExtrusion:xt,fillExtrusionPattern:zt,hillshadePrepare:_r,hillshade:xr,line:dn,lineGradient:Bn,linePattern:zi,lineSDF:Vi,raster:Ei,symbolIcon:qa,symbolSDF:$a,symbolTextAndIcon:La}),xo=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function bo(h){for(var g=[],p=0;p<h.length;p++)if(h[p]!==null){var b=h[p].split(" ");g.push(b.pop())}return g}xo.prototype.bind=function(h,g,p,b,N,q,ee,ge){this.context=h;for(var Ue=this.boundPaintVertexBuffers.length!==b.length,st=0;!Ue&&st<b.length;st++)this.boundPaintVertexBuffers[st]!==b[st]&&(Ue=!0);h.extVertexArrayObject&&this.vao&&this.boundProgram===g&&this.boundLayoutVertexBuffer===p&&!Ue&&this.boundIndexBuffer===N&&this.boundVertexOffset===q&&this.boundDynamicVertexBuffer===ee&&this.boundDynamicVertexBuffer2===ge?(h.bindVertexArrayOES.set(this.vao),ee&&ee.bind(),N&&N.dynamicDraw&&N.bind(),ge&&ge.bind()):this.freshBind(g,p,b,N,q,ee,ge)},xo.prototype.freshBind=function(h,g,p,b,N,q,ee){var ge,Ue=h.numAttributes,st=this.context,kt=st.gl;if(st.extVertexArrayObject)this.vao&&this.destroy(),this.vao=st.extVertexArrayObject.createVertexArrayOES(),st.bindVertexArrayOES.set(this.vao),ge=0,this.boundProgram=h,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=b,this.boundVertexOffset=N,this.boundDynamicVertexBuffer=q,this.boundDynamicVertexBuffer2=ee;else{ge=st.currentNumAttributes||0;for(var Lt=Ue;Lt<ge;Lt++)kt.disableVertexAttribArray(Lt)}g.enableAttributes(kt,h);for(var Zt=0,vr=p;Zt<vr.length;Zt+=1)vr[Zt].enableAttributes(kt,h);q&&q.enableAttributes(kt,h),ee&&ee.enableAttributes(kt,h),g.bind(),g.setVertexAttribPointers(kt,h,N);for(var pr=0,Nr=p;pr<Nr.length;pr+=1){var cr=Nr[pr];cr.bind(),cr.setVertexAttribPointers(kt,h,N)}q&&(q.bind(),q.setVertexAttribPointers(kt,h,N)),b&&b.bind(),ee&&(ee.bind(),ee.setVertexAttribPointers(kt,h,N)),st.currentNumAttributes=Ue},xo.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var so=function(h,g,p,b,N,q){var ee=h.gl;this.program=ee.createProgram();for(var ge=bo(p.staticAttributes),Ue=b?b.getBinderAttributes():[],st=ge.concat(Ue),kt=p.staticUniforms?bo(p.staticUniforms):[],Lt=b?b.getBinderUniforms():[],Zt=[],vr=0,pr=kt.concat(Lt);vr<pr.length;vr+=1){var Nr=pr[vr];Zt.indexOf(Nr)<0&&Zt.push(Nr)}var cr=b?b.defines():[];q&&cr.push("#define OVERDRAW_INSPECTOR;");var zr=cr.concat(Xt.fragmentSource,p.fragmentSource).join(`
`),Ur=cr.concat(Xt.vertexSource,p.vertexSource).join(`
`),Tn=ee.createShader(ee.FRAGMENT_SHADER);if(ee.isContextLost())this.failedToCreate=!0;else{ee.shaderSource(Tn,zr),ee.compileShader(Tn),ee.attachShader(this.program,Tn);var ti=ee.createShader(ee.VERTEX_SHADER);if(ee.isContextLost())this.failedToCreate=!0;else{ee.shaderSource(ti,Ur),ee.compileShader(ti),ee.attachShader(this.program,ti),this.attributes={};var Yn={};this.numAttributes=st.length;for(var ai=0;ai<this.numAttributes;ai++)st[ai]&&(ee.bindAttribLocation(this.program,ai,st[ai]),this.attributes[st[ai]]=ai);ee.linkProgram(this.program),ee.deleteShader(ti),ee.deleteShader(Tn);for(var Pi=0;Pi<Zt.length;Pi++){var va=Zt[Pi];if(va&&!Yn[va]){var na=ee.getUniformLocation(this.program,va);na&&(Yn[va]=na)}}this.fixedUniforms=N(h,Yn),this.binderUniforms=b?b.getUniforms(h,Yn):[]}}};function Cs(h,g,p){var b=1/_o(p,1,g.transform.tileZoom),N=Math.pow(2,p.tileID.overscaledZ),q=p.tileSize*Math.pow(2,g.transform.tileZoom)/N,ee=q*(p.tileID.canonical.x+p.tileID.wrap*N),ge=q*p.tileID.canonical.y;return{u_image:0,u_texsize:p.imageAtlasTexture.size,u_scale:[b,h.fromScale,h.toScale],u_fade:h.t,u_pixel_coord_upper:[ee>>16,ge>>16],u_pixel_coord_lower:[65535&ee,65535&ge]}}so.prototype.draw=function(h,g,p,b,N,q,ee,ge,Ue,st,kt,Lt,Zt,vr,pr,Nr){var cr,zr=h.gl;if(!this.failedToCreate){for(var Ur in h.program.set(this.program),h.setDepthMode(p),h.setStencilMode(b),h.setColorMode(N),h.setCullFace(q),this.fixedUniforms)this.fixedUniforms[Ur].set(ee[Ur]);vr&&vr.setUniforms(h,this.binderUniforms,Lt,{zoom:Zt});for(var Tn=(cr={},cr[zr.LINES]=2,cr[zr.TRIANGLES]=3,cr[zr.LINE_STRIP]=1,cr)[g],ti=0,Yn=kt.get();ti<Yn.length;ti+=1){var ai=Yn[ti],Pi=ai.vaos||(ai.vaos={});(Pi[ge]||(Pi[ge]=new xo)).bind(h,this,Ue,vr?vr.getPaintVertexBuffers():[],st,ai.vertexOffset,pr,Nr),zr.drawElements(g,ai.primitiveLength*Tn,zr.UNSIGNED_SHORT,ai.primitiveOffset*Tn*2)}}};var Ls=function(h,g,p,b){var N=g.style.light,q=N.properties.get("position"),ee=[q.x,q.y,q.z],ge=m.create$1();N.properties.get("anchor")==="viewport"&&m.fromRotation(ge,-g.transform.angle),m.transformMat3(ee,ee,ge);var Ue=N.properties.get("color");return{u_matrix:h,u_lightpos:ee,u_lightintensity:N.properties.get("intensity"),u_lightcolor:[Ue.r,Ue.g,Ue.b],u_vertical_gradient:+p,u_opacity:b}},Rs=function(h,g,p,b,N,q,ee){return m.extend(Ls(h,g,p,b),Cs(q,g,ee),{u_height_factor:-Math.pow(2,N.overscaledZ)/ee.tileSize/8})},lu=function(h){return{u_matrix:h}},ps=function(h,g,p,b){return m.extend(lu(h),Cs(p,g,b))},Go=function(h,g){return{u_matrix:h,u_world:g}},zu=function(h,g,p,b,N){return m.extend(ps(h,g,p,b),{u_world:N})},al=function(h,g,p,b){var N,q,ee=h.transform;if(b.paint.get("circle-pitch-alignment")==="map"){var ge=_o(p,1,ee.zoom);N=!0,q=[ge,ge]}else N=!1,q=ee.pixelsToGLUnits;return{u_camera_to_center_distance:ee.cameraToCenterDistance,u_scale_with_map:+(b.paint.get("circle-pitch-scale")==="map"),u_matrix:h.translatePosMatrix(g.posMatrix,p,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_pitch_with_map:+N,u_device_pixel_ratio:m.browser.devicePixelRatio,u_extrude_scale:q}},ou=function(h,g,p){var b=_o(p,1,g.zoom),N=Math.pow(2,g.zoom-p.tileID.overscaledZ),q=p.tileID.overscaleFactor();return{u_matrix:h,u_camera_to_center_distance:g.cameraToCenterDistance,u_pixels_to_tile_units:b,u_extrude_scale:[g.pixelsToGLUnits[0]/(b*N),g.pixelsToGLUnits[1]/(b*N)],u_overscale_factor:q}},Xu=function(h,g,p){return{u_matrix:h,u_inv_matrix:g,u_camera_to_center_distance:p.cameraToCenterDistance,u_viewport_size:[p.width,p.height]}},Nu=function(h,g,p){return p===void 0&&(p=1),{u_matrix:h,u_color:g,u_overlay:0,u_overlay_scale:p}},ks=function(h){return{u_matrix:h}},Sc=function(h,g,p,b){return{u_matrix:h,u_extrude_scale:_o(g,1,p),u_intensity:b}},vl=function(h,g,p){var b=h.transform;return{u_matrix:uc(h,g,p),u_ratio:1/_o(g,1,b.zoom),u_device_pixel_ratio:m.browser.devicePixelRatio,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},es=function(h,g,p,b){return m.extend(vl(h,g,p),{u_image:0,u_image_height:b})},Al=function(h,g,p,b){var N=h.transform,q=Zl(g,N);return{u_matrix:uc(h,g,p),u_texsize:g.imageAtlasTexture.size,u_ratio:1/_o(g,1,N.zoom),u_device_pixel_ratio:m.browser.devicePixelRatio,u_image:0,u_scale:[q,b.fromScale,b.toScale],u_fade:b.t,u_units_to_pixels:[1/N.pixelsToGLUnits[0],1/N.pixelsToGLUnits[1]]}},tf=function(h,g,p,b,N){var q=h.lineAtlas,ee=Zl(g,h.transform),ge=p.layout.get("line-cap")==="round",Ue=q.getDash(b.from,ge),st=q.getDash(b.to,ge),kt=Ue.width*N.fromScale,Lt=st.width*N.toScale;return m.extend(vl(h,g,p),{u_patternscale_a:[ee/kt,-Ue.height/2],u_patternscale_b:[ee/Lt,-st.height/2],u_sdfgamma:q.width/(256*Math.min(kt,Lt)*m.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ue.y,u_tex_y_b:st.y,u_mix:N.t})};function Zl(h,g){return 1/_o(h,1,g.tileZoom)}function uc(h,g,p){return h.translatePosMatrix(g.tileID.posMatrix,g,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}var pf=function(h,g,p,b,N){return{u_matrix:h,u_tl_parent:g,u_scale_parent:p,u_buffer_scale:1,u_fade_t:b.mix,u_opacity:b.opacity*N.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:N.paint.get("raster-brightness-min"),u_brightness_high:N.paint.get("raster-brightness-max"),u_saturation_factor:(ee=N.paint.get("raster-saturation"),ee>0?1-1/(1.001-ee):-ee),u_contrast_factor:(q=N.paint.get("raster-contrast"),q>0?1/(1-q):1+q),u_spin_weights:ql(N.paint.get("raster-hue-rotate"))};var q,ee};function ql(h){h*=Math.PI/180;var g=Math.sin(h),p=Math.cos(h);return[(2*p+1)/3,(-Math.sqrt(3)*g-p+1)/3,(Math.sqrt(3)*g-p+1)/3]}var Cu,rf=function(h,g,p,b,N,q,ee,ge,Ue,st){var kt=N.transform;return{u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:g?g.uSizeT:0,u_size:g?g.uSize:0,u_camera_to_center_distance:kt.cameraToCenterDistance,u_pitch:kt.pitch/360*2*Math.PI,u_rotate_symbol:+p,u_aspect_ratio:kt.width/kt.height,u_fade_change:N.options.fadeDuration?N.symbolFadeChange:1,u_matrix:q,u_label_plane_matrix:ee,u_coord_matrix:ge,u_is_text:+Ue,u_pitch_with_map:+b,u_texsize:st,u_texture:0}},ol=function(h,g,p,b,N,q,ee,ge,Ue,st,kt){var Lt=N.transform;return m.extend(rf(h,g,p,b,N,q,ee,ge,Ue,st),{u_gamma_scale:b?Math.cos(Lt._pitch)*Lt.cameraToCenterDistance:1,u_device_pixel_ratio:m.browser.devicePixelRatio,u_is_halo:+kt})},as=function(h,g,p,b,N,q,ee,ge,Ue,st){return m.extend(ol(h,g,p,b,N,q,ee,ge,!0,Ue,!0),{u_texsize_icon:st,u_texture_icon:1})},Ds=function(h,g,p){return{u_matrix:h,u_opacity:g,u_color:p}},Tl=function(h,g,p,b,N,q){return m.extend(function(ee,ge,Ue,st){var kt=Ue.imageManager.getPattern(ee.from.toString()),Lt=Ue.imageManager.getPattern(ee.to.toString()),Zt=Ue.imageManager.getPixelSize(),vr=Zt.width,pr=Zt.height,Nr=Math.pow(2,st.tileID.overscaledZ),cr=st.tileSize*Math.pow(2,Ue.transform.tileZoom)/Nr,zr=cr*(st.tileID.canonical.x+st.tileID.wrap*Nr),Ur=cr*st.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:kt.tl,u_pattern_br_a:kt.br,u_pattern_tl_b:Lt.tl,u_pattern_br_b:Lt.br,u_texsize:[vr,pr],u_mix:ge.t,u_pattern_size_a:kt.displaySize,u_pattern_size_b:Lt.displaySize,u_scale_a:ge.fromScale,u_scale_b:ge.toScale,u_tile_units_to_pixels:1/_o(st,1,Ue.transform.tileZoom),u_pixel_coord_upper:[zr>>16,Ur>>16],u_pixel_coord_lower:[65535&zr,65535&Ur]}}(b,q,p,N),{u_matrix:h,u_opacity:g})},Yu={fillExtrusion:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_lightpos:new m.Uniform3f(h,g.u_lightpos),u_lightintensity:new m.Uniform1f(h,g.u_lightintensity),u_lightcolor:new m.Uniform3f(h,g.u_lightcolor),u_vertical_gradient:new m.Uniform1f(h,g.u_vertical_gradient),u_opacity:new m.Uniform1f(h,g.u_opacity)}},fillExtrusionPattern:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_lightpos:new m.Uniform3f(h,g.u_lightpos),u_lightintensity:new m.Uniform1f(h,g.u_lightintensity),u_lightcolor:new m.Uniform3f(h,g.u_lightcolor),u_vertical_gradient:new m.Uniform1f(h,g.u_vertical_gradient),u_height_factor:new m.Uniform1f(h,g.u_height_factor),u_image:new m.Uniform1i(h,g.u_image),u_texsize:new m.Uniform2f(h,g.u_texsize),u_pixel_coord_upper:new m.Uniform2f(h,g.u_pixel_coord_upper),u_pixel_coord_lower:new m.Uniform2f(h,g.u_pixel_coord_lower),u_scale:new m.Uniform3f(h,g.u_scale),u_fade:new m.Uniform1f(h,g.u_fade),u_opacity:new m.Uniform1f(h,g.u_opacity)}},fill:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix)}},fillPattern:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_image:new m.Uniform1i(h,g.u_image),u_texsize:new m.Uniform2f(h,g.u_texsize),u_pixel_coord_upper:new m.Uniform2f(h,g.u_pixel_coord_upper),u_pixel_coord_lower:new m.Uniform2f(h,g.u_pixel_coord_lower),u_scale:new m.Uniform3f(h,g.u_scale),u_fade:new m.Uniform1f(h,g.u_fade)}},fillOutline:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_world:new m.Uniform2f(h,g.u_world)}},fillOutlinePattern:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_world:new m.Uniform2f(h,g.u_world),u_image:new m.Uniform1i(h,g.u_image),u_texsize:new m.Uniform2f(h,g.u_texsize),u_pixel_coord_upper:new m.Uniform2f(h,g.u_pixel_coord_upper),u_pixel_coord_lower:new m.Uniform2f(h,g.u_pixel_coord_lower),u_scale:new m.Uniform3f(h,g.u_scale),u_fade:new m.Uniform1f(h,g.u_fade)}},circle:function(h,g){return{u_camera_to_center_distance:new m.Uniform1f(h,g.u_camera_to_center_distance),u_scale_with_map:new m.Uniform1i(h,g.u_scale_with_map),u_pitch_with_map:new m.Uniform1i(h,g.u_pitch_with_map),u_extrude_scale:new m.Uniform2f(h,g.u_extrude_scale),u_device_pixel_ratio:new m.Uniform1f(h,g.u_device_pixel_ratio),u_matrix:new m.UniformMatrix4f(h,g.u_matrix)}},collisionBox:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_camera_to_center_distance:new m.Uniform1f(h,g.u_camera_to_center_distance),u_pixels_to_tile_units:new m.Uniform1f(h,g.u_pixels_to_tile_units),u_extrude_scale:new m.Uniform2f(h,g.u_extrude_scale),u_overscale_factor:new m.Uniform1f(h,g.u_overscale_factor)}},collisionCircle:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_inv_matrix:new m.UniformMatrix4f(h,g.u_inv_matrix),u_camera_to_center_distance:new m.Uniform1f(h,g.u_camera_to_center_distance),u_viewport_size:new m.Uniform2f(h,g.u_viewport_size)}},debug:function(h,g){return{u_color:new m.UniformColor(h,g.u_color),u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_overlay:new m.Uniform1i(h,g.u_overlay),u_overlay_scale:new m.Uniform1f(h,g.u_overlay_scale)}},clippingMask:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix)}},heatmap:function(h,g){return{u_extrude_scale:new m.Uniform1f(h,g.u_extrude_scale),u_intensity:new m.Uniform1f(h,g.u_intensity),u_matrix:new m.UniformMatrix4f(h,g.u_matrix)}},heatmapTexture:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_world:new m.Uniform2f(h,g.u_world),u_image:new m.Uniform1i(h,g.u_image),u_color_ramp:new m.Uniform1i(h,g.u_color_ramp),u_opacity:new m.Uniform1f(h,g.u_opacity)}},hillshade:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_image:new m.Uniform1i(h,g.u_image),u_latrange:new m.Uniform2f(h,g.u_latrange),u_light:new m.Uniform2f(h,g.u_light),u_shadow:new m.UniformColor(h,g.u_shadow),u_highlight:new m.UniformColor(h,g.u_highlight),u_accent:new m.UniformColor(h,g.u_accent)}},hillshadePrepare:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_image:new m.Uniform1i(h,g.u_image),u_dimension:new m.Uniform2f(h,g.u_dimension),u_zoom:new m.Uniform1f(h,g.u_zoom),u_unpack:new m.Uniform4f(h,g.u_unpack)}},line:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_ratio:new m.Uniform1f(h,g.u_ratio),u_device_pixel_ratio:new m.Uniform1f(h,g.u_device_pixel_ratio),u_units_to_pixels:new m.Uniform2f(h,g.u_units_to_pixels)}},lineGradient:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_ratio:new m.Uniform1f(h,g.u_ratio),u_device_pixel_ratio:new m.Uniform1f(h,g.u_device_pixel_ratio),u_units_to_pixels:new m.Uniform2f(h,g.u_units_to_pixels),u_image:new m.Uniform1i(h,g.u_image),u_image_height:new m.Uniform1f(h,g.u_image_height)}},linePattern:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_texsize:new m.Uniform2f(h,g.u_texsize),u_ratio:new m.Uniform1f(h,g.u_ratio),u_device_pixel_ratio:new m.Uniform1f(h,g.u_device_pixel_ratio),u_image:new m.Uniform1i(h,g.u_image),u_units_to_pixels:new m.Uniform2f(h,g.u_units_to_pixels),u_scale:new m.Uniform3f(h,g.u_scale),u_fade:new m.Uniform1f(h,g.u_fade)}},lineSDF:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_ratio:new m.Uniform1f(h,g.u_ratio),u_device_pixel_ratio:new m.Uniform1f(h,g.u_device_pixel_ratio),u_units_to_pixels:new m.Uniform2f(h,g.u_units_to_pixels),u_patternscale_a:new m.Uniform2f(h,g.u_patternscale_a),u_patternscale_b:new m.Uniform2f(h,g.u_patternscale_b),u_sdfgamma:new m.Uniform1f(h,g.u_sdfgamma),u_image:new m.Uniform1i(h,g.u_image),u_tex_y_a:new m.Uniform1f(h,g.u_tex_y_a),u_tex_y_b:new m.Uniform1f(h,g.u_tex_y_b),u_mix:new m.Uniform1f(h,g.u_mix)}},raster:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_tl_parent:new m.Uniform2f(h,g.u_tl_parent),u_scale_parent:new m.Uniform1f(h,g.u_scale_parent),u_buffer_scale:new m.Uniform1f(h,g.u_buffer_scale),u_fade_t:new m.Uniform1f(h,g.u_fade_t),u_opacity:new m.Uniform1f(h,g.u_opacity),u_image0:new m.Uniform1i(h,g.u_image0),u_image1:new m.Uniform1i(h,g.u_image1),u_brightness_low:new m.Uniform1f(h,g.u_brightness_low),u_brightness_high:new m.Uniform1f(h,g.u_brightness_high),u_saturation_factor:new m.Uniform1f(h,g.u_saturation_factor),u_contrast_factor:new m.Uniform1f(h,g.u_contrast_factor),u_spin_weights:new m.Uniform3f(h,g.u_spin_weights)}},symbolIcon:function(h,g){return{u_is_size_zoom_constant:new m.Uniform1i(h,g.u_is_size_zoom_constant),u_is_size_feature_constant:new m.Uniform1i(h,g.u_is_size_feature_constant),u_size_t:new m.Uniform1f(h,g.u_size_t),u_size:new m.Uniform1f(h,g.u_size),u_camera_to_center_distance:new m.Uniform1f(h,g.u_camera_to_center_distance),u_pitch:new m.Uniform1f(h,g.u_pitch),u_rotate_symbol:new m.Uniform1i(h,g.u_rotate_symbol),u_aspect_ratio:new m.Uniform1f(h,g.u_aspect_ratio),u_fade_change:new m.Uniform1f(h,g.u_fade_change),u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_label_plane_matrix:new m.UniformMatrix4f(h,g.u_label_plane_matrix),u_coord_matrix:new m.UniformMatrix4f(h,g.u_coord_matrix),u_is_text:new m.Uniform1i(h,g.u_is_text),u_pitch_with_map:new m.Uniform1i(h,g.u_pitch_with_map),u_texsize:new m.Uniform2f(h,g.u_texsize),u_texture:new m.Uniform1i(h,g.u_texture)}},symbolSDF:function(h,g){return{u_is_size_zoom_constant:new m.Uniform1i(h,g.u_is_size_zoom_constant),u_is_size_feature_constant:new m.Uniform1i(h,g.u_is_size_feature_constant),u_size_t:new m.Uniform1f(h,g.u_size_t),u_size:new m.Uniform1f(h,g.u_size),u_camera_to_center_distance:new m.Uniform1f(h,g.u_camera_to_center_distance),u_pitch:new m.Uniform1f(h,g.u_pitch),u_rotate_symbol:new m.Uniform1i(h,g.u_rotate_symbol),u_aspect_ratio:new m.Uniform1f(h,g.u_aspect_ratio),u_fade_change:new m.Uniform1f(h,g.u_fade_change),u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_label_plane_matrix:new m.UniformMatrix4f(h,g.u_label_plane_matrix),u_coord_matrix:new m.UniformMatrix4f(h,g.u_coord_matrix),u_is_text:new m.Uniform1i(h,g.u_is_text),u_pitch_with_map:new m.Uniform1i(h,g.u_pitch_with_map),u_texsize:new m.Uniform2f(h,g.u_texsize),u_texture:new m.Uniform1i(h,g.u_texture),u_gamma_scale:new m.Uniform1f(h,g.u_gamma_scale),u_device_pixel_ratio:new m.Uniform1f(h,g.u_device_pixel_ratio),u_is_halo:new m.Uniform1i(h,g.u_is_halo)}},symbolTextAndIcon:function(h,g){return{u_is_size_zoom_constant:new m.Uniform1i(h,g.u_is_size_zoom_constant),u_is_size_feature_constant:new m.Uniform1i(h,g.u_is_size_feature_constant),u_size_t:new m.Uniform1f(h,g.u_size_t),u_size:new m.Uniform1f(h,g.u_size),u_camera_to_center_distance:new m.Uniform1f(h,g.u_camera_to_center_distance),u_pitch:new m.Uniform1f(h,g.u_pitch),u_rotate_symbol:new m.Uniform1i(h,g.u_rotate_symbol),u_aspect_ratio:new m.Uniform1f(h,g.u_aspect_ratio),u_fade_change:new m.Uniform1f(h,g.u_fade_change),u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_label_plane_matrix:new m.UniformMatrix4f(h,g.u_label_plane_matrix),u_coord_matrix:new m.UniformMatrix4f(h,g.u_coord_matrix),u_is_text:new m.Uniform1i(h,g.u_is_text),u_pitch_with_map:new m.Uniform1i(h,g.u_pitch_with_map),u_texsize:new m.Uniform2f(h,g.u_texsize),u_texsize_icon:new m.Uniform2f(h,g.u_texsize_icon),u_texture:new m.Uniform1i(h,g.u_texture),u_texture_icon:new m.Uniform1i(h,g.u_texture_icon),u_gamma_scale:new m.Uniform1f(h,g.u_gamma_scale),u_device_pixel_ratio:new m.Uniform1f(h,g.u_device_pixel_ratio),u_is_halo:new m.Uniform1i(h,g.u_is_halo)}},background:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_opacity:new m.Uniform1f(h,g.u_opacity),u_color:new m.UniformColor(h,g.u_color)}},backgroundPattern:function(h,g){return{u_matrix:new m.UniformMatrix4f(h,g.u_matrix),u_opacity:new m.Uniform1f(h,g.u_opacity),u_image:new m.Uniform1i(h,g.u_image),u_pattern_tl_a:new m.Uniform2f(h,g.u_pattern_tl_a),u_pattern_br_a:new m.Uniform2f(h,g.u_pattern_br_a),u_pattern_tl_b:new m.Uniform2f(h,g.u_pattern_tl_b),u_pattern_br_b:new m.Uniform2f(h,g.u_pattern_br_b),u_texsize:new m.Uniform2f(h,g.u_texsize),u_mix:new m.Uniform1f(h,g.u_mix),u_pattern_size_a:new m.Uniform2f(h,g.u_pattern_size_a),u_pattern_size_b:new m.Uniform2f(h,g.u_pattern_size_b),u_scale_a:new m.Uniform1f(h,g.u_scale_a),u_scale_b:new m.Uniform1f(h,g.u_scale_b),u_pixel_coord_upper:new m.Uniform2f(h,g.u_pixel_coord_upper),u_pixel_coord_lower:new m.Uniform2f(h,g.u_pixel_coord_lower),u_tile_units_to_pixels:new m.Uniform1f(h,g.u_tile_units_to_pixels)}}};function Ml(h,g,p,b,N,q,ee){for(var ge=h.context,Ue=ge.gl,st=h.useProgram("collisionBox"),kt=[],Lt=0,Zt=0,vr=0;vr<b.length;vr++){var pr=b[vr],Nr=g.getTile(pr),cr=Nr.getBucket(p);if(cr){var zr=pr.posMatrix;N[0]===0&&N[1]===0||(zr=h.translatePosMatrix(pr.posMatrix,Nr,N,q));var Ur=ee?cr.textCollisionBox:cr.iconCollisionBox,Tn=cr.collisionCircleArray;if(Tn.length>0){var ti=m.create(),Yn=zr;m.mul(ti,cr.placementInvProjMatrix,h.transform.glCoordMatrix),m.mul(ti,ti,cr.placementViewportMatrix),kt.push({circleArray:Tn,circleOffset:Zt,transform:Yn,invTransform:ti}),Zt=Lt+=Tn.length/4}Ur&&st.draw(ge,Ue.LINES,Et.disabled,Bt.disabled,h.colorModeForRenderPass(),St.disabled,ou(zr,h.transform,Nr),p.id,Ur.layoutVertexBuffer,Ur.indexBuffer,Ur.segments,null,h.transform.zoom,null,null,Ur.collisionVertexBuffer)}}if(ee&&kt.length){var ai=h.useProgram("collisionCircle"),Pi=new m.StructArrayLayout2f1f2i16;Pi.resize(4*Lt),Pi._trim();for(var va=0,na=0,Ua=kt;na<Ua.length;na+=1)for(var co=Ua[na],Eo=0;Eo<co.circleArray.length/4;Eo++){var ho=4*Eo,qo=co.circleArray[ho+0],ga=co.circleArray[ho+1],Zo=co.circleArray[ho+2],Uo=co.circleArray[ho+3];Pi.emplace(va++,qo,ga,Zo,Uo,0),Pi.emplace(va++,qo,ga,Zo,Uo,1),Pi.emplace(va++,qo,ga,Zo,Uo,2),Pi.emplace(va++,qo,ga,Zo,Uo,3)}(!Cu||Cu.length<2*Lt)&&(Cu=function(Ou){var nu=2*Ou,rc=new m.StructArrayLayout3ui6;rc.resize(nu),rc._trim();for(var Du=0;Du<nu;Du++){var gu=6*Du;rc.uint16[gu+0]=4*Du+0,rc.uint16[gu+1]=4*Du+1,rc.uint16[gu+2]=4*Du+2,rc.uint16[gu+3]=4*Du+2,rc.uint16[gu+4]=4*Du+3,rc.uint16[gu+5]=4*Du+0}return rc}(Lt));for(var Do=ge.createIndexBuffer(Cu,!0),po=ge.createVertexBuffer(Pi,m.collisionCircleLayout.members,!0),us=0,ko=kt;us<ko.length;us+=1){var Io=ko[us],El=Xu(Io.transform,Io.invTransform,h.transform);ai.draw(ge,Ue.TRIANGLES,Et.disabled,Bt.disabled,h.colorModeForRenderPass(),St.disabled,El,p.id,po,Do,m.SegmentVector.simpleSegment(0,2*Io.circleOffset,Io.circleArray.length,Io.circleArray.length/2),null,h.transform.zoom,null,null,null)}po.destroy(),Do.destroy()}}var xl=m.identity(new Float32Array(16));function nf(h,g,p,b,N,q){var ee=m.getAnchorAlignment(h),ge=-(ee.horizontalAlign-.5)*g,Ue=-(ee.verticalAlign-.5)*p,st=m.evaluateVariableOffset(h,b);return new m.Point((ge/N+st[0])*q,(Ue/N+st[1])*q)}function Vc(h,g,p,b,N,q,ee,ge,Ue,st,kt){var Lt=h.text.placedSymbolArray,Zt=h.text.dynamicLayoutVertexArray,vr=h.icon.dynamicLayoutVertexArray,pr={};Zt.clear();for(var Nr=0;Nr<Lt.length;Nr++){var cr=Lt.get(Nr),zr=cr.hidden||!cr.crossTileID||h.allowVerticalPlacement&&!cr.placedOrientation?null:b[cr.crossTileID];if(zr){var Ur=new m.Point(cr.anchorX,cr.anchorY),Tn=ct(Ur,p?ge:ee),ti=qi(q.cameraToCenterDistance,Tn.signedDistanceFromCamera),Yn=N.evaluateSizeForFeature(h.textSizeData,st,cr)*ti/m.ONE_EM;p&&(Yn*=h.tilePixelRatio/Ue);for(var ai=nf(zr.anchor,zr.width,zr.height,zr.textOffset,zr.textBoxScale,Yn),Pi=p?ct(Ur.add(ai),ee).point:Tn.point.add(g?ai.rotate(-q.angle):ai),va=h.allowVerticalPlacement&&cr.placedOrientation===m.WritingMode.vertical?Math.PI/2:0,na=0;na<cr.numGlyphs;na++)m.addDynamicAttributes(Zt,Pi,va);kt&&cr.associatedIconIndex>=0&&(pr[cr.associatedIconIndex]={shiftedAnchor:Pi,angle:va})}else zo(cr.numGlyphs,Zt)}if(kt){vr.clear();for(var Ua=h.icon.placedSymbolArray,co=0;co<Ua.length;co++){var Eo=Ua.get(co);if(Eo.hidden)zo(Eo.numGlyphs,vr);else{var ho=pr[co];if(ho)for(var qo=0;qo<Eo.numGlyphs;qo++)m.addDynamicAttributes(vr,ho.shiftedAnchor,ho.angle);else zo(Eo.numGlyphs,vr)}}h.icon.dynamicLayoutVertexBuffer.updateData(vr)}h.text.dynamicLayoutVertexBuffer.updateData(Zt)}function Zf(h,g,p){return p.iconsInText&&g?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function Hc(h,g,p,b,N,q,ee,ge,Ue,st,kt,Lt){for(var Zt=h.context,vr=Zt.gl,pr=h.transform,Nr=ge==="map",cr=Ue==="map",zr=Nr&&p.layout.get("symbol-placement")!=="point",Ur=Nr&&!cr&&!zr,Tn=p.layout.get("symbol-sort-key").constantOr(1)!==void 0,ti=!1,Yn=h.depthModeForSublayer(0,Et.ReadOnly),ai=p.layout.get("text-variable-anchor"),Pi=[],va=0,na=b;va<na.length;va+=1){var Ua=na[va],co=g.getTile(Ua),Eo=co.getBucket(p);if(Eo){var ho=N?Eo.text:Eo.icon;if(ho&&ho.segments.get().length){var qo=ho.programConfigurations.get(p.id),ga=N||Eo.sdfIcons,Zo=N?Eo.textSizeData:Eo.iconSizeData,Uo=cr||pr.pitch!==0,Do=h.useProgram(Zf(ga,N,Eo),qo),po=m.evaluateSizeForZoom(Zo,pr.zoom),us=void 0,ko=[0,0],Io=void 0,El=void 0,Ou=null,nu=void 0;if(N)Io=co.glyphAtlasTexture,El=vr.LINEAR,us=co.glyphAtlasTexture.size,Eo.iconsInText&&(ko=co.imageAtlasTexture.size,Ou=co.imageAtlasTexture,nu=Uo||h.options.rotating||h.options.zooming||Zo.kind==="composite"||Zo.kind==="camera"?vr.LINEAR:vr.NEAREST);else{var rc=p.layout.get("icon-size").constantOr(0)!==1||Eo.iconsNeedLinear;Io=co.imageAtlasTexture,El=ga||h.options.rotating||h.options.zooming||rc||Uo?vr.LINEAR:vr.NEAREST,us=co.imageAtlasTexture.size}var Du=_o(co,1,h.transform.zoom),gu=fa(Ua.posMatrix,cr,Nr,h.transform,Du),gc=Wi(Ua.posMatrix,cr,Nr,h.transform,Du),Vl=ai&&Eo.hasTextData(),ml=p.layout.get("icon-text-fit")!=="none"&&Vl&&Eo.hasIconData();zr&&To(Eo,Ua.posMatrix,h,N,gu,gc,cr,st);var Mc=h.translatePosMatrix(Ua.posMatrix,co,q,ee),hl=zr||N&&ai||ml?xl:gu,yc=h.translatePosMatrix(gc,co,q,ee,!0),lp=ga&&p.paint.get(N?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Dh={program:Do,buffers:ho,uniformValues:ga?Eo.iconsInText?as(Zo.kind,po,Ur,cr,h,Mc,hl,yc,us,ko):ol(Zo.kind,po,Ur,cr,h,Mc,hl,yc,N,us,!0):rf(Zo.kind,po,Ur,cr,h,Mc,hl,yc,N,us),atlasTexture:Io,atlasTextureIcon:Ou,atlasInterpolation:El,atlasInterpolationIcon:nu,isSDF:ga,hasHalo:lp};if(Tn&&Eo.canOverlap){ti=!0;for(var jf=0,bh=ho.segments.get();jf<bh.length;jf+=1){var Qf=bh[jf];Pi.push({segments:new m.SegmentVector([Qf]),sortKey:Qf.sortKey,state:Dh})}}else Pi.push({segments:ho.segments,sortKey:0,state:Dh})}}}ti&&Pi.sort(function(fh,Eh){return fh.sortKey-Eh.sortKey});for(var sf=0,ch=Pi;sf<ch.length;sf+=1){var Pc=ch[sf],Hl=Pc.state;if(Zt.activeTexture.set(vr.TEXTURE0),Hl.atlasTexture.bind(Hl.atlasInterpolation,vr.CLAMP_TO_EDGE),Hl.atlasTextureIcon&&(Zt.activeTexture.set(vr.TEXTURE1),Hl.atlasTextureIcon&&Hl.atlasTextureIcon.bind(Hl.atlasInterpolationIcon,vr.CLAMP_TO_EDGE)),Hl.isSDF){var zc=Hl.uniformValues;Hl.hasHalo&&(zc.u_is_halo=1,Ql(Hl.buffers,Pc.segments,p,h,Hl.program,Yn,kt,Lt,zc)),zc.u_is_halo=0}Ql(Hl.buffers,Pc.segments,p,h,Hl.program,Yn,kt,Lt,Hl.uniformValues)}}function Ql(h,g,p,b,N,q,ee,ge,Ue){var st=b.context;N.draw(st,st.gl.TRIANGLES,q,ee,ge,St.disabled,Ue,p.id,h.layoutVertexBuffer,h.indexBuffer,g,p.paint,b.transform.zoom,h.programConfigurations.get(p.id),h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer)}function sl(h,g,p,b,N,q,ee){var ge,Ue,st,kt,Lt,Zt=h.context.gl,vr=p.paint.get("fill-pattern"),pr=vr&&vr.constantOr(1),Nr=p.getCrossfadeParameters();ee?(Ue=pr&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ge=Zt.LINES):(Ue=pr?"fillPattern":"fill",ge=Zt.TRIANGLES);for(var cr=0,zr=b;cr<zr.length;cr+=1){var Ur=zr[cr],Tn=g.getTile(Ur);if(!pr||Tn.patternsLoaded()){var ti=Tn.getBucket(p);if(ti){var Yn=ti.programConfigurations.get(p.id),ai=h.useProgram(Ue,Yn);pr&&(h.context.activeTexture.set(Zt.TEXTURE0),Tn.imageAtlasTexture.bind(Zt.LINEAR,Zt.CLAMP_TO_EDGE),Yn.updatePaintBuffers(Nr));var Pi=vr.constantOr(null);if(Pi&&Tn.imageAtlas){var va=Tn.imageAtlas,na=va.patternPositions[Pi.to.toString()],Ua=va.patternPositions[Pi.from.toString()];na&&Ua&&Yn.setConstantPatternPositions(na,Ua)}var co=h.translatePosMatrix(Ur.posMatrix,Tn,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(ee){kt=ti.indexBuffer2,Lt=ti.segments2;var Eo=[Zt.drawingBufferWidth,Zt.drawingBufferHeight];st=Ue==="fillOutlinePattern"&&pr?zu(co,h,Nr,Tn,Eo):Go(co,Eo)}else kt=ti.indexBuffer,Lt=ti.segments,st=pr?ps(co,h,Nr,Tn):lu(co);ai.draw(h.context,ge,N,h.stencilModeForClipping(Ur),q,St.disabled,st,p.id,ti.layoutVertexBuffer,kt,Lt,p.paint,h.transform.zoom,Yn)}}}}function vc(h,g,p,b,N,q,ee){for(var ge=h.context,Ue=ge.gl,st=p.paint.get("fill-extrusion-pattern"),kt=st.constantOr(1),Lt=p.getCrossfadeParameters(),Zt=p.paint.get("fill-extrusion-opacity"),vr=0,pr=b;vr<pr.length;vr+=1){var Nr=pr[vr],cr=g.getTile(Nr),zr=cr.getBucket(p);if(zr){var Ur=zr.programConfigurations.get(p.id),Tn=h.useProgram(kt?"fillExtrusionPattern":"fillExtrusion",Ur);kt&&(h.context.activeTexture.set(Ue.TEXTURE0),cr.imageAtlasTexture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),Ur.updatePaintBuffers(Lt));var ti=st.constantOr(null);if(ti&&cr.imageAtlas){var Yn=cr.imageAtlas,ai=Yn.patternPositions[ti.to.toString()],Pi=Yn.patternPositions[ti.from.toString()];ai&&Pi&&Ur.setConstantPatternPositions(ai,Pi)}var va=h.translatePosMatrix(Nr.posMatrix,cr,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),na=p.paint.get("fill-extrusion-vertical-gradient"),Ua=kt?Rs(va,h,na,Zt,Nr,Lt,cr):Ls(va,h,na,Zt);Tn.draw(ge,ge.gl.TRIANGLES,N,q,ee,St.backCCW,Ua,p.id,zr.layoutVertexBuffer,zr.indexBuffer,zr.segments,p.paint,h.transform.zoom,Ur)}}}function Jl(h,g,p,b,N,q){var ee=h.context,ge=ee.gl,Ue=g.fbo;if(Ue){var st=h.useProgram("hillshade");ee.activeTexture.set(ge.TEXTURE0),ge.bindTexture(ge.TEXTURE_2D,Ue.colorAttachment.get());var kt=function(Lt,Zt,vr){var pr=vr.paint.get("hillshade-shadow-color"),Nr=vr.paint.get("hillshade-highlight-color"),cr=vr.paint.get("hillshade-accent-color"),zr=vr.paint.get("hillshade-illumination-direction")*(Math.PI/180);vr.paint.get("hillshade-illumination-anchor")==="viewport"&&(zr-=Lt.transform.angle);var Ur,Tn,ti,Yn=!Lt.options.moving;return{u_matrix:Lt.transform.calculatePosMatrix(Zt.tileID.toUnwrapped(),Yn),u_image:0,u_latrange:(Ur=Zt.tileID,Tn=Math.pow(2,Ur.canonical.z),ti=Ur.canonical.y,[new m.MercatorCoordinate(0,ti/Tn).toLngLat().lat,new m.MercatorCoordinate(0,(ti+1)/Tn).toLngLat().lat]),u_light:[vr.paint.get("hillshade-exaggeration"),zr],u_shadow:pr,u_highlight:Nr,u_accent:cr}}(h,g,p);st.draw(ee,ge.TRIANGLES,b,N,q,St.disabled,kt,p.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}}function ts(h,g,p,b,N,q){var ee=h.context,ge=ee.gl,Ue=g.dem;if(Ue&&Ue.data){var st=Ue.dim,kt=Ue.stride,Lt=Ue.getPixels();if(ee.activeTexture.set(ge.TEXTURE1),ee.pixelStoreUnpackPremultiplyAlpha.set(!1),g.demTexture=g.demTexture||h.getTileTexture(kt),g.demTexture){var Zt=g.demTexture;Zt.update(Lt,{premultiply:!1}),Zt.bind(ge.NEAREST,ge.CLAMP_TO_EDGE)}else g.demTexture=new m.Texture(ee,Lt,ge.RGBA,{premultiply:!1}),g.demTexture.bind(ge.NEAREST,ge.CLAMP_TO_EDGE);ee.activeTexture.set(ge.TEXTURE0);var vr=g.fbo;if(!vr){var pr=new m.Texture(ee,{width:st,height:st,data:null},ge.RGBA);pr.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),(vr=g.fbo=ee.createFramebuffer(st,st,!0)).colorAttachment.set(pr.texture)}ee.bindFramebuffer.set(vr.framebuffer),ee.viewport.set([0,0,st,st]),h.useProgram("hillshadePrepare").draw(ee,ge.TRIANGLES,b,N,q,St.disabled,function(Nr,cr){var zr=cr.stride,Ur=m.create();return m.ortho(Ur,0,m.EXTENT,-m.EXTENT,0,0,1),m.translate(Ur,Ur,[0,-m.EXTENT,0]),{u_matrix:Ur,u_image:1,u_dimension:[zr,zr],u_zoom:Nr.overscaledZ,u_unpack:cr.getUnpackVector()}}(g.tileID,Ue),p.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments),g.needsHillshadePrepare=!1}}function gs(h,g,p,b,N){var q=b.paint.get("raster-fade-duration");if(q>0){var ee=m.browser.now(),ge=(ee-h.timeAdded)/q,Ue=g?(ee-g.timeAdded)/q:-1,st=p.getSource(),kt=N.coveringZoomLevel({tileSize:st.tileSize,roundZoom:st.roundZoom}),Lt=!g||Math.abs(g.tileID.overscaledZ-kt)>Math.abs(h.tileID.overscaledZ-kt),Zt=Lt&&h.refreshedUponExpiration?1:m.clamp(Lt?ge:1-Ue,0,1);return h.refreshedUponExpiration&&ge>=1&&(h.refreshedUponExpiration=!1),g?{opacity:1,mix:1-Zt}:{opacity:Zt,mix:0}}return{opacity:1,mix:0}}var $o=new m.Color(1,0,0,1),ds=new m.Color(0,1,0,1),Ns=new m.Color(0,0,1,1),Mu=new m.Color(1,0,1,1),ec=new m.Color(0,1,1,1);function zs(h,g,p,b){ha(h,0,g+p/2,h.transform.width,p,b)}function df(h,g,p,b){ha(h,g-p/2,0,p,h.transform.height,b)}function ha(h,g,p,b,N,q){var ee=h.context,ge=ee.gl;ge.enable(ge.SCISSOR_TEST),ge.scissor(g*m.browser.devicePixelRatio,p*m.browser.devicePixelRatio,b*m.browser.devicePixelRatio,N*m.browser.devicePixelRatio),ee.clear({color:q}),ge.disable(ge.SCISSOR_TEST)}function Gc(h,g,p){var b=h.context,N=b.gl,q=p.posMatrix,ee=h.useProgram("debug"),ge=Et.disabled,Ue=Bt.disabled,st=h.colorModeForRenderPass();b.activeTexture.set(N.TEXTURE0),h.emptyTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),ee.draw(b,N.LINE_STRIP,ge,Ue,st,St.disabled,Nu(q,m.Color.red),"$debug",h.debugBuffer,h.tileBorderIndexBuffer,h.debugSegments);var kt=g.getTileByID(p.key).latestRawTileData,Lt=Math.floor((kt&&kt.byteLength||0)/1024),Zt=g.getTile(p).tileSize,vr=512/Math.min(Zt,512)*(p.overscaledZ/h.transform.zoom)*.5,pr=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(pr+=" => "+p.overscaledZ),function(Nr,cr){Nr.initDebugOverlayCanvas();var zr=Nr.debugOverlayCanvas,Ur=Nr.context.gl,Tn=Nr.debugOverlayCanvas.getContext("2d");Tn.clearRect(0,0,zr.width,zr.height),Tn.shadowColor="white",Tn.shadowBlur=2,Tn.lineWidth=1.5,Tn.strokeStyle="white",Tn.textBaseline="top",Tn.font="bold 36px Open Sans, sans-serif",Tn.fillText(cr,5,5),Tn.strokeText(cr,5,5),Nr.debugOverlayTexture.update(zr),Nr.debugOverlayTexture.bind(Ur.LINEAR,Ur.CLAMP_TO_EDGE)}(h,pr+" "+Lt+"kb"),ee.draw(b,N.TRIANGLES,ge,Ue,Le.alphaBlended,St.disabled,Nu(q,m.Color.transparent,vr),"$debug",h.debugBuffer,h.quadTriangleIndexBuffer,h.debugSegments)}var kc={symbol:function(h,g,p,b,N){if(h.renderPass==="translucent"){var q=Bt.disabled,ee=h.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(ge,Ue,st,kt,Lt,Zt,vr){for(var pr=Ue.transform,Nr=Lt==="map",cr=Zt==="map",zr=0,Ur=ge;zr<Ur.length;zr+=1){var Tn=Ur[zr],ti=kt.getTile(Tn),Yn=ti.getBucket(st);if(Yn&&Yn.text&&Yn.text.segments.get().length){var ai=m.evaluateSizeForZoom(Yn.textSizeData,pr.zoom),Pi=_o(ti,1,Ue.transform.zoom),va=fa(Tn.posMatrix,cr,Nr,Ue.transform,Pi),na=st.layout.get("icon-text-fit")!=="none"&&Yn.hasIconData();if(ai){var Ua=Math.pow(2,pr.zoom-ti.tileID.overscaledZ);Vc(Yn,Nr,cr,vr,m.symbolSize,pr,va,Tn.posMatrix,Ua,ai,na)}}}}(b,h,p,g,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),N),p.paint.get("icon-opacity").constantOr(1)!==0&&Hc(h,g,p,b,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),q,ee),p.paint.get("text-opacity").constantOr(1)!==0&&Hc(h,g,p,b,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),q,ee),g.map.showCollisionBoxes&&(Ml(h,g,p,b,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),Ml(h,g,p,b,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))}},circle:function(h,g,p,b){if(h.renderPass==="translucent"){var N=p.paint.get("circle-opacity"),q=p.paint.get("circle-stroke-width"),ee=p.paint.get("circle-stroke-opacity"),ge=p.layout.get("circle-sort-key").constantOr(1)!==void 0;if(N.constantOr(1)!==0||q.constantOr(1)!==0&&ee.constantOr(1)!==0){for(var Ue=h.context,st=Ue.gl,kt=h.depthModeForSublayer(0,Et.ReadOnly),Lt=Bt.disabled,Zt=h.colorModeForRenderPass(),vr=[],pr=0;pr<b.length;pr++){var Nr=b[pr],cr=g.getTile(Nr),zr=cr.getBucket(p);if(zr){var Ur=zr.programConfigurations.get(p.id),Tn={programConfiguration:Ur,program:h.useProgram("circle",Ur),layoutVertexBuffer:zr.layoutVertexBuffer,indexBuffer:zr.indexBuffer,uniformValues:al(h,Nr,cr,p)};if(ge)for(var ti=0,Yn=zr.segments.get();ti<Yn.length;ti+=1){var ai=Yn[ti];vr.push({segments:new m.SegmentVector([ai]),sortKey:ai.sortKey,state:Tn})}else vr.push({segments:zr.segments,sortKey:0,state:Tn})}}ge&&vr.sort(function(co,Eo){return co.sortKey-Eo.sortKey});for(var Pi=0,va=vr;Pi<va.length;Pi+=1){var na=va[Pi],Ua=na.state;Ua.program.draw(Ue,st.TRIANGLES,kt,Lt,Zt,St.disabled,Ua.uniformValues,p.id,Ua.layoutVertexBuffer,Ua.indexBuffer,na.segments,p.paint,h.transform.zoom,Ua.programConfiguration)}}}},heatmap:function(h,g,p,b){if(p.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){var N=h.context,q=N.gl,ee=Bt.disabled,ge=new Le([q.ONE,q.ONE],m.Color.transparent,[!0,!0,!0,!0]);(function(vr,pr,Nr){var cr=vr.gl;vr.activeTexture.set(cr.TEXTURE1),vr.viewport.set([0,0,pr.width/4,pr.height/4]);var zr=Nr.heatmapFbo;if(zr)cr.bindTexture(cr.TEXTURE_2D,zr.colorAttachment.get()),vr.bindFramebuffer.set(zr.framebuffer);else{var Ur=cr.createTexture();cr.bindTexture(cr.TEXTURE_2D,Ur),cr.texParameteri(cr.TEXTURE_2D,cr.TEXTURE_WRAP_S,cr.CLAMP_TO_EDGE),cr.texParameteri(cr.TEXTURE_2D,cr.TEXTURE_WRAP_T,cr.CLAMP_TO_EDGE),cr.texParameteri(cr.TEXTURE_2D,cr.TEXTURE_MIN_FILTER,cr.LINEAR),cr.texParameteri(cr.TEXTURE_2D,cr.TEXTURE_MAG_FILTER,cr.LINEAR),zr=Nr.heatmapFbo=vr.createFramebuffer(pr.width/4,pr.height/4,!1),function(Tn,ti,Yn,ai){var Pi=Tn.gl;Pi.texImage2D(Pi.TEXTURE_2D,0,Pi.RGBA,ti.width/4,ti.height/4,0,Pi.RGBA,Tn.extRenderToTextureHalfFloat?Tn.extTextureHalfFloat.HALF_FLOAT_OES:Pi.UNSIGNED_BYTE,null),ai.colorAttachment.set(Yn)}(vr,pr,Ur,zr)}})(N,h,p),N.clear({color:m.Color.transparent});for(var Ue=0;Ue<b.length;Ue++){var st=b[Ue];if(!g.hasRenderableParent(st)){var kt=g.getTile(st),Lt=kt.getBucket(p);if(Lt){var Zt=Lt.programConfigurations.get(p.id);h.useProgram("heatmap",Zt).draw(N,q.TRIANGLES,Et.disabled,ee,ge,St.disabled,Sc(st.posMatrix,kt,h.transform.zoom,p.paint.get("heatmap-intensity")),p.id,Lt.layoutVertexBuffer,Lt.indexBuffer,Lt.segments,p.paint,h.transform.zoom,Zt)}}}N.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(vr,pr){var Nr=vr.context,cr=Nr.gl,zr=pr.heatmapFbo;if(zr){Nr.activeTexture.set(cr.TEXTURE0),cr.bindTexture(cr.TEXTURE_2D,zr.colorAttachment.get()),Nr.activeTexture.set(cr.TEXTURE1);var Ur=pr.colorRampTexture;Ur||(Ur=pr.colorRampTexture=new m.Texture(Nr,pr.colorRamp,cr.RGBA)),Ur.bind(cr.LINEAR,cr.CLAMP_TO_EDGE),vr.useProgram("heatmapTexture").draw(Nr,cr.TRIANGLES,Et.disabled,Bt.disabled,vr.colorModeForRenderPass(),St.disabled,function(Tn,ti,Yn,ai){var Pi=m.create();m.ortho(Pi,0,Tn.width,Tn.height,0,0,1);var va=Tn.context.gl;return{u_matrix:Pi,u_world:[va.drawingBufferWidth,va.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ti.paint.get("heatmap-opacity")}}(vr,pr),pr.id,vr.viewportBuffer,vr.quadTriangleIndexBuffer,vr.viewportSegments,pr.paint,vr.transform.zoom)}}(h,p))},line:function(h,g,p,b){if(h.renderPass==="translucent"){var N=p.paint.get("line-opacity"),q=p.paint.get("line-width");if(N.constantOr(1)!==0&&q.constantOr(1)!==0)for(var ee=h.depthModeForSublayer(0,Et.ReadOnly),ge=h.colorModeForRenderPass(),Ue=p.paint.get("line-dasharray"),st=p.paint.get("line-pattern"),kt=st.constantOr(1),Lt=p.paint.get("line-gradient"),Zt=p.getCrossfadeParameters(),vr=kt?"linePattern":Ue?"lineSDF":Lt?"lineGradient":"line",pr=h.context,Nr=pr.gl,cr=!0,zr=0,Ur=b;zr<Ur.length;zr+=1){var Tn=Ur[zr],ti=g.getTile(Tn);if(!kt||ti.patternsLoaded()){var Yn=ti.getBucket(p);if(Yn){var ai=Yn.programConfigurations.get(p.id),Pi=h.context.program.get(),va=h.useProgram(vr,ai),na=cr||va.program!==Pi,Ua=st.constantOr(null);if(Ua&&ti.imageAtlas){var co=ti.imageAtlas,Eo=co.patternPositions[Ua.to.toString()],ho=co.patternPositions[Ua.from.toString()];Eo&&ho&&ai.setConstantPatternPositions(Eo,ho)}var qo=kt?Al(h,ti,p,Zt):Ue?tf(h,ti,p,Ue,Zt):Lt?es(h,ti,p,Yn.lineClipsArray.length):vl(h,ti,p);if(kt)pr.activeTexture.set(Nr.TEXTURE0),ti.imageAtlasTexture.bind(Nr.LINEAR,Nr.CLAMP_TO_EDGE),ai.updatePaintBuffers(Zt);else if(Ue&&(na||h.lineAtlas.dirty))pr.activeTexture.set(Nr.TEXTURE0),h.lineAtlas.bind(pr);else if(Lt){var ga=Yn.gradients[p.id],Zo=ga.texture;if(p.gradientVersion!==ga.version){var Uo=256;if(p.stepInterpolant){var Do=g.getSource().maxzoom,po=Tn.canonical.z===Do?Math.ceil(1<<h.transform.maxZoom-Tn.canonical.z):1;Uo=m.clamp(m.nextPowerOfTwo(Yn.maxLineLength/m.EXTENT*1024*po),256,pr.maxTextureSize)}ga.gradient=m.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:Uo,image:ga.gradient||void 0,clips:Yn.lineClipsArray}),ga.texture?ga.texture.update(ga.gradient):ga.texture=new m.Texture(pr,ga.gradient,Nr.RGBA),ga.version=p.gradientVersion,Zo=ga.texture}pr.activeTexture.set(Nr.TEXTURE0),Zo.bind(p.stepInterpolant?Nr.NEAREST:Nr.LINEAR,Nr.CLAMP_TO_EDGE)}va.draw(pr,Nr.TRIANGLES,ee,h.stencilModeForClipping(Tn),ge,St.disabled,qo,p.id,Yn.layoutVertexBuffer,Yn.indexBuffer,Yn.segments,p.paint,h.transform.zoom,ai,Yn.layoutVertexBuffer2),cr=!1}}}}},fill:function(h,g,p,b){var N=p.paint.get("fill-color"),q=p.paint.get("fill-opacity");if(q.constantOr(1)!==0){var ee=h.colorModeForRenderPass(),ge=p.paint.get("fill-pattern"),Ue=h.opaquePassEnabledForLayer()&&!ge.constantOr(1)&&N.constantOr(m.Color.transparent).a===1&&q.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===Ue){var st=h.depthModeForSublayer(1,h.renderPass==="opaque"?Et.ReadWrite:Et.ReadOnly);sl(h,g,p,b,st,ee,!1)}if(h.renderPass==="translucent"&&p.paint.get("fill-antialias")){var kt=h.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,Et.ReadOnly);sl(h,g,p,b,kt,ee,!0)}}},"fill-extrusion":function(h,g,p,b){var N=p.paint.get("fill-extrusion-opacity");if(N!==0&&h.renderPass==="translucent"){var q=new Et(h.context.gl.LEQUAL,Et.ReadWrite,h.depthRangeFor3D);if(N!==1||p.paint.get("fill-extrusion-pattern").constantOr(1))vc(h,g,p,b,q,Bt.disabled,Le.disabled),vc(h,g,p,b,q,h.stencilModeFor3D(),h.colorModeForRenderPass());else{var ee=h.colorModeForRenderPass();vc(h,g,p,b,q,Bt.disabled,ee)}}},hillshade:function(h,g,p,b){if(h.renderPass==="offscreen"||h.renderPass==="translucent"){for(var N=h.context,q=h.depthModeForSublayer(0,Et.ReadOnly),ee=h.colorModeForRenderPass(),ge=h.renderPass==="translucent"?h.stencilConfigForOverlap(b):[{},b],Ue=ge[0],st=0,kt=ge[1];st<kt.length;st+=1){var Lt=kt[st],Zt=g.getTile(Lt);Zt.needsHillshadePrepare&&h.renderPass==="offscreen"?ts(h,Zt,p,q,Bt.disabled,ee):h.renderPass==="translucent"&&Jl(h,Zt,p,q,Ue[Lt.overscaledZ],ee)}N.viewport.set([0,0,h.width,h.height])}},raster:function(h,g,p,b){if(h.renderPass==="translucent"&&p.paint.get("raster-opacity")!==0&&b.length)for(var N=h.context,q=N.gl,ee=g.getSource(),ge=h.useProgram("raster"),Ue=h.colorModeForRenderPass(),st=ee instanceof bt?[{},b]:h.stencilConfigForOverlap(b),kt=st[0],Lt=st[1],Zt=Lt[Lt.length-1].overscaledZ,vr=!h.options.moving,pr=0,Nr=Lt;pr<Nr.length;pr+=1){var cr=Nr[pr],zr=h.depthModeForSublayer(cr.overscaledZ-Zt,p.paint.get("raster-opacity")===1?Et.ReadWrite:Et.ReadOnly,q.LESS),Ur=g.getTile(cr),Tn=h.transform.calculatePosMatrix(cr.toUnwrapped(),vr);Ur.registerFadeDuration(p.paint.get("raster-fade-duration"));var ti=g.findLoadedParent(cr,0),Yn=gs(Ur,ti,g,p,h.transform),ai=void 0,Pi=void 0,va=p.paint.get("raster-resampling")==="nearest"?q.NEAREST:q.LINEAR;N.activeTexture.set(q.TEXTURE0),Ur.texture.bind(va,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),N.activeTexture.set(q.TEXTURE1),ti?(ti.texture.bind(va,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),ai=Math.pow(2,ti.tileID.overscaledZ-Ur.tileID.overscaledZ),Pi=[Ur.tileID.canonical.x*ai%1,Ur.tileID.canonical.y*ai%1]):Ur.texture.bind(va,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST);var na=pf(Tn,Pi||[0,0],ai||1,Yn,p);ee instanceof bt?ge.draw(N,q.TRIANGLES,zr,Bt.disabled,Ue,St.disabled,na,p.id,ee.boundsBuffer,h.quadTriangleIndexBuffer,ee.boundsSegments):ge.draw(N,q.TRIANGLES,zr,kt[cr.overscaledZ],Ue,St.disabled,na,p.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}},background:function(h,g,p){var b=p.paint.get("background-color"),N=p.paint.get("background-opacity");if(N!==0){var q=h.context,ee=q.gl,ge=h.transform,Ue=ge.tileSize,st=p.paint.get("background-pattern");if(!h.isPatternMissing(st)){var kt=!st&&b.a===1&&N===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass===kt){var Lt=Bt.disabled,Zt=h.depthModeForSublayer(0,kt==="opaque"?Et.ReadWrite:Et.ReadOnly),vr=h.colorModeForRenderPass(),pr=h.useProgram(st?"backgroundPattern":"background"),Nr=ge.coveringTiles({tileSize:Ue});st&&(q.activeTexture.set(ee.TEXTURE0),h.imageManager.bind(h.context));for(var cr=p.getCrossfadeParameters(),zr=0,Ur=Nr;zr<Ur.length;zr+=1){var Tn=Ur[zr],ti=h.transform.calculatePosMatrix(Tn.toUnwrapped()),Yn=st?Tl(ti,N,h,st,{tileID:Tn,tileSize:Ue},cr):Ds(ti,N,b);pr.draw(q,ee.TRIANGLES,Zt,Lt,vr,St.disabled,Yn,p.id,h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}}}}},debug:function(h,g,p){for(var b=0;b<p.length;b++)Gc(h,g,p[b])},custom:function(h,g,p){var b=h.context,N=p.implementation;if(h.renderPass==="offscreen"){var q=N.prerender;q&&(h.setCustomLayerDefaults(),b.setColorMode(h.colorModeForRenderPass()),q.call(N,b.gl,h.transform.customLayerMatrix()),b.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),b.setColorMode(h.colorModeForRenderPass()),b.setStencilMode(Bt.disabled);var ee=N.renderingMode==="3d"?new Et(h.context.gl.LEQUAL,Et.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,Et.ReadOnly);b.setDepthMode(ee),N.render(b.gl,h.transform.customLayerMatrix()),b.setDirty(),h.setBaseState(),b.bindFramebuffer.set(null)}}},un=function(h,g){this.context=new tt(h),this.transform=g,this._tileTextures={},this.setup(),this.numSublayers=At.maxUnderzooming+At.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Mt,this.gpuTimers={}};un.prototype.resize=function(h,g){if(this.width=h*m.browser.devicePixelRatio,this.height=g*m.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var p=0,b=this.style._order;p<b.length;p+=1)this.style._layers[b[p]].resize()},un.prototype.setup=function(){var h=this.context,g=new m.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(m.EXTENT,0),g.emplaceBack(0,m.EXTENT),g.emplaceBack(m.EXTENT,m.EXTENT),this.tileExtentBuffer=h.createVertexBuffer(g,lt.members),this.tileExtentSegments=m.SegmentVector.simpleSegment(0,0,4,2);var p=new m.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(m.EXTENT,0),p.emplaceBack(0,m.EXTENT),p.emplaceBack(m.EXTENT,m.EXTENT),this.debugBuffer=h.createVertexBuffer(p,lt.members),this.debugSegments=m.SegmentVector.simpleSegment(0,0,4,5);var b=new m.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(m.EXTENT,0,m.EXTENT,0),b.emplaceBack(0,m.EXTENT,0,m.EXTENT),b.emplaceBack(m.EXTENT,m.EXTENT,m.EXTENT,m.EXTENT),this.rasterBoundsBuffer=h.createVertexBuffer(b,vt.members),this.rasterBoundsSegments=m.SegmentVector.simpleSegment(0,0,4,2);var N=new m.StructArrayLayout2i4;N.emplaceBack(0,0),N.emplaceBack(1,0),N.emplaceBack(0,1),N.emplaceBack(1,1),this.viewportBuffer=h.createVertexBuffer(N,lt.members),this.viewportSegments=m.SegmentVector.simpleSegment(0,0,4,2);var q=new m.StructArrayLayout1ui2;q.emplaceBack(0),q.emplaceBack(1),q.emplaceBack(3),q.emplaceBack(2),q.emplaceBack(0),this.tileBorderIndexBuffer=h.createIndexBuffer(q);var ee=new m.StructArrayLayout3ui6;ee.emplaceBack(0,1,2),ee.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=h.createIndexBuffer(ee),this.emptyTexture=new m.Texture(h,{width:1,height:1,data:new Uint8Array([0,0,0,0])},h.gl.RGBA);var ge=this.context.gl;this.stencilClearMode=new Bt({func:ge.ALWAYS,mask:0},0,255,ge.ZERO,ge.ZERO,ge.ZERO)},un.prototype.clearStencil=function(){var h=this.context,g=h.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var p=m.create();m.ortho(p,0,this.width,this.height,0,0,1),m.scale(p,p,[g.drawingBufferWidth,g.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(h,g.TRIANGLES,Et.disabled,this.stencilClearMode,Le.disabled,St.disabled,ks(p),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},un.prototype._renderTileClippingMasks=function(h,g){if(this.currentStencilSource!==h.source&&h.isTileClipped()&&g&&g.length){this.currentStencilSource=h.source;var p=this.context,b=p.gl;this.nextStencilID+g.length>256&&this.clearStencil(),p.setColorMode(Le.disabled),p.setDepthMode(Et.disabled);var N=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var q=0,ee=g;q<ee.length;q+=1){var ge=ee[q],Ue=this._tileClippingMaskIDs[ge.key]=this.nextStencilID++;N.draw(p,b.TRIANGLES,Et.disabled,new Bt({func:b.ALWAYS,mask:0},Ue,255,b.KEEP,b.KEEP,b.REPLACE),Le.disabled,St.disabled,ks(ge.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},un.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var h=this.nextStencilID++,g=this.context.gl;return new Bt({func:g.NOTEQUAL,mask:255},h,255,g.KEEP,g.KEEP,g.REPLACE)},un.prototype.stencilModeForClipping=function(h){var g=this.context.gl;return new Bt({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[h.key],0,g.KEEP,g.KEEP,g.REPLACE)},un.prototype.stencilConfigForOverlap=function(h){var g,p=this.context.gl,b=h.sort(function(Ue,st){return st.overscaledZ-Ue.overscaledZ}),N=b[b.length-1].overscaledZ,q=b[0].overscaledZ-N+1;if(q>1){this.currentStencilSource=void 0,this.nextStencilID+q>256&&this.clearStencil();for(var ee={},ge=0;ge<q;ge++)ee[ge+N]=new Bt({func:p.GEQUAL,mask:255},ge+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=q,[ee,b]}return[(g={},g[N]=Bt.disabled,g),b]},un.prototype.colorModeForRenderPass=function(){var h=this.context.gl;return this._showOverdrawInspector?new Le([h.CONSTANT_COLOR,h.ONE],new m.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Le.unblended:Le.alphaBlended},un.prototype.depthModeForSublayer=function(h,g,p){if(!this.opaquePassEnabledForLayer())return Et.disabled;var b=1-((1+this.currentLayer)*this.numSublayers+h)*this.depthEpsilon;return new Et(p||this.context.gl.LEQUAL,g,[b,b])},un.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},un.prototype.render=function(h,g){var p=this;this.style=h,this.options=g,this.lineAtlas=h.lineAtlas,this.imageManager=h.imageManager,this.glyphManager=h.glyphManager,this.symbolFadeChange=h.placement.symbolFadeChange(m.browser.now()),this.imageManager.beginFrame();var b=this.style._order,N=this.style.sourceCaches;for(var q in N){var ee=N[q];ee.used&&ee.prepare(this.context)}var ge,Ue,st={},kt={},Lt={};for(var Zt in N){var vr=N[Zt];st[Zt]=vr.getVisibleCoordinates(),kt[Zt]=st[Zt].slice().reverse(),Lt[Zt]=vr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var pr=0;pr<b.length;pr++)if(this.style._layers[b[pr]].is3D()){this.opaquePassCutoff=pr;break}this.renderPass="offscreen";for(var Nr=0,cr=b;Nr<cr.length;Nr+=1){var zr=this.style._layers[cr[Nr]];if(zr.hasOffscreenPass()&&!zr.isHidden(this.transform.zoom)){var Ur=kt[zr.source];(zr.type==="custom"||Ur.length)&&this.renderLayer(this,N[zr.source],zr,Ur)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:g.showOverdrawInspector?m.Color.black:m.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=g.showOverdrawInspector,this.depthRangeFor3D=[0,1-(h._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){var Tn=this.style._layers[b[this.currentLayer]],ti=N[Tn.source],Yn=st[Tn.source];this._renderTileClippingMasks(Tn,Yn),this.renderLayer(this,ti,Tn,Yn)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){var ai=this.style._layers[b[this.currentLayer]],Pi=N[ai.source],va=(ai.type==="symbol"?Lt:kt)[ai.source];this._renderTileClippingMasks(ai,st[ai.source]),this.renderLayer(this,Pi,ai,va)}this.options.showTileBoundaries&&(m.values(this.style._layers).forEach(function(na){na.source&&!na.isHidden(p.transform.zoom)&&(na.source!==(Ue&&Ue.id)&&(Ue=p.style.sourceCaches[na.source]),(!ge||ge.getSource().maxzoom<Ue.getSource().maxzoom)&&(ge=Ue))}),ge&&kc.debug(this,ge,ge.getVisibleCoordinates())),this.options.showPadding&&function(na){var Ua=na.transform.padding;zs(na,na.transform.height-(Ua.top||0),3,$o),zs(na,Ua.bottom||0,3,ds),df(na,Ua.left||0,3,Ns),df(na,na.transform.width-(Ua.right||0),3,Mu);var co=na.transform.centerPoint;(function(Eo,ho,qo,ga){ha(Eo,ho-1,qo-10,2,20,ga),ha(Eo,ho-10,qo-1,20,2,ga)})(na,co.x,na.transform.height-co.y,ec)}(this),this.context.setDefault()},un.prototype.renderLayer=function(h,g,p,b){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="custom"||b.length)&&(this.id=p.id,this.gpuTimingStart(p),kc[p.type](h,g,p,b,this.style.placement.variableOffsets),this.gpuTimingEnd())},un.prototype.gpuTimingStart=function(h){if(this.options.gpuTiming){var g=this.context.extTimerQuery,p=this.gpuTimers[h.id];p||(p=this.gpuTimers[h.id]={calls:0,cpuTime:0,query:g.createQueryEXT()}),p.calls++,g.beginQueryEXT(g.TIME_ELAPSED_EXT,p.query)}},un.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}},un.prototype.collectGpuTimers=function(){var h=this.gpuTimers;return this.gpuTimers={},h},un.prototype.queryGpuTimers=function(h){var g={};for(var p in h){var b=h[p],N=this.context.extTimerQuery,q=N.getQueryObjectEXT(b.query,N.QUERY_RESULT_EXT)/1e6;N.deleteQueryEXT(b.query),g[p]=q}return g},un.prototype.translatePosMatrix=function(h,g,p,b,N){if(!p[0]&&!p[1])return h;var q=N?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(q){var ee=Math.sin(q),ge=Math.cos(q);p=[p[0]*ge-p[1]*ee,p[0]*ee+p[1]*ge]}var Ue=[N?p[0]:_o(g,p[0],this.transform.zoom),N?p[1]:_o(g,p[1],this.transform.zoom),0],st=new Float32Array(16);return m.translate(st,h,Ue),st},un.prototype.saveTileTexture=function(h){var g=this._tileTextures[h.size[0]];g?g.push(h):this._tileTextures[h.size[0]]=[h]},un.prototype.getTileTexture=function(h){var g=this._tileTextures[h];return g&&g.length>0?g.pop():null},un.prototype.isPatternMissing=function(h){if(!h)return!1;if(!h.from||!h.to)return!0;var g=this.imageManager.getPattern(h.from.toString()),p=this.imageManager.getPattern(h.to.toString());return!g||!p},un.prototype.useProgram=function(h,g){this.cache=this.cache||{};var p=""+h+(g?g.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[p]||(this.cache[p]=new so(this.context,h,Ho[h],g,Yu[h],this._showOverdrawInspector)),this.cache[p]},un.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},un.prototype.setBaseState=function(){var h=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(h.FUNC_ADD)},un.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=m.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new m.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},un.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Mi=function(h,g){this.points=h,this.planes=g};Mi.fromInvProjectionMatrix=function(h,g,p){var b=Math.pow(2,p),N=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(ee){return m.transformMat4([],ee,h)}).map(function(ee){return m.scale$1([],ee,1/ee[3]/g*b)}),q=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(ee){var ge=m.sub([],N[ee[0]],N[ee[1]]),Ue=m.sub([],N[ee[2]],N[ee[1]]),st=m.normalize([],m.cross([],ge,Ue)),kt=-m.dot(st,N[ee[1]]);return st.concat(kt)});return new Mi(N,q)};var ei=function(h,g){this.min=h,this.max=g,this.center=m.scale$2([],m.add([],this.min,this.max),.5)};ei.prototype.quadrant=function(h){for(var g=[h%2==0,h<2],p=m.clone$2(this.min),b=m.clone$2(this.max),N=0;N<g.length;N++)p[N]=g[N]?this.min[N]:this.center[N],b[N]=g[N]?this.center[N]:this.max[N];return b[2]=this.max[2],new ei(p,b)},ei.prototype.distanceX=function(h){return Math.max(Math.min(this.max[0],h[0]),this.min[0])-h[0]},ei.prototype.distanceY=function(h){return Math.max(Math.min(this.max[1],h[1]),this.min[1])-h[1]},ei.prototype.intersects=function(h){for(var g=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],p=!0,b=0;b<h.planes.length;b++){for(var N=h.planes[b],q=0,ee=0;ee<g.length;ee++)q+=m.dot$1(N,g[ee])>=0;if(q===0)return 0;q!==g.length&&(p=!1)}if(p)return 2;for(var ge=0;ge<3;ge++){for(var Ue=Number.MAX_VALUE,st=-Number.MAX_VALUE,kt=0;kt<h.points.length;kt++){var Lt=h.points[kt][ge]-this.min[ge];Ue=Math.min(Ue,Lt),st=Math.max(st,Lt)}if(st<0||Ue>this.max[ge]-this.min[ge])return 0}return 1};var za=function(h,g,p,b){if(h===void 0&&(h=0),g===void 0&&(g=0),p===void 0&&(p=0),b===void 0&&(b=0),isNaN(h)||h<0||isNaN(g)||g<0||isNaN(p)||p<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=g,this.left=p,this.right=b};za.prototype.interpolate=function(h,g,p){return g.top!=null&&h.top!=null&&(this.top=m.number(h.top,g.top,p)),g.bottom!=null&&h.bottom!=null&&(this.bottom=m.number(h.bottom,g.bottom,p)),g.left!=null&&h.left!=null&&(this.left=m.number(h.left,g.left,p)),g.right!=null&&h.right!=null&&(this.right=m.number(h.right,g.right,p)),this},za.prototype.getCenter=function(h,g){var p=m.clamp((this.left+h-this.right)/2,0,h),b=m.clamp((this.top+g-this.bottom)/2,0,g);return new m.Point(p,b)},za.prototype.equals=function(h){return this.top===h.top&&this.bottom===h.bottom&&this.left===h.left&&this.right===h.right},za.prototype.clone=function(){return new za(this.top,this.bottom,this.left,this.right)},za.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Za=function(h,g,p,b,N){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=N===void 0||N,this._minZoom=h||0,this._maxZoom=g||22,this._minPitch=p==null?0:p,this._maxPitch=b==null?60:b,this.setMaxBounds(),this.width=0,this.height=0,this._center=new m.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new za,this._posMatrixCache={},this._alignedPosMatrixCache={}},Oo={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Za.prototype.clone=function(){var h=new Za(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return h.tileSize=this.tileSize,h.latRange=this.latRange,h.width=this.width,h.height=this.height,h._center=this._center,h.zoom=this.zoom,h.angle=this.angle,h._fov=this._fov,h._pitch=this._pitch,h._unmodified=this._unmodified,h._edgeInsets=this._edgeInsets.clone(),h._calcMatrices(),h},Oo.minZoom.get=function(){return this._minZoom},Oo.minZoom.set=function(h){this._minZoom!==h&&(this._minZoom=h,this.zoom=Math.max(this.zoom,h))},Oo.maxZoom.get=function(){return this._maxZoom},Oo.maxZoom.set=function(h){this._maxZoom!==h&&(this._maxZoom=h,this.zoom=Math.min(this.zoom,h))},Oo.minPitch.get=function(){return this._minPitch},Oo.minPitch.set=function(h){this._minPitch!==h&&(this._minPitch=h,this.pitch=Math.max(this.pitch,h))},Oo.maxPitch.get=function(){return this._maxPitch},Oo.maxPitch.set=function(h){this._maxPitch!==h&&(this._maxPitch=h,this.pitch=Math.min(this.pitch,h))},Oo.renderWorldCopies.get=function(){return this._renderWorldCopies},Oo.renderWorldCopies.set=function(h){h===void 0?h=!0:h===null&&(h=!1),this._renderWorldCopies=h},Oo.worldSize.get=function(){return this.tileSize*this.scale},Oo.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Oo.size.get=function(){return new m.Point(this.width,this.height)},Oo.bearing.get=function(){return-this.angle/Math.PI*180},Oo.bearing.set=function(h){var g=-m.wrap(h,-180,180)*Math.PI/180;this.angle!==g&&(this._unmodified=!1,this.angle=g,this._calcMatrices(),this.rotationMatrix=m.create$2(),m.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Oo.pitch.get=function(){return this._pitch/Math.PI*180},Oo.pitch.set=function(h){var g=m.clamp(h,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==g&&(this._unmodified=!1,this._pitch=g,this._calcMatrices())},Oo.fov.get=function(){return this._fov/Math.PI*180},Oo.fov.set=function(h){h=Math.max(.01,Math.min(60,h)),this._fov!==h&&(this._unmodified=!1,this._fov=h/180*Math.PI,this._calcMatrices())},Oo.zoom.get=function(){return this._zoom},Oo.zoom.set=function(h){var g=Math.min(Math.max(h,this.minZoom),this.maxZoom);this._zoom!==g&&(this._unmodified=!1,this._zoom=g,this.scale=this.zoomScale(g),this.tileZoom=Math.floor(g),this.zoomFraction=g-this.tileZoom,this._constrain(),this._calcMatrices())},Oo.center.get=function(){return this._center},Oo.center.set=function(h){h.lat===this._center.lat&&h.lng===this._center.lng||(this._unmodified=!1,this._center=h,this._constrain(),this._calcMatrices())},Oo.padding.get=function(){return this._edgeInsets.toJSON()},Oo.padding.set=function(h){this._edgeInsets.equals(h)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,h,1),this._calcMatrices())},Oo.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Za.prototype.isPaddingEqual=function(h){return this._edgeInsets.equals(h)},Za.prototype.interpolatePadding=function(h,g,p){this._unmodified=!1,this._edgeInsets.interpolate(h,g,p),this._constrain(),this._calcMatrices()},Za.prototype.coveringZoomLevel=function(h){var g=(h.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/h.tileSize));return Math.max(0,g)},Za.prototype.getVisibleUnwrappedCoordinates=function(h){var g=[new m.UnwrappedTileID(0,h)];if(this._renderWorldCopies)for(var p=this.pointCoordinate(new m.Point(0,0)),b=this.pointCoordinate(new m.Point(this.width,0)),N=this.pointCoordinate(new m.Point(this.width,this.height)),q=this.pointCoordinate(new m.Point(0,this.height)),ee=Math.floor(Math.min(p.x,b.x,N.x,q.x)),ge=Math.floor(Math.max(p.x,b.x,N.x,q.x)),Ue=ee-1;Ue<=ge+1;Ue++)Ue!==0&&g.push(new m.UnwrappedTileID(Ue,h));return g},Za.prototype.coveringTiles=function(h){var g=this.coveringZoomLevel(h),p=g;if(h.minzoom!==void 0&&g<h.minzoom)return[];h.maxzoom!==void 0&&g>h.maxzoom&&(g=h.maxzoom);var b=m.MercatorCoordinate.fromLngLat(this.center),N=Math.pow(2,g),q=[N*b.x,N*b.y,0],ee=Mi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g),ge=h.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ge=g);var Ue=function(na){return{aabb:new ei([na*N,0,0],[(na+1)*N,N,0]),zoom:0,x:0,y:0,wrap:na,fullyVisible:!1}},st=[],kt=[],Lt=g,Zt=h.reparseOverscaled?p:g;if(this._renderWorldCopies)for(var vr=1;vr<=3;vr++)st.push(Ue(-vr)),st.push(Ue(vr));for(st.push(Ue(0));st.length>0;){var pr=st.pop(),Nr=pr.x,cr=pr.y,zr=pr.fullyVisible;if(!zr){var Ur=pr.aabb.intersects(ee);if(Ur===0)continue;zr=Ur===2}var Tn=pr.aabb.distanceX(q),ti=pr.aabb.distanceY(q),Yn=Math.max(Math.abs(Tn),Math.abs(ti));if(pr.zoom===Lt||Yn>3+(1<<Lt-pr.zoom)-2&&pr.zoom>=ge)kt.push({tileID:new m.OverscaledTileID(pr.zoom===Lt?Zt:pr.zoom,pr.wrap,pr.zoom,Nr,cr),distanceSq:m.sqrLen([q[0]-.5-Nr,q[1]-.5-cr])});else for(var ai=0;ai<4;ai++){var Pi=(Nr<<1)+ai%2,va=(cr<<1)+(ai>>1);st.push({aabb:pr.aabb.quadrant(ai),zoom:pr.zoom+1,x:Pi,y:va,wrap:pr.wrap,fullyVisible:zr})}}return kt.sort(function(na,Ua){return na.distanceSq-Ua.distanceSq}).map(function(na){return na.tileID})},Za.prototype.resize=function(h,g){this.width=h,this.height=g,this.pixelsToGLUnits=[2/h,-2/g],this._constrain(),this._calcMatrices()},Oo.unmodified.get=function(){return this._unmodified},Za.prototype.zoomScale=function(h){return Math.pow(2,h)},Za.prototype.scaleZoom=function(h){return Math.log(h)/Math.LN2},Za.prototype.project=function(h){var g=m.clamp(h.lat,-this.maxValidLatitude,this.maxValidLatitude);return new m.Point(m.mercatorXfromLng(h.lng)*this.worldSize,m.mercatorYfromLat(g)*this.worldSize)},Za.prototype.unproject=function(h){return new m.MercatorCoordinate(h.x/this.worldSize,h.y/this.worldSize).toLngLat()},Oo.point.get=function(){return this.project(this.center)},Za.prototype.setLocationAtPoint=function(h,g){var p=this.pointCoordinate(g),b=this.pointCoordinate(this.centerPoint),N=this.locationCoordinate(h),q=new m.MercatorCoordinate(N.x-(p.x-b.x),N.y-(p.y-b.y));this.center=this.coordinateLocation(q),this._renderWorldCopies&&(this.center=this.center.wrap())},Za.prototype.locationPoint=function(h){return this.coordinatePoint(this.locationCoordinate(h))},Za.prototype.pointLocation=function(h){return this.coordinateLocation(this.pointCoordinate(h))},Za.prototype.locationCoordinate=function(h){return m.MercatorCoordinate.fromLngLat(h)},Za.prototype.coordinateLocation=function(h){return h.toLngLat()},Za.prototype.pointCoordinate=function(h){var g=[h.x,h.y,0,1],p=[h.x,h.y,1,1];m.transformMat4(g,g,this.pixelMatrixInverse),m.transformMat4(p,p,this.pixelMatrixInverse);var b=g[3],N=p[3],q=g[1]/b,ee=p[1]/N,ge=g[2]/b,Ue=p[2]/N,st=ge===Ue?0:(0-ge)/(Ue-ge);return new m.MercatorCoordinate(m.number(g[0]/b,p[0]/N,st)/this.worldSize,m.number(q,ee,st)/this.worldSize)},Za.prototype.coordinatePoint=function(h){var g=[h.x*this.worldSize,h.y*this.worldSize,0,1];return m.transformMat4(g,g,this.pixelMatrix),new m.Point(g[0]/g[3],g[1]/g[3])},Za.prototype.getBounds=function(){return new m.LngLatBounds().extend(this.pointLocation(new m.Point(0,0))).extend(this.pointLocation(new m.Point(this.width,0))).extend(this.pointLocation(new m.Point(this.width,this.height))).extend(this.pointLocation(new m.Point(0,this.height)))},Za.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new m.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Za.prototype.setMaxBounds=function(h){h?(this.lngRange=[h.getWest(),h.getEast()],this.latRange=[h.getSouth(),h.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Za.prototype.calculatePosMatrix=function(h,g){g===void 0&&(g=!1);var p=h.key,b=g?this._alignedPosMatrixCache:this._posMatrixCache;if(b[p])return b[p];var N=h.canonical,q=this.worldSize/this.zoomScale(N.z),ee=N.x+Math.pow(2,N.z)*h.wrap,ge=m.identity(new Float64Array(16));return m.translate(ge,ge,[ee*q,N.y*q,0]),m.scale(ge,ge,[q/m.EXTENT,q/m.EXTENT,1]),m.multiply(ge,g?this.alignedProjMatrix:this.projMatrix,ge),b[p]=new Float32Array(ge),b[p]},Za.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Za.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var h,g,p,b,N=-90,q=90,ee=-180,ge=180,Ue=this.size,st=this._unmodified;if(this.latRange){var kt=this.latRange;N=m.mercatorYfromLat(kt[1])*this.worldSize,h=(q=m.mercatorYfromLat(kt[0])*this.worldSize)-N<Ue.y?Ue.y/(q-N):0}if(this.lngRange){var Lt=this.lngRange;ee=m.mercatorXfromLng(Lt[0])*this.worldSize,g=(ge=m.mercatorXfromLng(Lt[1])*this.worldSize)-ee<Ue.x?Ue.x/(ge-ee):0}var Zt=this.point,vr=Math.max(g||0,h||0);if(vr)return this.center=this.unproject(new m.Point(g?(ge+ee)/2:Zt.x,h?(q+N)/2:Zt.y)),this.zoom+=this.scaleZoom(vr),this._unmodified=st,void(this._constraining=!1);if(this.latRange){var pr=Zt.y,Nr=Ue.y/2;pr-Nr<N&&(b=N+Nr),pr+Nr>q&&(b=q-Nr)}if(this.lngRange){var cr=Zt.x,zr=Ue.x/2;cr-zr<ee&&(p=ee+zr),cr+zr>ge&&(p=ge-zr)}p===void 0&&b===void 0||(this.center=this.unproject(new m.Point(p!==void 0?p:Zt.x,b!==void 0?b:Zt.y))),this._unmodified=st,this._constraining=!1}},Za.prototype._calcMatrices=function(){if(this.height){var h=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var g=Math.PI/2+this._pitch,p=this._fov*(.5+h.y/this.height),b=Math.sin(p)*this.cameraToCenterDistance/Math.sin(m.clamp(Math.PI-g-p,.01,Math.PI-.01)),N=this.point,q=N.x,ee=N.y,ge=1.01*(Math.cos(Math.PI/2-this._pitch)*b+this.cameraToCenterDistance),Ue=this.height/50,st=new Float64Array(16);m.perspective(st,this._fov,this.width/this.height,Ue,ge),st[8]=2*-h.x/this.width,st[9]=2*h.y/this.height,m.scale(st,st,[1,-1,1]),m.translate(st,st,[0,0,-this.cameraToCenterDistance]),m.rotateX(st,st,this._pitch),m.rotateZ(st,st,this.angle),m.translate(st,st,[-q,-ee,0]),this.mercatorMatrix=m.scale([],st,[this.worldSize,this.worldSize,this.worldSize]),m.scale(st,st,[1,1,m.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=st,this.invProjMatrix=m.invert([],this.projMatrix);var kt=this.width%2/2,Lt=this.height%2/2,Zt=Math.cos(this.angle),vr=Math.sin(this.angle),pr=q-Math.round(q)+Zt*kt+vr*Lt,Nr=ee-Math.round(ee)+Zt*Lt+vr*kt,cr=new Float64Array(st);if(m.translate(cr,cr,[pr>.5?pr-1:pr,Nr>.5?Nr-1:Nr,0]),this.alignedProjMatrix=cr,st=m.create(),m.scale(st,st,[this.width/2,-this.height/2,1]),m.translate(st,st,[1,-1,0]),this.labelPlaneMatrix=st,st=m.create(),m.scale(st,st,[1,-1,1]),m.translate(st,st,[-1,-1,0]),m.scale(st,st,[2/this.width,2/this.height,1]),this.glCoordMatrix=st,this.pixelMatrix=m.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(st=m.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=st,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Za.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var h=this.pointCoordinate(new m.Point(0,0)),g=[h.x*this.worldSize,h.y*this.worldSize,0,1];return m.transformMat4(g,g,this.pixelMatrix)[3]/this.cameraToCenterDistance},Za.prototype.getCameraPoint=function(){var h=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new m.Point(0,h))},Za.prototype.getCameraQueryGeometry=function(h){var g=this.getCameraPoint();if(h.length===1)return[h[0],g];for(var p=g.x,b=g.y,N=g.x,q=g.y,ee=0,ge=h;ee<ge.length;ee+=1){var Ue=ge[ee];p=Math.min(p,Ue.x),b=Math.min(b,Ue.y),N=Math.max(N,Ue.x),q=Math.max(q,Ue.y)}return[new m.Point(p,b),new m.Point(N,b),new m.Point(N,q),new m.Point(p,q),new m.Point(p,b)]},Object.defineProperties(Za.prototype,Oo);var mu=function(h){var g,p,b,N;this._hashName=h&&encodeURIComponent(h),m.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(g=this._updateHashUnthrottled.bind(this),p=!1,b=null,N=function(){b=null,p&&(g(),b=setTimeout(N,300),p=!1)},function(){return p=!0,b||N(),b})};mu.prototype.addTo=function(h){return this._map=h,m.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},mu.prototype.remove=function(){return m.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},mu.prototype.getHashString=function(h){var g=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,b=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),N=Math.pow(10,b),q=Math.round(g.lng*N)/N,ee=Math.round(g.lat*N)/N,ge=this._map.getBearing(),Ue=this._map.getPitch(),st="";if(st+=h?"/"+q+"/"+ee+"/"+p:p+"/"+ee+"/"+q,(ge||Ue)&&(st+="/"+Math.round(10*ge)/10),Ue&&(st+="/"+Math.round(Ue)),this._hashName){var kt=this._hashName,Lt=!1,Zt=m.window.location.hash.slice(1).split("&").map(function(vr){var pr=vr.split("=")[0];return pr===kt?(Lt=!0,pr+"="+st):vr}).filter(function(vr){return vr});return Lt||Zt.push(kt+"="+st),"#"+Zt.join("&")}return"#"+st},mu.prototype._getCurrentHash=function(){var h,g=this,p=m.window.location.hash.replace("#","");return this._hashName?(p.split("&").map(function(b){return b.split("=")}).forEach(function(b){b[0]===g._hashName&&(h=b)}),(h&&h[1]||"").split("/")):p.split("/")},mu.prototype._onHashChange=function(){var h=this._getCurrentHash();if(h.length>=3&&!h.some(function(p){return isNaN(p)})){var g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(h[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:g,pitch:+(h[4]||0)}),!0}return!1},mu.prototype._updateHashUnthrottled=function(){var h=m.window.location.href.replace(/(#.+)?$/,this.getHashString());try{m.window.history.replaceState(m.window.history.state,null,h)}catch(g){}};var Au={linearity:.3,easing:m.bezier(0,0,.3,1)},Rl=m.extend({deceleration:2500,maxSpeed:1400},Au),xh=m.extend({deceleration:20,maxSpeed:1400},Au),vf=m.extend({deceleration:1e3,maxSpeed:360},Au),Wh=m.extend({deceleration:1e3,maxSpeed:90},Au),oh=function(h){this._map=h,this.clear()};function mc(h,g){(!h.duration||h.duration<g.duration)&&(h.duration=g.duration,h.easing=g.easing)}function lc(h,g,p){var b=p.maxSpeed,N=p.linearity,q=p.deceleration,ee=m.clamp(h*N/(g/1e3),-b,b),ge=Math.abs(ee)/(q*N);return{easing:p.easing,duration:1e3*ge,amount:ee*(ge/2)}}oh.prototype.clear=function(){this._inertiaBuffer=[]},oh.prototype.record=function(h){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:m.browser.now(),settings:h})},oh.prototype._drainInertiaBuffer=function(){for(var h=this._inertiaBuffer,g=m.browser.now();h.length>0&&g-h[0].time>160;)h.shift()},oh.prototype._onMoveEnd=function(h){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var g={zoom:0,bearing:0,pitch:0,pan:new m.Point(0,0),pinchAround:void 0,around:void 0},p=0,b=this._inertiaBuffer;p<b.length;p+=1){var N=b[p].settings;g.zoom+=N.zoomDelta||0,g.bearing+=N.bearingDelta||0,g.pitch+=N.pitchDelta||0,N.panDelta&&g.pan._add(N.panDelta),N.around&&(g.around=N.around),N.pinchAround&&(g.pinchAround=N.pinchAround)}var q=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,ee={};if(g.pan.mag()){var ge=lc(g.pan.mag(),q,m.extend({},Rl,h||{}));ee.offset=g.pan.mult(ge.amount/g.pan.mag()),ee.center=this._map.transform.center,mc(ee,ge)}if(g.zoom){var Ue=lc(g.zoom,q,xh);ee.zoom=this._map.transform.zoom+Ue.amount,mc(ee,Ue)}if(g.bearing){var st=lc(g.bearing,q,vf);ee.bearing=this._map.transform.bearing+m.clamp(st.amount,-179,179),mc(ee,st)}if(g.pitch){var kt=lc(g.pitch,q,Wh);ee.pitch=this._map.transform.pitch+kt.amount,mc(ee,kt)}if(ee.zoom||ee.bearing){var Lt=g.pinchAround===void 0?g.around:g.pinchAround;ee.around=Lt?this._map.unproject(Lt):this._map.getCenter()}return this.clear(),m.extend(ee,{noMoveStart:!0})}};var Ku=function(h){function g(b,N,q,ee){ee===void 0&&(ee={});var ge=F.mousePos(N.getCanvasContainer(),q),Ue=N.unproject(ge);h.call(this,b,m.extend({point:ge,lngLat:Ue,originalEvent:q},ee)),this._defaultPrevented=!1,this.target=N}h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g;var p={defaultPrevented:{configurable:!0}};return g.prototype.preventDefault=function(){this._defaultPrevented=!0},p.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(g.prototype,p),g}(m.Event),xs=function(h){function g(b,N,q){var ee=b==="touchend"?q.changedTouches:q.touches,ge=F.touchPos(N.getCanvasContainer(),ee),Ue=ge.map(function(Lt){return N.unproject(Lt)}),st=ge.reduce(function(Lt,Zt,vr,pr){return Lt.add(Zt.div(pr.length))},new m.Point(0,0)),kt=N.unproject(st);h.call(this,b,{points:ge,point:st,lngLats:Ue,lngLat:kt,originalEvent:q}),this._defaultPrevented=!1}h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g;var p={defaultPrevented:{configurable:!0}};return g.prototype.preventDefault=function(){this._defaultPrevented=!0},p.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(g.prototype,p),g}(m.Event),sh=function(h){function g(b,N,q){h.call(this,b,{originalEvent:q}),this._defaultPrevented=!1}h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g;var p={defaultPrevented:{configurable:!0}};return g.prototype.preventDefault=function(){this._defaultPrevented=!0},p.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(g.prototype,p),g}(m.Event),bl=function(h,g){this._map=h,this._clickTolerance=g.clickTolerance};bl.prototype.reset=function(){delete this._mousedownPos},bl.prototype.wheel=function(h){return this._firePreventable(new sh(h.type,this._map,h))},bl.prototype.mousedown=function(h,g){return this._mousedownPos=g,this._firePreventable(new Ku(h.type,this._map,h))},bl.prototype.mouseup=function(h){this._map.fire(new Ku(h.type,this._map,h))},bl.prototype.click=function(h,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||this._map.fire(new Ku(h.type,this._map,h))},bl.prototype.dblclick=function(h){return this._firePreventable(new Ku(h.type,this._map,h))},bl.prototype.mouseover=function(h){this._map.fire(new Ku(h.type,this._map,h))},bl.prototype.mouseout=function(h){this._map.fire(new Ku(h.type,this._map,h))},bl.prototype.touchstart=function(h){return this._firePreventable(new xs(h.type,this._map,h))},bl.prototype.touchmove=function(h){this._map.fire(new xs(h.type,this._map,h))},bl.prototype.touchend=function(h){this._map.fire(new xs(h.type,this._map,h))},bl.prototype.touchcancel=function(h){this._map.fire(new xs(h.type,this._map,h))},bl.prototype._firePreventable=function(h){if(this._map.fire(h),h.defaultPrevented)return{}},bl.prototype.isEnabled=function(){return!0},bl.prototype.isActive=function(){return!1},bl.prototype.enable=function(){},bl.prototype.disable=function(){};var Ca=function(h){this._map=h};Ca.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Ca.prototype.mousemove=function(h){this._map.fire(new Ku(h.type,this._map,h))},Ca.prototype.mousedown=function(){this._delayContextMenu=!0},Ca.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ku("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Ca.prototype.contextmenu=function(h){this._delayContextMenu?this._contextMenuEvent=h:this._map.fire(new Ku(h.type,this._map,h)),this._map.listens("contextmenu")&&h.preventDefault()},Ca.prototype.isEnabled=function(){return!0},Ca.prototype.isActive=function(){return!1},Ca.prototype.enable=function(){},Ca.prototype.disable=function(){};var Zu=function(h,g){this._map=h,this._el=h.getCanvasContainer(),this._container=h.getContainer(),this._clickTolerance=g.clickTolerance||1};function $c(h,g){for(var p={},b=0;b<h.length;b++)p[h[b].identifier]=g[b];return p}Zu.prototype.isEnabled=function(){return!!this._enabled},Zu.prototype.isActive=function(){return!!this._active},Zu.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Zu.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Zu.prototype.mousedown=function(h,g){this.isEnabled()&&h.shiftKey&&h.button===0&&(F.disableDrag(),this._startPos=this._lastPos=g,this._active=!0)},Zu.prototype.mousemoveWindow=function(h,g){if(this._active){var p=g;if(!(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)){var b=this._startPos;this._lastPos=p,this._box||(this._box=F.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",h));var N=Math.min(b.x,p.x),q=Math.max(b.x,p.x),ee=Math.min(b.y,p.y),ge=Math.max(b.y,p.y);F.setTransform(this._box,"translate("+N+"px,"+ee+"px)"),this._box.style.width=q-N+"px",this._box.style.height=ge-ee+"px"}}},Zu.prototype.mouseupWindow=function(h,g){var p=this;if(this._active&&h.button===0){var b=this._startPos,N=g;if(this.reset(),F.suppressClick(),b.x!==N.x||b.y!==N.y)return this._map.fire(new m.Event("boxzoomend",{originalEvent:h})),{cameraAnimation:function(q){return q.fitScreenCoordinates(b,N,p._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",h)}},Zu.prototype.keydown=function(h){this._active&&h.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",h))},Zu.prototype.blur=function(){this.reset()},Zu.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(F.remove(this._box),this._box=null),F.enableDrag(),delete this._startPos,delete this._lastPos},Zu.prototype._fireEvent=function(h,g){return this._map.fire(new m.Event(h,{originalEvent:g}))};var os=function(h){this.reset(),this.numTouches=h.numTouches};os.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},os.prototype.touchstart=function(h,g,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=h.timeStamp),p.length===this.numTouches&&(this.centroid=function(b){for(var N=new m.Point(0,0),q=0,ee=b;q<ee.length;q+=1)N._add(ee[q]);return N.div(b.length)}(g),this.touches=$c(p,g)))},os.prototype.touchmove=function(h,g,p){if(!this.aborted&&this.centroid){var b=$c(p,g);for(var N in this.touches){var q=b[N];(!q||q.dist(this.touches[N])>30)&&(this.aborted=!0)}}},os.prototype.touchend=function(h,g,p){if((!this.centroid||h.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){var b=!this.aborted&&this.centroid;if(this.reset(),b)return b}};var yo=function(h){this.singleTap=new os(h),this.numTaps=h.numTaps,this.reset()};yo.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},yo.prototype.touchstart=function(h,g,p){this.singleTap.touchstart(h,g,p)},yo.prototype.touchmove=function(h,g,p){this.singleTap.touchmove(h,g,p)},yo.prototype.touchend=function(h,g,p){var b=this.singleTap.touchend(h,g,p);if(b){var N=h.timeStamp-this.lastTime<500,q=!this.lastTap||this.lastTap.dist(b)<30;if(N&&q||this.reset(),this.count++,this.lastTime=h.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}};var As=function(){this._zoomIn=new yo({numTouches:1,numTaps:2}),this._zoomOut=new yo({numTouches:2,numTaps:1}),this.reset()};As.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},As.prototype.touchstart=function(h,g,p){this._zoomIn.touchstart(h,g,p),this._zoomOut.touchstart(h,g,p)},As.prototype.touchmove=function(h,g,p){this._zoomIn.touchmove(h,g,p),this._zoomOut.touchmove(h,g,p)},As.prototype.touchend=function(h,g,p){var b=this,N=this._zoomIn.touchend(h,g,p),q=this._zoomOut.touchend(h,g,p);return N?(this._active=!0,h.preventDefault(),setTimeout(function(){return b.reset()},0),{cameraAnimation:function(ee){return ee.easeTo({duration:300,zoom:ee.getZoom()+1,around:ee.unproject(N)},{originalEvent:h})}}):q?(this._active=!0,h.preventDefault(),setTimeout(function(){return b.reset()},0),{cameraAnimation:function(ee){return ee.easeTo({duration:300,zoom:ee.getZoom()-1,around:ee.unproject(q)},{originalEvent:h})}}):void 0},As.prototype.touchcancel=function(){this.reset()},As.prototype.enable=function(){this._enabled=!0},As.prototype.disable=function(){this._enabled=!1,this.reset()},As.prototype.isEnabled=function(){return this._enabled},As.prototype.isActive=function(){return this._active};var Ul={0:1,2:2},Xi=function(h){this.reset(),this._clickTolerance=h.clickTolerance||1};Xi.prototype.blur=function(){this.reset()},Xi.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Xi.prototype._correctButton=function(h,g){return!1},Xi.prototype._move=function(h,g){return{}},Xi.prototype.mousedown=function(h,g){if(!this._lastPoint){var p=F.mouseButton(h);this._correctButton(h,p)&&(this._lastPoint=g,this._eventButton=p)}},Xi.prototype.mousemoveWindow=function(h,g){var p=this._lastPoint;if(p){if(h.preventDefault(),function(b,N){var q=Ul[N];return b.buttons===void 0||(b.buttons&q)!==q}(h,this._eventButton))this.reset();else if(this._moved||!(g.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=g,this._move(p,g)}},Xi.prototype.mouseupWindow=function(h){this._lastPoint&&F.mouseButton(h)===this._eventButton&&(this._moved&&F.suppressClick(),this.reset())},Xi.prototype.enable=function(){this._enabled=!0},Xi.prototype.disable=function(){this._enabled=!1,this.reset()},Xi.prototype.isEnabled=function(){return this._enabled},Xi.prototype.isActive=function(){return this._active};var cc=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.mousedown=function(p,b){h.prototype.mousedown.call(this,p,b),this._lastPoint&&(this._active=!0)},g.prototype._correctButton=function(p,b){return b===0&&!p.ctrlKey},g.prototype._move=function(p,b){return{around:b,panDelta:b.sub(p)}},g}(Xi),Dc=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype._correctButton=function(p,b){return b===0&&p.ctrlKey||b===2},g.prototype._move=function(p,b){var N=.8*(b.x-p.x);if(N)return this._active=!0,{bearingDelta:N}},g.prototype.contextmenu=function(p){p.preventDefault()},g}(Xi),af=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype._correctButton=function(p,b){return b===0&&p.ctrlKey||b===2},g.prototype._move=function(p,b){var N=-.5*(b.y-p.y);if(N)return this._active=!0,{pitchDelta:N}},g.prototype.contextmenu=function(p){p.preventDefault()},g}(Xi),Ws=function(h){this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset()};Ws.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new m.Point(0,0)},Ws.prototype.touchstart=function(h,g,p){return this._calculateTransform(h,g,p)},Ws.prototype.touchmove=function(h,g,p){if(this._active&&!(p.length<this._minTouches))return h.preventDefault(),this._calculateTransform(h,g,p)},Ws.prototype.touchend=function(h,g,p){this._calculateTransform(h,g,p),this._active&&p.length<this._minTouches&&this.reset()},Ws.prototype.touchcancel=function(){this.reset()},Ws.prototype._calculateTransform=function(h,g,p){p.length>0&&(this._active=!0);var b=$c(p,g),N=new m.Point(0,0),q=new m.Point(0,0),ee=0;for(var ge in b){var Ue=b[ge],st=this._touches[ge];st&&(N._add(Ue),q._add(Ue.sub(st)),ee++,b[ge]=Ue)}if(this._touches=b,!(ee<this._minTouches)&&q.mag()){var kt=q.div(ee);if(this._sum._add(kt),!(this._sum.mag()<this._clickTolerance))return{around:N.div(ee),panDelta:kt}}},Ws.prototype.enable=function(){this._enabled=!0},Ws.prototype.disable=function(){this._enabled=!1,this.reset()},Ws.prototype.isEnabled=function(){return this._enabled},Ws.prototype.isActive=function(){return this._active};var kl=function(){this.reset()};function Cc(h,g,p){for(var b=0;b<h.length;b++)if(h[b].identifier===p)return g[b]}function fc(h,g){return Math.log(h/g)/Math.LN2}kl.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},kl.prototype._start=function(h){},kl.prototype._move=function(h,g,p){return{}},kl.prototype.touchstart=function(h,g,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([g[0],g[1]]))},kl.prototype.touchmove=function(h,g,p){if(this._firstTwoTouches){h.preventDefault();var b=this._firstTwoTouches,N=b[1],q=Cc(p,g,b[0]),ee=Cc(p,g,N);if(q&&ee){var ge=this._aroundCenter?null:q.add(ee).div(2);return this._move([q,ee],ge,h)}}},kl.prototype.touchend=function(h,g,p){if(this._firstTwoTouches){var b=this._firstTwoTouches,N=b[1],q=Cc(p,g,b[0]),ee=Cc(p,g,N);q&&ee||(this._active&&F.suppressClick(),this.reset())}},kl.prototype.touchcancel=function(){this.reset()},kl.prototype.enable=function(h){this._enabled=!0,this._aroundCenter=!!h&&h.around==="center"},kl.prototype.disable=function(){this._enabled=!1,this.reset()},kl.prototype.isEnabled=function(){return this._enabled},kl.prototype.isActive=function(){return this._active};var Fc=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.reset=function(){h.prototype.reset.call(this),delete this._distance,delete this._startDistance},g.prototype._start=function(p){this._startDistance=this._distance=p[0].dist(p[1])},g.prototype._move=function(p,b){var N=this._distance;if(this._distance=p[0].dist(p[1]),this._active||!(Math.abs(fc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:fc(this._distance,N),pinchAround:b}},g}(kl);function Sf(h,g){return 180*h.angleWith(g)/Math.PI}var hc=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.reset=function(){h.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},g.prototype._start=function(p){this._startVector=this._vector=p[0].sub(p[1]),this._minDiameter=p[0].dist(p[1])},g.prototype._move=function(p,b){var N=this._vector;if(this._vector=p[0].sub(p[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Sf(this._vector,N),pinchAround:b}},g.prototype._isBelowThreshold=function(p){this._minDiameter=Math.min(this._minDiameter,p.mag());var b=25/(Math.PI*this._minDiameter)*360,N=Sf(p,this._startVector);return Math.abs(N)<b},g}(kl);function ap(h){return Math.abs(h.y)>Math.abs(h.x)}var jl=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.reset=function(){h.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},g.prototype._start=function(p){this._lastPoints=p,ap(p[0].sub(p[1]))&&(this._valid=!1)},g.prototype._move=function(p,b,N){var q=p[0].sub(this._lastPoints[0]),ee=p[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(q,ee,N.timeStamp),this._valid)return this._lastPoints=p,this._active=!0,{pitchDelta:(q.y+ee.y)/2*-.5}},g.prototype.gestureBeginsVertically=function(p,b,N){if(this._valid!==void 0)return this._valid;var q=p.mag()>=2,ee=b.mag()>=2;if(q||ee){if(!q||!ee)return this._firstMove===void 0&&(this._firstMove=N),N-this._firstMove<100&&void 0;var ge=p.y>0==b.y>0;return ap(p)&&ap(b)&&ge}},g}(kl),op={panStep:100,bearingStep:15,pitchStep:10},tc=function(){var h=op;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1};function Tu(h){return h*(2-h)}tc.prototype.blur=function(){this.reset()},tc.prototype.reset=function(){this._active=!1},tc.prototype.keydown=function(h){var g=this;if(!(h.altKey||h.ctrlKey||h.metaKey)){var p=0,b=0,N=0,q=0,ee=0;switch(h.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:h.shiftKey?b=-1:(h.preventDefault(),q=-1);break;case 39:h.shiftKey?b=1:(h.preventDefault(),q=1);break;case 38:h.shiftKey?N=1:(h.preventDefault(),ee=-1);break;case 40:h.shiftKey?N=-1:(h.preventDefault(),ee=1);break;default:return}return this._rotationDisabled&&(b=0,N=0),{cameraAnimation:function(ge){var Ue=ge.getZoom();ge.easeTo({duration:300,easeId:"keyboardHandler",easing:Tu,zoom:p?Math.round(Ue)+p*(h.shiftKey?2:1):Ue,bearing:ge.getBearing()+b*g._bearingStep,pitch:ge.getPitch()+N*g._pitchStep,offset:[-q*g._panStep,-ee*g._panStep],center:ge.getCenter()},{originalEvent:h})}}}},tc.prototype.enable=function(){this._enabled=!0},tc.prototype.disable=function(){this._enabled=!1,this.reset()},tc.prototype.isEnabled=function(){return this._enabled},tc.prototype.isActive=function(){return this._active},tc.prototype.disableRotation=function(){this._rotationDisabled=!0},tc.prototype.enableRotation=function(){this._rotationDisabled=!1};var bs=function(h,g){this._map=h,this._el=h.getCanvasContainer(),this._handler=g,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,m.bindAll(["_onTimeout"],this)};bs.prototype.setZoomRate=function(h){this._defaultZoomRate=h},bs.prototype.setWheelZoomRate=function(h){this._wheelZoomRate=h},bs.prototype.isEnabled=function(){return!!this._enabled},bs.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},bs.prototype.isZooming=function(){return!!this._zooming},bs.prototype.enable=function(h){this.isEnabled()||(this._enabled=!0,this._aroundCenter=h&&h.around==="center")},bs.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},bs.prototype.wheel=function(h){if(this.isEnabled()){var g=h.deltaMode===m.window.WheelEvent.DOM_DELTA_LINE?40*h.deltaY:h.deltaY,p=m.browser.now(),b=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,g!==0&&g%4.000244140625==0?this._type="wheel":g!==0&&Math.abs(g)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,h)):this._type||(this._type=Math.abs(b*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),h.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=h,this._delta-=g,this._active||this._start(h)),h.preventDefault()}},bs.prototype._onTimeout=function(h){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)},bs.prototype._start=function(h){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var g=F.mousePos(this._el,h);this._around=m.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(g)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},bs.prototype.renderFrame=function(){var h=this;if(this._frameId&&(this._frameId=null,this.isActive())){var g=this._map.transform;if(this._delta!==0){var p=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,b=2/(1+Math.exp(-Math.abs(this._delta*p)));this._delta<0&&b!==0&&(b=1/b);var N=typeof this._targetZoom=="number"?g.zoomScale(this._targetZoom):g.scale;this._targetZoom=Math.min(g.maxZoom,Math.max(g.minZoom,g.scaleZoom(N*b))),this._type==="wheel"&&(this._startZoom=g.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var q,ee=typeof this._targetZoom=="number"?this._targetZoom:g.zoom,ge=this._startZoom,Ue=this._easing,st=!1;if(this._type==="wheel"&&ge&&Ue){var kt=Math.min((m.browser.now()-this._lastWheelEventTime)/200,1),Lt=Ue(kt);q=m.number(ge,ee,Lt),kt<1?this._frameId||(this._frameId=!0):st=!0}else q=ee,st=!0;return this._active=!0,st&&(this._active=!1,this._finishTimeout=setTimeout(function(){h._zooming=!1,h._handler._triggerRenderFrame(),delete h._targetZoom,delete h._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!st,zoomDelta:q-g.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},bs.prototype._smoothOutEasing=function(h){var g=m.ease;if(this._prevEase){var p=this._prevEase,b=(m.browser.now()-p.start)/p.duration,N=p.easing(b+.01)-p.easing(b),q=.27/Math.sqrt(N*N+1e-4)*.01,ee=Math.sqrt(.0729-q*q);g=m.bezier(q,ee,.25,1)}return this._prevEase={start:m.browser.now(),duration:h,easing:g},g},bs.prototype.blur=function(){this.reset()},bs.prototype.reset=function(){this._active=!1};var Xf=function(h,g){this._clickZoom=h,this._tapZoom=g};Xf.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Xf.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Xf.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Xf.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Cf=function(){this.reset()};Cf.prototype.reset=function(){this._active=!1},Cf.prototype.blur=function(){this.reset()},Cf.prototype.dblclick=function(h,g){return h.preventDefault(),{cameraAnimation:function(p){p.easeTo({duration:300,zoom:p.getZoom()+(h.shiftKey?-1:1),around:p.unproject(g)},{originalEvent:h})}}},Cf.prototype.enable=function(){this._enabled=!0},Cf.prototype.disable=function(){this._enabled=!1,this.reset()},Cf.prototype.isEnabled=function(){return this._enabled},Cf.prototype.isActive=function(){return this._active};var cu=function(){this._tap=new yo({numTouches:1,numTaps:1}),this.reset()};cu.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},cu.prototype.touchstart=function(h,g,p){this._swipePoint||(this._tapTime&&h.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=g[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(h,g,p))},cu.prototype.touchmove=function(h,g,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;var b=g[0],N=b.y-this._swipePoint.y;return this._swipePoint=b,h.preventDefault(),this._active=!0,{zoomDelta:N/128}}}else this._tap.touchmove(h,g,p)},cu.prototype.touchend=function(h,g,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(h,g,p)&&(this._tapTime=h.timeStamp)},cu.prototype.touchcancel=function(){this.reset()},cu.prototype.enable=function(){this._enabled=!0},cu.prototype.disable=function(){this._enabled=!1,this.reset()},cu.prototype.isEnabled=function(){return this._enabled},cu.prototype.isActive=function(){return this._active};var Dl=function(h,g,p){this._el=h,this._mousePan=g,this._touchPan=p};Dl.prototype.enable=function(h){this._inertiaOptions=h||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Dl.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Dl.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Dl.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var mf=function(h,g,p){this._pitchWithRotate=h.pitchWithRotate,this._mouseRotate=g,this._mousePitch=p};mf.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},mf.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},mf.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},mf.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Fl=function(h,g,p,b){this._el=h,this._touchZoom=g,this._touchRotate=p,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0};Fl.prototype.enable=function(h){this._touchZoom.enable(h),this._rotationDisabled||this._touchRotate.enable(h),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Fl.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Fl.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Fl.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Fl.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Fl.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Ac=function(h){return h.zoom||h.drag||h.pitch||h.rotate},Yf=function(h){function g(){h.apply(this,arguments)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g}(m.Event);function Qi(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}var Xa=function(h,g){this._map=h,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new oh(h),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(g),m.bindAll(["handleEvent","handleWindowEvent"],this);var p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[m.window.document,"mousemove",{capture:!0}],[m.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[m.window,"blur",void 0]];for(var b=0,N=this._listeners;b<N.length;b+=1){var q=N[b],ee=q[0];F.addEventListener(ee,q[1],ee===m.window.document?this.handleWindowEvent:this.handleEvent,q[2])}};Xa.prototype.destroy=function(){for(var h=0,g=this._listeners;h<g.length;h+=1){var p=g[h],b=p[0];F.removeEventListener(b,p[1],b===m.window.document?this.handleWindowEvent:this.handleEvent,p[2])}},Xa.prototype._addDefaultHandlers=function(h){var g=this._map,p=g.getCanvasContainer();this._add("mapEvent",new bl(g,h));var b=g.boxZoom=new Zu(g,h);this._add("boxZoom",b);var N=new As,q=new Cf;g.doubleClickZoom=new Xf(q,N),this._add("tapZoom",N),this._add("clickZoom",q);var ee=new cu;this._add("tapDragZoom",ee);var ge=g.touchPitch=new jl;this._add("touchPitch",ge);var Ue=new Dc(h),st=new af(h);g.dragRotate=new mf(h,Ue,st),this._add("mouseRotate",Ue,["mousePitch"]),this._add("mousePitch",st,["mouseRotate"]);var kt=new cc(h),Lt=new Ws(h);g.dragPan=new Dl(p,kt,Lt),this._add("mousePan",kt),this._add("touchPan",Lt,["touchZoom","touchRotate"]);var Zt=new hc,vr=new Fc;g.touchZoomRotate=new Fl(p,vr,Zt,ee),this._add("touchRotate",Zt,["touchPan","touchZoom"]),this._add("touchZoom",vr,["touchPan","touchRotate"]);var pr=g.scrollZoom=new bs(g,this);this._add("scrollZoom",pr,["mousePan"]);var Nr=g.keyboard=new tc;this._add("keyboard",Nr),this._add("blockableMapEvent",new Ca(g));for(var cr=0,zr=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];cr<zr.length;cr+=1){var Ur=zr[cr];h.interactive&&h[Ur]&&g[Ur].enable(h[Ur])}},Xa.prototype._add=function(h,g,p){this._handlers.push({handlerName:h,handler:g,allowed:p}),this._handlersById[h]=g},Xa.prototype.stop=function(h){if(!this._updatingCamera){for(var g=0,p=this._handlers;g<p.length;g+=1)p[g].handler.reset();this._inertia.clear(),this._fireEvents({},{},h),this._changes=[]}},Xa.prototype.isActive=function(){for(var h=0,g=this._handlers;h<g.length;h+=1)if(g[h].handler.isActive())return!0;return!1},Xa.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Xa.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Xa.prototype.isMoving=function(){return Boolean(Ac(this._eventsInProgress))||this.isZooming()},Xa.prototype._blockedByActive=function(h,g,p){for(var b in h)if(b!==p&&(!g||g.indexOf(b)<0))return!0;return!1},Xa.prototype.handleWindowEvent=function(h){this.handleEvent(h,h.type+"Window")},Xa.prototype._getMapTouches=function(h){for(var g=[],p=0,b=h;p<b.length;p+=1){var N=b[p];this._el.contains(N.target)&&g.push(N)}return g},Xa.prototype.handleEvent=function(h,g){this._updatingCamera=!0;for(var p=h.type==="renderFrame"?void 0:h,b={needsRenderFrame:!1},N={},q={},ee=h.touches?this._getMapTouches(h.touches):void 0,ge=ee?F.touchPos(this._el,ee):F.mousePos(this._el,h),Ue=0,st=this._handlers;Ue<st.length;Ue+=1){var kt=st[Ue],Lt=kt.handlerName,Zt=kt.handler,vr=kt.allowed;if(Zt.isEnabled()){var pr=void 0;this._blockedByActive(q,vr,Lt)?Zt.reset():Zt[g||h.type]&&(pr=Zt[g||h.type](h,ge,ee),this.mergeHandlerResult(b,N,pr,Lt,p),pr&&pr.needsRenderFrame&&this._triggerRenderFrame()),(pr||Zt.isActive())&&(q[Lt]=Zt)}}var Nr={};for(var cr in this._previousActiveHandlers)q[cr]||(Nr[cr]=p);this._previousActiveHandlers=q,(Object.keys(Nr).length||Qi(b))&&(this._changes.push([b,N,Nr]),this._triggerRenderFrame()),(Object.keys(q).length||Qi(b))&&this._map._stop(!0),this._updatingCamera=!1;var zr=b.cameraAnimation;zr&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],zr(this._map))},Xa.prototype.mergeHandlerResult=function(h,g,p,b,N){if(p){m.extend(h,p);var q={handlerName:b,originalEvent:p.originalEvent||N};p.zoomDelta!==void 0&&(g.zoom=q),p.panDelta!==void 0&&(g.drag=q),p.pitchDelta!==void 0&&(g.pitch=q),p.bearingDelta!==void 0&&(g.rotate=q)}},Xa.prototype._applyChanges=function(){for(var h={},g={},p={},b=0,N=this._changes;b<N.length;b+=1){var q=N[b],ee=q[0],ge=q[1],Ue=q[2];ee.panDelta&&(h.panDelta=(h.panDelta||new m.Point(0,0))._add(ee.panDelta)),ee.zoomDelta&&(h.zoomDelta=(h.zoomDelta||0)+ee.zoomDelta),ee.bearingDelta&&(h.bearingDelta=(h.bearingDelta||0)+ee.bearingDelta),ee.pitchDelta&&(h.pitchDelta=(h.pitchDelta||0)+ee.pitchDelta),ee.around!==void 0&&(h.around=ee.around),ee.pinchAround!==void 0&&(h.pinchAround=ee.pinchAround),ee.noInertia&&(h.noInertia=ee.noInertia),m.extend(g,ge),m.extend(p,Ue)}this._updateMapTransform(h,g,p),this._changes=[]},Xa.prototype._updateMapTransform=function(h,g,p){var b=this._map,N=b.transform;if(!Qi(h))return this._fireEvents(g,p,!0);var q=h.panDelta,ee=h.zoomDelta,ge=h.bearingDelta,Ue=h.pitchDelta,st=h.around,kt=h.pinchAround;kt!==void 0&&(st=kt),b._stop(!0),st=st||b.transform.centerPoint;var Lt=N.pointLocation(q?st.sub(q):st);ge&&(N.bearing+=ge),Ue&&(N.pitch+=Ue),ee&&(N.zoom+=ee),N.setLocationAtPoint(Lt,st),this._map._update(),h.noInertia||this._inertia.record(h),this._fireEvents(g,p,!0)},Xa.prototype._fireEvents=function(h,g,p){var b=this,N=Ac(this._eventsInProgress),q=Ac(h),ee={};for(var ge in h)this._eventsInProgress[ge]||(ee[ge+"start"]=h[ge].originalEvent),this._eventsInProgress[ge]=h[ge];for(var Ue in!N&&q&&this._fireEvent("movestart",q.originalEvent),ee)this._fireEvent(Ue,ee[Ue]);for(var st in q&&this._fireEvent("move",q.originalEvent),h)this._fireEvent(st,h[st].originalEvent);var kt,Lt={};for(var Zt in this._eventsInProgress){var vr=this._eventsInProgress[Zt],pr=vr.handlerName,Nr=vr.originalEvent;this._handlersById[pr].isActive()||(delete this._eventsInProgress[Zt],Lt[Zt+"end"]=kt=g[pr]||Nr)}for(var cr in Lt)this._fireEvent(cr,Lt[cr]);var zr=Ac(this._eventsInProgress);if(p&&(N||q)&&!zr){this._updatingCamera=!0;var Ur=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Tn=function(ti){return ti!==0&&-b._bearingSnap<ti&&ti<b._bearingSnap};Ur?(Tn(Ur.bearing||this._map.getBearing())&&(Ur.bearing=0),this._map.easeTo(Ur,{originalEvent:kt})):(this._map.fire(new m.Event("moveend",{originalEvent:kt})),Tn(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Xa.prototype._fireEvent=function(h,g){this._map.fire(new m.Event(h,g?{originalEvent:g}:{}))},Xa.prototype._requestFrame=function(){var h=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(g){delete h._frameId,h.handleEvent(new Yf("renderFrame",{timeStamp:g})),h._applyChanges()})},Xa.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var of=function(h){function g(p,b){h.call(this),this._moving=!1,this._zooming=!1,this.transform=p,this._bearingSnap=b.bearingSnap,m.bindAll(["_renderFrameCallback"],this)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.getCenter=function(){return new m.LngLat(this.transform.center.lng,this.transform.center.lat)},g.prototype.setCenter=function(p,b){return this.jumpTo({center:p},b)},g.prototype.panBy=function(p,b,N){return p=m.Point.convert(p).mult(-1),this.panTo(this.transform.center,m.extend({offset:p},b),N)},g.prototype.panTo=function(p,b,N){return this.easeTo(m.extend({center:p},b),N)},g.prototype.getZoom=function(){return this.transform.zoom},g.prototype.setZoom=function(p,b){return this.jumpTo({zoom:p},b),this},g.prototype.zoomTo=function(p,b,N){return this.easeTo(m.extend({zoom:p},b),N)},g.prototype.zoomIn=function(p,b){return this.zoomTo(this.getZoom()+1,p,b),this},g.prototype.zoomOut=function(p,b){return this.zoomTo(this.getZoom()-1,p,b),this},g.prototype.getBearing=function(){return this.transform.bearing},g.prototype.setBearing=function(p,b){return this.jumpTo({bearing:p},b),this},g.prototype.getPadding=function(){return this.transform.padding},g.prototype.setPadding=function(p,b){return this.jumpTo({padding:p},b),this},g.prototype.rotateTo=function(p,b,N){return this.easeTo(m.extend({bearing:p},b),N)},g.prototype.resetNorth=function(p,b){return this.rotateTo(0,m.extend({duration:1e3},p),b),this},g.prototype.resetNorthPitch=function(p,b){return this.easeTo(m.extend({bearing:0,pitch:0,duration:1e3},p),b),this},g.prototype.snapToNorth=function(p,b){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(p,b):this},g.prototype.getPitch=function(){return this.transform.pitch},g.prototype.setPitch=function(p,b){return this.jumpTo({pitch:p},b),this},g.prototype.cameraForBounds=function(p,b){p=m.LngLatBounds.convert(p);var N=b&&b.bearing||0;return this._cameraForBoxAndBearing(p.getNorthWest(),p.getSouthEast(),N,b)},g.prototype._cameraForBoxAndBearing=function(p,b,N,q){var ee={top:0,bottom:0,right:0,left:0};if(typeof(q=m.extend({padding:ee,offset:[0,0],maxZoom:this.transform.maxZoom},q)).padding=="number"){var ge=q.padding;q.padding={top:ge,bottom:ge,right:ge,left:ge}}q.padding=m.extend(ee,q.padding);var Ue=this.transform,st=Ue.padding,kt=Ue.project(m.LngLat.convert(p)),Lt=Ue.project(m.LngLat.convert(b)),Zt=kt.rotate(-N*Math.PI/180),vr=Lt.rotate(-N*Math.PI/180),pr=new m.Point(Math.max(Zt.x,vr.x),Math.max(Zt.y,vr.y)),Nr=new m.Point(Math.min(Zt.x,vr.x),Math.min(Zt.y,vr.y)),cr=pr.sub(Nr),zr=(Ue.width-(st.left+st.right+q.padding.left+q.padding.right))/cr.x,Ur=(Ue.height-(st.top+st.bottom+q.padding.top+q.padding.bottom))/cr.y;if(!(Ur<0||zr<0)){var Tn=Math.min(Ue.scaleZoom(Ue.scale*Math.min(zr,Ur)),q.maxZoom),ti=typeof q.offset.x=="number"?new m.Point(q.offset.x,q.offset.y):m.Point.convert(q.offset),Yn=new m.Point((q.padding.left-q.padding.right)/2,(q.padding.top-q.padding.bottom)/2).rotate(N*Math.PI/180),ai=ti.add(Yn).mult(Ue.scale/Ue.zoomScale(Tn));return{center:Ue.unproject(kt.add(Lt).div(2).sub(ai)),zoom:Tn,bearing:N}}m.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},g.prototype.fitBounds=function(p,b,N){return this._fitInternal(this.cameraForBounds(p,b),b,N)},g.prototype.fitScreenCoordinates=function(p,b,N,q,ee){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(m.Point.convert(p)),this.transform.pointLocation(m.Point.convert(b)),N,q),q,ee)},g.prototype._fitInternal=function(p,b,N){return p?(delete(b=m.extend(p,b)).padding,b.linear?this.easeTo(b,N):this.flyTo(b,N)):this},g.prototype.jumpTo=function(p,b){this.stop();var N=this.transform,q=!1,ee=!1,ge=!1;return"zoom"in p&&N.zoom!==+p.zoom&&(q=!0,N.zoom=+p.zoom),p.center!==void 0&&(N.center=m.LngLat.convert(p.center)),"bearing"in p&&N.bearing!==+p.bearing&&(ee=!0,N.bearing=+p.bearing),"pitch"in p&&N.pitch!==+p.pitch&&(ge=!0,N.pitch=+p.pitch),p.padding==null||N.isPaddingEqual(p.padding)||(N.padding=p.padding),this.fire(new m.Event("movestart",b)).fire(new m.Event("move",b)),q&&this.fire(new m.Event("zoomstart",b)).fire(new m.Event("zoom",b)).fire(new m.Event("zoomend",b)),ee&&this.fire(new m.Event("rotatestart",b)).fire(new m.Event("rotate",b)).fire(new m.Event("rotateend",b)),ge&&this.fire(new m.Event("pitchstart",b)).fire(new m.Event("pitch",b)).fire(new m.Event("pitchend",b)),this.fire(new m.Event("moveend",b))},g.prototype.easeTo=function(p,b){var N=this;this._stop(!1,p.easeId),((p=m.extend({offset:[0,0],duration:500,easing:m.ease},p)).animate===!1||!p.essential&&m.browser.prefersReducedMotion)&&(p.duration=0);var q=this.transform,ee=this.getZoom(),ge=this.getBearing(),Ue=this.getPitch(),st=this.getPadding(),kt="zoom"in p?+p.zoom:ee,Lt="bearing"in p?this._normalizeBearing(p.bearing,ge):ge,Zt="pitch"in p?+p.pitch:Ue,vr="padding"in p?p.padding:q.padding,pr=m.Point.convert(p.offset),Nr=q.centerPoint.add(pr),cr=q.pointLocation(Nr),zr=m.LngLat.convert(p.center||cr);this._normalizeCenter(zr);var Ur,Tn,ti=q.project(cr),Yn=q.project(zr).sub(ti),ai=q.zoomScale(kt-ee);p.around&&(Ur=m.LngLat.convert(p.around),Tn=q.locationPoint(Ur));var Pi={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||kt!==ee,this._rotating=this._rotating||ge!==Lt,this._pitching=this._pitching||Zt!==Ue,this._padding=!q.isPaddingEqual(vr),this._easeId=p.easeId,this._prepareEase(b,p.noMoveStart,Pi),this._ease(function(va){if(N._zooming&&(q.zoom=m.number(ee,kt,va)),N._rotating&&(q.bearing=m.number(ge,Lt,va)),N._pitching&&(q.pitch=m.number(Ue,Zt,va)),N._padding&&(q.interpolatePadding(st,vr,va),Nr=q.centerPoint.add(pr)),Ur)q.setLocationAtPoint(Ur,Tn);else{var na=q.zoomScale(q.zoom-ee),Ua=kt>ee?Math.min(2,ai):Math.max(.5,ai),co=Math.pow(Ua,1-va),Eo=q.unproject(ti.add(Yn.mult(va*co)).mult(na));q.setLocationAtPoint(q.renderWorldCopies?Eo.wrap():Eo,Nr)}N._fireMoveEvents(b)},function(va){N._afterEase(b,va)},p),this},g.prototype._prepareEase=function(p,b,N){N===void 0&&(N={}),this._moving=!0,b||N.moving||this.fire(new m.Event("movestart",p)),this._zooming&&!N.zooming&&this.fire(new m.Event("zoomstart",p)),this._rotating&&!N.rotating&&this.fire(new m.Event("rotatestart",p)),this._pitching&&!N.pitching&&this.fire(new m.Event("pitchstart",p))},g.prototype._fireMoveEvents=function(p){this.fire(new m.Event("move",p)),this._zooming&&this.fire(new m.Event("zoom",p)),this._rotating&&this.fire(new m.Event("rotate",p)),this._pitching&&this.fire(new m.Event("pitch",p))},g.prototype._afterEase=function(p,b){if(!this._easeId||!b||this._easeId!==b){delete this._easeId;var N=this._zooming,q=this._rotating,ee=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,N&&this.fire(new m.Event("zoomend",p)),q&&this.fire(new m.Event("rotateend",p)),ee&&this.fire(new m.Event("pitchend",p)),this.fire(new m.Event("moveend",p))}},g.prototype.flyTo=function(p,b){var N=this;if(!p.essential&&m.browser.prefersReducedMotion){var q=m.pick(p,["center","zoom","bearing","pitch","around"]);return this.jumpTo(q,b)}this.stop(),p=m.extend({offset:[0,0],speed:1.2,curve:1.42,easing:m.ease},p);var ee=this.transform,ge=this.getZoom(),Ue=this.getBearing(),st=this.getPitch(),kt=this.getPadding(),Lt="zoom"in p?m.clamp(+p.zoom,ee.minZoom,ee.maxZoom):ge,Zt="bearing"in p?this._normalizeBearing(p.bearing,Ue):Ue,vr="pitch"in p?+p.pitch:st,pr="padding"in p?p.padding:ee.padding,Nr=ee.zoomScale(Lt-ge),cr=m.Point.convert(p.offset),zr=ee.centerPoint.add(cr),Ur=ee.pointLocation(zr),Tn=m.LngLat.convert(p.center||Ur);this._normalizeCenter(Tn);var ti=ee.project(Ur),Yn=ee.project(Tn).sub(ti),ai=p.curve,Pi=Math.max(ee.width,ee.height),va=Pi/Nr,na=Yn.mag();if("minZoom"in p){var Ua=m.clamp(Math.min(p.minZoom,ge,Lt),ee.minZoom,ee.maxZoom),co=Pi/ee.zoomScale(Ua-ge);ai=Math.sqrt(co/na*2)}var Eo=ai*ai;function ho(ko){var Io=(va*va-Pi*Pi+(ko?-1:1)*Eo*Eo*na*na)/(2*(ko?va:Pi)*Eo*na);return Math.log(Math.sqrt(Io*Io+1)-Io)}function qo(ko){return(Math.exp(ko)-Math.exp(-ko))/2}function ga(ko){return(Math.exp(ko)+Math.exp(-ko))/2}var Zo=ho(0),Uo=function(ko){return ga(Zo)/ga(Zo+ai*ko)},Do=function(ko){return Pi*((ga(Zo)*(qo(Io=Zo+ai*ko)/ga(Io))-qo(Zo))/Eo)/na;var Io},po=(ho(1)-Zo)/ai;if(Math.abs(na)<1e-6||!isFinite(po)){if(Math.abs(Pi-va)<1e-6)return this.easeTo(p,b);var us=va<Pi?-1:1;po=Math.abs(Math.log(va/Pi))/ai,Do=function(){return 0},Uo=function(ko){return Math.exp(us*ai*ko)}}return p.duration="duration"in p?+p.duration:1e3*po/("screenSpeed"in p?+p.screenSpeed/ai:+p.speed),p.maxDuration&&p.duration>p.maxDuration&&(p.duration=0),this._zooming=!0,this._rotating=Ue!==Zt,this._pitching=vr!==st,this._padding=!ee.isPaddingEqual(pr),this._prepareEase(b,!1),this._ease(function(ko){var Io=ko*po,El=1/Uo(Io);ee.zoom=ko===1?Lt:ge+ee.scaleZoom(El),N._rotating&&(ee.bearing=m.number(Ue,Zt,ko)),N._pitching&&(ee.pitch=m.number(st,vr,ko)),N._padding&&(ee.interpolatePadding(kt,pr,ko),zr=ee.centerPoint.add(cr));var Ou=ko===1?Tn:ee.unproject(ti.add(Yn.mult(Do(Io))).mult(El));ee.setLocationAtPoint(ee.renderWorldCopies?Ou.wrap():Ou,zr),N._fireMoveEvents(b)},function(){return N._afterEase(b)},p),this},g.prototype.isEasing=function(){return!!this._easeFrameId},g.prototype.stop=function(){return this._stop()},g.prototype._stop=function(p,b){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var N=this._onEaseEnd;delete this._onEaseEnd,N.call(this,b)}if(!p){var q=this.handlers;q&&q.stop(!1)}return this},g.prototype._ease=function(p,b,N){N.animate===!1||N.duration===0?(p(1),b()):(this._easeStart=m.browser.now(),this._easeOptions=N,this._onEaseFrame=p,this._onEaseEnd=b,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},g.prototype._renderFrameCallback=function(){var p=Math.min((m.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},g.prototype._normalizeBearing=function(p,b){p=m.wrap(p,-180,180);var N=Math.abs(p-b);return Math.abs(p-360-b)<N&&(p-=360),Math.abs(p+360-b)<N&&(p+=360),p},g.prototype._normalizeCenter=function(p){var b=this.transform;if(b.renderWorldCopies&&!b.lngRange){var N=p.lng-b.center.lng;p.lng+=N>180?-360:N<-180?360:0}},g}(m.Evented),Pl=function(h){h===void 0&&(h={}),this.options=h,m.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Pl.prototype.getDefaultPosition=function(){return"bottom-right"},Pl.prototype.onAdd=function(h){var g=this.options&&this.options.compact;return this._map=h,this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=F.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=F.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),g&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),g===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Pl.prototype.onRemove=function(){F.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Pl.prototype._setElementTitle=function(h,g){var p=this._map._getUIString("AttributionControl."+g);h.title=p,h.setAttribute("aria-label",p)},Pl.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Pl.prototype._updateEditLink=function(){var h=this._editLink;h||(h=this._editLink=this._container.querySelector(".mapbox-improve-map"));var g=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||m.config.ACCESS_TOKEN}];if(h){var p=g.reduce(function(b,N,q){return N.value&&(b+=N.key+"="+N.value+(q<g.length-1?"&":"")),b},"?");h.href=m.config.FEEDBACK_URL+"/"+p+(this._map._hash?this._map._hash.getHashString(!0):""),h.rel="noopener nofollow",this._setElementTitle(h,"MapFeedback")}},Pl.prototype._updateData=function(h){!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Pl.prototype._updateAttributions=function(){if(this._map.style){var h=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?h=h.concat(this.options.customAttribution.map(function(ge){return typeof ge!="string"?"":ge})):typeof this.options.customAttribution=="string"&&h.push(this.options.customAttribution)),this._map.style.stylesheet){var g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}var p=this._map.style.sourceCaches;for(var b in p){var N=p[b];if(N.used){var q=N.getSource();q.attribution&&h.indexOf(q.attribution)<0&&h.push(q.attribution)}}h.sort(function(ge,Ue){return ge.length-Ue.length});var ee=(h=h.filter(function(ge,Ue){for(var st=Ue+1;st<h.length;st++)if(h[st].indexOf(ge)>=0)return!1;return!0})).join(" | ");ee!==this._attribHTML&&(this._attribHTML=ee,h.length?(this._innerContainer.innerHTML=ee,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Pl.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Bc=function(){m.bindAll(["_updateLogo"],this),m.bindAll(["_updateCompact"],this)};Bc.prototype.onAdd=function(h){this._map=h,this._container=F.create("div","mapboxgl-ctrl");var g=F.create("a","mapboxgl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://www.mapbox.com/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Bc.prototype.onRemove=function(){F.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Bc.prototype.getDefaultPosition=function(){return"bottom-left"},Bc.prototype._updateLogo=function(h){h&&h.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Bc.prototype._logoRequired=function(){if(this._map.style){var h=this._map.style.sourceCaches;for(var g in h)if(h[g].getSource().mapbox_logo)return!0;return!1}},Bc.prototype._updateCompact=function(){var h=this._container.children;if(h.length){var g=h[0];this._map.getCanvasContainer().offsetWidth<250?g.classList.add("mapboxgl-compact"):g.classList.remove("mapboxgl-compact")}};var Qu=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Qu.prototype.add=function(h){var g=++this._id;return this._queue.push({callback:h,id:g,cancelled:!1}),g},Qu.prototype.remove=function(h){for(var g=this._currentlyRunning,p=0,b=g?this._queue.concat(g):this._queue;p<b.length;p+=1){var N=b[p];if(N.id===h)return void(N.cancelled=!0)}},Qu.prototype.run=function(h){h===void 0&&(h=0);var g=this._currentlyRunning=this._queue;this._queue=[];for(var p=0,b=g;p<b.length;p+=1){var N=b[p];if(!N.cancelled&&(N.callback(h),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Qu.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ul={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},uh=m.window.HTMLImageElement,sp=m.window.HTMLElement,fu=m.window.ImageBitmap,Pu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},up=function(h){function g(b){var N=this;if((b=m.extend({},Pu,b)).minZoom!=null&&b.maxZoom!=null&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(b.minPitch!=null&&b.maxPitch!=null&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(b.minPitch!=null&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(b.maxPitch!=null&&b.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var q=new Za(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies);if(h.call(this,q,b),this._interactive=b.interactive,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._crossSourceCollisions=b.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=b.collectResourceTiming,this._renderTaskQueue=new Qu,this._controls=[],this._mapId=m.uniqueId(),this._locale=m.extend({},ul,b.locale),this._clickTolerance=b.clickTolerance,this._requestManager=new m.RequestManager(b.transformRequest,b.accessToken),typeof b.container=="string"){if(this._container=m.window.document.getElementById(b.container),!this._container)throw new Error("Container '"+b.container+"' not found.")}else{if(!(b.container instanceof sp))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(b.maxBounds&&this.setMaxBounds(b.maxBounds),m.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return N._update(!1)}),this.on("moveend",function(){return N._update(!1)}),this.on("zoom",function(){return N._update(!0)}),m.window!==void 0&&(m.window.addEventListener("online",this._onWindowOnline,!1),m.window.addEventListener("resize",this._onWindowResize,!1),m.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Xa(this,b),this._hash=b.hash&&new mu(typeof b.hash=="string"&&b.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,m.extend({},b.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=b.localIdeographFontFamily,b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily}),b.attributionControl&&this.addControl(new Pl({customAttribution:b.customAttribution})),this.addControl(new Bc,b.logoPosition),this.on("style.load",function(){N.transform.unmodified&&N.jumpTo(N.style.stylesheet)}),this.on("data",function(ee){N._update(ee.dataType==="style"),N.fire(new m.Event(ee.dataType+"data",ee))}),this.on("dataloading",function(ee){N.fire(new m.Event(ee.dataType+"dataloading",ee))})}h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g;var p={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return g.prototype._getMapId=function(){return this._mapId},g.prototype.addControl=function(b,N){if(N===void 0&&(N=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new m.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var q=b.onAdd(this);this._controls.push(b);var ee=this._controlPositions[N];return N.indexOf("bottom")!==-1?ee.insertBefore(q,ee.firstChild):ee.appendChild(q),this},g.prototype.removeControl=function(b){if(!b||!b.onRemove)return this.fire(new m.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var N=this._controls.indexOf(b);return N>-1&&this._controls.splice(N,1),b.onRemove(this),this},g.prototype.hasControl=function(b){return this._controls.indexOf(b)>-1},g.prototype.resize=function(b){var N=this._containerDimensions(),q=N[0],ee=N[1];if(q===this.transform.width&&ee===this.transform.height)return this;this._resizeCanvas(q,ee),this.transform.resize(q,ee),this.painter.resize(q,ee);var ge=!this._moving;return ge&&this.fire(new m.Event("movestart",b)).fire(new m.Event("move",b)),this.fire(new m.Event("resize",b)),ge&&this.fire(new m.Event("moveend",b)),this},g.prototype.getBounds=function(){return this.transform.getBounds()},g.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},g.prototype.setMaxBounds=function(b){return this.transform.setMaxBounds(m.LngLatBounds.convert(b)),this._update()},g.prototype.setMinZoom=function(b){if((b=b==null?-2:b)>=-2&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},g.prototype.getMinZoom=function(){return this.transform.minZoom},g.prototype.setMaxZoom=function(b){if((b=b==null?22:b)>=this.transform.minZoom)return this.transform.maxZoom=b,this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")},g.prototype.getMaxZoom=function(){return this.transform.maxZoom},g.prototype.setMinPitch=function(b){if((b=b==null?0:b)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},g.prototype.getMinPitch=function(){return this.transform.minPitch},g.prototype.setMaxPitch=function(b){if((b=b==null?60:b)>60)throw new Error("maxPitch must be less than or equal to 60");if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")},g.prototype.getMaxPitch=function(){return this.transform.maxPitch},g.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},g.prototype.setRenderWorldCopies=function(b){return this.transform.renderWorldCopies=b,this._update()},g.prototype.project=function(b){return this.transform.locationPoint(m.LngLat.convert(b))},g.prototype.unproject=function(b){return this.transform.pointLocation(m.Point.convert(b))},g.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},g.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},g.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},g.prototype._createDelegatedListener=function(b,N,q){var ee,ge=this;if(b==="mouseenter"||b==="mouseover"){var Ue=!1;return{layer:N,listener:q,delegates:{mousemove:function(kt){var Lt=ge.getLayer(N)?ge.queryRenderedFeatures(kt.point,{layers:[N]}):[];Lt.length?Ue||(Ue=!0,q.call(ge,new Ku(b,ge,kt.originalEvent,{features:Lt}))):Ue=!1},mouseout:function(){Ue=!1}}}}if(b==="mouseleave"||b==="mouseout"){var st=!1;return{layer:N,listener:q,delegates:{mousemove:function(kt){(ge.getLayer(N)?ge.queryRenderedFeatures(kt.point,{layers:[N]}):[]).length?st=!0:st&&(st=!1,q.call(ge,new Ku(b,ge,kt.originalEvent)))},mouseout:function(kt){st&&(st=!1,q.call(ge,new Ku(b,ge,kt.originalEvent)))}}}}return{layer:N,listener:q,delegates:(ee={},ee[b]=function(kt){var Lt=ge.getLayer(N)?ge.queryRenderedFeatures(kt.point,{layers:[N]}):[];Lt.length&&(kt.features=Lt,q.call(ge,kt),delete kt.features)},ee)}},g.prototype.on=function(b,N,q){if(q===void 0)return h.prototype.on.call(this,b,N);var ee=this._createDelegatedListener(b,N,q);for(var ge in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(ee),ee.delegates)this.on(ge,ee.delegates[ge]);return this},g.prototype.once=function(b,N,q){if(q===void 0)return h.prototype.once.call(this,b,N);var ee=this._createDelegatedListener(b,N,q);for(var ge in ee.delegates)this.once(ge,ee.delegates[ge]);return this},g.prototype.off=function(b,N,q){var ee=this;return q===void 0?h.prototype.off.call(this,b,N):(this._delegatedListeners&&this._delegatedListeners[b]&&function(ge){for(var Ue=ge[b],st=0;st<Ue.length;st++){var kt=Ue[st];if(kt.layer===N&&kt.listener===q){for(var Lt in kt.delegates)ee.off(Lt,kt.delegates[Lt]);return Ue.splice(st,1),ee}}}(this._delegatedListeners),this)},g.prototype.queryRenderedFeatures=function(b,N){if(!this.style)return[];var q;if(N!==void 0||b===void 0||b instanceof m.Point||Array.isArray(b)||(N=b,b=void 0),N=N||{},(b=b||[[0,0],[this.transform.width,this.transform.height]])instanceof m.Point||typeof b[0]=="number")q=[m.Point.convert(b)];else{var ee=m.Point.convert(b[0]),ge=m.Point.convert(b[1]);q=[ee,new m.Point(ge.x,ee.y),ge,new m.Point(ee.x,ge.y),ee]}return this.style.queryRenderedFeatures(q,N,this.transform)},g.prototype.querySourceFeatures=function(b,N){return this.style.querySourceFeatures(b,N)},g.prototype.setStyle=function(b,N){return(N=m.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},N)).diff!==!1&&N.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,N),this):(this._localIdeographFontFamily=N.localIdeographFontFamily,this._updateStyle(b,N))},g.prototype._getUIString=function(b){var N=this._locale[b];if(N==null)throw new Error("Missing UI string '"+b+"'");return N},g.prototype._updateStyle=function(b,N){return this.style&&(this.style.setEventedParent(null),this.style._remove()),b?(this.style=new sn(this,N||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b):this.style.loadJSON(b),this):(delete this.style,this)},g.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new sn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},g.prototype._diffStyle=function(b,N){var q=this;if(typeof b=="string"){var ee=this._requestManager.normalizeStyleURL(b),ge=this._requestManager.transformRequest(ee,m.ResourceType.Style);m.getJSON(ge,function(Ue,st){Ue?q.fire(new m.ErrorEvent(Ue)):st&&q._updateDiff(st,N)})}else typeof b=="object"&&this._updateDiff(b,N)},g.prototype._updateDiff=function(b,N){try{this.style.setState(b)&&this._update(!0)}catch(q){m.warnOnce("Unable to perform style diff: "+(q.message||q.error||q)+".  Rebuilding the style from scratch."),this._updateStyle(b,N)}},g.prototype.getStyle=function(){if(this.style)return this.style.serialize()},g.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():m.warnOnce("There is no style added to the map.")},g.prototype.addSource=function(b,N){return this._lazyInitEmptyStyle(),this.style.addSource(b,N),this._update(!0)},g.prototype.isSourceLoaded=function(b){var N=this.style&&this.style.sourceCaches[b];if(N!==void 0)return N.loaded();this.fire(new m.ErrorEvent(new Error("There is no source with ID '"+b+"'")))},g.prototype.areTilesLoaded=function(){var b=this.style&&this.style.sourceCaches;for(var N in b){var q=b[N]._tiles;for(var ee in q){var ge=q[ee];if(ge.state!=="loaded"&&ge.state!=="errored")return!1}}return!0},g.prototype.addSourceType=function(b,N,q){return this._lazyInitEmptyStyle(),this.style.addSourceType(b,N,q)},g.prototype.removeSource=function(b){return this.style.removeSource(b),this._update(!0)},g.prototype.getSource=function(b){return this.style.getSource(b)},g.prototype.addImage=function(b,N,q){q===void 0&&(q={});var ee=q.pixelRatio;ee===void 0&&(ee=1);var ge=q.sdf;ge===void 0&&(ge=!1);var Ue=q.stretchX,st=q.stretchY,kt=q.content;if(this._lazyInitEmptyStyle(),N instanceof uh||fu&&N instanceof fu){var Lt=m.browser.getImageData(N);this.style.addImage(b,{data:new m.RGBAImage({width:Lt.width,height:Lt.height},Lt.data),pixelRatio:ee,stretchX:Ue,stretchY:st,content:kt,sdf:ge,version:0})}else{if(N.width===void 0||N.height===void 0)return this.fire(new m.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Zt=N;this.style.addImage(b,{data:new m.RGBAImage({width:N.width,height:N.height},new Uint8Array(N.data)),pixelRatio:ee,stretchX:Ue,stretchY:st,content:kt,sdf:ge,version:0,userImage:Zt}),Zt.onAdd&&Zt.onAdd(this,b)}},g.prototype.updateImage=function(b,N){var q=this.style.getImage(b);if(!q)return this.fire(new m.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var ee=N instanceof uh||fu&&N instanceof fu?m.browser.getImageData(N):N,ge=ee.width,Ue=ee.height,st=ee.data;return ge===void 0||Ue===void 0?this.fire(new m.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):ge!==q.data.width||Ue!==q.data.height?this.fire(new m.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(q.data.replace(st,!(N instanceof uh||fu&&N instanceof fu)),void this.style.updateImage(b,q))},g.prototype.hasImage=function(b){return b?!!this.style.getImage(b):(this.fire(new m.ErrorEvent(new Error("Missing required image id"))),!1)},g.prototype.removeImage=function(b){this.style.removeImage(b)},g.prototype.loadImage=function(b,N){m.getImage(this._requestManager.transformRequest(b,m.ResourceType.Image),N)},g.prototype.listImages=function(){return this.style.listImages()},g.prototype.addLayer=function(b,N){return this._lazyInitEmptyStyle(),this.style.addLayer(b,N),this._update(!0)},g.prototype.moveLayer=function(b,N){return this.style.moveLayer(b,N),this._update(!0)},g.prototype.removeLayer=function(b){return this.style.removeLayer(b),this._update(!0)},g.prototype.getLayer=function(b){return this.style.getLayer(b)},g.prototype.setLayerZoomRange=function(b,N,q){return this.style.setLayerZoomRange(b,N,q),this._update(!0)},g.prototype.setFilter=function(b,N,q){return q===void 0&&(q={}),this.style.setFilter(b,N,q),this._update(!0)},g.prototype.getFilter=function(b){return this.style.getFilter(b)},g.prototype.setPaintProperty=function(b,N,q,ee){return ee===void 0&&(ee={}),this.style.setPaintProperty(b,N,q,ee),this._update(!0)},g.prototype.getPaintProperty=function(b,N){return this.style.getPaintProperty(b,N)},g.prototype.setLayoutProperty=function(b,N,q,ee){return ee===void 0&&(ee={}),this.style.setLayoutProperty(b,N,q,ee),this._update(!0)},g.prototype.getLayoutProperty=function(b,N){return this.style.getLayoutProperty(b,N)},g.prototype.setLight=function(b,N){return N===void 0&&(N={}),this._lazyInitEmptyStyle(),this.style.setLight(b,N),this._update(!0)},g.prototype.getLight=function(){return this.style.getLight()},g.prototype.setFeatureState=function(b,N){return this.style.setFeatureState(b,N),this._update()},g.prototype.removeFeatureState=function(b,N){return this.style.removeFeatureState(b,N),this._update()},g.prototype.getFeatureState=function(b){return this.style.getFeatureState(b)},g.prototype.getContainer=function(){return this._container},g.prototype.getCanvasContainer=function(){return this._canvasContainer},g.prototype.getCanvas=function(){return this._canvas},g.prototype._containerDimensions=function(){var b=0,N=0;return this._container&&(b=this._container.clientWidth||400,N=this._container.clientHeight||300),[b,N]},g.prototype._detectMissingCSS=function(){m.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&m.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},g.prototype._setupContainer=function(){var b=this._container;b.classList.add("mapboxgl-map"),(this._missingCSSCanary=F.create("div","mapboxgl-canary",b)).style.visibility="hidden",this._detectMissingCSS();var N=this._canvasContainer=F.create("div","mapboxgl-canvas-container",b);this._interactive&&N.classList.add("mapboxgl-interactive"),this._canvas=F.create("canvas","mapboxgl-canvas",N),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var q=this._containerDimensions();this._resizeCanvas(q[0],q[1]);var ee=this._controlContainer=F.create("div","mapboxgl-control-container",b),ge=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Ue){ge[Ue]=F.create("div","mapboxgl-ctrl-"+Ue,ee)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},g.prototype._resizeCanvas=function(b,N){var q=m.browser.devicePixelRatio||1;this._canvas.width=q*b,this._canvas.height=q*N,this._canvas.style.width=b+"px",this._canvas.style.height=N+"px"},g.prototype._setupPainter=function(){var b=m.extend({},ae.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),N=this._canvas.getContext("webgl",b)||this._canvas.getContext("experimental-webgl",b);N?(this.painter=new un(N,this.transform),m.webpSupported.testSupport(N)):this.fire(new m.ErrorEvent(new Error("Failed to initialize WebGL")))},g.prototype._contextLost=function(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new m.Event("webglcontextlost",{originalEvent:b}))},g.prototype._contextRestored=function(b){this._setupPainter(),this.resize(),this._update(),this.fire(new m.Event("webglcontextrestored",{originalEvent:b}))},g.prototype._onMapScroll=function(b){if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},g.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},g.prototype._update=function(b){return this.style?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this},g.prototype._requestRenderFrame=function(b){return this._update(),this._renderTaskQueue.add(b)},g.prototype._cancelRenderFrame=function(b){this._renderTaskQueue.remove(b)},g.prototype._render=function(b){var N,q=this,ee=0,ge=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(N=ge.createQueryEXT(),ge.beginQueryEXT(ge.TIME_ELAPSED_EXT,N),ee=m.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),!this._removed){var Ue=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var st=this.transform.zoom,kt=m.browser.now();this.style.zoomHistory.update(st,kt);var Lt=new m.EvaluationParameters(st,{now:kt,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Zt=Lt.crossFadingFactor();Zt===1&&Zt===this._crossFadingFactor||(Ue=!0,this._crossFadingFactor=Zt),this.style.update(Lt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new m.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new m.Event("load"))),this.style&&(this.style.hasTransitions()||Ue)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var vr=m.browser.now()-ee;ge.endQueryEXT(ge.TIME_ELAPSED_EXT,N),setTimeout(function(){var cr=ge.getQueryObjectEXT(N,ge.QUERY_RESULT_EXT)/1e6;ge.deleteQueryEXT(N),q.fire(new m.Event("gpu-timing-frame",{cpuTime:vr,gpuTime:cr}))},50)}if(this.listens("gpu-timing-layer")){var pr=this.painter.collectGpuTimers();setTimeout(function(){var cr=q.painter.queryGpuTimers(pr);q.fire(new m.Event("gpu-timing-layer",{layerTimes:cr}))},50)}var Nr=this._sourcesDirty||this._styleDirty||this._placementDirty;return Nr||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new m.Event("idle")),!this._loaded||this._fullyLoaded||Nr||(this._fullyLoaded=!0),this}},g.prototype.remove=function(){this._hash&&this._hash.remove();for(var b=0,N=this._controls;b<N.length;b+=1)N[b].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),m.window!==void 0&&(m.window.removeEventListener("resize",this._onWindowResize,!1),m.window.removeEventListener("orientationchange",this._onWindowResize,!1),m.window.removeEventListener("online",this._onWindowOnline,!1));var q=this.painter.context.gl.getExtension("WEBGL_lose_context");q&&q.loseContext(),Ja(this._canvasContainer),Ja(this._controlContainer),Ja(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new m.Event("remove"))},g.prototype.triggerRepaint=function(){var b=this;this.style&&!this._frame&&(this._frame=m.browser.frame(function(N){b._frame=null,b._render(N)}))},g.prototype._onWindowOnline=function(){this._update()},g.prototype._onWindowResize=function(b){this._trackResize&&this.resize({originalEvent:b})._update()},p.showTileBoundaries.get=function(){return!!this._showTileBoundaries},p.showTileBoundaries.set=function(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())},p.showPadding.get=function(){return!!this._showPadding},p.showPadding.set=function(b){this._showPadding!==b&&(this._showPadding=b,this._update())},p.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},p.showCollisionBoxes.set=function(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())},p.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},p.showOverdrawInspector.set=function(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())},p.repaint.get=function(){return!!this._repaint},p.repaint.set=function(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())},p.vertices.get=function(){return!!this._vertices},p.vertices.set=function(b){this._vertices=b,this._update()},g.prototype._setCacheLimits=function(b,N){m.setCacheLimits(b,N)},p.version.get=function(){return m.version},Object.defineProperties(g.prototype,p),g}(of);function Ja(h){h.parentNode&&h.parentNode.removeChild(h)}var Kn={showCompass:!0,showZoom:!0,visualizePitch:!1},Wc=function(h){var g=this;this.options=m.extend({},Kn,h),this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(p){return p.preventDefault()}),this.options.showZoom&&(m.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(p){return g._map.zoomIn({},{originalEvent:p})}),F.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(p){return g._map.zoomOut({},{originalEvent:p})}),F.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(m.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(p){g.options.visualizePitch?g._map.resetNorthPitch({},{originalEvent:p}):g._map.resetNorth({},{originalEvent:p})}),this._compassIcon=F.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Wc.prototype._updateZoomButtons=function(){var h=this._map.getZoom(),g=h===this._map.getMaxZoom(),p=h===this._map.getMinZoom();this._zoomInButton.disabled=g,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",g.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},Wc.prototype._rotateCompassArrow=function(){var h=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=h},Wc.prototype.onAdd=function(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ju(this._map,this._compass,this.options.visualizePitch)),this._container},Wc.prototype.onRemove=function(){F.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Wc.prototype._createButton=function(h,g){var p=F.create("button",h,this._container);return p.type="button",p.addEventListener("click",g),p},Wc.prototype._setButtonTitle=function(h,g){var p=this._map._getUIString("NavigationControl."+g);h.title=p,h.setAttribute("aria-label",p)};var Ju=function(h,g,p){p===void 0&&(p=!1),this._clickTolerance=10,this.element=g,this.mouseRotate=new Dc({clickTolerance:h.dragRotate._mouseRotate._clickTolerance}),this.map=h,p&&(this.mousePitch=new af({clickTolerance:h.dragRotate._mousePitch._clickTolerance})),m.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),F.addEventListener(g,"mousedown",this.mousedown),F.addEventListener(g,"touchstart",this.touchstart,{passive:!1}),F.addEventListener(g,"touchmove",this.touchmove),F.addEventListener(g,"touchend",this.touchend),F.addEventListener(g,"touchcancel",this.reset)};function Nt(h,g,p){if(h=new m.LngLat(h.lng,h.lat),g){var b=new m.LngLat(h.lng-360,h.lat),N=new m.LngLat(h.lng+360,h.lat),q=p.locationPoint(h).distSqr(g);p.locationPoint(b).distSqr(g)<q?h=b:p.locationPoint(N).distSqr(g)<q&&(h=N)}for(;Math.abs(h.lng-p.center.lng)>180;){var ee=p.locationPoint(h);if(ee.x>=0&&ee.y>=0&&ee.x<=p.width&&ee.y<=p.height)break;h.lng>p.center.lng?h.lng-=360:h.lng+=360}return h}Ju.prototype.down=function(h,g){this.mouseRotate.mousedown(h,g),this.mousePitch&&this.mousePitch.mousedown(h,g),F.disableDrag()},Ju.prototype.move=function(h,g){var p=this.map,b=this.mouseRotate.mousemoveWindow(h,g);if(b&&b.bearingDelta&&p.setBearing(p.getBearing()+b.bearingDelta),this.mousePitch){var N=this.mousePitch.mousemoveWindow(h,g);N&&N.pitchDelta&&p.setPitch(p.getPitch()+N.pitchDelta)}},Ju.prototype.off=function(){var h=this.element;F.removeEventListener(h,"mousedown",this.mousedown),F.removeEventListener(h,"touchstart",this.touchstart,{passive:!1}),F.removeEventListener(h,"touchmove",this.touchmove),F.removeEventListener(h,"touchend",this.touchend),F.removeEventListener(h,"touchcancel",this.reset),this.offTemp()},Ju.prototype.offTemp=function(){F.enableDrag(),F.removeEventListener(m.window,"mousemove",this.mousemove),F.removeEventListener(m.window,"mouseup",this.mouseup)},Ju.prototype.mousedown=function(h){this.down(m.extend({},h,{ctrlKey:!0,preventDefault:function(){return h.preventDefault()}}),F.mousePos(this.element,h)),F.addEventListener(m.window,"mousemove",this.mousemove),F.addEventListener(m.window,"mouseup",this.mouseup)},Ju.prototype.mousemove=function(h){this.move(h,F.mousePos(this.element,h))},Ju.prototype.mouseup=function(h){this.mouseRotate.mouseupWindow(h),this.mousePitch&&this.mousePitch.mouseupWindow(h),this.offTemp()},Ju.prototype.touchstart=function(h){h.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=F.touchPos(this.element,h.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return h.preventDefault()}},this._startPos))},Ju.prototype.touchmove=function(h){h.targetTouches.length!==1?this.reset():(this._lastPos=F.touchPos(this.element,h.targetTouches)[0],this.move({preventDefault:function(){return h.preventDefault()}},this._lastPos))},Ju.prototype.touchend=function(h){h.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ju.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Xc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ss(h,g,p){var b=h.classList;for(var N in Xc)b.remove("mapboxgl-"+p+"-anchor-"+N);b.add("mapboxgl-"+p+"-anchor-"+g)}var Uu,cs=function(h){function g(p,b){if(h.call(this),(p instanceof m.window.HTMLElement||b)&&(p=m.extend({element:p},b)),m.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=p&&p.anchor||"center",this._color=p&&p.color||"#3FB1CE",this._scale=p&&p.scale||1,this._draggable=p&&p.draggable||!1,this._clickTolerance=p&&p.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=p&&p.rotation||0,this._rotationAlignment=p&&p.rotationAlignment||"auto",this._pitchAlignment=p&&p.pitchAlignment&&p.pitchAlignment!=="auto"?p.pitchAlignment:this._rotationAlignment,p&&p.element)this._element=p.element,this._offset=m.Point.convert(p&&p.offset||[0,0]);else{this._defaultMarker=!0,this._element=F.create("div"),this._element.setAttribute("aria-label","Map marker");var N=F.createNS("http://www.w3.org/2000/svg","svg");N.setAttributeNS(null,"display","block"),N.setAttributeNS(null,"height","41px"),N.setAttributeNS(null,"width","27px"),N.setAttributeNS(null,"viewBox","0 0 27 41");var q=F.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"stroke","none"),q.setAttributeNS(null,"stroke-width","1"),q.setAttributeNS(null,"fill","none"),q.setAttributeNS(null,"fill-rule","evenodd");var ee=F.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"fill-rule","nonzero");var ge=F.createNS("http://www.w3.org/2000/svg","g");ge.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ge.setAttributeNS(null,"fill","#000000");for(var Ue=0,st=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ue<st.length;Ue+=1){var kt=st[Ue],Lt=F.createNS("http://www.w3.org/2000/svg","ellipse");Lt.setAttributeNS(null,"opacity","0.04"),Lt.setAttributeNS(null,"cx","10.5"),Lt.setAttributeNS(null,"cy","5.80029008"),Lt.setAttributeNS(null,"rx",kt.rx),Lt.setAttributeNS(null,"ry",kt.ry),ge.appendChild(Lt)}var Zt=F.createNS("http://www.w3.org/2000/svg","g");Zt.setAttributeNS(null,"fill",this._color);var vr=F.createNS("http://www.w3.org/2000/svg","path");vr.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Zt.appendChild(vr);var pr=F.createNS("http://www.w3.org/2000/svg","g");pr.setAttributeNS(null,"opacity","0.25"),pr.setAttributeNS(null,"fill","#000000");var Nr=F.createNS("http://www.w3.org/2000/svg","path");Nr.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),pr.appendChild(Nr);var cr=F.createNS("http://www.w3.org/2000/svg","g");cr.setAttributeNS(null,"transform","translate(6.0, 7.0)"),cr.setAttributeNS(null,"fill","#FFFFFF");var zr=F.createNS("http://www.w3.org/2000/svg","g");zr.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Ur=F.createNS("http://www.w3.org/2000/svg","circle");Ur.setAttributeNS(null,"fill","#000000"),Ur.setAttributeNS(null,"opacity","0.25"),Ur.setAttributeNS(null,"cx","5.5"),Ur.setAttributeNS(null,"cy","5.5"),Ur.setAttributeNS(null,"r","5.4999962");var Tn=F.createNS("http://www.w3.org/2000/svg","circle");Tn.setAttributeNS(null,"fill","#FFFFFF"),Tn.setAttributeNS(null,"cx","5.5"),Tn.setAttributeNS(null,"cy","5.5"),Tn.setAttributeNS(null,"r","5.4999962"),zr.appendChild(Ur),zr.appendChild(Tn),ee.appendChild(ge),ee.appendChild(Zt),ee.appendChild(pr),ee.appendChild(cr),ee.appendChild(zr),N.appendChild(ee),N.setAttributeNS(null,"height",41*this._scale+"px"),N.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(N),this._offset=m.Point.convert(p&&p.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(ti){ti.preventDefault()}),this._element.addEventListener("mousedown",function(ti){ti.preventDefault()}),ss(this._element,this._anchor,"marker"),this._popup=null}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.addTo=function(p){return this.remove(),this._map=p,p.getCanvasContainer().appendChild(this._element),p.on("move",this._update),p.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},g.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),F.remove(this._element),this._popup&&this._popup.remove(),this},g.prototype.getLngLat=function(){return this._lngLat},g.prototype.setLngLat=function(p){return this._lngLat=m.LngLat.convert(p),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},g.prototype.getElement=function(){return this._element},g.prototype.setPopup=function(p){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),p){if(!("offset"in p.options)){var b=Math.sqrt(Math.pow(13.5,2)/2);p.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(24.6+b)],"bottom-right":[-b,-1*(24.6+b)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=p,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},g.prototype._onKeyPress=function(p){var b=p.code,N=p.charCode||p.keyCode;b!=="Space"&&b!=="Enter"&&N!==32&&N!==13||this.togglePopup()},g.prototype._onMapClick=function(p){var b=p.originalEvent.target,N=this._element;this._popup&&(b===N||N.contains(b))&&this.togglePopup()},g.prototype.getPopup=function(){return this._popup},g.prototype.togglePopup=function(){var p=this._popup;return p?(p.isOpen()?p.remove():p.addTo(this._map),this):this},g.prototype._update=function(p){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Nt(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var b="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?b="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(b="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var N="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?N="rotateX(0deg)":this._pitchAlignment==="map"&&(N="rotateX("+this._map.getPitch()+"deg)"),p&&p.type!=="moveend"||(this._pos=this._pos.round()),F.setTransform(this._element,Xc[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+N+" "+b)}},g.prototype.getOffset=function(){return this._offset},g.prototype.setOffset=function(p){return this._offset=m.Point.convert(p),this._update(),this},g.prototype._onMove=function(p){if(!this._isDragging){var b=this._clickTolerance||this._map._clickTolerance;this._isDragging=p.point.dist(this._pointerdownPos)>=b}this._isDragging&&(this._pos=p.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new m.Event("dragstart"))),this.fire(new m.Event("drag")))},g.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new m.Event("dragend")),this._state="inactive"},g.prototype._addDragHandler=function(p){this._element.contains(p.originalEvent.target)&&(p.preventDefault(),this._positionDelta=p.point.sub(this._pos).add(this._offset),this._pointerdownPos=p.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},g.prototype.setDraggable=function(p){return this._draggable=!!p,this._map&&(p?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},g.prototype.isDraggable=function(){return this._draggable},g.prototype.setRotation=function(p){return this._rotation=p||0,this._update(),this},g.prototype.getRotation=function(){return this._rotation},g.prototype.setRotationAlignment=function(p){return this._rotationAlignment=p||"auto",this._update(),this},g.prototype.getRotationAlignment=function(){return this._rotationAlignment},g.prototype.setPitchAlignment=function(p){return this._pitchAlignment=p&&p!=="auto"?p:this._rotationAlignment,this._update(),this},g.prototype.getPitchAlignment=function(){return this._pitchAlignment},g}(m.Evented),Kf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Uf=0,Nc=!1,Tc=function(h){function g(p){h.call(this),this.options=m.extend({},Kf,p),m.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.onAdd=function(p){var b;return this._map=p,this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),b=this._setupUI,Uu!==void 0?b(Uu):m.window.navigator.permissions!==void 0?m.window.navigator.permissions.query({name:"geolocation"}).then(function(N){b(Uu=N.state!=="denied")}):b(Uu=!!m.window.navigator.geolocation),this._container},g.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(m.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),F.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Uf=0,Nc=!1},g.prototype._isOutOfMapMaxBounds=function(p){var b=this._map.getMaxBounds(),N=p.coords;return b&&(N.longitude<b.getWest()||N.longitude>b.getEast()||N.latitude<b.getSouth()||N.latitude>b.getNorth())},g.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},g.prototype._onSuccess=function(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new m.Event("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new m.Event("geolocate",p)),this._finish()}},g.prototype._updateCamera=function(p){var b=new m.LngLat(p.coords.longitude,p.coords.latitude),N=p.coords.accuracy,q=this._map.getBearing(),ee=m.extend({bearing:q},this.options.fitBoundsOptions);this._map.fitBounds(b.toBounds(N),ee,{geolocateSource:!0})},g.prototype._updateMarker=function(p){if(p){var b=new m.LngLat(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(b).addTo(this._map),this._userLocationDotMarker.setLngLat(b).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},g.prototype._updateCircleRadius=function(){var p=this._map._container.clientHeight/2,b=this._map.unproject([0,p]),N=this._map.unproject([1,p]),q=b.distanceTo(N),ee=Math.ceil(2*this._accuracy/q);this._circleElement.style.width=ee+"px",this._circleElement.style.height=ee+"px"},g.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},g.prototype._onError=function(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var b=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=b,this._geolocateButton.setAttribute("aria-label",b),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&Nc)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new m.Event("error",p)),this._finish()}},g.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},g.prototype._setupUI=function(p){var b=this;if(this._container.addEventListener("contextmenu",function(ee){return ee.preventDefault()}),this._geolocateButton=F.create("button","mapboxgl-ctrl-geolocate",this._container),F.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",p===!1){m.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var N=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=N,this._geolocateButton.setAttribute("aria-label",N)}else{var q=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=q,this._geolocateButton.setAttribute("aria-label",q)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new cs(this._dotElement),this._circleElement=F.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new cs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(ee){ee.geolocateSource||b._watchState!=="ACTIVE_LOCK"||ee.originalEvent&&ee.originalEvent.type==="resize"||(b._watchState="BACKGROUND",b._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),b._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),b.fire(new m.Event("trackuserlocationend")))})},g.prototype.trigger=function(){if(!this._setup)return m.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new m.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Uf--,Nc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new m.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new m.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Uf>1?(p={maximumAge:6e5,timeout:0},Nc=!0):(p=this.options.positionOptions,Nc=!1),this._geolocationWatchID=m.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else m.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},g.prototype._clearWatch=function(){m.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},g}(m.Evented),gf={maxWidth:100,unit:"metric"},lh=function(h){this.options=m.extend({},gf,h),m.bindAll(["_onMove","setUnit"],this)};function Af(h,g,p){var b=p&&p.maxWidth||100,N=h._container.clientHeight/2,q=h.unproject([0,N]),ee=h.unproject([b,N]),ge=q.distanceTo(ee);if(p&&p.unit==="imperial"){var Ue=3.2808*ge;Ue>5280?Tf(g,b,Ue/5280,h._getUIString("ScaleControl.Miles")):Tf(g,b,Ue,h._getUIString("ScaleControl.Feet"))}else p&&p.unit==="nautical"?Tf(g,b,ge/1852,h._getUIString("ScaleControl.NauticalMiles")):ge>=1e3?Tf(g,b,ge/1e3,h._getUIString("ScaleControl.Kilometers")):Tf(g,b,ge,h._getUIString("ScaleControl.Meters"))}function Tf(h,g,p,b){var N,q,ee,ge=(N=p,(q=Math.pow(10,(""+Math.floor(N)).length-1))*(ee=(ee=N/q)>=10?10:ee>=5?5:ee>=3?3:ee>=2?2:ee>=1?1:function(Ue){var st=Math.pow(10,Math.ceil(-Math.log(Ue)/Math.LN10));return Math.round(Ue*st)/st}(ee)));h.style.width=g*(ge/p)+"px",h.innerHTML=ge+"&nbsp;"+b}lh.prototype.getDefaultPosition=function(){return"bottom-left"},lh.prototype._onMove=function(){Af(this._map,this._container,this.options)},lh.prototype.onAdd=function(h){return this._map=h,this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},lh.prototype.onRemove=function(){F.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},lh.prototype.setUnit=function(h){this.options.unit=h,Af(this._map,this._container,this.options)};var Mf=function(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof m.window.HTMLElement?this._container=h.container:m.warnOnce("Full screen control 'container' must be a DOM element.")),m.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in m.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in m.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in m.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in m.window.document&&(this._fullscreenchange="MSFullscreenChange")};Mf.prototype.onAdd=function(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",m.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Mf.prototype.onRemove=function(){F.remove(this._controlContainer),this._map=null,m.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Mf.prototype._checkFullscreenSupport=function(){return!!(m.window.document.fullscreenEnabled||m.window.document.mozFullScreenEnabled||m.window.document.msFullscreenEnabled||m.window.document.webkitFullscreenEnabled)},Mf.prototype._setupUI=function(){var h=this._fullscreenButton=F.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);F.create("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden",!0),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),m.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Mf.prototype._updateTitle=function(){var h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.title=h},Mf.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Mf.prototype._isFullscreen=function(){return this._fullscreen},Mf.prototype._changeIcon=function(){(m.window.document.fullscreenElement||m.window.document.mozFullScreenElement||m.window.document.webkitFullscreenElement||m.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Mf.prototype._onClickFullscreen=function(){this._isFullscreen()?m.window.document.exitFullscreen?m.window.document.exitFullscreen():m.window.document.mozCancelFullScreen?m.window.document.mozCancelFullScreen():m.window.document.msExitFullscreen?m.window.document.msExitFullscreen():m.window.document.webkitCancelFullScreen&&m.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Pf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ju=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),gp=function(h){function g(p){h.call(this),this.options=m.extend(Object.create(Pf),p),m.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return h&&(g.__proto__=h),(g.prototype=Object.create(h&&h.prototype)).constructor=g,g.prototype.addTo=function(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new m.Event("open")),this},g.prototype.isOpen=function(){return!!this._map},g.prototype.remove=function(){return this._content&&F.remove(this._content),this._container&&(F.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new m.Event("close")),this},g.prototype.getLngLat=function(){return this._lngLat},g.prototype.setLngLat=function(p){return this._lngLat=m.LngLat.convert(p),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},g.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},g.prototype.getElement=function(){return this._container},g.prototype.setText=function(p){return this.setDOMContent(m.window.document.createTextNode(p))},g.prototype.setHTML=function(p){var b,N=m.window.document.createDocumentFragment(),q=m.window.document.createElement("body");for(q.innerHTML=p;b=q.firstChild;)N.appendChild(b);return this.setDOMContent(N)},g.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},g.prototype.setMaxWidth=function(p){return this.options.maxWidth=p,this._update(),this},g.prototype.setDOMContent=function(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=F.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this},g.prototype.addClassName=function(p){this._container&&this._container.classList.add(p)},g.prototype.removeClassName=function(p){this._container&&this._container.classList.remove(p)},g.prototype.setOffset=function(p){return this.options.offset=p,this._update(),this},g.prototype.toggleClassName=function(p){if(this._container)return this._container.classList.toggle(p)},g.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=F.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},g.prototype._onMouseUp=function(p){this._update(p.point)},g.prototype._onMouseMove=function(p){this._update(p.point)},g.prototype._onDrag=function(p){this._update(p.point)},g.prototype._update=function(p){var b=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=F.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=F.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Lt){return b._container.classList.add(Lt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Nt(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||p)){var N=this._pos=this._trackPointer&&p?p:this._map.project(this._lngLat),q=this.options.anchor,ee=function Lt(Zt){if(Zt){if(typeof Zt=="number"){var vr=Math.round(Math.sqrt(.5*Math.pow(Zt,2)));return{center:new m.Point(0,0),top:new m.Point(0,Zt),"top-left":new m.Point(vr,vr),"top-right":new m.Point(-vr,vr),bottom:new m.Point(0,-Zt),"bottom-left":new m.Point(vr,-vr),"bottom-right":new m.Point(-vr,-vr),left:new m.Point(Zt,0),right:new m.Point(-Zt,0)}}if(Zt instanceof m.Point||Array.isArray(Zt)){var pr=m.Point.convert(Zt);return{center:pr,top:pr,"top-left":pr,"top-right":pr,bottom:pr,"bottom-left":pr,"bottom-right":pr,left:pr,right:pr}}return{center:m.Point.convert(Zt.center||[0,0]),top:m.Point.convert(Zt.top||[0,0]),"top-left":m.Point.convert(Zt["top-left"]||[0,0]),"top-right":m.Point.convert(Zt["top-right"]||[0,0]),bottom:m.Point.convert(Zt.bottom||[0,0]),"bottom-left":m.Point.convert(Zt["bottom-left"]||[0,0]),"bottom-right":m.Point.convert(Zt["bottom-right"]||[0,0]),left:m.Point.convert(Zt.left||[0,0]),right:m.Point.convert(Zt.right||[0,0])}}return Lt(new m.Point(0,0))}(this.options.offset);if(!q){var ge,Ue=this._container.offsetWidth,st=this._container.offsetHeight;ge=N.y+ee.bottom.y<st?["top"]:N.y>this._map.transform.height-st?["bottom"]:[],N.x<Ue/2?ge.push("left"):N.x>this._map.transform.width-Ue/2&&ge.push("right"),q=ge.length===0?"bottom":ge.join("-")}var kt=N.add(ee[q]).round();F.setTransform(this._container,Xc[q]+" translate("+kt.x+"px,"+kt.y+"px)"),ss(this._container,q,"popup")}},g.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var p=this._container.querySelector(ju);p&&p.focus()}},g.prototype._onClose=function(){this.remove()},g}(m.Evented),qf={version:m.version,supported:ae,setRTLTextPlugin:m.setRTLTextPlugin,getRTLTextPluginStatus:m.getRTLTextPluginStatus,Map:up,NavigationControl:Wc,GeolocateControl:Tc,AttributionControl:Pl,ScaleControl:lh,FullscreenControl:Mf,Popup:gp,Marker:cs,Style:sn,LngLat:m.LngLat,LngLatBounds:m.LngLatBounds,Point:m.Point,MercatorCoordinate:m.MercatorCoordinate,Evented:m.Evented,config:m.config,prewarm:function(){Hr().acquire(Ft)},clearPrewarmedResources:function(){var h=ot;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(Ft),ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return m.config.ACCESS_TOKEN},set accessToken(h){m.config.ACCESS_TOKEN=h},get baseApiUrl(){return m.config.API_URL},set baseApiUrl(h){m.config.API_URL=h},get workerCount(){return rr.workerCount},set workerCount(h){rr.workerCount=h},get maxParallelImageRequests(){return m.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){m.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage:function(h){m.clearTileCache(h)},workerUrl:""};return qf}),D})},3614:function(Ne,fe,I){"use strict";Ne.exports=k;var D=I(80645);function k(Se){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Se)?Se:new Uint8Array(Se||0),this.pos=0,this.type=0,this.length=this.buf.length}k.Varint=0,k.Fixed64=1,k.Bytes=2,k.Fixed32=5;var m=(1<<16)*(1<<16),ae=1/m,F=12,K=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");k.prototype={destroy:function(){this.buf=null},readFields:function(Se,Qe,oe){for(oe=oe||this.length;this.pos<oe;){var ue=this.readVarint(),be=ue>>3,vt=this.pos;this.type=ue&7,Se(be,Qe,this),this.pos===vt&&this.skip(ue)}return Qe},readMessage:function(Se,Qe){return this.readFields(Se,Qe,this.readVarint()+this.pos)},readFixed32:function(){var Se=ve(this.buf,this.pos);return this.pos+=4,Se},readSFixed32:function(){var Se=Re(this.buf,this.pos);return this.pos+=4,Se},readFixed64:function(){var Se=ve(this.buf,this.pos)+ve(this.buf,this.pos+4)*m;return this.pos+=8,Se},readSFixed64:function(){var Se=ve(this.buf,this.pos)+Re(this.buf,this.pos+4)*m;return this.pos+=8,Se},readFloat:function(){var Se=D.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Se},readDouble:function(){var Se=D.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Se},readVarint:function(Se){var Qe=this.buf,oe,ue;return ue=Qe[this.pos++],oe=ue&127,ue<128||(ue=Qe[this.pos++],oe|=(ue&127)<<7,ue<128)||(ue=Qe[this.pos++],oe|=(ue&127)<<14,ue<128)||(ue=Qe[this.pos++],oe|=(ue&127)<<21,ue<128)?oe:(ue=Qe[this.pos],oe|=(ue&15)<<28,W(oe,Se,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Se=this.readVarint();return Se%2===1?(Se+1)/-2:Se/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var Se=this.readVarint()+this.pos,Qe=this.pos;return this.pos=Se,Se-Qe>=F&&K?at(this.buf,Qe,Se):Ye(this.buf,Qe,Se)},readBytes:function(){var Se=this.readVarint()+this.pos,Qe=this.buf.subarray(this.pos,Se);return this.pos=Se,Qe},readPackedVarint:function(Se,Qe){if(this.type!==k.Bytes)return Se.push(this.readVarint(Qe));var oe=Y(this);for(Se=Se||[];this.pos<oe;)Se.push(this.readVarint(Qe));return Se},readPackedSVarint:function(Se){if(this.type!==k.Bytes)return Se.push(this.readSVarint());var Qe=Y(this);for(Se=Se||[];this.pos<Qe;)Se.push(this.readSVarint());return Se},readPackedBoolean:function(Se){if(this.type!==k.Bytes)return Se.push(this.readBoolean());var Qe=Y(this);for(Se=Se||[];this.pos<Qe;)Se.push(this.readBoolean());return Se},readPackedFloat:function(Se){if(this.type!==k.Bytes)return Se.push(this.readFloat());var Qe=Y(this);for(Se=Se||[];this.pos<Qe;)Se.push(this.readFloat());return Se},readPackedDouble:function(Se){if(this.type!==k.Bytes)return Se.push(this.readDouble());var Qe=Y(this);for(Se=Se||[];this.pos<Qe;)Se.push(this.readDouble());return Se},readPackedFixed32:function(Se){if(this.type!==k.Bytes)return Se.push(this.readFixed32());var Qe=Y(this);for(Se=Se||[];this.pos<Qe;)Se.push(this.readFixed32());return Se},readPackedSFixed32:function(Se){if(this.type!==k.Bytes)return Se.push(this.readSFixed32());var Qe=Y(this);for(Se=Se||[];this.pos<Qe;)Se.push(this.readSFixed32());return Se},readPackedFixed64:function(Se){if(this.type!==k.Bytes)return Se.push(this.readFixed64());var Qe=Y(this);for(Se=Se||[];this.pos<Qe;)Se.push(this.readFixed64());return Se},readPackedSFixed64:function(Se){if(this.type!==k.Bytes)return Se.push(this.readSFixed64());var Qe=Y(this);for(Se=Se||[];this.pos<Qe;)Se.push(this.readSFixed64());return Se},skip:function(Se){var Qe=Se&7;if(Qe===k.Varint)for(;this.buf[this.pos++]>127;);else if(Qe===k.Bytes)this.pos=this.readVarint()+this.pos;else if(Qe===k.Fixed32)this.pos+=4;else if(Qe===k.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Qe)},writeTag:function(Se,Qe){this.writeVarint(Se<<3|Qe)},realloc:function(Se){for(var Qe=this.length||16;Qe<this.pos+Se;)Qe*=2;if(Qe!==this.length){var oe=new Uint8Array(Qe);oe.set(this.buf),this.buf=oe,this.length=Qe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Se){this.realloc(4),Ae(this.buf,Se,this.pos),this.pos+=4},writeSFixed32:function(Se){this.realloc(4),Ae(this.buf,Se,this.pos),this.pos+=4},writeFixed64:function(Se){this.realloc(8),Ae(this.buf,Se&-1,this.pos),Ae(this.buf,Math.floor(Se*ae),this.pos+4),this.pos+=8},writeSFixed64:function(Se){this.realloc(8),Ae(this.buf,Se&-1,this.pos),Ae(this.buf,Math.floor(Se*ae),this.pos+4),this.pos+=8},writeVarint:function(Se){if(Se=+Se||0,Se>268435455||Se<0){$(Se,this);return}this.realloc(4),this.buf[this.pos++]=Se&127|(Se>127?128:0),!(Se<=127)&&(this.buf[this.pos++]=(Se>>>=7)&127|(Se>127?128:0),!(Se<=127)&&(this.buf[this.pos++]=(Se>>>=7)&127|(Se>127?128:0),!(Se<=127)&&(this.buf[this.pos++]=Se>>>7&127)))},writeSVarint:function(Se){this.writeVarint(Se<0?-Se*2-1:Se*2)},writeBoolean:function(Se){this.writeVarint(Boolean(Se))},writeString:function(Se){Se=String(Se),this.realloc(Se.length*4),this.pos++;var Qe=this.pos;this.pos=ht(this.buf,Se,this.pos);var oe=this.pos-Qe;oe>=128&&Ce(Qe,oe,this),this.pos=Qe-1,this.writeVarint(oe),this.pos+=oe},writeFloat:function(Se){this.realloc(4),D.write(this.buf,Se,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Se){this.realloc(8),D.write(this.buf,Se,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Se){var Qe=Se.length;this.writeVarint(Qe),this.realloc(Qe);for(var oe=0;oe<Qe;oe++)this.buf[this.pos++]=Se[oe]},writeRawMessage:function(Se,Qe){this.pos++;var oe=this.pos;Se(Qe,this);var ue=this.pos-oe;ue>=128&&Ce(oe,ue,this),this.pos=oe-1,this.writeVarint(ue),this.pos+=ue},writeMessage:function(Se,Qe,oe){this.writeTag(Se,k.Bytes),this.writeRawMessage(Qe,oe)},writePackedVarint:function(Se,Qe){Qe.length&&this.writeMessage(Se,We,Qe)},writePackedSVarint:function(Se,Qe){Qe.length&&this.writeMessage(Se,me,Qe)},writePackedBoolean:function(Se,Qe){Qe.length&&this.writeMessage(Se,pt,Qe)},writePackedFloat:function(Se,Qe){Qe.length&&this.writeMessage(Se,Ge,Qe)},writePackedDouble:function(Se,Qe){Qe.length&&this.writeMessage(Se,Ke,Qe)},writePackedFixed32:function(Se,Qe){Qe.length&&this.writeMessage(Se,Xe,Qe)},writePackedSFixed32:function(Se,Qe){Qe.length&&this.writeMessage(Se,gt,Qe)},writePackedFixed64:function(Se,Qe){Qe.length&&this.writeMessage(Se,ie,Qe)},writePackedSFixed64:function(Se,Qe){Qe.length&&this.writeMessage(Se,ft,Qe)},writeBytesField:function(Se,Qe){this.writeTag(Se,k.Bytes),this.writeBytes(Qe)},writeFixed32Field:function(Se,Qe){this.writeTag(Se,k.Fixed32),this.writeFixed32(Qe)},writeSFixed32Field:function(Se,Qe){this.writeTag(Se,k.Fixed32),this.writeSFixed32(Qe)},writeFixed64Field:function(Se,Qe){this.writeTag(Se,k.Fixed64),this.writeFixed64(Qe)},writeSFixed64Field:function(Se,Qe){this.writeTag(Se,k.Fixed64),this.writeSFixed64(Qe)},writeVarintField:function(Se,Qe){this.writeTag(Se,k.Varint),this.writeVarint(Qe)},writeSVarintField:function(Se,Qe){this.writeTag(Se,k.Varint),this.writeSVarint(Qe)},writeStringField:function(Se,Qe){this.writeTag(Se,k.Bytes),this.writeString(Qe)},writeFloatField:function(Se,Qe){this.writeTag(Se,k.Fixed32),this.writeFloat(Qe)},writeDoubleField:function(Se,Qe){this.writeTag(Se,k.Fixed64),this.writeDouble(Qe)},writeBooleanField:function(Se,Qe){this.writeVarintField(Se,Boolean(Qe))}};function W(Se,Qe,oe){var ue=oe.buf,be,vt;if(vt=ue[oe.pos++],be=(vt&112)>>4,vt<128||(vt=ue[oe.pos++],be|=(vt&127)<<3,vt<128)||(vt=ue[oe.pos++],be|=(vt&127)<<10,vt<128)||(vt=ue[oe.pos++],be|=(vt&127)<<17,vt<128)||(vt=ue[oe.pos++],be|=(vt&127)<<24,vt<128)||(vt=ue[oe.pos++],be|=(vt&1)<<31,vt<128))return G(Se,be,Qe);throw new Error("Expected varint not more than 10 bytes")}function Y(Se){return Se.type===k.Bytes?Se.readVarint()+Se.pos:Se.pos+1}function G(Se,Qe,oe){return oe?Qe*4294967296+(Se>>>0):(Qe>>>0)*4294967296+(Se>>>0)}function $(Se,Qe){var oe,ue;if(Se>=0?(oe=Se%4294967296|0,ue=Se/4294967296|0):(oe=~(-Se%4294967296),ue=~(-Se/4294967296),oe^4294967295?oe=oe+1|0:(oe=0,ue=ue+1|0)),Se>=18446744073709552e3||Se<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Qe.realloc(10),xe(oe,ue,Qe),Fe(ue,Qe)}function xe(Se,Qe,oe){oe.buf[oe.pos++]=Se&127|128,Se>>>=7,oe.buf[oe.pos++]=Se&127|128,Se>>>=7,oe.buf[oe.pos++]=Se&127|128,Se>>>=7,oe.buf[oe.pos++]=Se&127|128,Se>>>=7,oe.buf[oe.pos]=Se&127}function Fe(Se,Qe){var oe=(Se&7)<<4;Qe.buf[Qe.pos++]|=oe|((Se>>>=3)?128:0),Se&&(Qe.buf[Qe.pos++]=Se&127|((Se>>>=7)?128:0),Se&&(Qe.buf[Qe.pos++]=Se&127|((Se>>>=7)?128:0),Se&&(Qe.buf[Qe.pos++]=Se&127|((Se>>>=7)?128:0),Se&&(Qe.buf[Qe.pos++]=Se&127|((Se>>>=7)?128:0),Se&&(Qe.buf[Qe.pos++]=Se&127)))))}function Ce(Se,Qe,oe){var ue=Qe<=16383?1:Qe<=2097151?2:Qe<=268435455?3:Math.floor(Math.log(Qe)/(Math.LN2*7));oe.realloc(ue);for(var be=oe.pos-1;be>=Se;be--)oe.buf[be+ue]=oe.buf[be]}function We(Se,Qe){for(var oe=0;oe<Se.length;oe++)Qe.writeVarint(Se[oe])}function me(Se,Qe){for(var oe=0;oe<Se.length;oe++)Qe.writeSVarint(Se[oe])}function Ge(Se,Qe){for(var oe=0;oe<Se.length;oe++)Qe.writeFloat(Se[oe])}function Ke(Se,Qe){for(var oe=0;oe<Se.length;oe++)Qe.writeDouble(Se[oe])}function pt(Se,Qe){for(var oe=0;oe<Se.length;oe++)Qe.writeBoolean(Se[oe])}function Xe(Se,Qe){for(var oe=0;oe<Se.length;oe++)Qe.writeFixed32(Se[oe])}function gt(Se,Qe){for(var oe=0;oe<Se.length;oe++)Qe.writeSFixed32(Se[oe])}function ie(Se,Qe){for(var oe=0;oe<Se.length;oe++)Qe.writeFixed64(Se[oe])}function ft(Se,Qe){for(var oe=0;oe<Se.length;oe++)Qe.writeSFixed64(Se[oe])}function ve(Se,Qe){return(Se[Qe]|Se[Qe+1]<<8|Se[Qe+2]<<16)+Se[Qe+3]*16777216}function Ae(Se,Qe,oe){Se[oe]=Qe,Se[oe+1]=Qe>>>8,Se[oe+2]=Qe>>>16,Se[oe+3]=Qe>>>24}function Re(Se,Qe){return(Se[Qe]|Se[Qe+1]<<8|Se[Qe+2]<<16)+(Se[Qe+3]<<24)}function Ye(Se,Qe,oe){for(var ue="",be=Qe;be<oe;){var vt=Se[be],bt=null,Ht=vt>239?4:vt>223?3:vt>191?2:1;if(be+Ht>oe)break;var Er,Vt,on;Ht===1?vt<128&&(bt=vt):Ht===2?(Er=Se[be+1],(Er&192)===128&&(bt=(vt&31)<<6|Er&63,bt<=127&&(bt=null))):Ht===3?(Er=Se[be+1],Vt=Se[be+2],(Er&192)===128&&(Vt&192)===128&&(bt=(vt&15)<<12|(Er&63)<<6|Vt&63,(bt<=2047||bt>=55296&&bt<=57343)&&(bt=null))):Ht===4&&(Er=Se[be+1],Vt=Se[be+2],on=Se[be+3],(Er&192)===128&&(Vt&192)===128&&(on&192)===128&&(bt=(vt&15)<<18|(Er&63)<<12|(Vt&63)<<6|on&63,(bt<=65535||bt>=1114112)&&(bt=null))),bt===null?(bt=65533,Ht=1):bt>65535&&(bt-=65536,ue+=String.fromCharCode(bt>>>10&1023|55296),bt=56320|bt&1023),ue+=String.fromCharCode(bt),be+=Ht}return ue}function at(Se,Qe,oe){return K.decode(Se.subarray(Qe,oe))}function ht(Se,Qe,oe){for(var ue=0,be,vt;ue<Qe.length;ue++){if(be=Qe.charCodeAt(ue),be>55295&&be<57344)if(vt)if(be<56320){Se[oe++]=239,Se[oe++]=191,Se[oe++]=189,vt=be;continue}else be=vt-55296<<10|be-56320|65536,vt=null;else{be>56319||ue+1===Qe.length?(Se[oe++]=239,Se[oe++]=191,Se[oe++]=189):vt=be;continue}else vt&&(Se[oe++]=239,Se[oe++]=191,Se[oe++]=189,vt=null);be<128?Se[oe++]=be:(be<2048?Se[oe++]=be>>6|192:(be<65536?Se[oe++]=be>>12|224:(Se[oe++]=be>>18|240,Se[oe++]=be>>12&63|128),Se[oe++]=be>>6&63|128),Se[oe++]=be&63|128)}return oe}},32676:function(Ne,fe,I){var D=I(34155);(function(k,m){Ne.exports=m()})(this,function(){"use strict";function k(Pr,nt){if(!(Pr instanceof nt))throw new TypeError("Cannot call a class as a function")}function m(Pr,nt){for(var it=0;it<nt.length;it++){var _t=nt[it];_t.enumerable=_t.enumerable||!1,_t.configurable=!0,"value"in _t&&(_t.writable=!0),Object.defineProperty(Pr,_t.key,_t)}}function ae(Pr,nt,it){return nt&&m(Pr.prototype,nt),it&&m(Pr,it),Pr}var F=function(){function Pr(nt,it){this.next=null,this.key=nt,this.data=it,this.left=null,this.right=null}return Pr}();function K(Pr,nt){return Pr>nt?1:Pr<nt?-1:0}function W(Pr,nt,it){for(var _t=new F(null,null),we=_t,er=_t;;){var $r=it(Pr,nt.key);if($r<0){if(nt.left===null)break;if(it(Pr,nt.left.key)<0){var Fn=nt.left;if(nt.left=Fn.right,Fn.right=nt,nt=Fn,nt.left===null)break}er.left=nt,er=nt,nt=nt.left}else if($r>0){if(nt.right===null)break;if(it(Pr,nt.right.key)>0){var Fn=nt.right;if(nt.right=Fn.left,Fn.left=nt,nt=Fn,nt.right===null)break}we.right=nt,we=nt,nt=nt.right}else break}return we.right=nt.left,er.left=nt.right,nt.left=_t.right,nt.right=_t.left,nt}function Y(Pr,nt,it,_t){var we=new F(Pr,nt);if(it===null)return we.left=we.right=null,we;it=W(Pr,it,_t);var er=_t(Pr,it.key);return er<0?(we.left=it.left,we.right=it,it.left=null):er>=0&&(we.right=it.right,we.left=it,it.right=null),we}function G(Pr,nt,it){var _t=null,we=null;if(nt){nt=W(Pr,nt,it);var er=it(nt.key,Pr);er===0?(_t=nt.left,we=nt.right):er<0?(we=nt.right,nt.right=null,_t=nt):(_t=nt.left,nt.left=null,we=nt)}return{left:_t,right:we}}function $(Pr,nt,it){return nt===null?Pr:(Pr===null||(nt=W(Pr.key,nt,it),nt.left=Pr),nt)}function xe(Pr,nt,it,_t,we){if(Pr){_t(""+nt+(it?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+we(Pr)+`
`);var er=nt+(it?"    ":"\u2502   ");Pr.left&&xe(Pr.left,er,!1,_t,we),Pr.right&&xe(Pr.right,er,!0,_t,we)}}var Fe=function(){function Pr(nt){nt===void 0&&(nt=K),this._root=null,this._size=0,this._comparator=nt}return Pr.prototype.insert=function(nt,it){return this._size++,this._root=Y(nt,it,this._root,this._comparator)},Pr.prototype.add=function(nt,it){var _t=new F(nt,it);this._root===null&&(_t.left=_t.right=null,this._size++,this._root=_t);var we=this._comparator,er=W(nt,this._root,we),$r=we(nt,er.key);return $r===0?this._root=er:($r<0?(_t.left=er.left,_t.right=er,er.left=null):$r>0&&(_t.right=er.right,_t.left=er,er.right=null),this._size++,this._root=_t),this._root},Pr.prototype.remove=function(nt){this._root=this._remove(nt,this._root,this._comparator)},Pr.prototype._remove=function(nt,it,_t){var we;if(it===null)return null;it=W(nt,it,_t);var er=_t(nt,it.key);return er===0?(it.left===null?we=it.right:(we=W(nt,it.left,_t),we.right=it.right),this._size--,we):it},Pr.prototype.pop=function(){var nt=this._root;if(nt){for(;nt.left;)nt=nt.left;return this._root=W(nt.key,this._root,this._comparator),this._root=this._remove(nt.key,this._root,this._comparator),{key:nt.key,data:nt.data}}return null},Pr.prototype.findStatic=function(nt){for(var it=this._root,_t=this._comparator;it;){var we=_t(nt,it.key);if(we===0)return it;we<0?it=it.left:it=it.right}return null},Pr.prototype.find=function(nt){return this._root&&(this._root=W(nt,this._root,this._comparator),this._comparator(nt,this._root.key)!==0)?null:this._root},Pr.prototype.contains=function(nt){for(var it=this._root,_t=this._comparator;it;){var we=_t(nt,it.key);if(we===0)return!0;we<0?it=it.left:it=it.right}return!1},Pr.prototype.forEach=function(nt,it){for(var _t=this._root,we=[],er=!1;!er;)_t!==null?(we.push(_t),_t=_t.left):we.length!==0?(_t=we.pop(),nt.call(it,_t),_t=_t.right):er=!0;return this},Pr.prototype.range=function(nt,it,_t,we){for(var er=[],$r=this._comparator,Fn=this._root,Qt;er.length!==0||Fn;)if(Fn)er.push(Fn),Fn=Fn.left;else{if(Fn=er.pop(),Qt=$r(Fn.key,it),Qt>0)break;if($r(Fn.key,nt)>=0&&_t.call(we,Fn))return this;Fn=Fn.right}return this},Pr.prototype.keys=function(){var nt=[];return this.forEach(function(it){var _t=it.key;return nt.push(_t)}),nt},Pr.prototype.values=function(){var nt=[];return this.forEach(function(it){var _t=it.data;return nt.push(_t)}),nt},Pr.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Pr.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Pr.prototype.minNode=function(nt){if(nt===void 0&&(nt=this._root),nt)for(;nt.left;)nt=nt.left;return nt},Pr.prototype.maxNode=function(nt){if(nt===void 0&&(nt=this._root),nt)for(;nt.right;)nt=nt.right;return nt},Pr.prototype.at=function(nt){for(var it=this._root,_t=!1,we=0,er=[];!_t;)if(it)er.push(it),it=it.left;else if(er.length>0){if(it=er.pop(),we===nt)return it;we++,it=it.right}else _t=!0;return null},Pr.prototype.next=function(nt){var it=this._root,_t=null;if(nt.right){for(_t=nt.right;_t.left;)_t=_t.left;return _t}for(var we=this._comparator;it;){var er=we(nt.key,it.key);if(er===0)break;er<0?(_t=it,it=it.left):it=it.right}return _t},Pr.prototype.prev=function(nt){var it=this._root,_t=null;if(nt.left!==null){for(_t=nt.left;_t.right;)_t=_t.right;return _t}for(var we=this._comparator;it;){var er=we(nt.key,it.key);if(er===0)break;er<0?it=it.left:(_t=it,it=it.right)}return _t},Pr.prototype.clear=function(){return this._root=null,this._size=0,this},Pr.prototype.toList=function(){return me(this._root)},Pr.prototype.load=function(nt,it,_t){it===void 0&&(it=[]),_t===void 0&&(_t=!1);var we=nt.length,er=this._comparator;if(_t&&pt(nt,it,0,we-1,er),this._root===null)this._root=Ce(nt,it,0,we),this._size=we;else{var $r=Ke(this.toList(),We(nt,it),er);we=this._size+we,this._root=Ge({head:$r},0,we)}return this},Pr.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Pr.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Pr.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Pr.prototype.toString=function(nt){nt===void 0&&(nt=function(we){return String(we.key)});var it=[];return xe(this._root,"",!0,function(_t){return it.push(_t)},nt),it.join("")},Pr.prototype.update=function(nt,it,_t){var we=this._comparator,er=G(nt,this._root,we),$r=er.left,Fn=er.right;we(nt,it)<0?Fn=Y(it,_t,Fn,we):$r=Y(it,_t,$r,we),this._root=$($r,Fn,we)},Pr.prototype.split=function(nt){return G(nt,this._root,this._comparator)},Pr}();function Ce(Pr,nt,it,_t){var we=_t-it;if(we>0){var er=it+Math.floor(we/2),$r=Pr[er],Fn=nt[er],Qt=new F($r,Fn);return Qt.left=Ce(Pr,nt,it,er),Qt.right=Ce(Pr,nt,er+1,_t),Qt}return null}function We(Pr,nt){for(var it=new F(null,null),_t=it,we=0;we<Pr.length;we++)_t=_t.next=new F(Pr[we],nt[we]);return _t.next=null,it.next}function me(Pr){for(var nt=Pr,it=[],_t=!1,we=new F(null,null),er=we;!_t;)nt?(it.push(nt),nt=nt.left):it.length>0?(nt=er=er.next=it.pop(),nt=nt.right):_t=!0;return er.next=null,we.next}function Ge(Pr,nt,it){var _t=it-nt;if(_t>0){var we=nt+Math.floor(_t/2),er=Ge(Pr,nt,we),$r=Pr.head;return $r.left=er,Pr.head=Pr.head.next,$r.right=Ge(Pr,we+1,it),$r}return null}function Ke(Pr,nt,it){for(var _t=new F(null,null),we=_t,er=Pr,$r=nt;er!==null&&$r!==null;)it(er.key,$r.key)<0?(we.next=er,er=er.next):(we.next=$r,$r=$r.next),we=we.next;return er!==null?we.next=er:$r!==null&&(we.next=$r),_t.next}function pt(Pr,nt,it,_t,we){if(!(it>=_t)){for(var er=Pr[it+_t>>1],$r=it-1,Fn=_t+1;;){do $r++;while(we(Pr[$r],er)<0);do Fn--;while(we(Pr[Fn],er)>0);if($r>=Fn)break;var Qt=Pr[$r];Pr[$r]=Pr[Fn],Pr[Fn]=Qt,Qt=nt[$r],nt[$r]=nt[Fn],nt[Fn]=Qt}pt(Pr,nt,it,Fn,we),pt(Pr,nt,Fn+1,_t,we)}}var Xe=function(nt,it){return nt.ll.x<=it.x&&it.x<=nt.ur.x&&nt.ll.y<=it.y&&it.y<=nt.ur.y},gt=function(nt,it){if(it.ur.x<nt.ll.x||nt.ur.x<it.ll.x||it.ur.y<nt.ll.y||nt.ur.y<it.ll.y)return null;var _t=nt.ll.x<it.ll.x?it.ll.x:nt.ll.x,we=nt.ur.x<it.ur.x?nt.ur.x:it.ur.x,er=nt.ll.y<it.ll.y?it.ll.y:nt.ll.y,$r=nt.ur.y<it.ur.y?nt.ur.y:it.ur.y;return{ll:{x:_t,y:er},ur:{x:we,y:$r}}},ie=Number.EPSILON;ie===void 0&&(ie=Math.pow(2,-52));var ft=ie*ie,ve=function(nt,it){if(-ie<nt&&nt<ie&&-ie<it&&it<ie)return 0;var _t=nt-it;return _t*_t<ft*nt*it?0:nt<it?-1:1},Ae=function(){function Pr(){k(this,Pr),this.reset()}return ae(Pr,[{key:"reset",value:function(){this.xRounder=new Re,this.yRounder=new Re}},{key:"round",value:function(it,_t){return{x:this.xRounder.round(it),y:this.yRounder.round(_t)}}}]),Pr}(),Re=function(){function Pr(){k(this,Pr),this.tree=new Fe,this.round(0)}return ae(Pr,[{key:"round",value:function(it){var _t=this.tree.add(it),we=this.tree.prev(_t);if(we!==null&&ve(_t.key,we.key)===0)return this.tree.remove(it),we.key;var er=this.tree.next(_t);return er!==null&&ve(_t.key,er.key)===0?(this.tree.remove(it),er.key):it}}]),Pr}(),Ye=new Ae,at=function(nt,it){return nt.x*it.y-nt.y*it.x},ht=function(nt,it){return nt.x*it.x+nt.y*it.y},Se=function(nt,it,_t){var we={x:it.x-nt.x,y:it.y-nt.y},er={x:_t.x-nt.x,y:_t.y-nt.y},$r=at(we,er);return ve($r,0)},Qe=function(nt){return Math.sqrt(ht(nt,nt))},oe=function(nt,it,_t){var we={x:it.x-nt.x,y:it.y-nt.y},er={x:_t.x-nt.x,y:_t.y-nt.y};return at(er,we)/Qe(er)/Qe(we)},ue=function(nt,it,_t){var we={x:it.x-nt.x,y:it.y-nt.y},er={x:_t.x-nt.x,y:_t.y-nt.y};return ht(er,we)/Qe(er)/Qe(we)},be=function(nt,it,_t){return it.y===0?null:{x:nt.x+it.x/it.y*(_t-nt.y),y:_t}},vt=function(nt,it,_t){return it.x===0?null:{x:_t,y:nt.y+it.y/it.x*(_t-nt.x)}},bt=function(nt,it,_t,we){if(it.x===0)return vt(_t,we,nt.x);if(we.x===0)return vt(nt,it,_t.x);if(it.y===0)return be(_t,we,nt.y);if(we.y===0)return be(nt,it,_t.y);var er=at(it,we);if(er==0)return null;var $r={x:_t.x-nt.x,y:_t.y-nt.y},Fn=at($r,it)/er,Qt=at($r,we)/er,Br=nt.x+Qt*it.x,bn=_t.x+Fn*we.x,gr=nt.y+Qt*it.y,pn=_t.y+Fn*we.y,Sn=(Br+bn)/2,Dn=(gr+pn)/2;return{x:Sn,y:Dn}},Ht=function(){ae(Pr,null,[{key:"compare",value:function(it,_t){var we=Pr.comparePoints(it.point,_t.point);return we!==0?we:(it.point!==_t.point&&it.link(_t),it.isLeft!==_t.isLeft?it.isLeft?1:-1:Vt.compare(it.segment,_t.segment))}},{key:"comparePoints",value:function(it,_t){return it.x<_t.x?-1:it.x>_t.x?1:it.y<_t.y?-1:it.y>_t.y?1:0}}]);function Pr(nt,it){k(this,Pr),nt.events===void 0?nt.events=[this]:nt.events.push(this),this.point=nt,this.isLeft=it}return ae(Pr,[{key:"link",value:function(it){if(it.point===this.point)throw new Error("Tried to link already linked events");for(var _t=it.point.events,we=0,er=_t.length;we<er;we++){var $r=_t[we];this.point.events.push($r),$r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var it=this.point.events.length,_t=0;_t<it;_t++){var we=this.point.events[_t];if(we.segment.consumedBy===void 0)for(var er=_t+1;er<it;er++){var $r=this.point.events[er];$r.consumedBy===void 0&&we.otherSE.point.events===$r.otherSE.point.events&&we.segment.consume($r.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var it=[],_t=0,we=this.point.events.length;_t<we;_t++){var er=this.point.events[_t];er!==this&&!er.segment.ringOut&&er.segment.isInResult()&&it.push(er)}return it}},{key:"getLeftmostComparator",value:function(it){var _t=this,we=new Map,er=function(Fn){var Qt=Fn.otherSE;we.set(Fn,{sine:oe(_t.point,it.point,Qt.point),cosine:ue(_t.point,it.point,Qt.point)})};return function($r,Fn){we.has($r)||er($r),we.has(Fn)||er(Fn);var Qt=we.get($r),Br=Qt.sine,bn=Qt.cosine,gr=we.get(Fn),pn=gr.sine,Sn=gr.cosine;return Br>=0&&pn>=0?bn<Sn?1:bn>Sn?-1:0:Br<0&&pn<0?bn<Sn?-1:bn>Sn?1:0:pn<Br?-1:pn>Br?1:0}}}]),Pr}(),Er=0,Vt=function(){ae(Pr,null,[{key:"compare",value:function(it,_t){var we=it.leftSE.point.x,er=_t.leftSE.point.x,$r=it.rightSE.point.x,Fn=_t.rightSE.point.x;if(Fn<we)return 1;if($r<er)return-1;var Qt=it.leftSE.point.y,Br=_t.leftSE.point.y,bn=it.rightSE.point.y,gr=_t.rightSE.point.y;if(we<er){if(Br<Qt&&Br<bn)return 1;if(Br>Qt&&Br>bn)return-1;var pn=it.comparePoint(_t.leftSE.point);if(pn<0)return 1;if(pn>0)return-1;var Sn=_t.comparePoint(it.rightSE.point);return Sn!==0?Sn:-1}if(we>er){if(Qt<Br&&Qt<gr)return-1;if(Qt>Br&&Qt>gr)return 1;var Dn=_t.comparePoint(it.leftSE.point);if(Dn!==0)return Dn;var ui=it.comparePoint(_t.rightSE.point);return ui<0?1:ui>0?-1:1}if(Qt<Br)return-1;if(Qt>Br)return 1;if($r<Fn){var di=_t.comparePoint(it.rightSE.point);if(di!==0)return di}if($r>Fn){var ca=it.comparePoint(_t.rightSE.point);if(ca<0)return 1;if(ca>0)return-1}if($r!==Fn){var Ni=bn-Qt,Wa=$r-we,Ba=gr-Br,Ia=Fn-er;if(Ni>Wa&&Ba<Ia)return 1;if(Ni<Wa&&Ba>Ia)return-1}return $r>Fn?1:$r<Fn||bn<gr?-1:bn>gr?1:it.id<_t.id?-1:it.id>_t.id?1:0}}]);function Pr(nt,it,_t,we){k(this,Pr),this.id=++Er,this.leftSE=nt,nt.segment=this,nt.otherSE=it,this.rightSE=it,it.segment=this,it.otherSE=nt,this.rings=_t,this.windings=we}return ae(Pr,[{key:"replaceRightSE",value:function(it){this.rightSE=it,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var it=this.leftSE.point.y,_t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:it<_t?it:_t},ur:{x:this.rightSE.point.x,y:it>_t?it:_t}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(it){return it.x===this.leftSE.point.x&&it.y===this.leftSE.point.y||it.x===this.rightSE.point.x&&it.y===this.rightSE.point.y}},{key:"comparePoint",value:function(it){if(this.isAnEndpoint(it))return 0;var _t=this.leftSE.point,we=this.rightSE.point,er=this.vector();if(_t.x===we.x)return it.x===_t.x?0:it.x<_t.x?1:-1;var $r=(it.y-_t.y)/er.y,Fn=_t.x+$r*er.x;if(it.x===Fn)return 0;var Qt=(it.x-_t.x)/er.x,Br=_t.y+Qt*er.y;return it.y===Br?0:it.y<Br?-1:1}},{key:"getIntersection",value:function(it){var _t=this.bbox(),we=it.bbox(),er=gt(_t,we);if(er===null)return null;var $r=this.leftSE.point,Fn=this.rightSE.point,Qt=it.leftSE.point,Br=it.rightSE.point,bn=Xe(_t,Qt)&&this.comparePoint(Qt)===0,gr=Xe(we,$r)&&it.comparePoint($r)===0,pn=Xe(_t,Br)&&this.comparePoint(Br)===0,Sn=Xe(we,Fn)&&it.comparePoint(Fn)===0;if(gr&&bn)return Sn&&!pn?Fn:!Sn&&pn?Br:null;if(gr)return pn&&$r.x===Br.x&&$r.y===Br.y?null:$r;if(bn)return Sn&&Fn.x===Qt.x&&Fn.y===Qt.y?null:Qt;if(Sn&&pn)return null;if(Sn)return Fn;if(pn)return Br;var Dn=bt($r,this.vector(),Qt,it.vector());return Dn===null||!Xe(er,Dn)?null:Ye.round(Dn.x,Dn.y)}},{key:"split",value:function(it){var _t=[],we=it.events!==void 0,er=new Ht(it,!0),$r=new Ht(it,!1),Fn=this.rightSE;this.replaceRightSE($r),_t.push($r),_t.push(er);var Qt=new Pr(er,Fn,this.rings.slice(),this.windings.slice());return Ht.comparePoints(Qt.leftSE.point,Qt.rightSE.point)>0&&Qt.swapEvents(),Ht.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),we&&(er.checkForConsuming(),$r.checkForConsuming()),_t}},{key:"swapEvents",value:function(){var it=this.rightSE;this.rightSE=this.leftSE,this.leftSE=it,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var _t=0,we=this.windings.length;_t<we;_t++)this.windings[_t]*=-1}},{key:"consume",value:function(it){for(var _t=this,we=it;_t.consumedBy;)_t=_t.consumedBy;for(;we.consumedBy;)we=we.consumedBy;var er=Pr.compare(_t,we);if(er!==0){if(er>0){var $r=_t;_t=we,we=$r}if(_t.prev===we){var Fn=_t;_t=we,we=Fn}for(var Qt=0,Br=we.rings.length;Qt<Br;Qt++){var bn=we.rings[Qt],gr=we.windings[Qt],pn=_t.rings.indexOf(bn);pn===-1?(_t.rings.push(bn),_t.windings.push(gr)):_t.windings[pn]+=gr}we.rings=null,we.windings=null,we.consumedBy=_t,we.leftSE.consumedBy=_t.leftSE,we.rightSE.consumedBy=_t.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var it=this.prev.consumedBy||this.prev;this._beforeState=it.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var it=this.beforeState();this._afterState={rings:it.rings.slice(0),windings:it.windings.slice(0),multiPolys:[]};for(var _t=this._afterState.rings,we=this._afterState.windings,er=this._afterState.multiPolys,$r=0,Fn=this.rings.length;$r<Fn;$r++){var Qt=this.rings[$r],Br=this.windings[$r],bn=_t.indexOf(Qt);bn===-1?(_t.push(Qt),we.push(Br)):we[bn]+=Br}for(var gr=[],pn=[],Sn=0,Dn=_t.length;Sn<Dn;Sn++)if(we[Sn]!==0){var ui=_t[Sn],di=ui.poly;if(pn.indexOf(di)===-1)if(ui.isExterior)gr.push(di);else{pn.indexOf(di)===-1&&pn.push(di);var ca=gr.indexOf(ui.poly);ca!==-1&&gr.splice(ca,1)}}for(var Ni=0,Wa=gr.length;Ni<Wa;Ni++){var Ba=gr[Ni].multiPoly;er.indexOf(Ba)===-1&&er.push(Ba)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var it=this.beforeState().multiPolys,_t=this.afterState().multiPolys;switch(ea.type){case"union":{var we=it.length===0,er=_t.length===0;this._isInResult=we!==er;break}case"intersection":{var $r,Fn;it.length<_t.length?($r=it.length,Fn=_t.length):($r=_t.length,Fn=it.length),this._isInResult=Fn===ea.numMultiPolys&&$r<Fn;break}case"xor":{var Qt=Math.abs(it.length-_t.length);this._isInResult=Qt%2===1;break}case"difference":{var Br=function(gr){return gr.length===1&&gr[0].isSubject};this._isInResult=Br(it)!==Br(_t);break}default:throw new Error("Unrecognized operation type found ".concat(ea.type))}return this._isInResult}}],[{key:"fromRing",value:function(it,_t,we){var er,$r,Fn,Qt=Ht.comparePoints(it,_t);if(Qt<0)er=it,$r=_t,Fn=1;else if(Qt>0)er=_t,$r=it,Fn=-1;else throw new Error("Tried to create degenerate segment at [".concat(it.x,", ").concat(it.y,"]"));var Br=new Ht(er,!0),bn=new Ht($r,!1);return new Pr(Br,bn,[we],[Fn])}}]),Pr}(),on=function(){function Pr(nt,it,_t){if(k(this,Pr),!Array.isArray(nt)||nt.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=it,this.isExterior=_t,this.segments=[],typeof nt[0][0]!="number"||typeof nt[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var we=Ye.round(nt[0][0],nt[0][1]);this.bbox={ll:{x:we.x,y:we.y},ur:{x:we.x,y:we.y}};for(var er=we,$r=1,Fn=nt.length;$r<Fn;$r++){if(typeof nt[$r][0]!="number"||typeof nt[$r][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Qt=Ye.round(nt[$r][0],nt[$r][1]);Qt.x===er.x&&Qt.y===er.y||(this.segments.push(Vt.fromRing(er,Qt,this)),Qt.x<this.bbox.ll.x&&(this.bbox.ll.x=Qt.x),Qt.y<this.bbox.ll.y&&(this.bbox.ll.y=Qt.y),Qt.x>this.bbox.ur.x&&(this.bbox.ur.x=Qt.x),Qt.y>this.bbox.ur.y&&(this.bbox.ur.y=Qt.y),er=Qt)}(we.x!==er.x||we.y!==er.y)&&this.segments.push(Vt.fromRing(er,we,this))}return ae(Pr,[{key:"getSweepEvents",value:function(){for(var it=[],_t=0,we=this.segments.length;_t<we;_t++){var er=this.segments[_t];it.push(er.leftSE),it.push(er.rightSE)}return it}}]),Pr}(),hn=function(){function Pr(nt,it){if(k(this,Pr),!Array.isArray(nt))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new on(nt[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var _t=1,we=nt.length;_t<we;_t++){var er=new on(nt[_t],this,!1);er.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=er.bbox.ll.x),er.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=er.bbox.ll.y),er.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=er.bbox.ur.x),er.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=er.bbox.ur.y),this.interiorRings.push(er)}this.multiPoly=it}return ae(Pr,[{key:"getSweepEvents",value:function(){for(var it=this.exteriorRing.getSweepEvents(),_t=0,we=this.interiorRings.length;_t<we;_t++)for(var er=this.interiorRings[_t].getSweepEvents(),$r=0,Fn=er.length;$r<Fn;$r++)it.push(er[$r]);return it}}]),Pr}(),gi=function(){function Pr(nt,it){if(k(this,Pr),!Array.isArray(nt))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof nt[0][0][0]=="number"&&(nt=[nt])}catch($r){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var _t=0,we=nt.length;_t<we;_t++){var er=new hn(nt[_t],this);er.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=er.bbox.ll.x),er.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=er.bbox.ll.y),er.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=er.bbox.ur.x),er.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=er.bbox.ur.y),this.polys.push(er)}this.isSubject=it}return ae(Pr,[{key:"getSweepEvents",value:function(){for(var it=[],_t=0,we=this.polys.length;_t<we;_t++)for(var er=this.polys[_t].getSweepEvents(),$r=0,Fn=er.length;$r<Fn;$r++)it.push(er[$r]);return it}}]),Pr}(),Hn=function(){ae(Pr,null,[{key:"factory",value:function(it){for(var _t=[],we=0,er=it.length;we<er;we++){var $r=it[we];if(!(!$r.isInResult()||$r.ringOut)){for(var Fn=null,Qt=$r.leftSE,Br=$r.rightSE,bn=[Qt],gr=Qt.point,pn=[];Fn=Qt,Qt=Br,bn.push(Qt),Qt.point!==gr;)for(;;){var Sn=Qt.getAvailableLinkedEvents();if(Sn.length===0){var Dn=bn[0].point,ui=bn[bn.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Dn.x,",")+" ".concat(Dn.y,"]. Last matching segment found ends at")+" [".concat(ui.x,", ").concat(ui.y,"]."))}if(Sn.length===1){Br=Sn[0].otherSE;break}for(var di=null,ca=0,Ni=pn.length;ca<Ni;ca++)if(pn[ca].point===Qt.point){di=ca;break}if(di!==null){var Wa=pn.splice(di)[0],Ba=bn.splice(Wa.index);Ba.unshift(Ba[0].otherSE),_t.push(new Pr(Ba.reverse()));continue}pn.push({index:bn.length,point:Qt.point});var Ia=Qt.getLeftmostComparator(Fn);Br=Sn.sort(Ia)[0].otherSE;break}_t.push(new Pr(bn))}}return _t}}]);function Pr(nt){k(this,Pr),this.events=nt;for(var it=0,_t=nt.length;it<_t;it++)nt[it].segment.ringOut=this;this.poly=null}return ae(Pr,[{key:"getGeom",value:function(){for(var it=this.events[0].point,_t=[it],we=1,er=this.events.length-1;we<er;we++){var $r=this.events[we].point,Fn=this.events[we+1].point;Se($r,it,Fn)!==0&&(_t.push($r),it=$r)}if(_t.length===1)return null;var Qt=_t[0],Br=_t[1];Se(Qt,it,Br)===0&&_t.shift(),_t.push(_t[0]);for(var bn=this.isExteriorRing()?1:-1,gr=this.isExteriorRing()?0:_t.length-1,pn=this.isExteriorRing()?_t.length:-1,Sn=[],Dn=gr;Dn!=pn;Dn+=bn)Sn.push([_t[Dn].x,_t[Dn].y]);return Sn}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var it=this.enclosingRing();this._isExteriorRing=it?!it.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var it=this.events[0],_t=1,we=this.events.length;_t<we;_t++){var er=this.events[_t];Ht.compare(it,er)>0&&(it=er)}for(var $r=it.segment.prevInResult(),Fn=$r?$r.prevInResult():null;;){if(!$r)return null;if(!Fn)return $r.ringOut;if(Fn.ringOut!==$r.ringOut)return Fn.ringOut.enclosingRing()!==$r.ringOut?$r.ringOut:$r.ringOut.enclosingRing();$r=Fn.prevInResult(),Fn=$r?$r.prevInResult():null}}}]),Pr}(),Dt=function(){function Pr(nt){k(this,Pr),this.exteriorRing=nt,nt.poly=this,this.interiorRings=[]}return ae(Pr,[{key:"addInterior",value:function(it){this.interiorRings.push(it),it.poly=this}},{key:"getGeom",value:function(){var it=[this.exteriorRing.getGeom()];if(it[0]===null)return null;for(var _t=0,we=this.interiorRings.length;_t<we;_t++){var er=this.interiorRings[_t].getGeom();er!==null&&it.push(er)}return it}}]),Pr}(),Ea=function(){function Pr(nt){k(this,Pr),this.rings=nt,this.polys=this._composePolys(nt)}return ae(Pr,[{key:"getGeom",value:function(){for(var it=[],_t=0,we=this.polys.length;_t<we;_t++){var er=this.polys[_t].getGeom();er!==null&&it.push(er)}return it}},{key:"_composePolys",value:function(it){for(var _t=[],we=0,er=it.length;we<er;we++){var $r=it[we];if(!$r.poly)if($r.isExteriorRing())_t.push(new Dt($r));else{var Fn=$r.enclosingRing();Fn.poly||_t.push(new Dt(Fn)),Fn.poly.addInterior($r)}}return _t}}]),Pr}(),Ze=function(){function Pr(nt){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vt.compare;k(this,Pr),this.queue=nt,this.tree=new Fe(it),this.segments=[]}return ae(Pr,[{key:"process",value:function(it){var _t=it.segment,we=[];if(it.consumedBy)return it.isLeft?this.queue.remove(it.otherSE):this.tree.remove(_t),we;var er=it.isLeft?this.tree.insert(_t):this.tree.find(_t);if(!er)throw new Error("Unable to find segment #".concat(_t.id," ")+"[".concat(_t.leftSE.point.x,", ").concat(_t.leftSE.point.y,"] -> ")+"[".concat(_t.rightSE.point.x,", ").concat(_t.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var $r=er,Fn=er,Qt=void 0,Br=void 0;Qt===void 0;)$r=this.tree.prev($r),$r===null?Qt=null:$r.key.consumedBy===void 0&&(Qt=$r.key);for(;Br===void 0;)Fn=this.tree.next(Fn),Fn===null?Br=null:Fn.key.consumedBy===void 0&&(Br=Fn.key);if(it.isLeft){var bn=null;if(Qt){var gr=Qt.getIntersection(_t);if(gr!==null&&(_t.isAnEndpoint(gr)||(bn=gr),!Qt.isAnEndpoint(gr)))for(var pn=this._splitSafely(Qt,gr),Sn=0,Dn=pn.length;Sn<Dn;Sn++)we.push(pn[Sn])}var ui=null;if(Br){var di=Br.getIntersection(_t);if(di!==null&&(_t.isAnEndpoint(di)||(ui=di),!Br.isAnEndpoint(di)))for(var ca=this._splitSafely(Br,di),Ni=0,Wa=ca.length;Ni<Wa;Ni++)we.push(ca[Ni])}if(bn!==null||ui!==null){var Ba=null;if(bn===null)Ba=ui;else if(ui===null)Ba=bn;else{var Ia=Ht.comparePoints(bn,ui);Ba=Ia<=0?bn:ui}this.queue.remove(_t.rightSE),we.push(_t.rightSE);for(var an=_t.split(Ba),Ln=0,re=an.length;Ln<re;Ln++)we.push(an[Ln])}we.length>0?(this.tree.remove(_t),we.push(it)):(this.segments.push(_t),_t.prev=Qt)}else{if(Qt&&Br){var he=Qt.getIntersection(Br);if(he!==null){if(!Qt.isAnEndpoint(he))for(var V=this._splitSafely(Qt,he),Et=0,Bt=V.length;Et<Bt;Et++)we.push(V[Et]);if(!Br.isAnEndpoint(he))for(var Le=this._splitSafely(Br,he),St=0,tt=Le.length;St<tt;St++)we.push(Le[St])}}this.tree.remove(_t)}return we}},{key:"_splitSafely",value:function(it,_t){this.tree.remove(it);var we=it.rightSE;this.queue.remove(we);var er=it.split(_t);return er.push(we),it.consumedBy===void 0&&this.tree.insert(it),er}}]),Pr}(),ci=typeof D!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Ci=typeof D!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Oi=function(){function Pr(){k(this,Pr)}return ae(Pr,[{key:"run",value:function(it,_t,we){ea.type=it,Ye.reset();for(var er=[new gi(_t,!0)],$r=0,Fn=we.length;$r<Fn;$r++)er.push(new gi(we[$r],!1));if(ea.numMultiPolys=er.length,ea.type==="difference")for(var Qt=er[0],Br=1;Br<er.length;)gt(er[Br].bbox,Qt.bbox)!==null?Br++:er.splice(Br,1);if(ea.type==="intersection"){for(var bn=0,gr=er.length;bn<gr;bn++)for(var pn=er[bn],Sn=bn+1,Dn=er.length;Sn<Dn;Sn++)if(gt(pn.bbox,er[Sn].bbox)===null)return[]}for(var ui=new Fe(Ht.compare),di=0,ca=er.length;di<ca;di++)for(var Ni=er[di].getSweepEvents(),Wa=0,Ba=Ni.length;Wa<Ba;Wa++)if(ui.insert(Ni[Wa]),ui.size>ci)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Ia=new Ze(ui),an=ui.size,Ln=ui.pop();Ln;){var re=Ln.key;if(ui.size===an){var he=re.segment;throw new Error("Unable to pop() ".concat(re.isLeft?"left":"right"," SweepEvent ")+"[".concat(re.point.x,", ").concat(re.point.y,"] from segment #").concat(he.id," ")+"[".concat(he.leftSE.point.x,", ").concat(he.leftSE.point.y,"] -> ")+"[".concat(he.rightSE.point.x,", ").concat(he.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(ui.size>ci)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Ia.segments.length>Ci)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var V=Ia.process(re),Et=0,Bt=V.length;Et<Bt;Et++){var Le=V[Et];Le.consumedBy===void 0&&ui.insert(Le)}an=ui.size,Ln=ui.pop()}Ye.reset();var St=Hn.factory(Ia.segments),tt=new Ea(St);return tt.getGeom()}}]),Pr}(),ea=new Oi,fn=function(nt){for(var it=arguments.length,_t=new Array(it>1?it-1:0),we=1;we<it;we++)_t[we-1]=arguments[we];return ea.run("union",nt,_t)},tn=function(nt){for(var it=arguments.length,_t=new Array(it>1?it-1:0),we=1;we<it;we++)_t[we-1]=arguments[we];return ea.run("intersection",nt,_t)},da=function(nt){for(var it=arguments.length,_t=new Array(it>1?it-1:0),we=1;we<it;we++)_t[we-1]=arguments[we];return ea.run("xor",nt,_t)},Ii=function(nt){for(var it=arguments.length,_t=new Array(it>1?it-1:0),we=1;we<it;we++)_t[we-1]=arguments[we];return ea.run("difference",nt,_t)},Ai={union:fn,intersection:tn,xor:da,difference:Ii};return Ai})},34155:function(Ne){var fe=Ne.exports={},I,D;function k(){throw new Error("setTimeout has not been defined")}function m(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?I=setTimeout:I=k}catch(We){I=k}try{typeof clearTimeout=="function"?D=clearTimeout:D=m}catch(We){D=m}})();function ae(We){if(I===setTimeout)return setTimeout(We,0);if((I===k||!I)&&setTimeout)return I=setTimeout,setTimeout(We,0);try{return I(We,0)}catch(me){try{return I.call(null,We,0)}catch(Ge){return I.call(this,We,0)}}}function F(We){if(D===clearTimeout)return clearTimeout(We);if((D===m||!D)&&clearTimeout)return D=clearTimeout,clearTimeout(We);try{return D(We)}catch(me){try{return D.call(null,We)}catch(Ge){return D.call(this,We)}}}var K=[],W=!1,Y,G=-1;function $(){!W||!Y||(W=!1,Y.length?K=Y.concat(K):G=-1,K.length&&xe())}function xe(){if(!W){var We=ae($);W=!0;for(var me=K.length;me;){for(Y=K,K=[];++G<me;)Y&&Y[G].run();G=-1,me=K.length}Y=null,W=!1,F(We)}}fe.nextTick=function(We){var me=new Array(arguments.length-1);if(arguments.length>1)for(var Ge=1;Ge<arguments.length;Ge++)me[Ge-1]=arguments[Ge];K.push(new Fe(We,me)),K.length===1&&!W&&ae(xe)};function Fe(We,me){this.fun=We,this.array=me}Fe.prototype.run=function(){this.fun.apply(null,this.array)},fe.title="browser",fe.browser=!0,fe.env={},fe.argv=[],fe.version="",fe.versions={};function Ce(){}fe.on=Ce,fe.addListener=Ce,fe.once=Ce,fe.off=Ce,fe.removeListener=Ce,fe.removeAllListeners=Ce,fe.emit=Ce,fe.prependListener=Ce,fe.prependOnceListener=Ce,fe.listeners=function(We){return[]},fe.binding=function(We){throw new Error("process.binding is not supported")},fe.cwd=function(){return"/"},fe.chdir=function(We){throw new Error("process.chdir is not supported")},fe.umask=function(){return 0}},71990:function(Ne,fe,I){"use strict";I.d(fe,{zb:function(){return Ke},RV:function(){return eu}});var D=I(67294),k=I(87462),m=I(91),ae=I(4942),F=I(1413),K=I(74902),W=I(15671),Y=I(43144),G=I(97326),$=I(60136),xe=I(29388),Fe=I(50344),Ce=I(80334),We="RC_FORM_INTERNAL_HOOKS",me=function(){(0,Ce.ZP)(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},Ge=D.createContext({getFieldValue:me,getFieldsValue:me,getFieldError:me,getFieldWarning:me,getFieldsError:me,isFieldsTouched:me,isFieldTouched:me,isFieldValidating:me,isFieldsValidating:me,resetFields:me,setFields:me,setFieldValue:me,setFieldsValue:me,validateFields:me,submit:me,getInternalHooks:function(){return me(),{dispatch:me,initEntityValue:me,registerField:me,useSubscribe:me,setInitialValues:me,destroyForm:me,setCallbacks:me,registerWatch:me,getFields:me,setValidateMessages:me,setPreserve:me,getInitialValue:me}}}),Ke=Ge;function pt(De){return De==null?[]:Array.isArray(De)?De:[De]}var Xe=I(74165),gt=I(15861),ie=I(34155);function ft(){return ft=Object.assign?Object.assign.bind():function(De){for(var Me=1;Me<arguments.length;Me++){var ce=arguments[Me];for(var He in ce)Object.prototype.hasOwnProperty.call(ce,He)&&(De[He]=ce[He])}return De},ft.apply(this,arguments)}function ve(De,Me){De.prototype=Object.create(Me.prototype),De.prototype.constructor=De,Re(De,Me)}function Ae(De){return Ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ce){return ce.__proto__||Object.getPrototypeOf(ce)},Ae(De)}function Re(De,Me){return Re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(He,Pe){return He.__proto__=Pe,He},Re(De,Me)}function Ye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(De){return!1}}function at(De,Me,ce){return Ye()?at=Reflect.construct.bind():at=function(Pe,Tt,Mt){var $t=[null];$t.push.apply($t,Tt);var fr=Function.bind.apply(Pe,$t),Tr=new fr;return Mt&&Re(Tr,Mt.prototype),Tr},at.apply(null,arguments)}function ht(De){return Function.toString.call(De).indexOf("[native code]")!==-1}function Se(De){var Me=typeof Map=="function"?new Map:void 0;return Se=function(He){if(He===null||!ht(He))return He;if(typeof He!="function")throw new TypeError("Super expression must either be null or a function");if(typeof Me!="undefined"){if(Me.has(He))return Me.get(He);Me.set(He,Pe)}function Pe(){return at(He,arguments,Ae(this).constructor)}return Pe.prototype=Object.create(He.prototype,{constructor:{value:Pe,enumerable:!1,writable:!0,configurable:!0}}),Re(Pe,He)},Se(De)}var Qe=/%[sdj%]/g,oe=function(){};function ue(De){if(!De||!De.length)return null;var Me={};return De.forEach(function(ce){var He=ce.field;Me[He]=Me[He]||[],Me[He].push(ce)}),Me}function be(De){for(var Me=arguments.length,ce=new Array(Me>1?Me-1:0),He=1;He<Me;He++)ce[He-1]=arguments[He];var Pe=0,Tt=ce.length;if(typeof De=="function")return De.apply(null,ce);if(typeof De=="string"){var Mt=De.replace(Qe,function($t){if($t==="%%")return"%";if(Pe>=Tt)return $t;switch($t){case"%s":return String(ce[Pe++]);case"%d":return Number(ce[Pe++]);case"%j":try{return JSON.stringify(ce[Pe++])}catch(fr){return"[Circular]"}break;default:return $t}});return Mt}return De}function vt(De){return De==="string"||De==="url"||De==="hex"||De==="email"||De==="date"||De==="pattern"}function bt(De,Me){return!!(De==null||Me==="array"&&Array.isArray(De)&&!De.length||vt(Me)&&typeof De=="string"&&!De)}function Ht(De,Me,ce){var He=[],Pe=0,Tt=De.length;function Mt($t){He.push.apply(He,$t||[]),Pe++,Pe===Tt&&ce(He)}De.forEach(function($t){Me($t,Mt)})}function Er(De,Me,ce){var He=0,Pe=De.length;function Tt(Mt){if(Mt&&Mt.length){ce(Mt);return}var $t=He;He=He+1,$t<Pe?Me(De[$t],Tt):ce([])}Tt([])}function Vt(De){var Me=[];return Object.keys(De).forEach(function(ce){Me.push.apply(Me,De[ce]||[])}),Me}var on=function(De){ve(Me,De);function Me(ce,He){var Pe;return Pe=De.call(this,"Async Validation Error")||this,Pe.errors=ce,Pe.fields=He,Pe}return Me}(Se(Error));function hn(De,Me,ce,He,Pe){if(Me.first){var Tt=new Promise(function(lt,Xt){var nr=function(ln){return He(ln),ln.length?Xt(new on(ln,ue(ln))):lt(Pe)},ur=Vt(De);Er(ur,ce,nr)});return Tt.catch(function(lt){return lt}),Tt}var Mt=Me.firstFields===!0?Object.keys(De):Me.firstFields||[],$t=Object.keys(De),fr=$t.length,Tr=0,Sr=[],sn=new Promise(function(lt,Xt){var nr=function(Vr){if(Sr.push.apply(Sr,Vr),Tr++,Tr===fr)return He(Sr),Sr.length?Xt(new on(Sr,ue(Sr))):lt(Pe)};$t.length||(He(Sr),lt(Pe)),$t.forEach(function(ur){var Vr=De[ur];Mt.indexOf(ur)!==-1?Er(Vr,ce,nr):Ht(Vr,ce,nr)})});return sn.catch(function(lt){return lt}),sn}function gi(De){return!!(De&&De.message!==void 0)}function Hn(De,Me){for(var ce=De,He=0;He<Me.length;He++){if(ce==null)return ce;ce=ce[Me[He]]}return ce}function Dt(De,Me){return function(ce){var He;return De.fullFields?He=Hn(Me,De.fullFields):He=Me[ce.field||De.fullField],gi(ce)?(ce.field=ce.field||De.fullField,ce.fieldValue=He,ce):{message:typeof ce=="function"?ce():ce,fieldValue:He,field:ce.field||De.fullField}}}function Ea(De,Me){if(Me){for(var ce in Me)if(Me.hasOwnProperty(ce)){var He=Me[ce];typeof He=="object"&&typeof De[ce]=="object"?De[ce]=ft({},De[ce],He):De[ce]=He}}return De}var Ze=function(Me,ce,He,Pe,Tt,Mt){Me.required&&(!He.hasOwnProperty(Me.field)||bt(ce,Mt||Me.type))&&Pe.push(be(Tt.messages.required,Me.fullField))},ci=function(Me,ce,He,Pe,Tt){(/^\s+$/.test(ce)||ce==="")&&Pe.push(be(Tt.messages.whitespace,Me.fullField))},Ci,Oi=function(){if(Ci)return Ci;var De="[a-fA-F\\d:]",Me=function(qn){return qn&&qn.includeBoundaries?"(?:(?<=\\s|^)(?="+De+")|(?<="+De+")(?=\\s|$))":""},ce="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",He="[a-fA-F\\d]{1,4}",Pe=(`
(?:
(?:`+He+":){7}(?:"+He+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+He+":){6}(?:"+ce+"|:"+He+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+He+":){5}(?::"+ce+"|(?::"+He+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+He+":){4}(?:(?::"+He+"){0,1}:"+ce+"|(?::"+He+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+He+":){3}(?:(?::"+He+"){0,2}:"+ce+"|(?::"+He+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+He+":){2}(?:(?::"+He+"){0,3}:"+ce+"|(?::"+He+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+He+":){1}(?:(?::"+He+"){0,4}:"+ce+"|(?::"+He+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+He+"){0,5}:"+ce+"|(?::"+He+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),Tt=new RegExp("(?:^"+ce+"$)|(?:^"+Pe+"$)"),Mt=new RegExp("^"+ce+"$"),$t=new RegExp("^"+Pe+"$"),fr=function(qn){return qn&&qn.exact?Tt:new RegExp("(?:"+Me(qn)+ce+Me(qn)+")|(?:"+Me(qn)+Pe+Me(qn)+")","g")};fr.v4=function(Gn){return Gn&&Gn.exact?Mt:new RegExp(""+Me(Gn)+ce+Me(Gn),"g")},fr.v6=function(Gn){return Gn&&Gn.exact?$t:new RegExp(""+Me(Gn)+Pe+Me(Gn),"g")};var Tr="(?:(?:[a-z]+:)?//)",Sr="(?:\\S+(?::\\S*)?@)?",sn=fr.v4().source,lt=fr.v6().source,Xt="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",nr="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",ur="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",Vr="(?::\\d{2,5})?",ln='(?:[/?#][^\\s"]*)?',Un="(?:"+Tr+"|www\\.)"+Sr+"(?:localhost|"+sn+"|"+lt+"|"+Xt+nr+ur+")"+Vr+ln;return Ci=new RegExp("(?:^"+Un+"$)","i"),Ci},ea={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},fn={integer:function(Me){return fn.number(Me)&&parseInt(Me,10)===Me},float:function(Me){return fn.number(Me)&&!fn.integer(Me)},array:function(Me){return Array.isArray(Me)},regexp:function(Me){if(Me instanceof RegExp)return!0;try{return!!new RegExp(Me)}catch(ce){return!1}},date:function(Me){return typeof Me.getTime=="function"&&typeof Me.getMonth=="function"&&typeof Me.getYear=="function"&&!isNaN(Me.getTime())},number:function(Me){return isNaN(Me)?!1:typeof Me=="number"},object:function(Me){return typeof Me=="object"&&!fn.array(Me)},method:function(Me){return typeof Me=="function"},email:function(Me){return typeof Me=="string"&&Me.length<=320&&!!Me.match(ea.email)},url:function(Me){return typeof Me=="string"&&Me.length<=2048&&!!Me.match(Oi())},hex:function(Me){return typeof Me=="string"&&!!Me.match(ea.hex)}},tn=function(Me,ce,He,Pe,Tt){if(Me.required&&ce===void 0){Ze(Me,ce,He,Pe,Tt);return}var Mt=["integer","float","array","regexp","object","method","email","number","date","url","hex"],$t=Me.type;Mt.indexOf($t)>-1?fn[$t](ce)||Pe.push(be(Tt.messages.types[$t],Me.fullField,Me.type)):$t&&typeof ce!==Me.type&&Pe.push(be(Tt.messages.types[$t],Me.fullField,Me.type))},da=function(Me,ce,He,Pe,Tt){var Mt=typeof Me.len=="number",$t=typeof Me.min=="number",fr=typeof Me.max=="number",Tr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Sr=ce,sn=null,lt=typeof ce=="number",Xt=typeof ce=="string",nr=Array.isArray(ce);if(lt?sn="number":Xt?sn="string":nr&&(sn="array"),!sn)return!1;nr&&(Sr=ce.length),Xt&&(Sr=ce.replace(Tr,"_").length),Mt?Sr!==Me.len&&Pe.push(be(Tt.messages[sn].len,Me.fullField,Me.len)):$t&&!fr&&Sr<Me.min?Pe.push(be(Tt.messages[sn].min,Me.fullField,Me.min)):fr&&!$t&&Sr>Me.max?Pe.push(be(Tt.messages[sn].max,Me.fullField,Me.max)):$t&&fr&&(Sr<Me.min||Sr>Me.max)&&Pe.push(be(Tt.messages[sn].range,Me.fullField,Me.min,Me.max))},Ii="enum",Ai=function(Me,ce,He,Pe,Tt){Me[Ii]=Array.isArray(Me[Ii])?Me[Ii]:[],Me[Ii].indexOf(ce)===-1&&Pe.push(be(Tt.messages[Ii],Me.fullField,Me[Ii].join(", ")))},Pr=function(Me,ce,He,Pe,Tt){if(Me.pattern){if(Me.pattern instanceof RegExp)Me.pattern.lastIndex=0,Me.pattern.test(ce)||Pe.push(be(Tt.messages.pattern.mismatch,Me.fullField,ce,Me.pattern));else if(typeof Me.pattern=="string"){var Mt=new RegExp(Me.pattern);Mt.test(ce)||Pe.push(be(Tt.messages.pattern.mismatch,Me.fullField,ce,Me.pattern))}}},nt={required:Ze,whitespace:ci,type:tn,range:da,enum:Ai,pattern:Pr},it=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce,"string")&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt,"string"),bt(ce,"string")||(nt.type(Me,ce,Pe,Mt,Tt),nt.range(Me,ce,Pe,Mt,Tt),nt.pattern(Me,ce,Pe,Mt,Tt),Me.whitespace===!0&&nt.whitespace(Me,ce,Pe,Mt,Tt))}He(Mt)},_t=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce)&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt),ce!==void 0&&nt.type(Me,ce,Pe,Mt,Tt)}He(Mt)},we=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(ce===""&&(ce=void 0),bt(ce)&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt),ce!==void 0&&(nt.type(Me,ce,Pe,Mt,Tt),nt.range(Me,ce,Pe,Mt,Tt))}He(Mt)},er=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce)&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt),ce!==void 0&&nt.type(Me,ce,Pe,Mt,Tt)}He(Mt)},$r=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce)&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt),bt(ce)||nt.type(Me,ce,Pe,Mt,Tt)}He(Mt)},Fn=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce)&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt),ce!==void 0&&(nt.type(Me,ce,Pe,Mt,Tt),nt.range(Me,ce,Pe,Mt,Tt))}He(Mt)},Qt=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce)&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt),ce!==void 0&&(nt.type(Me,ce,Pe,Mt,Tt),nt.range(Me,ce,Pe,Mt,Tt))}He(Mt)},Br=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(ce==null&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt,"array"),ce!=null&&(nt.type(Me,ce,Pe,Mt,Tt),nt.range(Me,ce,Pe,Mt,Tt))}He(Mt)},bn=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce)&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt),ce!==void 0&&nt.type(Me,ce,Pe,Mt,Tt)}He(Mt)},gr="enum",pn=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce)&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt),ce!==void 0&&nt[gr](Me,ce,Pe,Mt,Tt)}He(Mt)},Sn=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce,"string")&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt),bt(ce,"string")||nt.pattern(Me,ce,Pe,Mt,Tt)}He(Mt)},Dn=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce,"date")&&!Me.required)return He();if(nt.required(Me,ce,Pe,Mt,Tt),!bt(ce,"date")){var fr;ce instanceof Date?fr=ce:fr=new Date(ce),nt.type(Me,fr,Pe,Mt,Tt),fr&&nt.range(Me,fr.getTime(),Pe,Mt,Tt)}}He(Mt)},ui=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Array.isArray(ce)?"array":typeof ce;nt.required(Me,ce,Pe,Mt,Tt,$t),He(Mt)},di=function(Me,ce,He,Pe,Tt){var Mt=Me.type,$t=[],fr=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if(fr){if(bt(ce,Mt)&&!Me.required)return He();nt.required(Me,ce,Pe,$t,Tt,Mt),bt(ce,Mt)||nt.type(Me,ce,Pe,$t,Tt)}He($t)},ca=function(Me,ce,He,Pe,Tt){var Mt=[],$t=Me.required||!Me.required&&Pe.hasOwnProperty(Me.field);if($t){if(bt(ce)&&!Me.required)return He();nt.required(Me,ce,Pe,Mt,Tt)}He(Mt)},Ni={string:it,method:_t,number:we,boolean:er,regexp:$r,integer:Fn,float:Qt,array:Br,object:bn,enum:pn,pattern:Sn,date:Dn,url:di,hex:di,email:di,required:ui,any:ca};function Wa(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var Me=JSON.parse(JSON.stringify(this));return Me.clone=this.clone,Me}}}var Ba=Wa(),Ia=function(){function De(ce){this.rules=null,this._messages=Ba,this.define(ce)}var Me=De.prototype;return Me.define=function(He){var Pe=this;if(!He)throw new Error("Cannot configure a schema with no rules");if(typeof He!="object"||Array.isArray(He))throw new Error("Rules must be an object");this.rules={},Object.keys(He).forEach(function(Tt){var Mt=He[Tt];Pe.rules[Tt]=Array.isArray(Mt)?Mt:[Mt]})},Me.messages=function(He){return He&&(this._messages=Ea(Wa(),He)),this._messages},Me.validate=function(He,Pe,Tt){var Mt=this;Pe===void 0&&(Pe={}),Tt===void 0&&(Tt=function(){});var $t=He,fr=Pe,Tr=Tt;if(typeof fr=="function"&&(Tr=fr,fr={}),!this.rules||Object.keys(this.rules).length===0)return Tr&&Tr(null,$t),Promise.resolve($t);function Sr(ur){var Vr=[],ln={};function Un(qn){if(Array.isArray(qn)){var oi;Vr=(oi=Vr).concat.apply(oi,qn)}else Vr.push(qn)}for(var Gn=0;Gn<ur.length;Gn++)Un(ur[Gn]);Vr.length?(ln=ue(Vr),Tr(Vr,ln)):Tr(null,$t)}if(fr.messages){var sn=this.messages();sn===Ba&&(sn=Wa()),Ea(sn,fr.messages),fr.messages=sn}else fr.messages=this.messages();var lt={},Xt=fr.keys||Object.keys(this.rules);Xt.forEach(function(ur){var Vr=Mt.rules[ur],ln=$t[ur];Vr.forEach(function(Un){var Gn=Un;typeof Gn.transform=="function"&&($t===He&&($t=ft({},$t)),ln=$t[ur]=Gn.transform(ln)),typeof Gn=="function"?Gn={validator:Gn}:Gn=ft({},Gn),Gn.validator=Mt.getValidationMethod(Gn),Gn.validator&&(Gn.field=ur,Gn.fullField=Gn.fullField||ur,Gn.type=Mt.getType(Gn),lt[ur]=lt[ur]||[],lt[ur].push({rule:Gn,value:ln,source:$t,field:ur}))})});var nr={};return hn(lt,fr,function(ur,Vr){var ln=ur.rule,Un=(ln.type==="object"||ln.type==="array")&&(typeof ln.fields=="object"||typeof ln.defaultField=="object");Un=Un&&(ln.required||!ln.required&&ur.value),ln.field=ur.field;function Gn(T,H){return ft({},H,{fullField:ln.fullField+"."+T,fullFields:ln.fullFields?[].concat(ln.fullFields,[T]):[T]})}function qn(T){T===void 0&&(T=[]);var H=Array.isArray(T)?T:[T];!fr.suppressWarning&&H.length&&De.warning("async-validator:",H),H.length&&ln.message!==void 0&&(H=[].concat(ln.message));var _e=H.map(Dt(ln,$t));if(fr.first&&_e.length)return nr[ln.field]=1,Vr(_e);if(!Un)Vr(_e);else{if(ln.required&&!ur.value)return ln.message!==void 0?_e=[].concat(ln.message).map(Dt(ln,$t)):fr.error&&(_e=[fr.error(ln,be(fr.messages.required,ln.field))]),Vr(_e);var ne={};ln.defaultField&&Object.keys(ur.value).map(function(zt){ne[zt]=ln.defaultField}),ne=ft({},ne,ur.rule.fields);var $e={};Object.keys(ne).forEach(function(zt){var _r=ne[zt],xr=Array.isArray(_r)?_r:[_r];$e[zt]=xr.map(Gn.bind(null,zt))});var xt=new De($e);xt.messages(fr.messages),ur.rule.options&&(ur.rule.options.messages=fr.messages,ur.rule.options.error=fr.error),xt.validate(ur.value,ur.rule.options||fr,function(zt){var _r=[];_e&&_e.length&&_r.push.apply(_r,_e),zt&&zt.length&&_r.push.apply(_r,zt),Vr(_r.length?_r:null)})}}var oi;if(ln.asyncValidator)oi=ln.asyncValidator(ln,ur.value,qn,ur.source,fr);else if(ln.validator){try{oi=ln.validator(ln,ur.value,qn,ur.source,fr)}catch(T){console.error==null||console.error(T),fr.suppressValidatorError||setTimeout(function(){throw T},0),qn(T.message)}oi===!0?qn():oi===!1?qn(typeof ln.message=="function"?ln.message(ln.fullField||ln.field):ln.message||(ln.fullField||ln.field)+" fails"):oi instanceof Array?qn(oi):oi instanceof Error&&qn(oi.message)}oi&&oi.then&&oi.then(function(){return qn()},function(T){return qn(T)})},function(ur){Sr(ur)},$t)},Me.getType=function(He){if(He.type===void 0&&He.pattern instanceof RegExp&&(He.type="pattern"),typeof He.validator!="function"&&He.type&&!Ni.hasOwnProperty(He.type))throw new Error(be("Unknown rule type %s",He.type));return He.type||"string"},Me.getValidationMethod=function(He){if(typeof He.validator=="function")return He.validator;var Pe=Object.keys(He),Tt=Pe.indexOf("message");return Tt!==-1&&Pe.splice(Tt,1),Pe.length===1&&Pe[0]==="required"?Ni.required:Ni[this.getType(He)]||void 0},De}();Ia.register=function(Me,ce){if(typeof ce!="function")throw new Error("Cannot register a validator by type, validator is not a function");Ni[Me]=ce},Ia.warning=oe,Ia.messages=Ba,Ia.validators=Ni;var an="'${name}' is not a valid ${type}",Ln={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:an,method:an,array:an,object:an,number:an,date:an,boolean:an,integer:an,float:an,regexp:an,email:an,url:an,hex:an},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},re=I(71002);function he(De,Me){for(var ce=De,He=0;He<Me.length;He+=1){if(ce==null)return;ce=ce[Me[He]]}return ce}var V=I(84506);function Et(De,Me,ce,He){if(!Me.length)return ce;var Pe=(0,V.Z)(Me),Tt=Pe[0],Mt=Pe.slice(1),$t;return!De&&typeof Tt=="number"?$t=[]:Array.isArray(De)?$t=(0,K.Z)(De):$t=(0,F.Z)({},De),He&&ce===void 0&&Mt.length===1?delete $t[Tt][Mt[0]]:$t[Tt]=Et($t[Tt],Mt,ce,He),$t}function Bt(De,Me,ce){var He=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return Me.length&&He&&ce===void 0&&!he(De,Me.slice(0,-1))?De:Et(De,Me,ce,He)}function Le(De){return Array.isArray(De)?tt(De):(0,re.Z)(De)==="object"&&De!==null?St(De):De}function St(De){if(Object.getPrototypeOf(De)===Object.prototype){var Me={};for(var ce in De)Me[ce]=Le(De[ce]);return Me}return De}function tt(De){return De.map(function(Me){return Le(Me)})}var At=Le;function tr(De){return pt(De)}function en(De,Me){var ce=he(De,Me);return ce}function Kr(De,Me,ce){var He=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,Pe=Bt(De,Me,ce,He);return Pe}function Ft(De,Me){var ce={};return Me.forEach(function(He){var Pe=en(De,He);ce=Kr(ce,He,Pe)}),ce}function rr(De,Me){return De&&De.some(function(ce){return _i(ce,Me)})}function ot(De){return(0,re.Z)(De)==="object"&&De!==null&&Object.getPrototypeOf(De)===Object.prototype}function Li(De,Me){var ce=Array.isArray(De)?(0,K.Z)(De):(0,F.Z)({},De);return Me&&Object.keys(Me).forEach(function(He){var Pe=ce[He],Tt=Me[He],Mt=ot(Pe)&&ot(Tt);ce[He]=Mt?Li(Pe,Tt||{}):At(Tt)}),ce}function Hr(De){for(var Me=arguments.length,ce=new Array(Me>1?Me-1:0),He=1;He<Me;He++)ce[He-1]=arguments[He];return ce.reduce(function(Pe,Tt){return Li(Pe,Tt)},De)}function _i(De,Me){return!De||!Me||De.length!==Me.length?!1:De.every(function(ce,He){return Me[He]===ce})}function vi(De,Me){if(De===Me)return!0;if(!De&&Me||De&&!Me||!De||!Me||(0,re.Z)(De)!=="object"||(0,re.Z)(Me)!=="object")return!1;var ce=Object.keys(De),He=Object.keys(Me),Pe=new Set([].concat(ce,He));return(0,K.Z)(Pe).every(function(Tt){var Mt=De[Tt],$t=Me[Tt];return typeof Mt=="function"&&typeof $t=="function"?!0:Mt===$t})}function It(De){var Me=arguments.length<=1?void 0:arguments[1];return Me&&Me.target&&(0,re.Z)(Me.target)==="object"&&De in Me.target?Me.target[De]:Me}function Yr(De,Me,ce){var He=De.length;if(Me<0||Me>=He||ce<0||ce>=He)return De;var Pe=De[Me],Tt=Me-ce;return Tt>0?[].concat((0,K.Z)(De.slice(0,ce)),[Pe],(0,K.Z)(De.slice(ce,Me)),(0,K.Z)(De.slice(Me+1,He))):Tt<0?[].concat((0,K.Z)(De.slice(0,Me)),(0,K.Z)(De.slice(Me+1,ce+1)),[Pe],(0,K.Z)(De.slice(ce+1,He))):De}var Dr=Ia;function Jn(De,Me){return De.replace(/\$\{\w+\}/g,function(ce){var He=ce.slice(2,-1);return Me[He]})}var Kt="CODE_LOGIC_ERROR";function hr(De,Me,ce,He,Pe){return Fr.apply(this,arguments)}function Fr(){return Fr=(0,gt.Z)((0,Xe.Z)().mark(function De(Me,ce,He,Pe,Tt){var Mt,$t,fr,Tr,Sr,sn,lt,Xt,nr;return(0,Xe.Z)().wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:return Mt=(0,F.Z)({},He),delete Mt.ruleIndex,Mt.validator&&($t=Mt.validator,Mt.validator=function(){try{return $t.apply(void 0,arguments)}catch(ln){return console.error(ln),Promise.reject(Kt)}}),fr=null,Mt&&Mt.type==="array"&&Mt.defaultField&&(fr=Mt.defaultField,delete Mt.defaultField),Tr=new Dr((0,ae.Z)({},Me,[Mt])),Sr=Hr({},Ln,Pe.validateMessages),Tr.messages(Sr),sn=[],Vr.prev=9,Vr.next=12,Promise.resolve(Tr.validate((0,ae.Z)({},Me,ce),(0,F.Z)({},Pe)));case 12:Vr.next=17;break;case 14:Vr.prev=14,Vr.t0=Vr.catch(9),Vr.t0.errors&&(sn=Vr.t0.errors.map(function(ln,Un){var Gn=ln.message,qn=Gn===Kt?Sr.default:Gn;return D.isValidElement(qn)?D.cloneElement(qn,{key:"error_".concat(Un)}):qn}));case 17:if(!(!sn.length&&fr)){Vr.next=22;break}return Vr.next=20,Promise.all(ce.map(function(ln,Un){return hr("".concat(Me,".").concat(Un),ln,fr,Pe,Tt)}));case 20:return lt=Vr.sent,Vr.abrupt("return",lt.reduce(function(ln,Un){return[].concat((0,K.Z)(ln),(0,K.Z)(Un))},[]));case 22:return Xt=(0,F.Z)((0,F.Z)({},He),{},{name:Me,enum:(He.enum||[]).join(", ")},Tt),nr=sn.map(function(ln){return typeof ln=="string"?Jn(ln,Xt):ln}),Vr.abrupt("return",nr);case 25:case"end":return Vr.stop()}},De,null,[[9,14]])})),Fr.apply(this,arguments)}function qr(De,Me,ce,He,Pe,Tt){var Mt=De.join("."),$t=ce.map(function(Sr,sn){var lt=Sr.validator,Xt=(0,F.Z)((0,F.Z)({},Sr),{},{ruleIndex:sn});return lt&&(Xt.validator=function(nr,ur,Vr){var ln=!1,Un=function(){for(var oi=arguments.length,T=new Array(oi),H=0;H<oi;H++)T[H]=arguments[H];Promise.resolve().then(function(){(0,Ce.ZP)(!ln,"Your validator function has already return a promise. `callback` will be ignored."),ln||Vr.apply(void 0,T)})},Gn=lt(nr,ur,Un);ln=Gn&&typeof Gn.then=="function"&&typeof Gn.catch=="function",(0,Ce.ZP)(ln,"`callback` is deprecated. Please return a promise instead."),ln&&Gn.then(function(){Vr()}).catch(function(qn){Vr(qn||" ")})}),Xt}).sort(function(Sr,sn){var lt=Sr.warningOnly,Xt=Sr.ruleIndex,nr=sn.warningOnly,ur=sn.ruleIndex;return!!lt==!!nr?Xt-ur:lt?1:-1}),fr;if(Pe===!0)fr=new Promise(function(){var Sr=(0,gt.Z)((0,Xe.Z)().mark(function sn(lt,Xt){var nr,ur,Vr;return(0,Xe.Z)().wrap(function(Un){for(;;)switch(Un.prev=Un.next){case 0:nr=0;case 1:if(!(nr<$t.length)){Un.next=12;break}return ur=$t[nr],Un.next=5,hr(Mt,Me,ur,He,Tt);case 5:if(Vr=Un.sent,!Vr.length){Un.next=9;break}return Xt([{errors:Vr,rule:ur}]),Un.abrupt("return");case 9:nr+=1,Un.next=1;break;case 12:lt([]);case 13:case"end":return Un.stop()}},sn)}));return function(sn,lt){return Sr.apply(this,arguments)}}());else{var Tr=$t.map(function(Sr){return hr(Mt,Me,Sr,He,Tt).then(function(sn){return{errors:sn,rule:Sr}})});fr=(Pe?fa(Tr):An(Tr)).then(function(Sr){return Promise.reject(Sr)})}return fr.catch(function(Sr){return Sr}),fr}function An(De){return Ui.apply(this,arguments)}function Ui(){return Ui=(0,gt.Z)((0,Xe.Z)().mark(function De(Me){return(0,Xe.Z)().wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return He.abrupt("return",Promise.all(Me).then(function(Pe){var Tt,Mt=(Tt=[]).concat.apply(Tt,(0,K.Z)(Pe));return Mt}));case 1:case"end":return He.stop()}},De)})),Ui.apply(this,arguments)}function fa(De){return Wi.apply(this,arguments)}function Wi(){return Wi=(0,gt.Z)((0,Xe.Z)().mark(function De(Me){var ce;return(0,Xe.Z)().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return ce=0,Pe.abrupt("return",new Promise(function(Tt){Me.forEach(function(Mt){Mt.then(function($t){$t.errors.length&&Tt([$t]),ce+=1,ce===Me.length&&Tt([])})})}));case 2:case"end":return Pe.stop()}},De)})),Wi.apply(this,arguments)}var ct=["name"],qi=[];function Na(De,Me,ce,He,Pe,Tt){return typeof De=="function"?De(Me,ce,"source"in Tt?{source:Tt.source}:{}):He!==Pe}var To=function(De){(0,$.Z)(ce,De);var Me=(0,xe.Z)(ce);function ce(He){var Pe;if((0,W.Z)(this,ce),Pe=Me.call(this,He),Pe.state={resetCount:0},Pe.cancelRegisterFunc=null,Pe.mounted=!1,Pe.touched=!1,Pe.dirty=!1,Pe.validatePromise=null,Pe.prevValidating=void 0,Pe.errors=qi,Pe.warnings=qi,Pe.cancelRegister=function(){var fr=Pe.props,Tr=fr.preserve,Sr=fr.isListField,sn=fr.name;Pe.cancelRegisterFunc&&Pe.cancelRegisterFunc(Sr,Tr,tr(sn)),Pe.cancelRegisterFunc=null},Pe.getNamePath=function(){var fr=Pe.props,Tr=fr.name,Sr=fr.fieldContext,sn=Sr.prefixName,lt=sn===void 0?[]:sn;return Tr!==void 0?[].concat((0,K.Z)(lt),(0,K.Z)(Tr)):[]},Pe.getRules=function(){var fr=Pe.props,Tr=fr.rules,Sr=Tr===void 0?[]:Tr,sn=fr.fieldContext;return Sr.map(function(lt){return typeof lt=="function"?lt(sn):lt})},Pe.refresh=function(){Pe.mounted&&Pe.setState(function(fr){var Tr=fr.resetCount;return{resetCount:Tr+1}})},Pe.triggerMetaEvent=function(fr){var Tr=Pe.props.onMetaChange;Tr==null||Tr((0,F.Z)((0,F.Z)({},Pe.getMeta()),{},{destroy:fr}))},Pe.onStoreChange=function(fr,Tr,Sr){var sn=Pe.props,lt=sn.shouldUpdate,Xt=sn.dependencies,nr=Xt===void 0?[]:Xt,ur=sn.onReset,Vr=Sr.store,ln=Pe.getNamePath(),Un=Pe.getValue(fr),Gn=Pe.getValue(Vr),qn=Tr&&rr(Tr,ln);switch(Sr.type==="valueUpdate"&&Sr.source==="external"&&Un!==Gn&&(Pe.touched=!0,Pe.dirty=!0,Pe.validatePromise=null,Pe.errors=qi,Pe.warnings=qi,Pe.triggerMetaEvent()),Sr.type){case"reset":if(!Tr||qn){Pe.touched=!1,Pe.dirty=!1,Pe.validatePromise=null,Pe.errors=qi,Pe.warnings=qi,Pe.triggerMetaEvent(),ur==null||ur(),Pe.refresh();return}break;case"remove":{if(lt){Pe.reRender();return}break}case"setField":{if(qn){var oi=Sr.data;"touched"in oi&&(Pe.touched=oi.touched),"validating"in oi&&!("originRCField"in oi)&&(Pe.validatePromise=oi.validating?Promise.resolve([]):null),"errors"in oi&&(Pe.errors=oi.errors||qi),"warnings"in oi&&(Pe.warnings=oi.warnings||qi),Pe.dirty=!0,Pe.triggerMetaEvent(),Pe.reRender();return}if(lt&&!ln.length&&Na(lt,fr,Vr,Un,Gn,Sr)){Pe.reRender();return}break}case"dependenciesUpdate":{var T=nr.map(tr);if(T.some(function(H){return rr(Sr.relatedFields,H)})){Pe.reRender();return}break}default:if(qn||(!nr.length||ln.length||lt)&&Na(lt,fr,Vr,Un,Gn,Sr)){Pe.reRender();return}break}lt===!0&&Pe.reRender()},Pe.validateRules=function(fr){var Tr=Pe.getNamePath(),Sr=Pe.getValue(),sn=Promise.resolve().then(function(){if(!Pe.mounted)return[];var lt=Pe.props,Xt=lt.validateFirst,nr=Xt===void 0?!1:Xt,ur=lt.messageVariables,Vr=fr||{},ln=Vr.triggerName,Un=Pe.getRules();ln&&(Un=Un.filter(function(qn){return qn}).filter(function(qn){var oi=qn.validateTrigger;if(!oi)return!0;var T=pt(oi);return T.includes(ln)}));var Gn=qr(Tr,Sr,Un,fr,nr,ur);return Gn.catch(function(qn){return qn}).then(function(){var qn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qi;if(Pe.validatePromise===sn){var oi;Pe.validatePromise=null;var T=[],H=[];(oi=qn.forEach)===null||oi===void 0||oi.call(qn,function(_e){var ne=_e.rule.warningOnly,$e=_e.errors,xt=$e===void 0?qi:$e;ne?H.push.apply(H,(0,K.Z)(xt)):T.push.apply(T,(0,K.Z)(xt))}),Pe.errors=T,Pe.warnings=H,Pe.triggerMetaEvent(),Pe.reRender()}}),Gn});return Pe.validatePromise=sn,Pe.dirty=!0,Pe.errors=qi,Pe.warnings=qi,Pe.triggerMetaEvent(),Pe.reRender(),sn},Pe.isFieldValidating=function(){return!!Pe.validatePromise},Pe.isFieldTouched=function(){return Pe.touched},Pe.isFieldDirty=function(){if(Pe.dirty||Pe.props.initialValue!==void 0)return!0;var fr=Pe.props.fieldContext,Tr=fr.getInternalHooks(We),Sr=Tr.getInitialValue;return Sr(Pe.getNamePath())!==void 0},Pe.getErrors=function(){return Pe.errors},Pe.getWarnings=function(){return Pe.warnings},Pe.isListField=function(){return Pe.props.isListField},Pe.isList=function(){return Pe.props.isList},Pe.isPreserve=function(){return Pe.props.preserve},Pe.getMeta=function(){Pe.prevValidating=Pe.isFieldValidating();var fr={touched:Pe.isFieldTouched(),validating:Pe.prevValidating,errors:Pe.errors,warnings:Pe.warnings,name:Pe.getNamePath()};return fr},Pe.getOnlyChild=function(fr){if(typeof fr=="function"){var Tr=Pe.getMeta();return(0,F.Z)((0,F.Z)({},Pe.getOnlyChild(fr(Pe.getControlled(),Tr,Pe.props.fieldContext))),{},{isFunction:!0})}var Sr=(0,Fe.Z)(fr);return Sr.length!==1||!D.isValidElement(Sr[0])?{child:Sr,isFunction:!1}:{child:Sr[0],isFunction:!1}},Pe.getValue=function(fr){var Tr=Pe.props.fieldContext.getFieldsValue,Sr=Pe.getNamePath();return en(fr||Tr(!0),Sr)},Pe.getControlled=function(){var fr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Tr=Pe.props,Sr=Tr.trigger,sn=Tr.validateTrigger,lt=Tr.getValueFromEvent,Xt=Tr.normalize,nr=Tr.valuePropName,ur=Tr.getValueProps,Vr=Tr.fieldContext,ln=sn!==void 0?sn:Vr.validateTrigger,Un=Pe.getNamePath(),Gn=Vr.getInternalHooks,qn=Vr.getFieldsValue,oi=Gn(We),T=oi.dispatch,H=Pe.getValue(),_e=ur||function(zt){return(0,ae.Z)({},nr,zt)},ne=fr[Sr],$e=(0,F.Z)((0,F.Z)({},fr),_e(H));$e[Sr]=function(){Pe.touched=!0,Pe.dirty=!0,Pe.triggerMetaEvent();for(var zt,_r=arguments.length,xr=new Array(_r),dn=0;dn<_r;dn++)xr[dn]=arguments[dn];lt?zt=lt.apply(void 0,xr):zt=It.apply(void 0,[nr].concat(xr)),Xt&&(zt=Xt(zt,H,qn(!0))),T({type:"updateValue",namePath:Un,value:zt}),ne&&ne.apply(void 0,xr)};var xt=pt(ln||[]);return xt.forEach(function(zt){var _r=$e[zt];$e[zt]=function(){_r&&_r.apply(void 0,arguments);var xr=Pe.props.rules;xr&&xr.length&&T({type:"validateField",namePath:Un,triggerName:zt})}}),$e},He.fieldContext){var Tt=He.fieldContext.getInternalHooks,Mt=Tt(We),$t=Mt.initEntityValue;$t((0,G.Z)(Pe))}return Pe}return(0,Y.Z)(ce,[{key:"componentDidMount",value:function(){var Pe=this.props,Tt=Pe.shouldUpdate,Mt=Pe.fieldContext;if(this.mounted=!0,Mt){var $t=Mt.getInternalHooks,fr=$t(We),Tr=fr.registerField;this.cancelRegisterFunc=Tr(this)}Tt===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var Pe=this.state.resetCount,Tt=this.props.children,Mt=this.getOnlyChild(Tt),$t=Mt.child,fr=Mt.isFunction,Tr;return fr?Tr=$t:D.isValidElement($t)?Tr=D.cloneElement($t,this.getControlled($t.props)):((0,Ce.ZP)(!$t,"`children` of Field is not validate ReactElement."),Tr=$t),D.createElement(D.Fragment,{key:Pe},Tr)}}]),ce}(D.Component);To.contextType=Ke,To.defaultProps={trigger:"onChange",valuePropName:"value"};function ao(De){var Me=De.name,ce=(0,m.Z)(De,ct),He=D.useContext(Ke),Pe=Me!==void 0?tr(Me):void 0,Tt="keep";return ce.isListField||(Tt="_".concat((Pe||[]).join("_"))),D.createElement(To,(0,k.Z)({key:Tt,name:Pe},ce,{fieldContext:He}))}var Ga=ao,Ko=D.createContext(null),ws=Ko,Fo=function(Me){var ce=Me.name,He=Me.initialValue,Pe=Me.children,Tt=Me.rules,Mt=Me.validateTrigger,$t=D.useContext(Ke),fr=D.useRef({keys:[],id:0}),Tr=fr.current,Sr=D.useMemo(function(){var nr=tr($t.prefixName)||[];return[].concat((0,K.Z)(nr),(0,K.Z)(tr(ce)))},[$t.prefixName,ce]),sn=D.useMemo(function(){return(0,F.Z)((0,F.Z)({},$t),{},{prefixName:Sr})},[$t,Sr]),lt=D.useMemo(function(){return{getKey:function(ur){var Vr=Sr.length,ln=ur[Vr];return[Tr.keys[ln],ur.slice(Vr+1)]}}},[Sr]);if(typeof Pe!="function")return(0,Ce.ZP)(!1,"Form.List only accepts function as children."),null;var Xt=function(ur,Vr,ln){var Un=ln.source;return Un==="internal"?!1:ur!==Vr};return D.createElement(ws.Provider,{value:lt},D.createElement(Ke.Provider,{value:sn},D.createElement(Ga,{name:[],shouldUpdate:Xt,rules:Tt,validateTrigger:Mt,initialValue:He,isList:!0},function(nr,ur){var Vr=nr.value,ln=Vr===void 0?[]:Vr,Un=nr.onChange,Gn=$t.getFieldValue,qn=function(){var _e=Gn(Sr||[]);return _e||[]},oi={add:function(_e,ne){var $e=qn();ne>=0&&ne<=$e.length?(Tr.keys=[].concat((0,K.Z)(Tr.keys.slice(0,ne)),[Tr.id],(0,K.Z)(Tr.keys.slice(ne))),Un([].concat((0,K.Z)($e.slice(0,ne)),[_e],(0,K.Z)($e.slice(ne))))):(Tr.keys=[].concat((0,K.Z)(Tr.keys),[Tr.id]),Un([].concat((0,K.Z)($e),[_e]))),Tr.id+=1},remove:function(_e){var ne=qn(),$e=new Set(Array.isArray(_e)?_e:[_e]);$e.size<=0||(Tr.keys=Tr.keys.filter(function(xt,zt){return!$e.has(zt)}),Un(ne.filter(function(xt,zt){return!$e.has(zt)})))},move:function(_e,ne){if(_e!==ne){var $e=qn();_e<0||_e>=$e.length||ne<0||ne>=$e.length||(Tr.keys=Yr(Tr.keys,_e,ne),Un(Yr($e,_e,ne)))}}},T=ln||[];return Array.isArray(T)||(T=[]),Pe(T.map(function(H,_e){var ne=Tr.keys[_e];return ne===void 0&&(Tr.keys[_e]=Tr.id,ne=Tr.keys[_e],Tr.id+=1),{name:_e,key:ne,isListField:!0}}),oi,ur)})))},su=Fo,zo=I(97685);function ns(De){var Me=!1,ce=De.length,He=[];return De.length?new Promise(function(Pe,Tt){De.forEach(function(Mt,$t){Mt.catch(function(fr){return Me=!0,fr}).then(function(fr){ce-=1,He[$t]=fr,!(ce>0)&&(Me&&Tt(He),Pe(He))})})}):Promise.resolve([])}var ls="__@field_split__";function _o(De){return De.map(function(Me){return"".concat((0,re.Z)(Me),":").concat(Me)}).join(ls)}var Po=function(){function De(){(0,W.Z)(this,De),this.kvs=new Map}return(0,Y.Z)(De,[{key:"set",value:function(ce,He){this.kvs.set(_o(ce),He)}},{key:"get",value:function(ce){return this.kvs.get(_o(ce))}},{key:"update",value:function(ce,He){var Pe=this.get(ce),Tt=He(Pe);Tt?this.set(ce,Tt):this.delete(ce)}},{key:"delete",value:function(ce){this.kvs.delete(_o(ce))}},{key:"map",value:function(ce){return(0,K.Z)(this.kvs.entries()).map(function(He){var Pe=(0,zo.Z)(He,2),Tt=Pe[0],Mt=Pe[1],$t=Tt.split(ls);return ce({key:$t.map(function(fr){var Tr=fr.match(/^([^:]*):(.*)$/),Sr=(0,zo.Z)(Tr,3),sn=Sr[1],lt=Sr[2];return sn==="number"?Number(lt):lt}),value:Mt})})}},{key:"toJSON",value:function(){var ce={};return this.map(function(He){var Pe=He.key,Tt=He.value;return ce[Pe.join(".")]=Tt,null}),ce}}]),De}(),Ss=Po,Wu=["name","errors"],$s=(0,Y.Z)(function De(Me){var ce=this;(0,W.Z)(this,De),this.formHooked=!1,this.forceRootUpdate=void 0,this.subscribable=!0,this.store={},this.fieldEntities=[],this.initialValues={},this.callbacks={},this.validateMessages=null,this.preserve=null,this.lastValidatePromise=null,this.getForm=function(){return{getFieldValue:ce.getFieldValue,getFieldsValue:ce.getFieldsValue,getFieldError:ce.getFieldError,getFieldWarning:ce.getFieldWarning,getFieldsError:ce.getFieldsError,isFieldsTouched:ce.isFieldsTouched,isFieldTouched:ce.isFieldTouched,isFieldValidating:ce.isFieldValidating,isFieldsValidating:ce.isFieldsValidating,resetFields:ce.resetFields,setFields:ce.setFields,setFieldValue:ce.setFieldValue,setFieldsValue:ce.setFieldsValue,validateFields:ce.validateFields,submit:ce.submit,_init:!0,getInternalHooks:ce.getInternalHooks}},this.getInternalHooks=function(He){return He===We?(ce.formHooked=!0,{dispatch:ce.dispatch,initEntityValue:ce.initEntityValue,registerField:ce.registerField,useSubscribe:ce.useSubscribe,setInitialValues:ce.setInitialValues,destroyForm:ce.destroyForm,setCallbacks:ce.setCallbacks,setValidateMessages:ce.setValidateMessages,getFields:ce.getFields,setPreserve:ce.setPreserve,getInitialValue:ce.getInitialValue,registerWatch:ce.registerWatch}):((0,Ce.ZP)(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)},this.useSubscribe=function(He){ce.subscribable=He},this.prevWithoutPreserves=null,this.setInitialValues=function(He,Pe){if(ce.initialValues=He||{},Pe){var Tt,Mt=Hr({},He,ce.store);(Tt=ce.prevWithoutPreserves)===null||Tt===void 0||Tt.map(function($t){var fr=$t.key;Mt=Kr(Mt,fr,en(He,fr))}),ce.prevWithoutPreserves=null,ce.updateStore(Mt)}},this.destroyForm=function(){var He=new Ss;ce.getFieldEntities(!0).forEach(function(Pe){ce.isMergedPreserve(Pe.isPreserve())||He.set(Pe.getNamePath(),!0)}),ce.prevWithoutPreserves=He},this.getInitialValue=function(He){var Pe=en(ce.initialValues,He);return He.length?At(Pe):Pe},this.setCallbacks=function(He){ce.callbacks=He},this.setValidateMessages=function(He){ce.validateMessages=He},this.setPreserve=function(He){ce.preserve=He},this.watchList=[],this.registerWatch=function(He){return ce.watchList.push(He),function(){ce.watchList=ce.watchList.filter(function(Pe){return Pe!==He})}},this.notifyWatch=function(){var He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(ce.watchList.length){var Pe=ce.getFieldsValue();ce.watchList.forEach(function(Tt){Tt(Pe,He)})}},this.timeoutId=null,this.warningUnhooked=function(){},this.updateStore=function(He){ce.store=He},this.getFieldEntities=function(){var He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return He?ce.fieldEntities.filter(function(Pe){return Pe.getNamePath().length}):ce.fieldEntities},this.getFieldsMap=function(){var He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Pe=new Ss;return ce.getFieldEntities(He).forEach(function(Tt){var Mt=Tt.getNamePath();Pe.set(Mt,Tt)}),Pe},this.getFieldEntitiesForNamePathList=function(He){if(!He)return ce.getFieldEntities(!0);var Pe=ce.getFieldsMap(!0);return He.map(function(Tt){var Mt=tr(Tt);return Pe.get(Mt)||{INVALIDATE_NAME_PATH:tr(Tt)}})},this.getFieldsValue=function(He,Pe){if(ce.warningUnhooked(),He===!0&&!Pe)return ce.store;var Tt=ce.getFieldEntitiesForNamePathList(Array.isArray(He)?He:null),Mt=[];return Tt.forEach(function($t){var fr,Tr="INVALIDATE_NAME_PATH"in $t?$t.INVALIDATE_NAME_PATH:$t.getNamePath();if(!(!He&&(!((fr=$t.isListField)===null||fr===void 0)&&fr.call($t))))if(!Pe)Mt.push(Tr);else{var Sr="getMeta"in $t?$t.getMeta():null;Pe(Sr)&&Mt.push(Tr)}}),Ft(ce.store,Mt.map(tr))},this.getFieldValue=function(He){ce.warningUnhooked();var Pe=tr(He);return en(ce.store,Pe)},this.getFieldsError=function(He){ce.warningUnhooked();var Pe=ce.getFieldEntitiesForNamePathList(He);return Pe.map(function(Tt,Mt){return Tt&&!("INVALIDATE_NAME_PATH"in Tt)?{name:Tt.getNamePath(),errors:Tt.getErrors(),warnings:Tt.getWarnings()}:{name:tr(He[Mt]),errors:[],warnings:[]}})},this.getFieldError=function(He){ce.warningUnhooked();var Pe=tr(He),Tt=ce.getFieldsError([Pe])[0];return Tt.errors},this.getFieldWarning=function(He){ce.warningUnhooked();var Pe=tr(He),Tt=ce.getFieldsError([Pe])[0];return Tt.warnings},this.isFieldsTouched=function(){ce.warningUnhooked();for(var He=arguments.length,Pe=new Array(He),Tt=0;Tt<He;Tt++)Pe[Tt]=arguments[Tt];var Mt=Pe[0],$t=Pe[1],fr,Tr=!1;Pe.length===0?fr=null:Pe.length===1?Array.isArray(Mt)?(fr=Mt.map(tr),Tr=!1):(fr=null,Tr=Mt):(fr=Mt.map(tr),Tr=$t);var Sr=ce.getFieldEntities(!0),sn=function(Vr){return Vr.isFieldTouched()};if(!fr)return Tr?Sr.every(sn):Sr.some(sn);var lt=new Ss;fr.forEach(function(ur){lt.set(ur,[])}),Sr.forEach(function(ur){var Vr=ur.getNamePath();fr.forEach(function(ln){ln.every(function(Un,Gn){return Vr[Gn]===Un})&&lt.update(ln,function(Un){return[].concat((0,K.Z)(Un),[ur])})})});var Xt=function(Vr){return Vr.some(sn)},nr=lt.map(function(ur){var Vr=ur.value;return Vr});return Tr?nr.every(Xt):nr.some(Xt)},this.isFieldTouched=function(He){return ce.warningUnhooked(),ce.isFieldsTouched([He])},this.isFieldsValidating=function(He){ce.warningUnhooked();var Pe=ce.getFieldEntities();if(!He)return Pe.some(function(Mt){return Mt.isFieldValidating()});var Tt=He.map(tr);return Pe.some(function(Mt){var $t=Mt.getNamePath();return rr(Tt,$t)&&Mt.isFieldValidating()})},this.isFieldValidating=function(He){return ce.warningUnhooked(),ce.isFieldsValidating([He])},this.resetWithFieldInitialValue=function(){var He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Pe=new Ss,Tt=ce.getFieldEntities(!0);Tt.forEach(function(fr){var Tr=fr.props.initialValue,Sr=fr.getNamePath();if(Tr!==void 0){var sn=Pe.get(Sr)||new Set;sn.add({entity:fr,value:Tr}),Pe.set(Sr,sn)}});var Mt=function(Tr){Tr.forEach(function(Sr){var sn=Sr.props.initialValue;if(sn!==void 0){var lt=Sr.getNamePath(),Xt=ce.getInitialValue(lt);if(Xt!==void 0)(0,Ce.ZP)(!1,"Form already set 'initialValues' with path '".concat(lt.join("."),"'. Field can not overwrite it."));else{var nr=Pe.get(lt);if(nr&&nr.size>1)(0,Ce.ZP)(!1,"Multiple Field with path '".concat(lt.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(nr){var ur=ce.getFieldValue(lt);(!He.skipExist||ur===void 0)&&ce.updateStore(Kr(ce.store,lt,(0,K.Z)(nr)[0].value))}}}})},$t;He.entities?$t=He.entities:He.namePathList?($t=[],He.namePathList.forEach(function(fr){var Tr=Pe.get(fr);if(Tr){var Sr;(Sr=$t).push.apply(Sr,(0,K.Z)((0,K.Z)(Tr).map(function(sn){return sn.entity})))}})):$t=Tt,Mt($t)},this.resetFields=function(He){ce.warningUnhooked();var Pe=ce.store;if(!He){ce.updateStore(Hr({},ce.initialValues)),ce.resetWithFieldInitialValue(),ce.notifyObservers(Pe,null,{type:"reset"}),ce.notifyWatch();return}var Tt=He.map(tr);Tt.forEach(function(Mt){var $t=ce.getInitialValue(Mt);ce.updateStore(Kr(ce.store,Mt,$t))}),ce.resetWithFieldInitialValue({namePathList:Tt}),ce.notifyObservers(Pe,Tt,{type:"reset"}),ce.notifyWatch(Tt)},this.setFields=function(He){ce.warningUnhooked();var Pe=ce.store,Tt=[];He.forEach(function(Mt){var $t=Mt.name,fr=Mt.errors,Tr=(0,m.Z)(Mt,Wu),Sr=tr($t);Tt.push(Sr),"value"in Tr&&ce.updateStore(Kr(ce.store,Sr,Tr.value)),ce.notifyObservers(Pe,[Sr],{type:"setField",data:Mt})}),ce.notifyWatch(Tt)},this.getFields=function(){var He=ce.getFieldEntities(!0),Pe=He.map(function(Tt){var Mt=Tt.getNamePath(),$t=Tt.getMeta(),fr=(0,F.Z)((0,F.Z)({},$t),{},{name:Mt,value:ce.getFieldValue(Mt)});return Object.defineProperty(fr,"originRCField",{value:!0}),fr});return Pe},this.initEntityValue=function(He){var Pe=He.props.initialValue;if(Pe!==void 0){var Tt=He.getNamePath(),Mt=en(ce.store,Tt);Mt===void 0&&ce.updateStore(Kr(ce.store,Tt,Pe))}},this.isMergedPreserve=function(He){var Pe=He!==void 0?He:ce.preserve;return Pe!=null?Pe:!0},this.registerField=function(He){ce.fieldEntities.push(He);var Pe=He.getNamePath();if(ce.notifyWatch([Pe]),He.props.initialValue!==void 0){var Tt=ce.store;ce.resetWithFieldInitialValue({entities:[He],skipExist:!0}),ce.notifyObservers(Tt,[He.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(Mt,$t){var fr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(ce.fieldEntities=ce.fieldEntities.filter(function(sn){return sn!==He}),!ce.isMergedPreserve($t)&&(!Mt||fr.length>1)){var Tr=Mt?void 0:ce.getInitialValue(Pe);if(Pe.length&&ce.getFieldValue(Pe)!==Tr&&ce.fieldEntities.every(function(sn){return!_i(sn.getNamePath(),Pe)})){var Sr=ce.store;ce.updateStore(Kr(Sr,Pe,Tr,!0)),ce.notifyObservers(Sr,[Pe],{type:"remove"}),ce.triggerDependenciesUpdate(Sr,Pe)}}ce.notifyWatch([Pe])}},this.dispatch=function(He){switch(He.type){case"updateValue":{var Pe=He.namePath,Tt=He.value;ce.updateValue(Pe,Tt);break}case"validateField":{var Mt=He.namePath,$t=He.triggerName;ce.validateFields([Mt],{triggerName:$t});break}default:}},this.notifyObservers=function(He,Pe,Tt){if(ce.subscribable){var Mt=(0,F.Z)((0,F.Z)({},Tt),{},{store:ce.getFieldsValue(!0)});ce.getFieldEntities().forEach(function($t){var fr=$t.onStoreChange;fr(He,Pe,Mt)})}else ce.forceRootUpdate()},this.triggerDependenciesUpdate=function(He,Pe){var Tt=ce.getDependencyChildrenFields(Pe);return Tt.length&&ce.validateFields(Tt),ce.notifyObservers(He,Tt,{type:"dependenciesUpdate",relatedFields:[Pe].concat((0,K.Z)(Tt))}),Tt},this.updateValue=function(He,Pe){var Tt=tr(He),Mt=ce.store;ce.updateStore(Kr(ce.store,Tt,Pe)),ce.notifyObservers(Mt,[Tt],{type:"valueUpdate",source:"internal"}),ce.notifyWatch([Tt]);var $t=ce.triggerDependenciesUpdate(Mt,Tt),fr=ce.callbacks.onValuesChange;if(fr){var Tr=Ft(ce.store,[Tt]);fr(Tr,ce.getFieldsValue())}ce.triggerOnFieldsChange([Tt].concat((0,K.Z)($t)))},this.setFieldsValue=function(He){ce.warningUnhooked();var Pe=ce.store;if(He){var Tt=Hr(ce.store,He);ce.updateStore(Tt)}ce.notifyObservers(Pe,null,{type:"valueUpdate",source:"external"}),ce.notifyWatch()},this.setFieldValue=function(He,Pe){ce.setFields([{name:He,value:Pe}])},this.getDependencyChildrenFields=function(He){var Pe=new Set,Tt=[],Mt=new Ss;ce.getFieldEntities().forEach(function(fr){var Tr=fr.props.dependencies;(Tr||[]).forEach(function(Sr){var sn=tr(Sr);Mt.update(sn,function(){var lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return lt.add(fr),lt})})});var $t=function fr(Tr){var Sr=Mt.get(Tr)||new Set;Sr.forEach(function(sn){if(!Pe.has(sn)){Pe.add(sn);var lt=sn.getNamePath();sn.isFieldDirty()&&lt.length&&(Tt.push(lt),fr(lt))}})};return $t(He),Tt},this.triggerOnFieldsChange=function(He,Pe){var Tt=ce.callbacks.onFieldsChange;if(Tt){var Mt=ce.getFields();if(Pe){var $t=new Ss;Pe.forEach(function(Tr){var Sr=Tr.name,sn=Tr.errors;$t.set(Sr,sn)}),Mt.forEach(function(Tr){Tr.errors=$t.get(Tr.name)||Tr.errors})}var fr=Mt.filter(function(Tr){var Sr=Tr.name;return rr(He,Sr)});Tt(fr,Mt)}},this.validateFields=function(He,Pe){ce.warningUnhooked();var Tt=!!He,Mt=Tt?He.map(tr):[],$t=[];ce.getFieldEntities(!0).forEach(function(Sr){if(Tt||Mt.push(Sr.getNamePath()),Pe!=null&&Pe.recursive&&Tt){var sn=Sr.getNamePath();sn.every(function(nr,ur){return He[ur]===nr||He[ur]===void 0})&&Mt.push(sn)}if(!(!Sr.props.rules||!Sr.props.rules.length)){var lt=Sr.getNamePath();if(!Tt||rr(Mt,lt)){var Xt=Sr.validateRules((0,F.Z)({validateMessages:(0,F.Z)((0,F.Z)({},Ln),ce.validateMessages)},Pe));$t.push(Xt.then(function(){return{name:lt,errors:[],warnings:[]}}).catch(function(nr){var ur,Vr=[],ln=[];return(ur=nr.forEach)===null||ur===void 0||ur.call(nr,function(Un){var Gn=Un.rule.warningOnly,qn=Un.errors;Gn?ln.push.apply(ln,(0,K.Z)(qn)):Vr.push.apply(Vr,(0,K.Z)(qn))}),Vr.length?Promise.reject({name:lt,errors:Vr,warnings:ln}):{name:lt,errors:Vr,warnings:ln}}))}}});var fr=ns($t);ce.lastValidatePromise=fr,fr.catch(function(Sr){return Sr}).then(function(Sr){var sn=Sr.map(function(lt){var Xt=lt.name;return Xt});ce.notifyObservers(ce.store,sn,{type:"validateFinish"}),ce.triggerOnFieldsChange(sn,Sr)});var Tr=fr.then(function(){return ce.lastValidatePromise===fr?Promise.resolve(ce.getFieldsValue(Mt)):Promise.reject([])}).catch(function(Sr){var sn=Sr.filter(function(lt){return lt&&lt.errors.length});return Promise.reject({values:ce.getFieldsValue(Mt),errorFields:sn,outOfDate:ce.lastValidatePromise!==fr})});return Tr.catch(function(Sr){return Sr}),Tr},this.submit=function(){ce.warningUnhooked(),ce.validateFields().then(function(He){var Pe=ce.callbacks.onFinish;if(Pe)try{Pe(He)}catch(Tt){console.error(Tt)}}).catch(function(He){var Pe=ce.callbacks.onFinishFailed;Pe&&Pe(He)})},this.forceRootUpdate=Me});function uu(De){var Me=D.useRef(),ce=D.useState({}),He=(0,zo.Z)(ce,2),Pe=He[1];if(!Me.current)if(De)Me.current=De;else{var Tt=function(){Pe({})},Mt=new $s(Tt);Me.current=Mt.getForm()}return[Me.current]}var Jo=uu,ms=D.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),eu=function(Me){var ce=Me.validateMessages,He=Me.onFormChange,Pe=Me.onFormFinish,Tt=Me.children,Mt=D.useContext(ms),$t=D.useRef({});return D.createElement(ms.Provider,{value:(0,F.Z)((0,F.Z)({},Mt),{},{validateMessages:(0,F.Z)((0,F.Z)({},Mt.validateMessages),ce),triggerFormChange:function(Tr,Sr){He&&He(Tr,{changedFields:Sr,forms:$t.current}),Mt.triggerFormChange(Tr,Sr)},triggerFormFinish:function(Tr,Sr){Pe&&Pe(Tr,{values:Sr,forms:$t.current}),Mt.triggerFormFinish(Tr,Sr)},registerForm:function(Tr,Sr){Tr&&($t.current=(0,F.Z)((0,F.Z)({},$t.current),{},(0,ae.Z)({},Tr,Sr))),Mt.registerForm(Tr,Sr)},unregisterForm:function(Tr){var Sr=(0,F.Z)({},$t.current);delete Sr[Tr],$t.current=Sr,Mt.unregisterForm(Tr)}})},Tt)},Bs=ms,fi=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"],is=function(Me,ce){var He=Me.name,Pe=Me.initialValues,Tt=Me.fields,Mt=Me.form,$t=Me.preserve,fr=Me.children,Tr=Me.component,Sr=Tr===void 0?"form":Tr,sn=Me.validateMessages,lt=Me.validateTrigger,Xt=lt===void 0?"onChange":lt,nr=Me.onValuesChange,ur=Me.onFieldsChange,Vr=Me.onFinish,ln=Me.onFinishFailed,Un=(0,m.Z)(Me,fi),Gn=D.useContext(Bs),qn=Jo(Mt),oi=(0,zo.Z)(qn,1),T=oi[0],H=T.getInternalHooks(We),_e=H.useSubscribe,ne=H.setInitialValues,$e=H.setCallbacks,xt=H.setValidateMessages,zt=H.setPreserve,_r=H.destroyForm;D.useImperativeHandle(ce,function(){return T}),D.useEffect(function(){return Gn.registerForm(He,T),function(){Gn.unregisterForm(He)}},[Gn,T,He]),xt((0,F.Z)((0,F.Z)({},Gn.validateMessages),sn)),$e({onValuesChange:nr,onFieldsChange:function(La){if(Gn.triggerFormChange(He,La),ur){for(var to=arguments.length,Ho=new Array(to>1?to-1:0),xo=1;xo<to;xo++)Ho[xo-1]=arguments[xo];ur.apply(void 0,[La].concat(Ho))}},onFinish:function(La){Gn.triggerFormFinish(He,La),Vr&&Vr(La)},onFinishFailed:ln}),zt($t);var xr=D.useRef(null);ne(Pe,!xr.current),xr.current||(xr.current=!0),D.useEffect(function(){return _r},[]);var dn,Bn=typeof fr=="function";if(Bn){var zi=T.getFieldsValue(!0);dn=fr(zi,T)}else dn=fr;_e(!Bn);var Vi=D.useRef();D.useEffect(function(){vi(Vi.current||[],Tt||[])||T.setFields(Tt||[]),Vi.current=Tt},[Tt,T]);var Ei=D.useMemo(function(){return(0,F.Z)((0,F.Z)({},T),{},{validateTrigger:Xt})},[T,Xt]),qa=D.createElement(Ke.Provider,{value:Ei},dn);return Sr===!1?qa:D.createElement(Sr,(0,k.Z)({},Un,{onSubmit:function(La){La.preventDefault(),La.stopPropagation(),T.submit()},onReset:function(La){var to;La.preventDefault(),T.resetFields(),(to=Un.onReset)===null||to===void 0||to.call(Un,La)}}),qa)},ku=is;function mt(De){try{return JSON.stringify(De)}catch(Me){return Math.random()}}var Gt=function(){};function Cr(){for(var De=arguments.length,Me=new Array(De),ce=0;ce<De;ce++)Me[ce]=arguments[ce];var He=Me[0],Pe=He===void 0?[]:He,Tt=Me[1],Mt=(0,D.useState)(),$t=(0,zo.Z)(Mt,2),fr=$t[0],Tr=$t[1],Sr=(0,D.useMemo)(function(){return mt(fr)},[fr]),sn=(0,D.useRef)(Sr);sn.current=Sr;var lt=(0,D.useContext)(Ke),Xt=Tt||lt,nr=Xt&&Xt._init,ur=tr(Pe),Vr=(0,D.useRef)(ur);return Vr.current=ur,Gt(ur),(0,D.useEffect)(function(){if(nr){var ln=Xt.getFieldsValue,Un=Xt.getInternalHooks,Gn=Un(We),qn=Gn.registerWatch,oi=qn(function(H){var _e=en(H,Vr.current),ne=mt(_e);sn.current!==ne&&(sn.current=ne,Tr(_e))}),T=en(ln(),Vr.current);return Tr(T),oi}},[nr]),fr}var Rr=Cr,ji=D.forwardRef(ku),Pa=ji;Pa.FormProvider=eu,Pa.Field=Ga,Pa.List=su,Pa.useForm=Jo,Pa.useWatch=Rr;var Yt=null},87787:function(Ne,fe,I){"use strict";I.d(fe,{Xo:function(){return St},Wx:function(){return At},ZP:function(){return Pa}});var D=I(87462),k=I(74902),m=I(4942),ae=I(1413),F=I(97685),K=I(91),W=I(71002),Y=I(21770),G=I(80334),$=I(67294),xe=I(94184),Fe=I.n(xe),Ce=I(8410),We=I(31131),me=I(15105),Ge=I(42550),Ke=$.createContext(null);function pt(){return $.useContext(Ke)}function Xe(){var Yt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,De=$.useState(!1),Me=(0,F.Z)(De,2),ce=Me[0],He=Me[1],Pe=$.useRef(null),Tt=function(){window.clearTimeout(Pe.current)};$.useEffect(function(){return Tt},[]);var Mt=function(fr,Tr){Tt(),Pe.current=window.setTimeout(function(){He(fr),Tr&&Tr()},Yt)};return[ce,Mt,Tt]}function gt(){var Yt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:250,De=$.useRef(null),Me=$.useRef(null);$.useEffect(function(){return function(){window.clearTimeout(Me.current)}},[]);function ce(He){(He||De.current===null)&&(De.current=He),window.clearTimeout(Me.current),Me.current=window.setTimeout(function(){De.current=null},Yt)}return[function(){return De.current},ce]}function ie(Yt,De,Me,ce){var He=$.useRef(null);He.current={open:De,triggerOpen:Me,customizedTrigger:ce},$.useEffect(function(){function Pe(Tt){var Mt;if(!((Mt=He.current)!==null&&Mt!==void 0&&Mt.customizedTrigger)){var $t=Tt.target;$t.shadowRoot&&Tt.composed&&($t=Tt.composedPath()[0]||$t),He.current.open&&Yt().filter(function(fr){return fr}).every(function(fr){return!fr.contains($t)&&fr!==$t})&&He.current.triggerOpen(!1)}}return window.addEventListener("mousedown",Pe),function(){return window.removeEventListener("mousedown",Pe)}},[])}var ft=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,ve=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,Ae="".concat(ft," ").concat(ve).split(/[\s\n]+/),Re="aria-",Ye="data-";function at(Yt,De){return Yt.indexOf(De)===0}function ht(Yt){var De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Me;De===!1?Me={aria:!0,data:!0,attr:!0}:De===!0?Me={aria:!0}:Me=(0,ae.Z)({},De);var ce={};return Object.keys(Yt).forEach(function(He){(Me.aria&&(He==="role"||at(He,Re))||Me.data&&at(He,Ye)||Me.attr&&Ae.includes(He))&&(ce[He]=Yt[He])}),ce}var Se=I(34243),Qe=function(De){var Me=De.className,ce=De.customizeIcon,He=De.customizeIconProps,Pe=De.onMouseDown,Tt=De.onClick,Mt=De.children,$t;return typeof ce=="function"?$t=ce(He):$t=ce,$.createElement("span",{className:Me,onMouseDown:function(Tr){Tr.preventDefault(),Pe&&Pe(Tr)},style:{userSelect:"none",WebkitUserSelect:"none"},unselectable:"on",onClick:Tt,"aria-hidden":!0},$t!==void 0?$t:$.createElement("span",{className:Fe()(Me.split(/\s+/).map(function(fr){return"".concat(fr,"-icon")}))},Mt))},oe=Qe,ue=function(De,Me){var ce,He,Pe=De.prefixCls,Tt=De.id,Mt=De.inputElement,$t=De.disabled,fr=De.tabIndex,Tr=De.autoFocus,Sr=De.autoComplete,sn=De.editable,lt=De.activeDescendantId,Xt=De.value,nr=De.maxLength,ur=De.onKeyDown,Vr=De.onMouseDown,ln=De.onChange,Un=De.onPaste,Gn=De.onCompositionStart,qn=De.onCompositionEnd,oi=De.open,T=De.attrs,H=Mt||$.createElement("input",null),_e=H,ne=_e.ref,$e=_e.props,xt=$e.onKeyDown,zt=$e.onChange,_r=$e.onMouseDown,xr=$e.onCompositionStart,dn=$e.onCompositionEnd,Bn=$e.style;return(0,G.Kp)(!("maxLength"in H.props),"Passing 'maxLength' to input element directly may not work because input in BaseSelect is controlled."),H=$.cloneElement(H,(0,ae.Z)((0,ae.Z)((0,ae.Z)({type:"search"},$e),{},{id:Tt,ref:(0,Ge.sQ)(Me,ne),disabled:$t,tabIndex:fr,autoComplete:Sr||"off",autoFocus:Tr,className:Fe()("".concat(Pe,"-selection-search-input"),(ce=H)===null||ce===void 0||(He=ce.props)===null||He===void 0?void 0:He.className),role:"combobox","aria-expanded":oi,"aria-haspopup":"listbox","aria-owns":"".concat(Tt,"_list"),"aria-autocomplete":"list","aria-controls":"".concat(Tt,"_list"),"aria-activedescendant":lt},T),{},{value:sn?Xt:"",maxLength:nr,readOnly:!sn,unselectable:sn?null:"on",style:(0,ae.Z)((0,ae.Z)({},Bn),{},{opacity:sn?null:0}),onKeyDown:function(Vi){ur(Vi),xt&&xt(Vi)},onMouseDown:function(Vi){Vr(Vi),_r&&_r(Vi)},onChange:function(Vi){ln(Vi),zt&&zt(Vi)},onCompositionStart:function(Vi){Gn(Vi),xr&&xr(Vi)},onCompositionEnd:function(Vi){qn(Vi),dn&&dn(Vi)},onPaste:Un})),H},be=$.forwardRef(ue);be.displayName="Input";var vt=be;function bt(Yt){return Array.isArray(Yt)?Yt:Yt!==void 0?[Yt]:[]}var Ht=typeof window!="undefined"&&window.document&&window.document.documentElement,Er=Ht;function Vt(Yt){return Yt!=null}function on(Yt){return["string","number"].includes((0,W.Z)(Yt))}function hn(Yt){var De=void 0;return Yt&&(on(Yt.title)?De=Yt.title.toString():on(Yt.label)&&(De=Yt.label.toString())),De}function gi(Yt,De){Er?$.useLayoutEffect(Yt,De):$.useEffect(Yt,De)}function Hn(Yt){var De;return(De=Yt.key)!==null&&De!==void 0?De:Yt.value}var Dt=function(De){De.preventDefault(),De.stopPropagation()},Ea=function(De){var Me=De.id,ce=De.prefixCls,He=De.values,Pe=De.open,Tt=De.searchValue,Mt=De.autoClearSearchValue,$t=De.inputRef,fr=De.placeholder,Tr=De.disabled,Sr=De.mode,sn=De.showSearch,lt=De.autoFocus,Xt=De.autoComplete,nr=De.activeDescendantId,ur=De.tabIndex,Vr=De.removeIcon,ln=De.maxTagCount,Un=De.maxTagTextLength,Gn=De.maxTagPlaceholder,qn=Gn===void 0?function(ps){return"+ ".concat(ps.length," ...")}:Gn,oi=De.tagRender,T=De.onToggleOpen,H=De.onRemove,_e=De.onInputChange,ne=De.onInputPaste,$e=De.onInputKeyDown,xt=De.onInputMouseDown,zt=De.onInputCompositionStart,_r=De.onInputCompositionEnd,xr=$.useRef(null),dn=(0,$.useState)(0),Bn=(0,F.Z)(dn,2),zi=Bn[0],Vi=Bn[1],Ei=(0,$.useState)(!1),qa=(0,F.Z)(Ei,2),$a=qa[0],La=qa[1],to="".concat(ce,"-selection"),Ho=Pe||Sr==="multiple"&&Mt===!1||Sr==="tags"?Tt:"",xo=Sr==="tags"||Sr==="multiple"&&Mt===!1||sn&&(Pe||$a);gi(function(){Vi(xr.current.scrollWidth)},[Ho]);function bo(ps,Go,zu,al,ou){return $.createElement("span",{className:Fe()("".concat(to,"-item"),(0,m.Z)({},"".concat(to,"-item-disabled"),zu)),title:hn(ps)},$.createElement("span",{className:"".concat(to,"-item-content")},Go),al&&$.createElement(oe,{className:"".concat(to,"-item-remove"),onMouseDown:Dt,onClick:ou,customizeIcon:Vr},"\xD7"))}function so(ps,Go,zu,al,ou){var Xu=function(ks){Dt(ks),T(!Pe)};return $.createElement("span",{onMouseDown:Xu},oi({label:Go,value:ps,disabled:zu,closable:al,onClose:ou}))}function Cs(ps){var Go=ps.disabled,zu=ps.label,al=ps.value,ou=!Tr&&!Go,Xu=zu;if(typeof Un=="number"&&(typeof zu=="string"||typeof zu=="number")){var Nu=String(Xu);Nu.length>Un&&(Xu="".concat(Nu.slice(0,Un),"..."))}var ks=function(vl){vl&&vl.stopPropagation(),H(ps)};return typeof oi=="function"?so(al,Xu,Go,ou,ks):bo(ps,Xu,Go,ou,ks)}function Ls(ps){var Go=typeof qn=="function"?qn(ps):qn;return bo({title:Go},Go,!1)}var Rs=$.createElement("div",{className:"".concat(to,"-search"),style:{width:zi},onFocus:function(){La(!0)},onBlur:function(){La(!1)}},$.createElement(vt,{ref:$t,open:Pe,prefixCls:ce,id:Me,inputElement:null,disabled:Tr,autoFocus:lt,autoComplete:Xt,editable:xo,activeDescendantId:nr,value:Ho,onKeyDown:$e,onMouseDown:xt,onChange:_e,onPaste:ne,onCompositionStart:zt,onCompositionEnd:_r,tabIndex:ur,attrs:ht(De,!0)}),$.createElement("span",{ref:xr,className:"".concat(to,"-search-mirror"),"aria-hidden":!0},Ho,"\xA0")),lu=$.createElement(Se.Z,{prefixCls:"".concat(to,"-overflow"),data:He,renderItem:Cs,renderRest:Ls,suffix:Rs,itemKey:Hn,maxCount:ln});return $.createElement($.Fragment,null,lu,!He.length&&!Ho&&$.createElement("span",{className:"".concat(to,"-placeholder")},fr))},Ze=Ea,ci=function(De){var Me=De.inputElement,ce=De.prefixCls,He=De.id,Pe=De.inputRef,Tt=De.disabled,Mt=De.autoFocus,$t=De.autoComplete,fr=De.activeDescendantId,Tr=De.mode,Sr=De.open,sn=De.values,lt=De.placeholder,Xt=De.tabIndex,nr=De.showSearch,ur=De.searchValue,Vr=De.activeValue,ln=De.maxLength,Un=De.onInputKeyDown,Gn=De.onInputMouseDown,qn=De.onInputChange,oi=De.onInputPaste,T=De.onInputCompositionStart,H=De.onInputCompositionEnd,_e=$.useState(!1),ne=(0,F.Z)(_e,2),$e=ne[0],xt=ne[1],zt=Tr==="combobox",_r=zt||nr,xr=sn[0],dn=ur||"";zt&&Vr&&!$e&&(dn=Vr),$.useEffect(function(){zt&&xt(!1)},[zt,Vr]);var Bn=Tr!=="combobox"&&!Sr&&!nr?!1:!!dn,zi=hn(xr),Vi=function(){if(xr)return null;var qa=Bn?{visibility:"hidden"}:void 0;return $.createElement("span",{className:"".concat(ce,"-selection-placeholder"),style:qa},lt)};return $.createElement($.Fragment,null,$.createElement("span",{className:"".concat(ce,"-selection-search")},$.createElement(vt,{ref:Pe,prefixCls:ce,id:He,open:Sr,inputElement:Me,disabled:Tt,autoFocus:Mt,autoComplete:$t,editable:_r,activeDescendantId:fr,value:dn,onKeyDown:Un,onMouseDown:Gn,onChange:function(qa){xt(!0),qn(qa)},onPaste:oi,onCompositionStart:T,onCompositionEnd:H,tabIndex:Xt,attrs:ht(De,!0),maxLength:zt?ln:void 0})),!zt&&xr&&!Bn&&$.createElement("span",{className:"".concat(ce,"-selection-item"),title:zi},xr.label),Vi())},Ci=ci;function Oi(Yt){return![me.Z.ESC,me.Z.SHIFT,me.Z.BACKSPACE,me.Z.TAB,me.Z.WIN_KEY,me.Z.ALT,me.Z.META,me.Z.WIN_KEY_RIGHT,me.Z.CTRL,me.Z.SEMICOLON,me.Z.EQUALS,me.Z.CAPS_LOCK,me.Z.CONTEXT_MENU,me.Z.F1,me.Z.F2,me.Z.F3,me.Z.F4,me.Z.F5,me.Z.F6,me.Z.F7,me.Z.F8,me.Z.F9,me.Z.F10,me.Z.F11,me.Z.F12].includes(Yt)}var ea=function(De,Me){var ce=(0,$.useRef)(null),He=(0,$.useRef)(!1),Pe=De.prefixCls,Tt=De.open,Mt=De.mode,$t=De.showSearch,fr=De.tokenWithEnter,Tr=De.autoClearSearchValue,Sr=De.onSearch,sn=De.onSearchSubmit,lt=De.onToggleOpen,Xt=De.onInputKeyDown,nr=De.domRef;$.useImperativeHandle(Me,function(){return{focus:function(){ce.current.focus()},blur:function(){ce.current.blur()}}});var ur=gt(0),Vr=(0,F.Z)(ur,2),ln=Vr[0],Un=Vr[1],Gn=function(Bn){var zi=Bn.which;(zi===me.Z.UP||zi===me.Z.DOWN)&&Bn.preventDefault(),Xt&&Xt(Bn),zi===me.Z.ENTER&&Mt==="tags"&&!He.current&&!Tt&&(sn==null||sn(Bn.target.value)),Oi(zi)&&lt(!0)},qn=function(){Un(!0)},oi=(0,$.useRef)(null),T=function(Bn){Sr(Bn,!0,He.current)!==!1&&lt(!0)},H=function(){He.current=!0},_e=function(Bn){He.current=!1,Mt!=="combobox"&&T(Bn.target.value)},ne=function(Bn){var zi=Bn.target.value;if(fr&&oi.current&&/[\r\n]/.test(oi.current)){var Vi=oi.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");zi=zi.replace(Vi,oi.current)}oi.current=null,T(zi)},$e=function(Bn){var zi=Bn.clipboardData,Vi=zi.getData("text");oi.current=Vi},xt=function(Bn){var zi=Bn.target;if(zi!==ce.current){var Vi=document.body.style.msTouchAction!==void 0;Vi?setTimeout(function(){ce.current.focus()}):ce.current.focus()}},zt=function(Bn){var zi=ln();Bn.target!==ce.current&&!zi&&Mt!=="combobox"&&Bn.preventDefault(),(Mt!=="combobox"&&(!$t||!zi)||!Tt)&&(Tt&&Tr!==!1&&Sr("",!0,!1),lt())},_r={inputRef:ce,onInputKeyDown:Gn,onInputMouseDown:qn,onInputChange:ne,onInputPaste:$e,onInputCompositionStart:H,onInputCompositionEnd:_e},xr=Mt==="multiple"||Mt==="tags"?$.createElement(Ze,(0,D.Z)({},De,_r)):$.createElement(Ci,(0,D.Z)({},De,_r));return $.createElement("div",{ref:nr,className:"".concat(Pe,"-selector"),onClick:xt,onMouseDown:zt},xr)},fn=$.forwardRef(ea);fn.displayName="Selector";var tn=fn,da=I(11276),Ii=["prefixCls","disabled","visible","children","popupElement","containerWidth","animation","transitionName","dropdownStyle","dropdownClassName","direction","placement","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","getPopupContainer","empty","getTriggerDOMNode","onPopupVisibleChange","onPopupMouseEnter"],Ai=function(De){var Me=De===!0?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:Me,adjustY:1}},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:Me,adjustY:1}},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:Me,adjustY:1}},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:Me,adjustY:1}}}},Pr=function(De,Me){var ce=De.prefixCls,He=De.disabled,Pe=De.visible,Tt=De.children,Mt=De.popupElement,$t=De.containerWidth,fr=De.animation,Tr=De.transitionName,Sr=De.dropdownStyle,sn=De.dropdownClassName,lt=De.direction,Xt=lt===void 0?"ltr":lt,nr=De.placement,ur=De.dropdownMatchSelectWidth,Vr=De.dropdownRender,ln=De.dropdownAlign,Un=De.getPopupContainer,Gn=De.empty,qn=De.getTriggerDOMNode,oi=De.onPopupVisibleChange,T=De.onPopupMouseEnter,H=(0,K.Z)(De,Ii),_e="".concat(ce,"-dropdown"),ne=Mt;Vr&&(ne=Vr(Mt));var $e=$.useMemo(function(){return Ai(ur)},[ur]),xt=fr?"".concat(_e,"-").concat(fr):Tr,zt=$.useRef(null);$.useImperativeHandle(Me,function(){return{getPopupElement:function(){return zt.current}}});var _r=(0,ae.Z)({minWidth:$t},Sr);return typeof ur=="number"?_r.width=ur:ur&&(_r.width=$t),$.createElement(da.Z,(0,D.Z)({},H,{showAction:oi?["click"]:[],hideAction:oi?["click"]:[],popupPlacement:nr||(Xt==="rtl"?"bottomRight":"bottomLeft"),builtinPlacements:$e,prefixCls:_e,popupTransitionName:xt,popup:$.createElement("div",{ref:zt,onMouseEnter:T},ne),popupAlign:ln,popupVisible:Pe,getPopupContainer:Un,popupClassName:Fe()(sn,(0,m.Z)({},"".concat(_e,"-empty"),Gn)),popupStyle:_r,getTriggerDOMNode:qn,onPopupVisibleChange:oi}),Tt)},nt=$.forwardRef(Pr);nt.displayName="SelectTrigger";var it=nt,_t=I(84506);function we(Yt,De){var Me=Yt.key,ce;return"value"in Yt&&(ce=Yt.value),Me!=null?Me:ce!==void 0?ce:"rc-index-key-".concat(De)}function er(Yt,De){var Me=Yt||{},ce=Me.label,He=Me.value,Pe=Me.options;return{label:ce||(De?"children":"label"),value:He||"value",options:Pe||"options"}}function $r(Yt){var De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Me=De.fieldNames,ce=De.childrenAsData,He=[],Pe=er(Me,!1),Tt=Pe.label,Mt=Pe.value,$t=Pe.options;function fr(Tr,Sr){Tr.forEach(function(sn){var lt=sn[Tt];if(Sr||!($t in sn)){var Xt=sn[Mt];He.push({key:we(sn,He.length),groupOption:Sr,data:sn,label:lt,value:Xt})}else{var nr=lt;nr===void 0&&ce&&(nr=sn.label),He.push({key:we(sn,He.length),group:!0,data:sn,label:nr}),fr(sn[$t],!0)}})}return fr(Yt,!1),He}function Fn(Yt){var De=(0,ae.Z)({},Yt);return"props"in De||Object.defineProperty(De,"props",{get:function(){return(0,G.ZP)(!1,"Return type is option instead of Option instance. Please read value directly instead of reading from `props`."),De}}),De}function Qt(Yt,De){if(!De||!De.length)return null;var Me=!1;function ce(Pe,Tt){var Mt=(0,_t.Z)(Tt),$t=Mt[0],fr=Mt.slice(1);if(!$t)return[Pe];var Tr=Pe.split($t);return Me=Me||Tr.length>1,Tr.reduce(function(Sr,sn){return[].concat((0,k.Z)(Sr),(0,k.Z)(ce(sn,fr)))},[]).filter(function(Sr){return Sr})}var He=ce(Yt,De);return Me?He:null}var Br=["id","prefixCls","className","showSearch","tagRender","direction","omitDomProps","displayValues","onDisplayValuesChange","emptyOptions","notFoundContent","onClear","mode","disabled","loading","getInputElement","getRawInputElement","open","defaultOpen","onDropdownVisibleChange","activeValue","onActiveValueChange","activeDescendantId","searchValue","autoClearSearchValue","onSearch","onSearchSplit","tokenSeparators","allowClear","showArrow","inputIcon","clearIcon","OptionList","animation","transitionName","dropdownStyle","dropdownClassName","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","placement","getPopupContainer","showAction","onFocus","onBlur","onKeyUp","onKeyDown","onMouseDown"],bn=["value","onChange","removeIcon","placeholder","autoFocus","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabIndex"];function gr(Yt){return Yt==="tags"||Yt==="multiple"}var pn=$.forwardRef(function(Yt,De){var Me,ce,He=Yt.id,Pe=Yt.prefixCls,Tt=Yt.className,Mt=Yt.showSearch,$t=Yt.tagRender,fr=Yt.direction,Tr=Yt.omitDomProps,Sr=Yt.displayValues,sn=Yt.onDisplayValuesChange,lt=Yt.emptyOptions,Xt=Yt.notFoundContent,nr=Xt===void 0?"Not Found":Xt,ur=Yt.onClear,Vr=Yt.mode,ln=Yt.disabled,Un=Yt.loading,Gn=Yt.getInputElement,qn=Yt.getRawInputElement,oi=Yt.open,T=Yt.defaultOpen,H=Yt.onDropdownVisibleChange,_e=Yt.activeValue,ne=Yt.onActiveValueChange,$e=Yt.activeDescendantId,xt=Yt.searchValue,zt=Yt.autoClearSearchValue,_r=Yt.onSearch,xr=Yt.onSearchSplit,dn=Yt.tokenSeparators,Bn=Yt.allowClear,zi=Yt.showArrow,Vi=Yt.inputIcon,Ei=Yt.clearIcon,qa=Yt.OptionList,$a=Yt.animation,La=Yt.transitionName,to=Yt.dropdownStyle,Ho=Yt.dropdownClassName,xo=Yt.dropdownMatchSelectWidth,bo=Yt.dropdownRender,so=Yt.dropdownAlign,Cs=Yt.placement,Ls=Yt.getPopupContainer,Rs=Yt.showAction,lu=Rs===void 0?[]:Rs,ps=Yt.onFocus,Go=Yt.onBlur,zu=Yt.onKeyUp,al=Yt.onKeyDown,ou=Yt.onMouseDown,Xu=(0,K.Z)(Yt,Br),Nu=gr(Vr),ks=(Mt!==void 0?Mt:Nu)||Vr==="combobox",Sc=(0,ae.Z)({},Xu);bn.forEach(function(os){delete Sc[os]}),Tr==null||Tr.forEach(function(os){delete Sc[os]});var vl=$.useState(!1),es=(0,F.Z)(vl,2),Al=es[0],tf=es[1];$.useEffect(function(){tf((0,We.Z)())},[]);var Zl=$.useRef(null),uc=$.useRef(null),pf=$.useRef(null),ql=$.useRef(null),Cu=$.useRef(null),rf=Xe(),ol=(0,F.Z)(rf,3),as=ol[0],Ds=ol[1],Tl=ol[2];$.useImperativeHandle(De,function(){var os,yo;return{focus:(os=ql.current)===null||os===void 0?void 0:os.focus,blur:(yo=ql.current)===null||yo===void 0?void 0:yo.blur,scrollTo:function(Ul){var Xi;return(Xi=Cu.current)===null||Xi===void 0?void 0:Xi.scrollTo(Ul)}}});var Yu=$.useMemo(function(){var os;if(Vr!=="combobox")return xt;var yo=(os=Sr[0])===null||os===void 0?void 0:os.value;return typeof yo=="string"||typeof yo=="number"?String(yo):""},[xt,Vr,Sr]),Ml=Vr==="combobox"&&typeof Gn=="function"&&Gn()||null,xl=typeof qn=="function"&&qn(),nf=(0,Ge.x1)(uc,xl==null||(Me=xl.props)===null||Me===void 0?void 0:Me.ref),Vc=(0,Y.Z)(void 0,{defaultValue:T,value:oi}),Zf=(0,F.Z)(Vc,2),Hc=Zf[0],Ql=Zf[1],sl=Hc,vc=!nr&&lt;(ln||vc&&sl&&Vr==="combobox")&&(sl=!1);var Jl=vc?!1:sl,ts=$.useCallback(function(os){var yo=os!==void 0?os:!sl;ln||(Ql(yo),sl!==yo&&(H==null||H(yo)))},[ln,sl,Ql,H]),gs=$.useMemo(function(){return(dn||[]).some(function(os){return[`
`,`\r
`].includes(os)})},[dn]),$o=function(yo,As,Ul){var Xi=!0,cc=yo;ne==null||ne(null);var Dc=Ul?null:Qt(yo,dn);return Vr!=="combobox"&&Dc&&(cc="",xr==null||xr(Dc),ts(!1),Xi=!1),_r&&Yu!==cc&&_r(cc,{source:As?"typing":"effect"}),Xi},ds=function(yo){!yo||!yo.trim()||_r(yo,{source:"submit"})};$.useEffect(function(){!sl&&!Nu&&Vr!=="combobox"&&$o("",!1,!1)},[sl]),$.useEffect(function(){Hc&&ln&&Ql(!1),ln&&Ds(!1)},[ln]);var Ns=gt(),Mu=(0,F.Z)(Ns,2),ec=Mu[0],zs=Mu[1],df=function(yo){var As=ec(),Ul=yo.which;if(Ul===me.Z.ENTER&&(Vr!=="combobox"&&yo.preventDefault(),sl||ts(!0)),zs(!!Yu),Ul===me.Z.BACKSPACE&&!As&&Nu&&!Yu&&Sr.length){for(var Xi=(0,k.Z)(Sr),cc=null,Dc=Xi.length-1;Dc>=0;Dc-=1){var af=Xi[Dc];if(!af.disabled){Xi.splice(Dc,1),cc=af;break}}cc&&sn(Xi,{type:"remove",values:[cc]})}for(var Ws=arguments.length,kl=new Array(Ws>1?Ws-1:0),Cc=1;Cc<Ws;Cc++)kl[Cc-1]=arguments[Cc];if(sl&&Cu.current){var fc;(fc=Cu.current).onKeyDown.apply(fc,[yo].concat(kl))}al==null||al.apply(void 0,[yo].concat(kl))},ha=function(yo){for(var As=arguments.length,Ul=new Array(As>1?As-1:0),Xi=1;Xi<As;Xi++)Ul[Xi-1]=arguments[Xi];if(sl&&Cu.current){var cc;(cc=Cu.current).onKeyUp.apply(cc,[yo].concat(Ul))}zu==null||zu.apply(void 0,[yo].concat(Ul))},Gc=function(yo){var As=Sr.filter(function(Ul){return Ul!==yo});sn(As,{type:"remove",values:[yo]})},kc=$.useRef(!1),un=function(){Ds(!0),ln||(ps&&!kc.current&&ps.apply(void 0,arguments),lu.includes("focus")&&ts(!0)),kc.current=!0},Mi=function(){Ds(!1,function(){kc.current=!1,ts(!1)}),!ln&&(Yu&&(Vr==="tags"?_r(Yu,{source:"submit"}):Vr==="multiple"&&_r("",{source:"blur"})),Go&&Go.apply(void 0,arguments))},ei=[];$.useEffect(function(){return function(){ei.forEach(function(os){return clearTimeout(os)}),ei.splice(0,ei.length)}},[]);var za=function(yo){var As,Ul=yo.target,Xi=(As=pf.current)===null||As===void 0?void 0:As.getPopupElement();if(Xi&&Xi.contains(Ul)){var cc=setTimeout(function(){var kl=ei.indexOf(cc);if(kl!==-1&&ei.splice(kl,1),Tl(),!Al&&!Xi.contains(document.activeElement)){var Cc;(Cc=ql.current)===null||Cc===void 0||Cc.focus()}});ei.push(cc)}for(var Dc=arguments.length,af=new Array(Dc>1?Dc-1:0),Ws=1;Ws<Dc;Ws++)af[Ws-1]=arguments[Ws];ou==null||ou.apply(void 0,[yo].concat(af))},Za=$.useState(null),Oo=(0,F.Z)(Za,2),mu=Oo[0],Au=Oo[1],Rl=$.useState({}),xh=(0,F.Z)(Rl,2),vf=xh[1];function Wh(){vf({})}(0,Ce.Z)(function(){if(Jl){var os,yo=Math.ceil((os=Zl.current)===null||os===void 0?void 0:os.offsetWidth);mu!==yo&&!Number.isNaN(yo)&&Au(yo)}},[Jl]);var oh;xl&&(oh=function(yo){ts(yo)}),ie(function(){var os;return[Zl.current,(os=pf.current)===null||os===void 0?void 0:os.getPopupElement()]},Jl,ts,!!xl);var mc=$.useMemo(function(){return(0,ae.Z)((0,ae.Z)({},Yt),{},{notFoundContent:nr,open:sl,triggerOpen:Jl,id:He,showSearch:ks,multiple:Nu,toggleOpen:ts})},[Yt,nr,Jl,sl,He,ks,Nu,ts]),lc=zi!==void 0?zi:Un||!Nu&&Vr!=="combobox",Ku;lc&&(Ku=$.createElement(oe,{className:Fe()("".concat(Pe,"-arrow"),(0,m.Z)({},"".concat(Pe,"-arrow-loading"),Un)),customizeIcon:Vi,customizeIconProps:{loading:Un,searchValue:Yu,open:sl,focused:as,showSearch:ks}}));var xs,sh=function(){var yo;ur==null||ur(),(yo=ql.current)===null||yo===void 0||yo.focus(),sn([],{type:"clear",values:Sr}),$o("",!1,!1)};!ln&&Bn&&(Sr.length||Yu)&&!(Vr==="combobox"&&Yu==="")&&(xs=$.createElement(oe,{className:"".concat(Pe,"-clear"),onMouseDown:sh,customizeIcon:Ei},"\xD7"));var bl=$.createElement(qa,{ref:Cu}),Ca=Fe()(Pe,Tt,(ce={},(0,m.Z)(ce,"".concat(Pe,"-focused"),as),(0,m.Z)(ce,"".concat(Pe,"-multiple"),Nu),(0,m.Z)(ce,"".concat(Pe,"-single"),!Nu),(0,m.Z)(ce,"".concat(Pe,"-allow-clear"),Bn),(0,m.Z)(ce,"".concat(Pe,"-show-arrow"),lc),(0,m.Z)(ce,"".concat(Pe,"-disabled"),ln),(0,m.Z)(ce,"".concat(Pe,"-loading"),Un),(0,m.Z)(ce,"".concat(Pe,"-open"),sl),(0,m.Z)(ce,"".concat(Pe,"-customize-input"),Ml),(0,m.Z)(ce,"".concat(Pe,"-show-search"),ks),ce)),Zu=$.createElement(it,{ref:pf,disabled:ln,prefixCls:Pe,visible:Jl,popupElement:bl,containerWidth:mu,animation:$a,transitionName:La,dropdownStyle:to,dropdownClassName:Ho,direction:fr,dropdownMatchSelectWidth:xo,dropdownRender:bo,dropdownAlign:so,placement:Cs,getPopupContainer:Ls,empty:lt,getTriggerDOMNode:function(){return uc.current},onPopupVisibleChange:oh,onPopupMouseEnter:Wh},xl?$.cloneElement(xl,{ref:nf}):$.createElement(tn,(0,D.Z)({},Yt,{domRef:uc,prefixCls:Pe,inputElement:Ml,ref:ql,id:He,showSearch:ks,autoClearSearchValue:zt,mode:Vr,activeDescendantId:$e,tagRender:$t,values:Sr,open:sl,onToggleOpen:ts,activeValue:_e,searchValue:Yu,onSearch:$o,onSearchSubmit:ds,onRemove:Gc,tokenWithEnter:gs}))),$c;return xl?$c=Zu:$c=$.createElement("div",(0,D.Z)({className:Ca},Sc,{ref:Zl,onMouseDown:za,onKeyDown:df,onKeyUp:ha,onFocus:un,onBlur:Mi}),as&&!sl&&$.createElement("span",{style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0},"aria-live":"polite"},"".concat(Sr.map(function(os){var yo=os.label,As=os.value;return["number","string"].includes((0,W.Z)(yo))?yo:As}).join(", "))),Zu,Ku,xs),$.createElement(Ke.Provider,{value:mc},$c)}),Sn=pn,Dn=function(Yt,De){var Me=$.useRef({values:new Map,options:new Map}),ce=$.useMemo(function(){var Pe=Me.current,Tt=Pe.values,Mt=Pe.options,$t=Yt.map(function(Sr){if(Sr.label===void 0){var sn;return(0,ae.Z)((0,ae.Z)({},Sr),{},{label:(sn=Tt.get(Sr.value))===null||sn===void 0?void 0:sn.label})}return Sr}),fr=new Map,Tr=new Map;return $t.forEach(function(Sr){fr.set(Sr.value,Sr),Tr.set(Sr.value,De.get(Sr.value)||Mt.get(Sr.value))}),Me.current.values=fr,Me.current.options=Tr,$t},[Yt,De]),He=$.useCallback(function(Pe){return De.get(Pe)||Me.current.options.get(Pe)},[De]);return[ce,He]};function ui(Yt,De){return bt(Yt).join("").toUpperCase().includes(De)}var di=function(Yt,De,Me,ce,He){return $.useMemo(function(){if(!Me||ce===!1)return Yt;var Pe=De.options,Tt=De.label,Mt=De.value,$t=[],fr=typeof ce=="function",Tr=Me.toUpperCase(),Sr=fr?ce:function(lt,Xt){return He?ui(Xt[He],Tr):Xt[Pe]?ui(Xt[Tt!=="children"?Tt:"label"],Tr):ui(Xt[Mt],Tr)},sn=fr?function(lt){return Fn(lt)}:function(lt){return lt};return Yt.forEach(function(lt){if(lt[Pe]){var Xt=Sr(Me,sn(lt));if(Xt)$t.push(lt);else{var nr=lt[Pe].filter(function(ur){return Sr(Me,sn(ur))});nr.length&&$t.push((0,ae.Z)((0,ae.Z)({},lt),{},(0,m.Z)({},Pe,nr)))}return}Sr(Me,sn(lt))&&$t.push(lt)}),$t},[Yt,ce,He,Me,De])},ca=I(98924),Ni=0,Wa=(0,ca.Z)();function Ba(){var Yt;return Wa?(Yt=Ni,Ni+=1):Yt="TEST_OR_SSR",Yt}function Ia(Yt){var De=$.useState(),Me=(0,F.Z)(De,2),ce=Me[0],He=Me[1];return $.useEffect(function(){He("rc_select_".concat(Ba()))},[]),Yt||ce}var an=I(50344),Ln=["children","value"],re=["children"];function he(Yt){var De=Yt,Me=De.key,ce=De.props,He=ce.children,Pe=ce.value,Tt=(0,K.Z)(ce,Ln);return(0,ae.Z)({key:Me,value:Pe!==void 0?Pe:Me,children:He},Tt)}function V(Yt){var De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(0,an.Z)(Yt).map(function(Me,ce){if(!$.isValidElement(Me)||!Me.type)return null;var He=Me,Pe=He.type.isSelectOptGroup,Tt=He.key,Mt=He.props,$t=Mt.children,fr=(0,K.Z)(Mt,re);return De||!Pe?he(Me):(0,ae.Z)((0,ae.Z)({key:"__RC_SELECT_GRP__".concat(Tt===null?ce:Tt,"__"),label:Tt},fr),{},{options:V($t)})}).filter(function(Me){return Me})}function Et(Yt,De,Me,ce,He){return $.useMemo(function(){var Pe=Yt,Tt=!Yt;Tt&&(Pe=V(De));var Mt=new Map,$t=new Map,fr=function(sn,lt,Xt){Xt&&typeof Xt=="string"&&sn.set(lt[Xt],lt)};function Tr(Sr){for(var sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,lt=0;lt<Sr.length;lt+=1){var Xt=Sr[lt];!Xt[Me.options]||sn?(Mt.set(Xt[Me.value],Xt),fr($t,Xt,Me.label),fr($t,Xt,ce),fr($t,Xt,He)):Tr(Xt[Me.options],!0)}}return Tr(Pe),{options:Pe,valueOptions:Mt,labelOptions:$t}},[Yt,De,Me,ce,He])}function Bt(Yt){var De=$.useRef();De.current=Yt;var Me=$.useCallback(function(){return De.current.apply(De,arguments)},[]);return Me}var Le=function(){return null};Le.isSelectOptGroup=!0;var St=Le,tt=function(){return null};tt.isSelectOption=!0;var At=tt,tr=I(56982),en=I(98423),Kr=I(48555),Ft=$.forwardRef(function(Yt,De){var Me=Yt.height,ce=Yt.offset,He=Yt.children,Pe=Yt.prefixCls,Tt=Yt.onInnerResize,Mt=Yt.innerProps,$t={},fr={display:"flex",flexDirection:"column"};return ce!==void 0&&($t={height:Me,position:"relative",overflow:"hidden"},fr=(0,ae.Z)((0,ae.Z)({},fr),{},{transform:"translateY(".concat(ce,"px)"),position:"absolute",left:0,right:0,top:0})),$.createElement("div",{style:$t},$.createElement(Kr.Z,{onResize:function(Sr){var sn=Sr.offsetHeight;sn&&Tt&&Tt()}},$.createElement("div",(0,D.Z)({style:fr,className:Fe()((0,m.Z)({},"".concat(Pe,"-holder-inner"),Pe)),ref:De},Mt),He)))});Ft.displayName="Filler";var rr=Ft,ot=I(15671),Li=I(43144),Hr=I(60136),_i=I(29388),vi=I(75164),It=20;function Yr(Yt){return"touches"in Yt?Yt.touches[0].pageY:Yt.pageY}var Dr=function(Yt){(0,Hr.Z)(Me,Yt);var De=(0,_i.Z)(Me);function Me(){var ce;(0,ot.Z)(this,Me);for(var He=arguments.length,Pe=new Array(He),Tt=0;Tt<He;Tt++)Pe[Tt]=arguments[Tt];return ce=De.call.apply(De,[this].concat(Pe)),ce.moveRaf=null,ce.scrollbarRef=$.createRef(),ce.thumbRef=$.createRef(),ce.visibleTimeout=null,ce.state={dragging:!1,pageY:null,startTop:null,visible:!1},ce.delayHidden=function(){clearTimeout(ce.visibleTimeout),ce.setState({visible:!0}),ce.visibleTimeout=setTimeout(function(){ce.setState({visible:!1})},2e3)},ce.onScrollbarTouchStart=function(Mt){Mt.preventDefault()},ce.onContainerMouseDown=function(Mt){Mt.stopPropagation(),Mt.preventDefault()},ce.patchEvents=function(){window.addEventListener("mousemove",ce.onMouseMove),window.addEventListener("mouseup",ce.onMouseUp),ce.thumbRef.current.addEventListener("touchmove",ce.onMouseMove),ce.thumbRef.current.addEventListener("touchend",ce.onMouseUp)},ce.removeEvents=function(){var Mt;window.removeEventListener("mousemove",ce.onMouseMove),window.removeEventListener("mouseup",ce.onMouseUp),(Mt=ce.scrollbarRef.current)===null||Mt===void 0||Mt.removeEventListener("touchstart",ce.onScrollbarTouchStart),ce.thumbRef.current&&(ce.thumbRef.current.removeEventListener("touchstart",ce.onMouseDown),ce.thumbRef.current.removeEventListener("touchmove",ce.onMouseMove),ce.thumbRef.current.removeEventListener("touchend",ce.onMouseUp)),vi.Z.cancel(ce.moveRaf)},ce.onMouseDown=function(Mt){var $t=ce.props.onStartMove;ce.setState({dragging:!0,pageY:Yr(Mt),startTop:ce.getTop()}),$t(),ce.patchEvents(),Mt.stopPropagation(),Mt.preventDefault()},ce.onMouseMove=function(Mt){var $t=ce.state,fr=$t.dragging,Tr=$t.pageY,Sr=$t.startTop,sn=ce.props.onScroll;if(vi.Z.cancel(ce.moveRaf),fr){var lt=Yr(Mt)-Tr,Xt=Sr+lt,nr=ce.getEnableScrollRange(),ur=ce.getEnableHeightRange(),Vr=ur?Xt/ur:0,ln=Math.ceil(Vr*nr);ce.moveRaf=(0,vi.Z)(function(){sn(ln)})}},ce.onMouseUp=function(){var Mt=ce.props.onStopMove;ce.setState({dragging:!1}),Mt(),ce.removeEvents()},ce.getSpinHeight=function(){var Mt=ce.props,$t=Mt.height,fr=Mt.count,Tr=$t/fr*10;return Tr=Math.max(Tr,It),Tr=Math.min(Tr,$t/2),Math.floor(Tr)},ce.getEnableScrollRange=function(){var Mt=ce.props,$t=Mt.scrollHeight,fr=Mt.height;return $t-fr||0},ce.getEnableHeightRange=function(){var Mt=ce.props.height,$t=ce.getSpinHeight();return Mt-$t||0},ce.getTop=function(){var Mt=ce.props.scrollTop,$t=ce.getEnableScrollRange(),fr=ce.getEnableHeightRange();if(Mt===0||$t===0)return 0;var Tr=Mt/$t;return Tr*fr},ce.showScroll=function(){var Mt=ce.props,$t=Mt.height,fr=Mt.scrollHeight;return fr>$t},ce}return(0,Li.Z)(Me,[{key:"componentDidMount",value:function(){this.scrollbarRef.current.addEventListener("touchstart",this.onScrollbarTouchStart),this.thumbRef.current.addEventListener("touchstart",this.onMouseDown)}},{key:"componentDidUpdate",value:function(He){He.scrollTop!==this.props.scrollTop&&this.delayHidden()}},{key:"componentWillUnmount",value:function(){this.removeEvents(),clearTimeout(this.visibleTimeout)}},{key:"render",value:function(){var He=this.state,Pe=He.dragging,Tt=He.visible,Mt=this.props.prefixCls,$t=this.getSpinHeight(),fr=this.getTop(),Tr=this.showScroll(),Sr=Tr&&Tt;return $.createElement("div",{ref:this.scrollbarRef,className:Fe()("".concat(Mt,"-scrollbar"),(0,m.Z)({},"".concat(Mt,"-scrollbar-show"),Tr)),style:{width:8,top:0,bottom:0,right:0,position:"absolute",display:Sr?null:"none"},onMouseDown:this.onContainerMouseDown,onMouseMove:this.delayHidden},$.createElement("div",{ref:this.thumbRef,className:Fe()("".concat(Mt,"-scrollbar-thumb"),(0,m.Z)({},"".concat(Mt,"-scrollbar-thumb-moving"),Pe)),style:{width:"100%",height:$t,top:fr,left:0,position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"},onMouseDown:this.onMouseDown}))}}]),Me}($.Component);function Jn(Yt){var De=Yt.children,Me=Yt.setRef,ce=$.useCallback(function(He){Me(He)},[]);return $.cloneElement(De,{ref:ce})}function Kt(Yt,De,Me,ce,He,Pe){var Tt=Pe.getKey;return Yt.slice(De,Me+1).map(function(Mt,$t){var fr=De+$t,Tr=He(Mt,fr,{}),Sr=Tt(Mt);return $.createElement(Jn,{key:Sr,setRef:function(lt){return ce(Mt,lt)}},Tr)})}var hr=I(34203),Fr=function(){function Yt(){(0,ot.Z)(this,Yt),this.maps=void 0,this.maps=Object.create(null)}return(0,Li.Z)(Yt,[{key:"set",value:function(Me,ce){this.maps[Me]=ce}},{key:"get",value:function(Me){return this.maps[Me]}}]),Yt}(),qr=Fr;function An(Yt,De,Me){var ce=$.useState(0),He=(0,F.Z)(ce,2),Pe=He[0],Tt=He[1],Mt=(0,$.useRef)(new Map),$t=(0,$.useRef)(new qr),fr=(0,$.useRef)();function Tr(){vi.Z.cancel(fr.current)}function Sr(){Tr(),fr.current=(0,vi.Z)(function(){Mt.current.forEach(function(lt,Xt){if(lt&&lt.offsetParent){var nr=(0,hr.Z)(lt),ur=nr.offsetHeight;$t.current.get(Xt)!==ur&&$t.current.set(Xt,nr.offsetHeight)}}),Tt(function(lt){return lt+1})})}function sn(lt,Xt){var nr=Yt(lt),ur=Mt.current.get(nr);Xt?(Mt.current.set(nr,Xt),Sr()):Mt.current.delete(nr),!ur!=!Xt&&(Xt?De==null||De(lt):Me==null||Me(lt))}return(0,$.useEffect)(function(){return Tr},[]),[sn,Sr,$t.current,Pe]}function Ui(Yt,De,Me,ce,He,Pe,Tt,Mt){var $t=$.useRef();return function(fr){if(fr==null){Mt();return}if(vi.Z.cancel($t.current),typeof fr=="number")Tt(fr);else if(fr&&(0,W.Z)(fr)==="object"){var Tr,Sr=fr.align;"index"in fr?Tr=fr.index:Tr=De.findIndex(function(nr){return He(nr)===fr.key});var sn=fr.offset,lt=sn===void 0?0:sn,Xt=function nr(ur,Vr){if(!(ur<0||!Yt.current)){var ln=Yt.current.clientHeight,Un=!1,Gn=Vr;if(ln){for(var qn=Vr||Sr,oi=0,T=0,H=0,_e=Math.min(De.length,Tr),ne=0;ne<=_e;ne+=1){var $e=He(De[ne]);T=oi;var xt=Me.get($e);H=T+(xt===void 0?ce:xt),oi=H,ne===Tr&&xt===void 0&&(Un=!0)}var zt=null;switch(qn){case"top":zt=T-lt;break;case"bottom":zt=H-ln+lt;break;default:{var _r=Yt.current.scrollTop,xr=_r+ln;T<_r?Gn="top":H>xr&&(Gn="bottom")}}zt!==null&&zt!==Yt.current.scrollTop&&Tt(zt)}$t.current=(0,vi.Z)(function(){Un&&Pe(),nr(ur-1,Gn)},2)}};Xt(3)}}}function fa(Yt,De,Me,ce){var He=Me-Yt,Pe=De-Me,Tt=Math.min(He,Pe)*2;if(ce<=Tt){var Mt=Math.floor(ce/2);return ce%2?Me+Mt+1:Me-Mt}return He>Pe?Me-(ce-Pe):Me+(ce-He)}function Wi(Yt,De,Me){var ce=Yt.length,He=De.length,Pe,Tt;if(ce===0&&He===0)return null;ce<He?(Pe=Yt,Tt=De):(Pe=De,Tt=Yt);var Mt={__EMPTY_ITEM__:!0};function $t(Xt){return Xt!==void 0?Me(Xt):Mt}for(var fr=null,Tr=Math.abs(ce-He)!==1,Sr=0;Sr<Tt.length;Sr+=1){var sn=$t(Pe[Sr]),lt=$t(Tt[Sr]);if(sn!==lt){fr=Sr,Tr=Tr||sn!==$t(Tt[Sr+1]);break}}return fr===null?null:{index:fr,multiple:Tr}}function ct(Yt,De,Me){var ce=$.useState(Yt),He=(0,F.Z)(ce,2),Pe=He[0],Tt=He[1],Mt=$.useState(null),$t=(0,F.Z)(Mt,2),fr=$t[0],Tr=$t[1];return $.useEffect(function(){var Sr=Wi(Pe||[],Yt||[],De);(Sr==null?void 0:Sr.index)!==void 0&&(Me==null||Me(Sr.index),Tr(Yt[Sr.index])),Tt(Yt)},[Yt]),[fr]}var qi=(typeof navigator=="undefined"?"undefined":(0,W.Z)(navigator))==="object"&&/Firefox/i.test(navigator.userAgent),Na=qi,To=function(Yt,De){var Me=(0,$.useRef)(!1),ce=(0,$.useRef)(null);function He(){clearTimeout(ce.current),Me.current=!0,ce.current=setTimeout(function(){Me.current=!1},50)}var Pe=(0,$.useRef)({top:Yt,bottom:De});return Pe.current.top=Yt,Pe.current.bottom=De,function(Tt){var Mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,$t=Tt<0&&Pe.current.top||Tt>0&&Pe.current.bottom;return Mt&&$t?(clearTimeout(ce.current),Me.current=!1):(!$t||Me.current)&&He(),!Me.current&&$t}};function ao(Yt,De,Me,ce){var He=(0,$.useRef)(0),Pe=(0,$.useRef)(null),Tt=(0,$.useRef)(null),Mt=(0,$.useRef)(!1),$t=To(De,Me);function fr(Sr){if(Yt){vi.Z.cancel(Pe.current);var sn=Sr.deltaY;He.current+=sn,Tt.current=sn,!$t(sn)&&(Na||Sr.preventDefault(),Pe.current=(0,vi.Z)(function(){var lt=Mt.current?10:1;ce(He.current*lt),He.current=0}))}}function Tr(Sr){Yt&&(Mt.current=Sr.detail===Tt.current)}return[fr,Tr]}var Ga=14/15;function Ko(Yt,De,Me){var ce=(0,$.useRef)(!1),He=(0,$.useRef)(0),Pe=(0,$.useRef)(null),Tt=(0,$.useRef)(null),Mt,$t=function(sn){if(ce.current){var lt=Math.ceil(sn.touches[0].pageY),Xt=He.current-lt;He.current=lt,Me(Xt)&&sn.preventDefault(),clearInterval(Tt.current),Tt.current=setInterval(function(){Xt*=Ga,(!Me(Xt,!0)||Math.abs(Xt)<=.1)&&clearInterval(Tt.current)},16)}},fr=function(){ce.current=!1,Mt()},Tr=function(sn){Mt(),sn.touches.length===1&&!ce.current&&(ce.current=!0,He.current=Math.ceil(sn.touches[0].pageY),Pe.current=sn.target,Pe.current.addEventListener("touchmove",$t),Pe.current.addEventListener("touchend",fr))};Mt=function(){Pe.current&&(Pe.current.removeEventListener("touchmove",$t),Pe.current.removeEventListener("touchend",fr))},(0,Ce.Z)(function(){return Yt&&De.current.addEventListener("touchstart",Tr),function(){var Sr;(Sr=De.current)===null||Sr===void 0||Sr.removeEventListener("touchstart",Tr),Mt(),clearInterval(Tt.current)}},[Yt])}var ws=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","component","onScroll","onVisibleChange","innerProps"],Fo=[],su={overflowY:"auto",overflowAnchor:"none"};function zo(Yt,De){var Me=Yt.prefixCls,ce=Me===void 0?"rc-virtual-list":Me,He=Yt.className,Pe=Yt.height,Tt=Yt.itemHeight,Mt=Yt.fullHeight,$t=Mt===void 0?!0:Mt,fr=Yt.style,Tr=Yt.data,Sr=Yt.children,sn=Yt.itemKey,lt=Yt.virtual,Xt=Yt.component,nr=Xt===void 0?"div":Xt,ur=Yt.onScroll,Vr=Yt.onVisibleChange,ln=Yt.innerProps,Un=(0,K.Z)(Yt,ws),Gn=!!(lt!==!1&&Pe&&Tt),qn=Gn&&Tr&&Tt*Tr.length>Pe,oi=(0,$.useState)(0),T=(0,F.Z)(oi,2),H=T[0],_e=T[1],ne=(0,$.useState)(!1),$e=(0,F.Z)(ne,2),xt=$e[0],zt=$e[1],_r=Fe()(ce,He),xr=Tr||Fo,dn=(0,$.useRef)(),Bn=(0,$.useRef)(),zi=(0,$.useRef)(),Vi=$.useCallback(function(as){return typeof sn=="function"?sn(as):as==null?void 0:as[sn]},[sn]),Ei={getKey:Vi};function qa(as){_e(function(Ds){var Tl;typeof as=="function"?Tl=as(Ds):Tl=as;var Yu=ks(Tl);return dn.current.scrollTop=Yu,Yu})}var $a=(0,$.useRef)({start:0,end:xr.length}),La=(0,$.useRef)(),to=ct(xr,Vi),Ho=(0,F.Z)(to,1),xo=Ho[0];La.current=xo;var bo=An(Vi,null,null),so=(0,F.Z)(bo,4),Cs=so[0],Ls=so[1],Rs=so[2],lu=so[3],ps=$.useMemo(function(){if(!Gn)return{scrollHeight:void 0,start:0,end:xr.length-1,offset:void 0};if(!qn){var as;return{scrollHeight:((as=Bn.current)===null||as===void 0?void 0:as.offsetHeight)||0,start:0,end:xr.length-1,offset:void 0}}for(var Ds=0,Tl,Yu,Ml,xl=xr.length,nf=0;nf<xl;nf+=1){var Vc=xr[nf],Zf=Vi(Vc),Hc=Rs.get(Zf),Ql=Ds+(Hc===void 0?Tt:Hc);Ql>=H&&Tl===void 0&&(Tl=nf,Yu=Ds),Ql>H+Pe&&Ml===void 0&&(Ml=nf),Ds=Ql}return Tl===void 0&&(Tl=0,Yu=0,Ml=Math.ceil(Pe/Tt)),Ml===void 0&&(Ml=xr.length-1),Ml=Math.min(Ml+1,xr.length),{scrollHeight:Ds,start:Tl,end:Ml,offset:Yu}},[qn,Gn,H,xr,lu,Pe]),Go=ps.scrollHeight,zu=ps.start,al=ps.end,ou=ps.offset;$a.current.start=zu,$a.current.end=al;var Xu=Go-Pe,Nu=(0,$.useRef)(Xu);Nu.current=Xu;function ks(as){var Ds=as;return Number.isNaN(Nu.current)||(Ds=Math.min(Ds,Nu.current)),Ds=Math.max(Ds,0),Ds}var Sc=H<=0,vl=H>=Xu,es=To(Sc,vl);function Al(as){var Ds=as;qa(Ds)}function tf(as){var Ds=as.currentTarget.scrollTop;Ds!==H&&qa(Ds),ur==null||ur(as)}var Zl=ao(Gn,Sc,vl,function(as){qa(function(Ds){var Tl=Ds+as;return Tl})}),uc=(0,F.Z)(Zl,2),pf=uc[0],ql=uc[1];Ko(Gn,dn,function(as,Ds){return es(as,Ds)?!1:(pf({preventDefault:function(){},deltaY:as}),!0)}),(0,Ce.Z)(function(){function as(Ds){Gn&&Ds.preventDefault()}return dn.current.addEventListener("wheel",pf),dn.current.addEventListener("DOMMouseScroll",ql),dn.current.addEventListener("MozMousePixelScroll",as),function(){dn.current&&(dn.current.removeEventListener("wheel",pf),dn.current.removeEventListener("DOMMouseScroll",ql),dn.current.removeEventListener("MozMousePixelScroll",as))}},[Gn]);var Cu=Ui(dn,xr,Rs,Tt,Vi,Ls,qa,function(){var as;(as=zi.current)===null||as===void 0||as.delayHidden()});$.useImperativeHandle(De,function(){return{scrollTo:Cu}}),(0,Ce.Z)(function(){if(Vr){var as=xr.slice(zu,al+1);Vr(as,xr)}},[zu,al,xr]);var rf=Kt(xr,zu,al,Cs,Sr,Ei),ol=null;return Pe&&(ol=(0,ae.Z)((0,m.Z)({},$t?"height":"maxHeight",Pe),su),Gn&&(ol.overflowY="hidden",xt&&(ol.pointerEvents="none"))),$.createElement("div",(0,D.Z)({style:(0,ae.Z)((0,ae.Z)({},fr),{},{position:"relative"}),className:_r},Un),$.createElement(nr,{className:"".concat(ce,"-holder"),style:ol,ref:dn,onScroll:tf},$.createElement(rr,{prefixCls:ce,height:Go,offset:ou,onInnerResize:Ls,ref:Bn,innerProps:ln},rf)),Gn&&$.createElement(Dr,{ref:zi,prefixCls:ce,scrollTop:H,height:Pe,scrollHeight:Go,count:xr.length,onScroll:Al,onStartMove:function(){zt(!0)},onStopMove:function(){zt(!1)}}))}var ns=$.forwardRef(zo);ns.displayName="List";var ls=ns,_o=ls,Po=$.createContext(null),Ss=Po;function Wu(){return/(mac\sos|macintosh)/i.test(navigator.appVersion)}var $s=["disabled","title","children","style","className"];function uu(Yt){return typeof Yt=="string"||typeof Yt=="number"}var Jo=function(De,Me){var ce=pt(),He=ce.prefixCls,Pe=ce.id,Tt=ce.open,Mt=ce.multiple,$t=ce.mode,fr=ce.searchValue,Tr=ce.toggleOpen,Sr=ce.notFoundContent,sn=ce.onPopupScroll,lt=$.useContext(Ss),Xt=lt.flattenOptions,nr=lt.onActiveValue,ur=lt.defaultActiveFirstOption,Vr=lt.onSelect,ln=lt.menuItemSelectedIcon,Un=lt.rawValues,Gn=lt.fieldNames,qn=lt.virtual,oi=lt.listHeight,T=lt.listItemHeight,H="".concat(He,"-item"),_e=(0,tr.Z)(function(){return Xt},[Tt,Xt],function(xo,bo){return bo[0]&&xo[1]!==bo[1]}),ne=$.useRef(null),$e=function(bo){bo.preventDefault()},xt=function(bo){ne.current&&ne.current.scrollTo(typeof bo=="number"?{index:bo}:bo)},zt=function(bo){for(var so=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Cs=_e.length,Ls=0;Ls<Cs;Ls+=1){var Rs=(bo+Ls*so+Cs)%Cs,lu=_e[Rs],ps=lu.group,Go=lu.data;if(!ps&&!Go.disabled)return Rs}return-1},_r=$.useState(function(){return zt(0)}),xr=(0,F.Z)(_r,2),dn=xr[0],Bn=xr[1],zi=function(bo){var so=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;Bn(bo);var Cs={source:so?"keyboard":"mouse"},Ls=_e[bo];if(!Ls){nr(null,-1,Cs);return}nr(Ls.value,bo,Cs)};(0,$.useEffect)(function(){zi(ur!==!1?zt(0):-1)},[_e.length,fr]);var Vi=$.useCallback(function(xo){return Un.has(xo)&&$t!=="combobox"},[$t,(0,k.Z)(Un).toString(),Un.size]);(0,$.useEffect)(function(){var xo=setTimeout(function(){if(!Mt&&Tt&&Un.size===1){var so=Array.from(Un)[0],Cs=_e.findIndex(function(Ls){var Rs=Ls.data;return Rs.value===so});Cs!==-1&&(zi(Cs),xt(Cs))}});if(Tt){var bo;(bo=ne.current)===null||bo===void 0||bo.scrollTo(void 0)}return function(){return clearTimeout(xo)}},[Tt,fr]);var Ei=function(bo){bo!==void 0&&Vr(bo,{selected:!Un.has(bo)}),Mt||Tr(!1)};if($.useImperativeHandle(Me,function(){return{onKeyDown:function(bo){var so=bo.which,Cs=bo.ctrlKey;switch(so){case me.Z.N:case me.Z.P:case me.Z.UP:case me.Z.DOWN:{var Ls=0;if(so===me.Z.UP?Ls=-1:so===me.Z.DOWN?Ls=1:Wu()&&Cs&&(so===me.Z.N?Ls=1:so===me.Z.P&&(Ls=-1)),Ls!==0){var Rs=zt(dn+Ls,Ls);xt(Rs),zi(Rs,!0)}break}case me.Z.ENTER:{var lu=_e[dn];lu&&!lu.data.disabled?Ei(lu.value):Ei(void 0),Tt&&bo.preventDefault();break}case me.Z.ESC:Tr(!1),Tt&&bo.stopPropagation()}},onKeyUp:function(){},scrollTo:function(bo){xt(bo)}}}),_e.length===0)return $.createElement("div",{role:"listbox",id:"".concat(Pe,"_list"),className:"".concat(H,"-empty"),onMouseDown:$e},Sr);var qa=Object.keys(Gn).map(function(xo){return Gn[xo]}),$a=function(bo){return bo.label};function La(xo,bo){var so=xo.group;return{role:so?"presentation":"option",id:"".concat(Pe,"_list_").concat(bo)}}var to=function(bo){var so=_e[bo];if(!so)return null;var Cs=so.data||{},Ls=Cs.value,Rs=so.group,lu=ht(Cs,!0),ps=$a(so);return so?$.createElement("div",(0,D.Z)({"aria-label":typeof ps=="string"&&!Rs?ps:null},lu,{key:bo},La(so,bo),{"aria-selected":Vi(Ls)}),Ls):null},Ho={role:"listbox",id:"".concat(Pe,"_list")};return $.createElement($.Fragment,null,qn&&$.createElement("div",(0,D.Z)({},Ho,{style:{height:0,width:0,overflow:"hidden"}}),to(dn-1),to(dn),to(dn+1)),$.createElement(_o,{itemKey:"key",ref:ne,data:_e,height:oi,itemHeight:T,fullHeight:!1,onMouseDown:$e,onScroll:sn,virtual:qn,innerProps:qn?null:Ho},function(xo,bo){var so,Cs=xo.group,Ls=xo.groupOption,Rs=xo.data,lu=xo.label,ps=xo.value,Go=Rs.key;if(Cs){var zu,al=(zu=Rs.title)!==null&&zu!==void 0?zu:uu(lu)?lu.toString():void 0;return $.createElement("div",{className:Fe()(H,"".concat(H,"-group")),title:al},lu!==void 0?lu:Go)}var ou=Rs.disabled,Xu=Rs.title,Nu=Rs.children,ks=Rs.style,Sc=Rs.className,vl=(0,K.Z)(Rs,$s),es=(0,en.Z)(vl,qa),Al=Vi(ps),tf="".concat(H,"-option"),Zl=Fe()(H,tf,Sc,(so={},(0,m.Z)(so,"".concat(tf,"-grouped"),Ls),(0,m.Z)(so,"".concat(tf,"-active"),dn===bo&&!ou),(0,m.Z)(so,"".concat(tf,"-disabled"),ou),(0,m.Z)(so,"".concat(tf,"-selected"),Al),so)),uc=$a(xo),pf=!ln||typeof ln=="function"||Al,ql=typeof uc=="number"?uc:uc||ps,Cu=uu(ql)?ql.toString():void 0;return Xu!==void 0&&(Cu=Xu),$.createElement("div",(0,D.Z)({},ht(es),qn?{}:La(xo,bo),{"aria-selected":Al,className:Zl,title:Cu,onMouseMove:function(){dn===bo||ou||zi(bo)},onClick:function(){ou||Ei(ps)},style:ks}),$.createElement("div",{className:"".concat(tf,"-content")},ql),$.isValidElement(ln)||Al,pf&&$.createElement(oe,{className:"".concat(H,"-option-state"),customizeIcon:ln,customizeIconProps:{isSelected:Al}},Al?"\u2713":null))}))},ms=$.forwardRef(Jo);ms.displayName="OptionList";var eu=ms;function Bs(Yt){var De=Yt.mode,Me=Yt.options,ce=Yt.children,He=Yt.backfill,Pe=Yt.allowClear,Tt=Yt.placeholder,Mt=Yt.getInputElement,$t=Yt.showSearch,fr=Yt.onSearch,Tr=Yt.defaultOpen,Sr=Yt.autoFocus,sn=Yt.labelInValue,lt=Yt.value,Xt=Yt.inputValue,nr=Yt.optionLabelProp,ur=isMultiple(De),Vr=$t!==void 0?$t:ur||De==="combobox",ln=Me||convertChildrenToData(ce);if(warning(De!=="tags"||ln.every(function(oi){return!oi.disabled}),"Please avoid setting option to disabled in tags mode since user can always type text as tag."),De==="tags"||De==="combobox"){var Un=ln.some(function(oi){return oi.options?oi.options.some(function(T){return typeof("value"in T?T.value:T.key)=="number"}):typeof("value"in oi?oi.value:oi.key)=="number"});warning(!Un,"`value` of Option should not use number type when `mode` is `tags` or `combobox`.")}if(warning(De!=="combobox"||!nr,"`combobox` mode not support `optionLabelProp`. Please set `value` on Option directly."),warning(De==="combobox"||!He,"`backfill` only works with `combobox` mode."),warning(De==="combobox"||!Mt,"`getInputElement` only work with `combobox` mode."),noteOnce(De!=="combobox"||!Mt||!Pe||!Tt,"Customize `getInputElement` should customize clear and placeholder logic instead of configuring `allowClear` and `placeholder`."),fr&&!Vr&&De!=="combobox"&&De!=="tags"&&warning(!1,"`onSearch` should work with `showSearch` instead of use alone."),noteOnce(!Tr||Sr,"`defaultOpen` makes Select open without focus which means it will not close by click outside. You can set `autoFocus` if needed."),lt!=null){var Gn=toArray(lt);warning(!sn||Gn.every(function(oi){return _typeof(oi)==="object"&&("key"in oi||"value"in oi)}),"`value` should in shape of `{ value: string | number, label?: ReactNode }` when you set `labelInValue` to `true`"),warning(!ur||Array.isArray(lt),"`value` should be array when `mode` is `multiple` or `tags`")}if(ce){var qn=null;toNodeArray(ce).some(function(oi){if(!React.isValidElement(oi)||!oi.type)return!1;var T=oi,H=T.type;if(H.isSelectOption)return!1;if(H.isSelectOptGroup){var _e=toNodeArray(oi.props.children).every(function(ne){return!React.isValidElement(ne)||!oi.type||ne.type.isSelectOption?!0:(qn=ne.type,!1)});return!_e}return qn=H,!0}),qn&&warning(!1,"`children` should be `Select.Option` or `Select.OptGroup` instead of `".concat(qn.displayName||qn.name||qn,"`.")),warning(Xt===void 0,"`inputValue` is deprecated, please use `searchValue` instead.")}}function fi(Yt,De){if(Yt){var Me=function ce(He){for(var Pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Tt=0;Tt<He.length;Tt++){var Mt=He[Tt];if(Mt[De==null?void 0:De.value]===null)return warning(!1,"`value` in Select options should not be `null`."),!0;if(!Pe&&Array.isArray(Mt[De==null?void 0:De.options])&&ce(Mt[De==null?void 0:De.options],!0))break}};Me(Yt)}}var is=null,ku=["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","listHeight","listItemHeight","value","defaultValue","labelInValue","onChange"],mt=["inputValue"];function Gt(Yt){return!Yt||(0,W.Z)(Yt)!=="object"}var Cr=$.forwardRef(function(Yt,De){var Me=Yt.id,ce=Yt.mode,He=Yt.prefixCls,Pe=He===void 0?"rc-select":He,Tt=Yt.backfill,Mt=Yt.fieldNames,$t=Yt.inputValue,fr=Yt.searchValue,Tr=Yt.onSearch,Sr=Yt.autoClearSearchValue,sn=Sr===void 0?!0:Sr,lt=Yt.onSelect,Xt=Yt.onDeselect,nr=Yt.dropdownMatchSelectWidth,ur=nr===void 0?!0:nr,Vr=Yt.filterOption,ln=Yt.filterSort,Un=Yt.optionFilterProp,Gn=Yt.optionLabelProp,qn=Yt.options,oi=Yt.children,T=Yt.defaultActiveFirstOption,H=Yt.menuItemSelectedIcon,_e=Yt.virtual,ne=Yt.listHeight,$e=ne===void 0?200:ne,xt=Yt.listItemHeight,zt=xt===void 0?20:xt,_r=Yt.value,xr=Yt.defaultValue,dn=Yt.labelInValue,Bn=Yt.onChange,zi=(0,K.Z)(Yt,ku),Vi=Ia(Me),Ei=gr(ce),qa=!!(!qn&&oi),$a=$.useMemo(function(){return Vr===void 0&&ce==="combobox"?!1:Vr},[Vr,ce]),La=$.useMemo(function(){return er(Mt,qa)},[JSON.stringify(Mt),qa]),to=(0,Y.Z)("",{value:fr!==void 0?fr:$t,postState:function(gs){return gs||""}}),Ho=(0,F.Z)(to,2),xo=Ho[0],bo=Ho[1],so=Et(qn,oi,La,Un,Gn),Cs=so.valueOptions,Ls=so.labelOptions,Rs=so.options,lu=$.useCallback(function(ts){var gs=bt(ts);return gs.map(function($o){var ds,Ns,Mu,ec,zs;if(Gt($o))ds=$o;else{var df;Mu=$o.key,Ns=$o.label,ds=(df=$o.value)!==null&&df!==void 0?df:Mu}var ha=Cs.get(ds);if(ha){var Gc;if(Ns===void 0&&(Ns=ha==null?void 0:ha[Gn||La.label]),Mu===void 0&&(Mu=(Gc=ha==null?void 0:ha.key)!==null&&Gc!==void 0?Gc:ds),ec=ha==null?void 0:ha.disabled,zs=ha==null?void 0:ha.title,!1)var kc}return{label:Ns,value:ds,key:Mu,disabled:ec,title:zs}})},[La,Gn,Cs]),ps=(0,Y.Z)(xr,{value:_r}),Go=(0,F.Z)(ps,2),zu=Go[0],al=Go[1],ou=$.useMemo(function(){var ts,gs=lu(zu);return ce==="combobox"&&!((ts=gs[0])!==null&&ts!==void 0&&ts.value)?[]:gs},[zu,lu,ce]),Xu=Dn(ou,Cs),Nu=(0,F.Z)(Xu,2),ks=Nu[0],Sc=Nu[1],vl=$.useMemo(function(){if(!ce&&ks.length===1){var ts=ks[0];if(ts.value===null&&(ts.label===null||ts.label===void 0))return[]}return ks.map(function(gs){var $o;return(0,ae.Z)((0,ae.Z)({},gs),{},{label:($o=gs.label)!==null&&$o!==void 0?$o:gs.value})})},[ce,ks]),es=$.useMemo(function(){return new Set(ks.map(function(ts){return ts.value}))},[ks]);$.useEffect(function(){if(ce==="combobox"){var ts,gs=(ts=ks[0])===null||ts===void 0?void 0:ts.value;bo(Vt(gs)?String(gs):"")}},[ks]);var Al=Bt(function(ts,gs){var $o,ds=gs!=null?gs:ts;return $o={},(0,m.Z)($o,La.value,ts),(0,m.Z)($o,La.label,ds),$o}),tf=$.useMemo(function(){if(ce!=="tags")return Rs;var ts=(0,k.Z)(Rs),gs=function(ds){return Cs.has(ds)};return(0,k.Z)(ks).sort(function($o,ds){return $o.value<ds.value?-1:1}).forEach(function($o){var ds=$o.value;gs(ds)||ts.push(Al(ds,$o.label))}),ts},[Al,Rs,Cs,ks,ce]),Zl=di(tf,La,xo,$a,Un),uc=$.useMemo(function(){return ce!=="tags"||!xo||Zl.some(function(ts){return ts[Un||"value"]===xo})?Zl:[Al(xo)].concat((0,k.Z)(Zl))},[Al,Un,ce,Zl,xo]),pf=$.useMemo(function(){return ln?(0,k.Z)(uc).sort(function(ts,gs){return ln(ts,gs)}):uc},[uc,ln]),ql=$.useMemo(function(){return $r(pf,{fieldNames:La,childrenAsData:qa})},[pf,La,qa]),Cu=function(gs){var $o=lu(gs);if(al($o),Bn&&($o.length!==ks.length||$o.some(function(Mu,ec){var zs;return((zs=ks[ec])===null||zs===void 0?void 0:zs.value)!==(Mu==null?void 0:Mu.value)}))){var ds=dn?$o:$o.map(function(Mu){return Mu.value}),Ns=$o.map(function(Mu){return Fn(Sc(Mu.value))});Bn(Ei?ds:ds[0],Ei?Ns:Ns[0])}},rf=$.useState(null),ol=(0,F.Z)(rf,2),as=ol[0],Ds=ol[1],Tl=$.useState(0),Yu=(0,F.Z)(Tl,2),Ml=Yu[0],xl=Yu[1],nf=T!==void 0?T:ce!=="combobox",Vc=$.useCallback(function(ts,gs){var $o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ds=$o.source,Ns=ds===void 0?"keyboard":ds;xl(gs),Tt&&ce==="combobox"&&ts!==null&&Ns==="keyboard"&&Ds(String(ts))},[Tt,ce]),Zf=function(gs,$o,ds){var Ns=function(){var ei,za=Sc(gs);return[dn?{label:za==null?void 0:za[La.label],value:gs,key:(ei=za==null?void 0:za.key)!==null&&ei!==void 0?ei:gs}:gs,Fn(za)]};if($o&&lt){var Mu=Ns(),ec=(0,F.Z)(Mu,2),zs=ec[0],df=ec[1];lt(zs,df)}else if(!$o&&Xt&&ds!=="clear"){var ha=Ns(),Gc=(0,F.Z)(ha,2),kc=Gc[0],un=Gc[1];Xt(kc,un)}},Hc=Bt(function(ts,gs){var $o,ds=Ei?gs.selected:!0;ds?$o=Ei?[].concat((0,k.Z)(ks),[ts]):[ts]:$o=ks.filter(function(Ns){return Ns.value!==ts}),Cu($o),Zf(ts,ds),ce==="combobox"?Ds(""):(!gr||sn)&&(bo(""),Ds(""))}),Ql=function(gs,$o){Cu(gs);var ds=$o.type,Ns=$o.values;(ds==="remove"||ds==="clear")&&Ns.forEach(function(Mu){Zf(Mu.value,!1,ds)})},sl=function(gs,$o){if(bo(gs),Ds(null),$o.source==="submit"){var ds=(gs||"").trim();if(ds){var Ns=Array.from(new Set([].concat((0,k.Z)(es),[ds])));Cu(Ns),Zf(ds,!0),bo("")}return}$o.source!=="blur"&&(ce==="combobox"&&Cu(gs),Tr==null||Tr(gs))},vc=function(gs){var $o=gs;ce!=="tags"&&($o=gs.map(function(Ns){var Mu=Ls.get(Ns);return Mu==null?void 0:Mu.value}).filter(function(Ns){return Ns!==void 0}));var ds=Array.from(new Set([].concat((0,k.Z)(es),(0,k.Z)($o))));Cu(ds),ds.forEach(function(Ns){Zf(Ns,!0)})},Jl=$.useMemo(function(){var ts=_e!==!1&&ur!==!1;return(0,ae.Z)((0,ae.Z)({},so),{},{flattenOptions:ql,onActiveValue:Vc,defaultActiveFirstOption:nf,onSelect:Hc,menuItemSelectedIcon:H,rawValues:es,fieldNames:La,virtual:ts,listHeight:$e,listItemHeight:zt,childrenAsData:qa})},[so,ql,Vc,nf,Hc,H,es,La,_e,ur,$e,zt,qa]);return $.createElement(Ss.Provider,{value:Jl},$.createElement(Sn,(0,D.Z)({},zi,{id:Vi,prefixCls:Pe,ref:De,omitDomProps:mt,mode:ce,displayValues:vl,onDisplayValuesChange:Ql,searchValue:xo,onSearch:sl,autoClearSearchValue:sn,onSearchSplit:vc,dropdownMatchSelectWidth:ur,OptionList:eu,emptyOptions:!ql.length,activeValue:as,activeDescendantId:"".concat(Vi,"_list_").concat(Ml)})))}),Rr=Cr;Rr.Option=At,Rr.OptGroup=St;var ji=Rr,Pa=ji},44958:function(Ne,fe,I){"use strict";I.d(fe,{hq:function(){return me},jL:function(){return Fe}});var D=I(98924),k=I(94999),m="data-rc-order",ae="rc-util-key",F=new Map;function K(){var Ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ke=Ge.mark;return Ke?Ke.startsWith("data-")?Ke:"data-".concat(Ke):ae}function W(Ge){if(Ge.attachTo)return Ge.attachTo;var Ke=document.querySelector("head");return Ke||document.body}function Y(Ge){return Ge==="queue"?"prependQueue":Ge?"prepend":"append"}function G(Ge){return Array.from((F.get(Ge)||Ge).children).filter(function(Ke){return Ke.tagName==="STYLE"})}function $(Ge){var Ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!(0,D.Z)())return null;var pt=Ke.csp,Xe=Ke.prepend,gt=document.createElement("style");gt.setAttribute(m,Y(Xe)),pt!=null&&pt.nonce&&(gt.nonce=pt==null?void 0:pt.nonce),gt.innerHTML=Ge;var ie=W(Ke),ft=ie.firstChild;if(Xe){if(Xe==="queue"){var ve=G(ie).filter(function(Ae){return["prepend","prependQueue"].includes(Ae.getAttribute(m))});if(ve.length)return ie.insertBefore(gt,ve[ve.length-1].nextSibling),gt}ie.insertBefore(gt,ft)}else ie.appendChild(gt);return gt}function xe(Ge){var Ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},pt=W(Ke);return G(pt).find(function(Xe){return Xe.getAttribute(K(Ke))===Ge})}function Fe(Ge){var Ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},pt=xe(Ge,Ke);if(pt){var Xe=W(Ke);Xe.removeChild(pt)}}function Ce(Ge,Ke){var pt=F.get(Ge);if(!pt||!(0,k.Z)(document,pt)){var Xe=$("",Ke),gt=Xe.parentNode;F.set(Ge,gt),Ge.removeChild(Xe)}}function We(){F.clear()}function me(Ge,Ke){var pt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Xe=W(pt);Ce(Xe,pt);var gt=xe(Ke,pt);if(gt){var ie,ft;if((ie=pt.csp)!==null&&ie!==void 0&&ie.nonce&&gt.nonce!==((ft=pt.csp)===null||ft===void 0?void 0:ft.nonce)){var ve;gt.nonce=(ve=pt.csp)===null||ve===void 0?void 0:ve.nonce}return gt.innerHTML!==Ge&&(gt.innerHTML=Ge),gt}var Ae=$(Ge,pt);return Ae.setAttribute(K(pt),Ke),Ae}},38135:function(Ne,fe,I){"use strict";var D;I.d(fe,{s:function(){return pt},v:function(){return ve}});var k=I(74165),m=I(15861),ae=I(71002),F=I(1413),K=I(73935),W=(0,F.Z)({},D||(D=I.t(K,2))),Y=W.version,G=W.render,$=W.unmountComponentAtNode,xe;try{var Fe=Number((Y||"").split(".")[0]);Fe>=18&&(xe=W.createRoot)}catch(Re){}function Ce(Re){var Ye=W.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Ye&&(0,ae.Z)(Ye)==="object"&&(Ye.usingClientEntryPoint=Re)}var We="__rc_react_root__";function me(Re,Ye){Ce(!0);var at=Ye[We]||xe(Ye);Ce(!1),at.render(Re),Ye[We]=at}function Ge(Re,Ye){G(Re,Ye)}function Ke(Re,Ye){}function pt(Re,Ye){if(xe){me(Re,Ye);return}Ge(Re,Ye)}function Xe(Re){return gt.apply(this,arguments)}function gt(){return gt=(0,m.Z)((0,k.Z)().mark(function Re(Ye){return(0,k.Z)().wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:return ht.abrupt("return",Promise.resolve().then(function(){var Se;(Se=Ye[We])===null||Se===void 0||Se.unmount(),delete Ye[We]}));case 1:case"end":return ht.stop()}},Re)})),gt.apply(this,arguments)}function ie(Re){$(Re)}function ft(Re){}function ve(Re){return Ae.apply(this,arguments)}function Ae(){return Ae=(0,m.Z)((0,k.Z)().mark(function Re(Ye){return(0,k.Z)().wrap(function(ht){for(;;)switch(ht.prev=ht.next){case 0:if(xe===void 0){ht.next=2;break}return ht.abrupt("return",Xe(Ye));case 2:ie(Ye);case 3:case"end":return ht.stop()}},Re)})),Ae.apply(this,arguments)}},28660:function(Ne,fe,I){var D=I(34155);var k;(function(m){(function(ae){var F=typeof I.g=="object"?I.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),K=W(m);typeof F.Reflect=="undefined"?F.Reflect=m:K=W(F.Reflect,K),ae(K);function W(Y,G){return function($,xe){typeof Y[$]!="function"&&Object.defineProperty(Y,$,{configurable:!0,writable:!0,value:xe}),G&&G($,xe)}}})(function(ae){var F=Object.prototype.hasOwnProperty,K=typeof Symbol=="function",W=K&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",Y=K&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",G=typeof Object.create=="function",$={__proto__:[]}instanceof Array,xe=!G&&!$,Fe={create:G?function(){return Fn(Object.create(null))}:$?function(){return Fn({__proto__:null})}:function(){return Fn({})},has:xe?function(Qt,Br){return F.call(Qt,Br)}:function(Qt,Br){return Br in Qt},get:xe?function(Qt,Br){return F.call(Qt,Br)?Qt[Br]:void 0}:function(Qt,Br){return Qt[Br]}},Ce=Object.getPrototypeOf(Function),We=typeof D=="object"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",me=!We&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:we(),Ge=!We&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:er(),Ke=!We&&typeof WeakMap=="function"?WeakMap:$r(),pt=new Ke;function Xe(Qt,Br,bn,gr){if(hn(bn)){if(!ea(Qt))throw new TypeError;if(!tn(Br))throw new TypeError;return Se(Qt,Br)}else{if(!ea(Qt))throw new TypeError;if(!Dt(Br))throw new TypeError;if(!Dt(gr)&&!hn(gr)&&!gi(gr))throw new TypeError;return gi(gr)&&(gr=void 0),bn=Oi(bn),Qe(Qt,Br,bn,gr)}}ae("decorate",Xe);function gt(Qt,Br){function bn(gr,pn){if(!Dt(gr))throw new TypeError;if(!hn(pn)&&!da(pn))throw new TypeError;Ht(Qt,Br,gr,pn)}return bn}ae("metadata",gt);function ie(Qt,Br,bn,gr){if(!Dt(bn))throw new TypeError;return hn(gr)||(gr=Oi(gr)),Ht(Qt,Br,bn,gr)}ae("defineMetadata",ie);function ft(Qt,Br,bn){if(!Dt(Br))throw new TypeError;return hn(bn)||(bn=Oi(bn)),ue(Qt,Br,bn)}ae("hasMetadata",ft);function ve(Qt,Br,bn){if(!Dt(Br))throw new TypeError;return hn(bn)||(bn=Oi(bn)),be(Qt,Br,bn)}ae("hasOwnMetadata",ve);function Ae(Qt,Br,bn){if(!Dt(Br))throw new TypeError;return hn(bn)||(bn=Oi(bn)),vt(Qt,Br,bn)}ae("getMetadata",Ae);function Re(Qt,Br,bn){if(!Dt(Br))throw new TypeError;return hn(bn)||(bn=Oi(bn)),bt(Qt,Br,bn)}ae("getOwnMetadata",Re);function Ye(Qt,Br){if(!Dt(Qt))throw new TypeError;return hn(Br)||(Br=Oi(Br)),Er(Qt,Br)}ae("getMetadataKeys",Ye);function at(Qt,Br){if(!Dt(Qt))throw new TypeError;return hn(Br)||(Br=Oi(Br)),Vt(Qt,Br)}ae("getOwnMetadataKeys",at);function ht(Qt,Br,bn){if(!Dt(Br))throw new TypeError;hn(bn)||(bn=Oi(bn));var gr=oe(Br,bn,!1);if(hn(gr)||!gr.delete(Qt))return!1;if(gr.size>0)return!0;var pn=pt.get(Br);return pn.delete(bn),pn.size>0||pt.delete(Br),!0}ae("deleteMetadata",ht);function Se(Qt,Br){for(var bn=Qt.length-1;bn>=0;--bn){var gr=Qt[bn],pn=gr(Br);if(!hn(pn)&&!gi(pn)){if(!tn(pn))throw new TypeError;Br=pn}}return Br}function Qe(Qt,Br,bn,gr){for(var pn=Qt.length-1;pn>=0;--pn){var Sn=Qt[pn],Dn=Sn(Br,bn,gr);if(!hn(Dn)&&!gi(Dn)){if(!Dt(Dn))throw new TypeError;gr=Dn}}return gr}function oe(Qt,Br,bn){var gr=pt.get(Qt);if(hn(gr)){if(!bn)return;gr=new me,pt.set(Qt,gr)}var pn=gr.get(Br);if(hn(pn)){if(!bn)return;pn=new me,gr.set(Br,pn)}return pn}function ue(Qt,Br,bn){var gr=be(Qt,Br,bn);if(gr)return!0;var pn=_t(Br);return gi(pn)?!1:ue(Qt,pn,bn)}function be(Qt,Br,bn){var gr=oe(Br,bn,!1);return hn(gr)?!1:ci(gr.has(Qt))}function vt(Qt,Br,bn){var gr=be(Qt,Br,bn);if(gr)return bt(Qt,Br,bn);var pn=_t(Br);if(!gi(pn))return vt(Qt,pn,bn)}function bt(Qt,Br,bn){var gr=oe(Br,bn,!1);if(!hn(gr))return gr.get(Qt)}function Ht(Qt,Br,bn,gr){var pn=oe(bn,gr,!0);pn.set(Qt,Br)}function Er(Qt,Br){var bn=Vt(Qt,Br),gr=_t(Qt);if(gr===null)return bn;var pn=Er(gr,Br);if(pn.length<=0)return bn;if(bn.length<=0)return pn;for(var Sn=new Ge,Dn=[],ui=0,di=bn;ui<di.length;ui++){var ca=di[ui],Ni=Sn.has(ca);Ni||(Sn.add(ca),Dn.push(ca))}for(var Wa=0,Ba=pn;Wa<Ba.length;Wa++){var ca=Ba[Wa],Ni=Sn.has(ca);Ni||(Sn.add(ca),Dn.push(ca))}return Dn}function Vt(Qt,Br){var bn=[],gr=oe(Qt,Br,!1);if(hn(gr))return bn;for(var pn=gr.keys(),Sn=Ai(pn),Dn=0;;){var ui=nt(Sn);if(!ui)return bn.length=Dn,bn;var di=Pr(ui);try{bn[Dn]=di}catch(ca){try{it(Sn)}finally{throw ca}}Dn++}}function on(Qt){if(Qt===null)return 1;switch(typeof Qt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Qt===null?1:6;default:return 6}}function hn(Qt){return Qt===void 0}function gi(Qt){return Qt===null}function Hn(Qt){return typeof Qt=="symbol"}function Dt(Qt){return typeof Qt=="object"?Qt!==null:typeof Qt=="function"}function Ea(Qt,Br){switch(on(Qt)){case 0:return Qt;case 1:return Qt;case 2:return Qt;case 3:return Qt;case 4:return Qt;case 5:return Qt}var bn=Br===3?"string":Br===5?"number":"default",gr=Ii(Qt,W);if(gr!==void 0){var pn=gr.call(Qt,bn);if(Dt(pn))throw new TypeError;return pn}return Ze(Qt,bn==="default"?"number":bn)}function Ze(Qt,Br){if(Br==="string"){var bn=Qt.toString;if(fn(bn)){var gr=bn.call(Qt);if(!Dt(gr))return gr}var pn=Qt.valueOf;if(fn(pn)){var gr=pn.call(Qt);if(!Dt(gr))return gr}}else{var pn=Qt.valueOf;if(fn(pn)){var gr=pn.call(Qt);if(!Dt(gr))return gr}var Sn=Qt.toString;if(fn(Sn)){var gr=Sn.call(Qt);if(!Dt(gr))return gr}}throw new TypeError}function ci(Qt){return!!Qt}function Ci(Qt){return""+Qt}function Oi(Qt){var Br=Ea(Qt,3);return Hn(Br)?Br:Ci(Br)}function ea(Qt){return Array.isArray?Array.isArray(Qt):Qt instanceof Object?Qt instanceof Array:Object.prototype.toString.call(Qt)==="[object Array]"}function fn(Qt){return typeof Qt=="function"}function tn(Qt){return typeof Qt=="function"}function da(Qt){switch(on(Qt)){case 3:return!0;case 4:return!0;default:return!1}}function Ii(Qt,Br){var bn=Qt[Br];if(bn!=null){if(!fn(bn))throw new TypeError;return bn}}function Ai(Qt){var Br=Ii(Qt,Y);if(!fn(Br))throw new TypeError;var bn=Br.call(Qt);if(!Dt(bn))throw new TypeError;return bn}function Pr(Qt){return Qt.value}function nt(Qt){var Br=Qt.next();return Br.done?!1:Br}function it(Qt){var Br=Qt.return;Br&&Br.call(Qt)}function _t(Qt){var Br=Object.getPrototypeOf(Qt);if(typeof Qt!="function"||Qt===Ce||Br!==Ce)return Br;var bn=Qt.prototype,gr=bn&&Object.getPrototypeOf(bn);if(gr==null||gr===Object.prototype)return Br;var pn=gr.constructor;return typeof pn!="function"||pn===Qt?Br:pn}function we(){var Qt={},Br=[],bn=function(){function Dn(ui,di,ca){this._index=0,this._keys=ui,this._values=di,this._selector=ca}return Dn.prototype["@@iterator"]=function(){return this},Dn.prototype[Y]=function(){return this},Dn.prototype.next=function(){var ui=this._index;if(ui>=0&&ui<this._keys.length){var di=this._selector(this._keys[ui],this._values[ui]);return ui+1>=this._keys.length?(this._index=-1,this._keys=Br,this._values=Br):this._index++,{value:di,done:!1}}return{value:void 0,done:!0}},Dn.prototype.throw=function(ui){throw this._index>=0&&(this._index=-1,this._keys=Br,this._values=Br),ui},Dn.prototype.return=function(ui){return this._index>=0&&(this._index=-1,this._keys=Br,this._values=Br),{value:ui,done:!0}},Dn}();return function(){function Dn(){this._keys=[],this._values=[],this._cacheKey=Qt,this._cacheIndex=-2}return Object.defineProperty(Dn.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Dn.prototype.has=function(ui){return this._find(ui,!1)>=0},Dn.prototype.get=function(ui){var di=this._find(ui,!1);return di>=0?this._values[di]:void 0},Dn.prototype.set=function(ui,di){var ca=this._find(ui,!0);return this._values[ca]=di,this},Dn.prototype.delete=function(ui){var di=this._find(ui,!1);if(di>=0){for(var ca=this._keys.length,Ni=di+1;Ni<ca;Ni++)this._keys[Ni-1]=this._keys[Ni],this._values[Ni-1]=this._values[Ni];return this._keys.length--,this._values.length--,ui===this._cacheKey&&(this._cacheKey=Qt,this._cacheIndex=-2),!0}return!1},Dn.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Qt,this._cacheIndex=-2},Dn.prototype.keys=function(){return new bn(this._keys,this._values,gr)},Dn.prototype.values=function(){return new bn(this._keys,this._values,pn)},Dn.prototype.entries=function(){return new bn(this._keys,this._values,Sn)},Dn.prototype["@@iterator"]=function(){return this.entries()},Dn.prototype[Y]=function(){return this.entries()},Dn.prototype._find=function(ui,di){return this._cacheKey!==ui&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=ui)),this._cacheIndex<0&&di&&(this._cacheIndex=this._keys.length,this._keys.push(ui),this._values.push(void 0)),this._cacheIndex},Dn}();function gr(Dn,ui){return Dn}function pn(Dn,ui){return ui}function Sn(Dn,ui){return[Dn,ui]}}function er(){return function(){function Qt(){this._map=new me}return Object.defineProperty(Qt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Qt.prototype.has=function(Br){return this._map.has(Br)},Qt.prototype.add=function(Br){return this._map.set(Br,Br),this},Qt.prototype.delete=function(Br){return this._map.delete(Br)},Qt.prototype.clear=function(){this._map.clear()},Qt.prototype.keys=function(){return this._map.keys()},Qt.prototype.values=function(){return this._map.values()},Qt.prototype.entries=function(){return this._map.entries()},Qt.prototype["@@iterator"]=function(){return this.keys()},Qt.prototype[Y]=function(){return this.keys()},Qt}()}function $r(){var Qt=16,Br=Fe.create(),bn=gr();return function(){function di(){this._key=gr()}return di.prototype.has=function(ca){var Ni=pn(ca,!1);return Ni!==void 0?Fe.has(Ni,this._key):!1},di.prototype.get=function(ca){var Ni=pn(ca,!1);return Ni!==void 0?Fe.get(Ni,this._key):void 0},di.prototype.set=function(ca,Ni){var Wa=pn(ca,!0);return Wa[this._key]=Ni,this},di.prototype.delete=function(ca){var Ni=pn(ca,!1);return Ni!==void 0?delete Ni[this._key]:!1},di.prototype.clear=function(){this._key=gr()},di}();function gr(){var di;do di="@@WeakMap@@"+ui();while(Fe.has(Br,di));return Br[di]=!0,di}function pn(di,ca){if(!F.call(di,bn)){if(!ca)return;Object.defineProperty(di,bn,{value:Fe.create()})}return di[bn]}function Sn(di,ca){for(var Ni=0;Ni<ca;++Ni)di[Ni]=Math.random()*255|0;return di}function Dn(di){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(di)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(di)):Sn(new Uint8Array(di),di):Sn(new Array(di),di)}function ui(){var di=Dn(Qt);di[6]=di[6]&79|64,di[8]=di[8]&191|128;for(var ca="",Ni=0;Ni<Qt;++Ni){var Wa=di[Ni];(Ni===4||Ni===6||Ni===8)&&(ca+="-"),Wa<16&&(ca+="0"),ca+=Wa.toString(16).toLowerCase()}return ca}}function Fn(Qt){return Qt.__=void 0,delete Qt.__,Qt}})})(k||(k={}))},86851:function(Ne,fe,I){"use strict";var D=I(89594),k=Array.prototype.concat,m=Array.prototype.slice,ae=Ne.exports=function(K){for(var W=[],Y=0,G=K.length;Y<G;Y++){var $=K[Y];D($)?W=k.call(W,m.call($)):W.push($)}return W};ae.wrap=function(F){return function(){return F(ae(arguments))}}},89594:function(Ne){Ne.exports=function(I){return!I||typeof I=="string"?!1:I instanceof Array||Array.isArray(I)||I.length>=0&&(I.splice instanceof Function||Object.getOwnPropertyDescriptor(I,I.length-1)&&I.constructor.name!=="String")}},69848:function(Ne){(function(fe,I){Ne.exports=I()})(this,function(){"use strict";function fe(ve,Ae,Re,Ye,at,ht){if(!(at-Ye<=Re)){var Se=Ye+at>>1;I(ve,Ae,Se,Ye,at,ht%2),fe(ve,Ae,Re,Ye,Se-1,ht+1),fe(ve,Ae,Re,Se+1,at,ht+1)}}function I(ve,Ae,Re,Ye,at,ht){for(;at>Ye;){if(at-Ye>600){var Se=at-Ye+1,Qe=Re-Ye+1,oe=Math.log(Se),ue=.5*Math.exp(2*oe/3),be=.5*Math.sqrt(oe*ue*(Se-ue)/Se)*(Qe-Se/2<0?-1:1),vt=Math.max(Ye,Math.floor(Re-Qe*ue/Se+be)),bt=Math.min(at,Math.floor(Re+(Se-Qe)*ue/Se+be));I(ve,Ae,Re,vt,bt,ht)}var Ht=Ae[2*Re+ht],Er=Ye,Vt=at;for(D(ve,Ae,Ye,Re),Ae[2*at+ht]>Ht&&D(ve,Ae,Ye,at);Er<Vt;){for(D(ve,Ae,Er,Vt),Er++,Vt--;Ae[2*Er+ht]<Ht;)Er++;for(;Ae[2*Vt+ht]>Ht;)Vt--}Ae[2*Ye+ht]===Ht?D(ve,Ae,Ye,Vt):(Vt++,D(ve,Ae,Vt,at)),Vt<=Re&&(Ye=Vt+1),Re<=Vt&&(at=Vt-1)}}function D(ve,Ae,Re,Ye){k(ve,Re,Ye),k(Ae,2*Re,2*Ye),k(Ae,2*Re+1,2*Ye+1)}function k(ve,Ae,Re){var Ye=ve[Ae];ve[Ae]=ve[Re],ve[Re]=Ye}function m(ve,Ae,Re,Ye,at,ht,Se){for(var Qe=[0,ve.length-1,0],oe=[],ue,be;Qe.length;){var vt=Qe.pop(),bt=Qe.pop(),Ht=Qe.pop();if(bt-Ht<=Se){for(var Er=Ht;Er<=bt;Er++)ue=Ae[2*Er],be=Ae[2*Er+1],ue>=Re&&ue<=at&&be>=Ye&&be<=ht&&oe.push(ve[Er]);continue}var Vt=Math.floor((Ht+bt)/2);ue=Ae[2*Vt],be=Ae[2*Vt+1],ue>=Re&&ue<=at&&be>=Ye&&be<=ht&&oe.push(ve[Vt]);var on=(vt+1)%2;(vt===0?Re<=ue:Ye<=be)&&(Qe.push(Ht),Qe.push(Vt-1),Qe.push(on)),(vt===0?at>=ue:ht>=be)&&(Qe.push(Vt+1),Qe.push(bt),Qe.push(on))}return oe}function ae(ve,Ae,Re,Ye,at,ht){for(var Se=[0,ve.length-1,0],Qe=[],oe=at*at;Se.length;){var ue=Se.pop(),be=Se.pop(),vt=Se.pop();if(be-vt<=ht){for(var bt=vt;bt<=be;bt++)F(Ae[2*bt],Ae[2*bt+1],Re,Ye)<=oe&&Qe.push(ve[bt]);continue}var Ht=Math.floor((vt+be)/2),Er=Ae[2*Ht],Vt=Ae[2*Ht+1];F(Er,Vt,Re,Ye)<=oe&&Qe.push(ve[Ht]);var on=(ue+1)%2;(ue===0?Re-at<=Er:Ye-at<=Vt)&&(Se.push(vt),Se.push(Ht-1),Se.push(on)),(ue===0?Re+at>=Er:Ye+at>=Vt)&&(Se.push(Ht+1),Se.push(be),Se.push(on))}return Qe}function F(ve,Ae,Re,Ye){var at=ve-Re,ht=Ae-Ye;return at*at+ht*ht}var K=function(ve){return ve[0]},W=function(ve){return ve[1]},Y=function(Ae,Re,Ye,at,ht){Re===void 0&&(Re=K),Ye===void 0&&(Ye=W),at===void 0&&(at=64),ht===void 0&&(ht=Float64Array),this.nodeSize=at,this.points=Ae;for(var Se=Ae.length<65536?Uint16Array:Uint32Array,Qe=this.ids=new Se(Ae.length),oe=this.coords=new ht(Ae.length*2),ue=0;ue<Ae.length;ue++)Qe[ue]=ue,oe[2*ue]=Re(Ae[ue]),oe[2*ue+1]=Ye(Ae[ue]);fe(Qe,oe,at,0,Qe.length-1,0)};Y.prototype.range=function(Ae,Re,Ye,at){return m(this.ids,this.coords,Ae,Re,Ye,at,this.nodeSize)},Y.prototype.within=function(Ae,Re,Ye){return ae(this.ids,this.coords,Ae,Re,Ye,this.nodeSize)};var G={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ve){return ve}},$=Math.fround||function(ve){return function(Ae){return ve[0]=+Ae,ve[0]}}(new Float32Array(1)),xe=function(Ae){this.options=gt(Object.create(G),Ae),this.trees=new Array(this.options.maxZoom+1)};xe.prototype.load=function(Ae){var Re=this.options,Ye=Re.log,at=Re.minZoom,ht=Re.maxZoom,Se=Re.nodeSize;Ye&&console.time("total time");var Qe="prepare "+Ae.length+" points";Ye&&console.time(Qe),this.points=Ae;for(var oe=[],ue=0;ue<Ae.length;ue++)Ae[ue].geometry&&oe.push(Ce(Ae[ue],ue));this.trees[ht+1]=new Y(oe,ie,ft,Se,Float32Array),Ye&&console.timeEnd(Qe);for(var be=ht;be>=at;be--){var vt=+Date.now();oe=this._cluster(oe,be),this.trees[be]=new Y(oe,ie,ft,Se,Float32Array),Ye&&console.log("z%d: %d clusters in %dms",be,oe.length,+Date.now()-vt)}return Ye&&console.timeEnd("total time"),this},xe.prototype.getClusters=function(Ae,Re){var Ye=((Ae[0]+180)%360+360)%360-180,at=Math.max(-90,Math.min(90,Ae[1])),ht=Ae[2]===180?180:((Ae[2]+180)%360+360)%360-180,Se=Math.max(-90,Math.min(90,Ae[3]));if(Ae[2]-Ae[0]>=360)Ye=-180,ht=180;else if(Ye>ht){var Qe=this.getClusters([Ye,at,180,Se],Re),oe=this.getClusters([-180,at,ht,Se],Re);return Qe.concat(oe)}for(var ue=this.trees[this._limitZoom(Re)],be=ue.range(Ge(Ye),Ke(Se),Ge(ht),Ke(at)),vt=[],bt=0,Ht=be;bt<Ht.length;bt+=1){var Er=Ht[bt],Vt=ue.points[Er];vt.push(Vt.numPoints?We(Vt):this.points[Vt.index])}return vt},xe.prototype.getChildren=function(Ae){var Re=this._getOriginId(Ae),Ye=this._getOriginZoom(Ae),at="No cluster with the specified id.",ht=this.trees[Ye];if(!ht)throw new Error(at);var Se=ht.points[Re];if(!Se)throw new Error(at);for(var Qe=this.options.radius/(this.options.extent*Math.pow(2,Ye-1)),oe=ht.within(Se.x,Se.y,Qe),ue=[],be=0,vt=oe;be<vt.length;be+=1){var bt=vt[be],Ht=ht.points[bt];Ht.parentId===Ae&&ue.push(Ht.numPoints?We(Ht):this.points[Ht.index])}if(ue.length===0)throw new Error(at);return ue},xe.prototype.getLeaves=function(Ae,Re,Ye){Re=Re||10,Ye=Ye||0;var at=[];return this._appendLeaves(at,Ae,Re,Ye,0),at},xe.prototype.getTile=function(Ae,Re,Ye){var at=this.trees[this._limitZoom(Ae)],ht=Math.pow(2,Ae),Se=this.options,Qe=Se.extent,oe=Se.radius,ue=oe/Qe,be=(Ye-ue)/ht,vt=(Ye+1+ue)/ht,bt={features:[]};return this._addTileFeatures(at.range((Re-ue)/ht,be,(Re+1+ue)/ht,vt),at.points,Re,Ye,ht,bt),Re===0&&this._addTileFeatures(at.range(1-ue/ht,be,1,vt),at.points,ht,Ye,ht,bt),Re===ht-1&&this._addTileFeatures(at.range(0,be,ue/ht,vt),at.points,-1,Ye,ht,bt),bt.features.length?bt:null},xe.prototype.getClusterExpansionZoom=function(Ae){for(var Re=this._getOriginZoom(Ae)-1;Re<=this.options.maxZoom;){var Ye=this.getChildren(Ae);if(Re++,Ye.length!==1)break;Ae=Ye[0].properties.cluster_id}return Re},xe.prototype._appendLeaves=function(Ae,Re,Ye,at,ht){for(var Se=this.getChildren(Re),Qe=0,oe=Se;Qe<oe.length;Qe+=1){var ue=oe[Qe],be=ue.properties;if(be&&be.cluster?ht+be.point_count<=at?ht+=be.point_count:ht=this._appendLeaves(Ae,be.cluster_id,Ye,at,ht):ht<at?ht++:Ae.push(ue),Ae.length===Ye)break}return ht},xe.prototype._addTileFeatures=function(Ae,Re,Ye,at,ht,Se){for(var Qe=0,oe=Ae;Qe<oe.length;Qe+=1){var ue=oe[Qe],be=Re[ue],vt=be.numPoints,bt=void 0,Ht=void 0,Er=void 0;if(vt)bt=me(be),Ht=be.x,Er=be.y;else{var Vt=this.points[be.index];bt=Vt.properties,Ht=Ge(Vt.geometry.coordinates[0]),Er=Ke(Vt.geometry.coordinates[1])}var on={type:1,geometry:[[Math.round(this.options.extent*(Ht*ht-Ye)),Math.round(this.options.extent*(Er*ht-at))]],tags:bt},hn=void 0;vt?hn=be.id:this.options.generateId?hn=be.index:this.points[be.index].id&&(hn=this.points[be.index].id),hn!==void 0&&(on.id=hn),Se.features.push(on)}},xe.prototype._limitZoom=function(Ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+Ae),this.options.maxZoom+1))},xe.prototype._cluster=function(Ae,Re){for(var Ye=[],at=this.options,ht=at.radius,Se=at.extent,Qe=at.reduce,oe=at.minPoints,ue=ht/(Se*Math.pow(2,Re)),be=0;be<Ae.length;be++){var vt=Ae[be];if(!(vt.zoom<=Re)){vt.zoom=Re;for(var bt=this.trees[Re+1],Ht=bt.within(vt.x,vt.y,ue),Er=vt.numPoints||1,Vt=Er,on=0,hn=Ht;on<hn.length;on+=1){var gi=hn[on],Hn=bt.points[gi];Hn.zoom>Re&&(Vt+=Hn.numPoints||1)}if(Vt>Er&&Vt>=oe){for(var Dt=vt.x*Er,Ea=vt.y*Er,Ze=Qe&&Er>1?this._map(vt,!0):null,ci=(be<<5)+(Re+1)+this.points.length,Ci=0,Oi=Ht;Ci<Oi.length;Ci+=1){var ea=Oi[Ci],fn=bt.points[ea];if(!(fn.zoom<=Re)){fn.zoom=Re;var tn=fn.numPoints||1;Dt+=fn.x*tn,Ea+=fn.y*tn,fn.parentId=ci,Qe&&(Ze||(Ze=this._map(vt,!0)),Qe(Ze,this._map(fn)))}}vt.parentId=ci,Ye.push(Fe(Dt/Vt,Ea/Vt,ci,Vt,Ze))}else if(Ye.push(vt),Vt>1)for(var da=0,Ii=Ht;da<Ii.length;da+=1){var Ai=Ii[da],Pr=bt.points[Ai];Pr.zoom<=Re||(Pr.zoom=Re,Ye.push(Pr))}}}return Ye},xe.prototype._getOriginId=function(Ae){return Ae-this.points.length>>5},xe.prototype._getOriginZoom=function(Ae){return(Ae-this.points.length)%32},xe.prototype._map=function(Ae,Re){if(Ae.numPoints)return Re?gt({},Ae.properties):Ae.properties;var Ye=this.points[Ae.index].properties,at=this.options.map(Ye);return Re&&at===Ye?gt({},at):at};function Fe(ve,Ae,Re,Ye,at){return{x:$(ve),y:$(Ae),zoom:1/0,id:Re,parentId:-1,numPoints:Ye,properties:at}}function Ce(ve,Ae){var Re=ve.geometry.coordinates,Ye=Re[0],at=Re[1];return{x:$(Ge(Ye)),y:$(Ke(at)),zoom:1/0,index:Ae,parentId:-1}}function We(ve){return{type:"Feature",id:ve.id,properties:me(ve),geometry:{type:"Point",coordinates:[pt(ve.x),Xe(ve.y)]}}}function me(ve){var Ae=ve.numPoints,Re=Ae>=1e4?Math.round(Ae/1e3)+"k":Ae>=1e3?Math.round(Ae/100)/10+"k":Ae;return gt(gt({},ve.properties),{cluster:!0,cluster_id:ve.id,point_count:Ae,point_count_abbreviated:Re})}function Ge(ve){return ve/360+.5}function Ke(ve){var Ae=Math.sin(ve*Math.PI/180),Re=.5-.25*Math.log((1+Ae)/(1-Ae))/Math.PI;return Re<0?0:Re>1?1:Re}function pt(ve){return(ve-.5)*360}function Xe(ve){var Ae=(180-ve*360)*Math.PI/180;return 360*Math.atan(Math.exp(Ae))/Math.PI-90}function gt(ve,Ae){for(var Re in Ae)ve[Re]=Ae[Re];return ve}function ie(ve){return ve.x}function ft(ve){return ve.y}return xe})},17061:function(Ne,fe,I){var D=I(18698).default;function k(){"use strict";Ne.exports=k=function(){return m},Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports;var m={},ae=Object.prototype,F=ae.hasOwnProperty,K=Object.defineProperty||function(oe,ue,be){oe[ue]=be.value},W=typeof Symbol=="function"?Symbol:{},Y=W.iterator||"@@iterator",G=W.asyncIterator||"@@asyncIterator",$=W.toStringTag||"@@toStringTag";function xe(oe,ue,be){return Object.defineProperty(oe,ue,{value:be,enumerable:!0,configurable:!0,writable:!0}),oe[ue]}try{xe({},"")}catch(oe){xe=function(be,vt,bt){return be[vt]=bt}}function Fe(oe,ue,be,vt){var bt=ue&&ue.prototype instanceof me?ue:me,Ht=Object.create(bt.prototype),Er=new ht(vt||[]);return K(Ht,"_invoke",{value:Ae(oe,be,Er)}),Ht}function Ce(oe,ue,be){try{return{type:"normal",arg:oe.call(ue,be)}}catch(vt){return{type:"throw",arg:vt}}}m.wrap=Fe;var We={};function me(){}function Ge(){}function Ke(){}var pt={};xe(pt,Y,function(){return this});var Xe=Object.getPrototypeOf,gt=Xe&&Xe(Xe(Se([])));gt&&gt!==ae&&F.call(gt,Y)&&(pt=gt);var ie=Ke.prototype=me.prototype=Object.create(pt);function ft(oe){["next","throw","return"].forEach(function(ue){xe(oe,ue,function(be){return this._invoke(ue,be)})})}function ve(oe,ue){function be(bt,Ht,Er,Vt){var on=Ce(oe[bt],oe,Ht);if(on.type!=="throw"){var hn=on.arg,gi=hn.value;return gi&&D(gi)=="object"&&F.call(gi,"__await")?ue.resolve(gi.__await).then(function(Hn){be("next",Hn,Er,Vt)},function(Hn){be("throw",Hn,Er,Vt)}):ue.resolve(gi).then(function(Hn){hn.value=Hn,Er(hn)},function(Hn){return be("throw",Hn,Er,Vt)})}Vt(on.arg)}var vt;K(this,"_invoke",{value:function(Ht,Er){function Vt(){return new ue(function(on,hn){be(Ht,Er,on,hn)})}return vt=vt?vt.then(Vt,Vt):Vt()}})}function Ae(oe,ue,be){var vt="suspendedStart";return function(bt,Ht){if(vt==="executing")throw new Error("Generator is already running");if(vt==="completed"){if(bt==="throw")throw Ht;return Qe()}for(be.method=bt,be.arg=Ht;;){var Er=be.delegate;if(Er){var Vt=Re(Er,be);if(Vt){if(Vt===We)continue;return Vt}}if(be.method==="next")be.sent=be._sent=be.arg;else if(be.method==="throw"){if(vt==="suspendedStart")throw vt="completed",be.arg;be.dispatchException(be.arg)}else be.method==="return"&&be.abrupt("return",be.arg);vt="executing";var on=Ce(oe,ue,be);if(on.type==="normal"){if(vt=be.done?"completed":"suspendedYield",on.arg===We)continue;return{value:on.arg,done:be.done}}on.type==="throw"&&(vt="completed",be.method="throw",be.arg=on.arg)}}}function Re(oe,ue){var be=ue.method,vt=oe.iterator[be];if(vt===void 0)return ue.delegate=null,be==="throw"&&oe.iterator.return&&(ue.method="return",ue.arg=void 0,Re(oe,ue),ue.method==="throw")||be!=="return"&&(ue.method="throw",ue.arg=new TypeError("The iterator does not provide a '"+be+"' method")),We;var bt=Ce(vt,oe.iterator,ue.arg);if(bt.type==="throw")return ue.method="throw",ue.arg=bt.arg,ue.delegate=null,We;var Ht=bt.arg;return Ht?Ht.done?(ue[oe.resultName]=Ht.value,ue.next=oe.nextLoc,ue.method!=="return"&&(ue.method="next",ue.arg=void 0),ue.delegate=null,We):Ht:(ue.method="throw",ue.arg=new TypeError("iterator result is not an object"),ue.delegate=null,We)}function Ye(oe){var ue={tryLoc:oe[0]};1 in oe&&(ue.catchLoc=oe[1]),2 in oe&&(ue.finallyLoc=oe[2],ue.afterLoc=oe[3]),this.tryEntries.push(ue)}function at(oe){var ue=oe.completion||{};ue.type="normal",delete ue.arg,oe.completion=ue}function ht(oe){this.tryEntries=[{tryLoc:"root"}],oe.forEach(Ye,this),this.reset(!0)}function Se(oe){if(oe){var ue=oe[Y];if(ue)return ue.call(oe);if(typeof oe.next=="function")return oe;if(!isNaN(oe.length)){var be=-1,vt=function bt(){for(;++be<oe.length;)if(F.call(oe,be))return bt.value=oe[be],bt.done=!1,bt;return bt.value=void 0,bt.done=!0,bt};return vt.next=vt}}return{next:Qe}}function Qe(){return{value:void 0,done:!0}}return Ge.prototype=Ke,K(ie,"constructor",{value:Ke,configurable:!0}),K(Ke,"constructor",{value:Ge,configurable:!0}),Ge.displayName=xe(Ke,$,"GeneratorFunction"),m.isGeneratorFunction=function(oe){var ue=typeof oe=="function"&&oe.constructor;return!!ue&&(ue===Ge||(ue.displayName||ue.name)==="GeneratorFunction")},m.mark=function(oe){return Object.setPrototypeOf?Object.setPrototypeOf(oe,Ke):(oe.__proto__=Ke,xe(oe,$,"GeneratorFunction")),oe.prototype=Object.create(ie),oe},m.awrap=function(oe){return{__await:oe}},ft(ve.prototype),xe(ve.prototype,G,function(){return this}),m.AsyncIterator=ve,m.async=function(oe,ue,be,vt,bt){bt===void 0&&(bt=Promise);var Ht=new ve(Fe(oe,ue,be,vt),bt);return m.isGeneratorFunction(ue)?Ht:Ht.next().then(function(Er){return Er.done?Er.value:Ht.next()})},ft(ie),xe(ie,$,"Generator"),xe(ie,Y,function(){return this}),xe(ie,"toString",function(){return"[object Generator]"}),m.keys=function(oe){var ue=Object(oe),be=[];for(var vt in ue)be.push(vt);return be.reverse(),function bt(){for(;be.length;){var Ht=be.pop();if(Ht in ue)return bt.value=Ht,bt.done=!1,bt}return bt.done=!0,bt}},m.values=Se,ht.prototype={constructor:ht,reset:function(ue){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(at),!ue)for(var be in this)be.charAt(0)==="t"&&F.call(this,be)&&!isNaN(+be.slice(1))&&(this[be]=void 0)},stop:function(){this.done=!0;var ue=this.tryEntries[0].completion;if(ue.type==="throw")throw ue.arg;return this.rval},dispatchException:function(ue){if(this.done)throw ue;var be=this;function vt(hn,gi){return Er.type="throw",Er.arg=ue,be.next=hn,gi&&(be.method="next",be.arg=void 0),!!gi}for(var bt=this.tryEntries.length-1;bt>=0;--bt){var Ht=this.tryEntries[bt],Er=Ht.completion;if(Ht.tryLoc==="root")return vt("end");if(Ht.tryLoc<=this.prev){var Vt=F.call(Ht,"catchLoc"),on=F.call(Ht,"finallyLoc");if(Vt&&on){if(this.prev<Ht.catchLoc)return vt(Ht.catchLoc,!0);if(this.prev<Ht.finallyLoc)return vt(Ht.finallyLoc)}else if(Vt){if(this.prev<Ht.catchLoc)return vt(Ht.catchLoc,!0)}else{if(!on)throw new Error("try statement without catch or finally");if(this.prev<Ht.finallyLoc)return vt(Ht.finallyLoc)}}}},abrupt:function(ue,be){for(var vt=this.tryEntries.length-1;vt>=0;--vt){var bt=this.tryEntries[vt];if(bt.tryLoc<=this.prev&&F.call(bt,"finallyLoc")&&this.prev<bt.finallyLoc){var Ht=bt;break}}Ht&&(ue==="break"||ue==="continue")&&Ht.tryLoc<=be&&be<=Ht.finallyLoc&&(Ht=null);var Er=Ht?Ht.completion:{};return Er.type=ue,Er.arg=be,Ht?(this.method="next",this.next=Ht.finallyLoc,We):this.complete(Er)},complete:function(ue,be){if(ue.type==="throw")throw ue.arg;return ue.type==="break"||ue.type==="continue"?this.next=ue.arg:ue.type==="return"?(this.rval=this.arg=ue.arg,this.method="return",this.next="end"):ue.type==="normal"&&be&&(this.next=be),We},finish:function(ue){for(var be=this.tryEntries.length-1;be>=0;--be){var vt=this.tryEntries[be];if(vt.finallyLoc===ue)return this.complete(vt.completion,vt.afterLoc),at(vt),We}},catch:function(ue){for(var be=this.tryEntries.length-1;be>=0;--be){var vt=this.tryEntries[be];if(vt.tryLoc===ue){var bt=vt.completion;if(bt.type==="throw"){var Ht=bt.arg;at(vt)}return Ht}}throw new Error("illegal catch attempt")},delegateYield:function(ue,be,vt){return this.delegate={iterator:Se(ue),resultName:be,nextLoc:vt},this.method==="next"&&(this.arg=void 0),We}},m}Ne.exports=k,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},18698:function(Ne){function fe(I){return Ne.exports=fe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports,fe(I)}Ne.exports=fe,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},64687:function(Ne,fe,I){var D=I(17061)();Ne.exports=D;try{regeneratorRuntime=D}catch(k){typeof globalThis=="object"?globalThis.regeneratorRuntime=D:Function("r","regeneratorRuntime = r")(D)}},96446:function(Ne,fe,I){var D=I(37923);function k(m){if(Array.isArray(m))return D(m)}Ne.exports=k,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},25098:function(Ne){function fe(I){if(I===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I}Ne.exports=fe,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},12444:function(Ne){function fe(I,D){if(!(I instanceof D))throw new TypeError("Cannot call a class as a function")}Ne.exports=fe,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},72004:function(Ne,fe,I){var D=I(51883);function k(ae,F){for(var K=0;K<F.length;K++){var W=F[K];W.enumerable=W.enumerable||!1,W.configurable=!0,"value"in W&&(W.writable=!0),Object.defineProperty(ae,D(W.key),W)}}function m(ae,F,K){return F&&k(ae.prototype,F),K&&k(ae,K),Object.defineProperty(ae,"prototype",{writable:!1}),ae}Ne.exports=m,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},96695:function(Ne,fe,I){var D=I(96263);function k(m,ae){var F=typeof Symbol!="undefined"&&m[Symbol.iterator]||m["@@iterator"];if(!F){if(Array.isArray(m)||(F=D(m))||ae&&m&&typeof m.length=="number"){F&&(m=F);var K=0,W=function(){};return{s:W,n:function(){return K>=m.length?{done:!0}:{done:!1,value:m[K++]}},e:function(Fe){throw Fe},f:W}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Y=!0,G=!1,$;return{s:function(){F=F.call(m)},n:function(){var Fe=F.next();return Y=Fe.done,Fe},e:function(Fe){G=!0,$=Fe},f:function(){try{!Y&&F.return!=null&&F.return()}finally{if(G)throw $}}}}Ne.exports=k,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},26037:function(Ne,fe,I){var D=I(48374),k=I(21771),m=I(73408);function ae(F){var K=k();return function(){var Y=D(F),G;if(K){var $=D(this).constructor;G=Reflect.construct(Y,arguments,$)}else G=Y.apply(this,arguments);return m(this,G)}}Ne.exports=ae,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},48374:function(Ne){function fe(I){return Ne.exports=fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(k){return k.__proto__||Object.getPrototypeOf(k)},Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports,fe(I)}Ne.exports=fe,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},31996:function(Ne,fe,I){var D=I(21314);function k(m,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(ae&&ae.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),Object.defineProperty(m,"prototype",{writable:!1}),ae&&D(m,ae)}Ne.exports=k,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},21771:function(Ne){function fe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(I){return!1}}Ne.exports=fe,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},96936:function(Ne){function fe(I){if(typeof Symbol!="undefined"&&I[Symbol.iterator]!=null||I["@@iterator"]!=null)return Array.from(I)}Ne.exports=fe,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},88619:function(Ne){function fe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}Ne.exports=fe,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},73408:function(Ne,fe,I){var D=I(52677).default,k=I(25098);function m(ae,F){if(F&&(D(F)==="object"||typeof F=="function"))return F;if(F!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k(ae)}Ne.exports=m,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},21314:function(Ne){function fe(I,D){return Ne.exports=fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(m,ae){return m.__proto__=ae,m},Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports,fe(I,D)}Ne.exports=fe,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},19632:function(Ne,fe,I){var D=I(96446),k=I(96936),m=I(96263),ae=I(88619);function F(K){return D(K)||k(K)||m(K)||ae()}Ne.exports=F,Ne.exports.__esModule=!0,Ne.exports.default=Ne.exports},84506:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return F}});var D=I(83878),k=I(59199),m=I(40181),ae=I(25267);function F(K){return(0,D.Z)(K)||(0,k.Z)(K)||(0,m.Z)(K)||(0,ae.Z)()}},1449:function(Ne,fe,I){"use strict";I.d(fe,{DL:function(){return Xe},Ht:function(){return Ae},Kn:function(){return ht},Tu:function(){return xe},tw:function(){return Ge},uf:function(){return Ce},vi:function(){return ve},yu:function(){return G},zL:function(){return F}});var D=63710088e-1,k={centimeters:D*100,centimetres:D*100,degrees:D/111325,feet:D*3.28084,inches:D*39.37,kilometers:D/1e3,kilometres:D/1e3,meters:D,metres:D,miles:D/1609.344,millimeters:D*1e3,millimetres:D*1e3,nauticalmiles:D/1852,radians:1,yards:D*1.0936},m={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/D,yards:1.0936133},ae={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function F(oe,ue,be){be===void 0&&(be={});var vt={type:"Feature"};return(be.id===0||be.id)&&(vt.id=be.id),be.bbox&&(vt.bbox=be.bbox),vt.properties=ue||{},vt.geometry=oe,vt}function K(oe,ue,be){switch(be===void 0&&(be={}),oe){case"Point":return W(ue).geometry;case"LineString":return xe(ue).geometry;case"Polygon":return G(ue).geometry;case"MultiPoint":return me(ue).geometry;case"MultiLineString":return We(ue).geometry;case"MultiPolygon":return Ge(ue).geometry;default:throw new Error(oe+" is invalid")}}function W(oe,ue,be){if(be===void 0&&(be={}),!oe)throw new Error("coordinates is required");if(!Array.isArray(oe))throw new Error("coordinates must be an Array");if(oe.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!at(oe[0])||!at(oe[1]))throw new Error("coordinates must contain numbers");var vt={type:"Point",coordinates:oe};return F(vt,ue,be)}function Y(oe,ue,be){return be===void 0&&(be={}),Ce(oe.map(function(vt){return W(vt,ue)}),be)}function G(oe,ue,be){be===void 0&&(be={});for(var vt=0,bt=oe;vt<bt.length;vt++){var Ht=bt[vt];if(Ht.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Er=0;Er<Ht[Ht.length-1].length;Er++)if(Ht[Ht.length-1][Er]!==Ht[0][Er])throw new Error("First and last Position are not equivalent.")}var Vt={type:"Polygon",coordinates:oe};return F(Vt,ue,be)}function $(oe,ue,be){return be===void 0&&(be={}),Ce(oe.map(function(vt){return G(vt,ue)}),be)}function xe(oe,ue,be){if(be===void 0&&(be={}),oe.length<2)throw new Error("coordinates must be an array of two or more positions");var vt={type:"LineString",coordinates:oe};return F(vt,ue,be)}function Fe(oe,ue,be){return be===void 0&&(be={}),Ce(oe.map(function(vt){return xe(vt,ue)}),be)}function Ce(oe,ue){ue===void 0&&(ue={});var be={type:"FeatureCollection"};return ue.id&&(be.id=ue.id),ue.bbox&&(be.bbox=ue.bbox),be.features=oe,be}function We(oe,ue,be){be===void 0&&(be={});var vt={type:"MultiLineString",coordinates:oe};return F(vt,ue,be)}function me(oe,ue,be){be===void 0&&(be={});var vt={type:"MultiPoint",coordinates:oe};return F(vt,ue,be)}function Ge(oe,ue,be){be===void 0&&(be={});var vt={type:"MultiPolygon",coordinates:oe};return F(vt,ue,be)}function Ke(oe,ue,be){be===void 0&&(be={});var vt={type:"GeometryCollection",geometries:oe};return F(vt,ue,be)}function pt(oe,ue){if(ue===void 0&&(ue=0),ue&&!(ue>=0))throw new Error("precision must be a positive number");var be=Math.pow(10,ue||0);return Math.round(oe*be)/be}function Xe(oe,ue){ue===void 0&&(ue="kilometers");var be=k[ue];if(!be)throw new Error(ue+" units is invalid");return oe*be}function gt(oe,ue){ue===void 0&&(ue="kilometers");var be=k[ue];if(!be)throw new Error(ue+" units is invalid");return oe/be}function ie(oe,ue){return ve(gt(oe,ue))}function ft(oe){var ue=oe%360;return ue<0&&(ue+=360),ue}function ve(oe){var ue=oe%(2*Math.PI);return ue*180/Math.PI}function Ae(oe){var ue=oe%360;return ue*Math.PI/180}function Re(oe,ue,be){if(ue===void 0&&(ue="kilometers"),be===void 0&&(be="kilometers"),!(oe>=0))throw new Error("length must be a positive number");return Xe(gt(oe,ue),be)}function Ye(oe,ue,be){if(ue===void 0&&(ue="meters"),be===void 0&&(be="kilometers"),!(oe>=0))throw new Error("area must be a positive number");var vt=ae[ue];if(!vt)throw new Error("invalid original units");var bt=ae[be];if(!bt)throw new Error("invalid final units");return oe/vt*bt}function at(oe){return!isNaN(oe)&&oe!==null&&!Array.isArray(oe)}function ht(oe){return!!oe&&oe.constructor===Object}function Se(oe){if(!oe)throw new Error("bbox is required");if(!Array.isArray(oe))throw new Error("bbox must be an Array");if(oe.length!==4&&oe.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");oe.forEach(function(ue){if(!at(ue))throw new Error("bbox must only contain numbers")})}function Qe(oe){if(!oe)throw new Error("id is required");if(["string","number"].indexOf(typeof oe)===-1)throw new Error("id must be a number or a string")}},36987:function(Ne,fe,I){"use strict";I.d(fe,{oL:function(){return G},r7:function(){return m},wA:function(){return Y}});var D=I(1449);function k($){if(!$)throw new Error("coord is required");if(!Array.isArray($)){if($.type==="Feature"&&$.geometry!==null&&$.geometry.type==="Point")return $.geometry.coordinates;if($.type==="Point")return $.coordinates}if(Array.isArray($)&&$.length>=2&&!Array.isArray($[0])&&!Array.isArray($[1]))return $;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function m($){if(Array.isArray($))return $;if($.type==="Feature"){if($.geometry!==null)return $.geometry.coordinates}else if($.coordinates)return $.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ae($){if($.length>1&&isNumber($[0])&&isNumber($[1]))return!0;if(Array.isArray($[0])&&$[0].length)return ae($[0]);throw new Error("coordinates must only contain numbers")}function F($,xe,Fe){if(!xe||!Fe)throw new Error("type and name required");if(!$||$.type!==xe)throw new Error("Invalid input to "+Fe+": must be a "+xe+", given "+$.type)}function K($,xe,Fe){if(!$)throw new Error("No feature passed");if(!Fe)throw new Error(".featureOf() requires a name");if(!$||$.type!=="Feature"||!$.geometry)throw new Error("Invalid input to "+Fe+", Feature with geometry required");if(!$.geometry||$.geometry.type!==xe)throw new Error("Invalid input to "+Fe+": must be a "+xe+", given "+$.geometry.type)}function W($,xe,Fe){if(!$)throw new Error("No featureCollection passed");if(!Fe)throw new Error(".collectionOf() requires a name");if(!$||$.type!=="FeatureCollection")throw new Error("Invalid input to "+Fe+", FeatureCollection required");for(var Ce=0,We=$.features;Ce<We.length;Ce++){var me=We[Ce];if(!me||me.type!=="Feature"||!me.geometry)throw new Error("Invalid input to "+Fe+", Feature with geometry required");if(!me.geometry||me.geometry.type!==xe)throw new Error("Invalid input to "+Fe+": must be a "+xe+", given "+me.geometry.type)}}function Y($){return $.type==="Feature"?$.geometry:$}function G($,xe){return $.type==="FeatureCollection"?"FeatureCollection":$.type==="GeometryCollection"?"GeometryCollection":$.type==="Feature"&&$.geometry!==null?$.geometry.type:$.type}},39034:function(Ne,fe,I){"use strict";I.d(fe,{nG:function(){return xe},on:function(){return G},pZ:function(){return k}});var D=I(1449);function k(Xe,gt,ie){if(Xe!==null)for(var ft,ve,Ae,Re,Ye,at,ht,Se=0,Qe=0,oe,ue=Xe.type,be=ue==="FeatureCollection",vt=ue==="Feature",bt=be?Xe.features.length:1,Ht=0;Ht<bt;Ht++){ht=be?Xe.features[Ht].geometry:vt?Xe.geometry:Xe,oe=ht?ht.type==="GeometryCollection":!1,Ye=oe?ht.geometries.length:1;for(var Er=0;Er<Ye;Er++){var Vt=0,on=0;if(Re=oe?ht.geometries[Er]:ht,Re!==null){at=Re.coordinates;var hn=Re.type;switch(Se=ie&&(hn==="Polygon"||hn==="MultiPolygon")?1:0,hn){case null:break;case"Point":if(gt(at,Qe,Ht,Vt,on)===!1)return!1;Qe++,Vt++;break;case"LineString":case"MultiPoint":for(ft=0;ft<at.length;ft++){if(gt(at[ft],Qe,Ht,Vt,on)===!1)return!1;Qe++,hn==="MultiPoint"&&Vt++}hn==="LineString"&&Vt++;break;case"Polygon":case"MultiLineString":for(ft=0;ft<at.length;ft++){for(ve=0;ve<at[ft].length-Se;ve++){if(gt(at[ft][ve],Qe,Ht,Vt,on)===!1)return!1;Qe++}hn==="MultiLineString"&&Vt++,hn==="Polygon"&&on++}hn==="Polygon"&&Vt++;break;case"MultiPolygon":for(ft=0;ft<at.length;ft++){for(on=0,ve=0;ve<at[ft].length;ve++){for(Ae=0;Ae<at[ft][ve].length-Se;Ae++){if(gt(at[ft][ve][Ae],Qe,Ht,Vt,on)===!1)return!1;Qe++}on++}Vt++}break;case"GeometryCollection":for(ft=0;ft<Re.geometries.length;ft++)if(k(Re.geometries[ft],gt,ie)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function m(Xe,gt,ie,ft){var ve=ie;return k(Xe,function(Ae,Re,Ye,at,ht){Re===0&&ie===void 0?ve=Ae:ve=gt(ve,Ae,Re,Ye,at,ht)},ft),ve}function ae(Xe,gt){var ie;switch(Xe.type){case"FeatureCollection":for(ie=0;ie<Xe.features.length&&gt(Xe.features[ie].properties,ie)!==!1;ie++);break;case"Feature":gt(Xe.properties,0);break}}function F(Xe,gt,ie){var ft=ie;return ae(Xe,function(ve,Ae){Ae===0&&ie===void 0?ft=ve:ft=gt(ft,ve,Ae)}),ft}function K(Xe,gt){if(Xe.type==="Feature")gt(Xe,0);else if(Xe.type==="FeatureCollection")for(var ie=0;ie<Xe.features.length&&gt(Xe.features[ie],ie)!==!1;ie++);}function W(Xe,gt,ie){var ft=ie;return K(Xe,function(ve,Ae){Ae===0&&ie===void 0?ft=ve:ft=gt(ft,ve,Ae)}),ft}function Y(Xe){var gt=[];return k(Xe,function(ie){gt.push(ie)}),gt}function G(Xe,gt){var ie,ft,ve,Ae,Re,Ye,at,ht,Se,Qe,oe=0,ue=Xe.type==="FeatureCollection",be=Xe.type==="Feature",vt=ue?Xe.features.length:1;for(ie=0;ie<vt;ie++){for(Ye=ue?Xe.features[ie].geometry:be?Xe.geometry:Xe,ht=ue?Xe.features[ie].properties:be?Xe.properties:{},Se=ue?Xe.features[ie].bbox:be?Xe.bbox:void 0,Qe=ue?Xe.features[ie].id:be?Xe.id:void 0,at=Ye?Ye.type==="GeometryCollection":!1,Re=at?Ye.geometries.length:1,ve=0;ve<Re;ve++){if(Ae=at?Ye.geometries[ve]:Ye,Ae===null){if(gt(null,oe,ht,Se,Qe)===!1)return!1;continue}switch(Ae.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(gt(Ae,oe,ht,Se,Qe)===!1)return!1;break}case"GeometryCollection":{for(ft=0;ft<Ae.geometries.length;ft++)if(gt(Ae.geometries[ft],oe,ht,Se,Qe)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}oe++}}function $(Xe,gt,ie){var ft=ie;return G(Xe,function(ve,Ae,Re,Ye,at){Ae===0&&ie===void 0?ft=ve:ft=gt(ft,ve,Ae,Re,Ye,at)}),ft}function xe(Xe,gt){G(Xe,function(ie,ft,ve,Ae,Re){var Ye=ie===null?null:ie.type;switch(Ye){case null:case"Point":case"LineString":case"Polygon":return gt((0,D.zL)(ie,ve,{bbox:Ae,id:Re}),ft,0)===!1?!1:void 0}var at;switch(Ye){case"MultiPoint":at="Point";break;case"MultiLineString":at="LineString";break;case"MultiPolygon":at="Polygon";break}for(var ht=0;ht<ie.coordinates.length;ht++){var Se=ie.coordinates[ht],Qe={type:at,coordinates:Se};if(gt((0,D.zL)(Qe,ve),ft,ht)===!1)return!1}})}function Fe(Xe,gt,ie){var ft=ie;return xe(Xe,function(ve,Ae,Re){Ae===0&&Re===0&&ie===void 0?ft=ve:ft=gt(ft,ve,Ae,Re)}),ft}function Ce(Xe,gt){xe(Xe,function(ie,ft,ve){var Ae=0;if(ie.geometry){var Re=ie.geometry.type;if(!(Re==="Point"||Re==="MultiPoint")){var Ye,at=0,ht=0,Se=0;if(k(ie,function(Qe,oe,ue,be,vt){if(Ye===void 0||ft>at||be>ht||vt>Se){Ye=Qe,at=ft,ht=be,Se=vt,Ae=0;return}var bt=lineString([Ye,Qe],ie.properties);if(gt(bt,ft,ve,vt,Ae)===!1)return!1;Ae++,Ye=Qe})===!1)return!1}}})}function We(Xe,gt,ie){var ft=ie,ve=!1;return Ce(Xe,function(Ae,Re,Ye,at,ht){ve===!1&&ie===void 0?ft=Ae:ft=gt(ft,Ae,Re,Ye,at,ht),ve=!0}),ft}function me(Xe,gt){if(!Xe)throw new Error("geojson is required");xe(Xe,function(ie,ft,ve){if(ie.geometry!==null){var Ae=ie.geometry.type,Re=ie.geometry.coordinates;switch(Ae){case"LineString":if(gt(ie,ft,ve,0,0)===!1)return!1;break;case"Polygon":for(var Ye=0;Ye<Re.length;Ye++)if(gt(lineString(Re[Ye],ie.properties),ft,ve,Ye)===!1)return!1;break}}})}function Ge(Xe,gt,ie){var ft=ie;return me(Xe,function(ve,Ae,Re,Ye){Ae===0&&ie===void 0?ft=ve:ft=gt(ft,ve,Ae,Re,Ye)}),ft}function Ke(Xe,gt){if(gt=gt||{},!isObject(gt))throw new Error("options is invalid");var ie=gt.featureIndex||0,ft=gt.multiFeatureIndex||0,ve=gt.geometryIndex||0,Ae=gt.segmentIndex||0,Re=gt.properties,Ye;switch(Xe.type){case"FeatureCollection":ie<0&&(ie=Xe.features.length+ie),Re=Re||Xe.features[ie].properties,Ye=Xe.features[ie].geometry;break;case"Feature":Re=Re||Xe.properties,Ye=Xe.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ye=Xe;break;default:throw new Error("geojson is invalid")}if(Ye===null)return null;var at=Ye.coordinates;switch(Ye.type){case"Point":case"MultiPoint":return null;case"LineString":return Ae<0&&(Ae=at.length+Ae-1),lineString([at[Ae],at[Ae+1]],Re,gt);case"Polygon":return ve<0&&(ve=at.length+ve),Ae<0&&(Ae=at[ve].length+Ae-1),lineString([at[ve][Ae],at[ve][Ae+1]],Re,gt);case"MultiLineString":return ft<0&&(ft=at.length+ft),Ae<0&&(Ae=at[ft].length+Ae-1),lineString([at[ft][Ae],at[ft][Ae+1]],Re,gt);case"MultiPolygon":return ft<0&&(ft=at.length+ft),ve<0&&(ve=at[ft].length+ve),Ae<0&&(Ae=at[ft][ve].length-Ae-1),lineString([at[ft][ve][Ae],at[ft][ve][Ae+1]],Re,gt)}throw new Error("geojson is invalid")}function pt(Xe,gt){if(gt=gt||{},!isObject(gt))throw new Error("options is invalid");var ie=gt.featureIndex||0,ft=gt.multiFeatureIndex||0,ve=gt.geometryIndex||0,Ae=gt.coordIndex||0,Re=gt.properties,Ye;switch(Xe.type){case"FeatureCollection":ie<0&&(ie=Xe.features.length+ie),Re=Re||Xe.features[ie].properties,Ye=Xe.features[ie].geometry;break;case"Feature":Re=Re||Xe.properties,Ye=Xe.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ye=Xe;break;default:throw new Error("geojson is invalid")}if(Ye===null)return null;var at=Ye.coordinates;switch(Ye.type){case"Point":return point(at,Re,gt);case"MultiPoint":return ft<0&&(ft=at.length+ft),point(at[ft],Re,gt);case"LineString":return Ae<0&&(Ae=at.length+Ae),point(at[Ae],Re,gt);case"Polygon":return ve<0&&(ve=at.length+ve),Ae<0&&(Ae=at[ve].length+Ae),point(at[ve][Ae],Re,gt);case"MultiLineString":return ft<0&&(ft=at.length+ft),Ae<0&&(Ae=at[ft].length+Ae),point(at[ft][Ae],Re,gt);case"MultiPolygon":return ft<0&&(ft=at.length+ft),ve<0&&(ve=at[ft].length+ve),Ae<0&&(Ae=at[ft][ve].length-Ae),point(at[ft][ve][Ae],Re,gt)}throw new Error("geojson is invalid")}},13365:function(Ne,fe,I){"use strict";I.d(fe,{Z:function(){return at}});var D=I(1449),k=I(36987);function m(ht,Se){Se===void 0&&(Se={});var Qe=typeof Se=="object"?Se.mutate:Se;if(!ht)throw new Error("geojson is required");var oe=(0,k.oL)(ht),ue=[];switch(oe){case"LineString":ue=ae(ht);break;case"MultiLineString":case"Polygon":(0,k.r7)(ht).forEach(function(vt){ue.push(ae(vt))});break;case"MultiPolygon":(0,k.r7)(ht).forEach(function(vt){var bt=[];vt.forEach(function(Ht){bt.push(ae(Ht))}),ue.push(bt)});break;case"Point":return ht;case"MultiPoint":var be={};(0,k.r7)(ht).forEach(function(vt){var bt=vt.join("-");Object.prototype.hasOwnProperty.call(be,bt)||(ue.push(vt),be[bt]=!0)});break;default:throw new Error(oe+" geometry not supported")}return ht.coordinates?Qe===!0?(ht.coordinates=ue,ht):{type:oe,coordinates:ue}:Qe===!0?(ht.geometry.coordinates=ue,ht):(0,D.zL)({type:oe,coordinates:ue},ht.properties,{bbox:ht.bbox,id:ht.id})}function ae(ht){var Se=(0,k.r7)(ht);if(Se.length===2&&!F(Se[0],Se[1]))return Se;var Qe=[],oe=Se.length-1,ue=Qe.length;Qe.push(Se[0]);for(var be=1;be<oe;be++){var vt=Qe[Qe.length-1];Se[be][0]===vt[0]&&Se[be][1]===vt[1]||(Qe.push(Se[be]),ue=Qe.length,ue>2&&K(Qe[ue-3],Qe[ue-1],Qe[ue-2])&&Qe.splice(Qe.length-2,1))}if(Qe.push(Se[Se.length-1]),ue=Qe.length,F(Se[0],Se[Se.length-1])&&ue<4)throw new Error("invalid polygon");return K(Qe[ue-3],Qe[ue-1],Qe[ue-2])&&Qe.splice(Qe.length-2,1),Qe}function F(ht,Se){return ht[0]===Se[0]&&ht[1]===Se[1]}function K(ht,Se,Qe){var oe=Qe[0],ue=Qe[1],be=ht[0],vt=ht[1],bt=Se[0],Ht=Se[1],Er=oe-be,Vt=ue-vt,on=bt-be,hn=Ht-vt,gi=Er*hn-Vt*on;return gi!==0?!1:Math.abs(on)>=Math.abs(hn)?on>0?be<=oe&&oe<=bt:bt<=oe&&oe<=be:hn>0?vt<=ue&&ue<=Ht:Ht<=ue&&ue<=vt}var W=m;function Y(ht){if(!ht)throw new Error("geojson is required");switch(ht.type){case"Feature":return G(ht);case"FeatureCollection":return xe(ht);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Fe(ht);default:throw new Error("unknown GeoJSON type")}}function G(ht){var Se={type:"Feature"};return Object.keys(ht).forEach(function(Qe){switch(Qe){case"type":case"properties":case"geometry":return;default:Se[Qe]=ht[Qe]}}),Se.properties=$(ht.properties),Se.geometry=Fe(ht.geometry),Se}function $(ht){var Se={};return ht&&Object.keys(ht).forEach(function(Qe){var oe=ht[Qe];typeof oe=="object"?oe===null?Se[Qe]=null:Array.isArray(oe)?Se[Qe]=oe.map(function(ue){return ue}):Se[Qe]=$(oe):Se[Qe]=oe}),Se}function xe(ht){var Se={type:"FeatureCollection"};return Object.keys(ht).forEach(function(Qe){switch(Qe){case"type":case"features":return;default:Se[Qe]=ht[Qe]}}),Se.features=ht.features.map(function(Qe){return G(Qe)}),Se}function Fe(ht){var Se={type:ht.type};return ht.bbox&&(Se.bbox=ht.bbox),ht.type==="GeometryCollection"?(Se.geometries=ht.geometries.map(function(Qe){return Fe(Qe)}),Se):(Se.coordinates=Ce(ht.coordinates),Se)}function Ce(ht){var Se=ht;return typeof Se[0]!="object"?Se.slice():Se.map(function(Qe){return Ce(Qe)})}var We=Y,me=I(39034);function Ge(ht,Se){var Qe=ht.x-Se.x,oe=ht.y-Se.y;return Qe*Qe+oe*oe}function Ke(ht,Se,Qe){var oe=Se.x,ue=Se.y,be=Qe.x-oe,vt=Qe.y-ue;if(be!==0||vt!==0){var bt=((ht.x-oe)*be+(ht.y-ue)*vt)/(be*be+vt*vt);bt>1?(oe=Qe.x,ue=Qe.y):bt>0&&(oe+=be*bt,ue+=vt*bt)}return be=ht.x-oe,vt=ht.y-ue,be*be+vt*vt}function pt(ht,Se){for(var Qe=ht[0],oe=[Qe],ue,be=1,vt=ht.length;be<vt;be++)ue=ht[be],Ge(ue,Qe)>Se&&(oe.push(ue),Qe=ue);return Qe!==ue&&oe.push(ue),oe}function Xe(ht,Se,Qe,oe,ue){for(var be=oe,vt,bt=Se+1;bt<Qe;bt++){var Ht=Ke(ht[bt],ht[Se],ht[Qe]);Ht>be&&(vt=bt,be=Ht)}be>oe&&(vt-Se>1&&Xe(ht,Se,vt,oe,ue),ue.push(ht[vt]),Qe-vt>1&&Xe(ht,vt,Qe,oe,ue))}function gt(ht,Se){var Qe=ht.length-1,oe=[ht[0]];return Xe(ht,0,Qe,Se,oe),oe.push(ht[Qe]),oe}function ie(ht,Se,Qe){if(ht.length<=2)return ht;var oe=Se!==void 0?Se*Se:1;return ht=Qe?ht:pt(ht,oe),ht=gt(ht,oe),ht}function ft(ht,Se){if(Se=Se||{},!(0,D.Kn)(Se))throw new Error("options is invalid");var Qe=Se.tolerance!==void 0?Se.tolerance:1,oe=Se.highQuality||!1,ue=Se.mutate||!1;if(!ht)throw new Error("geojson is required");if(Qe&&Qe<0)throw new Error("invalid tolerance");return ue!==!0&&(ht=We(ht)),(0,me.on)(ht,function(be){ve(be,Qe,oe)}),ht}function ve(ht,Se,Qe){var oe=ht.type;if(oe==="Point"||oe==="MultiPoint")return ht;W(ht,!0);var ue=ht.coordinates;switch(oe){case"LineString":ht.coordinates=Ae(ue,Se,Qe);break;case"MultiLineString":ht.coordinates=ue.map(function(be){return Ae(be,Se,Qe)});break;case"Polygon":ht.coordinates=Re(ue,Se,Qe);break;case"MultiPolygon":ht.coordinates=ue.map(function(be){return Re(be,Se,Qe)})}return ht}function Ae(ht,Se,Qe){return ie(ht.map(function(oe){return{x:oe[0],y:oe[1],z:oe[2]}}),Se,Qe).map(function(oe){return oe.z?[oe.x,oe.y,oe.z]:[oe.x,oe.y]})}function Re(ht,Se,Qe){return ht.map(function(oe){var ue=oe.map(function(vt){return{x:vt[0],y:vt[1]}});if(ue.length<4)throw new Error("invalid polygon");for(var be=ie(ue,Se,Qe).map(function(vt){return[vt.x,vt.y]});!Ye(be);)Se-=Se*.01,be=ie(ue,Se,Qe).map(function(vt){return[vt.x,vt.y]});return(be[be.length-1][0]!==be[0][0]||be[be.length-1][1]!==be[0][1])&&be.push(be[0]),be})}function Ye(ht){return ht.length<3?!1:!(ht.length===3&&ht[2][0]===ht[0][0]&&ht[2][1]===ht[0][1])}var at=ft}}]);
