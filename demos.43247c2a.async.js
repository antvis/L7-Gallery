"use strict";(self.webpackChunkdistrict_data=self.webpackChunkdistrict_data||[]).push([[433],{5639:function(ya,te,s){s.r(te),s.d(te,{default:function(){return ea}});var Se=s(15009),d=s.n(Se),je=s(99289),x=s.n(je),ke=s(97857),o=s.n(ke),xe=s(5574),A=s.n(xe),Ee=s(58093),we=s(38244),P=s(25742),G=s(49474),T=s(83370),$e=s(75081),I=s(59577),be=s(79840),z=s(84301),ne=s(34749),Ne=s(12444),M=s.n(Ne),Fe=s(72004),K=s.n(Fe),Le=s(25098),W=s.n(Le),Re=s(31996),ue=s.n(Re),Be=s(26037),ie=s.n(Be),Ae=s(9783),L=s.n(Ae),le=K()(function m(v){M()(this,m),L()(this,"info",{}),L()(this,"options",{}),L()(this,"data",{country:void 0,province:void 0,city:void 0,district:void 0,jiuduanxian:void 0}),L()(this,"version",void 0),L()(this,"fetchJsonData",function(){var i=x()(d()().mark(function e(n){var u;return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,fetch(n);case 2:return u=c.sent,c.next=5,u.json();case 5:return c.abrupt("return",c.sent);case 6:case"end":return c.stop()}},e)}));return function(e){return i.apply(this,arguments)}}()),this.options=o()(o()({},this.getDefaultOptions()),v),this.version=this.options.version||"default"}),Q={desc:{text:"DataV",href:"https://datav.aliyun.com/portal/school/atlas/area_selector"},url:"https://geo.datav.aliyun.com"},Ze=function(m){ue()(i,m);var v=ie()(i);function i(){var e;M()(this,i);for(var n=arguments.length,u=new Array(n),a=0;a<n;a++)u[a]=arguments[a];return e=v.call.apply(v,[this].concat(u)),L()(W()(e),"info",Q),e}return K()(i,[{key:"getDefaultOptions",value:function(){return{version:"areas_v3"}}},{key:"getRenderData",value:function(n){throw new Error("Method not implemented.")}},{key:"getData",value:function(n){var u=n.code,a=n.full,c=this.fetchData(u,a);return c}},{key:"getChildrenData",value:function(n){var u=n.parentName,a=n.full,c=this.fetchData(u,a);return c}},{key:"fetchData",value:function(){var e=x()(d()().mark(function u(a,c){var r,g,D,l;return d()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(r="".concat(Q.url,"/").concat(this.version,"/bound/").concat(a,".json"),g="".concat(Q.url,"/").concat(this.version,"/bound/").concat(a,"_full.json"),!c){h.next=9;break}return h.next=5,this.fetchJsonData(g);case 5:return D=h.sent,h.abrupt("return",D);case 9:return h.next=11,this.fetchJsonData(r);case 11:return l=h.sent,h.abrupt("return",l);case 13:case"end":return h.stop()}},u,this)}));function n(u,a){return e.apply(this,arguments)}return n}()}]),i}(le),Oe=s(13365),Ve=s(74951),Te=s(3614),Je=s.n(Te),se={desc:{text:"\u9510\u591A\u5B9D\u7684\u5730\u7406\u7A7A\u95F4",href:"https://github.com/ruiduobao/shengshixian.com"},url:"https://unpkg.com/xingzhengqu"},Pe={high:1e-6,middle:1e-5,low:.005},Ue={country:"country",province:"province",city:"city",district:"county",jiuduanxian:"jiuduanxian"},Ge=function(m){ue()(i,m);var v=ie()(i);function i(){var e;M()(this,i);for(var n=arguments.length,u=new Array(n),a=0;a<n;a++)u[a]=arguments[a];return e=v.call.apply(v,[this].concat(u)),L()(W()(e),"info",se),L()(W()(e),"fetchArrayBuffer",function(){var c=x()(d()().mark(function r(g){var D;return d()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,fetch(g);case 2:return D=C.sent,C.next=5,D.arrayBuffer();case 5:return C.abrupt("return",C.sent);case 6:case"end":return C.stop()}},r)}));return function(r){return c.apply(this,arguments)}}()),e}return K()(i,[{key:"getDefaultOptions",value:function(){return{version:"2023"}}},{key:"getRenderData",value:function(){var e=x()(d()().mark(function u(a){return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.getData(a));case 1:case"end":return r.stop()}},u,this)}));function n(u){return e.apply(this,arguments)}return n}()},{key:"getData",value:function(){var e=x()(d()().mark(function u(a){var c,r,g,D,l;return d()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return c=a.level,r=c===void 0?"country":c,g=a.precision,D=g===void 0?"low":g,h.next=3,this.fetchData(r);case 3:return l=h.sent,h.abrupt("return",this.simplifyData(l,D));case 5:case"end":return h.stop()}},u,this)}));function n(u){return e.apply(this,arguments)}return n}()},{key:"getChildrenData",value:function(){var e=x()(d()().mark(function u(a){var c,r,g,D,l,C,h,y,V,J;return d()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return c=a.parentName,r=a.parentLevel,g=a.childrenLevel,D=a.shineUpon,l=D===void 0?{country:"",province:"FIRST_GID",city:"GID_1",district:"GID_2"}:D,C=a.precision,h=C===void 0?"low":C,N.next=3,this.getData({level:g,precision:h});case 3:if(y=N.sent,!(l[r]&&c)){N.next=8;break}return V=y.features.filter(function(j){return j.properties[l[r]]===c}),J={type:"FeatureCollection",features:V},N.abrupt("return",J);case 8:return N.abrupt("return",y);case 9:case"end":return N.stop()}},u,this)}));function n(u){return e.apply(this,arguments)}return n}()},{key:"fetchData",value:function(){var e=x()(d()().mark(function u(a){var c,r,g;return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.data[a]){l.next=2;break}return l.abrupt("return",this.data[a]);case 2:return c="".concat(se.url,"@").concat(this.version,"/data/").concat(Ue[a],".pbf"),l.next=5,this.fetchArrayBuffer(c);case 5:return r=l.sent,l.next=8,Ve.decode(new(Je())(r));case 8:return g=l.sent,l.next=11,g;case 11:return this.data[a]=l.sent,l.abrupt("return",g);case 13:case"end":return l.stop()}},u,this)}));function n(u){return e.apply(this,arguments)}return n}()},{key:"simplifyData",value:function(n,u){return(0,Oe.Z)(n,{tolerance:Pe[u],highQuality:!1})}}]),i}(le),Ie={DataVSource:Ze,RDBSource:Ge},$=s(67294),ze={autoFit:!0,fillColor:"#377eb8",opacity:.3,strokeColor:"blue",lineWidth:.5,state:{active:{strokeColor:"green",lineWidth:1.5,lineOpacity:.8},select:{strokeColor:"red",lineWidth:1.5,lineOpacity:.8}}},Me={mapType:"Gaode",mapOptions:{style:"light",center:[120.210792,30.246026],zoom:3}},ce={country:"province",province:"city",city:"district"},oe={province:"",city:"",district:"code"},U={district:"city",city:"province",province:"country",country:"",jiuduanxian:""},Ke=function(){var m=x()(d()().mark(function v(i,e,n,u){var a;return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e==null?void 0:e.getChildrenData({parentName:n,parentLevel:i,childrenLevel:ce[i],shineUpon:{country:"",province:"province_adcode",city:"city_adcode",district:"",jiuduanxian:""},full:u});case 2:return a=r.sent,console.log(a),r.abrupt("return",{GeoJSON:a,level:ce[i]});case 5:case"end":return r.stop()}},v)}));return function(i,e,n,u){return m.apply(this,arguments)}}(),We=function(){var m=x()(d()().mark(function v(i){var e,n,u,a,c,r,g,D,l,C;return d()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(e=i.source,n=i.code,u=i.type,a=i.areaLevel,!u){y.next=20;break}return y.next=4,e==null?void 0:e.getData({code:n,full:!0});case 4:return c=y.sent,y.next=7,e==null?void 0:e.getData({code:n});case 7:if(r=y.sent,g=r==null?void 0:r.features[0].properties.parent.adcode,D=r==null?void 0:r.features[0].properties.level,typeof g=="undefined"){y.next=14;break}return y.abrupt("return",{geoJson:c,code:g,areaLevel:D});case 14:if(g!==null){y.next=18;break}return y.abrupt("return",{geoJson:c,areaLevel:D,code:1e5});case 18:return l=JSON.parse(r==null?void 0:r.features[0].properties.parent).adcode,y.abrupt("return",{geoJson:c,code:l,areaLevel:D});case 20:return y.next=22,e==null?void 0:e.getChildrenData({parentName:n,parentLevel:U[a],childrenLevel:U[a],shineUpon:{country:"",province:"",city:"province_adcode",district:"city_adcode",jiuduanxian:""}});case 22:return C=y.sent,y.abrupt("return",{geoJson:C,code:i[oe[a]]?i[oe[a]]:1e5,areaLevel:U[a]});case 24:case"end":return y.stop()}},v)}));return function(i){return m.apply(this,arguments)}}(),Qe=function(){var m=x()(d()().mark(function v(i,e,n,u){var a;return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n==null?void 0:n.getChildrenData({parentName:i,parentLevel:u,childrenLevel:u,shineUpon:{country:"",province:"",city:"city_adcode",district:"district_adcode"},precision:e,full:!0});case 2:return a=r.sent,r.abrupt("return",a);case 4:case"end":return r.stop()}},v)}));return function(i,e,n,u){return m.apply(this,arguments)}}(),He=function(v){var i=document.createElement("input");i.value=v,document.body.appendChild(i),i.select(),document.execCommand("Copy"),i.style.display="none",T.ZP.success("\u590D\u5236\u6210\u529F")},de=function(v,i){var e=document.createElement("a");e.download="".concat(i,".json"),e.href="data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(v))),e.target="_blank",e.rel="noreferrer",e.click()},Xe=function(){return[{layer:"myChoroplethLayer",fields:[{field:"name",formatField:function(){return"\u540D\u79F0"}},{field:"adcode",formatField:"\u884C\u653F\u7F16\u53F7"}]}]},Ye=function(v){return{country:[{label:"\u7701",value:"province"},{label:"\u5E02",value:"city"},{label:"\u53BF",value:"district"}],province:[{label:"\u5E02",value:"city"},{label:"\u53BF",value:"district"}],city:[{label:"\u53BF",value:"district"}],district:[]}[v]},qe=[{value:"DataVSource",label:"dataV\u6570\u636E\u6E90"},{value:"RDBSource",label:"L7\u6570\u636E\u6E90"}],ve={DataVSource:[{value:"areas_v3",label:"areas_v3"},{value:"areas_v2",label:"areas_v2"}],RDBSource:[{value:"2023",label:"2023"},{value:"2022",label:"2022"}]},_e=[{value:"low",label:"\u4F4E"},{value:"middle",label:"\u4E2D"},{value:"high",label:"\u9AD8"}],t=s(85893),fe=G.Z.Panel,ea=function(){var m,v,i,e,n,u=(0,$.useState)({data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}}),a=A()(u,2),c=a[0],r=a[1],g=(0,$.useState)("RDBSource"),D=A()(g,2),l=D[0],C=D[1],h=(0,$.useState)("2023"),y=A()(h,2),V=y[0],J=y[1],pe=(0,$.useState)({code:1e5,adcode:1e5,level:"country"}),N=A()(pe,2),j=N[0],he=N[1],aa=(0,$.useState)(),ye=A()(aa,2),b=ye[0],ra=ye[1],ta=(0,$.useState)("low"),ge=A()(ta,2),De=ge[0],na=ge[1],ua=(0,$.useState)({clickData:void 0,CheckValue:[],loading:!1}),me=A()(ua,2),F=me[0],R=me[1];(0,$.useEffect)(function(){J(ve[l][0].value)},[l]),(0,$.useEffect)(function(){var E=new Ie[l]({version:V});R(function(p){return o()(o()({},p),{},{loading:!0})}),ra(E),E.getData({level:"country",code:1e5,full:!0}).then(function(p){r(function(f){return o()(o()({},f),{},{data:p})}),R(function(f){return o()(o()({},f),{},{loading:!1,clickData:void 0})})})},[l,V]);var ia=function(){var E=x()(d()().mark(function p(f){var S,B,k,w,H,X,Y,q,_,ee,ae,Ce;return d()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(R(function(O){return o()(o()({},O),{},{loading:!0})}),j.level==="district"){Z.next=12;break}return _={DataVSource:{parentCode:(S=f.feature.properties)!==null&&S!==void 0&&(B=S.parent)!==null&&B!==void 0&&B.adcode?(k=f.feature.properties)===null||k===void 0||(w=k.parent)===null||w===void 0?void 0:w.adcode:(H=f.feature.properties)!==null&&H!==void 0&&H.parent?(X=JSON.parse((Y=f.feature.properties)===null||Y===void 0?void 0:Y.parent))===null||X===void 0?void 0:X.adcode:void 0,full:j.level!=="city"},RDBSource:{parentCode:f.feature.properties["".concat(U[j.level],"_adcode")],full:void 0}},ee=f.feature.properties.adcode,Z.next=6,Ke(j.level,b,ee,(q=_[l])===null||q===void 0?void 0:q.full);case 6:ae=Z.sent,Ce={DataVSource:f.feature.properties.level,RDBSource:ae.level},r(function(O){return o()(o()({},O),{},{data:ae.GeoJSON})}),he(function(O){var re;return o()(o()({},O),{},{code:(re=_[l])===null||re===void 0?void 0:re.parentCode,adcode:ee,level:Ce[l]})}),Z.next=13;break;case 12:T.ZP.info("\u5DF2\u4E0B\u94BB\u5230\u6700\u540E\u4E00\u5C42");case 13:R(function(O){return o()(o()({},O),{},{clickData:void 0,CheckValue:[],loading:!1})});case 14:case"end":return Z.stop()}},p)}));return function(f){return E.apply(this,arguments)}}(),la=function(){var E=x()(d()().mark(function p(){var f,S;return d()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(R(o()(o()({},F),{},{loading:!0})),j.level!=="country"){k.next=5;break}T.ZP.info("\u5DF2\u7ECF\u4E0A\u94BB\u5230\u6700\u4E0A\u5C42\u7EA7"),k.next=11;break;case 5:return f={DataVSource:!0,RDBSource:!1},k.next=8,We({source:b,code:j.code,type:f[l],areaLevel:j.level});case 8:S=k.sent,r(function(w){return o()(o()({},w),{},{data:S.geoJson})}),he({code:S.code,level:S.areaLevel,adcode:S.code});case 11:R(function(w){return o()(o()({},w),{},{clickData:void 0,CheckValue:[],loading:!1})});case 12:case"end":return k.stop()}},p)}));return function(){return E.apply(this,arguments)}}(),sa=function(){var E=x()(d()().mark(function p(){var f,S;return d()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return T.ZP.info("\u6570\u636E\u4E0B\u8F7D\u4E2D"),k.next=3,Qe(j.code,De,b,j.level);case 3:f=k.sent,S=document.createElement("a"),S.download="".concat(j.adcode,".json"),S.href="data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(f))),S.target="_blank",S.rel="noreferrer",S.click(),T.ZP.success("\u6570\u636E\u4E0B\u8F7D\u5B8C\u6210");case 11:case"end":return k.stop()}},p)}));return function(){return E.apply(this,arguments)}}(),ca=function(p){na(p)},oa=(0,$.useMemo)(function(){return Xe()},[l,j.level]),da=function(p){R(function(f){return o()(o()({},f),{},{clickData:{geojson:p.feature,name:p.feature.properties.name,code:p.feature.properties.adcode}})})},va=(0,$.useMemo)(function(){return Ye(j.level)},[j.level]),fa=function(p){R(function(f){return o()(o()({},f),{},{CheckValue:p})})},pa=function(p){J(p)};(0,$.useEffect)(function(){console.log(j)},[j]);var ha=function(){F.CheckValue.forEach(function(){var p=x()(d()().mark(function f(S){var B;return d()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,b==null?void 0:b.getChildrenData({parentName:F.clickData.code,parentLevel:j.level,childrenLevel:S,shineUpon:{country:"",province:"province_adcode",city:"city_adcode"}});case 2:B=w.sent,de(B,S);case 4:case"end":return w.stop()}},f)}));return function(f){return p.apply(this,arguments)}}()),de(F.clickData.geojson,F.clickData.name)};return(0,t.jsx)($e.Z,{spinning:F.loading,children:(0,t.jsxs)("div",{style:{display:"flex"},children:[(0,t.jsxs)(P.$2,o()(o()({},Me),{},{style:{height:"calc(100vh - 180px)",width:"calc(100% - 300px)"},children:[(0,t.jsx)(P.Co,o()(o()({},ze),{},{source:c,onDblClick:ia,onUndblclick:la,onClick:da,id:"myChoroplethLayer"})),(0,t.jsx)(P.Kh,{closeButton:!1,closeOnClick:!1,anchor:"bottom-left",trigger:"hover",items:oa}),(0,t.jsx)(P.w3,{position:"topleft"})]})),(0,t.jsxs)("div",{className:"panel",children:[(0,t.jsxs)("div",{className:"source-select",children:[(0,t.jsxs)("div",{className:"source",children:[(0,t.jsxs)("div",{className:"source-flex",children:[(0,t.jsx)("div",{className:"source-label",children:"\u6570\u636E\u6E90"}),(0,t.jsx)(I.Z,{value:l,style:{width:140},onChange:C,options:qe})]}),(0,t.jsxs)("div",{className:"source-flex",children:[(0,t.jsx)("div",{className:"source-label",children:"\u7248\u672C\u53F7"}),(0,t.jsx)(I.Z,{value:V,style:{width:140},onChange:pa,options:ve[l]})]})]}),(0,t.jsx)("div",{className:"infoText",children:"\u9009\u62E9\u5207\u6362\u4E0D\u540C\u7684\u6570\u636E\u6E90\u548C\u7248\u672C\u53F7"})]}),(0,t.jsx)(G.Z,{defaultActiveKey:["1"],ghost:!0,style:{paddingTop:"12px"},children:(0,t.jsxs)(fe,{header:"\u4E0B\u8F7D\u9009\u4E2D\u6570\u636E",children:[l==="RDBSource"&&(0,t.jsxs)("div",{className:"download_check",children:[(0,t.jsx)("div",{className:"download_check-label",children:"\u6570\u636E\u7C92\u5EA6\u9009\u62E9\uFF1A"}),(0,t.jsx)(be.Z.Group,{options:va,onChange:fa})]}),F.clickData?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{display:"flex",marginBottom:10},children:[(0,t.jsx)("div",{className:"click-label",children:"\u9009\u4E2D\u540D\u79F0\uFF1A"}),(0,t.jsx)("div",{children:(m=F.clickData)===null||m===void 0?void 0:m.name})]}),(0,t.jsxs)("div",{style:{display:"flex"},children:[(0,t.jsx)("div",{className:"click-label",children:"\u9009\u4E2D\u57CE\u5E02\u7F16\u7801\uFF1A"}),(0,t.jsx)(z.Z,{content:"\u70B9\u51FB\u4E0B\u8F7D\u9009\u4E2D\u6570\u636E",children:(0,t.jsx)("a",{onClick:ha,children:F.clickData.code})})]})]}):(0,t.jsx)("div",{className:"infoText",children:"\u6682\u65E0\u6570\u636E\uFF0C\u8BF7\u5355\u51FB\u56FE\u5C42\u9009\u62E9\u6570\u636E"})]},"1")}),l==="RDBSource"&&(0,t.jsx)(G.Z,{defaultActiveKey:["1"],ghost:!0,style:{paddingTop:"10px"},children:(0,t.jsx)(fe,{header:"\u9AD8\u7EA7\u8BBE\u7F6E",children:(0,t.jsxs)("div",{className:"flexCenter",children:[(0,t.jsx)("div",{className:"click-label",children:"\u6570\u636E\u7CBE\u5EA6\uFF1A"}),(0,t.jsx)(I.Z,{style:{width:120},value:De,onChange:ca,options:_e})]})},"1")}),(0,t.jsxs)("div",{className:"download-content",children:[(0,t.jsx)("div",{style:{marginRight:10},children:"\u6570\u636E\u4E0B\u8F7D"}),(0,t.jsxs)("div",{className:"data-input",children:[(0,t.jsx)(z.Z,{content:"\u590D\u5236",children:(0,t.jsx)(ne.ZP,{className:"copy",onClick:function(){return He(JSON.stringify(c.data))},children:(0,t.jsx)(Ee.Z,{})})}),(0,t.jsx)(z.Z,{content:"\u4E0B\u8F7D\u5F53\u524D\u5C42\u7EA7\u5168\u90E8\u6570\u636E",children:(0,t.jsx)(ne.ZP,{onClick:sa,children:(0,t.jsx)(we.Z,{})})})]})]}),(0,t.jsxs)("div",{className:"originData",style:{},children:[(0,t.jsx)("div",{children:"\u6570\u636E\u6765\u6E90\uFF1A"}),(0,t.jsx)("a",{href:"".concat(b==null||(v=b.info)===null||v===void 0||(i=v.desc)===null||i===void 0?void 0:i.href),children:"".concat(b==null||(e=b.info)===null||e===void 0||(n=e.desc)===null||n===void 0?void 0:n.text)})]})]})]})})}}}]);
